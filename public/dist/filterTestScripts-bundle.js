/*! For license information please see filterTestScripts-bundle.js.LICENSE.txt */
(()=>{var e={729:function(e,t,n){e=n.nmd(e),function(t){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function u(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function d(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}var h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},h(e,t)};function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f.apply(this,arguments)};function g(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function y(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function b(e){return"function"==typeof e}function E(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var w=E((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function I(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var _=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=m(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(b(u))try{u()}catch(e){i=e instanceof w?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var l=m(c),d=l.next();!d.done;d=l.next()){var h=d.value;try{T(h)}catch(e){i=null!=i?i:[],e instanceof w?i=y(y([],v(i)),v(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(i)throw new w(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)T(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&I(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&I(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),C=_.EMPTY;function A(e){return e instanceof _||e&&"closed"in e&&b(e.remove)&&b(e.add)&&b(e.unsubscribe)}function T(e){b(e)?e():e.unsubscribe()}var R={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=R.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,y([e,t],v(n))):setTimeout.apply(void 0,y([e,t],v(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function O(e){R.setTimeout((function(){throw e}))}function P(){}function D(e){e()}var k=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,A(t)&&t.add(n)):n.destination=F,n}return p(t,e),t.create=function(e,t,n){return new N(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(_);Function.prototype.bind;var x=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){M(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){M(e)}else M(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){M(e)}},e}(),N=function(e){function t(t,n,r){var i,o=e.call(this)||this;return i=b(t)||!t?{next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:t,o.destination=new x(i),o}return p(t,e),t}(k);function M(e){O(e)}var F={closed:!0,next:P,error:function(e){throw e},complete:P},L="function"==typeof Symbol&&Symbol.observable||"@@observable";function V(e){return e}function B(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return j(e)}function j(e){return 0===e.length?V:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var U=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof k||function(e){return e&&b(e.next)&&b(e.error)&&b(e.complete)}(r)&&A(r)?e:new N(e,t,n);return D((function(){var e=i,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?i._subscribe(o):i._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=H(t))((function(t,r){var i=new N({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return j(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=H(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function H(e){var t;return null!==(t=null!=e?e:undefined)&&void 0!==t?t:Promise}function q(e){return function(t){if(function(e){return b(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function K(e,t,n,r,i){return new W(e,t,n,r,i)}var $,W=function(e){function t(t,n,r,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return p(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(k),G=E((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),z=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return p(t,e),t.prototype.lift=function(e){var t=new J(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new G},t.prototype.next=function(e){var t=this;D((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=m(t.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;D((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;D((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?C:(this.currentObservers=null,o.push(e),new _((function(){t.currentObservers=null,I(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new U;return e.source=this,e},t.create=function(e,t){return new J(e,t)},t}(U),J=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return p(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:C},t}(z),Q=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return p(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(z),Y={now:function(){return(Y.delegate||Date).now()},delegate:void 0},Z=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=Y);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return p(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,o=n._infiniteTimeWindow,s=n._timestampProvider,a=n._windowTime;r||(i.push(t),!o&&i.push(s.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var s=n.now(),a=0,u=1;u<r.length&&r[u]<=s;u+=2)a=u;a&&r.splice(0,a+1)}},t}(z),X=function(e){function t(t,n){return e.call(this)||this}return p(t,e),t.prototype.schedule=function(e,t){return this},t}(_),ee={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=ee.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,y([e,t],v(n))):setInterval.apply(void 0,y([e,t],v(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},te=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return p(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),ee.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&ee.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,I(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(X),ne=1,re={};function ie(e){return e in re&&(delete re[e],!0)}var oe=function(e){var t=ne++;return re[t]=!0,$||($=Promise.resolve()),$.then((function(){return ie(t)&&e()})),t},se={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=se.delegate;return((null==n?void 0:n.setImmediate)||oe).apply(void 0,y([],v(e)))},clearImmediate:function(e){return function(e){ie(e)}(e)},delegate:void 0},ae=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return p(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=se.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,n,r){var i;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var o=t.actions;null!=n&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==n&&(se.clearImmediate(n),t._scheduled===n&&(t._scheduled=void 0))},t}(te),ue=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Y.now,e}(),ce=function(e){function t(t,n){void 0===n&&(n=ue.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return p(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(ue),le=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(ce))(ae),de=new ce(te),he=de,pe=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return p(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!=r&&r>0||null==r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.flush(this),0)},t}(te),fe=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t}(ce))(pe),ge=new U((function(e){return e.complete()}));function me(e){return e&&b(e.schedule)}function ve(e){return e[e.length-1]}function ye(e){return b(ve(e))?e.pop():void 0}function Se(e){return me(ve(e))?e.pop():void 0}var be=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Ee(e){return b(null==e?void 0:e.then)}function we(e){return b(e[L])}function Ie(e){return Symbol.asyncIterator&&b(null==e?void 0:e[Symbol.asyncIterator])}function _e(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Ce="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ae(e){return b(null==e?void 0:e[Ce])}function Te(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{!function(e){e.value instanceof S?Promise.resolve(e.value.v).then(u,c):l(o[0][2],e)}(i[e](t))}catch(e){l(o[0][3],e)}}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,(function(){var t,n,r;return g(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,S(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,S(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,S(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Re(e){return b(null==e?void 0:e.getReader)}function Oe(e){if(e instanceof U)return e;if(null!=e){if(we(e))return i=e,new U((function(e){var t=i[L]();if(b(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(be(e))return r=e,new U((function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()}));if(Ee(e))return n=e,new U((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,O)}));if(Ie(e))return Pe(e);if(Ae(e))return t=e,new U((function(e){var n,r;try{for(var i=m(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(Re(e))return Pe(Te(e))}var t,n,r,i;throw _e(e)}function Pe(e){return new U((function(t){(function(e,t){var n,r,i,o;return function(e,t,n,r){return new(n||(n=Promise))((function(t,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(o,s)}a((r=r.apply(e,[])).next())}))}(this,0,void 0,(function(){var s,a;return g(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=m(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}(e),u.label=1;case 1:return[4,n.next()];case 2:if((r=u.sent()).done)return[3,4];if(s=r.value,t.next(s),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=u.sent(),i={error:a},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function De(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}function ke(e,t){return void 0===t&&(t=0),q((function(n,r){n.subscribe(K(r,(function(n){return De(r,e,(function(){return r.next(n)}),t)}),(function(){return De(r,e,(function(){return r.complete()}),t)}),(function(n){return De(r,e,(function(){return r.error(n)}),t)})))}))}function xe(e,t){return void 0===t&&(t=0),q((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function Ne(e,t){if(!e)throw new Error("Iterable cannot be null");return new U((function(n){De(n,t,(function(){var r=e[Symbol.asyncIterator]();De(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function Me(e,t){return t?function(e,t){if(null!=e){if(we(e))return function(e,t){return Oe(e).pipe(xe(t),ke(t))}(e,t);if(be(e))return function(e,t){return new U((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(Ee(e))return function(e,t){return Oe(e).pipe(xe(t),ke(t))}(e,t);if(Ie(e))return Ne(e,t);if(Ae(e))return function(e,t){return new U((function(n){var r;return De(n,t,(function(){r=e[Ce](),De(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return b(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(Re(e))return function(e,t){return Ne(Te(e),t)}(e,t)}throw _e(e)}(e,t):Oe(e)}function Fe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Me(e,Se(e))}function Le(e,t){var n=b(e)?e:function(){return e},r=function(e){return e.error(n())};return new U(t?function(e){return t.schedule(r,0,e)}:r)}var Ve=E((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function Be(e,t){var n="object"==typeof t;return new Promise((function(r,i){var o=new N({next:function(e){r(e),o.unsubscribe()},error:i,complete:function(){n?r(t.defaultValue):i(new Ve)}});e.subscribe(o)}))}function je(e){return e instanceof Date&&!isNaN(e)}var Ue=E((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function He(e,t){var n=je(e)?{first:e}:"number"==typeof e?{each:e}:e,r=n.first,i=n.each,o=n.with,s=void 0===o?qe:o,a=n.scheduler,u=void 0===a?null!=t?t:de:a,c=n.meta,l=void 0===c?null:c;if(null==r&&null==i)throw new TypeError("No timeout provided.");return q((function(e,t){var n,o,a=null,c=0,d=function(e){o=De(t,u,(function(){try{n.unsubscribe(),Oe(s({meta:l,lastValue:a,seen:c})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe(K(t,(function(e){null==o||o.unsubscribe(),c++,t.next(a=e),i>0&&d(i)}),void 0,void 0,(function(){(null==o?void 0:o.closed)||null==o||o.unsubscribe(),a=null}))),!c&&d(null!=r?"number"==typeof r?r:+r-u.now():i)}))}function qe(e){throw new Ue(e)}function Ke(e,t){return q((function(n,r){var i=0;n.subscribe(K(r,(function(n){r.next(e.call(t,n,i++))})))}))}var $e=Array.isArray;function We(e){return Ke((function(t){return function(e,t){return $e(t)?e.apply(void 0,y([],v(t))):e(t)}(e,t)}))}var Ge=Array.isArray,ze=Object.getPrototypeOf,Je=Object.prototype,Qe=Object.keys;function Ye(e,t,n){return void 0===n&&(n=1/0),b(t)?Ye((function(n,r){return Ke((function(e,i){return t(n,e,r,i)}))(Oe(e(n,r)))}),n):("number"==typeof t&&(n=t),q((function(t,r){return function(e,t,n,r,i,o,s,a){var u=[],c=0,l=0,d=!1,h=function(){!d||u.length||c||t.complete()},p=function(e){c++;var i=!1;Oe(n(e,l++)).subscribe(K(t,(function(e){t.next(e)}),(function(){i=!0}),void 0,(function(){if(i)try{c--;for(var e=function(){var e=u.shift();p(e)};u.length&&c<r;)e();h()}catch(e){t.error(e)}})))};return e.subscribe(K(t,(function(e){return c<r?p(e):u.push(e)}),(function(){d=!0,h()}))),function(){}}(t,r,e,n)})))}function Ze(e){return void 0===e&&(e=1/0),Ye(V,e)}function Xe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ze(1)(Me(e,Se(e)))}function et(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ye(e),r=function(e){if(1===e.length){var t=e[0];if(Ge(t))return{args:t,keys:null};if((r=t)&&"object"==typeof r&&ze(r)===Je){var n=Qe(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var r;return{args:e,keys:null}}(e),i=r.args,o=r.keys,s=new U((function(e){var t=i.length;if(t)for(var n=new Array(t),r=t,s=t,a=function(t){var a=!1;Oe(i[t]).subscribe(K(e,(function(e){a||(a=!0,s--),n[t]=e}),(function(){return r--}),void 0,(function(){r&&a||(s||e.next(o?function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}(o,n):n),e.complete())})))},u=0;u<t;u++)a(u);else e.complete()}));return n?s.pipe(We(n)):s}var tt=["addListener","removeListener"],nt=["addEventListener","removeEventListener"],rt=["on","off"];function it(e,t,n,r){if(b(n)&&(r=n,n=void 0),r)return it(e,t,n).pipe(We(r));var i=v(function(e){return b(e.addEventListener)&&b(e.removeEventListener)}(e)?nt.map((function(r){return function(i){return e[r](t,i,n)}})):function(e){return b(e.addListener)&&b(e.removeListener)}(e)?tt.map(ot(e,t)):function(e){return b(e.on)&&b(e.off)}(e)?rt.map(ot(e,t)):[],2),o=i[0],s=i[1];if(!o&&be(e))return Ye((function(e){return it(e,t,n)}))(Oe(e));if(!o)throw new TypeError("Invalid event target");return new U((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return o(t),function(){return s(t)}}))}function ot(e,t){return function(n){return function(r){return e[n](t,r)}}}function st(e,t,n){return n?st(e,t).pipe(We(n)):new U((function(n){var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.next(1===e.length?e[0]:e)},i=e(r);return b(t)?function(){return t(r,i)}:void 0}))}function at(e,t,n){void 0===e&&(e=0),void 0===n&&(n=he);var r=-1;return null!=t&&(me(t)?n=t:r=t),new U((function(t){var i=je(e)?+e-n.now():e;i<0&&(i=0);var o=0;return n.schedule((function(){t.closed||(t.next(o++),0<=r?this.schedule(void 0,r):t.complete())}),i)}))}function ut(e,t){return void 0===e&&(e=0),void 0===t&&(t=de),e<0&&(e=0),at(e,e,t)}function ct(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Se(e),r=function(e,t){return"number"==typeof ve(e)?e.pop():1/0}(e),i=e;return i.length?1===i.length?Oe(i[0]):Ze(r)(Me(i,n)):ge}var lt=Array.isArray;function dt(e,t){return function(n,r){return!e.call(t,n,r)}}function ht(e,t){return q((function(n,r){var i=0;n.subscribe(K(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}function pt(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 1===(t=1===(e=t).length&&lt(e[0])?e[0]:e).length?Oe(t[0]):new U(function(e){return function(t){for(var n=[],r=function(r){n.push(Oe(e[r]).subscribe(K(t,(function(e){if(n){for(var i=0;i<n.length;i++)i!==r&&n[i].unsubscribe();n=null}t.next(e)}))))},i=0;n&&!t.closed&&i<e.length;i++)r(i)}}(t))}function ft(e){return q((function(t,n){var r,i=null,o=!1;i=t.subscribe(K(n,void 0,void 0,(function(s){r=Oe(e(s,ft(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):o=!0}))),o&&(i.unsubscribe(),i=null,r.subscribe(n))}))}function gt(e){return e<=0?function(){return ge}:q((function(t,n){var r=0;t.subscribe(K(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}function mt(e){return Ke((function(){return e}))}function vt(e,t){return t?function(n){return Xe(t.pipe(gt(1),q((function(e,t){e.subscribe(K(t,P))}))),n.pipe(vt(e)))}:Ye((function(t,n){return Oe(e(t,n)).pipe(gt(1),mt(t))}))}function yt(e,t){void 0===t&&(t=de);var n=at(e,t);return vt((function(){return n}))}function St(e,t,n){return void 0===n&&(n=1/0),b(t)?Ye((function(){return e}),t,n):("number"==typeof t&&(n=t),Ye((function(){return e}),n))}function bt(e,t){return q(function(e,t,n,r,i){return function(r,i){var o=n,s=t,a=0;r.subscribe(K(i,(function(t){var n=a++;s=o?e(s,t,n):(o=!0,t),i.next(s)}),void 0))}}(e,t,arguments.length>=2))}function Et(e){return q((function(t,n){var r=!1,i=0;t.subscribe(K(n,(function(t){return(r||(r=!e(t,i++)))&&n.next(t)})))}))}function wt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Se(e);return q((function(t,r){(n?Xe(e,t,n):Xe(e,t)).subscribe(r)}))}function It(e,t){return q((function(n,r){var i=null,o=0,s=!1,a=function(){return s&&!i&&r.complete()};n.subscribe(K(r,(function(n){null==i||i.unsubscribe();var s=0,u=o++;Oe(e(n,u)).subscribe(i=K(r,(function(e){return r.next(t?t(n,e,u,s++):e)}),(function(){i=null,a()})))}),(function(){s=!0,a()})))}))}function _t(e){return q((function(t,n){Oe(e).subscribe(K(n,(function(){return n.complete()}),P)),!n.closed&&t.subscribe(n)}))}function Ct(e,t){return void 0===t&&(t=!1),q((function(n,r){var i=0;n.subscribe(K(r,(function(n){var o=e(n,i++);(o||t)&&r.next(n),!o&&r.complete()})))}))}function At(e,t,n){var r=b(e)||t||n?{next:e,error:t,complete:n}:e;return r?q((function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(K(t,(function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)}),(function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()}),(function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)}),(function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)})))})):V}function Tt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ye(e);return q((function(t,r){for(var i=e.length,o=new Array(i),s=e.map((function(){return!1})),a=!1,u=function(t){Oe(e[t]).subscribe(K(r,(function(e){o[t]=e,a||s[t]||(s[t]=!0,(a=s.every(V))&&(s=null))}),P))},c=0;c<i;c++)u(c);t.subscribe(K(r,(function(e){if(a){var t=y([e],v(o));r.next(n?n.apply(void 0,y([],v(t))):t)}})))}))}function Rt(e){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rt(e)}function Ot(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Rt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Rt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function kt(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var xt="function"==typeof Symbol&&Symbol.observable||"@@observable",Nt=function(){return Math.random().toString(36).substring(7).split("").join(".")},Mt={INIT:"@@redux/INIT"+Nt(),REPLACE:"@@redux/REPLACE"+Nt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Nt()}};function Ft(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(kt(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(kt(1));return n(Ft)(e,t)}if("function"!=typeof e)throw new Error(kt(2));var i=e,o=t,s=[],a=s,u=!1;function c(){a===s&&(a=s.slice())}function l(){if(u)throw new Error(kt(3));return o}function d(e){if("function"!=typeof e)throw new Error(kt(4));if(u)throw new Error(kt(5));var t=!0;return c(),a.push(e),function(){if(t){if(u)throw new Error(kt(6));t=!1,c();var n=a.indexOf(e);a.splice(n,1),s=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(kt(7));if(void 0===e.type)throw new Error(kt(8));if(u)throw new Error(kt(9));try{u=!0,o=i(o,e)}finally{u=!1}for(var t=s=a,n=0;n<t.length;n++)(0,t[n])();return e}return h({type:Mt.INIT}),(r={dispatch:h,subscribe:d,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error(kt(10));i=e,h({type:Mt.REPLACE})}})[xt]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(kt(11));function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[xt]=function(){return this},e},r}function Lt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var Vt=function(e,t){return Vt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Vt(e,t)},Bt=function(e){function t(t,n){var r=e.call(this,(function(e){var t=r.__notifier.subscribe(e);return t&&!t.closed&&e.next(r.value),t}))||this;return r.__notifier=new z,r.value=n,t.subscribe((function(e){e!==r.value&&(r.value=e,r.__notifier.next(e))})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Vt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(U),jt=function(e,t){return e===t||"function"==typeof t&&e===t.toString()};function Ut(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;return ht(1===n?function(t){return jt(t.type,e[0])}:function(t){for(var r=0;r<n;r++)if(jt(t.type,e[r]))return!0;return!1})}var Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function qt(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function Kt(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}"object"===(void 0===n.g?"undefined":Ht(n.g))&&n.g?n.g:"undefined"!=typeof window&&window,qt((function e(t,n,r){e.super_.call(this,"E",t),Object.defineProperty(this,"lhs",{value:n,enumerable:!0}),Object.defineProperty(this,"rhs",{value:r,enumerable:!0})}),Kt),qt((function e(t,n){e.super_.call(this,"N",t),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}),Kt),qt((function e(t,n){e.super_.call(this,"D",t),Object.defineProperty(this,"lhs",{value:n,enumerable:!0})}),Kt),qt((function e(t,n,r){e.super_.call(this,"A",t),Object.defineProperty(this,"index",{value:n,enumerable:!0}),Object.defineProperty(this,"item",{value:r,enumerable:!0})}),Kt);const $t=!1;var Wt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function Gt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function zt(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}var Jt=function(e,t,n,r,i,o,s,a){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,i,o,s,a],l=0;(u=new Error(t.replace(/%s/g,(function(){return c[l++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}},Qt=function(e){return"function"==typeof e},Yt=function(e){return e.toString()},Zt=function(e){return"string"==typeof e},Xt="/",en="||",tn=function(e){return e},nn=function(e){return null===e};function rn(e,t,n){void 0===t&&(t=tn),Jt(Qt(t)||nn(t),"Expected payloadCreator to be a function, undefined or null");var r=nn(t)||t===tn?tn:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e instanceof Error?e:t.apply(void 0,[e].concat(r))},i=Qt(n),o=e.toString(),s=function(){var t=r.apply(void 0,arguments),o={type:e};return t instanceof Error&&(o.error=!0),void 0!==t&&(o.payload=t),i&&(o.meta=n.apply(void 0,arguments)),o};return s.toString=function(){return o},s}var on=function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},sn=function(e){return Array.isArray(e)},an=function(e){return null==e},un=/\s/,cn=/(_|-|\.|:)/,ln=/([a-z][A-Z]|[A-Z][a-z])/,dn=/[\W_]+(.|$)/g,hn=/(.)([A-Z]+)/g,pn=function(e){return function(e){return function(e){return un.test(e)?e.toLowerCase():cn.test(e)?(function(e){return e.replace(dn,(function(e,t){return t?" "+t:""}))}(e)||e).toLowerCase():ln.test(e)?function(e){return e.replace(hn,(function(e,t,n){return t+" "+n.toLowerCase().split("").join(" ")}))}(e).toLowerCase():e.toLowerCase()}(e).replace(/[\W_]+(.|$)/g,(function(e,t){return t?" "+t:""})).trim()}(e).replace(/\s(\w)/g,(function(e,t){return t.toUpperCase()}))},fn=function(e){return-1===e.indexOf("/")?pn(e):e.split("/").map(pn).join("/")},gn=function(e,t){return e.reduce((function(e,n){return t(e,n)}),{})},mn=function(e){return"undefined"!=typeof Map&&e instanceof Map};function vn(e){if(mn(e))return Array.from(e.keys());if("undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys)return Reflect.ownKeys(e);var t=Object.getOwnPropertyNames(e);return"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t}function yn(e,t){return mn(t)?t.get(e):t[e]}var Sn=function(e){return function t(n,r,i,o){var s=void 0===r?{}:r,a=s.namespace,u=void 0===a?Xt:a,c=s.prefix;return void 0===i&&(i={}),void 0===o&&(o=""),vn(n).forEach((function(r){var s=function(e){return o||!c||c&&new RegExp("^"+c+u).test(e)?e:""+c+u+e}(function(e){var t;if(!o)return e;var n=e.toString().split(en),r=o.split(en);return(t=[]).concat.apply(t,r.map((function(e){return n.map((function(t){return""+e+u+t}))}))).join(en)}(r)),a=yn(r,n);e(a)?t(a,{namespace:u,prefix:c},i,s):i[s]=a})),i}},bn=Sn(on);function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){wn(e,t,n[t])}))}return e}function wn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function In(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,o=on((i=n)[i.length-1])?n.pop():{};return Jt(n.every(Zt)&&(Zt(e)||on(e)),"Expected optional object followed by string action types"),Zt(e)?Cn([e].concat(n),o):En({},function(e,t){return function(e,t){var n=void 0===t?{}:t,r=n.namespace,i=void 0===r?Xt:r,o=n.prefix;function s(t,n,r){var i=fn(r.shift());!function(e){return 0===e.length}(r)?(n[i]||(n[i]={}),s(t,n[i],r)):n[i]=e[t]}var a={};return Object.getOwnPropertyNames(e).forEach((function(e){var t=o?e.replace(""+o+i,""):e;return s(e,a,t.split(i))})),a}(_n(bn(e,t)),t)}(e,o),Cn(n,o))}function _n(e,t){var n=void 0===t?{}:t,r=n.prefix,i=n.namespace,o=void 0===i?Xt:i;return gn(Object.keys(e),(function(t,n){var i,s=e[n];Jt(function(e){if(Qt(e)||an(e))return!0;if(sn(e)){var t=e[0],n=void 0===t?tn:t,r=e[1];return Qt(n)&&Qt(r)}return!1}(s),"Expected function, undefined, null, or array with payload and meta functions for "+n);var a=r?""+r+o+n:n,u=sn(s)?rn.apply(void 0,[a].concat(s)):rn(a,s);return En({},t,((i={})[n]=u,i))}))}function Cn(e,t){var n=_n(gn(e,(function(e,t){var n;return En({},e,((n={})[t]=tn,n))})),t);return gn(Object.keys(n),(function(e,t){var r;return En({},e,((r={})[fn(t)]=n[t],r))}))}var An=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="function"!=typeof t[t.length-1]&&t.pop(),i=t;if(void 0===r)throw new TypeError("The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.");return function(e,t){for(var n=arguments.length,o=Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s];var a=void 0===e,u=void 0===t;return a&&u&&r?r:i.reduce((function(e,n){return n.apply(void 0,[e,t].concat(o))}),a&&!u&&r?r:e)}},Tn=Sn((function(e){return(on(e)||mn(e))&&!function(e){var t=vn(e),n=t.every((function(e){return"next"===e||"throw"===e}));return t.length&&t.length<=2&&n}(e)}));function Rn(e,t,n){void 0===n&&(n={}),Jt(on(e)||mn(e),"Expected handlers to be a plain object.");var r=Tn(e,n),i=vn(r).map((function(e){return function(e,t,n){void 0===t&&(t=tn);var r=Yt(e).split(en);Jt(!function(e){return void 0===e}(n),"defaultState for reducer handling "+r.join(", ")+" should be defined"),Jt(Qt(t)||on(t),"Expected reducer to be a function or object with next and throw reducers");var i=Qt(t)?[t,t]:[t.next,t.throw].map((function(e){return an(e)?tn:e})),o=i[0],s=i[1];return function(e,t){void 0===e&&(e=n);var i=t.type;return i&&-1!==r.indexOf(Yt(i))?(!0===t.error?s:o)(e,t):e}}(e,yn(e,r),t)})),o=An.apply(void 0,i.concat([t]));return function(e,n){return void 0===e&&(e=t),o(e,n)}}const On=rn("CONNECT_ZOOM_SOCKET"),Pn=rn("CONNECT_XMPP_SOCKET"),Dn=rn("CLOSE_ZOOM_SOCKET"),kn=rn("CLOSE_XMPP_SOCKET"),xn=rn("RECEIVE_MESSAGE_FROM_ZOOM_SOCKET"),Nn=rn("RECEIVE_SHARING_PAYLOAD_FROM_ZOOM_SOCKET"),Mn=rn("RECEIVE_MESSAGE_FROM_XMPP_SOCKET"),Fn=rn("CONNECT_MAIN_SESSION_SOCKET"),Ln=rn("CLOSE_MAIN_SESSION_SOCKET"),Vn=rn("RECEIVE_MESSAGE_FROM_MAIN_SESSION_SOCKET"),{setZoomSocketStatus:Bn,setRwgServersList:jn,setRwgRetryCount:Un,setXmppSocketStatus:Hn,setMainSessionSocketStatus:qn,resetSocket:Kn}=In("SET_ZOOM_SOCKET_STATUS","SET_RWG_SERVERS_LIST","SET_RWG_RETRY_COUNT","SET_XMPP_SOCKET_STATUS","SET_MAIN_SESSION_SOCKET_STATUS","RESET_SOCKET"),$n=rn("CONNECT_TO_MEDIA_STREAM"),Wn=rn("RECEIVE_PAYLOAD_FROM_MEDIA_SDK"),{setAudioEncodeStatus:Gn,setAudioDecodeStatus:zn,setVideoEncodeStatus:Jn,setVideoDecodeStatus:Qn,setSharingEncodeStatus:Yn,setSharingDecodeStatus:Zn,setMediaConstraints:Xn,setMediaEncryptKey:er,setIsEnableDecoderInWorklet:tr,setPatchedMediaSdkStatus:nr,setMediaAssetsPath:rr,setIsEnableVideoAudioQos:ir,setIsAudioBridgeReceiveReady:or,setIsAudioBridgeSendReady:sr,setIsMediaAgentInitialized:ar,setAdaptedAbOptionForMediaSdk:ur,resetMedia:cr}=In("SET_AUDIO_ENCODE_STATUS","SET_AUDIO_DECODE_STATUS","SET_VIDEO_ENCODE_STATUS","SET_VIDEO_DECODE_STATUS","SET_SHARING_ENCODE_STATUS","SET_SHARING_DECODE_STATUS","SET_MEDIA_CONSTRAINTS","SET_MEDIA_ENCRYPT_KEY","SET_IS_ENABLE_DECODER_IN_WORKLET","SET_PATCHED_MEDIA_SDK_STATUS","SET_MEDIA_ASSETS_PATH","SET_IS_ENABLE_VIDEO_AUDIO_QOS","SET_IS_AUDIO_BRIDGE_RECEIVE_READY","SET_IS_AUDIO_BRIDGE_SEND_READY","SET_IS_MEDIA_AGENT_INITIALIZED","SET_ADAPTED_AB_OPTION_FOR_MEDIA_SDK","RESET_MEDIA");function lr(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return e(Fe(...r||[]),t,null)}function dr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return ct(...t.map((e=>{const t=e(...n);if(!t)throw new TypeError(`combineEpics: one of the provided Epics "${e.name||"<anonymous>"}" does not return a stream. Double check you're not missing a return statement!`);return t.pipe(ft(((e,t)=>(setTimeout((()=>{throw e}),0),t))))})))};try{Object.defineProperty(r,"name",{value:`combineEpics(${t.map((e=>e.name||"<anonymous>")).join(", ")})`})}catch(e){}return r}function hr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return dr(...t.flatMap((e=>Object.values(e))))}function pr(e,t){return e.pipe(Ut(`${xn}`),ht((e=>e.payload.evt===t)))}function fr(e,t){return e.pipe(Ut(`${Vn}`),ht((e=>e.payload.evt===t)))}function gr(e,t){return e.pipe(Ut(`${Mn}`),ht((e=>e.payload.evt===t)))}function mr(e,t){return e.pipe(Ut(`${xn}`,`${Vn}`),ht((e=>e.payload.evt===t)))}function vr(e,t){return e.pipe(Ut(`${Wn}`),ht((e=>Array.isArray(t)?t.indexOf(e.payload.type)>-1:e.payload.type===t)))}function yr(e,t){return e.pipe(Ut(`${$n}`),ht((()=>{const{media:{assetsPath:e,mediaConstraints:n}}=t.value;return void 0!==e&&void 0!==n})),It((()=>{const{media:{isMediaAgentInitialized:n}}=t.value;return n?Me([0]):e.pipe(Ut(`${ar}`),ht((e=>!!e.payload)),gt(1))})))}const Sr="3.7.5",br=Sr,Er="function"==typeof atob,wr="function"==typeof btoa,Ir="function"==typeof Buffer,_r="function"==typeof TextDecoder?new TextDecoder:void 0,Cr="function"==typeof TextEncoder?new TextEncoder:void 0,Ar=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Tr=(e=>{let t={};return Ar.forEach(((e,n)=>t[e]=n)),t})(),Rr=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Or=String.fromCharCode.bind(String),Pr="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Dr=e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")),kr=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),xr=e=>{let t,n,r,i,o="";const s=e.length%3;for(let s=0;s<e.length;){if((n=e.charCodeAt(s++))>255||(r=e.charCodeAt(s++))>255||(i=e.charCodeAt(s++))>255)throw new TypeError("invalid character found");t=n<<16|r<<8|i,o+=Ar[t>>18&63]+Ar[t>>12&63]+Ar[t>>6&63]+Ar[63&t]}return s?o.slice(0,s-3)+"===".substring(s):o},Nr=wr?e=>btoa(e):Ir?e=>Buffer.from(e,"binary").toString("base64"):xr,Mr=Ir?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let n=0,r=e.length;n<r;n+=4096)t.push(Or.apply(null,e.subarray(n,n+4096)));return Nr(t.join(""))},Fr=(e,t=!1)=>t?Dr(Mr(e)):Mr(e),Lr=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?Or(192|t>>>6)+Or(128|63&t):Or(224|t>>>12&15)+Or(128|t>>>6&63)+Or(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return Or(240|t>>>18&7)+Or(128|t>>>12&63)+Or(128|t>>>6&63)+Or(128|63&t)},Vr=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Br=e=>e.replace(Vr,Lr),jr=Ir?e=>Buffer.from(e,"utf8").toString("base64"):Cr?e=>Mr(Cr.encode(e)):e=>Nr(Br(e)),Ur=(e,t=!1)=>t?Dr(jr(e)):jr(e),Hr=e=>Ur(e,!0),qr=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Kr=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return Or(55296+(t>>>10))+Or(56320+(1023&t));case 3:return Or((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Or((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},$r=e=>e.replace(qr,Kr),Wr=e=>{if(e=e.replace(/\s+/g,""),!Rr.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,r,i="";for(let o=0;o<e.length;)t=Tr[e.charAt(o++)]<<18|Tr[e.charAt(o++)]<<12|(n=Tr[e.charAt(o++)])<<6|(r=Tr[e.charAt(o++)]),i+=64===n?Or(t>>16&255):64===r?Or(t>>16&255,t>>8&255):Or(t>>16&255,t>>8&255,255&t);return i},Gr=Er?e=>atob(kr(e)):Ir?e=>Buffer.from(e,"base64").toString("binary"):Wr,zr=Ir?e=>Pr(Buffer.from(e,"base64")):e=>Pr(Gr(e).split("").map((e=>e.charCodeAt(0)))),Jr=e=>zr(Yr(e)),Qr=Ir?e=>Buffer.from(e,"base64").toString("utf8"):_r?e=>_r.decode(zr(e)):e=>$r(Gr(e)),Yr=e=>kr(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),Zr=e=>Qr(Yr(e)),Xr=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),ei=function(){const e=(e,t)=>Object.defineProperty(String.prototype,e,Xr(t));e("fromBase64",(function(){return Zr(this)})),e("toBase64",(function(e){return Ur(this,e)})),e("toBase64URI",(function(){return Ur(this,!0)})),e("toBase64URL",(function(){return Ur(this,!0)})),e("toUint8Array",(function(){return Jr(this)}))},ti=function(){const e=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,Xr(t));e("toBase64",(function(e){return Fr(this,e)})),e("toBase64URI",(function(){return Fr(this,!0)})),e("toBase64URL",(function(){return Fr(this,!0)}))},ni={version:Sr,VERSION:br,atob:Gr,atobPolyfill:Wr,btoa:Nr,btoaPolyfill:xr,fromBase64:Zr,toBase64:Ur,encode:Ur,encodeURI:Hr,encodeURL:Hr,utob:Br,btou:$r,decode:Zr,isValid:e=>{if("string"!=typeof e)return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:Fr,toUint8Array:Jr,extendString:ei,extendUint8Array:ti,extendBuiltins:()=>{ei(),ti()}};function ri(e){return ni.encode(e,!0)}function ii(e){return ni.decode(e)}function oi(e){return ni.encode(e,!1)}const si={"-":"+",_:"/",".":"="};function ai(e){const t=e.replace(/[-_.]/g,(e=>si[e]));return Uint8Array.from(window.atob(t),(e=>e.charCodeAt(0)))}const ui=e=>{const t=e.charCodeAt(0);return t<=parseInt("0x7F",16)?1:t<=parseInt("0x7FF",16)?2:t<=parseInt("0xFFFF",16)?3:t<=parseInt("0x1FFFFF",16)?4:t<=parseInt("0x3FFFFFF",16)?5:6},ci=(e,t)=>{const n=e.split(".").map((e=>Number(e))).slice(0,3),r=t.split(".").map((e=>Number(e))).slice(0,3);let i=0;for(let e=0;e<3;e++){const t=e<n.length?n[e]:0,o=e<r.length?r[e]:0;if(t<o){i=-1;break}if(t>o){i=1;break}}return i},li=e=>{var t;let n=(new Date).getTime(),r=1e3*(null===(t=performance)||void 0===t?void 0:t.now())||0;const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{let t=16*Math.random();return n>0?(t=(n+t)%16|0,n=Math.floor(n/16)):(t=(r+t)%16|0,r=Math.floor(r/16)),("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?i+":"+e:i+""};function di(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=Object.keys(e),r=Object.keys(t),i=n.length;if(r.length!==i)return!1;for(let r=0;r<i;r++){const i=n[r];if(e[i]!==t[i]||!Object.prototype.hasOwnProperty.call(t,i))return!1}return!0}const hi=(e,t)=>e>>10==t>>10,pi=(e,t)=>new Promise((n=>{setTimeout((()=>{n(e())}),t)})),fi=e=>{const t=`${Math.floor(1e4*Math.random())}`;return e.indexOf("@")>-1?e.replace("@",t):`${e}${t}`},gi=e=>{try{const t=new URL(e);return!("data:"===t.protocol&&"null"===t.origin)&&t.origin!==location.origin}catch(e){return!0}},mi=e=>{const t=e.split(".")[1];if("string"==typeof t){let n=t.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw new Error("base64 string is not of the correct length")}try{const e=decodeURIComponent(window.atob(n).replace(/(.)/g,(function(e,t){let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})));return JSON.parse(e)}catch(e){console.error("Invalid token specified: invalid base64")}}};function vi(e){return e&&e.endsWith("/")?e.slice(0,e.length-1):e}function yi(e){return[...new Uint8Array(e)].map((e=>e.toString(16).padStart(2,"0"))).join("")}function Si(e){return`${e.tagName}${e.id?`#${e.id}`:""}${e.className?`${e.className.split(" ").map((e=>`.${e}`)).join("")}`:""}`}function bi(e){const t=function(e){const t=e&&e.getRootNode();if(t&&"#document"!==t.nodeName&&t.host)return Si(t.host)}(e);return`${t?`${t}>`:""}${Si(e)}`}function Ei(e){return"object"==typeof e&&null!==e?e instanceof HTMLElement?bi(e):ArrayBuffer.isView(e)?yi(e.buffer):Array.isArray(e)?e.map((e=>Ei(e))):Object.keys(e).reduce(((t,n)=>({...t,[`${n}`]:Ei(e[n])})),{}):e}let wi=function(e){return e[e.Success=0]="Success",e[e.MeetingIsOver=6]="MeetingIsOver",e[e.UserFull=9]="UserFull",e[e.MeetingLocked=9]="MeetingLocked",e[e.WebinarBlockedEmail=3033]="WebinarBlockedEmail",e[e.MeetingNotStarted=3008]="MeetingNotStarted",e[e.MeetingHasClosed=103003]="MeetingHasClosed",e[e.UserHasBeenRemoved=103039]="UserHasBeenRemoved",e[e.MMRIBReject=103043]="MMRIBReject",e[e.MMRConfParticipantExists=103044]="MMRConfParticipantExists",e}({}),Ii=function(e){return e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Userrequest=2]="Userrequest",e[e.SdkConnection=3]="SdkConnection",e[e.Reconnect=5]="Reconnect",e[e.PtRequest=6]="PtRequest",e[e.KickedByHost=7]="KickedByHost",e[e.EndByHost=8]="EndByHost",e[e.EndByHostStartAnotherMeeting=9]="EndByHostStartAnotherMeeting",e[e.FreeMeetingTimeout=10]="FreeMeetingTimeout",e[e.JBHTimeout=11]="JBHTimeout",e[e.EndBySingleStatus=12]="EndBySingleStatus",e[e.WebinarNeedRegister=13]="WebinarNeedRegister",e[e.ArchiveFail=14]="ArchiveFail",e[e.EndByNone=15]="EndByNone",e[e.EndByAdmin=16]="EndByAdmin",e[e.DuplicateSession=17]="DuplicateSession",e[e.MeetingTransfer=18]="MeetingTransfer",e}({}),_i=function(e){return e[e.WaitingRoomFailover=1]="WaitingRoomFailover",e[e.WebEndAndRejoin=2]="WebEndAndRejoin",e}({}),Ci=function(e){return e[e.Success=0]="Success",e[e.CommonError=200]="CommonError",e[e.WrongPasscode=3004]="WrongPasscode",e[e.RoleTypeMissing=3010]="RoleTypeMissing",e[e.InvalidParameter=4003]="InvalidParameter",e}({}),Ai=function(e){return e[e.Success=0]="Success",e[e.AnotherMeetingInProgress=3e3]="AnotherMeetingInProgress",e[e.MeetingNotExist=3001]="MeetingNotExist",e[e.NotHost=3003]="NotHost",e[e.WrongPasscode=3004]="WrongPasscode",e[e.MissingEmail=3005]="MissingEmail",e[e.MeetingNotStarted=3008]="MeetingNotStarted",e[e.UserHasBeenRemoved=3009]="UserHasBeenRemoved",e[e.RoleTypeMissing=3010]="RoleTypeMissing",e[e.WebinarEnforceLogin=3034]="WebinarEnforceLogin",e[e.RealNameMissing=3082]="RealNameMissing",e[e.RegisterRequired=3099]="RegisterRequired",e[e.SsoLoginWindow=6024]="SsoLoginWindow",e[e.ZoomLoginWindow=3051]="ZoomLoginWindow",e[e.ZoomSpecificLoginWindow=3052]="ZoomSpecificLoginWindow",e[e.LoginRequired=3100]="LoginRequired",e[e.Reconnecting=4e3]="Reconnecting",e[e.Disconnect=4001]="Disconnect",e[e.InvalidParameter=4003]="InvalidParameter",e[e.DeniedRegisterWithPanelist=3032]="DeniedRegisterWithPanelist",e[e.ServiceOffline=403]="ServiceOffline",e[e.RwcEmpty=3621]="RwcEmpty",e[e.RwcError=3622]="RwcError",e[e.FrequentCall=3633]="FrequentCall",e[e.FrequentJoin=3634]="FrequentJoin",e[e.WasmFail=3635]="WasmFail",e[e.CommonError=200]="CommonError",e[e.Upgrade=1e4]="Upgrade",e}({});Ai.Success,Ai.RegisterRequired,Ai.LoginRequired,Ai.SsoLoginWindow,Ai.ZoomLoginWindow,Ai.ZoomSpecificLoginWindow,Ai.MissingEmail,Ai.MeetingNotExist,Ai.NotHost,Ai.WrongPasscode,Ai.RoleTypeMissing,Ai.AnotherMeetingInProgress,Ai.MeetingNotStarted,Ai.InvalidParameter,Ai.Reconnecting,Ai.UserHasBeenRemoved,Ai.WebinarEnforceLogin,Ai.Disconnect,Ai.DeniedRegisterWithPanelist,Ai.RwcEmpty,Ai.RwcError,Ai.FrequentCall,Ai.FrequentJoin,Ai.WasmFail,Ai.Upgrade;const Ti={3004:{"apac.errorcodes_pac_mn_wrong":3714},3005:{"apac.errorcodes_web_has_in_progress":3e3},3008:{"apac.errorcodes_not_start":3008},3027:{"apac.errorcodes_host_email_as_attendee":3627},3033:{"apac.errorcodes_denied_email":3620},1005:{"apac.errorcodes_no_response_from_web":3621},131005:{"apac.errorcodes_no_response_from_web":3621},1001:{"apac.errorcodes_host_inactive":3625},131001:{"apac.errorcodes_host_inactive":3625},131013:{"meeting ended":4004},103039:{"apac.errorcodes_be_removed":3009},6:{"meeting ended":4004},9:{"meeting is at capacity":4005},12:{"meeting locked":4006},103043:{"reject for information barriers":4007},103044:{"participant exist":4008}};function Ri(e,t){let n={code:200,i18nKey:"apac.errorcodes_fail"};if(void 0!==Ti[e]){const t=Ti[e],r=Object.keys(t)[0];return n={code:t[r],i18nKey:r},{reason:r.startsWith("apac")?"":r,errorCode:n.code}}return{code:200,reason:"connection error"}}const Oi=["bLock","bHoldUponEntry","viewOnly","listenOnlyPhone","bAllowRaiseHand","bAllowAttendeeRename","bBroadcast","bAllowPlayChimeForEnterOrExit","bIbDisableShare","bIbDisableChat","encryptKey","bNoHostTimeOut","bAllowShowCount","bHasAST","bHasRMC","gatewayKey","encryptKey"],Pi={bChime:"bAllowPlayChimeForEnterOrExit",bHasAST:"hasAst",bHasRMC:"hasRmc",topic:e=>({meetingTopic:ii(e)}),gatewayKey:e=>{const[,t,n]=e.split(".");return t&&n?{gatewayUser:{userId:Number(t),sn:n}}:{}},encryptKey:e=>({gcmSessinKey:ai(e)})},Di=rn("GET_MEETING_INFO"),ki=rn("GET_INSTANT_MEETING_INFO");rn("LOGON_ZOOM_DOMAIN"),rn("VERIFY_ZOOM_RECAPTCHA"),rn("LOGON_THIRD_PARTY_DOMAIN");const xi=rn("PING_RWC_SERVER"),Ni=rn("MEETING_FAILOVER"),Mi=rn("LEAVE_MEETING"),Fi=rn("LEAVE_WAITING_ROOM"),Li=rn("END_MEETING");rn("REGISTER_WEBINAR");const Vi=rn("TRIGGER_IDLE_CHECK"),{setMeetingInfo:Bi,setMeetingJoinInfo:ji,setWindownOpen:Ui,setAppidSignature:Hi,setZtk:qi,setZsk:Ki,setTkMtkguid:$i,setPingRwcTimestamp:Wi,setInMeetingInfo:Gi,setMeetingAttribute:zi,resetMeeting:Ji,setIsHost:Qi,setIsCohost:Yi,setMeetingIsOnHold:Zi,setIsMeetingReset:Xi,setAudioVideoBeforeOnHold:eo,setCurrentUserAudioBeforeReset:to,setIsCurrentUserMutedBeforeReset:no,setMeetingStatus:ro,setMeetingRegion:io,setIsCurrentUserStartVideoBeforeReset:oo,setJoinMeetingTimeStamp:so,setActiveAppInfo:ao,setMeetingIdleStartTime:uo,setSessionIdleTimeoutMinutes:co,setIsAudioBridgeEnabled:lo,addDiscardedRwcHost:ho,setSharePronounType:po,setIsStayAwakeDuringTheSession:fo,setMeetingJoinSuccessTimestamp:go,resetFailoverRecord:mo,setFailoverReason:vo,setIsQuicklyLeaveMeetingAfterRefresh:yo,setMeetingInfoTimestamp:So,setIsEnableZmkFromRwg:bo}=In({SET_MEETING_INFO:e=>e,SET_MEETING_JOIN_INFO:e=>e,SET_WINDOWN_OPEN:e=>e,SET_APPID_SIGNATURE:e=>e,SET_ZTK:e=>e,SET_ZSK:e=>e,SET_TK_MTKGUID:e=>e,SET_PING_RWC_TIMESTAMP:e=>e,SET_IN_MEETING_INFO:e=>e,SET_MEETING_ATTRIBUTE:e=>{if(Oi.some((t=>e&&void 0!==e[t]))){let t=e;return Object.keys(Pi).some((t=>void 0!==e[t]))&&(t=Object.keys(e).reduce(((t,n)=>{const r=Pi[n];return"function"==typeof r?Object.assign(t,r(e[n])):"string"==typeof r?t[r]=e[n]:(t[n],e[n]),t}),{})),t}return{}},SET_IS_HOST:e=>e&&e.bHost,SET_IS_COHOST:e=>e&&e.bCoHost,RESET_MEETING:e=>e,SET_MEETING_IS_ON_HOLD:e=>e,SET_IS_MEETING_RESET:e=>e,SET_AUDIO_VIDEO_BEFORE_ON_HOLD:e=>e,SET_CURRENT_USER_AUDIO_BEFORE_RESET:e=>e,SET_IS_CURRENT_USER_MUTED_BEFORE_RESET:e=>e,SET_MEETING_STATUS:e=>e,SET_MEETING_REGION:e=>e,SET_IS_CURRENT_USER_START_VIDEO_BEFORE_RESET:e=>e,SET_JOIN_MEETING_TIME_STAMP:e=>e,SET_ACTIVE_APP_INFO:e=>e,SET_MEETING_IDLE_START_TIME:e=>e,SET_SESSION_IDLE_TIMEOUT_MINUTES:e=>e,SET_IS_AUDIO_BRIDGE_ENABLED:e=>e,ADD_DISCARDED_RWC_HOST:e=>e,SET_SHARE_PRONOUN_TYPE:e=>e,SET_IS_STAY_AWAKE_DURING_THE_SESSION:e=>e,SET_MEETING_JOIN_SUCCESS_TIMESTAMP:e=>e,RESET_FAILOVER_RECORD:e=>e,SET_FAILOVER_REASON:e=>e,SET_IS_QUICKLY_LEAVE_MEETING_AFTER_REFRESH:e=>e,SET_MEETING_INFO_TIMESTAMP:e=>e,SET_IS_ENABLE_ZMK_FROM_RWG:e=>e});let Eo=function(e){return e.Failover="failover",e.OnHold="on hold",e.Promote="promote",e.Depromote="depromote",e.JoinBreakoutRoom="join breakout room",e.MoveToBreakoutRoom="move to breakout room",e.BackToMainSession="back to main session",e}({});const wo="js_media.min.js";let Io=function(e){return e.CDN="CDN",e.Global="Global",e.CN="CN",e}({}),_o=function(e){return e.Connected="Connected",e.Reconnecting="Reconnecting",e.Closed="Closed",e.Fail="Fail",e}({}),Co=function(e){return e.Initial="initial",e.Joined="joined",e.Closed="closed",e}({}),Ao=function(e){return e.AudioBridgeEnable="M:1,2;V:1,2",e.AudioDecodeInWorklet="M:6;V:3",e.VideoFullHD="M:8;V:4",e.VideoShareFullHD="M:9;V:5",e.WebGL2Render="M:20;V:8",e.WebGPURender="M:21;V:9",e.ZMKFromRWG="M:19;V:10",e}({}),To=function(e){return e[e.NormalCase=-1]="NormalCase",e[e.NoHeartbeat=0]="NoHeartbeat",e[e.NoHeartbeatMChannel=1]="NoHeartbeatMChannel",e[e.NetworkChange=2]="NetworkChange",e[e.NotifyUiFailover=3]="NotifyUiFailover",e[e.InvalidParameters=4]="InvalidParameters",e[e.OnError=5]="OnError",e[e.OnErrorMChannel=6]="OnErrorMChannel",e[e.Disconnect=7]="Disconnect",e[e.DisconnectMChannel=8]="DisconnectMChannel",e[e.DisconnectXmpp=9]="DisconnectXmpp",e[e.RefreshPage=10]="RefreshPage",e}({});const Ro=["8-29","9-21"];let Oo=function(e){return e.LocalStorage="LocalStorage",e.SessionStorage="SessionStorage",e.Memory="Memory",e}({});const Po=ri("{}");class Do{constructor(e){this.sessionStorageKey=void 0,this.localStorageKey=void 0,this.sessionCache=void 0,this.localCache=void 0,this.memoryCache=void 0,this.sessionStorageKey=ri(`zoom-storage-${e}`),this.localStorageKey=ri("zoom-local-storage"),this.memoryCache={};try{this.sessionCache=JSON.parse(ii(sessionStorage.getItem(this.sessionStorageKey)||Po)),this.localCache=JSON.parse(ii(localStorage.getItem(this.localStorageKey)||Po))}catch(e){console.error(e),this.sessionCache={},this.localCache={}}}static init(e){this.instance=new Do(e)}static get(e){if(void 0===this.instance)throw new Error("read before initial");return this.instance.getValue(e).value}static set(e,t,n){if(void 0===this.instance)throw new Error("set before initial");return this.instance.setValue(e,t,n)}static remove(e){if(void 0===this.instance)throw new Error("remove before initial");return this.instance.removeValue(e)}static clearSession(){if(void 0===this.instance)throw new Error("clear before initial");return this.instance.memoryCache={},this.instance.sessionCache={},this.instance.localCache={},sessionStorage.removeItem(this.instance.sessionStorageKey)}getValue(e){return this.sessionCache.hasOwnProperty(e)?{value:this.sessionCache[e],type:Oo.SessionStorage}:this.localCache.hasOwnProperty(e)?{value:this.localCache[e],type:Oo.LocalStorage}:{value:this.memoryCache[e],type:Oo.Memory}}setValue(e,t,n){if(!e)throw new Error("key is null");switch(n){case Oo.SessionStorage:{const n=this.sessionCache[e];let r=t;return"function"==typeof t&&(r=t(n)),n!==r&&(this.sessionCache[e]=r,this.flushValue(Oo.SessionStorage)),r}case Oo.LocalStorage:{const n=this.localCache[e];let r=t;return"function"==typeof t&&(r=t(n)),n!==r&&(this.localCache[e]=r,this.flushValue(Oo.LocalStorage)),r}case Oo.Memory:{const n=this.memoryCache[e];let r=t;return"function"==typeof t&&(r=t(n)),this.memoryCache[e]=r,r}default:return null}}removeValue(e){const{type:t}=this.getValue(e);switch(t){case Oo.SessionStorage:delete this.sessionCache[e],this.flushValue(Oo.SessionStorage);break;case Oo.LocalStorage:delete this.localCache[e],this.flushValue(Oo.LocalStorage);break;case Oo.Memory:delete this.memoryCache[e]}}flushValue(e){e===Oo.SessionStorage?sessionStorage.setItem(this.sessionStorageKey,ri(JSON.stringify(this.sessionCache))):e===Oo.LocalStorage&&localStorage.setItem(this.localStorageKey,ri(JSON.stringify(this.localCache)))}}Do.instance=void 0;let ko=function(e){return e.WebclientOpt="WEB_CLIENT_OPT",e.WebclientWebinarToken="WEB_CLIENT_WEBINAR_TOKEN",e.WebclientMeetingToken="WEB_CLIENT_MEETING_TOKEN",e.WebclientZtk="WEB_CLIENT_ZTK",e.WebclientZsk="WEB_CLIENT_ZSK",e.WebclientTk="WEB_CLIENT_TK",e.WebclientIVState="WEB_CLIENT_IV_STATE",e.WebclientIsOnHold="WEB_CLIENT_IS_ON_HOLD",e.WebclientParticipantId="WEB_CLIENT_PARTICIPANT_ID",e.WebclientZoomId="WEB_CLIENT_ZOOM_ID",e.WebclientUserName="WEB_CLIENT_USER_NAME",e.WebclientUserEmail="WEB_CLIENT_USER_EMAIL",e.WebclientBreakoutRoomAttendeeStatus="WEB_CLIENT_BO_ATTENDEE_STATUS",e.WebclientBreakoutRoomCommand="WEB_CLIENT_BO_COMMAND",e.WebclientAudioEncryptKey="WEB_CLIENT_AUDIO_ENCRYPT_KEY",e.WebclientVideoEncryptKey="WEB_CLIENT_VIDEO_ENCRYPT_KEY",e.WebclientSharingEncryptKey="WEB_CLIENT_SHARING_ENCRYPT_KEY",e.WebclientFailoverCount="WEB_CLIENT_FAILOVER_COUNT",e.WebclientRecordingToken="WEB_CLIENT_RECORDING_TOKEN",e}({}),xo=function(e){return e.WebclientDeviceId="WEBCLIENT_DEVICE_ID",e.VSDKLogTrackingId="ZM_VSDK_LOG_TRACKING_IDS",e}({}),No=function(e){return e.EnforceWebRTCAudio="ENFORCE_WEB_RTC_AUDIO",e.DisableAutoReportLogs="DISABLE_AUTO_REPORT_LOGS",e}({});function Mo(e,t){const n=t.match(e);return n&&n.length>0&&n[1]||""}function Fo(e,t){const n=t.match(e);return n&&n.length>1&&n[2]||""}const Lo=/version\/(\d+(\.?_?\d+)+)/i,Vo=[{test:[/opera/i],describe:e=>["Opera(Legacy)",Mo(Lo,e)||Mo(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e)]},{test:[/opr\/|opios/i],describe:e=>["Opera",Mo(/(?:opr|opios)[\s/](\S+)/i,e)||Mo(Lo,e)]},{test:[/SamsungBrowser/i],describe:e=>["Samsung Internet for Android",Mo(Lo,e)||Mo(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e)]},{test:[/micromessenger/i],describe:e=>["WeChat",Mo(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||Mo(Lo,e)]},{test:[/qqbrowser/i],describe:e=>[/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser",Mo(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||Mo(Lo,e)]},{test:[/msie|trident/i],describe:e=>["Internet Explorer",Mo(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e)]},{test:[/\sedg\//i],describe:e=>["Microsoft Edge",Mo(/\sedg\/(\d+(\.?_?\d+)+)/i,e)]},{test:[/edg([ea]|ios)/i],describe:e=>["Microsoft Edge(Legacy)",Fo(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e)]},{test:[/firefox|iceweasel|fxios/i],describe:e=>["Firefox",Mo(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e)]},{test:[/electron/i],describe:e=>["Electron",Mo(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e)]},{test:[/chromium/i],describe:e=>["Chromium",Mo(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||Mo(Lo,e)]},{test:[/chrome|crios|crmo/i],describe:e=>["Chrome",Mo(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e)]},{test:e=>!/like android/i.test(e)&&/android/i.test(e),describe:e=>["Android Browser",Mo(Lo,e)]},{test:[/safari|applewebkit/i],describe:e=>["Safari",Mo(Lo,e)]}],Bo=[{test:[/windows /i],describe:e=>["Windows",Mo(/Windows ((NT|XP)( \d\d?.\d)?)/i,e)]},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:e=>["iOS",Fo(/(Version\/)(\d[\d.]+)/,e)]},{test:[/macintosh/i],describe:e=>["macOS",Mo(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,".")]},{test:[/(ipod|iphone|ipad)/i],describe:e=>["iOS",Mo(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".")]},{test:e=>!/like android/i.test(e)&&/android/i.test(e),describe:e=>["Android",Mo(/android[\s/-](\d+(\.\d+)*)/i,e)]},{test:[/linux/i],describe:()=>["Linux"]},{test:[/CrOS/],describe:()=>["Chrome OS"]}];class jo{constructor(){this.value=void 0,this.gpu=void 0}get isSupported(){if(void 0===this.value)if("function"==typeof window.OffscreenCanvas){const e=new OffscreenCanvas(1,1);e.addEventListener("webglcontextlost",(e=>{e.preventDefault()}));const t=e.getContext("webgl");if(this.value=!!t,t){const e=t.getExtension("WEBGL_debug_renderer_info");e&&(this.gpu=t.getParameter(e.UNMASKED_RENDERER_WEBGL))}}else this.value=!1;return this.value}}const Uo=new class{constructor(){this._browser=void 0,this._os=void 0,this._browserVersion=void 0,this._osVersion=void 0,this._offscreenCanvasCapality=void 0,this._clientHintsData=void 0,this._offscreenCanvasCapality=new jo,"userAgentData"in navigator&&navigator.userAgentData.getHighEntropyValues(["architecture","bitness","formFactor","model","platformVersion","wow64"]).then((e=>{this._clientHintsData=e,this._os&&this._osVersion&&this._clientHintsData.platform&&this._clientHintsData.platformVersion&&(this._os=this._clientHintsData.platform,this._osVersion=this._clientHintsData.platformVersion)})).catch((e=>{console.warn(e)}))}_getBrowserVersion(){var e,t;if(null!==(e=this._clientHintsData)&&void 0!==e&&null!==(t=e.brands)&&void 0!==t&&t.length){const e=this._clientHintsData.brands.filter((e=>!/(Chromium|Not.*Brand)/i.test(e.brand)))[0];e&&(this._browser=e.brand);const t=this._clientHintsData.brands.find((e=>{var t;return"chromium"===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())}));t?(this._browserVersion=t.version,this._browser||(this._browser=t.brand)):this._browserVersion=e.version}else{const e=navigator.userAgent,t=Vo.find((t=>"function"==typeof t.test?t.test(e):t.test.some((t=>t.test(e)))));if(t){const n=t.describe(e);this._browser=n[0],this._browserVersion=n[1],this.isIOSMobile&&(this._browser="ios-safari")}else this._browser="unknown",this._browserVersion="0"}}_getOSVersion(){var e,t;if(null!==(e=this._clientHintsData)&&void 0!==e&&e.platform&&null!==(t=this._clientHintsData)&&void 0!==t&&t.platformVersion)this._os=this._clientHintsData.platform,this._osVersion=this._clientHintsData.platformVersion;else{const e=navigator.userAgent,t=Bo.find((t=>"function"==typeof t.test?t.test(e):t.test.some((t=>t.test(e)))));if(t){const n=t.describe(e);this._os=n[0],this._osVersion=n[1]}else this._os="unknown",this._osVersion="0"}}get browser(){return this._browser||this._getBrowserVersion(),this._browser}get browserVersion(){return this._browserVersion||this._getBrowserVersion(),this._browserVersion}get os(){return this._os||this._getOSVersion(),this._os}get osVersion(){return this._osVersion||this._getOSVersion(),this._osVersion}get isIE(){return"Internet Explorer"===this.browser}get isLegacyEdge(){return"Microsoft Edge(Legacy)"===this.browser}get isLegacyOpera(){return"Opera(Legacy)"===this.browser}get isFirefox(){return"Firefox"===this.browser}get isSafari(){return"Safari"===this.browser}get isChrome(){var e,t,n;if(null!==(e=this._clientHintsData)&&void 0!==e&&null!==(t=e.brands)&&void 0!==t&&t.length)return null===(n=this._clientHintsData)||void 0===n?void 0:n.brands.some((e=>{var t;return"chromium"===(null===(t=e.brand)||void 0===t?void 0:t.toLocaleLowerCase())}));const{userAgent:r}=navigator;return!this.isLegacyOpera&&!this.isLegacyEdge&&/chrome/i.test(r)&&/webkit/i.test(r)}get isLegacyChrome(){var e;return this.isChrome&&"function"!=typeof(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getDisplayMedia)}get isMacOS(){return"macOS"===this.os}get isIPad(){var e;return/iPad/i.test(navigator.userAgent)||this.isMacOS&&(null===(e=navigator)||void 0===e?void 0:e.maxTouchPoints)>2}get isIOSMobile(){return"iOS"===this.os||this.isIPad}get architecture(){var e,t;return null!==(e=null===(t=this._clientHintsData)||void 0===t?void 0:t.architecture)&&void 0!==e?e:""}get isArm(){return this.architecture?"arm"===this.architecture:/arm/i.test(navigator.userAgent)}get isChromeOS(){return"Chrome OS"===this.os}get isAndroidBrowser(){var e;return"android"===(null===(e=this.os)||void 0===e?void 0:e.toLowerCase())}get isArmChromeOS(){return this.isArm&&this.isChromeOS}get isAndroidOrIOSBrowser(){return this.isAndroidBrowser||this.isIOSMobile}get isSupportEssentialAudioAndVideoAbility(){return"object"==typeof WebAssembly&&"function"==typeof Worker}get isSupportAudioWorklet(){return"function"==typeof AudioWorklet}get isSupportImageCapture(){return"ImageCapture"in window}get isSupportMediaStreamTrackProcessor(){return"MediaStreamTrackProcessor"in window}get isSupportOffscreenCanvas(){return this._offscreenCanvasCapality.isSupported}get gpu(){return this._offscreenCanvasCapality.isSupported?this._offscreenCanvasCapality.gpu:""}get bitness(){var e,t;return null!==(e=null===(t=this._clientHintsData)||void 0===t?void 0:t.bitness)&&void 0!==e?e:""}get model(){var e,t;return null!==(e=null===(t=this._clientHintsData)||void 0===t?void 0:t.model)&&void 0!==e?e:""}get wow64(){var e;if("windows"===this.os.toLowerCase())return null===(e=this._clientHintsData)||void 0===e?void 0:e.wow64}get isSupportSendScreenSharing(){return"getDisplayMedia"in navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getDisplayMedia}};function Ho(){return Uo.isAndroidOrIOSBrowser||!!Do.get(No.EnforceWebRTCAudio)}const qo=()=>Uo.isIE,Ko=()=>{var e;return Uo.isSupportOffscreenCanvas&&(null===(e=navigator)||void 0===e?void 0:e.hardwareConcurrency)>=4&&"function"==typeof requestAnimationFrame&&"function"==typeof SharedArrayBuffer},$o=(e,t)=>{var n;const{isSafari:r,isIOSMobile:i,isSupportMediaStreamTrackProcessor:o,isAndroidOrIOSBrowser:s,isArmChromeOS:a,isChromeOS:u,isArm:c,isSupportOffscreenCanvas:l,isIPad:d}=Uo;if(!Ko()){const n=r||i,s="function"!=typeof window.SharedArrayBuffer&&(!!n||o&&l);return e&&s?t?25:4:1}return s?t?25:d?9:4:a||u&&!c?navigator.hardwareConcurrency>=4?9:4:(null===(n=navigator)||void 0===n?void 0:n.hardwareConcurrency)<4?9:25};function Wo(){var e;return"webkit"in window&&!("chrome"in window)&&!(null===(e=window.webkit.messageHandlers)||void 0===e||!e.jsOCHelper)}function Go(){var e;const{isAndroidBrowser:t,isIOSMobile:n,osVersion:r,browserVersion:i,isChrome:o,isFirefox:s,isSafari:a}=Uo;var u,c;if(n)return Number(null===(u=r.match(/^\d+/))||void 0===u?void 0:u[0])>=15;if(t)return Number(null===(c=r.match(/^\d+/))||void 0===c?void 0:c[0])>=10;const l=Number(null===(e=i.match(/^\d+/))||void 0===e?void 0:e[0]);return!!(o&&l>=69)||!!(a&&l>14)||!!(s&&l>=76)}let zo=function(e){return e.VIDEO_ENCODE="0",e.VIDEO_DECODE="1",e.AUDIO_ENCODE="2",e.AUDIO_DECODE="3",e.SHARING_ENCODE="4",e.SHARING_DECODE="5",e}({}),Jo=function(e){return e[e.NONE=0]="NONE",e[e.AES_256=1]="AES_256",e[e.AES_GCM=2]="AES_GCM",e}({});const Qo=Object.freeze({RWG_CHAT:{gcmType:1,sessionType:"RWG_CHAT"},XMPP_CHAT:{gcmType:1,sessionType:"XMPP_CHAT"},CC_MESSAGE:{gcmType:3,sessionType:"CC_MESSAGE"},BO_BROADCAST:{gcmType:1,sessionType:"BO_BROADCAST"},CHAT_FILE:{gcmType:2,sessionType:"CHAT_FILE"},CHAT_FILE_INFO:{gcmType:1,sessionType:"CHAT_FILE_INFO"}}),Yo=(window.crypto||window.msCrypto).subtle,Zo=ko.WebclientIVState,Xo=Object.keys(Qo).map((e=>Qo[e].sessionType));class es{constructor(e,t,n){this.isGCMEnabled=void 0,this.gcmSessionKey=void 0,this.gcmMainSessionKey=void 0,this.zoomId=void 0,this.resetParameters(e,t,n),Do.set(Zo,{},Oo.SessionStorage)}static init(e,t,n){this.instance?this.instance.resetParameters(e,t,n):this.instance=new es(e,t,n)}static destroy(){this.instance&&(this.instance=void 0)}resetParameters(e,t,n){this.isGCMEnabled=!(Uo.isIE||!Uo.isSupportEssentialAudioAndVideoAbility)&&n===Jo.AES_GCM,this.gcmSessionKey=ai(t),this.gcmMainSessionKey||(this.gcmMainSessionKey=this.gcmSessionKey),this.zoomId=String(e)}beginCrypto(e,t,n){const r=new Uint32Array(1);r[0]=9,r[0]+=Number(n);const i=new Uint8Array(r.buffer);let o=new Uint8Array(132);const s=ai(t);return o.set(s,0),o.set(i,s.length),o=o.subarray(0,s.length+4),Yo.importKey("raw",e,{name:"HMAC",hash:"SHA-256"},!0,["sign"]).then((e=>Yo.sign({name:"HMAC"},e,o))).then((e=>Yo.importKey("raw",e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])))}getNextIV(e){const t=Do.get(Zo);return void 0===t[e]?(t[e]=0,Do.set(Zo,t,Oo.SessionStorage)):Do.set(Zo,(t=>({...t,[e]:t[e]+1})),Oo.SessionStorage)}resetIVState(){const e=Do.get(Zo);if(void 0===e);else{const t=Object.keys(e).filter((e=>Xo.indexOf(e)>-1));t.length>0&&(t.forEach((t=>{e[t]+=1e6})),Do.set(Zo,e,Oo.SessionStorage))}}static resetIV(){if(void 0===this.instance)throw new Error("reset before intialize");this.instance.resetIVState()}static beginEncrypt(e){let{text:t,type:n}=e;const r=new Uint8Array(0);if(this.instance&&this.instance.isGCMEnabled){const e=16,i=12,o=this.instance.getNextIV(n.sessionType),s=new ArrayBuffer(i),a=new Uint8Array(s);new DataView(s).setUint32(0,o,!0);let u=null;return u="BO_BROADCAST"===n.sessionType||"XMPP_CHAT"===n.sessionType?this.instance.gcmMainSessionKey:this.instance.gcmSessionKey,this.instance.beginCrypto(u,this.instance.zoomId,n.gcmType).then((n=>{const i=ArrayBuffer.isView(t)?t:(new TextEncoder).encode(t);return Yo.encrypt({name:"AES-GCM",iv:a,additionalData:r,tagLength:8*e},n,i)})).then((t=>{const i=1+a.byteLength+2+r.byteLength+4+t.byteLength,o=new ArrayBuffer(i);if(new Uint8Array(o)[0]=a.length,new Uint8Array(o,1,a.byteLength).set(a),new DataView(o).setUint16(1+a.byteLength,r.length,!0),new Uint8Array(o,3+a.byteLength).set(r),new DataView(o).setUint32(1+a.byteLength+2+r.byteLength,t.byteLength-e,!0),new Uint8Array(o,1+a.byteLength+2+r.byteLength+4).set(new Uint8Array(t)),n.sessionType===Qo.CHAT_FILE.sessionType)return o;const s=new Uint8Array(o).reduce(((e,t)=>e+String.fromCharCode(t)),"");return window.btoa(s).replace(/_/g,"/").replace(/-/g,"+").replace(/\=/g,"")}))}return Promise.resolve(ArrayBuffer.isView(t)?t:ri(t))}static beginDecrypt(e){let{decryptedText:t,type:n,zoomId:r}=e;if(this.instance&&this.instance.isGCMEnabled){const e=ArrayBuffer.isView(t)||t instanceof ArrayBuffer?new Uint8Array(t):function(e){let t;const n=e.length,r=new Array(n);for(t=0;t<n;++t)r[t]=255&e.charCodeAt(t);return new Uint8Array(r)}(atob(t.replace(/_/g,"/").replace(/-/g,"+"))),i=e[0],o=e.slice(1,i+1),s=e.slice(1+i,3+i),a=new DataView(s.buffer).getUint16(0,!0),u=e.slice(1+i+2,1+i+2+a),c=e.slice(1+i+2+a,1+i+2+a+4),l=new DataView(c.buffer).getUint32(0,!0),d=e.slice(1+i+2+a+4,1+i+2+a+4+l),h=e.slice(1+i+2+a+4+l);let p=null;return p="BO_BROADCAST"===n.sessionType||"XMPP_CHAT"===n.sessionType?this.instance.gcmMainSessionKey:this.instance.gcmSessionKey,this.instance.beginCrypto(p,r,n.gcmType).then((e=>{const t=function(e,t){e=new Uint8Array(e),t=new Uint8Array(t);const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(d,h);return Yo.decrypt({name:"AES-GCM",iv:o,additionalData:u,tagLength:8*h.length},e,t.buffer)})).then((e=>({message:n.sessionType===Qo.CHAT_FILE.sessionType?e:(new TextDecoder).decode(e),iv:o,aad:u}))).catch((e=>({message:"[This is an encrypted message]",iv:o,aad:u})))}{const e=new TextDecoder("utf-8");return Promise.resolve({message:ArrayBuffer.isView(t)||t instanceof ArrayBuffer?t:e.decode(ai(t))})}}}es.instance=void 0;const ts=20225,ns=20234,rs=7937,is=7938,os=12039,ss=16138,as=4098,us=4305,cs=4343,ls=16428;let ds=function(e){return e[e.NoAttendee=0]="NoAttendee",e[e.All=1]="All",e[e.AllPanelist=2]="AllPanelist",e[e.Host=3]="Host",e[e.NoOne=4]="NoOne",e[e.EveryonePublicly=5]="EveryonePublicly",e}({}),hs=function(e){return e[e.AllPanelist=1]="AllPanelist",e[e.Everyone=2]="Everyone",e[e.Invalid=0]="Invalid",e}({}),ps=function(e){return e[e.All=0]="All",e[e.Panelist=1]="Panelist",e[e.IndividualCcPanelist=2]="IndividualCcPanelist",e[e.Individual=3]="Individual",e[e.SilentModeUsers=4]="SilentModeUsers",e}({}),fs=function(e){return e[e.None=0]="None",e[e.Delete=1]="Delete",e[e.Modify=2]="Modify",e}({}),gs=function(e){return e[e.Success=0]="Success",e[e.Delete=1]="Delete",e[e.Block=3]="Block",e}({});const ms=[ds.All,ds.Host,ds.NoOne,ds.EveryonePublicly],vs=[ds.NoOne,ds.All,ds.AllPanelist],ys={AllPanelist:11,Everyone:12},Ss={[ys.AllPanelist]:hs.AllPanelist,[ys.Everyone]:hs.Everyone},bs={userId:ps.All,displayName:"Everyone",isHost:!1,isCoHost:!1},Es={userId:ps.Panelist,displayName:"All panelists"},ws={userId:ps.SilentModeUsers,displayName:"Everyone (in Waiting Room)",isHost:!1,isCoHost:!1};let Is=function(e){return e[e.Local=0]="Local",e[e.ThirdParty=1]="ThirdParty",e}({}),_s=function(e){return e[e.ChunkSize=20971520]="ChunkSize",e[e.EncodeBlockSize=32768]="EncodeBlockSize",e[e.DecodeBlockSize=32803]="DecodeBlockSize",e[e.MaxSize=2147483648]="MaxSize",e[e.ReaderChunkSize=1073741824]="ReaderChunkSize",e}({}),Cs=function(e){return e[e.Init=0]="Init",e[e.InProgress=1]="InProgress",e[e.Success=2]="Success",e[e.Fail=3]="Fail",e[e.Cancel=4]="Cancel",e[e.Complete=5]="Complete",e}({}),As=function(e){return e[e.InProgress=1]="InProgress",e[e.Success=2]="Success",e[e.Fail=3]="Fail",e[e.Cancel=4]="Cancel",e}({});const Ts={"7z":"application/x-7z-compressed",avi:"video/x-msvideo",bin:"application/octet-stream",bmp:"image/bmp",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",gif:"image/gif",gz:"application/gzip",html:"text/html",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",mid:"audio/midi",mov:"video/*",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/*",mpg:"video/*",pdf:"application/pdf",png:"image/png",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/wav",webp:"image/webp",wma:"audio/*",wmv:"video/*",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",zip:"application/zip"};let Rs=function(e){return e.Open="open",e.Message="message",e.Error="error",e.Close="close",e.Inactive="inactive",e}({});class Os{constructor(){this.eventHandlers=void 0,this.websocket=void 0,this.seq=void 0,this.intervalsToBeCleardWhenSocketClose=[],this.isAlive=!1,this.eventHandlers=new Map,this.websocket=null,this.seq=1}on(e,t){let n=this.eventHandlers.get(e);n||(n=[]),n.push(t),this.eventHandlers.set(e,n)}off(e,t){const n=this.eventHandlers.get(e);if(n){const r=n.filter((e=>e!==t));this.eventHandlers.set(e,r)}}emit(e,t){const n=this.eventHandlers.get(e);n&&n instanceof Array&&n.slice(0).forEach((e=>{try{e(t)}catch(e){console.error(e)}}))}sendMessageToRwg(e){this.seq+=1;const t=this.seq;return this.websocket&&this.websocket.readyState===WebSocket.OPEN&&this.websocket.send(JSON.stringify(Object.assign(e,{seq:t}))),t}connect(e){this.websocket=new WebSocket(e),this.websocket.binaryType="arraybuffer",this.addWebSocketEventListeners()}close(){var e;null===(e=this.websocket)||void 0===e||e.close()}addHeartBeat(){const e=Uo.isAndroidOrIOSBrowser?15e3:2e4,t=setInterval((()=>{this.isAlive||this.emit(Rs.Inactive,{}),this.sendMessageToRwg({evt:0}),this.isAlive=!1}),e);this.intervalsToBeCleardWhenSocketClose.push(t)}clearIntervals(){this.intervalsToBeCleardWhenSocketClose.forEach((e=>clearInterval(e))),this.isAlive=!1}addWebSocketEventListeners(){this.websocket&&(this.websocket.addEventListener("open",(e=>{this.addHeartBeat(),this.emit(Rs.Open,e)})),this.websocket.addEventListener("message",(e=>{this.isAlive=!0,this.emit(Rs.Message,e)})),this.websocket.addEventListener("close",(e=>{this.clearIntervals(),this.emit(Rs.Close,e)})),this.websocket.addEventListener("error",(e=>{this.clearIntervals(),this.emit(Rs.Error,e)})))}sendLaunchParams(e){return{seq:this.sendMessageToRwg({evt:4301,body:e})}}joinMeeting(e){return{seq:this.sendMessageToRwg({evt:4097,body:{meetingtoken:e}})}}lockMeeting(e){return{seq:this.sendMessageToRwg({evt:4099,body:{bLock:e}})}}endMeeting(){return{seq:this.sendMessageToRwg({evt:4101,body:{}})}}leaveMeeting(){const e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?4364:4103;return{seq:this.sendMessageToRwg({evt:e,body:{}})}}recordMeeting(e,t){return{seq:this.sendMessageToRwg({evt:4105,body:{bRecord:e,bPause:t}})}}localRecordingGrantPermission(e,t,n){return{seq:this.sendMessageToRwg({evt:cs,body:{cmdType:"permission_request_answer",userId:e,agreed:t,saveAgreed:n}})}}hostGrantPermission(e,t){return{seq:this.sendMessageToRwg({evt:cs,body:{cmdType:"grant_permission",userId:e,grant:t}})}}localRecordingRequestPermission(){return{seq:this.sendMessageToRwg({evt:cs,body:{cmdType:"request_permission"}})}}localRecordingMeeting(e){return{seq:this.sendMessageToRwg({evt:cs,body:{cmdType:"change_recording_status",status:e}})}}summaryMeeting(e){return{seq:this.sendMessageToRwg({evt:8009,body:{type:e?"start":"stop"}})}}startMeetingQuery(e){return{seq:this.sendMessageToRwg({evt:8017,body:{type:e?"start":"stop"}})}}allowSelfRecord(e){return{seq:this.sendMessageToRwg({evt:4325,body:{bAllowISORecord:e}})}}enableZoomIQRecord(e){return{seq:this.sendMessageToRwg({evt:4318,body:{check:e}})}}expel(e){return{seq:this.sendMessageToRwg({evt:4107,body:{id:e}})}}expelAttendee(e){return{seq:this.sendMessageToRwg({evt:4205,body:{jid:e}})}}rename(e,t,n){return{seq:this.sendMessageToRwg({evt:4109,body:{id:e,dn2:t,olddn2:n}})}}assignHost(e,t){return{seq:this.sendMessageToRwg({evt:4111,body:{id:e,bCoHost:t}})}}reclaimHost(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{seq:this.sendMessageToRwg({evt:4133,body:{id:e,bCoHost:t}})}}revokeCoHost(e){return{seq:this.sendMessageToRwg({evt:4195,body:{id:e}})}}putOnHold(e,t){return{seq:this.sendMessageToRwg({evt:4113,body:{id:e,bHold:t}})}}setMuteOnEntry(e){return{seq:this.sendMessageToRwg({evt:4115,body:{bOn:e}})}}setHoldOnEntry(e){return{seq:this.sendMessageToRwg({evt:4117,body:{bOn:e}})}}inviteCRCDevice(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return{seq:this.sendMessageToRwg({evt:4119,body:{ip:e,type:t,encrypt:n}})}}cancelInviteCRCDevice(e){return{seq:this.sendMessageToRwg({evt:4121,body:{transID:e}})}}sendCloseCaption(e){return{seq:this.sendMessageToRwg({evt:4125,body:{...e}})}}allowViewParticipantNumber(e){return{seq:this.sendMessageToRwg({evt:4127,body:{bOn:e}})}}lowerAllHands(){return{seq:this.sendMessageToRwg({evt:4129,body:{}})}}raiseLowerHand(e,t){return{seq:this.sendMessageToRwg({evt:4131,body:{id:e,bOn:t}})}}chat(e,t,n,r){const i={text:e,destNodeID:t};return n&&Object.assign(i,{sn:n}),r&&Object.assign(i,{attendeeNodeID:r}),{seq:this.sendMessageToRwg({evt:4135,body:i})}}assignCC(e,t){return{seq:this.sendMessageToRwg({evt:4137,body:{id:e,bCCEditor:t}})}}enableLT(e){return{seq:this.sendMessageToRwg({evt:4227,body:{op:e?2:4}})}}enableNewLLT(){return{seq:this.sendMessageToRwg({evt:4285})}}disableCaptions(e){return{seq:this.sendMessageToRwg({evt:us,body:{type:4,disableNewLtt:e}})}}enableManualCaption(e){return{seq:this.sendMessageToRwg({evt:4291,body:{op:e?1:0}})}}setTranslationLanguage(e){return void 0!==e?{seq:this.sendMessageToRwg({evt:us,body:{type:1,lang:e}})}:{seq:this.sendMessageToRwg({evt:us,body:{type:3}})}}setSpokenLanguage(e){return{seq:this.sendMessageToRwg({evt:4287,body:{lang:e}})}}allowAskLT(e){return{seq:this.sendMessageToRwg({evt:4263,body:{bAnonymous:e}})}}approveLT(){return{seq:this.sendMessageToRwg({evt:4262,body:{bApproved:!0}})}}askLT(e){return{seq:this.sendMessageToRwg({evt:4261,body:{bAnonymous:e}})}}setChatPriviledge(e){return{seq:this.sendMessageToRwg({evt:4141,body:{chatPriviledge:e}})}}setPanelistChatPrivilege(e){if(!Object.values(ys).includes(e))throw Error("Invalid panelist chat privilege req value");return{seq:this.sendMessageToRwg({evt:4141,body:{chatPriviledge:e}})}}sendFeedback(e){return{seq:this.sendMessageToRwg({evt:4143,body:{feedback:e}})}}clearFeedback(){return{seq:this.sendMessageToRwg({evt:4145,body:{}})}}allowUnmuteVideo(e){return{seq:this.sendMessageToRwg({evt:4147,body:{bOn:e}})}}allowUnmuteAudio(e){return{seq:this.sendMessageToRwg({evt:4149,body:{bOn:e}})}}allowRaiseHand(e){return{seq:this.sendMessageToRwg({evt:4151,body:{bOn:e}})}}boToken(e){return{seq:this.sendMessageToRwg({evt:4173,body:{topic:e}})}}startBO(e){return{seq:this.sendMessageToRwg({evt:4175,body:{proto:e}})}}stopBO(e){return{seq:this.sendMessageToRwg({evt:4177,body:{status:e}})}}assignToBO(e,t){return{seq:this.sendMessageToRwg({evt:4179,body:{targetID:e,targetBID:t}})}}switchBO(e,t){return{seq:this.sendMessageToRwg({evt:4181,body:{targetID:e,targetBID:t}})}}wantJoinBO(e,t){return{seq:this.sendMessageToRwg({evt:4183,body:{targetID:e,targetBID:t}})}}joinBO(e){return{seq:this.sendMessageToRwg({evt:4193,body:{targetBID:e}})}}leaveBO(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{seq:this.sendMessageToRwg({evt:4185,body:{reason:e}})}}broadcastBO(e){return{seq:this.sendMessageToRwg({evt:4187,body:{textContent:e}})}}askForHelpBO(e){return{seq:this.sendMessageToRwg({evt:4189,body:{targetID:e}})}}askForHelpResultBO(e,t){return{seq:this.sendMessageToRwg({evt:4191,body:{targetID:e,helpResult:t}})}}coHostStartBO(e,t){return{seq:this.sendMessageToRwg({evt:4241,body:{proto:e,targetID:t}})}}coHostStopBO(e,t){return{seq:this.sendMessageToRwg({evt:4243,body:{status:e,targetID:t}})}}coHostAssignToBO(e,t,n){return{seq:this.sendMessageToRwg({evt:4245,body:{userGUID:e,targetID:n,targetBID:t}})}}moveToMainSession(e){return{seq:this.sendMessageToRwg({evt:4247,body:{userGUID:e}})}}coHostMoveToMainSession(e,t){return{seq:this.sendMessageToRwg({evt:4249,body:{userGUID:e,targetID:t}})}}allowParticipantRename(e){return{seq:this.sendMessageToRwg({evt:4163,body:{bOn:e}})}}allowMessageFeedbackNotify(e,t){return{seq:this.sendMessageToRwg({evt:4171,body:{bOn:e,id:t}})}}setPlayChime(e,t){return{seq:this.sendMessageToRwg({evt:4197,body:{bOn:e,id:t}})}}admitAllSilentUsers(){return{seq:this.sendMessageToRwg({evt:4199,body:{}})}}bindTeleUser(e,t,n){return{seq:this.sendMessageToRwg({evt:4201,body:{teleUserID:e,targetUserID:t,bBind:n}})}}practiceSession(){return{seq:this.sendMessageToRwg({evt:4207,body:null})}}roleChangeWebinar(e,t,n,r){return{seq:this.sendMessageToRwg({evt:4209,body:{jid:t,userID:n,clientCap:r,bPromote:e}})}}sendPromoteConsent(e,t){return{seq:this.sendMessageToRwg({evt:4254,body:{agreed:e,req_id:t}})}}batchCreateBOToken(e){const t=e.map(((e,t)=>({topic:e,index:t})));return{seq:this.sendMessageToRwg({evt:4211,body:t})}}mute(e,t){return{seq:this.sendMessageToRwg({evt:8193,body:{bMute:t,id:e}})}}audioDrop(e){return{seq:this.sendMessageToRwg({evt:8195,body:{id:e}})}}audioDialout(e,t,n,r,i){return{seq:this.sendMessageToRwg({evt:8197,body:{pn:e,dn2:ri(t),bCallme:n,bPressOne:r,bGreeting:i}})}}audioCancelDialout(e,t){return{seq:this.sendMessageToRwg({evt:8199,body:{pn:e,bCallme:t}})}}audioMuteAll(e){return{seq:this.sendMessageToRwg({evt:8201,body:{bMute:e}})}}allowToTalk(e,t){return{seq:this.sendMessageToRwg({evt:8204,body:{id:e,bAllowTalk:t}})}}subscribeVideo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return{seq:this.sendMessageToRwg({evt:12289,body:{id:e,size:t,bOn:n}})}}unsubscribeVideo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{seq:this.sendMessageToRwg({evt:12291,body:{id:e}})}}muteAttendeeVideo(e,t){return{seq:this.sendMessageToRwg({evt:12297,body:{id:e,bOn:t}})}}notifyRwgIsMuteVideo(e,t){return this.muteAttendeeVideo(e,t)}pauseSharing(){return{seq:this.sendMessageToRwg({evt:16385,body:{}})}}resumeSharing(){return{seq:this.sendMessageToRwg({evt:16387,body:{}})}}allowAnonymousQuestion(e,t){return{seq:this.sendMessageToRwg({evt:4155,body:{userId:e,bOn:t}})}}allowViewAll(e,t){return{seq:this.sendMessageToRwg({evt:4157,body:{userId:e,bOn:t}})}}allowVote(e,t){return{seq:this.sendMessageToRwg({evt:4159,body:{userId:e,bOn:t}})}}allowComment(e,t){return{seq:this.sendMessageToRwg({evt:4161,body:{userId:e,bOn:t}})}}sharingRequestRemoteControl(e,t){return{seq:this.sendMessageToRwg({evt:16389,body:{id:e,bOn:t}})}}subscribeGrabRemoteControl(e,t){return{seq:this.sendMessageToRwg({evt:16393,body:{id:e,bOn:t}})}}subscribeSharing(e,t,n,r){const i={id:e,size:t};return n&&Object.assign(i,{bShareToBO:!0}),void 0!==r&&Object.assign(i,{bVideoShare:r}),{seq:this.sendMessageToRwg({evt:16415,body:i})}}unsubscribeSharing(e,t){const n={id:e};return t&&Object.assign(n,{bShareToBO:!0}),{seq:this.sendMessageToRwg({evt:16417,body:n})}}sendRWGConnectionPerformance(e){return{seq:this.sendMessageToRwg({evt:4167,body:{data:e}})}}sendSdkKeyToMonitor(e,t,n){return{seq:this.sendMessageToRwg({evt:4167,body:{data:`ZoomConferenceClient,videoapp_HTML5_sdk_web_join,${n},2,${t},${e}`}})}}sendDatachannelOffer(e){return{seq:this.sendMessageToRwg({evt:24321,offer:e})}}joinOrLeaveVoip(e){return{seq:this.sendMessageToRwg({evt:8203,body:{bOn:e}})}}startSharing(e,t){return{seq:this.sendMessageToRwg({evt:16409,body:{id:e,boOn:!1,...null!=t?t:{}}})}}stopSharing(e){return{seq:this.sendMessageToRwg({evt:16409,body:{id:e,bOn:!0}})}}lockSharing(e){return{seq:this.sendMessageToRwg({evt:4169,body:{lockShare:e}})}}startShareToBreakoutRoom(e){return{seq:this.sendMessageToRwg({evt:16425,body:{id:e,bShareToBO:!0}})}}stopShareToBreakoutRoom(e){return{seq:this.sendMessageToRwg({evt:16425,body:{id:e,bShareToBO:!1}})}}preAssignBreakoutRoom(){return{seq:this.sendMessageToRwg({evt:4213,body:{}})}}claimHost(e){return{seq:this.sendMessageToRwg({evt:4215,body:{hostKey:e}})}}allowMultiplePin(e,t){return{seq:this.sendMessageToRwg({evt:4217,body:{userID:e,bOn:t}})}}spotlightVideo(e,t){return{seq:this.sendMessageToRwg({evt:4219,body:{id:e,...t}})}}connectCamera(e,t){const n={evt:12307,body:{id:e,bOn:t}};return{seq:this.sendMessageToRwg(n)}}followHostLayout(e){return{seq:this.sendMessageToRwg({evt:4223,body:{bFollowHostVideo:e}})}}setVideoDragLayout(e){return{seq:this.sendMessageToRwg({evt:4218,body:{drag_list:e}})}}chatCmdReq(e,t){return{seq:this.sendMessageToRwg({evt:4237,body:{msgID:e,cmd:t}})}}activeAppLinkReq(e){return{seq:this.sendMessageToRwg({evt:4257,body:{appId:e}})}}activeAppInfoReq(){return{seq:this.sendMessageToRwg({evt:4255,body:{}})}}muteShareAudio(e,t){const n={bOn:!0,bShareAudio:!e};return t&&Object.assign(n,{bShareAudioOnly:!0}),{seq:this.sendMessageToRwg({evt:16423,body:n})}}localMuteAudio(e,t){return{seq:this.sendMessageToRwg({evt:8209,body:{id:e,bMute:t}})}}changeSharePronoun(e,t){return{seq:this.sendMessageToRwg({evt:4264,body:{bPronoun:e,strPronoun:t}})}}sendReceivingSharingReady(e){return{seq:this.sendMessageToRwg({evt:16421,body:{ssrc:e}})}}sendManualCaption(e){return{seq:this.sendMessageToRwg({evt:4289,body:{...e}})}}sendPollingAction(e,t,n){return{seq:this.sendMessageToRwg({evt:4224,body:{action:e,PollingId:t,...n}})}}broadcastUserNetworkQuality(e){const t={type:e.isUplink,level:e.level,bwLevel:e.bwLevel};return{seq:this.sendMessageToRwg({evt:4331,body:t})}}sendFarEndCameraControl(e,t,n){return{seq:this.sendMessageToRwg({evt:4329,body:{cmd:e,userID:t,buttonID:n}})}}sendCameraAblity(e){return{seq:this.sendMessageToRwg({evt:4330,body:{...e,focus:!1}})}}sendReaction(e){return{seq:this.sendMessageToRwg({evt:4259,body:{...e}})}}remoteControlConsent(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{deviceId:o,...s}=r;return{seq:this.sendMessageToRwg({evt:16427,body:{DeviceID:o,op:e,SendUserID:n,AssignUserID:t,...s,bAutoDelete:i}})}}takeBackRemoteControlPermission(e,t){return{seq:this.sendMessageToRwg({evt:16431,body:{SendUserID:e,ReceiverUserID:t}})}}syncSharedContentMetaWithRcApp(e){const{deviceId:t,...n}=e;return{seq:this.sendMessageToRwg({evt:16429,body:{DeviceID:t,...n}})}}startLiveStream(e,t,n){return{seq:this.sendMessageToRwg({evt:7977,body:{action:1,streamingURL:e,streamingKey:t,broadcastURL:n}})}}stopLiveStream(){return{seq:this.sendMessageToRwg({evt:7977,body:{action:0}})}}sendRemoteControlAuth(e){return{seq:this.sendMessageToRwg({evt:16433,body:{auth:e}})}}chatFileTransfer(e){return{seq:this.sendMessageToRwg({evt:4307,body:{...e,fileType:0,receiverType:0}})}}broadcastVoiceReq(e){return{seq:this.sendMessageToRwg({evt:4314,body:{broadcastVoice:e}})}}}class Ps extends Os{static createAgent(){return this.rwgInstance||(this.rwgInstance=new Ps),this.rwgInstance}}Ps.rwgInstance=null;class Ds extends Os{static getInstance(){return this.instance||(this.instance=new Ds),this.instance}}Ds.instance=null;const ks=[{name:"audio_simd.min.js",category:"audio",type:"worker",tag:"simd",alias:"audioSIMDWorkletPath"},{name:"audio.simd.wasm",category:"audio",type:"wasm",tag:"simd",alias:"audioSIMDWasm"},{name:"js_audio_process.min.js",category:"audio",type:"worker",tag:"",alias:"audioWorkerPath"},{name:"audio.encode.wasm",category:"audio",type:"wasm",tag:"",alias:"audioWasm"},{name:"js_audio_worklet.min.js",category:"audio",type:"worklet",tag:"",alias:"audioWorkletPath"},{name:"js_audio_worklet_simd.min.js",category:"audio",type:"worklet",tag:"simd",alias:"audioWorkletSIMDPath"},{name:"js_audio_worklet_process.min.js",category:"audio",type:"worklet",tag:"",alias:"audioWorkletProcessPath"},{name:"js_sharing_audio_worklet.min.js",category:"audio",type:"worklet",tag:"",alias:"sharingAudioWorkletPath"},{name:"js_audio_level_worklet_process.min.js",category:"audio",type:"worklet",tag:"",alias:"audioLevelWorkletPath"},{name:"video_mtsimd.min.js",category:"video",type:"worker",tag:"simd,thread",alias:"videoMSIMDWorkerPath"},{name:"video.mtsimd.wasm",category:"video",type:"wasm",tag:"simd,thread,videoShare",alias:"videoMSIMDWasm"},{name:"video_m.min.js",category:"video",type:"worker",tag:"thread",alias:"videoMtWorkerPath"},{name:"video.mt.wasm",category:"video",type:"wasm",tag:"thread",alias:"videoMtWasm"},{name:"video_simd.min.js",category:"video",type:"worker",tag:"simd",alias:"videoSIMDWorkerPath"},{name:"video.simd.wasm",category:"video",type:"wasm",tag:"simd",alias:"videoSIMDWasm"},{name:"video_s.min.js",category:"video",type:"worker",tag:"",alias:"videoWorkerPath"},{name:"video.decode.wasm",category:"video",type:"wasm",tag:"",alias:"videoWasm"},{name:"video_share_mtsimd.min.js",category:"video",type:"worker",tag:"videoShare",alias:"vsmiworkerpath"},{name:"sharing_mtsimd.min.js",category:"sharing",type:"worker",tag:"simd,thread",alias:"sharingMSIMDWorkerPath"},{name:"sharing_m.min.js",category:"sharing",type:"worker",tag:"thread",alias:"sharingMtWorkerPath"},{name:"sharing_simd.min.js",category:"sharing",type:"worker",tag:"simd",alias:"sharingSIMDWorkerPath"},{name:"sharing_s.min.js",category:"sharing",type:"worker",tag:"",alias:"sharingWorkerPath"}],xs="1506",Ns=(e,t)=>ks.reduce(((n,r)=>{const{name:i,alias:o}=r;return Object.assign(n,{[`${o}`]:`${e}/${t&&xs?`${xs}_`:""}${i}`}),n}),{});let Ms=function(e){return e.VideoEncode="0",e.VideoDecode="1",e.AudioEncode="2",e.AudioDecode="3",e.SharingEncode="4",e.SharingDecode="5",e}({});const Fs=ko.WebclientIVState;class Ls{static getInstance(){return void 0===this.agentInstance&&(this.agentInstance=new Ls),this.agentInstance}constructor(){this.assetsPath=void 0,this.instance=void 0,this.callbackList=void 0,this.mediaWorkersPath=void 0,this.constraints=void 0,this.svcUrl=void 0,this.meetingNumber=void 0,this.confId=void 0,this.mediaSocketAddress=void 0,this.currentUserId=void 0,this.receivedSharingCanvas=void 0,this.sharingCanvas=void 0,this.mediaOptions=void 0,this.inProgress=void 0,this.callbackList=[]}init(e){if(!this.instance&&window.JsMediaSDK_Instance){const t={ivObj:{[zo.AUDIO_ENCODE]:Do.get(Fs)&&Do.get(Fs)[zo.AUDIO_ENCODE],[zo.VIDEO_ENCODE]:Do.get(Fs)&&Do.get(Fs)[zo.VIDEO_ENCODE],[zo.SHARING_ENCODE]:Do.get(Fs)&&Do.get(Fs)[zo.SHARING_ENCODE]},globalTracingLogger:e};this.instance=new window.JsMediaSDK_Instance(t),this.instance.setRWGAgent(Ps.createAgent())}}setAssetsAndConstraint(e,t,n,r){var i;this.assetsPath=e,this.constraints=t,this.mediaWorkersPath=Ns(this.assetsPath,!!n),this.onMediaSDKCallback=this.onMediaSDKCallback.bind(this),this.mediaOptions=r,null===(i=this.instance)||void 0===i||i.JsMediaSDK_PreLoad(this.mediaWorkersPath,this.onMediaSDKCallback,r)}onMediaSDKCallback(e,t){this.callbackList.length>0&&this.callbackList.forEach((n=>n(e,t)))}registerCallback(e){this.callbackList.push(e)}unregisterCallback(e){this.callbackList=this.callbackList.filter((t=>t!==e))}static isSupportVideoEncodeHardwareAcceleration(){return window.JsMediaSDK_Instance.util.IsSupportVideoEncodeHardwareAcceleration()}static isSupportVideoDecodeHardwareAcceleration(){return window.JsMediaSDK_Instance.util.IsSupportVideoDecodeHardwareAcceleration()}static isCompatibleHardwareForEncode(){var e;return Uo.isSupportOffscreenCanvas&&0==(null===(e=window.JsMediaSDK_Instance)||void 0===e?void 0:e.util.AdapterWhiteListCheckForEncoder())}static getPTZCapability(){var e,t,n,r,i,o,s,a,u;return{pan:!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||null===(n=t.isSupportCameraPan)||void 0===n||!n.call(t)),tilt:!(null===(r=window.JsMediaSDK_Instance)||void 0===r||null===(i=r.util)||void 0===i||null===(o=i.isSupportCameraTilt)||void 0===o||!o.call(i)),zoom:!(null===(s=window.JsMediaSDK_Instance)||void 0===s||null===(a=s.util)||void 0===a||null===(u=a.isSupportCameraZoom)||void 0===u||!u.call(a))}}static isSupportVideoShare(){var e,t,n;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||null===(n=t.isSupportVideoShareReceive)||void 0===n||!n.call(t))}static isSupportVideoShareSend(){var e,t,n;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||null===(n=t.isSupportVideoShareSend)||void 0===n||!n.call(t))}static isSupportSending720P(){var e,t;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||!t.get720pcapacity())}static isSupportSubscribing1080P(){var e,t;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||!t.getsub1080pcapacity())}static isSupportOpenMicWhenShareAudio(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isSupportOpenMicWhenShareAudio())}static isSupportMediaPlaybackAsVideoInput(){var e,t;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util.videoToMediaStreamManager)||void 0===t||!t.isSupported())}static isSupportMediaPlaybackAsAudioInput(){var e,t;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util.audioToMediaStreamMananger)||void 0===t||!t.isSupported())}static isSupportAudioDenoise(e){var t;return!(null===(t=window.JsMediaSDK_Instance)||void 0===t||!t.util.isSupportAudioDenoise(e))}static isSupportAudioBridgeAVSync(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isSupportAudioBridgeAvsync())}static getAudioFeatureFlag(){var e;return null===(e=window.JsMediaSDK_Instance)||void 0===e?void 0:e.util.getAudioFeatureFlags()}static isSupportShareMultiStream(){var e;return null===(e=window.JsMediaSDK_Instance)||void 0===e?void 0:e.util.isSupportShareMultiStream()}static isSupportVideoLTR(){var e;return null===(e=window.JsMediaSDK_Instance)||void 0===e?void 0:e.util.isSupportVideoLTR()}static isSupportStereoAudio(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isBrowserSupportStereo())}static isSupportFullHDVideo(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isSupportSendVideoFullHD())}static isSupportFullHDVideoShare(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isSupportSendVideoShareFullHD())}static isSupportShare2ndAudioDevice(e){var t;return!(null===(t=window.JsMediaSDK_Instance)||void 0===t||!t.util.isSupportShare2ndAudioDevice(e))}connect(e){var t,n,r,i,o,s;let{svcUrl:a,meetingNumber:u,conId:c,e2eEncrypt:l,isViewOnly:d,currentUserId:h,isWebinar:p,enableAudioQos:f,enableVideoQos:g=!1,enableWebtransport:m=!1,webtransportPort:v,rendererType:y,adaptedABOptionForMediaSDK:S}=e;const{isSupportEssentialAudioAndVideoAbility:b,isSupportAudioWorklet:E,isSupportSendScreenSharing:w}=Uo;this.svcUrl=a,this.meetingNumber=u,this.confId=c;const I=((e,t,n)=>({videoSocketAddress:`wss://${e}/wc/media/${t}?type=v&cid=${n}`,audioSocketAddress:`wss://${e}/wc/media/${t}?type=a&cid=${n}`,sharingSocketAddress:`wss://${e}/wc/media/${t}?type=${qo()?"j":"s"}&cid=${n}`}))(a,u,c);this.mediaSocketAddress=I,this.currentUserId=h;const _=$o(null===(t=this.mediaOptions)||void 0===t?void 0:t.enableMultiDecodeVideoWithoutSAB);var C,A,T,R,O,P,D,k,x,N;null===(n=this.instance)||void 0===n||n.setPropsBeforeInit({callback:this.onMediaSDKCallback,audioWorkerPath:b?null===(r=this.mediaWorkersPath)||void 0===r?void 0:r.audioWorkletPath:void 0,e2eEncrypt:l,isEnableListenInitEvent:!0,enableWebtransport:m,webtransportPort:v,featureOptions:S,rendererType:y}),!0===(null===(i=this.constraints)||void 0===i?void 0:i.audio)&&b&&!Ho()&&((p||E)&&(null===(C=this.instance)||void 0===C||C.initAudioDecode(this.mediaWorkersPath,I.audioSocketAddress,h,$t,c,u,_,f)),!E||p&&d||null===(A=this.instance)||void 0===A||A.initAudioEncode(this.mediaWorkersPath,I.audioSocketAddress,h,$t,c,u,_,f)),!0===(null===(o=this.constraints)||void 0===o?void 0:o.video)&&b&&(null===(T=this.instance)||void 0===T||T.initVideoDecode(this.mediaWorkersPath,I.videoSocketAddress,h,$t,c,u,_,null===(R=null===(O=window.JsMediaSDK_Instance)||void 0===O||null===(P=O.util)||void 0===P?void 0:P.isGraphicShouldUseHardwareAccelerationDecode())||void 0===R||R,g),p&&d||null===(D=this.instance)||void 0===D||D.initVideoEncode(this.mediaWorkersPath,I.videoSocketAddress,h,$t,c,u,_,!1,g,!0,!0)),!0===(null===(s=this.constraints)||void 0===s?void 0:s.screen)&&(b?(null===(k=this.instance)||void 0===k||k.initSharingDecode(this.mediaWorkersPath,I.sharingSocketAddress,h,$t,c,u,_),!w||p&&d||null===(x=this.instance)||void 0===x||x.initSharingEncode(this.mediaWorkersPath,I.sharingSocketAddress,h,$t,c,u,_)):null===(N=this.instance)||void 0===N||N.initSharingDecode(I.sharingSocketAddress)),this.inProgress=!0}async destroy(){var e;this.callbackList=[],[Ms.AudioDecode,Ms.AudioEncode,Ms.VideoDecode,Ms.VideoEncode].forEach((e=>{var t;null===(t=this.instance)||void 0===t||t.updateQosSubscription(!1,e)}));const t=null===(e=this.instance)||void 0===e?void 0:e.destroy.bind(this.instance);this.instance=null,this.inProgress=!1,await(null==t?void 0:t())}disconnect(){var e,t;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(17,{}),null===(t=this.instance)||void 0===t||t.JsMediaSDK_UnInit()}muteAudio(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(8,{ssrc:0})}unmuteAudio(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(7,{ssrc:0,AudioSelectValue:0})}joinComputerAudio(e,t,n,r,i,o,s){var a;const u=s?{...s,enableHID:!0}:{enableHID:!1};return null===(a=this.instance)||void 0===a?void 0:a.Notify_MeidaSDK(22,{CaptureAudio:r,CaptureAudioInfo:{ssrc:e,AudioSelectValue:"default"===t?null:t,...u,audioProfile:i},speakerInfo:{defaultDeviceId:n},...o?{useAudioBridge:!0,audioBridge:o}:{}})}leaveComputerAudio(){var e;return null===(e=this.instance)||void 0===e?void 0:e.Notify_MeidaSDK(21,null)}joinSharingAudio(e){var t;let{ssrc:n,microphoneDeviceId:r,speakerDeviceId:i,isCaptureAudio:o,audioBridge:s}=e;return null===(t=this.instance)||void 0===t?void 0:t.Notify_MeidaSDK(72,{CaptureAudio:o,CaptureAudioInfo:{ssrc:n,AudioSelectValue:"default"===r?null:r},speakerInfo:{defaultDeviceId:i},checkAutoplay:!1,...s?{useAudioBridge:!0,audioBridge:s}:{}})}leaveSharingAudio(e){var t;return null===(t=this.instance)||void 0===t?void 0:t.Notify_MeidaSDK(73,{isPause:e?1:0})}changeSpeaker(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(11,{ssrc:0,AudioSelectValue:e})}changeMicrophone(e,t,n){var r;null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(18,{ssrc:0,AudioSelectValue:"default"===e?null:e,microphoneLabel:null!=t?t:"default",defaultMuted:n})}restoreWebRTC(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(19,{ssrc:0,AudioSelectValue:"default"===e?null:e})}renderVideo(e,t,n,r,i,o,s,a,u,c,l){var d;const h={userId:t,width:r,height:i,x:o,y:s,quality:a,isMyself:u,canvas:e,enableWaterMark:l,waterMarkText:c,zone:n};e instanceof HTMLVideoElement&&Object.assign(h,{videodom:e}),null===(d=this.instance)||void 0===d||d.Notify_MeidaSDK(1,h)}stopRenderVideo(e,t,n,r){var i;let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(2,{canvas:e,userId:t,RGBA:r,doNotClean:o,zone:n})}startCaptureVideo(e,t,n,r,i,o){var s;let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>8?arguments[8]:void 0;const c=(arguments.length>7?arguments[7]:void 0)?Ls.getPTZCapability():void 0;null===(s=this.instance)||void 0===s||s.Notify_MeidaSDK(3,{ssid:e,width:n,height:r,fps:u,video:i,usingFacingMode:o,VideoSelectValue:"default"===t?null:t,disableOriginalRatio:a,...c})}stopCaptureVideo(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(4,{ssrc:0})}changeCamera(e,t,n){var r;null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(12,{VideoSelectValue:"default"===e?null:e,usingFacingMode:!!t,...n||{}})}switchCanvasForVideoCapture(e){var t;let n=e;"string"==typeof e&&(n=[e]),null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(25,n)}renderSharing(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.receivedSharingCanvas=t,null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(23,{width:0,height:0,ssrc:e,canvas:t,enableWaterMark:r,waterMarkText:i,isFromMainSession:o})}stopRenderSharing(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(24,{})}switchSharingSource(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(36,{ssrc:e,isFromMainSession:Number(n)})}ajustmentReceivedSharingCanvas(e,t){if(this.receivedSharingCanvas)try{this.receivedSharingCanvas.width=e,this.receivedSharingCanvas.height=t}catch(e){}}startRemoteControl(e,t,n){var r;null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(26,{socketURL:`wss://${this.svcUrl}`,meetingID:this.meetingNumber,condID:this.confId,os:t,dom:e,...n})}stopRemoteControl(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(28)}resendRemoteControlPositionPDU(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(41)}updateRemoteControlProperties(e){var t;const{dimension:n,...r}=e;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(27,{...n,...r})}startDesktopSharing(e,t,n,r){var i;let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0;this.sharingCanvas=t;const c={};r&&Object.assign(c,{share2ndCamera:!0,share2ndCameraParams:{VideoSelectValue:"default"===r.cameraId?null:r.cameraId,width:r.width,height:r.height}}),void 0!==s&&Object.assign(c,{videoParams:{displaySurface:s}}),void 0!==u&&Object.assign(c,{otherParams:{...u}}),null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(30,{ssid:e,canvas:t,video:n,...c,showShareAudioOption:o,sourceId:a})}stopDesktopSharing(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(31,{})}pauseDesktopSharing(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(32,{})}resumeDesktopSharing(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(33,{})}selectLanguageChannelForNewLTT(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(57,{lang:e})}changeSharingSecondCamera(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(49,{VideoSelectValue:e})}ajustmentSharingCanvas(e,t){if(this.sharingCanvas)try{this.sharingCanvas.width=e,this.sharingCanvas.height=t}catch(e){}}checkChromeSharingExtension(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(34,{})}enableAudioEncode(){var e,t;null===(e=this.instance)||void 0===e||e.initAudioEncode(this.mediaWorkersPath,this.mediaSocketAddress.audioSocketAddress,this.currentUserId,$t,this.confId,this.meetingNumber,$o(null===(t=this.mediaOptions)||void 0===t?void 0:t.enableMultiDecodeVideoWithoutSAB))}sendUserNodeList(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(43,{userList:e,encryptKey:t})}updateRenderedSharingDimension(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(44,{width:e,height:t})}pauseOrResumeAudio(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(45,{bPause:e})}updateRenderedVideoCanvasDimension(e,t,n){var r;null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(46,{canvas:e,width:t,height:n})}clearVideoCanvas(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(47,{id:e,RGBA:t})}adjustRenderedVideoPosition(e,t,n,r,i,o,s,a){var u;null===(u=this.instance)||void 0===u||u.Notify_MeidaSDK(48,{userId:t,x:r,y:i,width:o,height:s,canvas:e,zone:n,RGBA:a})}mirrorVideo(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(75,{isMirrorMyVideo:e})}updateUserMediaSN(e){var t,n,r;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(80,{isFromMainSession:Number(e.isFromMainSession),mediaActionType:e.iVType,body:{add:null!==(n=e.added)&&void 0!==n?n:[],remove:null!==(r=e.removed)&&void 0!==r?r:[]}})}updateMediaParams(e){var t;const{iVType:n,isFromMainSession:r,updateParams:i}=e;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(81,{mediaActionType:n,isFromMainSession:Number(r),updateParams:i})}createMainSessionChannel(e,t){var n,r;"sharing"===e?null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(84,t):null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(85,t)}addReceivedSharingChannelType(e){var t;const{isFromMainSession:n,...r}=e;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(82,{isFromMainSession:Number(n),...r})}removeReceivedSharingChannelType(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(83,{isFromMainSession:Number(e.isFromMainSession),ssrc:e.ssrc})}enableHardwareAccelerationForVideoDecode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(70,{enable:e})}enableHardwareAccelerationForVideoEncode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(71,{enable:e})}setSharingAudioVolume(e,t,n){var r;null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(74,{userid:e>>10,shareVolume:t?0:100,isFromMainSession:n})}subscribeToQos(e,t){e.forEach((e=>{var n;null===(n=this.instance)||void 0===n||n.updateQosSubscription(!0,e,t)}))}unsubscribeFromQos(e){e.forEach((e=>{var t;null===(t=this.instance)||void 0===t||t.updateQosSubscription(!1,e)}))}passThroughRWGMessage(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(40,e)}startVirtualBackgroundSetting(e,t,n,r,i,o){var s;let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];null===(s=this.instance)||void 0===s||s.Notify_MeidaSDK(91,{canvas:e,bgdom:t,width:i,height:o,ssid:n,VideoSelectValue:"default"===r?null:r,disableOriginalRatio:a})}updateVirtualBackgroundImage(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(92,{bgdom:e})}stopVirtualBackgroundSetting(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(93,{isSwitch:t})}startMaskSetting(e,t,n,r,i,o,s,a,u){var c;null===(c=this.instance)||void 0===c||c.Notify_MeidaSDK(62,{canvas:e,maskdom:n,bgdom:t,dx:0,dy:0,dWidth:o,dHeight:s,width:a,height:u,ssid:r,VideoSelectValue:"default"===i?null:i})}updateMaskBackgroundImage(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(63,{bgdom:e})}updateMaskClip(e,t,n){var r;null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(64,{maskdom:e,dx:0,dy:0,dWidth:t,dHeight:n})}stopMaskSetting(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(65,{isSwitch:t})}enableVideoObserver(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(99,{enable:e,fpsdisbale:n})}enableShareAudioToBreakoutRoom(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(86,{enable:e})}sendUserAudioStatus(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(51,e)}muteOrUnmuteOtherAudio(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(50,{userId:e,volume:t?0:100})}adjustOtherAudioVolume(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(50,{userId:e,volume:t})}notifySDKMeetingReady(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(113)}movePTZCamera(e){var t,n;return null===(t=window.JsMediaSDK_Instance)||void 0===t||null===(n=t.util)||void 0===n?void 0:n.queryPTZPermisson().then((t=>{var n;return t?(null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(53,e),Promise.resolve("")):Promise.reject("Cannot move camera without permission granted")}))}switchSharingMode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(101,{mode:e})}updateVideoHDValue(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK("update_videohd_value",{videohd:e})}updateVideoFullhdValue(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK("update_videofullhd_value",{videofullhd:e})}changeAudioProfile(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(126,e)}enableSyncButtonsOnHeadset(e,t,n){var r;null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(100,{enable:e,microphoneLabel:t,defaultMuted:n})}stopAllIncomingAudio(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(123,e)}isSharingEntireScreen(){var e,t;const n=null===(e=this.instance)||void 0===e||null===(t=e.getShareStreamInfo)||void 0===t?void 0:t.call(e);if(n){const{displaySurface:e}=n;return!e||"monitor"===e}return!1}getShareStreamInfo(){var e,t;const n=null===(e=this.instance)||void 0===e||null===(t=e.getShareStreamInfo)||void 0===t?void 0:t.call(e);if(n){const{deviceId:e,width:t,height:r}=n;return{deviceId:e,width:t,height:r}}return{}}preInitAudioBridge(e){var t;null===(t=this.instance)||void 0===t||t.previewInit({audioBridge:{...e}})}prefetchVideoSsrc(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(110,{ssrc:e})}cancelPrefetchVideoSsrc(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(112,{ssrc:e,haddata:!1})}setMobileRotateMode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(124,{isLandScape:e})}changeActiveVideoSsrc(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(13,{ssrc:e})}setAudioCodecMode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(122,{mode:e})}startRemoteControlQRCheck(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(54,{enable:e})}broadcastVoiceToBreakoutRoom(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(87,{enable:e})}share2ndAudio(e,t){var n;const r={audioOnly:!0,deviceId:"default"===e?null:e};t&&Object.assign(r,t),null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(129,r)}}Ls.agentInstance=void 0;const Vs="ADD_CURRENT_USER_PARTICIPANT_ATTRIBUTE",Bs="UPDATE_CURRENT_USER_PARTICIPANT_ATTRIBUTE",js="ADD_USER_PARTICIPANT_ATTRIBUTE",Us="UPDATE_USER_PARTICIPANT_ATTRIBUTE",Hs="REMOVE_USER_PARTICIPANT_ATTRIBUTE",qs="UPDATE_WEBINAR_PARTICIPANT_ATTRIBUTE",Ks="REMOVE_WEBINAR_ATTENDEE_ATTRIBUTE",$s="JOIN_MEETING_SUCCESS",Ws="JOIN_MEETING_FAILED",Gs="RECONNECTING_MEETING",zs="LEAVING_MEETING",Js="MEETING_IN_WAITING_ROOM",Qs="UPDATE_MEETING_ATTRIBUTE",Ys="SHARE_PRONOUN_TYPE_UPDATE";var Zs=function(e){return e.ConnectionChange="connection-change",e.OnHoldChange="on-hold-change",e.UserAdd="user-added",e.UserUpdate="user-updated",e.UserRemove="user-removed",e.AttendeeUpdate="attendee-updated",e.MeetingAttributeUpdate="meeting-attribute-updated",e.PromoteAttendeeConsent="promote-attendee-consent",e.ActiveAppsUpdate="active-apps-updated",e.SharePronounTypeUpdate="share-pronoun-type-update",e}(Zs||{});const Xs={JoinMeeting:{success:Vs,fail:[Ws]}},ea={[Zs.ConnectionChange]:[{event:$s,payload:()=>({state:_o.Connected})},{event:Ws,payload:e=>({state:_o.Fail,...e})},{event:Gs,payload:e=>({state:_o.Reconnecting,...e})},{event:zs,payload:e=>({state:_o.Closed,...e})}],[Zs.OnHoldChange]:[{event:Js,payload:e=>({isOnHold:e})}],[Zs.UserAdd]:[{event:Vs,payload:e=>[e]},{event:js,payload:e=>e}],[Zs.UserUpdate]:[{event:Bs,payload:e=>[e]},{event:Us,payload:e=>e}],[Zs.UserRemove]:[{event:Hs,payload:e=>e}],[Zs.AttendeeUpdate]:[{event:qs,payload:e=>e},{event:Ks,payload:e=>e}],[Zs.MeetingAttributeUpdate]:[{event:Qs,payload:e=>"bNoHostTimeOut"in e?{isHostLost:e.bNoHostTimeOut}:null}],[Zs.PromoteAttendeeConsent]:[{event:"MEETING_WEBINAR_PROMOTE_CONSENT_REQ",payload:e=>{let{req_id:t,sender_id:n}=e;return{reqId:t,senderId:n}}}],[Zs.ActiveAppsUpdate]:[{event:"ACTIVE_APPS_UPDATE",payload:()=>{}}],[Zs.SharePronounTypeUpdate]:[{event:Ys,payload:e=>e}]},ta="LIVE_TRANSCRIPTION_RECEIVE_MESSAGE",na="LIVE_TRANSCRIPTION_CAPTION_STATUS_CHANGE_RESPONSE",ra="LIVE_TRANSCRIPTION_STATUS_CHANGE",ia="LIVE_TRANSCRIPTION_HOST_DISABLE_CHANGE",oa={"caption-message":[{event:ta,payload:e=>e}],"caption-status":[{event:na,payload:e=>e}],"caption-enable":[{event:ra,payload:e=>e}],"caption-host-disable":[{event:ia,payload:e=>e}]},sa="CHAT_RECEIVE_MESSAGE_EVENTS",aa="CHAT_PRIVILEGE_CHANGE",ua="CHAT_MESSAGE_RESPONSE",ca="CHAT_DELETE_MESSAGE_REPONSE",la="CHAT_FILE_CHAT_UPLOAD_PROGRESS",da="CHAT_FILE_CHAT_DOWNLOAD_PROGRESS";let ha=function(e){return e.ChatOnMessage="chat-on-message",e.ChatPrivilegeChange="chat-privilege-change",e.ChatDeleteMessage="chat-delete-message",e.ChatFileUploadProgress="chat-file-upload-progress",e.ChatFileDownloadProgress="chat-file-download-progress",e}({});const pa={[ha.ChatOnMessage]:[{event:sa,payload:e=>e}],[ha.ChatPrivilegeChange]:[{event:aa,payload:e=>e}],[ha.ChatDeleteMessage]:[{event:ca,payload:e=>e}],[ha.ChatFileUploadProgress]:[{event:la,payload:e=>e}],[ha.ChatFileDownloadProgress]:[{event:da,payload:e=>e}]},fa="COMMAND_RECEIVE_MESSAGE_EVENTS",ga="COMMAND_STATUS_EVENTS";let ma=function(e){return e.CommandChannelStatus="command-channel-status",e.CommandChannelMessage="command-channel-message",e}({});const va={[ma.CommandChannelStatus]:[{event:ga,payload:e=>e}],[ma.CommandChannelMessage]:[{event:fa,payload:e=>e}]};let ya=function(e){return e.Recording="Recording",e.Paused="Paused",e.Stopped="Stopped",e.Ask="Ask",e.Accept="Accept",e.Decline="Decline",e}({}),Sa=function(e){return e[e.None=0]="None",e[e.Init=1]="Init",e[e.Start=2]="Start",e[e.Pause=3]="Pause",e[e.Stop=4]="Stop",e}({}),ba=function(e){return e[e.Stop=0]="Stop",e[e.Start=1]="Start",e[e.Pause=2]="Pause",e}({}),Ea=function(e){return e[e.None=0]="None",e[e.Deny=1]="Deny",e[e.Allow=2]="Allow",e}({}),wa=function(e){return e[e.None=0]="None",e[e.DenyAllRequest=1]="DenyAllRequest",e[e.AllowAllRequest=2]="AllowAllRequest",e}({});const Ia="CLOUD_RECORDING_STATUS_CHANGE",_a="CLOUD_RECORDING_ISO_STATUS_CHANGE",Ca="LOCAL_RECORDING_CHANGE",Aa="LOCAL_RECORDING_PERMISSION_CHANGE",Ta="RECORDING_FOR_IQ_STATUS_CHANGE",Ra="RECORDING_FOR_IQ_OPERATION_CHANGE";let Oa=function(e){return e.RecordingChange="recording-change",e.IndividualRecordingChange="individual-recording-change",e.LocalRecordingChange="local-recording-change",e.LocalRecordingPermissionChange="local-recording-permission-change",e.MediaCaptureStatusChange="media-capture-status-change",e.MediaCapturePermissionChange="media-capture-permission-change",e.RecordingIqChange="recording-iq-change",e}({});const Pa={[Oa.RecordingChange]:[{event:Ia,payload:e=>{const{cmrServerStatus:t}=e;return t===Sa.Start?ya.Recording:t===Sa.Pause?ya.Paused:ya.Stopped}}],[Oa.IndividualRecordingChange]:[{event:_a,payload:e=>e}],[Oa.LocalRecordingChange]:[{event:Ca,payload:e=>e}],[Oa.LocalRecordingPermissionChange]:[{event:Aa,payload:e=>e}],[Oa.MediaCaptureStatusChange]:[{event:Ca,payload:e=>e}],[Oa.MediaCapturePermissionChange]:[{event:Aa,payload:e=>e}],[Oa.RecordingIqChange]:[{event:Ta,payload:e=>e}]};let Da=function(e){return e[e.InitSuccess=1]="InitSuccess",e[e.InitSuccessVideo=1.1]="InitSuccessVideo",e[e.InitSuccessAudio=1.2]="InitSuccessAudio",e[e.InitSuccessSharing=1.3]="InitSuccessSharing",e[e.UserGrantCaptureAudio=2]="UserGrantCaptureAudio",e[e.CurrentVideoResolution=3]="CurrentVideoResolution",e[e.JpegDecThreadOk=4]="JpegDecThreadOk",e[e.JpegData=5]="JpegData",e[e.SharingPara=6]="SharingPara",e[e.VideoDecodeMaxSize=7]="VideoDecodeMaxSize",e[e.CurrentCaptureVideoWidthHeight=8]="CurrentCaptureVideoWidthHeight",e[e.StartVideoCaptureSuccess=9]="StartVideoCaptureSuccess",e[e.StopVideoCaptureSuccess=10]="StopVideoCaptureSuccess",e[e.StartRemoteControlSuccess=11]="StartRemoteControlSuccess",e[e.CancelRemoteControlSuccess=12]="CancelRemoteControlSuccess",e[e.RemoteControlCopiedTextNotify=13]="RemoteControlCopiedTextNotify",e[e.MonitorLog=14]="MonitorLog",e[e.CurrentDesktopSharingWidthHeight=15]="CurrentDesktopSharingWidthHeight",e[e.DesktopSharingCaptureSuccess=16]="DesktopSharingCaptureSuccess",e[e.CheckChromeSharingExtensionResponse=17]="CheckChromeSharingExtensionResponse",e[e.SharingDecodeMaxSize=18]="SharingDecodeMaxSize",e[e.DataChannelOffer=19]="DataChannelOffer",e[e.AesGcmIvResponse=21]="AesGcmIvResponse",e[e.SharingDesktopStreamHaveAudio=23]="SharingDesktopStreamHaveAudio",e[e.JoinComputerAudioComplete=24]="JoinComputerAudioComplete",e[e.JoinSharingAudioComplete=25]="JoinSharingAudioComplete",e[e.LeaveComputerAudioComplete=26]="LeaveComputerAudioComplete",e[e.LeaveSharingAudioComplete=27]="LeaveSharingAudioComplete",e[e.HidStatusMute=28]="HidStatusMute",e[e.AudioStreamFailed=31]="AudioStreamFailed",e[e.VideoStreamFailed=32]="VideoStreamFailed",e[e.AudioSpeakerSetSuccess=33]="AudioSpeakerSetSuccess",e[e.AudiobridgeSetCcLangSuccess=36]="AudiobridgeSetCcLangSuccess",e[e.AudioLevelIndicator=38]="AudioLevelIndicator",e[e.SyncRendererTypeResponse=39]="SyncRendererTypeResponse",e[e.SendRemoteControlQrCode=55]="SendRemoteControlQrCode",e[e.StartVideoStreamInMaskSettingSuccess=66]="StartVideoStreamInMaskSettingSuccess",e[e.CurrentDecodeVideoQuality=66.5]="CurrentDecodeVideoQuality",e[e.CurrentDecodeVideoFps=66.6]="CurrentDecodeVideoFps",e[e.SharingFirstDecodeFrameReceivedSsrc=70]="SharingFirstDecodeFrameReceivedSsrc",e[e.StartVideoStreamInVbSettingSuccess=94]="StartVideoStreamInVbSettingSuccess",e[e.VbModelPreloading_3S=96]="VbModelPreloading_3S",e[e.VbModelPreloading_10S=97]="VbModelPreloading_10S",e[e.VbModelPreloadingOk=98]="VbModelPreloadingOk",e[e.NewActiveSpeakerFirstFrameCallback=111]="NewActiveSpeakerFirstFrameCallback",e[e.AudioBridgeFirstRecvData=114]="AudioBridgeFirstRecvData",e[e.AudioBridgeCanSendData=115]="AudioBridgeCanSendData",e[e.InitFailed=-1]="InitFailed",e[e.InitFailedVideo=-1.1]="InitFailedVideo",e[e.InitFailedAudio=-1.2]="InitFailedAudio",e[e.InitFailedSharing=-1.3]="InitFailedSharing",e[e.UserForbiddedCaptureAudio=-2]="UserForbiddedCaptureAudio",e[e.AudioWebsocketBroken=-3]="AudioWebsocketBroken",e[e.VideoWebsocketBroken=-4]="VideoWebsocketBroken",e[e.SharingDecThreadFailed=-5]="SharingDecThreadFailed",e[e.AudioZeroData=-6]="AudioZeroData",e[e.AudioCtxSamplerate=-7]="AudioCtxSamplerate",e[e.UserForbiddedCaptureVideo=-8]="UserForbiddedCaptureVideo",e[e.UserCameraIsTakenByOtherPrograms=-9]="UserCameraIsTakenByOtherPrograms",e[e.StopVideoCaptureFailed=-10]="StopVideoCaptureFailed",e[e.StartRemoteControlFailed=-11]="StartRemoteControlFailed",e[e.CancelRemoteControlFailed=-12]="CancelRemoteControlFailed",e[e.RemoteControlPasteTextLengthOverflow=-14]="RemoteControlPasteTextLengthOverflow",e[e.UserStopDesktopSharing=-15]="UserStopDesktopSharing",e[e.UserCancelPermissionRequest=-16]="UserCancelPermissionRequest",e[e.DesktopSharingChromeExtensionUninstalled=-17]="DesktopSharingChromeExtensionUninstalled",e[e.DesktopSharingPermissionDenied=-18]="DesktopSharingPermissionDenied",e[e.DesktopSharingTimeOut=-19]="DesktopSharingTimeOut",e[e.DesktopSharingError=-20]="DesktopSharingError",e[e.AudioSpeakerSetError=-21]="AudioSpeakerSetError",e[e.DesktopSharingSystemError=-22]="DesktopSharingSystemError",e[e.SharingDesktopStreamHaveNoAudio=-27]="SharingDesktopStreamHaveNoAudio",e.AudioQosData="AUDIO_QOS_DATA",e.VideoQosData="VIDEO_QOS_DATA",e.ShareQosData="VIDEOSHARE_QOS_DATA",e.NetworkQualityChange="NETWORK_QUALITY_CHANGE",e[e.AudioBridgeReconnectStart=-29]="AudioBridgeReconnectStart",e[e.AudioBridgeReconnectEnd=-31]="AudioBridgeReconnectEnd",e[e.WebglLostInMultiView=-32]="WebglLostInMultiView",e[e.MaskSettingParaError=-33]="MaskSettingParaError",e[e.VbSettingParaError=-34]="VbSettingParaError",e[e.NotifyUIFailover=-35]="NotifyUIFailover",e[e.RecoverWebrtcAudio=-36]="RecoverWebrtcAudio",e[e.AudiobridgeSetCcLangFailure=-39]="AudiobridgeSetCcLangFailure",e}({}),ka=function(e){return e[e.EncodeSuccess=1]="EncodeSuccess",e[e.DecodeSuccess=2]="DecodeSuccess",e[e.EncodeFailed=-1]="EncodeFailed",e[e.DecodeFailed=-2]="DecodeFailed",e}({}),xa=function(e){return e.Spotlight="Spotlight",e.Unmute="Unmute",e.AllowToTalk="Allow to talk",e}({}),Na=function(e){return e.Inherited="inherited",e.Active="active",e.PassiveByMuteOne="passive(mute one)",e.PassiveByMuteAll="passive(mute all)",e.SharingAudio="sharing audio",e}({}),Ma=function(e){return e.Inherited="inherited",e.Active="active",e.Passive="passive",e.SharingAudio="sharing audio",e}({}),Fa=function(e){return e.Active="active",e.Failover="failover",e.EndedBySystem="audio stream is ended by system",e.Pstn="pstn",e.MicrophoneError="microphone error",e}({}),La=function(e){return e.Join="join",e.Leave="leave",e.Muted="muted",e.Unmuted="unmuted",e}({}),Va=function(e){return e[e.Calling=1]="Calling",e[e.Ringing=2]="Ringing",e[e.Accepted=3]="Accepted",e[e.Busy=4]="Busy",e[e.NotAvailable=5]="NotAvailable",e[e.HangUp=6]="HangUp",e[e.Fail=7]="Fail",e[e.Success=8]="Success",e[e.Timeout=9]="Timeout",e[e.Canceling=10]="Canceling",e[e.Canceled=11]="Canceled",e[e.CancelFailed=12]="CancelFailed",e}({});const Ba=(()=>{const e=new ArrayBuffer(684),t=new Uint32Array(e);return t.set([1179011410,676,1163280727,544501094,16,65539,16e3,64e3,2097156,1635017060,640],0),new Blob([t],{type:"audio/wav"})})(),ja=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]),Ua=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);let Ha=function(e){return e[e.HostGrab=0]="HostGrab",e[e.OnlyHost=1]="OnlyHost",e[e.AnyoneGrab=2]="AnyoneGrab",e[e.MultipleShare=3]="MultipleShare",e}({}),qa=function(e){return e.Sharing="sharing",e.Paused="paused",e.End="ended",e}({}),Ka=function(e){return e[e.Video_90P=0]="Video_90P",e[e.Video_180P=1]="Video_180P",e[e.Video_360P=2]="Video_360P",e[e.Video_720P=3]="Video_720P",e[e.Video_1080P=4]="Video_1080P",e}({}),$a=function(e){return e.Active="Active",e.Inactive="Inactive",e}({}),Wa=function(e){return e.Muted="Muted",e.Unmuted="Unmuted",e}({}),Ga=function(e){return e.Started="Started",e.Stopped="Stopped",e.Failed="Failed",e}({}),za=function(e){return e.Approved="Approved",e.Rejected="Rejected",e}({}),Ja=function(e){return e.PrivilegeChange="PrivilegeChange",e.StopScreenCapture="StopScreenCapture",e.ShareFromMainSession="ShareFromMainSession",e}({}),Qa=function(e){return e[e.ImageNotMatch=2]="ImageNotMatch",e[e.CanvasNotMatch=3]="CanvasNotMatch",e[e.VBModelNotMatch=4]="VBModelNotMatch",e}({});const Ya="blur";let Za=function(e){return e.User="user",e.Environment="environment",e.Left="left",e.Right="right",e}({});const Xa=Object.values(Za),eu=1e3,tu="__ZOOM_SDK_SHARING_VIDEO__",nu="__ZOOM_SDK_VIDEO_ZONE__",ru="__ZOOM_SDK_VIRTUAL_BACKGROUND_CANVAS_@__",iu="__ZOOM_SDK_VIRTUAL_BACKGROUND_IMAGE_@__",ou="__ZOOM_SDK_MASK_CLIP_@__",su="__ZOOM_SDK_MEDIA_PLAYBACK_SOURCE_VIDEO__",au="__ZOOM_SDK_DYMMY_VIDEO_PLAYER_CANVAS_ID__",uu="__ZOOM_SDK_DUMMY_HIDDEN_SELF_VIEW_VIDEO_ID__",cu={data:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,rate:0,bandwidth:0}},lu={data:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,rate:0,bandwidth:0}};let du=function(e){return e[e.Request=11]="Request",e[e.Decline=12]="Decline",e[e.Approve=13]="Approve",e[e.GiveUp=14]="GiveUp",e[e.StartControl=15]="StartControl",e[e.ContinueControl=16]="ContinueControl",e[e.StopControl=17]="StopControl",e[e.SwitchCamera=20]="SwitchCamera",e}({}),hu=function(e){return e[e.Bk=0]="Bk",e[e.Center=1]="Center",e[e.ZoomIn=2]="ZoomIn",e[e.ZoomOut=3]="ZoomOut",e[e.Left=4]="Left",e[e.Right=5]="Right",e[e.Up=6]="Up",e[e.Down=7]="Down",e[e.SwitchCamera=8]="SwitchCamera",e}({}),pu=function(e){return e[e.Pan=192]="Pan",e[e.Tilt=48]="Tilt",e[e.Zoom=12]="Zoom",e[e.Focus=3]="Focus",e}({}),fu=function(e){return e[e.ZoomIn=2]="ZoomIn",e[e.ZoomOut=3]="ZoomOut",e[e.Left=4]="Left",e[e.Right=5]="Right",e[e.Up=6]="Up",e[e.Down=7]="Down",e[e.SwitchCamera=8]="SwitchCamera",e}({}),gu=function(e){return e[e.None=0]="None",e[e.ApproveAnother=3]="ApproveAnother",e[e.Stop=5]="Stop",e}({}),mu=function(e){return e[e.Null=0]="Null",e[e.Normal=1]="Normal",e[e.VideoMode=2]="VideoMode",e}({}),vu=function(e){return e[e.Null=0]="Null",e[e.VirtualBackground=1]="VirtualBackground",e[e.Mask=2]="Mask",e}({}),yu=function(e){return e.Computer="computer",e.Phone="phone",e}({}),Su=function(e){return e[e.Decline=0]="Decline",e[e.Approve=1]="Approve",e[e.CacheClean=2]="CacheClean",e}({}),bu=function(e){return e.Unknown="unknown",e.Uninstalled="uninstalled",e.Installed="installed",e}({}),Eu=function(e){return e.Unlaunched="unlaunched",e.Launched="launched",e}({}),wu=function(e){return e.Started="started",e.Ended="ended",e}({}),Iu=function(e){return e[e.Max=30]="Max",e[e.Min=10]="Min",e[e.Default=24]="Default",e}({}),_u=function(e){return e[e.Loading=1]="Loading",e[e.Done=2]="Done",e}({}),Cu=function(e){return e.Browser="Browser",e.Zoom="Zoom",e}({}),Au=function(e){return e.Denoise="backgroundNoiseSuppression",e.OriginalSound="originalSound",e}({}),Tu=function(e){return e[e.Undefined=0]="Undefined",e[e.WebGL=1]="WebGL",e[e.WebGPU=2]="WebGPU",e[e.WebGL2=3]="WebGL2",e}({}),Ru=function(e){return e[e.H323=1]="H323",e[e.SIP=2]="SIP",e}({}),Ou=function(e){return e[e.Success=0]="Success",e[e.Ringing=1]="Ringing",e[e.Timeout=2]="Timeout",e[e.Busy=101]="Busy",e[e.Fail=104]="Fail",e}({});const Pu="RECEIVE_VIDEO_ACTIVE_INDICATION",Du="RECEIVE_VIDEO_MUTE_INDICATION",ku="ASK_FOR_START_VIDEO_CONSENT",xu="RECEIVE_VIDEO_DIMENSION_CHANGE",Nu="CAPTURED_VIDEO_DIMENSION_CHANGE",Mu="CAN_NOT_DETECT_CAMERA",Fu="CAN_NOT_FIND_CAMERA",Lu="VIDEO_USER_FORBIDDEN_CAPTURE",Vu="VIDEO_CAMERA_IS_TAKEN",Bu="VIDEO_BACKGROUND_FAILED",ju="VIDEO_ESTABLISH_STREAM_ERROR",Uu="VIDEO_CAPTURE_START_SUCCESS",Hu="VIDEO_CAPTURE_STOP_RESULT",qu="VIDEO_SPOTLIGHT_CHANGE",Ku="VIDEO_FOLLOW_HOST_ORDER_CHANGE",$u="VIDEO_HOST_DRAG_LAYOUT_CHANGE",Wu="VIDEO_NEW_USER_START",Gu="VIDEO_OLD_USER_STOP",zu="VIDEO_VIRTUAL_BACKGROUND_PRELOAD_READY",Ju="VIDEO_VIRTUAL_BACKGROUND_SETTING_SUCCESS",Qu="VIDEO_STATISTIC_DATA",Yu="VIDEO_CELL_DETAILED_DATA",Zu="VIDEO_NETWORK_QUALITY_CHANGE",Xu="VIDEO_FAR_END_CAMERA_CONTROL_REQUEST",ec="VIDEO_FAR_END_CAMERA_CONTROL_RESPONSE",tc="VIDEO_FAR_END_CAMERA_IN_CONTROL_CHANGE",nc="VIDEO_FAR_END_CAMERA_CAPABILITY_CHANGE",rc="VIDEO_MASK_SETTING_SUCCESS",ic="VIDEO_CAPTURE_SDK_SUCCESS",oc="VIDEO_PREFETCH_VIDEO_FRAME_CALLBACK",sc="VIDEO_CURRENT_USER_SSRC",ac="VIDEO_RENDER_ASPECT_RATIO_CHANGE",uc={startCaptureVideo:{success:Uu,fail:[Mu,Fu,Lu,ju,Vu,Bu]},switchCameraVideo:{success:ic,fail:[Mu,Fu,Lu,Vu]},stopCaptureVideo:{success:Hu}};let cc=function(e){return e.VideoActiveChange="video-active-change",e.PeerVideoStateChange="peer-video-state-change",e.VideoSpotlightChange="video-spotlight-change",e.VideoMutedChange="video-muted-change",e.VideoCapturingChange="video-capturing-change",e.AskForStartVideoConsent="ask-for-start-video-consent",e.VideoDimensionChange="video-dimension-change",e.VideoFollowHostOrder="video-follow-host-order-change",e.VideoHostLayoutChange="video-host-layout-change",e.VideoVBPreloadChange="video-virtual-background-preload-change",e.VideoStatisticDataChange="video-statistic-data-change",e.VideoDetailedDataChange="video-detailed-data-change",e.VideoAspectRatioChange="video-aspect-ratio-change",e.NetworkQualityChange="network-quality-change",e.FarEndCameraRequestControl="far-end-camera-request-control",e.FarEndCameraResponseControl="far-end-camera-response-control",e.FarEndCameraInControlChange="far-end-camera-in-control-change",e.FarEndCameraCapabilityChange="far-end-camera-capability-change",e}({});const lc={[cc.VideoActiveChange]:[{event:Pu,payload:e=>({state:e.bVideoOn?$a.Active:$a.Inactive,userId:e.userId})}],[cc.VideoCapturingChange]:[{event:Uu,payload:()=>({state:Ga.Started})},{event:Hu,payload:e=>({state:null!=e&&e.failed?Ga.Failed:Ga.Stopped})}],[cc.VideoMutedChange]:[{event:Du,payload:e=>({state:e.isVideoMuted?Wa.Muted:Wa.Unmuted,userId:e.id})}],[cc.AskForStartVideoConsent]:[{event:ku,payload:e=>({state:e.isVideoMuted?Wa.Muted:Wa.Unmuted,userId:e.id})}],[cc.VideoSpotlightChange]:[{event:qu,payload:e=>({spotlightList:e.spotlightList&&e.spotlightList.map((e=>({userId:e})))})}],[cc.VideoDimensionChange]:[{event:xu,payload:e=>({type:"received",width:e.width,height:e.height})},{event:Nu,payload:e=>({type:"captured",width:e.width,height:e.height})}],[cc.VideoFollowHostOrder]:[{event:Ku,payload:e=>({isFollowHostOrder:e.bOn})}],[cc.VideoHostLayoutChange]:[{event:$u,payload:e=>Array.isArray(e.layout)?e.layout.map((e=>({userId:e}))):[]}],[cc.PeerVideoStateChange]:[{event:Wu,payload:e=>({action:"Start",...e})},{event:Gu,payload:e=>({action:"Stop",...e})}],[cc.VideoVBPreloadChange]:[{event:zu,payload:e=>({isReady:e})}],[cc.VideoStatisticDataChange]:[{event:Qu,payload:e=>{const{data:{rate:t,...n},...r}=null!=e?e:{data:{}};return{data:{bitrate:t,...n},...r}}}],[cc.VideoDetailedDataChange]:[{event:Yu,payload:e=>e}],[cc.VideoAspectRatioChange]:[{event:ac,payload:e=>e}],[cc.NetworkQualityChange]:[{event:Zu,payload:e=>e}],[cc.FarEndCameraRequestControl]:[{event:Xu,payload:e=>e}],[cc.FarEndCameraResponseControl]:[{event:ec,payload:e=>e}],[cc.FarEndCameraInControlChange]:[{event:tc,payload:e=>e}],[cc.FarEndCameraCapabilityChange]:[{event:nc,payload:e=>e}]},dc="AUDIO_ACTIVE_SPEAKER",hc="AUDIO_UNMUTE_CONSENT",pc="AUDIO_CURRENT_USER_JOIN_BY_VOIP",fc="AUDIO_CURRENT_USER_JOIN_BY_PHONE",gc="AUDIO_CURRENT_USER_LEAVE_AUDIO",mc="AUDIO_CURRENT_USER_MUTED",vc="AUDIO_CURRENT_USER_UNMUTED",yc="AUDIO_PARTICIPANT_AUDIO_UPDATE",Sc="AUDIO_DIALOUT_RESULT_CODE",bc="AUDIO_DIALOUT_RESULT_SUCCESS",Ec="AUDIO_DIALOUT_RESULT_FAIL",wc="AUDIO_DIALOUT_CANCEL_SUCCESS",Ic="DIALOUT_CANCEL_FAIL",_c="AUDIO_MERGE_AUDIO_INDICATION",Cc="USER_FORBIDDEN_MICROPHONE",Ac="ESTABLISH_AUDIO_STREAM_ERROR",Tc="AUDIO_AUTO_PLAY_FAILED",Rc="INVALID_DEVICE_ID",Oc="AUDIO_ALLOW_TALK_CHANGE",Pc="SHARE_AUDIO_STATE_CHANGE",Dc="AUDIO_STATISTIC_DATA",kc="AUDIO_CURRENT_USER_SSRC",xc="AUDIO_SET_SPEAKER_RESULT",Nc="AUDIO_SHARE_SECONDARY_AUDIO_SUCCESS",Mc="AUDIO_CRC_CALL_OUT_RESULT_CODE",Fc="AUDIO_CRC_CALL_OUT_RESULT_SUCCESS",Lc="AUDIO_CRC_CALL_OUT_RESULT_FAIL",Vc="AUDIO_CURRENT_AUDIO_LEVEL_CHANGE";let Bc=function(e){return e.ActiveSpeaker="active-speaker",e.UnmuteAudioConsent="unmute-audio-consent",e.CurrentAudioChange="current-audio-change",e.CurrentAudioLevelChange="current-audio-level-change",e.DialoutStateChange="dialout-state-change",e.MergeAudio="merged-audio",e.AutoPlayFailed="auto-play-audio-failed",e.AllowTalkChange="allow-talk-change",e.ShareAudioChange="share-audio-change",e.AudioStatisticDataChange="audio-statistic-data-change",e.CrcCallOutStateChange="crc-call-out-state-change",e}({});const jc={JoinComputerAudio:{success:pc,fail:[Cc,Ac]},LeaveComputerAudio:{success:gc},JoinAudioByCallMe:{success:bc,fail:[Ec]},cancelDialOut:{success:wc,fail:[Ic]},hangup:{success:gc},crcCallOut:{success:Fc,fail:[Lc]}},Uc={[Bc.ActiveSpeaker]:[{event:dc,payload:e=>e}],[Bc.UnmuteAudioConsent]:[{event:hc,payload:e=>({reason:e})}],[Bc.CurrentAudioChange]:[{event:fc,payload:()=>({action:La.Join,type:yu.Phone})},{event:pc,payload:()=>({action:La.Join,type:yu.Computer})},{event:gc,payload:e=>{let{source:t}=e;return{action:La.Leave,source:t}}},{event:mc,payload:e=>{let{source:t}=e;return{action:La.Muted,source:t}}},{event:vc,payload:e=>{let{source:t}=e;return{action:La.Unmuted,source:t}}}],[Bc.DialoutStateChange]:[{event:Sc,payload:e=>e}],[Bc.MergeAudio]:[{event:_c,payload:e=>e}],[Bc.AutoPlayFailed]:[{event:Tc,payload:()=>{}}],[Bc.AllowTalkChange]:[{event:Oc,payload:e=>({enabled:e})}],[Bc.ShareAudioChange]:[{event:Pc,payload:e=>e}],[Bc.AudioStatisticDataChange]:[{event:Dc,payload:e=>{const{data:{rate:t,...n},...r}=null!=e?e:{data:{}};return{data:{bitrate:t,...n},...r}}}],[Bc.CrcCallOutStateChange]:[{event:Mc,payload:e=>e}],[Bc.CurrentAudioLevelChange]:[{event:Vc,payload:e=>e}]},Hc="SHARE_ACTIVE_INDICATION",qc="SHARE_CHECK_CHROME_SHARING_EXTENSION",Kc="SHARE_START_DESKTOP_SHARE_FAILED",$c="SHARE_DIMENSION_CHANGE",Wc="SHARE_RECEIVED_DIMENSION_CHANGE",Gc="SHARE_VIDEO_STREAMS_END",zc="SHARE_PASSIVE_STOP_SHARE",Jc="SHARE_PASSIVE_BO_STOP",Qc="SHARE_NEW_USER_ADD",Yc="SHARE_USER_REMOVE",Zc="SHARE_USER_PAUSED",Xc="SHARE_USER_RESUMED",el="SHARE_AUTO_CHANGE_SOURCE",tl="SHARE_REMOTE_CONTROL_APPROVE",nl="SHARE_GRAB_REMOTE_CONTROL_CHANGE",rl="SHARE_REMOTE_CONTROL_CLIPBOARD_CHANGE",il="SHARE_REMOTE_CONTROL_SUCCESS",ol="SHARE_REMOTE_CONTROL_FAILED",sl="SHARE_PRIVILEGE_CHANGE",al="SHARE_READ_RECEIPT",ul="SHARE_STATISTIC_DATA",cl="SHARE_REMOTE_CONTROL_REQUEST",ll="SHARE_REMOTE_CONTROL_APP_STATUS",dl="SHARE_REMOTE_CONTROL_SESSION_STATUS",hl="SHARE_REMOTE_CONTROL_APP_SCHEME";let pl=function(e){return e.ShareActiveChange="active-share-change",e.ShareDimensionChange="share-content-dimension-change",e.SharePassiveStop="passively-stop-share",e.SharePeerStateChange="peer-share-state-change",e.ShareContentChange="share-content-change",e.SharePrivilegeChange="share-privilege-change",e.ShareReadReceipt="share-can-see-screen",e.ShareStatisticDataChange="share-statistic-data-change",e.RemoteControlApprovedChange="remote-control-approved-change",e.RemoteControlInControlChange="remote-control-in-control-change",e.RemoteControlClipboardChange="remote-control-clipboard-change",e.RemoteControlRequestChange="remote-control-request-change",e.RemoteControlAppStatusChange="remote-control-app-status-change",e.RemoteControlControlledStatusChange="remote-control-controlled-status-change",e}({});const fl={[pl.ShareActiveChange]:[{event:Hc,payload:e=>{const{isActive:t,activeUserId:n,...r}=e;return{state:t?"Active":"Inactive",userId:n,...r}}}],[pl.ShareDimensionChange]:[{event:$c,payload:e=>({type:"sended",width:e.width,height:e.height})},{event:Wc,payload:e=>({type:"received",width:e.width,height:e.height})}],[pl.SharePassiveStop]:[{event:Gc,payload:()=>({reason:Ja.StopScreenCapture})},{event:zc,payload:()=>({reason:Ja.PrivilegeChange})},{event:Jc,payload:()=>({reason:Ja.ShareFromMainSession})}],[pl.SharePeerStateChange]:[{event:Qc,payload:e=>({userId:e.id,action:"Start"})},{event:Yc,payload:e=>({userId:e.id,action:"Stop"})},{event:Zc,payload:e=>({userId:e.id,action:"Pause"})},{event:Xc,payload:e=>({userId:e.id,action:"Resume"})}],[pl.ShareContentChange]:[{event:el,payload:e=>e}],[pl.SharePrivilegeChange]:[{event:sl,payload:e=>({privilege:e})}],[pl.ShareReadReceipt]:[{event:al,payload:()=>{}}],[pl.ShareStatisticDataChange]:[{event:ul,payload:e=>{const{data:{rate:t,...n},...r}=null!=e?e:{data:{}};return{data:{bitrate:t,...n},...r}}}],[pl.RemoteControlApprovedChange]:[{event:tl,payload:e=>({state:e?za.Approved:za.Rejected})}],[pl.RemoteControlInControlChange]:[{event:nl,payload:e=>({isControlling:e})}],[pl.RemoteControlClipboardChange]:[{event:rl,payload:e=>e}],[pl.RemoteControlRequestChange]:[{event:cl,payload:e=>e}],[pl.RemoteControlAppStatusChange]:[{event:ll,payload:e=>e}],[pl.RemoteControlControlledStatusChange]:[{event:dl,payload:e=>e}]};let gl=function(e){return e.Question="question",e.UpdateQuestion="updateQuestion",e.Answer="answer",e.DeleteComment="deleteComment",e.DeleteQuestion="deleteQuestion",e.Dismiss="dismiss",e.Reopen="reopen",e.Upvote="upvote",e.AnswerLive="answerLive",e}({}),ml=function(e){return e.QaSettingChange="qa-setting-change",e.QaActionChange="qa-action-change",e}({});const vl={[ml.QaSettingChange]:[{event:"QA_SETTING_OPTION_CHANGE",payload:e=>e}],[ml.QaActionChange]:[{event:"QA_NEW_ASK_QUESTION",payload:e=>({action:gl.Question,data:e})},{event:"QA_UPDATE_ANONYMOUS_QUESTION",payload:e=>({action:gl.UpdateQuestion,data:e})},{event:"QA_ANSWER_QUESTION",payload:e=>({action:gl.Answer,data:e})},{event:"QA_ANSWER_REMOVE_COMMENT",payload:e=>({action:gl.DeleteComment,data:e})},{event:"QA_ANSWER_REMOVE_QUESTION",payload:e=>({action:gl.DeleteQuestion,data:e})},{event:"QA_ANSWER_DISMISS_QUESTION",payload:e=>({action:gl.Dismiss,data:e})},{event:"QA_ANSWER_REOPEN_QUESTION",payload:e=>({action:gl.Reopen,data:e})},{event:"QA_ANSWER_VOTE_QUESTION",payload:e=>({action:gl.Upvote,data:e})},{event:"QA_ANSWER_QUESTION_LIVE",payload:e=>({action:gl.AnswerLive,data:e})}]},yl="INVALID_OPERATION",Sl="INTERNAL_ERROR",bl="OPERATION_TIMEOUT",El="INSUFFICIENT_PRIVILEGES",wl="IMPROPER_MEETING_STATE",Il="INVALID_PARAMETERS",_l="AUDIO_ENCODE_SUCCESS",Cl="AUDIO_DECODE_SUCCESS",Al="VIDEO_ENCODE_SUCCESS",Tl="VIDEO_DECODE_SUCCESS",Rl="SHARING_ENCODE_SUCCESS",Ol="SHARING_DECODE_SUCCESS",Pl="AUDIO_ENCODE_FAIL",Dl="AUDIO_DECODE_FAIL",kl="VIDEO_ENCODE_FAIL",xl="VIDEO_DECODE_FAIL",Nl="SHARING_ENCODE_FAIL",Ml="SHARING_DECODE_FAIL",Fl="MEDIA_DEVICE_CHANGE",Ll="MEDIS_SDK_PATHCH_LOADED",Vl="AUDIO_BRIDGE_PEER_CONNECTION_RECEIVE_READY",Bl="AUDIO_BRIDGE_PEER_CONNECTION_SEND_READY",jl="DEVICE_PERMISSION_CHANGE";let Ul=function(e){return e.DeviceChange="device-change",e.MediaSDKChange="media-sdk-change",e.DevicePermissionChange="device-permission-change",e}({});const Hl={[Ul.DeviceChange]:[{event:Fl,payload:()=>({})}],[Ul.MediaSDKChange]:[{event:_l,payload:()=>({type:"audio",action:"encode",result:"success"})},{event:Pl,payload:()=>({type:"audio",action:"encode",result:"fail"})},{event:Cl,payload:()=>({type:"audio",action:"decode",result:"success"})},{event:Dl,payload:()=>({type:"audio",action:"decode",result:"fail"})},{event:Al,payload:()=>({type:"video",action:"encode",result:"success"})},{event:kl,payload:()=>({type:"video",action:"encode",result:"fail"})},{event:Tl,payload:()=>({type:"video",action:"decode",result:"success"})},{event:xl,payload:()=>({type:"video",action:"decode",result:"fail"})},{event:Rl,payload:()=>({type:"share",action:"encode",result:"success"})},{event:Nl,payload:()=>({type:"share",action:"encode",result:"fail"})},{event:Ol,payload:()=>({type:"share",action:"decode",result:"success"})},{event:Ml,payload:()=>({type:"share",action:"decode",result:"fail"})}],[Ul.DevicePermissionChange]:[{event:jl,payload:e=>e}]},ql="BREAKOUT_ROOM_ADD_TOKEN",Kl="BREAKOUT_ROOM_INVITE_TO_JOIN_NOTIFICATION",$l="BREAKOUT_ROOM_ROOM_CLOSING_COUNTDOWN",Wl="BREAKOUT_ROOM_ROOM_COUTDOWN",Gl="BREAKOUT_ROOM_BROADCAST_MESSAGE",zl="BREAKOUT_ROOM_ASK_HELP_REQUEST",Jl="BREAKOUT_ROOM_ASK_HELP_RESPONSE",Ql="BREAKOUT_ROOM_ATTRIBUTE_INDICATION",Yl="BREAKOUT_ROOM_JOIN_BO_RESPONSE",Zl="BREAKOUT_ROOM_ROOM_COUNTDOWN_TIME_UP",Xl="BREAKOUT_ROOM_CURRENT_USER_PARTICIPANT_ROLE",ed="BREAKOUT_ROOM_LOAD_PRE_ASSIGNED_ROOMS",td="BREAKOUT_ROOM_MAIN_SESSION_USER_UPDATE",nd="BREAKOUT_ROOM_INVITE_TO_BACK_NOTIFICATION",rd="BREAKOUT_ROOM_IN_ROOM_USER_STATUS_UPDATE",id="BREAKOUT_ROOM_BROADCAST_VOICE";let od=function(e){return e.InviteToJoin="invite-to-join",e.RoomCountdown="room-countdown",e.RoomTimeUp="room-time-up",e.ClosingRoomCountdown="closing-room-countdown",e.BroadcastMessage="broadcast-message",e.AskForHelp="ask-for-help",e.AskForHelpResponse="ask-for-help-response",e.RoomStateChange="room-state-change",e.MainSessionUserUpdate="main-session-user-updated",e.InviteToBack="invite-back-to-main-session",e.RoomUserUpdate="room-user-update",e.BroadcastVoice="broadcast-voice",e}({});const sd={[od.InviteToJoin]:[{event:Kl,payload:e=>e}],[od.RoomCountdown]:[{event:Wl,payload:e=>e}],[od.RoomTimeUp]:[{event:Zl,payload:e=>e}],[od.ClosingRoomCountdown]:[{event:$l,payload:e=>e}],[od.BroadcastMessage]:[{event:Gl,payload:e=>e}],[od.AskForHelp]:[{event:zl,payload:e=>e}],[od.AskForHelpResponse]:[{event:Jl,payload:e=>e}],[od.RoomStateChange]:[{event:Ql,payload:e=>({status:e.controlStatus})}],[od.MainSessionUserUpdate]:[{event:td,payload:()=>({})}],[od.InviteToBack]:[{event:nd,payload:e=>e}],[od.RoomUserUpdate]:[{event:rd,payload:e=>e}],[od.BroadcastVoice]:[{event:id,payload:e=>e}]};var ad=function(e){return e.StatusUpdate="archiving-status-update",e.OptionsUpdate="archiving-options-update",e}(ad||{});const ud={[ad.StatusUpdate]:[{event:"ARCHIVING_STATUS_UPDATE",payload:e=>e}],[ad.OptionsUpdate]:[{event:"ARCHIVING_OPTIONS_UPDATE",payload:e=>e}]};let cd=function(e){return e.PollDataChange="poll-data-change",e.PollSizeUpdate="poll-size-update",e.PollStatusUpdate="poll-status-update",e}({});const ld={[cd.PollDataChange]:[{event:"POLL_DATA_CHANGE",payload:e=>e}],[cd.PollSizeUpdate]:[{event:"POLL_SIZE_UPDATE",payload:e=>e}],[cd.PollStatusUpdate]:[{event:"POLL_STATUS_UPDATE",payload:e=>e}]};let dd=function(e){return e.ReactionReceived="reaction-received",e.ReactionRemoved="reaction-removed",e}({});const hd={[dd.ReactionReceived]:[{event:"REACTION_RECEIVED",payload:e=>e}],[dd.ReactionRemoved]:[{event:"REACTION_REMOVED",payload:e=>e}]},pd="SMART_SUMMARY_STATUS_CHANGE",fd="MEETING_QUERY_STATUS_CHANGE";let gd=function(e){return e.SummaryChange="summary-status-change",e.MeetingQueryChang="meeting-query-status-change",e}({});const md={[gd.SummaryChange]:[{event:pd,payload:e=>e}],[gd.MeetingQueryChang]:[{event:fd,payload:e=>e}]},vd="LIVE_STREAM_STATUS_CHANGE",yd={"live-stream-status":[{event:vd,payload:e=>e}]},Sd={...ea,...oa,...pa,...va,...Pa,...Uc,...lc,...vl,...fl,...Hl,...sd,...ud,"closed-caption-message":[{event:"CC_RECEIVE_MESSAGE",payload:e=>e}],"closed-caption-lt-status":[{event:"LT_STATUS_CHANGE",payload:e=>e}],"closed-caption-lt-message":[{event:"LT_RECEIVE_MESSAGE",payload:e=>e}],"closed-caption-status":[{event:"CC_ASSIGN_CC_EDITOR_SUCCESS",payload:e=>e},{event:"CC_STATUS_CHANGE",payload:e=>e}],...ld,...hd,...md,...yd},bd=function(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map((function(e){e(n)})),(r=e.get("*"))&&r.slice().map((function(e){e(t,n)}))}}}(),Ed=new Map,wd=new Array,Id=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;bd.emit(e,t)},_d=e=>new Promise(((t,n)=>{e.fail&&e.fail.length>0?pt(it(bd,e.success).pipe(gt(1)),ct(...e.fail.map((e=>it(bd,e).pipe(gt(1),Ye((t=>Le({type:e,payload:t})))))))).subscribe((e=>t(e)),(e=>{"object"==typeof e.payload?n({type:e.type,...e.payload}):void 0===e.payload?n({type:e.type}):n(e)})):it(bd,e.success).pipe(gt(1)).subscribe((e=>t(e)))})),Cd=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;return new Promise(((r,i)=>{let o=ge;"string"==typeof e?o=it(bd,e).pipe(gt(1)):(o=it(bd,e.event),e.operations&&(o=e.operations.reduce(((e,t)=>e.pipe(t)),o))),pt(o,at(n).pipe(St(Le("timeout")))).subscribe((e=>{if(t){const n=t(e);"boolean"==typeof n?n?r(""):i({type:Sl}):0===n.ret?r(n.body):i({type:Sl,reason:n.body})}else r(e)}),(()=>{i({type:bl})}))}))},Ad=(e,t)=>void 0!==t?it(bd,e).pipe(gt(t)):it(bd,e),Td=()=>{wd.forEach((e=>{e.unsubscribe()})),wd.length=0,Ed.clear()},{setAttendeesList:Rd,setAssistantList:Od,setIsAdmitAllSilentUsers:Pd,resetParticipants:Dd,addFailoverAttendees:kd,removeFailoverAttendees:xd,setClearRaiseHand:Nd,setClearAttendeeFeedback:Md,updateAttendeeDisplayName:Fd,removeXmppAttendeeUser:Ld,updateXmppAttendeeList:Vd,setAttendeeExtraKey:Bd}=In({SET_ATTENDEES_LIST:e=>e,SET_ASSISTANT_LIST:e=>e,UPDATE_XMPP_ATTENDEE_LIST:e=>e,RESET_PARTICIPANTS:()=>({}),SET_IS_ADMIT_ALL_SILENT_USERS:e=>e,REMOVE_FAILOVER_ATTENDEES:e=>e,ADD_FAILOVER_ATTENDEES:e=>e,SET_CLEAR_RAISE_HAND:()=>({}),SET_CLEAR_ATTENDEE_FEEDBACK:()=>({}),UPDATE_ATTENDEE_DISPLAY_NAME:e=>e,REMOVE_XMPP_ATTENDEE_USER:e=>e,SET_ATTENDEE_EXTRA_KEY:e=>e});var jd="NOT_FOUND",Ud=function(e,t){return e===t};function Hd(e,t){var n,r,i="object"==typeof t?t:{equalityCheck:t},o=i.equalityCheck,s=void 0===o?Ud:o,a=i.maxSize,u=void 0===a?1:a,c=i.resultEqualityCheck,l=function(e){return function(t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}}(s),d=1===u?(n=l,{get:function(e){return r&&n(r.key,e)?r.value:jd},put:function(e,t){r={key:e,value:t}},getEntries:function(){return r?[r]:[]},clear:function(){r=void 0}}):function(e,t){var n=[];function r(e){var r=n.findIndex((function(n){return t(e,n.key)}));if(r>-1){var i=n[r];return r>0&&(n.splice(r,1),n.unshift(i)),i.value}return jd}return{get:r,put:function(t,i){r(t)===jd&&(n.unshift({key:t,value:i}),n.length>e&&n.pop())},getEntries:function(){return n},clear:function(){n=[]}}}(u,l);function h(){var t=d.get(arguments);if(t===jd){if(t=e.apply(null,arguments),c){var n=d.getEntries().find((function(e){return c(e.value,t)}));n&&(t=n.value)}d.put(arguments,t)}return t}return h.clearCache=function(){return d.clear()},h}function qd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var o,s=0,a={memoizeOptions:void 0},u=r.pop();if("object"==typeof u&&(a=u,u=r.pop()),"function"!=typeof u)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof u+"]");var c=a.memoizeOptions,l=void 0===c?n:c,d=Array.isArray(l)?l:[l],h=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return"function"==typeof e?"function "+(e.name||"unnamed")+"()":typeof e})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return t}(r),p=e.apply(void 0,[function(){return s++,u.apply(null,arguments)}].concat(d)),f=e((function(){for(var e=[],t=h.length,n=0;n<t;n++)e.push(h[n].apply(null,arguments));return o=p.apply(null,e)}));return Object.assign(f,{resultFunc:u,memoizedResultFunc:p,dependencies:h,lastResult:function(){return o},recomputations:function(){return s},resetRecomputations:function(){return s=0}}),f}}var Kd=qd(Hd);const $d=e=>{let{participants:{attendeesList:t}}=e;return t},Wd=e=>{let{meeting:{userId:t}}=e;return t},Gd=e=>{let{participants:{xmppAttendeeList:t}}=e;return t};let zd=function(e){return e[e.Attendee=0]="Attendee",e[e.Host=1]="Host",e[e.Owner=4]="Owner",e[e.ViewOnly=8]="ViewOnly",e[e.HostOwner=5]="HostOwner",e[e.ViewOnlyCanTalk=24]="ViewOnlyCanTalk",e}({}),Jd=function(e){return e[e.Host=10]="Host",e[e.Panelist=20]="Panelist",e[e.Attendee=30]="Attendee",e}({}),Qd=function(e){return e[e.Client=9]="Client",e[e.Phone=5]="Phone",e[e.H323=15]="H323",e[e.Assitant=51]="Assitant",e}({});const Yd=e=>(e&zd.Host)===zd.Host,Zd=e=>(e&Qd.Phone)===Qd.Phone,Xd=e=>e===zd.ViewOnlyCanTalk,eh=e=>(e&zd.ViewOnly)===zd.ViewOnly;let th=function(e){return e[e.Automatically=1]="Automatically",e[e.Manually=2]="Manually",e[e.SelfSelect=3]="SelfSelect",e}({}),nh=function(e){return e[e.NotStarted=1]="NotStarted",e[e.InProgress=2]="InProgress",e[e.Closing=3]="Closing",e[e.Closed=4]="Closed",e}({}),rh=function(e){return e[e.NoToken=1]="NoToken",e[e.GotToken=2]="GotToken",e[e.Started=3]="Started",e[e.Closing=4]="Closing",e[e.Closed=5]="Closed",e}({}),ih=function(e){return e.Initial="initial",e.Invited="invited",e.Joining="joining",e.InRoom="in room",e.Leaving="leaving",e.TimeUp="time up",e.MainSession="main session",e}({}),oh=function(e){return e.Join="joinRequest",e.Switch="switchRequest",e.Leave="leaveRequest",e.Broadcast="messageText",e.HelpReq="helpRequest",e.HelpRes="helpResponse",e.CoHostWantJoinThisBo="wantJoinThisBO",e.BOActivity="BOActivity",e}({});const sh="Subsession";let ah=function(e){return e[e.Received=0]="Received",e[e.Busy=1]="Busy",e[e.Ignore=2]="Ignore",e[e.AlreadyInRoom=3]="AlreadyInRoom",e}({}),uh=function(e){return e[e.AskToLeave=0]="AskToLeave",e[e.ClosingRoom=1]="ClosingRoom",e}({}),ch=function(e){return e[e.Active=0]="Active",e[e.Ask=1]="Ask",e}({}),lh=function(e){return e[e.Connect=1]="Connect",e[e.Muted=2]="Muted",e[e.Voip=4]="Voip",e}({}),dh=function(e){return e[e.Connect=8]="Connect",e[e.On=16]="On",e}({}),hh=function(e){return e[e.Share=32]="Share",e[e.ShareAudio=64]="ShareAudio",e}({});const ph=e=>{let{breakoutRoom:t}=e;return t&&t.controlStatus},fh=e=>{let{breakoutRoom:t}=e;return t&&t.currentRoom.status},gh=Kd([Wd,$d],((e,t)=>t.find((t=>t.userId===e)))),mh=Kd([gh],(e=>(null==e?void 0:e.isHost)||(null==e?void 0:e.bCoHost))),vh=Kd([gh],(e=>null==e?void 0:e.isHost)),yh=Kd([Gd],(e=>e.filter((e=>e.userRole===Jd.Attendee)))),Sh=Kd([$d],(e=>e.filter((e=>e.bHold&&!e.bid)))),bh=Kd([$d,ph,fh],((e,t,n)=>t!==nh.InProgress&&t!==nh.Closing||n!==ih.InRoom?e.filter((e=>!e.bHold&&!e.bid)):e.filter((e=>!e.bHold)))),Eh=Kd([e=>{let{participants:{assistantList:t}}=e;return t}],(e=>e)),wh=Kd([bh],(e=>e.find((e=>e.isHost)))),Ih=Kd([bh],(e=>e.filter((e=>e.bCoHost)))),_h=Kd([gh,bh],((e,t)=>t.filter((t=>t.userId!==(null==e?void 0:e.userId)))));Kd([Gd],(e=>e.reduce(((e,t)=>{const{jid:n}=t;return Object.assign(e,{[n]:t}),e}),{}))),Kd([Gd,e=>{let{meeting:{jid:t}}=e;return t}],((e,t)=>{var n;return null===(n=e.find((e=>e.jid===t)))||void 0===n?void 0:n.userId}));const Ch=Kd([$d],(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).some((e=>(null==e?void 0:e.bLocalRecord)===ba.Start))})),Ah=Kd([ph,e=>{let{meeting:t}=e;return t&&t.meetingOptions},$d,vh],((e,t,n,r)=>{const i=n.filter((e=>e.bCoHost)),{moveToWRIfHostLeave:o}=t,s=e===nh.InProgress;return r&&!!o&&i.length<=0&&!s&&n.length>1}));Kd([$d,fh,e=>{let{breakoutRoom:t}=e;return t&&t.mainSessionAttendeeList}],((e,t,n)=>(t===ih.InRoom?n:e).filter((e=>{return!(e.bHold||e.isHost||e.audio===yu.Phone||Zd(null==e?void 0:e.userType)||(t=null==e?void 0:e.caps,n=null==e?void 0:e.bMultiStreamVideoUser,((e,t)=>(e=>!!(128&e))(e)&&void 0!==t)(t,n)&&n));var t,n}))));let Th=function(e){return e.Closed="closed",e.Connecting="connecting",e.Connected="connected",e}({});function Rh(e){return 1<<e-1}let Oh=function(e){return e[e.SupportASL=Rh(1)]="SupportASL",e[e.SidecarPhase2=Rh(2)]="SidecarPhase2",e[e.SupportBroadcastVoice=Rh(4)]="SupportBroadcastVoice",e[e.SendMeetingTokenSeparately=Rh(5)]="SendMeetingTokenSeparately",e[e.SupportPreview=Rh(6)]="SupportPreview",e[e.WebCameraIndication=Rh(7)]="WebCameraIndication",e[e.SupportFarEndCameraControl=Rh(9)]="SupportFarEndCameraControl",e[e.SupportVideoShare=Rh(10)]="SupportVideoShare",e[e.UnifyErrorType=Rh(11)]="UnifyErrorType",e[e.WhiteBoard=Rh(12)]="WhiteBoard",e[e.RequestRemoteControl=Rh(14)]="RequestRemoteControl",e[e.SmartSummary=Rh(15)]="SmartSummary",e[e.LocalRecording=Rh(16)]="LocalRecording",e[e.LocalRecordingGrantPermission=Rh(17)]="LocalRecordingGrantPermission",e[e.ShareMultiStream=Rh(18)]="ShareMultiStream",e[e.VideoLTR=Rh(19)]="VideoLTR",e[e.WebrtcAudioRtcpTime=Rh(20)]="WebrtcAudioRtcpTime",e[e.SupportSend1080PVideo=Rh(29)]="SupportSend1080PVideo",e[e.SupportSend1080PVideoShare=Rh(30)]="SupportSend1080PVideoShare",e}({});const{setAsnIds:Ph,setIsCanUnmute:Dh,setDialoutSequence:kh,setDialoutResultCode:xh,setIsAllowToTalk:Nh,setAudioSsrc:Mh,setIsMutedUponEntry:Fh,setIsUserGrantCaptureAudio:Lh,setIsMicrophoneForbidden:Vh,setWebrtcRestartCount:Bh,setMicrophoneList:jh,setSpeakerList:Uh,setActiveMicrophone:Hh,setActiveSpeaker:qh,setCanPlayAudio:Kh,resetAudio:$h,setIsComputerAudioLoading:Wh,setIsAllowToTalkAttendeeConnected:Gh,setIsMuteBeforeSharingAudio:zh,addLocalShareAudioUser:Jh,updateLocalShareAudioUser:Qh,setIsJoinComputerAudioBeforeSharingAudio:Yh,setIsShareAudioEnabled:Zh,setIsShareAudioMuted:Xh,setIsSharingAudio:ep,setAudioDataEncoding:tp,setAudioDataDecoding:np,addLocallyMutedAudio:rp,removeLocallyMutedAudio:ip,updateUserAudioVolumeLocally:op,removeLocalUserAudioVolume:sp,setCustomizedAudioOption:ap,setIsBackgroundNoiseSuppression:up,setIsHidEnabled:cp,setAudioMediaPlaybackFile:lp,setIsStopAllIncomingAudio:dp,setIsVerifiedAudioPermissionOnIosMobile:hp,setIsAudioBridgeSignalReconnecting:pp,setAudioMutedSource:fp,setAudioUnmutedSource:gp,setAudioOriginalSound:mp,setLeaveAudioSource:vp,setSecondaryAudioMicrophoneId:yp,setCrcCallOutSequence:Sp,setCrcCallOutReturnCode:bp}=In("SET_ASN_IDS","SET_IS_CAN_UNMUTE","SET_DIALOUT_SEQUENCE","SET_DIALOUT_RESULT_CODE","SET_IS_ALLOW_TO_TALK","SET_AUDIO_SSRC","SET_IS_MUTED_UPON_ENTRY","SET_IS_USER_GRANT_CAPTURE_AUDIO","SET_IS_MICROPHONE_FORBIDDEN","SET_WEBRTC_RESTART_COUNT","SET_MICROPHONE_LIST","SET_SPEAKER_LIST","SET_ACTIVE_MICROPHONE","SET_ACTIVE_SPEAKER","SET_CAN_PLAY_AUDIO","RESET_AUDIO","SET_IS_COMPUTER_AUDIO_LOADING","SET_IS_ALLOW_TO_TALK_ATTENDEE_CONNECTED","SET_IS_MUTE_BEFORE_SHARING_AUDIO","SET_IS_SHARING_AUDIO","ADD_LOCAL_SHARE_AUDIO_USER","UPDATE_LOCAL_SHARE_AUDIO_USER","SET_IS_JOIN_COMPUTER_AUDIO_BEFORE_SHARING_AUDIO","SET_IS_SHARE_AUDIO_ENABLED","SET_IS_SHARE_AUDIO_MUTED","SET_AUDIO_DATA_ENCODING","SET_AUDIO_DATA_DECODING","ADD_LOCALLY_MUTED_AUDIO","REMOVE_LOCALLY_MUTED_AUDIO","UPDATE_USER_AUDIO_VOLUME_LOCALLY","REMOVE_LOCAL_USER_AUDIO_VOLUME","SET_CUSTOMIZED_AUDIO_OPTION","SET_IS_BACKGROUND_NOISE_SUPPRESSION","SET_IS_HID_ENABLED","SET_AUDIO_MEDIA_PLAYBACK_FILE","SET_IS_STOP_ALL_INCOMING_AUDIO","SET_IS_VERIFIED_AUDIO_PERMISSION_ON_IOS_MOBILE","SET_IS_AUDIO_BRIDGE_SIGNAL_RECONNECTING","SET_AUDIO_MUTED_SOURCE","SET_AUDIO_UNMUTED_SOURCE","SET_AUDIO_ORIGINAL_SOUND","SET_LEAVE_AUDIO_SOURCE","SET_SECONDARY_AUDIO_MICROPHONE_ID","SET_CRC_CALL_OUT_SEQUENCE","SET_CRC_CALL_OUT_RETURN_CODE"),{setSharePrivilege:Ep,setShareActiveNode:wp,setIsReceiveSharing:Ip,setIsChromeExtensionInstalled:_p,setIsScreenShareForbidden:Cp,setShareDimension:Ap,setShareStatus:Tp,setShareSsrc:Rp,setShareQuality:Op,setReceivedShareDimension:Pp,setIsGrabRemoteControl:Dp,setIsSdkGrabControl:kp,setIsReceiveSharingFromMainSession:xp,setIsSharingToBreakoutRoom:Np,setIsSharingWithSecondCamera:Mp,setShringSecondCameraId:Fp,setIsRequireReadReceipt:Lp,setIsOptimizedForSharedVideo:Vp,setShareDataEncoding:Bp,setShareDataDecoding:jp,addShareCapturedEnsuredCanvas:Up,addShareRenderedEnsuredCanvas:Hp,setRemoteControlCurrentSsrc:qp,setRemoteControllingSsrc:Kp,setApprovedRemoteControlSsrc:$p,setRemoteControlAppDownloadUrl:Wp,setRemoteControlAppInstallStatus:Gp,remoteControlAppStatusFallbackCheck:zp,remoteControlAppLaunchedCheck:Jp,setIsEnableAutoDeleteRcApp:Qp,setRemoteControlAppLaunchSheme:Yp,addSharingUserIdSsrcMapping:Zp,addRemoteControlledUser:Xp,removeRemoteControlledUser:ef,setRemoteControlSetting:tf,setRemoteControlViewportDomSelector:nf,setIsFullHdVideoShareEnabled:rf,resetShare:of}=In("SET_SHARE_PRIVILEGE","SET_SHARE_ACTIVE_NODE","SET_IS_RECEIVE_SHARING","SET_IS_CHROME_EXTENSION_INSTALLED","SET_IS_SCREEN_SHARE_FORBIDDEN","SET_SHARE_DIMENSION","SET_SHARE_STATUS","SET_SHARE_SSRC","SET_SHARE_QUALITY","SET_RECEIVED_SHARE_DIMENSION","SET_IS_GRAB_REMOTE_CONTROL","SET_IS_SDK_GRAB_CONTROL","SET_IS_RECEIVE_SHARING_FROM_MAIN_SESSION","SET_IS_SHARING_TO_BREAKOUT_ROOM","SET_IS_SHARING_WITH_SECOND_CAMERA","SET_SHRING_SECOND_CAMERA_ID","SET_IS_REQUIRE_READ_RECEIPT","SET_IS_OPTIMIZED_FOR_SHARED_VIDEO","SET_SHARE_DATA_ENCODING","SET_SHARE_DATA_DECODING","ADD_SHARE_CAPTURED_ENSURED_CANVAS","ADD_SHARE_RENDERED_ENSURED_CANVAS","SET_REMOTE_CONTROL_CURRENT_SSRC","SET_REMOTE_CONTROLLING_SSRC","SET_APPROVED_REMOTE_CONTROL_SSRC","SET_REMOTE_CONTROL_APP_DOWNLOAD_URL","SET_REMOTE_CONTROL_APP_INSTALL_STATUS","REMOTE_CONTROL_APP_STATUS_FALLBACK_CHECK","REMOTE_CONTROL_APP_LAUNCHED_CHECK","SET_IS_ENABLE_AUTO_DELETE_RC_APP","SET_REMOTE_CONTROL_APP_LAUNCH_SHEME","ADD_SHARING_USER_ID_SSRC_MAPPING","ADD_REMOTE_CONTROLLED_USER","REMOVE_REMOTE_CONTROLLED_USER","SET_REMOTE_CONTROL_SETTING","SET_REMOTE_CONTROL_VIEWPORT_DOM_SELECTOR","SET_IS_FULL_HD_VIDEO_SHARE_ENABLED","RESET_SHARE"),{setVideoSsrc:sf,setActiveVideoId:af,setCameraList:uf,setActiveCamera:cf,setIsCurrentUserStartedVideo:lf,setSpotlightVideo:df,setIsCaptureForbidden:hf,setVideoMaxQuality:pf,setIsVideoMuted:ff,setIsCaptureCameraLoading:gf,setIsCameraTaken:mf,resetVideo:vf,setReceivedVideoDimension:yf,addSubscribedVideoId:Sf,removeSubscribedVideoId:bf,setIsFollowHostVideoLayout:Ef,setHostDragLayout:wf,addRenderedVideoId:If,removeRenderedVideoId:_f,setIsSupportHdVideo:Cf,setMaximumNumbeOfHdSubscriptions:Af,setIsCanUnmuteVideo:Tf,setIsVbPreloadReady:Rf,setIsVbConfiged:Of,setVbImageSrc:Pf,setVideoDataEncoding:Df,setVideoDataDecoding:kf,setHardwareAccelerationState:xf,setVideoCaptureCustomizedOption:Nf,setNetworkQuality:Mf,setVideoCameraPtzCapabilities:Ff,setIsCurrentUserRequestCameraControlled:Lf,setIsCurrentUserCameraInControl:Vf,addVideoFarEndCameraControlUser:Bf,removeVideoFarEndCameraControlUser:jf,setVideoPtzCameraMoving:Uf,setVideoPtzCameraValue:Hf,setIsControllingFarEndCamera:qf,setNetworkQualityBroadcastTime:Kf,setIsMaskConfiged:$f,setVideoBackgroundMode:Wf,setVideoMask:Gf,setVideoCapturedDimension:zf,addVideoRenderedEnsuredCanvas:Jf,setVideoMediaPlaybackFile:Qf,setPrefetchedVideoUser:Yf,setVideoQosSubscriptionStatus:Zf,setIsSupportFullHdVideo:Xf,addVideoPlayerAttachment:eg,removeVideoPlayerAttachment:tg,setIsWebGl2RendererType:ng,setIsWebGpuRendererType:rg,setVideoRendererType:ig,setIsVideoMirrored:og,addSelfPreviewVideoTag:sg,removeSelfPreviewVideoTag:ag}=In("SET_VIDEO_SSRC","SET_ACTIVE_VIDEO_ID","SET_CAMERA_LIST","SET_ACTIVE_CAMERA","SET_IS_CURRENT_USER_STARTED_VIDEO","SET_SPOTLIGHT_VIDEO","SET_IS_CAPTURE_FORBIDDEN","SET_VIDEO_MAX_QUALITY","SET_IS_VIDEO_MUTED","SET_IS_CAPTURE_CAMERA_LOADING","SET_IS_CAMERA_TAKEN","RESET_VIDEO","SET_RECEIVED_VIDEO_DIMENSION","ADD_SUBSCRIBED_VIDEO_ID","REMOVE_SUBSCRIBED_VIDEO_ID","SET_IS_FOLLOW_HOST_VIDEO_LAYOUT","SET_HOST_DRAG_LAYOUT","ADD_RENDERED_VIDEO_ID","REMOVE_RENDERED_VIDEO_ID","SET_IS_SUPPORT_HD_VIDEO","SET_MAXIMUM_NUMBE_OF_HD_SUBSCRIPTIONS","SET_IS_CAN_UNMUTE_VIDEO","SET_IS_VB_PRELOAD_READY","SET_IS_VB_CONFIGED","SET_VB_IMAGE_SRC","SET_VIDEO_DATA_ENCODING","SET_VIDEO_DATA_DECODING","SET_HARDWARE_ACCELERATION_STATE","SET_VIDEO_CAPTURE_CUSTOMIZED_OPTION","SET_NETWORK_QUALITY","SET_VIDEO_CAMERA_PTZ_CAPABILITIES","SET_IS_CURRENT_USER_REQUEST_CAMERA_CONTROLLED","SET_IS_CURRENT_USER_CAMERA_IN_CONTROL","ADD_VIDEO_FAR_END_CAMERA_CONTROL_USER","REMOVE_VIDEO_FAR_END_CAMERA_CONTROL_USER","SET_VIDEO_PTZ_CAMERA_MOVING","SET_VIDEO_PTZ_CAMERA_VALUE","SET_IS_CONTROLLING_FAR_END_CAMERA","SET_NETWORK_QUALITY_BROADCAST_TIME","SET_IS_MASK_CONFIGED","SET_VIDEO_BACKGROUND_MODE","SET_VIDEO_MASK","SET_VIDEO_CAPTURED_DIMENSION","ADD_VIDEO_RENDERED_ENSURED_CANVAS","SET_VIDEO_MEDIA_PLAYBACK_FILE","SET_PREFETCHED_VIDEO_USER","SET_VIDEO_QOS_SUBSCRIPTION_STATUS","SET_IS_SUPPORT_FULL_HD_VIDEO","ADD_VIDEO_PLAYER_ATTACHMENT","REMOVE_VIDEO_PLAYER_ATTACHMENT","SET_IS_WEB_GL2_RENDERER_TYPE","SET_IS_WEB_GPU_RENDERER_TYPE","SET_VIDEO_RENDERER_TYPE","SET_IS_VIDEO_MIRRORED","ADD_SELF_PREVIEW_VIDEO_TAG","REMOVE_SELF_PREVIEW_VIDEO_TAG"),{setQaSetting:ug,addQaQuestion:cg,addQaAnswer:lg,removeQaComment:dg,removeQaQuestion:hg,dismissQaQuestion:pg,reopenQaQuestion:fg,voteQaQuestion:gg,answerQaQuestionLive:mg,updateAttendeeAnonymousQuestion:vg,setQaEnabled:yg,resetQa:Sg}=In("SET_QA_SETTING","ADD_QA_QUESTION","ADD_QA_ANSWER","REMOVE_QA_COMMENT","REMOVE_QA_QUESTION","DISMISS_QA_QUESTION","REOPEN_QA_QUESTION","VOTE_QA_QUESTION","ANSWER_QA_QUESTION_LIVE","UPDATE_ATTENDEE_ANONYMOUS_QUESTION","SET_QA_ENABLED","RESET_QA"),{setChatPrivilege:bg,setPanelistChatPrivilege:Eg,addChatMessageHistory:wg,resetChat:Ig,setIsAllowAttendeeChat:_g,setLatestChatMessageId:Cg,removeChatMessage:Ag,setFileChatSetting:Tg,addChatFileRecord:Rg,updateChatFileRecord:Og,cancelSendFileChat:Pg,addFailedChatFileTransfer:Dg,setChatFileMessageId:kg,cancelDownloadFileChat:xg}=In("SET_CHAT_PRIVILEGE","SET_PANELIST_CHAT_PRIVILEGE","ADD_CHAT_MESSAGE_HISTORY","RESET_CHAT","SET_IS_ALLOW_ATTENDEE_CHAT","SET_LATEST_CHAT_MESSAGE_ID","REMOVE_CHAT_MESSAGE","SET_FILE_CHAT_SETTING","ADD_CHAT_FILE_RECORD","UPDATE_CHAT_FILE_RECORD","CANCEL_SEND_FILE_CHAT","ADD_FAILED_CHAT_FILE_TRANSFER","SET_CHAT_FILE_MESSAGE_ID","CANCEL_DOWNLOAD_FILE_CHAT"),{setCcEditorInfo:Ng,setTempSendCcText:Mg,setCcLtMessage:Fg,setTempReceiveLtText:Lg,setTempReceiveCcText:Vg,setGatewayInfoList:Bg,setLtEnable:jg,setIsListenClosedCaption:Ug,setCcEnable:Hg,allowParticipantAskLt:qg,receiveAskStartLt:Kg,setMeetingEnabledLtFeature:$g,updateLtStatus:Wg,deleteMessage:Gg,updateMessage:zg,resetClosedCaption:Jg}=In("SET_CC_EDITOR_INFO","SET_CC_LT_MESSAGE","SET_TEMP_SEND_CC_TEXT","SET_TEMP_RECEIVE_LT_TEXT","SET_TEMP_RECEIVE_CC_TEXT","SET_GATEWAY_INFO_LIST","SET_LT_ENABLE","SET_IS_LISTEN_CLOSED_CAPTION","SET_CC_ENABLE","ALLOW_PARTICIPANT_ASK_LT","RECEIVE_ASK_START_LT","SET_MEETING_ENABLED_LT_FEATURE","UPDATE_LT_STATUS","DELETE_MESSAGE","UPDATE_MESSAGE","RESET_CLOSED_CAPTION"),{addBreakoutRooms:Qg,setBreakoutRoomAllocationPattern:Yg,setBreakoutRoomSequenceId:Zg,setMeetingElapsedTime:Xg,setStartRoomElapsedTime:em,setBreakoutRoomOptions:tm,setBreakoutRoomControlStatus:nm,setBreakoutRooms:rm,setCurrentBreakoutRoom:im,setBreakoutRoomAttendeeStatus:om,setBreakoutRoomConfId:sm,setBreakoutRoomToken:am,resetBreakoutRoom:um,setBreakoutRoomClosingRoomTime:cm,setBreakoutRoomBroadcastMessage:lm,setBreakoutRoomHostReplyType:dm,setBreakoutRoomHostReplyRequestId:hm,setMainSessionAttendeeList:pm,setIsHugeBreakoutRoom:fm,setBreakoutRoomPreAssignedRoomList:gm,setBreakoutRoomUserRoleUpdated:mm,setBreakoutRoomMeetingOptions:vm,setBreakoutRoomUserActivityStatus:ym,setBreakoutRoomIsBroadcastVoice:Sm}=In("ADD_BREAKOUT_ROOMS","SET_BREAKOUT_ROOM_ALLOCATION_PATTERN","SET_BREAKOUT_ROOM_SEQUENCE_ID","SET_MEETING_ELAPSED_TIME","SET_START_ROOM_ELAPSED_TIME","SET_BREAKOUT_ROOM_OPTIONS","SET_BREAKOUT_ROOM_CONTROL_STATUS","SET_BREAKOUT_ROOMS","SET_CURRENT_BREAKOUT_ROOM","SET_BREAKOUT_ROOM_ATTENDEE_STATUS","SET_BREAKOUT_ROOM_CONF_ID","SET_BREAKOUT_ROOM_TOKEN","RESET_BREAKOUT_ROOM","SET_BREAKOUT_ROOM_CLOSING_ROOM_TIME","SET_BREAKOUT_ROOM_BROADCAST_MESSAGE","SET_BREAKOUT_ROOM_HOST_REPLY_TYPE","SET_BREAKOUT_ROOM_HOST_REPLY_REQUEST_ID","SET_MAIN_SESSION_ATTENDEE_LIST","SET_IS_HUGE_BREAKOUT_ROOM","SET_BREAKOUT_ROOM_PRE_ASSIGNED_ROOM_LIST","SET_BREAKOUT_ROOM_USER_ROLE_UPDATED","SET_BREAKOUT_ROOM_MEETING_OPTIONS","SET_BREAKOUT_ROOM_USER_ACTIVITY_STATUS","SET_BREAKOUT_ROOM_IS_BROADCAST_VOICE"),{setCloudRecordingStatus:bm,setCloudRecordingEnable:Em,setCloudIsoRecordingEnable:wm,setAllowStopAutoRecording:Im,setAutomaticCloudRecordingEnable:_m,setIsZoomIQ:Cm,setZoomIQChanging:Am,setLocalRecordStatus:Tm,setSupportLocalRecording:Rm,setLocalGrantPermissionOption:Om,setLocalPermissionUserList:Pm,resetRecording:Dm}=In("SET_CLOUD_RECORDING_STATUS","SET_CLOUD_RECORDING_ENABLE","SET_CLOUD_ISO_RECORDING_ENABLE","SET_ALLOW_STOP_AUTO_RECORDING","SET_AUTOMATIC_CLOUD_RECORDING_ENABLE","SET_IS_ZOOM_I_Q","SET_ZOOM_I_Q_CHANGING","SET_LOCAL_RECORD_STATUS","SET_SUPPORT_LOCAL_RECORDING","SET_LOCAL_GRANT_PERMISSION_OPTION","SET_LOCAL_PERMISSION_USER_LIST","RESET_RECORDING"),{updateCmdJid:km,removeCmdJid:xm,setCmdChannelConnectionStatus:Nm,resetCmdChannel:Mm}=In("UPDATE_CMD_JID","REMOVE_CMD_JID","SET_CMD_CHANNEL_CONNECTION_STATUS","RESET_CMD_CHANNEL"),{setArchivingStatus:Fm,setArchivingSessionReady:Lm,setArchivingOptions:Vm,resetArchiving:Bm}=In({SET_ARCHIVING_STATUS:e=>e,SET_ARCHIVING_SESSION_READY:e=>e,SET_ARCHIVING_OPTIONS:e=>e,RESET_ARCHIVING:()=>{}}),{setIsLiveTranscriptionEnabled:jm,setLiveTranscriptionMeetingOptions:Um,setIsLiveTranscriptionManualCaptionerEnabled:Hm,setLiveTranscriptionGatewayId:qm,setLiveTranscriptionSupportedLanguage:Km,setIsLiveTranscriptionSubscribed:$m,setCurrentTranscriptionLang:Wm,setCurrentTranslationLang:Gm,addLiveTranscriptionMessage:zm,updateLiveTranscriptionMessage:Jm,reduceLiveTranscriptionMessages:Qm,setLiveTranscriptionEngineType:Ym,removeLiveTranscriptionFailoverState:Zm,setLiveTranscriptionLastCaptionMessage:Xm,resetLiveTranscription:ev,setIsHostDisableCaptions:tv}=In("SET_IS_LIVE_TRANSCRIPTION_ENABLED","SET_LIVE_TRANSCRIPTION_MEETING_OPTIONS","SET_IS_LIVE_TRANSCRIPTION_MANUAL_CAPTIONER_ENABLED","SET_LIVE_TRANSCRIPTION_GATEWAY_ID","SET_LIVE_TRANSCRIPTION_SUPPORTED_LANGUAGE","SET_IS_LIVE_TRANSCRIPTION_SUBSCRIBED","SET_CURRENT_TRANSCRIPTION_LANG","SET_CURRENT_TRANSLATION_LANG","ADD_LIVE_TRANSCRIPTION_MESSAGE","UPDATE_LIVE_TRANSCRIPTION_MESSAGE","REDUCE_LIVE_TRANSCRIPTION_MESSAGES","SET_LIVE_TRANSCRIPTION_ENGINE_TYPE","REMOVE_LIVE_TRANSCRIPTION_FAILOVER_STATE","SET_LIVE_TRANSCRIPTION_LAST_CAPTION_MESSAGE","RESET_LIVE_TRANSCRIPTION"," SET_IS_HOST_DISABLE_CAPTIONS"),{setPollData:nv,setPollingId:rv,setPollingWebLinks:iv,setPollingDocMaxSize:ov,setPollingDocSize:sv,setPollingDocLibraryMaxSize:av,setPollingDocLibrarySize:uv,resetPoll:cv}=In("SET_POLL_DATA","SET_POLLING_ID","SET_POLLING_WEB_LINKS","SET_POLLING_DOC_MAX_SIZE","SET_POLLING_DOC_SIZE","SET_POLLING_DOC_LIBRARY_MAX_SIZE","SET_POLLING_DOC_LIBRARY_SIZE","RESET_POLL"),{setLoggerInitOptions:lv,setIsLaplaceInitialized:dv,resetLogger:hv}=In("SET_LOGGER_INIT_OPTIONS","SET_IS_LAPLACE_INITIALIZED","RESET_LOGGER"),{setIsLiveStreamEnable:pv,setLiveStreamStatus:fv,resetLiveStream:gv}=In("SET_IS_LIVE_STREAM_ENABLE","SET_LIVE_STREAM_STATUS","RESET_LIVE_STREAM");var mv={exports:{}},vv={};!function(e,t){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},n(e,t)};function r(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i,o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},a="/";(i=e.TransformDataFormat||(e.TransformDataFormat={})).STRING="string",i.BLOB="blob",i.ARRAY_BUFFER="arraybuffer";var u=function(e){return Blob&&e instanceof Blob?"blob":ArrayBuffer&&e instanceof ArrayBuffer?"arrayBuffer":typeof e},c=[],l=function(){for(var e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t="",n=0;n<32;n++)t+=e[Math.round(61*Math.random())];return-1!==c.indexOf(t)?l():(c.push(t),t)},d=function(e){return e.arrayBuffer?e.arrayBuffer():new Promise((function(t,n){var r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(e){t(e.target&&e.target.result)},r.onerror=function(e){n(e)}}))},h=function(e){return e.text?e.text():new Promise((function(t,n){var r=new FileReader;r.readAsText(e),r.onload=function(e){t(e.target&&e.target.result)},r.onerror=function(e){n(e)}}))},p=function(e,t){return Promise.resolve(new Blob([new Uint8Array(e)],{type:t}))},f=function(e,t){var n=new Blob([e],{type:t||"text/plain"});return h(n)},g=function(e,t){return Promise.resolve(new Blob([e],{type:t||"text/plain"}))},m=function(e,t){return d(new Blob([e],{type:t||"text/plain"}))};function v(e){var t=(e||"").split(".");return t[t.length-1]||""}function y(e){var t=(e||"").lastIndexOf(a);return t<0?"":e.slice(0,t)}function S(e){var t=(e||"").lastIndexOf(a),n=t<0?e:e.slice(t+1),r=(n||"").lastIndexOf(".");return r<0?n:n.slice(0,r)}function b(e){return["png","jpg","jpeg","svg"].includes(v(e))}function E(e){return"json"===v(e)}function w(e){return"version"===v(e)}function I(e,n){return t.loadAsync(e).then((function(e){return Promise.all(e.filter((function(e,t){return!t.dir})).map((function(e){var t=function(e){return E(e.name)?"string":b(e.name)?"base64":w(e.name)?"text":"blob"}(e);return(null==n?void 0:n.setUnZipFormat)&&(t=n.setUnZipFormat(e)||t),e.async(t).then((function(n){var r=n,i=v(e.name),o="svg"===i?"svg+xml":i;return"base64"===t&&b(e.name)&&!n.startsWith("data")&&(r="data:image/"+o+";base64,"+r),{data:r,file:e}}))})))})).then((function(e){return function(e,t){return e.reduce((function(e,n){var r,i=n.data,o=n.file,s=v(o.name),u=y(o.name),c=S(o.name),l=((null==t?void 0:t.combineExtNames)||[]).includes(s)&&"string"==typeof i,d=l?""+(u?""+u+a+s:s):o.name;return l&&e.some((function(e){return e.path===d&&(e.data[c]=i,!0)}))||e.push({path:d,extName:s,data:l?(r={},r[c]=i,r):i,shouldCombine:l}),e}),[]).map((function(e){var t=e.data,n=e.shouldCombine,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["data","shouldCombine"]);return o(o({},r),{data:n?JSON.stringify(t):t})}))}(e,n)}))}function _(t,n){var r=n||{},i=r.encoding,o=r.blobType,s=r.unZipOptions;if(function(e){return"blob"===u(e)&&(e.type.includes("compressed")||e.type.includes("zip"))}(t)&&!(null==s?void 0:s.disableUnZip))return I(t,s);if(!i)return Promise.resolve(t);var a=u(t),c="string"===a,l="blob"===a,v="arrayBuffer"===a;if(i===e.TransformDataFormat.BLOB){var y=t;if(c)return h(y);if(v)return d(y)}else if(i===e.TransformDataFormat.ARRAY_BUFFER){var S=t;if(c)return f(S,o);if(l)return p(S,o)}else if(i===e.TransformDataFormat.STRING){var b=t;if(l)return g(b,o);if(v)return m(b,o)}return Promise.resolve(t)}function C(e){var t=0,n=!1,r=function(){t>90||n||(e(t+=(100-t)/50),requestAnimationFrame(r))};return r(),{finish:function(){100===t||n||(t=100,e(100))},abort:function(){100===t||n||(n=!0)},get curProgress(){return t}}}function A(){}function T(){T.init.call(this)}function R(e){return void 0===e._maxListeners?T.defaultMaxListeners:e._maxListeners}function O(e,t,n,r){var i,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]):(o=e._events=new A,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(i=R(e))&&i>0&&s.length>i){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,function(e){"function"==typeof console.warn?console.warn(e):console.log(e)}(a)}}else s=o[t]=n,++e._eventsCount;return e}function P(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function D(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function k(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}A.prototype=Object.create(null),T.EventEmitter=T,T.usingDomains=!1,T.prototype.domain=void 0,T.prototype._events=void 0,T.prototype._maxListeners=void 0,T.defaultMaxListeners=10,T.init=function(){this.domain=null,T.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new A,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},T.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},T.prototype.getMaxListeners=function(){return R(this)},T.prototype.emit=function(e){var t,n,r,i,o,s,a,u="error"===e;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=k(e,r),o=0;o<r;++o)i[o].call(n)}(n,l,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=k(e,i),s=0;s<i;++s)o[s].call(n,r)}(n,l,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,s=k(e,o),a=0;a<o;++a)s[a].call(n,r,i)}(n,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var s=e.length,a=k(e,s),u=0;u<s;++u)a[u].call(n,r,i,o)}(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=k(e,i),s=0;s<i;++s)o[s].apply(n,r)}(n,l,this,i)}return!0},T.prototype.addListener=function(e,t){return O(this,e,t,!1)},T.prototype.on=T.prototype.addListener,T.prototype.prependListener=function(e,t){return O(this,e,t,!0)},T.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,P(this,e,t)),this},T.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,P(this,e,t)),this},T.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new A:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new A,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,s||t)}return this},T.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new A,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new A:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new A,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},T.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},T.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):D.call(e,t)},T.prototype.listenerCount=D,T.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var x=function(e){function t(t){var n=e.call(this)||this;return n.timeout=(null==t?void 0:t.timeout)||3e4,n}return r(t,e),t.prototype.clearTimeoutCheck=function(){this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)},t.prototype.startTimeoutCheck=function(){var e=this;!this.timeoutTimer&&!this.finished&&this.timeout>0&&(this.timeoutTimer=setTimeout((function(){e.finished||(e.finished=!0,e.data=null,e.emit("timeout")),e.clearTimeoutCheck()}),this.timeout))},t}(T),N=function(e){function t(t){var n=e.call(this,t)||this;return n.uuid=l(),n.domParams=t||{},n}return r(t,e),t.prototype.jsonp=function(){var e=this;if(!this.finished){var t=this.domParams,n=t.url,r=t.jsonpCallbackName,i=void 0===r?"callback":r,o=t.body,s=t.integrity;this.script=document.createElement("script"),s&&(this.script.integrity=s,this.script.crossOrigin="anonymous");var a="";o&&Object.entries(o).forEach((function(e){var t=e[0],n=e[1];a+=(a?"&":"")+t+"="+n})),a+=(a?"&":"")+i+"="+this.uuid,this.script.src=n+(n.includes("?")?"":"?")+a,this.jsonpCallback(),this.progressMonitory=C((function(t){e.finished||e.emit("progressUpdated",t)})),document.body.appendChild(this.script)}},t.prototype.clearSideEffect=function(e){if(void 0===e&&(e=!1),document.body.removeChild(this.script),e){var t=this.uuid;window[this.uuid]=function(){window[t]&&delete window[t]}}else delete window[this.uuid];this.script=null,this.uuid=null,this.finished=!0,this.data=null,this.clearTimeoutCheck()},t.prototype.jsonpCallback=function(){var e=this;this.script.onerror=function(t){var n;e.finished||(e.clearSideEffect(),null===(n=e.progressMonitory)||void 0===n||n.abort(),e.emit("error",new Error("string"==typeof t?t:"load jsonp script failed")))},window[this.uuid]=function(t){var n;if(!e.finished){var r=e.domParams,i=r.encoding,o=r.blobType,s=r.unZipOptions,a=r.beforeTransformData,u=r.afterTransformData;null===(n=e.progressMonitory)||void 0===n||n.finish(),e.clearSideEffect(),(a?a(t||""):Promise.resolve(t||"")).then((function(t){return _(t,{encoding:i,blobType:o,unZipOptions:s}).then((function(t){return(u?u(t):Promise.resolve(t)).then((function(t){return e.emit("finished",t)}))}))})).catch((function(t){return e.emit("error",t)}))}}},t.prototype.abort=function(){this.clearSideEffect(!0)},t}(x),M=function(e){function t(t){var n=e.call(this,t)||this;return n.socketParams=t||{},n}return r(t,e),t.prototype.write=function(e,t){e&&!this.finished&&(e instanceof Error?this.handleError(e):(this.data?this.appendData(e):this.data=e,this.handlePerCentUpdate(t)))},t.prototype.handlePerCentUpdate=function(e){void 0===e||this.finished||this.emit("progressUpdated",e)},t.prototype.handleError=function(e){this.data=null,this.finished=!0,this.clearTimeoutCheck(),this.emit("error",e)},t.prototype.appendData=function(e){u(e)===u(this.data)?"string"==typeof e?this.data+=e:Blob&&e instanceof Blob?this.data=new Blob([this.data,e],{type:e.type}):ArrayBuffer&&e instanceof ArrayBuffer&&(this.data=s(this.data,e)):this.handleError(new Error("every piece of the data format must be the same"))},t.prototype.end=function(e){var t=this;if(!this.finished){this.handlePerCentUpdate(100),e&&this.write(e);var n=this.socketParams,r=n.encoding,i=n.blobType,o=n.unZipOptions,s=n.beforeTransformData,a=n.afterTransformData;(s?s(this.data):Promise.resolve(this.data)).then((function(e){return _(e,{encoding:r,blobType:i,unZipOptions:o}).then((function(e){return(a?a(e):Promise.resolve(e)).then((function(e){return t.emit("finished",e)}))}))})).catch((function(e){return t.emit("error",e)})),this.data=null,this.finished=!0,this.clearTimeoutCheck()}},t.prototype.abort=function(){this.data=null,this.finished=!0,this.clearTimeoutCheck()},t}(x),F=function(t){function n(e){var n=t.call(this,e)||this;return n.xhrParams=e||{},n.xhrParams.headers=o({},n.xhrParams.headers||{}),n}return r(n,t),n.prototype.supportFetch=function(){return!!window.fetch&&window.AbortController&&window.Request},n.prototype.ajax=function(){var t=this;if(!this.finished)if(this.xhrParams.url){var n=this.xhrParams,r=n.headers,i=void 0===r?{}:r,s=n.url,a=n.body,u=void 0===a?{}:a,c=n.method,l=void 0===c?"POST":c,d=n.encoding,h=n.integrity;this.controller=this.supportFetch()?new AbortController:new XMLHttpRequest;var p=this.supportFetch()?C((function(e){t.finished||t.emit("progressUpdated",e)})):null;(this.supportFetch()?fetch(new Request(s,o({method:l,headers:i,body:"GET"===l?void 0:JSON.stringify(u),signal:this.controller.signal},h?{integrity:h,mode:"cors"}:{}))).then((function(t){return t.ok?d===e.TransformDataFormat.STRING?t.text():d===e.TransformDataFormat.ARRAY_BUFFER?t.arrayBuffer():t.blob():Promise.reject(new Error("xhr download "+s+" failed!"))})):new Promise((function(n,r){var o=new XMLHttpRequest;t.controller=o,o.open(l,s),o.responseType=d===e.TransformDataFormat.STRING?"text":d===e.TransformDataFormat.ARRAY_BUFFER?"arraybuffer":"blob",Object.entries(i).forEach((function(e){var t=e[0],n=e[1];o.setRequestHeader(t,n)})),o.onload=function(){var e=o.status,t=o.response,i=o.statusText;e>=200&&e<300||304===e?n(t):r(new Error(e+": "+i))},o.onprogress=function(e){var n=e||{},r=n.total,i=n.loaded;void 0===i||t.finished||(r?t.emit("progressUpdated",i/r*100):i&&!p&&(p=C((function(e){t.finished||t.emit("progressUpdated",e)}))))},o.onerror=function(){r(new Error("xhr download "+s+" failed!"))},o.send(JSON.stringify(u))}))).then((function(e){if(!t.finished){var n=t.xhrParams,r=n.encoding,i=n.blobType,o=n.unZipOptions,s=n.beforeTransformData,a=n.afterTransformData;null==p||p.finish(),t.finished=!0,t.clearTimeoutCheck(),(s?s(e):Promise.resolve(e)).then((function(e){return _(e,{encoding:r,blobType:i,unZipOptions:o}).then((function(e){return(a?a(e):Promise.resolve(e)).then((function(e){return t.emit("finished",e)}))}))})).catch((function(e){return t.emit("error",e)}))}})).catch((function(e){t.finished||(t.finished=!0,t.clearTimeoutCheck(),null==p||p.abort(),t.emit("error",e))}))}else this.emit("error",new Error("xhrDownloader url params invalid!"))},n.prototype.abort=function(){this.data=null,this.finished=!0,this.clearTimeoutCheck(),this.controller.abort()},n}(x),L=0;T.defaultMaxListeners=500;var V,B=new T,j="ThreadPoolReady",U=function(){L-=1,B.emit(j)};(V=e.DownloaderType||(e.DownloaderType={})).XHR="xhr",V.DOM="dom",V.SOCKET="socket";var H=function(t){function n(n){var r=t.call(this)||this;return r.aborted=!1,r.downloadParmas=o({type:e.DownloaderType.XHR},n),r.id=l(),r}return r(n,t),n.prototype.start=function(){var t=this;L+=1,this.progress=0,this.emit("downloadStart"),this.onDownloadStartCallback&&this.onDownloadStartCallback();var n=this.downloadParmas,r=n.type,i=n.xhrParams,o=n.domParams,s=n.socketParams;switch(r){case e.DownloaderType.DOM:this.downloader=new N(o),this.downloader.jsonp();break;case e.DownloaderType.SOCKET:this.downloader=new M(s);break;default:this.downloader=new F(i),this.downloader.ajax()}return this.downloader.startTimeoutCheck(),this.downloader.on("error",(function(e){t.emit("error",e),t.onErrorCallback&&t.onErrorCallback(e),U()})).on("finished",(function(e){t.emit("complete",e),t.onCompleteCallback&&t.onCompleteCallback(e),U()})).on("progressUpdated",(function(e){t.progress=e,t.emit("progressUpdated",e),t.onProgressUpdatedCallback&&t.onProgressUpdatedCallback(e)})).on("timeout",(function(){t.emit("timeout"),t.onTimeoutCallback&&t.onTimeoutCallback(),U()})),this},n.prototype.abort=function(){if(this.aborted)return this;this.aborted=!0,this.downloader&&!this.downloader.finished&&this.downloader.abort();var e=new Error("file download has been aborted");return this.emit("abort",e),this.onAbortCallback&&this.onAbortCallback(e),U(),this},n.prototype.onDownloadStart=function(e){return this.onDownloadStartCallback=e,this},n.prototype.onProgressUpdated=function(e){return this.onProgressUpdatedCallback=e,this},n.prototype.onError=function(e){return this.onErrorCallback=e,this},n.prototype.onComplete=function(e){return this.onCompleteCallback=e,this},n.prototype.onAbort=function(e){return this.onAbortCallback=e,this},n.prototype.onTimeout=function(e){return this.onTimeoutCallback=e,this},n.prototype.isInProgress=function(){return void 0!==this.progress},n.prototype.isFinished=function(){return 100===this.progress},n}(T),q=function(){function e(e){this.taskList=[],this.options=e||{};var t=this.options.threadLimit;if((void 0===t?6:t)>6)throw new Error("threadLimit must be lower than 6");B.on(j,this.startNextTask.bind(this))}return e.prototype.download=function(e){var t=new H(e),n=this.removeTask.bind(this,t);return t.on("abort",n),this.taskList.push(t),this.checkTaskReady(t),t},e.prototype.startNextTask=function(){var e=this.taskList.find((function(e){return!e.isInProgress()}));e&&this.checkTaskReady(e)},e.prototype.checkTaskReady=function(e){var t=this.options.threadLimit,n=void 0===t?6:t;if(!(this.taskList.findIndex((function(e){return!e.isInProgress()}))>=n||L+1>6)){var r=this.removeTask.bind(this,e);e.on("complete",r),e.on("error",r),e.on("timeout",r),setTimeout((function(){return e.start()}),0)}},e.prototype.removeTask=function(e){var t=this;this.taskList.some((function(n,r){return n===e&&(setTimeout((function(){return e.removeAllListeners()}),0),t.taskList.splice(r,1),!0)}))},e}();e.DownloadTask=H,e.IDownloadManager=q,e.appendBuffer=s,e.arrayBufferToBlob=p,e.arrayBufferToString=f,e.blobToArrayBuffer=d,e.blobToText=h,e.genUuid=l,e.getDataFormat=u,e.getExtName=v,e.getFileName=S,e.getFullPathName=y,e.isImgFile=b,e.isJsonFile=E,e.isVersionFile=w,e.monitorProgress=C,e.sep=a,e.stringToArrayBuffer=m,e.stringToBlob=g,e.transformData=_,Object.defineProperty(e,"__esModule",{value:!0})}(vv,zt(Object.freeze({__proto__:null,default:{}}))),Gt(vv),function(e,t){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},n(e,t)};function r(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)};function o(){}function s(){s.init.call(this)}function a(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var i,s,u;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),u=s[t]):(s=e._events=new o,e._eventsCount=0),u){if("function"==typeof u?u=s[t]=r?[n,u]:[u,n]:r?u.unshift(n):u.push(n),!u.warned&&(i=a(e))&&i>0&&u.length>i){u.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=u.length,function(e){"function"==typeof console.warn?console.warn(e):console.log(e)}(c)}}else u=s[t]=n,++e._eventsCount;return e}function c(e,t,n){var r=!1;function i(){e.removeListener(t,i),r||(r=!0,n.apply(e,arguments))}return i.listener=n,i}function l(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function d(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}o.prototype=Object.create(null),s.EventEmitter=s,s.usingDomains=!1,s.prototype.domain=void 0,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.init=function(){this.domain=null,s.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new o,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return a(this)},s.prototype.emit=function(e){var t,n,r,i,o,s,a,u="error"===e;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(t=arguments[1],!a){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var r=e.length,i=d(e,r),o=0;o<r;++o)i[o].call(n)}(n,l,this);break;case 2:!function(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=d(e,i),s=0;s<i;++s)o[s].call(n,r)}(n,l,this,arguments[1]);break;case 3:!function(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,s=d(e,o),a=0;a<o;++a)s[a].call(n,r,i)}(n,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var s=e.length,a=d(e,s),u=0;u<s;++u)a[u].call(n,r,i,o)}(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];!function(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=d(e,i),s=0;s<i;++s)o[s].apply(n,r)}(n,l,this,i)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,c(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,c(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,s,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new o:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){a=n[s].listener,i=s;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new o,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,i);r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new o,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new o:delete n[e]),this;if(0===arguments.length){for(var r,i=Object.keys(n),s=0;s<i.length;++s)"removeListener"!==(r=i[s])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new o,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},s.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):l.call(e,t)},s.prototype.listenerCount=l,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var h="ZipInfo:";function p(e){var t;return null===(t=null==e?void 0:e.path)||void 0===t?void 0:t.startsWith(h)}function f(e){return"string"==typeof e&&e.startsWith(h)}function g(e,t){return(Array.isArray(e)?e:[e]).some((function(e){if("number"!=typeof e.version)throw new Error("file version must be an int number");return e.version<t}))}function m(e,t){return e.reduce((function(e,n){return e.then((function(e){return t(e,n)})).catch((function(){return t(void 0,n)}))}),Promise.resolve(void 0))}var v,y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(s),S="resource",b=function(e){function n(t){var n=e.call(this)||this;if(n.ready=!1,n.openError=!1,n.isEnable()){var r=t||{},i=r.nameSpaceId,o=r.indexDbVersion;n.dbName=function(e){return"resource-manager"+(e?"-"+e:"")}(i);var s=indexedDB.open(n.dbName,o||1);s.addEventListener("error",(function(){n.openError=!0,n.checkReady(),n.emit("error",new Error("failed to open indexedDB"))})),s.addEventListener("success",(function(){n.db=s.result,n.checkReady()})),s.addEventListener("upgradeneeded",(function(){n.db=s.result,n.handleSuccess()})),setTimeout((function(){n.checkReady()}),5e3)}else n.checkReady();return n}return r(n,e),n.prototype.checkReady=function(){this.ready||(this.ready=!0,this.emit("ready"))},n.prototype.handleSuccess=function(){if(!this.db.objectStoreNames||0===this.db.objectStoreNames.length||!this.db.objectStoreNames.contains(S)){var e=this.db.createObjectStore(S,{keyPath:"path",autoIncrement:!1});e.createIndex("path","path"),e.createIndex("sourceURL","sourceURL",{unique:!1})}},n.prototype.createAction=function(e){var t=this.db.transaction([S],e||"readonly");return{trans:t,store:t.objectStore(S)}},n.prototype.handleAction=function(e,t){return new Promise((function(n,r){var i=t();e.addEventListener("complete",(function(){n(i.result)})),e.addEventListener("error",(function(){r(e.error||new Error("transaction error"))})),e.addEventListener("abort",(function(){r(e.error||new Error("transaction aborted"))}))}))},n.prototype.put=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.createAction("readwrite"),r=n.trans,i=n.store;return this.handleAction(r,(function(){return i.put.apply(i,e)}))},n.prototype.getAllKeysFromIndex=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(IDBObjectStore.prototype.getAllKeys){var r=this.createAction(),i=r.trans,o=r.store;return this.handleAction(i,(function(){var n;return(n=o.index(e)).getAllKeys.apply(n,t)}))}return this.openKeyCursor(e)},n.prototype.getAllFromIndex=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.createAction(),i=r.trans,o=r.store;return IDBObjectStore.prototype.getAll?this.handleAction(i,(function(){var n;return(n=o.index(e)).getAll.apply(n,t)})):this.openCursor(e)},n.prototype.getFromIndex=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.createAction(),i=r.trans,o=r.store;return this.handleAction(i,(function(){var n;return(n=o.index(e)).get.apply(n,t)}))},n.prototype.deleteKey=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.createAction("readwrite"),r=n.trans,i=n.store;return this.handleAction(r,(function(){return i.delete.apply(i,e)}))},n.prototype.handleCursorAction=function(e,t,n,r){return new Promise((function(i,o){t.addEventListener("success",(function(){t.result?(n(r,t.result),t.result.continue()):i(r)})),t.addEventListener("error",(function(){o(e.error||new Error("transaction error"))}))}))},n.prototype.openKeyCursor=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.createAction("readwrite"),o=i.trans,s=i.store;return this.handleCursorAction(o,(t=s.index(e)).openKeyCursor.apply(t,n),(function(e,t){return e.push(t.key),e}),[])},n.prototype.openCursor=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this.createAction("readwrite"),o=i.trans,s=i.store;return this.handleCursorAction(o,(t=s.index(e)).openCursor.apply(t,n),(function(e,t){return e.push(t.value),e}),[])},n.prototype.isEnable=function(){return!!window.indexedDB&&!this.openError},n.prototype.saveFile=function(e){return this.db?this.put(e).then((function(){return!0})):Promise.resolve(!1)},n.prototype.removeFile=function(e){var n=this;return this.db?"string"==typeof e?this.getAllKeysFromIndex("path").then((function(r){var i=(r||[]).filter((function(n){return n===e||n.startsWith(""+e+t.sep)}));return Promise.all(i.map((function(e){return n.deleteKey(e)})))})).then((function(){return!0})):this.deleteKey(e.path).then((function(){return!0})):Promise.resolve(!1)},n.prototype.clear=function(){if(!this.db)return Promise.resolve(!1);var e=this.createAction("readwrite"),t=e.trans,n=e.store;return this.handleAction(t,(function(){return n.clear()})).then((function(){return!0}))},n.prototype.findFileByPath=function(e){return this.db&&e?this.getFromIndex("path",e):Promise.resolve(void 0)},n.prototype.findFileBySourceURL=function(e){return this.db&&e?this.getAllFromIndex("sourceURL",e):Promise.resolve([])},n.prototype.isDirectory=function(e){var n=this;return this.db?new Promise((function(r){f(e)?r(!1):n.getAllKeysFromIndex("path").then((function(n){return(n||[]).some((function(n){return n.startsWith(""+e+t.sep)}))})).then(r).catch((function(){return r(!1)}))})):Promise.resolve(!1)},n.prototype.ls=function(e){var n=this;return this.db?this.getAllKeysFromIndex("path").then((function(r){var i=[];return Promise.all((r||[]).map((function(r){if(f(r))return Promise.resolve(void 0);if(e){if(r.startsWith(""+e+t.sep)){var o=r.split(""+e+t.sep)[1]||"";if(o.includes(t.sep)){var s=""+e+t.sep+o.split(t.sep)[0];return s&&!i.includes(s)?(i.push(s),Promise.resolve(s)):Promise.resolve(void 0)}return n.getFromIndex("path",r)}return Promise.resolve(void 0)}if(r.includes(t.sep)){var a=r.split(t.sep)[0]||"";return a&&!i.includes(a)?(i.push(a),Promise.resolve(a)):Promise.resolve(void 0)}return n.getFromIndex("path",r)}))).then((function(e){return e.filter((function(e){return!!e}))}))})):Promise.resolve([])},n}(y),E=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.memoryFiles=[],t}return r(n,e),n.prototype.isEnable=function(){return!0},n.prototype.saveFile=function(e){var t=this;return new Promise((function(n){t.memoryFiles.some((function(n,r){return n.path===e.path&&(t.memoryFiles.splice(r,1,e),!0)}))||t.memoryFiles.push(e),n(!0)}))},n.prototype.removeFile=function(e){var n=this;return new Promise((function(r){for(var i=n.memoryFiles.length-1;i>=0;i--){var o=n.memoryFiles[i];("string"==typeof e&&(o.path===e||o.path.startsWith(""+e+t.sep))||e.path===o.path)&&n.memoryFiles.splice(i,1)}r(!0)}))},n.prototype.clear=function(){var e=this;return new Promise((function(t){e.memoryFiles=[],t(!0)}))},n.prototype.findFileByPath=function(e){var t=this;return new Promise((function(n){n(t.memoryFiles.filter((function(t){return t.path===e}))[0])}))},n.prototype.findFileBySourceURL=function(e){var t=this;return new Promise((function(n){n(t.memoryFiles.filter((function(t){return t.sourceURL===e})))}))},n.prototype.isDirectory=function(e){var n=this;return new Promise((function(r){f(e)?r(!1):r(n.memoryFiles.some((function(n){return n.path.startsWith(""+e+t.sep)})))}))},n.prototype.ls=function(e){var n=this;return new Promise((function(r){var i=[];n.memoryFiles.forEach((function(n){if(!p(n))if(e){if(n.path.startsWith(""+e+t.sep)){var r=n.path.split(""+e+t.sep)[1]||"";if(r.includes(t.sep)){var o=""+e+t.sep+r.split(t.sep)[0];return void(o&&!i.includes(o)&&i.push(o))}i.push(n)}}else if(n.path.includes(t.sep)){var s=n.path.split(t.sep)[0]||"";s&&!i.includes(s)&&i.push(s)}else i.push(n)})),r(i)}))},n}(y),w=function(e){function n(t){var n=e.call(this)||this;if(n.isLocalAvaliable=void 0,n.isEnable()){var r=(t||{}).nameSpaceId;n.storageName=function(e){return"resource-manager"+(e?"-"+e:"")}(r)}return n}return r(n,e),n.prototype.isEnable=function(){if(void 0!==this.isLocalAvaliable)return this.isLocalAvaliable;try{this.isLocalAvaliable=!0,localStorage.setItem("privateTest","")}catch(e){this.isLocalAvaliable=!1}return this.isLocalAvaliable},n.prototype.saveFile=function(e){var t=this;return this.isEnable()?new Promise((function(n){var r=t.getLocalFile();r.some((function(t,n){return t.path===e.path&&(r.splice(n,1,e),!0)}))||r.push(e),localStorage.setItem(t.storageName,JSON.stringify(r)),n(!0)})):Promise.resolve(!1)},n.prototype.getLocalFile=function(){var e=localStorage.getItem(this.storageName),t=[];if(e)try{t=JSON.parse(e)||"[]"}catch(e){console.log(e)}return t},n.prototype.removeFile=function(e){var n=this;return this.isEnable()?new Promise((function(r){for(var i=n.getLocalFile(),o=i.length-1;o>=0;o--){var s=i[o];("string"==typeof e&&(s.path===e||s.path.startsWith(""+e+t.sep))||e.path===s.path)&&i.splice(o,1)}localStorage.setItem(n.storageName,JSON.stringify(i)),r(!0)})):Promise.resolve(!1)},n.prototype.clear=function(){var e=this;return this.isEnable()?new Promise((function(t){localStorage.removeItem(e.storageName),t(!0)})):Promise.resolve(!1)},n.prototype.findFileByPath=function(e){var t=this;return this.isEnable()?new Promise((function(n){n(t.getLocalFile().filter((function(t){return t.path===e}))[0])})):Promise.resolve(void 0)},n.prototype.findFileBySourceURL=function(e){var t=this;return this.isEnable()?new Promise((function(n){n(t.getLocalFile().filter((function(t){return t.sourceURL===e})))})):Promise.resolve([])},n.prototype.isDirectory=function(e){var n=this;return this.isEnable()?new Promise((function(r){f(e)?r(!1):r(n.getLocalFile().some((function(n){return n.path.startsWith(""+e+t.sep)})))})):Promise.resolve(!1)},n.prototype.ls=function(e){var n=this;return this.isEnable()?new Promise((function(r){var i=[];n.getLocalFile().forEach((function(n){if(!p(n))if(e){if(n.path.startsWith(""+e+t.sep)){var r=n.path.split(""+e+t.sep)[1]||"";if(r.includes(t.sep)){var o=""+e+t.sep+r.split(t.sep)[0];return void(o&&!i.includes(o)&&i.push(o))}i.push(n)}}else if(n.path.includes(t.sep)){var s=n.path.split(t.sep)[0]||"";s&&!i.includes(s)&&i.push(s)}else i.push(n)})),r(i)})):Promise.resolve([])},n}(y);(v=e.FileStoreEnum||(e.FileStoreEnum={})).MEMORY="memoryStore",v.INDEX_DB="indexedDBStore",v.STORAGE="storageStore";var I=function(n){function o(e){var t=n.call(this)||this;return t.indexedDBStore=new b(e),t.memoryStore=new E,t.storageStore=new w(e),t}return r(o,n),o.prototype.saveFile=function(t,n,r){var o=this;void 0===n&&(n=!0);var s=(r||{}).forceSpecifyStore;return(n?this.findFileByPath(t.path,r):Promise.resolve(void 0)).then((function(n){if((null==n?void 0:n.version)&&g(t,n.version))throw new Error("there is an higher version file existed already");var r=i(i({},t),{createTime:n&&n.createTime||Date.now(),updateTime:Date.now()});return s&&o[s]&&o[s].isEnable()&&(s!==e.FileStoreEnum.STORAGE||o.isLocalStorageAvaliable(r))?o[s].saveFile(r):o[o.saveToTargetStoreRule(r)].saveFile(r)}))},o.prototype.isLocalStorageAvaliable=function(e){var n=e.data;return"string"===t.getDataFormat(n)&&n.length<=102400&&this.storageStore.isEnable()},o.prototype.saveToTargetStoreRule=function(t){return this.indexedDBStore.isEnable()?e.FileStoreEnum.INDEX_DB:this.isLocalStorageAvaliable(t)?e.FileStoreEnum.STORAGE:e.FileStoreEnum.MEMORY},o.prototype.removeFile=function(e,t){var n=(t||{}).forceSpecifyStore;return n&&this[n]?this[n].removeFile(e):Promise.all([this.indexedDBStore.removeFile(e),this.storageStore.removeFile(e),this.memoryStore.removeFile(e)]).then((function(){return!0}))},o.prototype.clear=function(e){var t=(e||{}).forceSpecifyStore;return t&&this[t]?this[t].clear():Promise.all([this.indexedDBStore.clear(),this.storageStore.clear(),this.memoryStore.clear()]).then((function(){return!0}))},o.prototype.findFileByPath=function(e,t){var n=this,r=(t||{}).forceSpecifyStore;return r&&this[r]?this[r].findFileByPath(e):m(this.searchInTargetStoreRule(),(function(t,r){return t?Promise.resolve(t):n[r].findFileByPath(e)}))},o.prototype.findFileBySourceURL=function(e,t){var n=this,r=(t||{}).forceSpecifyStore;return r&&this[r]?this[r].findFileBySourceURL(e):m(this.searchInTargetStoreRule(),(function(t,r){return n[r].findFileBySourceURL(e).then((function(e){return t?t.filter((function(t){return!e.some((function(e){return e.path===t.path}))})).concat(e||[]):e||[]}))}))},o.prototype.searchInTargetStoreRule=function(){return[e.FileStoreEnum.INDEX_DB,e.FileStoreEnum.STORAGE,e.FileStoreEnum.MEMORY]},o.prototype.isDirectory=function(e){var t=this;return e?m(this.searchInTargetStoreRule(),(function(n,r){return n?Promise.resolve(!0):t[r].isDirectory(e)})):Promise.resolve(!0)},o.prototype.ls=function(e){var t=this;return this.isDirectory(e).then((function(n){if(!n)throw new Error("path: "+e+" is an invalid directory path");return m(t.searchInTargetStoreRule(),(function(n,r){return t[r].ls(e).then((function(e){return n?(e||[]).concat(n.filter((function(t){return!e.some((function(e){return"string"==typeof t?e===t:"string"!=typeof e&&e.path===t.path}))}))):e}))}))}))},o}(s),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(s),C=function(e){function n(n){var r=e.call(this)||this,i=n||{},o=i.storeOptions,s=i.downloadManagerOptions;return r.downloadManager=new t.IDownloadManager(s),r.store=new I(o),r.store.indexedDBStore.on("ready",(function(){return r.emit("ready")})),r}return r(n,e),n.prototype.getFile=function(e,t,n){var r=this,i=new _,o=Promise.resolve(void 0),s=t||{},a=s.downloadOptions,u=s.forceDownload,c=s.saveRootPath;u?o=Promise.resolve(void 0):"string"==typeof e?o=this.store.findFileByPath(e,n):(null==e?void 0:e.sourceURL)?o=this.store.findFileBySourceURL(e.sourceURL):a&&(a.domParams||a.socketParams||a.xhrParams)&&(o=this.store.findFileBySourceURL(this.genSourceURL(a)));var l=null,d=new Promise((function(e){l=e}));return i.getDownloadTask=function(){return d},o=o.then((function(e){if(e&&(!Array.isArray(e)||e.length)){var t=e;if(Array.isArray(t)){var r=t.find((function(e){return p(e)}));if(!r)return;t=t.filter((function(e){return!p(e)}));var o=r.data;if("string"!=typeof o)return;if(!JSON.parse(o||"[]").every((function(e){return t.some((function(t){return t.path===e}))})))return}if(!(null==n?void 0:n.targetVersion)||!g(t,n.targetVersion))return i.emit("checkExpire",!1),t;i.emit("checkExpire",!0)}})).then((function(t){if(!t&&a){var o=r.downloadManager.download(a);return l(o),new Promise((function(t,s){o.on("complete",(function(o){setTimeout((function(){var s=Array.isArray(o)?o.map((function(e){var t=e.data,i=e.path,o=e.extName;return{path:r.genFilePath(c,i),sourceURL:r.genSourceURL(a),data:t,fileFormat:o||r.getFileFormat(a),version:(null==n?void 0:n.targetVersion)||1}})):{path:r.genFilePath(c,void 0),sourceURL:r.genSourceURL(a),data:o,fileFormat:r.getFileFormat(a),version:(null==n?void 0:n.targetVersion)||1};if(Array.isArray(s)&&"string"==typeof e&&e){var u=s.find((function(t){return t.path===e}));t(u||s)}else t(s);i.emit("beforeSet",s),r.beforeWrite(s,n).then((function(){i.emit("afterSet")})).catch((function(e){return i.emit("afterSet",e)}))}),0)})),o.on("abort",s),o.on("error",s),o.on("timeout",(function(){return s(new Error("download timeout"))}))}))}return l(void 0),t})).catch((function(e){return l(void 0),Promise.reject(e)})),i.getResult=function(){return o},i},n.prototype.genSourceURL=function(e){var n=e.domParams,r=e.type,i=e.xhrParams;if(r===t.DownloaderType.SOCKET)return null;var o=(r===t.DownloaderType.DOM?n:i)||{},s=o.url,a=void 0===s?"":s,u=o.body;return u&&Object.keys(u).length?a+(a.includes("?")?"&":"?")+"downloadBodyParams="+JSON.stringify(u):a},n.prototype.updateFile=function(e,t){return this.saveStore(e,!0,t)},n.prototype.beforeWrite=function(e,t){var n=this;return Array.isArray(e)?Promise.all(e.concat(function(e){var t=e[0].sourceURL||"";return{path:""+h+t,sourceURL:t,data:JSON.stringify(e.map((function(e){return e.path})))}}(e)).map((function(e){return n.saveStore(e,!1,t)}))).then((function(e){return e.filter((function(e){return!p(e)}))})):this.saveStore(e,!0,t)},n.prototype.getFileFormat=function(e){var n=e||{},r=n.xhrParams,i=n.domParams,o=n.socketParams,s=n.type;return s===t.DownloaderType.DOM&&(null==i?void 0:i.fileFormat)?i.fileFormat:s===t.DownloaderType.SOCKET&&(null==o?void 0:o.fileFormat)?o.fileFormat:(null==r?void 0:r.fileFormat)?r.fileFormat:"unknow"},n.prototype.genFilePath=function(e,n){return n?""+(e||"")+(e?t.sep:"")+n:e||""},n.prototype.saveStore=function(e,t,n){return void 0===t&&(t=!0),this.store.saveFile(e,t,n).then((function(t){if(t)return e;throw new Error("fail to save file in local store")}))},n.prototype.remove=function(e,t){return this.store.removeFile(e,t)},n.prototype.clear=function(e){return this.store.clear(e)},n.prototype.list=function(e){return this.store.ls(e)},n.prototype.updateVersion=function(e,t){var n=this;return this.store.findFileByPath(e).then((function(r){if(r)return n.saveStore(i(i({},r),{version:t})).then((function(){}));throw new Error("the target path: "+e+" isn't existed")}))},n.prototype.updateSourceURL=function(e,t){var n=this;return this.store.findFileByPath(e).then((function(r){if(r)return n.saveStore(i(i({},r),{sourceURL:t})).then((function(){}));throw new Error("the target path: "+e+" isn't existed")}))},n}(s);e.IResourceManager=C,Object.defineProperty(e,"__esModule",{value:!0})}(mv.exports,vv),Gt(mv.exports);class yv{constructor(e){this._cancelError=new Error("request for lock canceled"),this._locked=void 0,this._queue=[],this._waiters=[],this._currentReleaser=void 0,e&&(this._cancelError=e),this._locked=!1}acquire(){const e=this.isLocked(),t=new Promise(((e,t)=>this._queue.push({resolve:e,reject:t})));return e||this._dispatch(),t}async runExclusive(e){const t=await this.acquire();try{return await e()}finally{t()}}async waitForUnlock(){return this.isLocked()?new Promise((e=>this._waiters.push({resolve:e}))):Promise.resolve()}isLocked(){return this._locked}release(){if(this._currentReleaser){const e=this._currentReleaser;this._currentReleaser=void 0,e()}}cancel(){this._queue.forEach((e=>e.reject(this._cancelError))),this._queue=[]}_dispatch(){const e=this._queue.shift();if(!e)return;let t=!1;this._currentReleaser=()=>{t||(t=!0,this._locked=!1,this._resolveWaiters(),this._dispatch())},this._locked=!0,e.resolve(this._currentReleaser)}_resolveWaiters(){this._waiters.forEach((e=>e.resolve())),this._waiters=[]}}function Sv(e,t,n){const r=document.createElement("script");r.type="text/javascript",r.readyState?r.onreadystatechange=()=>{"loaded"!==r.readyState&&"complete"!==r.readyState||(r.onreadystatechange=null,t())}:(r.onload=()=>{t()},r.onerror=()=>{n()}),r.src=e,window.crossOriginIsolated&&(r.crossOrigin="anonymous"),"function"==typeof document.body.append?document.getElementsByTagName("head")[0].append(r):document.getElementsByTagName("head")[0].appendChild(r)}function bv(e,t){let n=e;/^https?:\/\//.test(n)||(n=`https://${e}`);try{const e=new URL(n);if(!t)return e.href;if(t.hostname)return e.hostname;if(t.path)return e.pathname}catch(e){return""}return""}function Ev(e){if(e){var t;const n=document.getElementById(e);null==n||null===(t=n.parentNode)||void 0===t||t.removeChild(n)}}let wv="zoom.us";const Iv="3.8.0",_v=`https://dmogdx0jrul3u.cloudfront.net/${Iv}/lib/av`,Cv=`https://source.zoom.us/${Iv}/lib/av`,Av=`https://jssdk.zoomus.cn/${Iv}/lib/av`,Tv=()=>wv,Rv=(e,t,n)=>et([t,n].map(((t,n)=>{if("initial"!==t)return Me(["success"===t]);{const t=0===n?"ENCODE":"DECODE";return pt(Ad(`${e.toUpperCase()}_${t}_SUCCESS`,1).pipe(Ke((()=>!0))),Ad(`${e.toUpperCase()}_${t}_FAIL`,1).pipe(Ke((()=>!1))))}}))),Ov=e=>{const t=gh(e.value);return t?Fe(t):Ad(Vs,1).pipe(ke(le),Tt(e),Ke((e=>{let[,t]=e;return gh(t)})))};function Pv(e,t){var n,r;const i="audio"===e?null===(n=t.audio)||void 0===n?void 0:n.audioSsrc:null===(r=t.video)||void 0===r?void 0:r.videoSsrc,o="audio"===e?kc:sc;return"audio"===e&&Ho()||i?Promise.resolve():Cd(o)}const Dv=()=>Me(navigator.mediaDevices.enumerateDevices()).pipe(Ke((e=>{const t=[],n=[],r=[];return e.forEach((e=>{const{kind:i,deviceId:o,label:s}=e,a=s.replace(/\([\w,\d]+:[\w,\d]+\)/i,"").trim();switch(i){case"audioinput":"communications"===o||/ZoomAudioDevice/i.test(a)||/Zoom-\S*/.test(a)||/CubebAggregateDevice\S*/.test(a)||/Microsoft Teams Audio/i.test(a)||t.push({deviceId:o,label:a});break;case"audiooutput":"communications"===o||/ZoomAudioDevice/i.test(a)||/Microsoft Teams Audio/i.test(a)||n.push({deviceId:o,label:a});break;case"videoinput":r.push({deviceId:o,label:a})}})),{microphones:t,speakers:n,cameras:r}})));function kv(e){const{x:t,y:n,width:r,height:i}=e.getBoundingClientRect();return{scaleWidth:r,scaleHeight:i,srcOffsetX:t,srcOffsetY:n}}function xv(e){if(e){let n=e;try{const t=e.width;e.width=t}catch(r){var t;n=e.cloneNode(!0),null===(t=e.parentNode)||void 0===t||t.replaceChild(n,e)}return n}return e}function Nv(){try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(ja)}catch(e){return!1}}function Mv(){var e;return null===(e=WebAssembly)||void 0===e?void 0:e.validate(Ua)}const Fv=(()=>{const e=new yv;return{withAudioAction:t=>function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return new Promise((async(n,i)=>{let o=!1;const s=setTimeout((()=>{o=!0,e.release()}),3e4);try{await e.acquire(),o||clearTimeout(s),n(t(...r))}catch(e){o||(clearTimeout(s),i(e))}}))},processAudioAction:t=>e.acquire().then((()=>t())),completeAudioAction:()=>{e.release()},cancelAllAudioAction:()=>{e.cancel()}}})();function Lv(e){const t=["joinComputerAudio","joinSharingAudio","leaveComputerAudio","leaveSharingAudio"];return new Proxy(e,{get:(e,n)=>"string"==typeof n&&t.includes(n)?function(){return Fv.withAudioAction(e[n].bind(e))(...arguments)}:Reflect.get(e,n)})}function Vv(e){var t;const{browserVersion:n,isChrome:r,isFirefox:i,isSafari:o,isAndroidOrIOSBrowser:s,isSupportMediaStreamTrackProcessor:a,isSupportOffscreenCanvas:u}=Uo,c=Number(null==n||null===(t=n.match(/^\d+/))||void 0===t?void 0:t[0]),l=r&&c>=91,d=i&&c>=89,h=o&&ci(n,"17.4")>=0,p=navigator.hardwareConcurrency>2;let f=Ko();return e&&!f&&(f=u&&a),!s&&f&&(l||d||h)&&p}const Bv=(e,t)=>{const n=document.createElement("link");return n.rel="preload",n.href=e,n.as=t,n.crossOrigin="anonymous",n},jv=(e,t,n)=>{const r=[],i=[],o=Array.isArray(e)?e:[e];return ks.filter((e=>{var n;return o.includes(e.category)&&(e.tag===t||(null===(n=e.tag)||void 0===n?void 0:n.split(",").includes(t)))})).forEach((e=>{"worker"===e.type?r.push(`${n}${e.name}`):"wasm"===e.type&&i.push(`${n}${e.name}`)})),{workers:r,wasms:i}};function Uv(e,t,n){const r={};if("function"!=typeof window.SharedArrayBuffer){const{isIOSMobile:e,isSafari:i,isSupportOffscreenCanvas:o,isSupportMediaStreamTrackProcessor:s}=Uo,a=e||i||o&&s;Object.assign(r,{enableMultiDecodeVideoWithoutSAB:!!t&&a}),o&&s&&Object.assign(r,{enableVirtualBackgroundWithoutSAB:!!n})}return Vv(n)&&Object.assign(r,{resourceManager:mv.exports.IResourceManager,file:[{path:`${e}/vb-resource/dualModel.bin`,type:"bin"},{path:`${e}/vb-resource/tf.min.js`,type:"js"}]}),r}function Hv(e,t){const{media:{isAudioBridgeReceiveReady:n,isAudioBridgeSendReady:r},audio:{customizeAudioOption:i}}=e,o=void 0!==t?t:!(null==i||!i.speakerOnly);return et([n?Me([!0]):Ad(Vl,1).pipe(mt(!0)),r||o?Me([!0]):Ad(Bl,1).pipe(mt(!0))])}function qv(e,t,n){if(e.deviceId===t)return!0;if("default"===t){const r=n.find((e=>e.deviceId===t));if(r)return r.label.indexOf(e.label)>-1}return!1}function Kv(e){return e.find((e=>"default"===e.deviceId))}const $v=(()=>{let e,t=!1;return{watch:function(n){t=!0,e=Promise.race([n,pi((()=>!0),1e4)]).then((()=>{e=void 0,t=!1})).finally((()=>{e=void 0,t=!1}))},acquire:function(){return t&&e?e:Promise.resolve()}}})(),Wv=(e,t)=>Cd({event:Qs,operations:[ht((t=>void 0!==t[`${e}`])),gt(1)]},(n=>n[`${e}`]===t));class Gv{constructor(){this.audioPlaybackUrl=void 0,this.videoPlaybackUrl=void 0,this._audioElement=void 0,this._videoElement=void 0,this.videoSrc=void 0,this.isUsingSameFile=void 0}static getInstance(){return void 0===this.instance&&(this.instance=new Gv),this.instance}static destroyInstance(){if(this.instance){this.instance.stopAudioElement(),this.instance.stopVideoElement();const t=document.getElementById(su);var e;t&&(null===(e=t.parentNode)||void 0===e||e.removeChild(t)),this.instance=void 0}}setAudioElement(e){return void 0===this._audioElement&&(this._audioElement=new Audio),new Promise(((t,n)=>{if(this.videoSrc===e.url)this._audioElement.pause(),this.isUsingSameFile=!0,this._videoElement.muted=!1,(i=this._videoElement).currentTime>0&&!i.paused&&!i.ended&&i.readyState>2?t(""):this._videoElement.play().then((()=>{t("")})).catch((()=>{n()}));else{var r;this.isUsingSameFile=!1;const i=Uo.isFirefox?"canplay":"canplaythrough",o=()=>{this._audioElement.play().then((()=>{this._audioElement.removeEventListener(i,o),t("")}))},s=()=>{this._audioElement.removeEventListener(i,o),this._audioElement.removeEventListener("error",s),n()};this._audioElement.addEventListener(i,o),this._audioElement.addEventListener("error",s),this._audioElement.src=e.url,this._audioElement.loop=!!e.loop,gi(e.url)&&this._audioElement.setAttribute("crossorigin",""),this._audioElement.currentTime=Math.max(null!==(r=e.currentTime)&&void 0!==r?r:0,1e-4)}var i}))}setVideoElement(e){return void 0===this._videoElement&&(this._videoElement=document.createElement("video")),new Promise(((t,n)=>{var r;this.videoSrc=e.url;const i=Uo.isFirefox?"canplay":"canplaythrough",o=()=>{this._videoElement.play().then((()=>{this._videoElement.removeEventListener(i,o),t("")}))},s=()=>{this._videoElement.removeEventListener(i,o),this._videoElement.removeEventListener("error",s),n()};this._videoElement.addEventListener(i,o),this._videoElement.addEventListener("error",s),this._videoElement.src=e.url,this.isUsingSameFile||(this._videoElement.muted=!0),this._videoElement.loop=!!e.loop,this._videoElement.currentTime=null!==(r=e.currentTime)&&void 0!==r?r:0,gi(e.url)&&this._videoElement.setAttribute("crossorigin",""),Uo.isSafari&&!document.getElementById(su)&&(this._videoElement.id=su,this._videoElement.setAttribute("style","position:fixed;top:-10000px;left:-10000px"),document.body.appendChild(this._videoElement))}))}get audioElement(){return this.isUsingSameFile?this._videoElement:this._audioElement}get videoElement(){return this._videoElement}stopAudioElement(){this.isUsingSameFile||this._audioElement&&(this._audioElement.currentTime=0,this._audioElement.pause())}stopVideoElement(){this._videoElement&&this._videoElement.pause(),this.videoSrc=void 0}}Gv.instance=void 0;const zv=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{socket:{zoomSocketStatus:n,xmppSocketStatus:r,mainSessionSocketStatus:i},meeting:{meetingStatus:o}}=e,s=[];if(o===Co.Joined){var a;const t=Ls.getInstance(),n=Ps.createAgent();if((null===(a=gh(e))||void 0===a?void 0:a.audio)===yu.Computer&&t.leaveComputerAudio(),t.disconnect(),$v.watch(t.destroy()),e.video&&(e.video.subscribedVideoList.length>0&&e.video.subscribedVideoList.forEach((e=>{n.unsubscribeVideo(e)})),e.video.isCurrentUserStartedVideo&&Id(Hu)),e.share&&e.share.isReceiveSharing){const t=e.share.activeNodeId;e.share.remoteControlledUserList.length>0&&e.share.remoteControlledUserList.forEach((e=>{n.sharingRequestRemoteControl(e,!1)})),n.unsubscribeSharing(t)}Gv.destroyInstance()}if(t||(Do.clearSession(),[ko.WebclientTk,ko.WebclientZsk,ko.WebclientZtk,ko.WebclientRecordingToken].forEach((e=>{sessionStorage.removeItem(e)})),es.destroy()),n!==Th.Closed&&s.push(Dn()),r!==Th.Closed&&s.push(kn()),i!==Th.Closed&&s.push(Ln()),t){const n=gh(e);s.push(Ji({audio:null==n?void 0:n.audio,muted:null==n?void 0:n.muted,video:null==n?void 0:n.bVideoOn,isFailover:t}))}else s.push(Ji({audio:!1,muted:void 0,video:!1,isFailover:t}));return s.push(Kn(),cr(),Dd(),$h(t),of(),vf(t),Sg(),Ig(),Dm(),Jg(),um(),Mm(),Bm(),ev(t),cv(),hv(t),gv(t),ro(Co.Closed)),s},Jv=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Cd({event:Us,operations:[Ke((t=>t.find((t=>t.userId===e.userId&&(!e.key||void 0!==t[`${e.key}`]))))),ht((e=>!!e)),gt(1)]},...n)},Qv={[`${Ao.AudioBridgeEnable}`]:{mask:240,action:lo},[`${Ao.AudioDecodeInWorklet}`]:{mask:15,action:tr},[`${Ao.VideoFullHD}`]:{mask:15,action:Xf},[`${Ao.VideoShareFullHD}`]:{mask:15,action:rf},[`${Ao.WebGL2Render}`]:{mask:15,action:ng},[`${Ao.WebGPURender}`]:{mask:15,action:rg},[`${Ao.ZMKFromRWG}`]:{mask:15,action:bo}};function Yv(e){if(!e)return"";const t=e.match(/rid=(.*)/);return t?t[1]:""}function Zv(e){return B(Ke(((t,n)=>e(t,n))),ht((e=>null!=e)))}function Xv(e){return B(Ye(((t,n)=>e(t,n)||ge)))}function ey(e){return B(Ye(((t,n)=>e(t,n))),Ye((e=>Array.isArray(e)?Me(e):Fe(e))))}const ty={period:500,rules:[{peak:50,throttle:300},{peak:60,throttle:400}]},ny={[`${rs}`]:()=>({payloads:{add:[],update:[],remove:[]},onThrottle(e){e.add&&this.payloads.add.push(...e.add),e.update&&this.payloads.update.push(...e.update),e.remove&&this.payloads.remove.push(...e.remove)}})};function ry(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ty;return t=>new U((n=>{const r=new Map;let i=0,o=null;const{period:s,rules:a}=e;let u=null;o||(o=((e,t)=>{const n=performance.now();let r=0,i=!1;return setTimeout((function o(){r+=t,e();const s=performance.now()-n-r,a=setTimeout(o,Math.max(t-s,0));i&&clearTimeout(a)}),t),()=>{i=!0}})((()=>{i=0}),s));const c=Object.keys(ny),l=t.subscribe({next(e){if(e&&e.evt&&null!==o){i+=1;const{evt:t,body:o}=e,s=String(t);if(c.indexOf(s)>=0)if(u){const e=r.get(s);if(e)e.onThrottle(o);else{const e=ny[s]();e.onThrottle(o),r.set(s,e)}}else{let t=0;if(a.forEach((e=>{i>e.peak&&(t=e.throttle)})),t>0){const e=ny[s]();e.onThrottle(o),r.set(s,e),u=setTimeout((()=>{r.forEach(((e,t)=>{const r={evt:Number(t),body:e.payloads};n.next(r)})),r.clear(),u=null}),t)}else n.next(e)}else n.next(e)}else n.next(e)},error(e){n.error(e)},complete(){n.complete()}});return()=>{l.unsubscribe(),o&&(o(),o=null),i=0}}))}let iy=function(e){return e[e.Unknown=0]="Unknown",e[e.Windows=1]="Windows",e[e.Mac=2]="Mac",e[e.Pad=3]="Pad",e[e.Mobile=4]="Mobile",e[e.CallIn=5]="CallIn",e[e.Linux=6]="Linux",e[e.WebClient=7]="WebClient",e[e.ChromeOs=8]="ChromeOs",e}({});const oy=262144,sy=1048576,ay=e=>!(4&~e),uy=e=>(e&sy)===sy,cy=e=>{let{share:{isReceiveSharing:t}}=e;return t},ly=e=>{let{share:{activeNodeId:t}}=e;return t},dy=Kd([bh,cy,ly],(function(){let e=arguments.length>2?arguments[2]:void 0;if(arguments.length>1?arguments[1]:void 0){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((t=>t.userId===e&&!0===t.sharerOn));if(t){let{os:e}=t;const{pwaOS:n}=t;return"mac"===n?e=iy.Mac:"win"===n&&(e=iy.Windows),{...t,os:e}}}return null})),hy=Kd([bh],(e=>e.filter((e=>e.sharerOn)))),py=Kd([hy],(e=>e.some((e=>!!e.bVideoShare)))),fy=Kd([e=>{let{share:{remoteControlledUserList:t}}=e;return t},cy,ly],((e,t,n)=>!!t&&e.some((e=>hi(e,n)))));var gy,my=new Uint8Array(16);function vy(){if(!gy&&!(gy="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gy(my)}for(var yy,Sy,by,Ey,wy=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Iy=[],_y=0;_y<256;++_y)Iy.push((_y+256).toString(16).substr(1));function Cy(e,t,n){var r=(e=e||{}).random||(e.rng||vy)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Iy[e[t+0]]+Iy[e[t+1]]+Iy[e[t+2]]+Iy[e[t+3]]+"-"+Iy[e[t+4]]+Iy[e[t+5]]+"-"+Iy[e[t+6]]+Iy[e[t+7]]+"-"+Iy[e[t+8]]+Iy[e[t+9]]+"-"+Iy[e[t+10]]+Iy[e[t+11]]+Iy[e[t+12]]+Iy[e[t+13]]+Iy[e[t+14]]+Iy[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&wy.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n}(r)}!function(e){e[e.PLAIN=0]="PLAIN",e[e.RSA=1]="RSA",e[e.AESGCM256=2]="AESGCM256"}(yy||(yy={})),function(e){e[e.info=0]="info",e[e.debug=1]="debug",e[e.log=2]="log",e[e.warn=3]="warn",e[e.error=4]="error"}(Sy||(Sy={})),function(e){e[e.PROTECT_LOCAL_KEY=0]="PROTECT_LOCAL_KEY"}(by||(by={})),function(e){e.beforeInit="beforeInit",e.afterInit="afterInit",e.beforeLog="beforeLog",e.hitSizeLimit="hitSizeLimit",e.afterLog="afterLog",e.beforeReport="beforeReport",e.afterReport="afterReport"}(Ey||(Ey={}));class Ay{constructor(){}}var Ty,Ry={exports:{}},Oy={exports:{}},Py=zt(Object.freeze({__proto__:null,default:{}}));Oy.exports=(Ty=Ty||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==Wt&&Wt.crypto&&(n=Wt.crypto),!n)try{n=Py}catch(e){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),o={},s=o.lib={},a=s.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=s.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=s<<24-(r+o)%4*8}else for(var a=0;a<i;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new u.init(t,e)}}),c=o.enc={},l=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new u.init(n,t/2)}},d=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new u.init(n,t)}},h=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},p=s.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,i=r.words,o=r.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,l=e.min(4*c,o);if(c){for(var d=0;d<c;d+=s)this._doProcessBlock(i,d);n=i.splice(0,c),r.sigBytes-=l}return new u.init(n,l)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=p.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=o.algo={};return o}(Math),Ty),Ry.exports=function(e){return e.enc.Utf8}(Oy.exports);var Dy={exports:{}};Dy.exports=function(e){return function(){var t=e,n=t.lib.WordArray;function r(e,t,r){for(var i=[],o=0,s=0;s<t;s++)if(s%4){var a=r[e.charCodeAt(s-1)]<<s%4*2|r[e.charCodeAt(s)]>>>6-s%4*2;i[o>>>2]|=a<<24-o%4*8,o++}return n.create(i,o)}t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],o=0;o<n;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)i.push(r.charAt(s>>>6*(3-a)&63));var u=r.charAt(64);if(u)for(;i.length%4;)i.push(u);return i.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<n.length;o++)i[n.charCodeAt(o)]=o}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return r(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(Oy.exports);var ky=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};const xy=e=>{try{const t=Dy.exports.parse(e);return Ry.exports.stringify(t)}catch(t){return e}},Ny=e=>{for(var t=e.length,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n);r>127&&r<=2047?t++:r>2047&&r<=65535&&(t+=2),r>=56320&&r<=57343&&n--}return t},My=()=>ky(void 0,void 0,void 0,(function*(){return yield self.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])})),Fy=(e,t,n)=>ky(void 0,void 0,void 0,(function*(){try{return yield self.crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e)}catch(e){throw e}})),Ly=(e,t)=>{const n="string"==typeof e?function(e){const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0,r=e.length;t<r;t++)n[t]=e.charCodeAt(t);return t}(e):e;return self.crypto.subtle.encrypt({name:"RSA-OAEP"},t,n)},Vy={},By=(e,t)=>{Vy[t]=e},jy=Vy,Uy=e=>{try{return JSON.stringify(e)}catch(e){return"json stringify failed"}},Hy=e=>{try{return JSON.parse(e)}catch(t){return e}},qy=e=>{let t=0;return t+=Ny(e.message),e.tags.forEach((e=>{t+=Ny(e)})),t};class Ky{constructor(e){this.uuid="randomUUID"in self.crypto?self.crypto.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)));const{databaseName:t,maxSize:n,publicKey:r,reportUrl:i,plugins:o,idbManager:s,logManager:a,currentSize:u,externalKeys:c,codecWorkerFilePath:l}=e;this.databaseName=t,this.maxSize=n,this.publicKey=null!=r?r:"",this.reportUrl=null!=i?i:"",this.plugins=null!=o?o:[],this.idbManager=s,this.logManager=a,this.currentSize=null!=u?u:0,this.externalKeys=c,this.commonMethods=Object.assign({},jy)}getLocalAESGCM256Key(){var e;return function(e,t,n,r){return new(n||(n=Promise))((function(t,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(o,s)}a((r=r.apply(e,[])).next())}))}(this,0,void 0,(function*(){if(this.localAESGCM256Key)return this.localAESGCM256Key;this.localAESGCM256Key=yield My();const t=this.externalKeys?null===(e=this.externalKeys.filter((e=>e.usage===by.PROTECT_LOCAL_KEY))[0])||void 0===e?void 0:e.key:void 0;return yield this.idbManager.saveAESGCM256Key(this.uuid,this.localAESGCM256Key,t),this.localAESGCM256Key}))}updateCurrentSize(e){var t;let n=null!==(t=this.currentSize)&&void 0!==t?t:0;if(e instanceof Map)for(const[t,r]of e)n+=qy(r);else n+=qy(e);return this.currentSize=n,n>=this.maxSize}}const $y=(...e)=>{const t={},n=[];for(const r of e)r.forEach((e=>{t[e.id]||(t[e.id]=!0,n.push(e))}));const r=new Map;return n.sort(((e,t)=>(null==e?void 0:e.id)-(null==t?void 0:t.id))).forEach((e=>{r.set(e.id,e)})),r},Wy=(e,t)=>{const n=new Map;return t.forEach((t=>{e(t)&&n.set(t.id,t)})),n};class Gy{constructor(){this.getStore=()=>({byTag:Object.assign({},this.store.byTag),byTime:new Map(this.store.byTime)}),this.pushByTime=e=>{for(const t of e)this.store.byTime.set(t.id,t)},this.pushByTag=e=>{e.forEach((e=>{const t=e.tags;Array.isArray(t)&&t.forEach((t=>{this.store.byTag[t]||(this.store.byTag[t]=new Map),this.store.byTag[t].set(e.id,e)}))}))},this.addLog=e=>{let t=e;Array.isArray(e)||(t=[e]),this.pushByTime(t),this.pushByTag(t)},this.syncFromIDB=e=>function(e,t,n,r){return new(n||(n=Promise))((function(t,i){function o(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(o,s)}a((r=r.apply(e,[])).next())}))}(this,0,void 0,(function*(){const t=yield e.getAllLogs();this.addLog(t)})),this.reset=()=>{this.store={byTag:{},byTime:new Map}},this.deleteLogs=e=>{for(const t of e){const e=this.store.byTime.get(t);if(!e)continue;const{tags:n}=e;for(const e of n)this.store.byTag[e].delete(t);this.store.byTime.delete(t)}},this.filterStore=e=>{const t=((e,t)=>{if(!t)return e.byTime;if("string"==typeof t)return e.byTag[t]||new Map;if(Array.isArray(t)){if(t.every((e=>"string"==typeof e)))return $y(...t.map((t=>e.byTag[t])).filter((e=>Boolean(e))))}else{if("function"==typeof t)return Wy(t,e.byTime);if("object"==typeof t)if(t.tags&&t.filter){if("string"==typeof t.tags)return Wy(t.filter,e.byTag[t.tags]);if(Array.isArray(t.tags)&&t.tags.every((e=>"string"==typeof e)))return $y(...t.tags.map((n=>{const r=e.byTag[n];return r?Wy(t.filter,r):new Map})))}else{if(t.filter)return Wy(t.filter,e.byTime);if(t.tags){if("string"==typeof t)return e.byTag[t]||new Map;if(Array.isArray(t)&&t.every((e=>"string"==typeof e)))return $y(...t.map((t=>e.byTag[t])))}}else console.error("Wrong filter type")}return new Map})(this.store,e),n=new Map;for(const[e,r]of t){const t=Object.assign(Object.assign({},r),{message:Hy(xy(r.message))});n.set(e,t)}return n},this.store={byTag:{},byTime:new Map}}}function zy(e,t,n){const r=e.plugins;if(!Array.isArray(r))return n;let i=n;return r.forEach((n=>{const r=n[t];if("function"==typeof r){const t=r(e,i);t&&(i=t)}})),i}const Jy=(e,t,n,r,i,o={})=>function(e,t,n,r){return new(n||(n=Promise))((function(e,t){function i(e){try{s(r.next(e))}catch(e){t(e)}}function o(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,o)}s((r=r.apply(undefined,[])).next())}))}(0,0,void 0,(function*(){const{noCache:s,extraProperties:a={}}=o,u=((e,t,n,r,i,o)=>{const s=Array.isArray(t)?t:[t],a=Date.now();return Object.assign({message:e,logLevel:n,tags:s,encryptMode:r,timestamp:a,laplaceSessionId:i},o)})(`${t}`,n,r,i,e.uuid,a),c=zy(e,Ey.beforeLog,u);if(s)zy(e,Ey.afterLog,u);else{const{idbManager:t,logManager:n}=e,r=yield t.makeNextId();c.message=(e=>{try{const t=Ry.exports.parse(e);return Dy.exports.stringify(t)}catch(t){return e}})(c.message);const i=Object.assign(Object.assign({},c),{id:r});e.updateCurrentSize(i)&&zy(e,Ey.hitSizeLimit,i),n.addLog(i),yield t.addLog(i),zy(e,Ey.afterLog,i)}}));By(Jy,"commonLog");const Qy=e=>new Promise((t=>{const n=new XMLHttpRequest;n.open(e.type||"GET",e.url,!0),n.withCredentials=e.withCredentials,n.onerror=n=>{t({error:n,report:e.reportItem})},n.onreadystatechange=function(){if(4===n.readyState){const r=n.status;t(r>=200&&r<300?{report:e.reportItem}:{error:`Request failed, status: ${r}, responseText: ${n.responseText}`,report:e.reportItem})}},Object.entries(e.headers).forEach((([e,t])=>{t&&e&&n.setRequestHeader(e,t)})),n.send(e.data)})),Yy=(e,t=2)=>{let n=`${e}`;for(;n.length<t;)n=`0${n}`;return n},Zy=e=>{const t=new Date(e);return`${t.getUTCFullYear()}-${Yy(t.getUTCMonth()+1)}-${Yy(t.getUTCDate())} ${Yy(t.getUTCHours())}:${Yy(t.getUTCMinutes())}:${Yy(t.getUTCSeconds())}.${Yy(t.getUTCMilliseconds(),3)}`},Xy={version:"000001",flag:"0"},eS=(e,t,n)=>((e,t,n)=>Promise.all(e.map((e=>Object.assign({url:t||"",type:"POST",withCredentials:!1,headers:{},data:Uy({messages:e.messages,meta:e.meta}),reportItem:e},n))).map(Qy)))(e,t.reportUrl,n).then((e=>{e.forEach((e=>{var n;zy(t,Ey.afterReport,{report:e.report,error:null!==(n=e.error)&&void 0!==n?n:null})}))})),tS=(e,t,n)=>function(e,t,n,r){return new(n||(n=Promise))((function(e,t){function i(e){try{s(r.next(e))}catch(e){t(e)}}function o(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,o)}s((r=r.apply(undefined,[])).next())}))}(0,0,void 0,(function*(){const r=e.logManager.filterStore(t);if(!r||0===(null==r?void 0:r.size)||!n)return;const{xhrOptions:i={},additionalContext:o}=n,s=((e,t)=>Array.from(e.values()).reduce(((e,n)=>{const r=((e,t)=>{const{message:n,logLevel:r,tags:i,timestamp:o,encryptMode:s,id:a}=e,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["message","logLevel","tags","timestamp","encryptMode","id"]),c=Object.assign(Object.assign({time:Zy(o),logLevel:Sy[r],message:n,tags:i},t),u);return Uy(c)})(n,t),i=Ny(r),o=e[e.length-1];return o.currentSize+i>30720?e.push({messages:[r],ids:[n.id],currentSize:i}):(o.messages.push(r),o.ids.push(n.id),o.currentSize+=i),e}),[{messages:[],ids:[],currentSize:0}]).filter((e=>e.currentSize>0)).map((e=>({messages:e.messages.join("\n"),ids:e.ids,meta:Xy}))))(zy(e,Ey.beforeReport,r),o);eS(s,e,i)}));By(tS,"commonReport");var nS=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};const rS=(e,t,n)=>nS(void 0,void 0,void 0,(function*(){const{idbManager:r,logManager:i}=e;if(Array.isArray(n)&&(yield r.deleteLogs(n),i.deleteLogs(n),!t))return;const o=e.logManager.filterStore(t),s=[];for(const[e,t]of o)s.push(t.id);let a=s;Array.isArray(s)||(a=[s]),yield r.deleteLogs(a),i.deleteLogs(a)})),iS=e=>nS(void 0,void 0,void 0,(function*(){const{idbManager:t,logManager:n}=e;yield t.reset(),n.reset()}));function oS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sS(e){return new Promise((function(t,n){e.oncomplete=e.onsuccess=function(){return t(e.result)},e.onabort=e.onerror=function(){return n(e.error)}}))}function aS(e,t){var n=indexedDB.open(e);n.onupgradeneeded=function(){return n.result.createObjectStore(t)};var r=sS(n);return function(e,n){return r.then((function(r){return n(r.transaction(t,e).objectStore(t))}))}}var uS;function cS(){return uS||(uS=aS("keyval-store","keyval")),uS}function lS(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:cS())("readwrite",(function(t){return e.forEach((function(e){return t.delete(e)})),sS(t.transaction)}))}By(rS,"commonDelete"),By(iS,"commonReset");var dS=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};const hS={default:{queue:[],isRunning:!1,listeners:[]}},pS=e=>{let t=hS[e];return t||(t={queue:[],isRunning:!1,listeners:[]},hS[e]=t),t};function fS(e){return dS(this,void 0,void 0,(function*(){const t=pS(e),{queue:n,listeners:r}=t;for(;n.length>0&&!t.isRunning;){const r=n.shift();t.isRunning=!0;try{const e=yield r.task();r.resolution(e)}catch(e){r.rejection(e)}t.isRunning=!1,fS(e)}r.length&&r.forEach((e=>{e()}))}))}function gS(e,t){const n=pS(t);try{return new Promise(((r,i)=>{n.queue.push({task:e,resolution:r,rejection:i}),fS(t)}))}catch(e){return Promise.reject(e)}}const mS=(e,t)=>{pS(e).listeners.push(t)};var vS=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};const yS="change_meta",SS="change_log",bS=()=>Promise.resolve();class ES{constructor(e){this.waitingForReset=!1,this.resetting=!1,this.isChangingMeta=!1,this.isChangingLog=!1,this.dbFailCount={read:0,write:0},this.get=e=>function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:cS())("readonly",(function(t){return sS(t.get(e))}))}(e,this.store),this.set=(e,t)=>vS(this,void 0,void 0,(function*(){try{return!(this.dbFailCount.write>3)&&(yield function(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:cS())("readwrite",(function(n){return n.put(t,e),sS(n.transaction)}))}(e,t,this.store))}catch(n){n instanceof DOMException&&(n&&"QuotaExceededError"===n.name?(yield this.deleteOldLogsForSetNewOne(),yield this.set(e,t)):this.dbFailCount.write+=1),console.error(n)}})),this.deleteOldLogsForSetNewOne=()=>vS(this,void 0,void 0,(function*(){var e;const t=yield this.getAllLogs(),n=[];for(let r=0;r<13;r++){const i=null===(e=t[r])||void 0===e?void 0:e.id;(i||0===i)&&n.push(`${i}`)}return lS(n,this.store)})),this.adjustMaxId=()=>vS(this,void 0,void 0,(function*(){return this.resetting?bS():(this.isChangingMeta=!0,yield gS((()=>vS(this,void 0,void 0,(function*(){var e;const t=yield this.getAllLogs(),n=t[t.length-1],r=null!==(e=null==n?void 0:n.id)&&void 0!==e?e:0;return yield this.set("maxId",r),r}))),yS))})),this.makeNextId=()=>vS(this,void 0,void 0,(function*(){return this.resetting?bS():(this.isChangingMeta=!0,yield gS((()=>vS(this,void 0,void 0,(function*(){const e=yield this.get("maxId");if(!e&&0!==e)return yield this.set("maxId",0),0;const t=e+1;return yield this.set("maxId",t),t}))),yS))})),this.addLog=e=>vS(this,void 0,void 0,(function*(){if(this.resetting)return bS();this.isChangingLog=!0,yield gS((()=>vS(this,void 0,void 0,(function*(){const{id:t}=e;return this.set(`${t}`,e)}))),SS)})),this.getAllLogs=()=>vS(this,void 0,void 0,(function*(){return(yield function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cS();return e("readonly",(function(t){if(t.getAll&&t.getAllKeys)return Promise.all([sS(t.getAllKeys()),sS(t.getAll())]).then((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),2!==o.length);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(e)||function(e,t){if(e){if("string"==typeof e)return oS(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oS(e,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e),n=t[0],r=t[1];return n.map((function(e,t){return[e,r[t]]}))}));var n=[];return e("readonly",(function(e){return function(e,t){return e.openCursor().onsuccess=function(){this.result&&(function(e){n.push([e.key,e.value])}(this.result),this.result.continue())},sS(e.transaction)}(e).then((function(){return n}))}))}))}(this.store)).filter((([e])=>"maxId"!==e)).sort(((e,t)=>{var n,r;return(null===(n=e[1])||void 0===n?void 0:n.id)-(null===(r=t[1])||void 0===r?void 0:r.id)})).map((([,e])=>e))})),this.deleteLogs=e=>vS(this,void 0,void 0,(function*(){if(this.resetting)return bS();this.isChangingLog=!0,yield gS((()=>vS(this,void 0,void 0,(function*(){return lS(e.map((e=>`${e}`)),this.store)}))),SS),yield this.adjustMaxId()})),this.saveAESGCM256Key=(e,t,n)=>vS(this,void 0,void 0,(function*(){if(n){const r=yield self.crypto.subtle.exportKey("raw",t),i=yield((e,t,n)=>ky(void 0,void 0,void 0,(function*(){return new Promise(((r,i)=>{requestAnimationFrame((()=>ky(void 0,void 0,void 0,(function*(){var i;const o=null===(i=null==t?void 0:t.algorithm)||void 0===i?void 0:i.name;let s;if("RSA-OAEP"===o?s=Ly:"AES-GCM"===o&&(s=Fy),!s)throw new Error("Unsupported encrypt key type");if("string"==typeof e){const i=new TextEncoder,o=yield s(i.encode(e),t,n);r(o)}else{const i=yield s(e,t,n);r(i)}}))))}))})))(r,n,new Uint8Array(16));yield this.set(`aes-gcm-256-${e}`,i)}else yield this.set(`aes-gcm-256-${e}`,t)})),this.reset=()=>vS(this,void 0,void 0,(function*(){return this.resetting?bS():(this.waitingForReset=!0,this.isChangingLog||this.isChangingMeta?bS():(this.resetting=!0,yield function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:cS())("readwrite",(function(e){return e.clear(),sS(e.transaction)}))}(this.store),this.resetting=!1,void(this.waitingForReset=!1)))})),this.store=aS(e,e+"-store"),mS(yS,(()=>{if(this.isChangingMeta=!1,this.waitingForReset)return this.reset()})),mS(SS,(()=>{if(this.isChangingLog=!1,this.waitingForReset)return this.reset()}))}}var wS=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};const IS={databaseName:"laplace-default-db",maxSize:49283072};class _S{constructor(e){this.commonLogWithContext=(e,t,n,r,i)=>wS(this,void 0,void 0,(function*(){yield Jy(this.runtimeMetaManager,e,t,n,r,i)})),this.commonReportWithContext=(e,t)=>wS(this,void 0,void 0,(function*(){yield tS(this.runtimeMetaManager,e,t)})),this.commonDeleteWithContext=e=>wS(this,void 0,void 0,(function*(){yield rS(this.runtimeMetaManager,e)})),this.resetWithContext=()=>wS(this,void 0,void 0,(function*(){yield iS(this.runtimeMetaManager)})),this.initLocalAESGCM256Key=()=>wS(this,void 0,void 0,(function*(){return yield My()})),this.doNotUseDirtyGetStore=()=>this.runtimeMetaManager.logManager.getStore(),this.log=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.log,yy.PLAIN,{extraProperties:n})})),this.info=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.info,yy.PLAIN,{extraProperties:n})})),this.warn=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.warn,yy.PLAIN,{extraProperties:n})})),this.debug=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.debug,yy.PLAIN,{extraProperties:n})})),this.error=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.error,yy.PLAIN,{extraProperties:n})})),this.logWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.log,yy.AESGCM256,{extraProperties:n})})),this.infoWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.info,yy.AESGCM256,{extraProperties:n})})),this.debugWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.debug,yy.AESGCM256,{extraProperties:n})})),this.warnWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.warn,yy.AESGCM256,{extraProperties:n})})),this.errorWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.error,yy.AESGCM256,{extraProperties:n})})),this.logWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.log,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.infoWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.info,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.warnWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.warn,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.debugWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.debug,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.errorWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.error,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.getLogs=e=>{const t=this.runtimeMetaManager.logManager;return t?t.filterStore(e):new Map},this.report=(...e)=>((e,t,n={})=>function(e,t,n,r){return new(n||(n=Promise))((function(e,t){function i(e){try{s(r.next(e))}catch(e){t(e)}}function o(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(i,o)}s((r=r.apply(undefined,[])).next())}))}(0,0,void 0,(function*(){var r,i;const o=null!==(r=n.sampleRate)&&void 0!==r?r:1;if(Math.random()>o)return;if(Ny(t)>30720)throw new Error("ERROR: Laplace .report(strMsg) size bigger than 30KB is NOT allowed.");const s=Object.assign({message:Object.assign({strMsg:t},n.extraMsg),time:Zy(Date.now())},n.extraData);return(null===(i=null==n?void 0:n.tags)||void 0===i?void 0:i.length)&&(s.tags=null==n?void 0:n.tags),eS([{messages:JSON.stringify(s),meta:Xy}],e,n.xhrOptions)})))(this.runtimeMetaManager,...e),this.reportByHttps=(e,t)=>wS(this,void 0,void 0,(function*(){yield this.commonReportWithContext(e,t)})),this.deleteLog=e=>wS(this,void 0,void 0,(function*(){yield this.commonDeleteWithContext(e)})),this.deleteAll=()=>wS(this,void 0,void 0,(function*(){yield this.resetWithContext()}));const{runtimeMetaManager:t}=e;this.runtimeMetaManager=t}}_S.init=e=>wS(void 0,void 0,void 0,(function*(){const{databaseName:t="laplace-default-db"}=e,n=new ES(t),r=new Gy,i=new Ky(Object.assign(Object.assign(Object.assign({},IS),e),{idbManager:n,logManager:r}));zy(i,Ey.beforeInit),yield r.syncFromIDB(i.idbManager);const o=new _S({runtimeMetaManager:i});return zy(i,Ey.afterInit),o}));class CS extends Ay{constructor(e){super(),this.config={verbose:!1},this.beforeLog=(e,t)=>{const{verbose:n}=this.config;switch(n&&console.log("beforeLog, ","state: ",t,"meta: ",e),t.logLevel){case Sy.error:console.error(t.message);break;case Sy.warn:console.warn(t.message);break;case Sy.log:console.log(t.message);break;case Sy.debug:console.debug(t.message);break;case Sy.info:console.info(t.message)}},this.afterLog=(e,t)=>{const{verbose:n}=this.config;n&&console.log("afterLog, ","state: ",t,"meta: ",e)},this.beforeReport=(e,t)=>{const{verbose:n}=this.config;n&&console.log("beforeReport, ","pluginParams: ",t,"meta: ",e)},this.afterReport=(e,t)=>{const{verbose:n}=this.config;n&&console.log("afterReport, ","pluginParams: ",t,"runtimeMetaManager: ",e)},e&&(this.config=e)}}const AS=e=>{const t=[];for(const[n,r]of e)t.push(r);return t};class TS extends Ay{constructor(e){super(),this.config={debug:!1},this.debugLog=e=>{const{debug:t}=this.config;t&&console.log(`[AutoCleanLogPlugin]: ${e}`)},this.afterInit=e=>{const{expireBefore:t}=this.config;if(!t)return void this.debugLog("early return on beforeInit because expireBefore is falsy");const{logManager:n,commonMethods:{commonDelete:r}}=e,i=n.getStore().byTime,o=("function"==typeof t?AS(i).filter(t):AS(i).filter((e=>e.timestamp<t))).map((e=>e.id));r(e,void 0,o),this.debugLog(`afterInit, clean log id: ${o}`)},this.afterReport=(e,{report:t,error:n})=>{if(n)return this.debugLog("error"),void console.error(n);const{cleanAfterReport:r}=this.config;if(!r)return void this.debugLog("early return on afterReport because cleanAfterReport is falsy");const{commonMethods:{commonDelete:i}}=e;i(e,void 0,t.ids),this.debugLog(`afterReport, clean log id: ${t.ids}`)},e&&(this.config=e)}}var RS="Expected a function",OS=/^\s+|\s+$/g,PS=/^[-+]0x[0-9a-f]+$/i,DS=/^0b[01]+$/i,kS=/^0o[0-7]+$/i,xS=parseInt,NS="object"==typeof Wt&&Wt&&Wt.Object===Object&&Wt,MS="object"==typeof self&&self&&self.Object===Object&&self,FS=NS||MS||Function("return this")(),LS=Object.prototype.toString,VS=Math.max,BS=Math.min,jS=function(){return FS.Date.now()};function US(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function HS(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==LS.call(e)}(e))return NaN;if(US(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=US(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(OS,"");var n=DS.test(e);return n||kS.test(e)?xS(e.slice(2),n?2:8):PS.test(e)?NaN:+e}const qS=["RESOURCE_ERROR","JS_ERROR","UNHANDLED_PROMISE_REJECTION"];class KS extends Ay{constructor(e){super(),this.config={debug:!1,publicTags:[]},this.errorCount=0,this.hashErrors={},this.runtimeMetaManager=null,this.addPublicTags=e=>{var t;return null===(t=this.config.publicTags)||void 0===t?void 0:t.concat(e).filter((e=>e))},this.debugLog=e=>{const{debug:t}=this.config;t&&console.log("[AutoLogErrorPlugin]:",e)},this.ignore=e=>{var t,n,r,i,o;return void 0!==(null===(t=this.config)||void 0===t?void 0:t.maxErrorCount)&&this.errorCount>=(null===(n=this.config)||void 0===n?void 0:n.maxErrorCount)||!!(null===(r=this.config)||void 0===r?void 0:r.ignoredErrorMsgKeywords)&&e&&(null===(o=null===(i=this.config)||void 0===i?void 0:i.ignoredErrorMsgKeywords)||void 0===o?void 0:o.some((t=>null==e?void 0:e.includes(t))))},this.report=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError(RS);return US(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),function(e,t,n){var r,i,o,s,a,u,c=0,l=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(RS);function p(t){var n=r,o=i;return r=i=void 0,c=t,s=e.apply(o,n)}function f(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-c>=o}function g(){var e=jS();if(f(e))return m(e);a=setTimeout(g,function(e){var n=t-(e-u);return d?BS(n,o-(e-c)):n}(e))}function m(e){return a=void 0,h&&r?p(e):(r=i=void 0,s)}function v(){var e=jS(),n=f(e);if(r=arguments,i=this,u=e,n){if(void 0===a)return function(e){return c=e,a=setTimeout(g,t),l?p(e):s}(u);if(d)return a=setTimeout(g,t),p(u)}return void 0===a&&(a=setTimeout(g,t)),s}return t=HS(t)||0,US(n)&&(l=!!n.leading,o=(d="maxWait"in n)?VS(HS(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h),v.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=u=i=a=void 0},v.flush=function(){return void 0===a?s:m(jS())},v}(e,t,{leading:r,maxWait:t,trailing:i})}((()=>{if(null===this.runtimeMetaManager)return;const{autoReport:e}=this.config,{commonMethods:{commonReport:t}}=this.runtimeMetaManager;return t(this.runtimeMetaManager,qS,e)}),600,{trailing:!0,leading:!1}),this.afterInit=e=>{if(this.runtimeMetaManager=e,!self.addEventListener)return;const{commonMethods:{commonLog:t}}=e,n=(n,r,i)=>{this.debugLog(i),this.errorCount+=1;try{return function(e){const t=(new TextEncoder).encode(e);return crypto.subtle.digest("SHA-1",t).then((e=>Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")))}(n).then((i=>this.hashErrors[i]?"dismissed":(this.hashErrors[i]=!0,t(e,n,this.addPublicTags([].concat(r)),Sy.error,yy.PLAIN,{extraProperties:{messageHash:i}}).then(this.report)))).catch(console.error)}catch(e){return console.error(e),Promise.resolve(e)}};try{self.addEventListener("error",(e=>{var t,r,i,o,s,a,u;if(!this.ignore(null==e?void 0:e.message)){if((null==e?void 0:e.target)&&((null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.src)||(null===(r=null==e?void 0:e.target)||void 0===r?void 0:r.href))){const t=`Load Resource Error in ${null===(i=null==e?void 0:e.target)||void 0===i?void 0:i.tagName} element: ${(null===(o=null==e?void 0:e.target)||void 0===o?void 0:o.src)||(null===(s=null==e?void 0:e.target)||void 0===s?void 0:s.href)}`;return n(t,"RESOURCE_ERROR",e)}{const t=`Javascript Runtime Error in ${null==e?void 0:e.filename} (${null==e?void 0:e.lineno}:${null==e?void 0:e.colno}): ${null==e?void 0:e.message}\nStack: ${null!==(u=null===(a=null==e?void 0:e.error)||void 0===a?void 0:a.stack)&&void 0!==u?u:null==e?void 0:e.stack}`;return n(t,"JS_ERROR",e)}}})),self.addEventListener("unhandledrejection",(e=>{var t;if(this.ignore(null===(t=null==e?void 0:e.reason)||void 0===t?void 0:t.message))return;let r;const i=null==e?void 0:e.reason;return r="string"==typeof i?`Promise Error: ${i}`:i instanceof Error?`Promise Error: ${i.message} ${i.name} ${i.stack}`:"object"==typeof i?`Promise Error with reason: ${Uy(i)}`:`Promise Error with unrecognized reason: ${i}`,n(r,"UNHANDLED_PROMISE_REJECTION",e)}))}catch(e){console.error(e)}this.debugLog("afterInit, add listener")},e&&(this.config=e),this.config.publicTags=[].concat(null==e?void 0:e.publicTags)}}let $S=function(e){return e.DeviceAudioStreamCaptured="device audio stream captured",e.AudioJoinComplete="audio join complete",e.AudioLeaveComplete="audio leave complete",e.SharingAudioStartComplete="sharing audio start complete",e.SharingAudioStopComplete="sharing audio stop complete",e.AudioBridgeReconnectStart="audio bridge reconnect start",e.AudioBridgeReconnectEnd="audio bridge reconnect end",e}({}),WS=function(e){return e.VBSettingSuccess="video VB setting success",e.VBSettingFailed="init video VB failed",e.VBPreloadSuccess="preload video VB success",e.VBPreloading3S="preload video VB 3s",e.VBPreloading10S="preload video VB 10s",e.StartCaptureVideoSuccess="start capture video success",e.StopCaptureVideoSuccess="stop capture video success",e}({});function GS(e){return`{E}${e}{/E}`}const zS={enable:!1,enableReport:!1,gatewayEndPoint:"",newGatewayEndPoint:"",logLevel:{debug:!1,log:!1,info:!1,print:!1,warn:!1,error:!1},performanceReportRatio:.25,trackingCount:7},JS=["debug","log","info","print","warn","error"],QS=(e,t)=>[...e,...t].filter((e=>!!e));class YS{static getInstance(){return this.agentInstance||(this.agentInstance=new YS),this.agentInstance}constructor(){var e=this;this.laplace=void 0,this.trackingId=void 0,this.logConfig=void 0,this.reportUrl=void 0,this.publicTags=void 0,this.accountId=void 0,this.disableAutoReport=void 0,this.initConfig=async e=>{let t,n=zS;try{e.logConfig&&(n=JSON.parse(e.logConfig),n.gatewayEndPoint&&(this.reportUrl=n.gatewayEndPoint),n.newGatewayEndPoint&&(this.reportUrl=n.newGatewayEndPoint));const{enable:r,enableReport:i,reportUrl:o,logLevel:s,encryptKeys:a,trackingId:u,accountId:c}=e;if(void 0!==r&&(n={...n,enable:!!r}),void 0!==i&&(n={...n,enableReport:!!i}),o&&(this.reportUrl=o),"string"==typeof s){const e=JS.indexOf(s),t=JS.reduce(((t,n,r)=>r<e?{...t,[`${n}`]:!1}:{...t,[`${n}`]:!0}),{});n={...n,logLevel:t}}else void 0!==s&&(n={...n,logLevel:s});if(u&&(this.trackingId=u,n={...n,enable:!0,enableReport:!0}),void 0!==a){const e=Array.isArray(a)?a:[a];t=await Promise.all(e.map((e=>function(e){return window.crypto.subtle.importKey("raw",(new TextEncoder).encode(e.slice(0,32)),"AES-GCM",!1,["encrypt","decrypt"])}(e).then((e=>({usage:by.PROTECT_LOCAL_KEY,key:e}))))))}void 0!==c&&(this.accountId=c)}catch(e){console.error("parse log config error",e)}const r=(new Date).getTime()-6048e5,i=n.enableReport&&this.reportUrl?{gzip:!1,encrypt:!1,additionalContext:{trackingId:this.trackingId}}:void 0;this.publicTags=["VideoSDK",this.trackingId];const o=[e.debugMode&&new CS({verbose:!1}),new TS({debug:!1,cleanAfterReport:!0,expireBefore:r}),new KS({debug:!1,autoReport:i,ignoredErrorMsgKeywords:["table index is out of bounds"],maxErrorCount:223,publicTags:this.accountId?[...this.publicTags,GS(this.accountId)]:this.publicTags})].filter(Boolean);return{laplaceConfig:{databaseName:"ZM-VSDK-LOG-DATABASE",maxSize:49283072,publicKey:e.logEncryptionPubKey,reportUrl:this.reportUrl,externalKeys:t,plugins:o},logConfig:n}},this.handleInitLaplaceSuccess=(e,t)=>{var n;this.laplace=e;const r=Do.get(xo.VSDKLogTrackingId);let i=[];try{i=JSON.parse(r?window.atob(r):"[]")}catch(e){}(null===(n=i.length>=(null==t?void 0:t.trackingCount))||void 0===n||n)&&i.shift();const o=i.reduce(((e,t)=>({...e,[`${t}`]:!0})),{});e.deleteLog((e=>{var t;return!(null!==(t=e.tags)&&void 0!==t&&t.some((e=>o[e])))})),i.push(this.trackingId),Do.set(xo.VSDKLogTrackingId,window.btoa(JSON.stringify(i)),Oo.LocalStorage)},this.init=async e=>{const{laplaceConfig:t,logConfig:n}=await this.initConfig(e);return n.enable?(this.logConfig=n,_S.init(t).then((e=>{this.handleInitLaplaceSuccess(e,n)})).catch((e=>{throw{type:Sl,reason:"Logger init failed.",error:e}}))):Promise.reject({type:yl,reason:"Logger feature is not enabled."})},this.check=e=>{var t,n;return!(!this.checkLaplace()||(null===(t=this.logConfig)||void 0===t||null===(n=t.logLevel)||void 0===n||!n[e])&&(console.warn(`Logger ${e} is not enabled.`),1))},this.log=(e,t,n)=>{if(this.check("log"))try{var r;return null===(r=this.laplace.logWithEncryption(e,QS(t,n)))||void 0===r?void 0:r.catch((()=>{}))}catch(e){return}},this.logWithExtraProperties=(e,t,n)=>{if(this.check("log"))try{var r;return null===(r=this.laplace.log(e,t,n))||void 0===r?void 0:r.catch((()=>{}))}catch(e){return}},this.warn=(e,t,n)=>{if(this.check("warn"))try{var r;return null===(r=this.laplace.warnWithEncryption(e,QS(t,n)))||void 0===r?void 0:r.catch((()=>{}))}catch(e){return}},this.info=(e,t,n)=>{if(this.check("info"))try{var r;return null===(r=this.laplace.infoWithEncryption(e,QS(t,n)))||void 0===r?void 0:r.catch((()=>{}))}catch(e){return}},this.debug=(e,t,n)=>{if(this.check("debug"))try{var r;return null===(r=this.laplace.debugWithEncryption(e,QS(t,n)))||void 0===r?void 0:r.catch((()=>{}))}catch(e){return}},this.error=(e,t,n)=>{if(this.check("error"))try{var r;return null===(r=this.laplace.errorWithEncryption(e,QS(t,n)))||void 0===r?void 0:r.catch((()=>{}))}catch(e){return}},this.checkLaplace=()=>{var e;return!(null===(e=this.laplace)||void 0===e||!e.log)},this.makeLogger=e=>{var t;const n=QS(null!==(t=this.publicTags)&&void 0!==t?t:[],e);return{log:(e,t)=>this.log(e,n,null!=t?t:[]),logWithExtraProperties:(e,t)=>this.logWithExtraProperties(e,n,t),warn:(e,t)=>this.warn(e,n,null!=t?t:[]),info:(e,t)=>this.info(e,n,null!=t?t:[]),debug:(e,t)=>this.debug(e,n,null!=t?t:[]),error:(e,t)=>this.error(e,n,null!=t?t:[])}},this.reportToGlobalTracing=function(t){var n;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.checkLaplace()?null!==(n=e.logConfig)&&void 0!==n&&n.enableReport&&e.reportUrl?function(){try{return!!Do.get(No.DisableAutoReportLogs)}catch(e){return!1}}()&&!r?Promise.resolve():e.laplace.reportByHttps(t,{gzip:!1,encrypt:!1,xhrOptions:{url:e.reportUrl},additionalContext:{trackingId:e.trackingId}}):Promise.reject({type:yl,reason:"Please use getLogs to obtain log data and report by yourself."}):Promise.reject({type:yl,reason:"Logger has not been enabled or initialized."})},this.report=function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"warn";if(e.checkLaplace()&&e.logConfig.enableReport&&e.reportUrl){var i,o;const s=Array.isArray(n)?n:[n],a=e.accountId?[...s,GS(e.accountId)]:s;null===(i=(o=e.makeLogger(a))[`${r}`])||void 0===i||i.call(o,t).then((()=>{e.reportToGlobalTracing(s)}))}},this.getLogs=(e,t)=>{if(!this.checkLaplace())return console.warn("Logger has not been enabled or initialized."),[];const n=e.getState(),{meeting:{meetingNumber:r,userId:i,userEmail:o,userName:s}}=n,a={meetingNumber:r,userId:i,userEmail:o,userName:s},u=this.laplace.getLogs(t),c=[];for(const[,e]of u)c.push({...e,...a});return c},this.doNotUseDirtyGetStore=()=>this.checkLaplace()?this.laplace.doNotUseDirtyGetStore():(console.warn("Logger has not been enabled or initialized."),{byTag:{},byTime:new Map}),this.trackingId=Cy()}}YS.agentInstance=void 0;const ZS=YS.getInstance(),XS=[{type:"MediaMeta",methods:["sendUserNodeList","updateUserMediaSN","updateMediaParams","subscribeToQos","unsubscribeFromQos","sendUserAudioStatus","destroy","createMainSessionChannel","notifySDKMeetingReady"]},{type:"Audio",methods:["joinComputerAudio","leaveComputerAudio","joinSharingAudio","leaveSharingAudio","changeSpeaker","changeMicrophone","enableAudioEncode","pauseOrResumeAudio","setSharingAudioVolume","enableShareAudioToBreakoutRoom","enableAudioDenoise","enableSyncButtonsOnHeadset","stopAllIncomingAudio","preInitAudioBridge","setAudioCodecMode","muteOrUnmuteOtherAudio","adjustOtherAudioVolume","changeAudioProfile","unmuteAudio","muteAudio"]},{type:"Video",methods:["startCaptureVideo","stopCaptureVideo","renderVideo","stopRenderVideo","changeCamera","updateRenderedVideoCanvasDimension","adjustRenderedVideoPosition","mirrorVideo","enableHardwareAccelerationForVideoDecode","enableHardwareAccelerationForVideoEncode","startVirtualBackgroundSetting","updateVirtualBackgroundImage","stopVirtualBackgroundSetting","startMaskSetting","updateMaskBackgroundImage","updateMaskClip","stopMaskSetting","enableVideoObserver","prefetchVideoSsrc","cancelPrefetchVideoSsrc","setMobileRotateMode","changeActiveVideoSsrc","updateVideoHDValue","updateVideoFullhdValue","clearVideoCanvas"]},{type:"Sharing",methods:["stopDesktopSharing","startDesktopSharing","pauseDesktopSharing","resumeDesktopSharing","renderSharing","stopRenderSharing","switchSharingSource","ajustmentReceivedSharingCanvas","changeSharingSecondCamera","updateRenderedSharingDimension","addReceivedSharingChannelType","removeReceivedSharingChannelType","switchSharingMode","ajustmentSharingCanvas"]},{type:"RemoteControl",methods:["startRemoteControl","stopRemoteControl","resendRemoteControlPositionPDU","updateRemoteControlProperties","ajustmentReceivedSharingCanvas","startRemoteControlQRCheck"]},{type:"LiveTranscription",methods:["selectLanguageChannelForNewLTT"]},{type:"RemoteCamera",methods:["movePTZCamera"]}].reduce(((e,t)=>{const{type:n,methods:r}=t;return[...e,...r.map((e=>({name:e,type:n})))]}),[]),eb=XS.map((e=>e.name)),tb=function(e){const t=XS.find((t=>t.name===e));if(t){const{type:o}=t;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=null==r?void 0:r.map((e=>Ei(e)));ZS.makeLogger([o,`${o} Media SDK`]).info(`${e},params:${JSON.stringify(s)}`)}};function nb(e){return new Proxy(e,{get:(e,t)=>"string"==typeof t&&eb.includes(t)?function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{Reflect.apply(tb,void 0,[t,...r])}catch(e){}return Reflect.apply(Reflect.get(e,t),e,r)}:Reflect.get(e,t)})}const rb=YS.getInstance().makeLogger(["Remote Control"]),ib=nb(Ls.getInstance());function ob(e,t,n,r){let{share:{activeNodeId:i,shareQuality:o}}=t;const{share:{isReceiveSharingFromMainSession:s}}=t;n&&(i=n),void 0!==r&&(o=r);const a=py(t);e.subscribeSharing(i,o,s,a)}class sb{constructor(){this.checkerSubject=void 0,this.checkerSubscription=void 0}startCheck(e){return this.checkerSubject&&this.stopCheck(),this.checkerSubject=new z,this.checkerSubscription=at(e).subscribe(this.checkerSubject),this.checkerSubject}stopCheck(){var e;this.checkerSubject&&(this.checkerSubject.complete(),null===(e=this.checkerSubscription)||void 0===e||e.unsubscribe(),this.checkerSubject=void 0)}}const ab=new sb,ub=new sb;function cb(){return ab.stopCheck()}function lb(){return ub.stopCheck()}function db(e,t){cb(),lb();const{share:{remoteControllingSsrc:n},meeting:{userId:r}}=e;n&&(pb(),t.takeBackRemoteControlPermission(r,n))}async function hb(e,t,n,r,i){const{share:{isSDKGrabControl:o,isGrabRemoteControl:s}}=n;s||(r.subscribeGrabRemoteControl(e,!0),await Be(Ad(nl,1).pipe(ht((e=>!!e)))));const a=dy(n);a&&(o?(i.resendRemoteControlPositionPDU(),i.updateRemoteControlProperties({os:a.os,isControllerNow:!0,dimension:t&&kv(t)})):t&&i.startRemoteControl(t,a.os,kv(t)))}function pb(){rb.log("qr scanning stop"),ib.startRemoteControlQRCheck(!1)}const fb=Ps.createAgent(),gb=nb(Ls.getInstance()),mb=Ps.createAgent(),vb=nb(Ls.getInstance());function yb(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Sb(e){return!!e&&!!e[rE]}function bb(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===iE}(e)||Array.isArray(e)||!!e[nE]||!!(null===(t=e.constructor)||void 0===t?void 0:t[nE])||Cb(e)||Ab(e))}function Eb(e,t,n){void 0===n&&(n=!1),0===wb(e)?(n?Object.keys:oE)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function wb(e){var t=e[rE];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Cb(e)?2:Ab(e)?3:0}function Ib(e,t){return 2===wb(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function _b(e,t,n){var r=wb(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function Cb(e){return Zb&&e instanceof Map}function Ab(e){return Xb&&e instanceof Set}function Tb(e){return e.o||e.t}function Rb(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=sE(e);delete t[rE];for(var n=oE(t),r=0;r<n.length;r++){var i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function Ob(e,t){return void 0===t&&(t=!1),Db(e)||Sb(e)||!bb(e)||(wb(e)>1&&(e.set=e.add=e.clear=e.delete=Pb),Object.freeze(e),t&&Eb(e,(function(e,t){return Ob(t,!0)}),!0)),e}function Pb(){yb(2)}function Db(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function kb(e){var t=aE[e];return t||yb(18,e),t}function xb(){return Qb}function Nb(e,t){t&&(kb("Patches"),e.u=[],e.s=[],e.v=t)}function Mb(e){Fb(e),e.p.forEach(Vb),e.p=null}function Fb(e){e===Qb&&(Qb=e.l)}function Lb(e){return Qb={p:[],l:Qb,h:e,m:!0,_:0}}function Vb(e){var t=e[rE];0===t.i||1===t.i?t.j():t.O=!0}function Bb(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||kb("ES5").S(t,e,r),r?(n[rE].P&&(Mb(t),yb(4)),bb(e)&&(e=jb(t,e),t.l||Hb(t,e)),t.u&&kb("Patches").M(n[rE].t,e,t.u,t.s)):e=jb(t,n,[]),Mb(t),t.u&&t.v(t.u,t.s),e!==tE?e:void 0}function jb(e,t,n){if(Db(t))return t;var r=t[rE];if(!r)return Eb(t,(function(i,o){return Ub(e,r,t,i,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return Hb(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=Rb(r.k):r.o;Eb(3===r.i?new Set(i):i,(function(t,o){return Ub(e,r,i,t,o,n)})),Hb(e,i,!1),n&&e.u&&kb("Patches").R(r,n,e.u,e.s)}return r.o}function Ub(e,t,n,r,i,o){if(Sb(i)){var s=jb(e,i,o&&t&&3!==t.i&&!Ib(t.D,r)?o.concat(r):void 0);if(_b(n,r,s),!Sb(s))return;e.m=!1}if(bb(i)&&!Db(i)){if(!e.h.F&&e._<1)return;jb(e,i),t&&t.A.l||Hb(e,i)}}function Hb(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&Ob(t,n)}function qb(e,t){var n=e[rE];return(n?Tb(n):e)[t]}function Kb(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function $b(e){e.P||(e.P=!0,e.l&&$b(e.l))}function Wb(e){e.o||(e.o=Rb(e.t))}function Gb(e,t,n){var r=Cb(t)?kb("MapSet").N(t,n):Ab(t)?kb("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:xb(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,o=uE;n&&(i=[r],o=cE);var s=Proxy.revocable(i,o),a=s.revoke,u=s.proxy;return r.k=u,r.j=a,u}(t,n):kb("ES5").J(t,n);return(n?n.A:xb()).p.push(r),r}function zb(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Rb(e)}var Jb,Qb,Yb="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Zb="undefined"!=typeof Map,Xb="undefined"!=typeof Set,eE="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,tE=Yb?Symbol.for("immer-nothing"):((Jb={})["immer-nothing"]=!0,Jb),nE=Yb?Symbol.for("immer-draftable"):"__$immer_draftable",rE=Yb?Symbol.for("immer-state"):"__$immer_state",iE=""+Object.prototype.constructor,oE="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,sE=Object.getOwnPropertyDescriptors||function(e){var t={};return oE(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},aE={},uE={get:function(e,t){if(t===rE)return e;var n=Tb(e);if(!Ib(n,t))return function(e,t,n){var r,i=Kb(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!bb(r)?r:r===qb(e.t,t)?(Wb(e),e.o[t]=Gb(e.A.h,r,e)):r},has:function(e,t){return t in Tb(e)},ownKeys:function(e){return Reflect.ownKeys(Tb(e))},set:function(e,t,n){var r=Kb(Tb(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=qb(Tb(e),t),o=null==i?void 0:i[rE];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,i)&&(void 0!==n||Ib(e.t,t)))return!0;Wb(e),$b(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==qb(e.t,t)||t in e.t?(e.D[t]=!1,Wb(e),$b(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Tb(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){yb(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){yb(12)}},cE={};Eb(uE,(function(e,t){cE[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),cE.deleteProperty=function(e,t){return cE.set.call(this,e,t,void 0)},cE.set=function(e,t,n){return uE.set.call(this,e[0],t,n,e[0])};var lE=function(){function e(e){var t=this;this.g=eE,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,s=Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return o.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(s))}))}}var s;if("function"!=typeof n&&yb(6),void 0!==r&&"function"!=typeof r&&yb(7),bb(e)){var a=Lb(t),u=Gb(t,e,void 0),c=!0;try{s=n(u),c=!1}finally{c?Mb(a):Fb(a)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return Nb(a,r),Bb(e,a)}),(function(e){throw Mb(a),e})):(Nb(a,r),Bb(s,a))}if(!e||"object"!=typeof e){if(void 0===(s=n(e))&&(s=e),s===tE&&(s=void 0),t.F&&Ob(s,!0),r){var l=[],d=[];kb("Patches").M(e,s,l,d),r(l,d)}return s}yb(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))};var r,i,o=t.produce(e,n,(function(e,t){r=e,i=t}));return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return[e,r,i]})):[o,r,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){bb(e)||yb(8),Sb(e)&&(e=function(e){return Sb(e)||yb(22,e),function e(t){if(!bb(t))return t;var n,r=t[rE],i=wb(t);if(r){if(!r.P&&(r.i<4||!kb("ES5").K(r)))return r.t;r.I=!0,n=zb(t,i),r.I=!1}else n=zb(t,i);return Eb(n,(function(t,i){r&&function(e,t){return 2===wb(e)?e.get(t):e[t]}(r.t,t)===i||_b(n,t,e(i))})),3===i?new Set(n):n}(e)}(e));var t=Lb(this),n=Gb(this,e,void 0);return n[rE].C=!0,Fb(t),n},t.finishDraft=function(e,t){var n=(e&&e[rE]).A;return Nb(n,t),Bb(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!eE&&yb(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var i=kb("Patches").$;return Sb(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),dE=new lE,hE=dE.produce;dE.produceWithPatches.bind(dE),dE.setAutoFreeze.bind(dE),dE.setUseProxies.bind(dE),dE.applyPatches.bind(dE),dE.createDraft.bind(dE),dE.finishDraft.bind(dE);const pE={ssrc:0,status:qa.End,shareDimension:{width:0,height:0},receivedShareDimension:{width:1920,height:1080,logicWidth:1920,logicHeight:1080},sharePrivilege:Ha.OnlyHost,activeNodeId:0,activeSsrc:0,shareQuality:1,isRemoteSharingActive:!1,isReceiveSharing:!1,isGrabRemoteControl:!1,isSDKGrabControl:!1,isChromeExtensionInstalled:!1,isScreenShareForbidden:!1,isReceiveSharingFromMainSession:!1,isSharingToBreakoutRoom:!1,isSharingWithSecondCamera:!1,secondCameraId:"default",isRequireReadReceipt:!1,capturedEnsuredCanvas:[],renderedEnsuredCanvas:[],remoteControllingSsrc:0,remoteControlApprovedSsrc:0,remoteControlAppDownloadUrl:"",remoteControlAppInstallStatus:bu.Unknown,isEnableAutoDeleteRcApp:!1,remoteControlledUserList:[],isRemoteControlEnabled:!1,isFullHDVideoShareEnabled:!1,userSsrcMapping:{},statistic:{encode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0},decode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0}}},fE=Rn({[`${Ep}`]:hE(((e,t)=>{let{payload:n}=t;e.sharePrivilege=n})),[`${wp}`]:hE(((e,t)=>{let{payload:n}=t;e.isRemoteSharingActive=1===n.bStatus,e.activeNodeId=n.activeNodeID,e.activeSsrc=n.ssrc})),[`${Ip}`]:hE(((e,t)=>{let{payload:n}=t;e.isReceiveSharing=n})),[`${_p}`]:hE(((e,t)=>{let{payload:n}=t;e.isChromeExtensionInstalled=n})),[`${Ap}`]:hE(((e,t)=>{let{payload:n}=t;e.shareDimension={...n}})),[`${Tp}`]:hE(((e,t)=>{let{payload:n}=t;e.status=n})),[`${Rp}`]:hE(((e,t)=>{let{payload:n}=t;e.ssrc=n})),[`${Op}`]:hE(((e,t)=>{let{payload:n}=t;e.shareQuality=n})),[`${Pp}`]:hE(((e,t)=>{let{payload:n}=t;e.receivedShareDimension={...n}})),[`${Xp}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlledUserList.includes(n)||e.remoteControlledUserList.push(n)})),[`${ef}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.remoteControlledUserList.indexOf(n);r>=0&&e.remoteControlledUserList.splice(r,1)})),[`${Dp}`]:hE(((e,t)=>{let{payload:n}=t;e.isGrabRemoteControl=n,!1===n&&(e.remoteControlViewportDomSelector=void 0)})),[`${kp}`]:hE(((e,t)=>{let{payload:n}=t;e.isSDKGrabControl=n})),[`${xp}`]:hE(((e,t)=>{let{payload:n}=t;e.isReceiveSharingFromMainSession=n})),[`${Np}`]:hE(((e,t)=>{let{payload:n}=t;e.isSharingToBreakoutRoom=n})),[`${Mp}`]:hE(((e,t)=>{let{payload:n}=t;e.isSharingWithSecondCamera=n})),[`${Fp}`]:hE(((e,t)=>{let{payload:n}=t;e.secondCameraId=n})),[`${Lp}`]:hE(((e,t)=>{let{payload:n}=t;e.isRequireReadReceipt=n})),[`${Vp}`]:hE(((e,t)=>{let{payload:n}=t;e.isOptimizedForSharedVideo=n})),[`${Bp}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:r,rate:i,...o}}=n;e.statistic.encode={bitrate:i,...o}})),[`${jp}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:r,rate:i,...o}}=n;e.statistic.decode={bitrate:i,...o}})),[`${Up}`]:hE(((e,t)=>{let{payload:n}=t;e.capturedEnsuredCanvas.includes(n)||e.capturedEnsuredCanvas.push(n)})),[`${Hp}`]:hE(((e,t)=>{let{payload:n}=t;e.renderedEnsuredCanvas.includes(n)||e.renderedEnsuredCanvas.push(n)})),[`${Kp}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControllingSsrc=n})),[`${$p}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlApprovedSsrc=n})),[`${Wp}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlAppDownloadUrl=n})),[`${Gp}`]:hE(((e,t)=>{let{payload:n}=t;(e.remoteControlAppInstallStatus!==bu.Installed||bu.Unknown)&&(e.remoteControlAppInstallStatus=n)})),[`${Yp}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlAppLaunchSheme=n})),[`${Zp}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:r,ssrc:i}=n;Object.assign(e.userSsrcMapping,{[`${r}`]:i})})),[`${tf}`]:hE(((e,t)=>{let{payload:n}=t;Object.assign(e,n)})),[`${nf}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlViewportDomSelector=n})),[`${rf}`]:hE(((e,t)=>{let{payload:n}=t;e.isFullHDVideoShareEnabled=n})),[`${of}`]:()=>({...pE})},pE),gE={remoteControlEpics0:e=>e.pipe(Ut(`${Bi}`),Ke((e=>{const{payload:{meetingOptions:t,rcAutoDelete:n,jwtRc:r,opRc:i}}=e,o=(null==t?void 0:t.isRemoteControlEnbaled)&&i&&1===r;return tf({isRemoteControlEnabled:o,isEnableAutoDeleteRcApp:1===n})}))),remoteControlEpics1:(e,t)=>pr(e,16391).pipe(Ye((e=>{const{payload:{body:{bOn:n,sendID:r,receiveID:i}}}=e,{meeting:{userId:o},share:{status:s,activeNodeId:a,isGrabRemoteControl:u}}=t.value,c=[];if(s===qa.End&&c.push(Kp(0)),s!==qa.End)if(hi(o,r))if(n){cb(),lb(),s===qa.Paused&&(mb.resumeSharing(),vb.resumeDesktopSharing(),c.push(Tp(qa.Sharing))),c.push(Kp(i));const e=bh(t.value).find((e=>hi(e.userId,i)));e&&c.push(Zp({userId:e.userId,ssrc:i}))}else c.push(Kp(0));else{var l;const e=null===(l=bh(t.value))||void 0===l?void 0:l.find((e=>hi(e.userId,r)));e&&(c.push(Zp({userId:e.userId,ssrc:r})),Id(cl,{userId:e.userId,displayName:e.displayName,isSharingEntireScreen:vb.isSharingEntireScreen()}))}else if(!i||hi(i,o)){const e=gh(t.value);if(!eh(e.userRole)&&!Uo.isAndroidOrIOSBrowser){const e=r&&hi(a,r);n?(c.push(Xp(a)),e&&(u||mb.subscribeGrabRemoteControl(a,!0))):(c.push(ef(a)),e&&(u&&(mb.subscribeGrabRemoteControl(a,!1),c.push(Dp(!1)),Id(nl,!1)),vb.updateRemoteControlProperties({isControllerNow:!1}))),Id(tl,n)}}return Me(c)}))),remoteControlEpics2:(e,t)=>pr(e,16395).pipe(Tt(t),ht((e=>{let[t,n]=e;return t.payload.body.id===n.meeting.userId})),Ke((e=>{let[t]=e;const{payload:{body:{bOn:n}}}=t;return vb.updateRemoteControlProperties({isControllerNow:n}),Id(nl,n),Dp(n)}))),remoteControlEpics3:e=>vr(e,[Da.StartRemoteControlSuccess,Da.StartRemoteControlFailed,Da.CancelRemoteControlSuccess]).pipe(Zv((e=>e.payload.type===Da.StartRemoteControlSuccess?(Id(il),kp(!0)):e.payload.type===Da.CancelRemoteControlSuccess?kp(!1):void(e.payload.type===Da.StartRemoteControlFailed&&Id(ol))))),remoteControlEpics4:e=>vr(e,[Da.RemoteControlCopiedTextNotify,Da.RemoteControlPasteTextLengthOverflow]).pipe(At((e=>{if(e.payload.type===Da.RemoteControlCopiedTextNotify){const{payload:{data:t}}=e;Id(rl,{content:t.data,x:t.x,y:t.y})}else Id(rl,{error:"length of pasted text is too long"})})),St(ge)),remoteControlEpics5:(e,t)=>pr(e,4342).pipe(ht((e=>0===e.payload.body.result)),Ye((e=>{const{payload:{body:{downloadUrl:n,ssrc:r,urlScheme:i}}}=e,{share:{remoteControlApprovedSsrc:o,status:s}}=t.value,a=[],{isMacOS:u}=Uo;if(s!==qa.End){if(!o||o===r){cb();try{const e=JSON.parse(n||"{}"),t=u?e.macDownloadUrl:e.winDownloadUrl;a.push(Wp(t))}catch(e){console.warn("unsupported JSON string",e)}}const s={};u||Object.assign(s,{runAsAdmin:1});const c=bh(t.value).find((e=>hi(e.userId,r)));c&&Object.assign(s,{controllerName:ri(c.displayName)}),Object.assign(s,{ssrc:r});const{deviceId:l}=vb.getShareStreamInfo();l&&Object.assign(s,{DeviceID:l});const d=`${i}&${new URLSearchParams(s).toString()}`;a.push(Yp(d),Gp(bu.Unknown)),Id(hl,d)}return Me(a)}))),remoteControlEpics6:e=>e.pipe(Ut(`${zp}`),Ye((()=>ab.startCheck(1e4).pipe(Ke((()=>(Id(ll,bu.Unknown),Gp(bu.Unknown)))))))),remoteControlEpics7:(e,t)=>e.pipe(Ut(`${Jp}`),ht((()=>{const{share:{remoteControlAppInstallStatus:e}}=t.value;return e===bu.Installed})),Ye((()=>ub.startCheck(6e4).pipe(Ye((()=>{Id(ll,Eu.Unlaunched);const{share:{remoteControlApprovedSsrc:e,isEnableAutoDeleteRcApp:n},meeting:{userId:r}}=t.value,i=[],{isMacOS:o}=Uo;return e&&(mb.remoteControlConsent(Su.CacheClean,e,r,{...vb.getShareStreamInfo(),platform:o?"mac":"win"},n),i.push(Yp(""),$p(0))),Me(i)})))))),remoteControlEpics8:(e,t)=>e.pipe(Ut(`${Yp}`),ht((e=>!!e.payload)),Ye((e=>{const{payload:n}=e,r=[];let i;if(n){!function(e){if(!e.startsWith("zoomprc://"))return;const t=fi("__ZOOM_SDK_RC_APP_SCHEME_@__");let n=document.getElementById(t);n||(n=document.createElement("iframe"),n.id=t,n.style.display="none",document.body.appendChild(n)),n.contentWindow.location.href=e}(n),r.push(Jp());const e=performance.now();document.hasFocus()?i=ut(25).pipe(Ct((()=>{const n=performance.now()-e<500;return n||Id(ll,bu.Uninstalled),n&&t.value.share.remoteControlAppInstallStatus===bu.Unknown})),It((()=>{const t=performance.now()-e,n=[];return document.hasFocus()||(t>75?n.push(zp()):cb(),Id(ll,bu.Installed),n.push(Gp(bu.Installed),Jp())),Me(n)})),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return Xe(t,Fe.apply(void 0,y([],v(e))))}}(Gp(bu.Uninstalled))):(Id(ll,bu.Unknown),r.push(Gp(bu.Unknown)))}return i?ct(i,Me(r)):Me(r)}))),remoteControlEpics9:(e,t)=>pr(e,ls).pipe(Ye((()=>(Id(dl,wu.Ended),db(t.value,mb),Me([Yp(""),$p(0)]))))),remoteControlEpics10:(e,t)=>e.pipe(Ut(`${Tp}`),ht((e=>{const{share:{remoteControllingSsrc:n,remoteControlApprovedSsrc:r}}=t.value;return!(e.payload!==qa.End||!n&&!r)})),At((()=>{const{share:{remoteControllingSsrc:e,remoteControlApprovedSsrc:n,isEnableAutoDeleteRcApp:r},meeting:{userId:i}}=t.value,{isMacOS:o}=Uo;e&&db(t.value,mb),n!==e&&mb.remoteControlConsent(Su.Decline,n,i,{...vb.getShareStreamInfo(),platform:o?"mac":"win"},r)})),St(ge)),remoteControlEpics11:(e,t)=>pr(e,16430).pipe(Ye((()=>(cb(),lb(),Id(ll,Eu.Launched),t.value.share.status!==qa.End&&function(e,t){(async function(e){const{media:{assetsPath:t}}=e,n=`${t}/qrscanner.min.js`;return"WebQrscanner"in window?Promise.resolve(""):new Promise(((e,t)=>{rb.log(`load qr scanner script start. url:${n}`),Sv(n,(()=>{rb.log("load qr scanner script done."),e("")}),t)}))})(e).then((()=>{rb.log("qr scanning start"),t.startRemoteControlQRCheck(!0)}))}(t.value,vb),Me([Yp(""),$p(0)]))))),remoteControlEpics12:e=>vr(e,Da.CurrentDesktopSharingWidthHeight).pipe(At((()=>{mb.syncSharedContentMetaWithRcApp(vb.getShareStreamInfo())})),St(ge)),remoteControlEpics13:(e,t)=>vr(e,Da.SendRemoteControlQrCode).pipe(At((e=>{const{payload:{data:n}}=e,{share:{status:r}}=t.value;r!==qa.End&&Array.isArray(n)&&n.length>0&&n.forEach((e=>{null!=e&&e.startsWith("zrc_")&&mb.sendRemoteControlAuth(e)}))})),St(ge)),remoteControlEpics14:e=>pr(e,16434).pipe(At((e=>{const{payload:{body:{result:t}}}=e;0===t&&(pb(),Id(dl,wu.Started))})),St(ge)),remoteControlEpics15:(e,t)=>pr(e,rs).pipe(ht((e=>{var n,r;const{meeting:{userId:i},share:{remoteControlledUserList:o}}=t.value,{payload:{body:s}}=e;return o.length>0&&((null===(n=s.update)||void 0===n?void 0:n.some((e=>e.id!==i&&!1===e.bShareOn)))||(null===(r=s.remove)||void 0===r?void 0:r.some((e=>e.id!==i))))})),Ye((e=>{var n,r,i,o;const{payload:{body:s}}=e,{share:{remoteControlledUserList:a,activeNodeId:u,isGrabRemoteControl:c},meeting:{userId:l}}=t.value,d=(null!==(n=null===(r=s.update)||void 0===r?void 0:r.filter((e=>e.id!==l&&!1===e.bShareOn)))&&void 0!==n?n:[]).concat(null!==(i=null===(o=s.remove)||void 0===o?void 0:o.filter((e=>e.id!==l)))&&void 0!==i?i:[]),h=[];return a.forEach((e=>{d.find((t=>t.id===e))&&(h.push(ef(e)),e===u&&c&&(h.push(Dp(!1)),Id(nl,!1)))})),Me(h)}))),remoteControlEpics16:(e,t)=>e.pipe(Ut(`${Ni}`),At((()=>{const{share:{remoteControllingSsrc:e,status:n}}=t.value;n===qa.Sharing&&e&&Id(dl,wu.Ended)})),St(ge))},mE={epics0:(e,t)=>pr(e,is).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.lockShare)})),Tt(t),At((e=>{let[t,n]=e;const{share:{sharePrivilege:r}}=n,{payload:{body:{lockShare:i}}}=t;r!==i&&Id(sl,i)})),Ke((e=>{let[t]=e;return Ep(t.payload.body.lockShare)}))),epics1:e=>pr(e,20227).pipe(Ke((e=>Rp(e.payload.body.ssrc)))),epics2:(e,t)=>pr(e,ts).pipe(Tt(t),ht((e=>{let[t,n]=e;const{payload:{body:r}}=t,{share:{isReceiveSharingFromMainSession:i}}=n;return!i||i&&r.fromMainSession})),Ke((e=>{let[t,n]=e;const{share:{isReceiveSharing:r,activeNodeId:i,isReceiveSharingFromMainSession:o},breakoutRoom:s}=n,{payload:{body:a}}=t;if(r&&1===a.bStatus){let e=!1;(null==s?void 0:s.currentRoom.status)===ih.InRoom&&s.mainSessionAttendeeList.length>0&&(e=s.mainSessionAttendeeList.findIndex((e=>e.userId===i))>-1),fb.unsubscribeSharing(i,e),ob(fb,n,a.activeNodeID),gb.switchSharingSource(a.ssrc,o),Id(el,{userId:a.activeNodeID})}else if(1===a.bStatus){const e={activeUserId:a.activeNodeID,isActive:!0};o&&Object.assign(e,{isFromMainSession:!0}),Id(Hc,e)}else if(r){const e={activeUserId:a.activeNodeID,isActive:!1};o&&Object.assign(e,{isFromMainSession:!0}),Id(Hc,e)}return wp(a)}))),epics3:e=>vr(e,Da.CheckChromeSharingExtensionResponse).pipe(Ke((e=>(Id(qc,e.payload.data),_p(e.payload.data))))),epics4:(e,t)=>vr(e,[Da.SharingDesktopStreamHaveAudio,Da.SharingDesktopStreamHaveNoAudio]).pipe(ht((e=>e.payload.type!==Da.SharingDesktopStreamHaveAudio||!t.value.audio.secondaryAudioMicrophoneId)),Tt(t),Ke((e=>{let[t,n]=e;const{meeting:{userId:r},share:{isSharingToBreakoutRoom:i,isOptimizedForSharedVideo:o}}=n,{payload:{type:s}}=t,a=s===Da.SharingDesktopStreamHaveAudio;return fb.startSharing(r,{bShareToBO:i,bShareAudio:a,bShareVideo:!!o}),gb.switchSharingMode(o?mu.VideoMode:mu.Normal),Cp(!1)}))),epics5:e=>vr(e,[Da.DesktopSharingError,Da.DesktopSharingChromeExtensionUninstalled,Da.DesktopSharingPermissionDenied,Da.DesktopSharingSystemError]).pipe(Ye((e=>{const t=[];let n="";return[Da.DesktopSharingPermissionDenied,Da.DesktopSharingSystemError].includes(e.payload.type)&&(t.push(Cp(!0)),e.payload.type===Da.DesktopSharingSystemError?Uo.isMacOS&&(n="To use screen share on Chrome, please allow screen recording access in system setting."):n="To use screen share, please allow the permission request."),Id(Kc,{reason:n}),Me(t)}))),epics6:e=>vr(e,Da.CurrentDesktopSharingWidthHeight).pipe(ht((e=>!!e.payload.data)),Ke((e=>{Id($c,e.payload.data);const{payload:{data:{width:t,height:n}}}=e;return gb.ajustmentSharingCanvas(t,n),Ap(e.payload.data)}))),epics7:(e,t)=>vr(e,Da.SharingDecodeMaxSize).pipe(ht((e=>!!e.payload.data)),Tt(t),Zv((e=>{let[t,n]=e;const{share:{shareQuality:r,activeNodeId:i}}=n,{payload:{data:{fps:o}}}=t,s=Number(o);if(r!==s)return ob(fb,n,i,s),Op(s)}))),epics8:e=>pr(e,20226).pipe(At((e=>{var t,n;if(Id(Wc,null===(t=e.payload)||void 0===t?void 0:t.body),null!==(n=e.payload)&&void 0!==n&&n.body){const{payload:{body:{width:t,height:n}}}=e;gb.ajustmentReceivedSharingCanvas(t,n)}})),Ke((e=>Pp(e.payload.body)))),epics9:e=>vr(e,Da.SharingPara).pipe(At((e=>{var t,n;if(Id(Wc,null===(t=e.payload.data)||void 0===t?void 0:t.body),null!==(n=e.payload.data)&&void 0!==n&&n.body){const{payload:{data:{body:{width:t,height:n}}}}=e;gb.ajustmentReceivedSharingCanvas(t,n)}})),Ke((e=>{var t;return Pp(null===(t=e.payload.data)||void 0===t?void 0:t.body)}))),epics10:(e,t)=>vr(e,Da.UserStopDesktopSharing).pipe(Tt(t),Ke((e=>{let[,t]=e;const{meeting:{userId:n},share:{status:r}}=t;return r!==qa.End&&(fb.stopSharing(n),gb.stopDesktopSharing(),Id(Gc)),Tp(qa.End)}))),epics11:(e,t)=>pr(e,rs).pipe(Tt(t),ht((e=>{let[t,n]=e;const{meeting:{userId:r}}=n,i=t.payload.body.update;return i&&i.length>0&&i.findIndex((e=>e.id===r&&void 0!==e.bShareOn))>-1})),Ye((e=>{let[t,n]=e;const{meeting:{userId:r},share:{status:i,isReceiveSharing:o,activeNodeId:s}}=n,{payload:{body:{update:a}}}=t,u=a.find((e=>e.id===r&&!1===e.bShareOn)),c=a.find((e=>e.id===r&&!0===e.bShareOn)),l=[];return u&&i!==qa.End&&(fb.stopSharing(r),gb.stopDesktopSharing(),l.push(Tp(qa.End)),Id(zc)),c&&i===qa.End&&(o&&(gb.stopRenderSharing(),fb.unsubscribeSharing(s),l.push(Ip(!1))),l.push(Tp(qa.Sharing))),Me(l)}))),epics12:(e,t)=>pr(e,rs).pipe(Tt(t),ht((e=>{let[t,n]=e;const{meeting:{userId:r}}=n,i=t.payload.body.update;return i&&i.length>0&&i.findIndex((e=>e.id!==r&&void 0!==e.bShareOn))>-1})),Ye((n=>{let[r,i]=n;const{payload:{body:{update:o}}}=r,{share:{activeNodeId:s,isReceiveSharing:a}}=i,u=hy(i),c=o.filter((e=>!0===e.bShareOn&&!1===e.bSharePause)),l=o.filter((e=>!0===e.bShareOn&&!0===e.bSharePause)),d=o.filter((e=>!1===e.bShareOn));return c.length>0&&c.forEach((e=>{-1===u.findIndex((t=>t.userId===e.id))?Id(Qc,e):Id(Xc,e)})),l.length>0&&l.forEach((e=>{Id(Zc,e)})),d.length>0&&(d.forEach((e=>{Id(Yc,e)})),a&&d.some((e=>e.id===s)))?pt(pr(e,ts).pipe(gt(1),St(ge)),at(50).pipe(St(Le("timeout")))).pipe(ft((()=>{const{share:{activeNodeId:e,isReceiveSharingFromMainSession:n},audio:r}=t.value,i=u.filter((t=>t.userId!==e));if(i.length>0){const o=i[0],{userId:s}=o;return fb.unsubscribeSharing(e,n),ob(fb,t.value,s),gb.switchSharingSource(s,n),null==r||r.localShareAudioUserMutedList.forEach((e=>{gb.setSharingAudioVolume(s,e.userId!==s||e.muted,e.isFromMainSession)})),Id(el,{userId:s}),Fe(wp({activeNodeID:s,bStatus:1,ssrc:s}))}return ge}))):ge}))),epics13:(e,t)=>pr(e,ns).pipe(Tt(t),It((e=>{let[n,r]=e;const{payload:{body:{encryptKey:i,additionalType:o}}}=n,{media:{sharingDecodeStatus:s,sharingEncodeStatus:a},meeting:{confId:u,userId:c,zoomId:l,meetingId:d,meetingNumber:h,isWebinar:p}}=r;return Ov(t).pipe(It((e=>{let n=a;return(!Uo.isSupportSendScreenSharing||p&&e&&eh(e.userRole))&&(n="failed"),Rv("sharing",n,s).pipe(At((e=>{let[n,r]=e;const s={userId:c,sn:ai(l),confId:u,encryptKey:ai(i),encryptType:o,meetingId:d,meetingNumber:h};if(n&&(null==gb||gb.updateMediaParams({iVType:zo.SHARING_ENCODE,isFromMainSession:!1,updateParams:s})),r){gb.updateMediaParams({iVType:zo.SHARING_DECODE,isFromMainSession:!1,updateParams:s});const{participants:{attendeesList:e}}=t.value;if(e.length>0){const t=e.map((e=>({userid:e.userId,sn:e.zoomID&&ai(e.zoomID)})));gb.updateUserMediaSN({added:t,isFromMainSession:!1,iVType:zo.SHARING_DECODE})}}})),St(ge))})))}))),epics14:(e,t)=>mr(e,20235).pipe(Tt(t),At((e=>{let[t,n]=e;const{media:{sharingDecodeStatus:r}}=n,{type:i,payload:{body:o}}=t,s=i===`${Vn}`;Rv("sharing","success",r).subscribe((e=>{let[,t]=e;t&&gb.addReceivedSharingChannelType({isFromMainSession:s,...o})}))})),St(ge)),epics15:(e,t)=>mr(e,20236).pipe(Tt(t),At((e=>{let[t,n]=e;const{media:{sharingDecodeStatus:r}}=n,{type:i,payload:{body:{ssrc:o}}}=t,s=i===`${Vn}`;Rv("sharing","success",r).subscribe((e=>{let[,t]=e;t&&gb.removeReceivedSharingChannelType({isFromMainSession:s,ssrc:o})}))})),St(ge)),epics16:e=>vr(e,Da.SharingFirstDecodeFrameReceivedSsrc).pipe(ht((e=>!!e.payload.data)),At((e=>{const{payload:{data:{ssrc:t}}}=e;fb.sendReceivingSharingReady(t)})),St(ge)),epics17:(e,t)=>pr(e,20233).pipe(ht((()=>!!t.value.share.isRequireReadReceipt)),At((e=>{const{payload:{body:{bReceiveOk:t}}}=e;t&&Id(al)})),St(ge)),epics18:(e,t)=>pr(e,is).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.lockShare)})),Ye((e=>{const{payload:{body:{lockShare:n}}}=e,{share:{isOptimizedForSharedVideo:r,isSharingToBreakoutRoom:i},audio:{isSharingAudio:o},meeting:{userId:s}}=t.value,a=[];return n===Ha.MultipleShare&&r&&(fb.startSharing(s,{bShareAudio:o,bShareToBO:i,bShareVideo:!1}),gb.switchSharingMode(mu.Normal),a.push(Vp(!1))),Me(a)}))),epics19:(e,t)=>vr(e,Da.ShareQosData).pipe(Tt(t),Ke((e=>{var t;let[n,r]=e;const{meeting:{isWebinar:i},media:{sharingEncodeStatus:o,sharingDecodeStatus:s},share:{status:a,isReceiveSharing:u},participants:{xmppAttendeeList:c}}=r;let l=_h(r).length>0;i&&(l=l||Boolean(c.length));const d=a!==qa.End&&"success"===o&&l,h=u&&"success"===s;return null!==(t=n.payload.data)&&void 0!==t&&t.encoding?d?(Id(ul,n.payload),Bp(n.payload)):Bp(lu):h?(Id(ul,n.payload),jp(n.payload)):jp(lu)})))},vE=hr(mE,gE),yE=Ps.createAgent();let SE=function(e){return e.Add="add",e.List="list",e.Remove="memberremove",e.rename="rename",e.update="UPDATE",e}({}),bE=function(e){return e.Open="open",e.Message="message",e.Error="error",e.Close="close",e}({});class EE{constructor(){this.eventHandlers=void 0,this.websocket=void 0,this.seq=void 0,this.eventHandlers=new Map,this.websocket=null,this.seq=1}static getInstance(){return this.xmppInstance||(this.xmppInstance=new EE),this.xmppInstance}on(e,t){let n=this.eventHandlers.get(e);n||(n=[]),n.push(t),this.eventHandlers.set(e,n)}off(e,t){const n=this.eventHandlers.get(e);if(n){const r=n.filter((e=>e!==t));this.eventHandlers.set(e,r)}}emit(e,t){const n=this.eventHandlers.get(e);n&&n instanceof Array&&n.slice(0).forEach((e=>{try{e(t)}catch(e){console.error(e)}}))}sendMessageToRwg(e){this.seq+=1;const t=this.seq;return this.websocket&&this.websocket.readyState===WebSocket.OPEN&&this.websocket.send(JSON.stringify(Object.assign(e,{seq:t}))),t}connect(e){this.websocket=new WebSocket(e),this.websocket.binaryType="arraybuffer",this.addWebSocketEventListeners()}close(){var e;null===(e=this.websocket)||void 0===e||e.close()}addWebSocketEventListeners(){this.websocket&&(this.websocket.addEventListener("open",(e=>{this.emit(bE.Open,e)})),this.websocket.addEventListener("message",(e=>{const{data:t}=e;var n;if(t instanceof ArrayBuffer)0===new Uint8Array(t)[0]&&(null===(n=this.websocket)||void 0===n||n.send(t));else try{this.emit(bE.Message,JSON.parse(t))}catch(e){console.warn("Unsupported format",t)}})),this.websocket.addEventListener("close",(e=>{this.emit(bE.Close,e)})),this.websocket.addEventListener("error",(e=>{this.emit(bE.Error,e)})))}join(e){return{seq:this.sendMessageToRwg({evt:24576,body:{clientCap:e}})}}raiseHand(){return{seq:this.sendMessageToRwg({evt:24580,body:null})}}lowerHand(e){return{seq:this.sendMessageToRwg({evt:24578,jids:e||[]})}}sendWebinarMseeage(e,t,n){const r={msg:e,jid:t?[t]:[],type:n,bcm:arguments.length>3&&void 0!==arguments[3]&&arguments[3]};return{seq:this.sendMessageToRwg({evt:24582,body:r})}}sendAnswer(e,t,n){return{seq:this.sendMessageToRwg({evt:24584,body:{question_attendeejid:t.jid,question_attendeename:t.displayName,question_text:t.questionText,question_id:t.questionId,question_anonymous:t.isAnonymous,question_time:t.questionTime,text:e,isPrivate:n}})}}answerOnline(e,t){return{seq:this.sendMessageToRwg({evt:24586,body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,isLiveStart:t}})}}dismissQuestion(e){return{seq:this.sendMessageToRwg({evt:24590,body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,bOpen:!1}})}}deleteQuestion(e){return{seq:this.sendMessageToRwg({evt:24614,body:{question_id:e,bDelete:!0}})}}deleteComment(e){return{seq:this.sendMessageToRwg({body:{comment_id:e,bDelete:!0},evt:24616})}}reopenQuestion(e){return{seq:this.sendMessageToRwg({body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,bOpen:!0},evt:24590})}}askQuestion(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;const i=li();return{seq:this.sendMessageToRwg({body:{id:i,text:e,isAnonymous:n,bAllowAttendeeViewAllQuestion:r,name:t},evt:24592}),questionId:i}}upOrDownVote(e,t){return{seq:this.sendMessageToRwg({body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,bUpVote:t},evt:24598})}}rename(e,t){return{seq:this.sendMessageToRwg({body:{jid:e,displayName:t},evt:24600})}}setSkinTome(e){return{seq:this.sendMessageToRwg({body:{skinTone:e},evt:24618})}}}EE.xmppInstance=null;const wE=YS.getInstance();let IE,_E;const CE=Ps.createAgent();let AE=null;function TE(e){switch(e.responseType){case"json":if("response"in e)return e.response;var t=e;return JSON.parse(t.responseText);case"document":return e.responseXML;default:return"response"in e?e.response:(t=e).responseText}}var RE,OE=function(e,t,n,r){void 0===r&&(r="download_load"),this.originalEvent=e,this.xhr=t,this.request=n,this.type=r;var i=t.status,o=t.responseType;this.status=null!=i?i:0,this.responseType=null!=o?o:"";var s=t.getAllResponseHeaders();this.responseHeaders=s?s.split("\n").reduce((function(e,t){var n=t.indexOf(": ");return e[t.slice(0,n)]=t.slice(n+2),e}),{}):{},this.response=TE(t);var a=e.loaded,u=e.total;this.loaded=a,this.total=u},PE=E((function(e){return function(e,t,n){var r;this.message=e,this.name="AjaxError",this.xhr=t,this.request=n,this.status=t.status,this.responseType=t.responseType;try{r=TE(t)}catch(e){r=t.responseText}this.response=r}})),DE=function(){function e(e,t){return PE.call(this,"ajax timeout",e,t),this.name="AjaxTimeoutError",this}return e.prototype=Object.create(PE.prototype),e}(),kE=Ke((function(e){return e.response})),xE=(RE=function(e){var t;return t="string"==typeof e?{url:e}:e,new U((function(e){var n,r,i,o=f({async:!0,crossDomain:!1,withCredentials:!1,method:"GET",timeout:0,responseType:"json"},t),s=o.queryParams,a=o.body,u=o.headers,c=o.url;if(!c)throw new TypeError("url is required");if(s)if(c.includes("?")){var l=c.split("?");if(2<l.length)throw new TypeError("invalid url");i=new URLSearchParams(l[1]),new URLSearchParams(s).forEach((function(e,t){return i.set(t,e)})),c=l[0]+"?"+i}else c=c+"?"+(i=new URLSearchParams(s));var d={};if(u)for(var h in u)u.hasOwnProperty(h)&&(d[h.toLowerCase()]=u[h]);var p=o.crossDomain;p||"x-requested-with"in d||(d["x-requested-with"]="XMLHttpRequest");var g=o.withCredentials,m=o.xsrfCookieName,v=o.xsrfHeaderName;if((g||!p)&&m&&v){var y=null!==(r=null===(n=null===document||void 0===document?void 0:document.cookie.match(new RegExp("(^|;\\s*)("+m+")=([^;]*)")))||void 0===n?void 0:n.pop())&&void 0!==r?r:"";y&&(d[v]=y)}var S,b=function(e,t){var n;if(!e||"string"==typeof e||function(e){return"undefined"!=typeof FormData&&e instanceof FormData}(e)||function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}(e)||function(e){return jE(e,"ArrayBuffer")}(e)||function(e){return jE(e,"File")}(e)||function(e){return jE(e,"Blob")}(e)||function(e){return"undefined"!=typeof ReadableStream&&e instanceof ReadableStream}(e))return e;if(function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView(e)}(e))return e.buffer;if("object"==typeof e)return t["content-type"]=null!==(n=t["content-type"])&&void 0!==n?n:"application/json;charset=utf-8",JSON.stringify(e);throw new TypeError("Unknown body type")}(a,d),E=f(f({},o),{url:c,headers:d,body:b});S=t.createXHR?t.createXHR():new XMLHttpRequest;var w=t.progressSubscriber,I=t.includeDownloadProgress,_=void 0!==I&&I,C=t.includeUploadProgress,A=void 0!==C&&C,T=function(t,n){S.addEventListener(t,(function(){var t,r=n();null===(t=null==w?void 0:w.error)||void 0===t||t.call(w,r),e.error(r)}))};T("timeout",(function(){return new DE(S,E)})),T("abort",(function(){return new PE("aborted",S,E)}));var R=function(e,t){return new OE(t,S,E,e+"_"+t.type)},O=function(t,n,r){t.addEventListener(n,(function(t){e.next(R(r,t))}))};A&&[FE,LE,VE].forEach((function(e){return O(S.upload,e,NE)})),w&&[FE,LE].forEach((function(e){return S.upload.addEventListener(e,(function(e){var t;return null===(t=null==w?void 0:w.next)||void 0===t?void 0:t.call(w,e)}))})),_&&[FE,LE].forEach((function(e){return O(S,e,ME)}));var P=function(t){var n="ajax error"+(t?" "+t:"");e.error(new PE(n,S,E))};S.addEventListener("error",(function(e){var t;null===(t=null==w?void 0:w.error)||void 0===t||t.call(w,e),P()})),S.addEventListener(VE,(function(t){var n,r,i=S.status;if(i<400){null===(n=null==w?void 0:w.complete)||void 0===n||n.call(w);var o=void 0;try{o=R(ME,t)}catch(t){return void e.error(t)}e.next(o),e.complete()}else null===(r=null==w?void 0:w.error)||void 0===r||r.call(w,t),P(i)}));var D=E.user,k=E.method,x=E.async;for(var h in D?S.open(k,c,x,D,E.password):S.open(k,c,x),x&&(S.timeout=E.timeout,S.responseType=E.responseType),"withCredentials"in S&&(S.withCredentials=E.withCredentials),d)d.hasOwnProperty(h)&&S.setRequestHeader(h,d[h]);return b?S.send(b):S.send(),function(){S&&4!==S.readyState&&S.abort()}}))},RE.get=function(e,t){return xE({method:"GET",url:e,headers:t})},RE.post=function(e,t,n){return xE({method:"POST",url:e,body:t,headers:n})},RE.delete=function(e,t){return xE({method:"DELETE",url:e,headers:t})},RE.put=function(e,t,n){return xE({method:"PUT",url:e,body:t,headers:n})},RE.patch=function(e,t,n){return xE({method:"PATCH",url:e,body:t,headers:n})},RE.getJSON=function(e,t){return kE(xE({method:"GET",url:e,headers:t}))},RE),NE="upload",ME="download",FE="loadstart",LE="progress",VE="load",BE=Object.prototype.toString;function jE(e,t){return BE.call(e)==="[object "+t+"]"}const UE=YS.getInstance(),HE=e=>{const{meeting:{encryptedRWC:t,encryptedGEORWC:n,discardedRwcList:r,meetingOptions:i}}=e;let o=[];return(null==i?void 0:i.isEnableGeoFenceRWC)&&n&&(null==n?void 0:n.length)>0?o=n.filter((e=>!r.includes(e.rwc))).reduce(((e,t)=>{const{dl:n,rwc:r,rwcToken:i}=t,o=e.find((e=>e.dl===n));if(o)o.items.push({rwc:r,rwcToken:i});else{const t={dl:n,items:[]};t.items.push({rwc:r,rwcToken:i}),e.push(t)}return e}),[]):t&&(o=[{dl:0,items:Object.keys(t).map((e=>({rwc:e,rwcToken:t[e]})))}]),o},qE=e=>ct(...e.map((e=>0===e.dl?Me(e.items):at(e.dl).pipe(Ye((()=>Me(e.items))))))),KE=(e,t)=>e.pipe(Ut(`${xi}`),Tt(t),ht((e=>{let[,t]=e;return void 0!==t.meeting.encryptedRWC||void 0!==t.meeting.encryptedGEORWC&&t.meeting.encryptedGEORWC.length>0})),It((e=>{let[,n]=e;const{meeting:{ts:r,auth:i,meetingNumber:o,meetingOptions:s,meetingId:a,userName:u},breakoutRoom:c}=n,l=null==s?void 0:s.isEnableGeoFenceRWC,d=HE(n);if(d.length>0){const e={serversLength:d.reduce(((e,t)=>e+t.items.length),0),pingFailedServerList:[],pingRwcServerCounts:0,retryCounts:0};let n;return l&&(n=new Z,qE(d).subscribe((e=>{var t;return null===(t=n)||void 0===t?void 0:t.next(e)}))),(l?n:qE(d)).pipe(Ct((()=>{const{meeting:{meetingStatus:r,meetingId:i}}=t.value,o=r===Co.Initial&&!!i&&e.pingFailedServerList.length<e.serversLength&&e.serversLength>0;return!o&&n&&n.complete(),o})),At((()=>{if(e.pingRwcServerCounts=e.pingRwcServerCounts+1,l&&e.pingRwcServerCounts===e.serversLength){const r=1e3*Math.floor(5*Math.pow(2,e.retryCounts));e.retryCounts=e.retryCounts+1,UE.makeLogger(["Join Meeting Flow"]).info(`ping rwc retry,current rwc list:${JSON.stringify(HE(t.value))},retry counts:${e.retryCounts}, ${JSON.stringify({meetingId:a,meetingNumber:GS(o),userName:GS(u)})}`,["Ping RWC Retry"]),at(r).pipe(Ke((()=>{const n=HE(t.value);return Object.assign(e,{serversLength:n.reduce(((e,t)=>e+t.items.length),0),pingFailedServerList:[],pingRwcServerCounts:0}),n}))).subscribe((e=>{qE(e).subscribe((e=>{n.next(e)}))}))}})),Ye((t=>{const{rwc:s,rwcToken:d}=t,h=((e,t,n,r,i,o)=>{const s={ts:r,auth:i,rwcToken:n,dmz:1};return o&&Object.assign(s,{confID:o}),`https://${e}/wc/ping/${t}?${new URLSearchParams(s).toString()}`})(s,o,d,r,i,null==c?void 0:c.currentRoom.boConfId);return xE({url:h,crossDomain:gi(h)}).pipe(Ye((e=>{let t={};return t=e.response?{...e.response,rwc:s,fromNginx:!1}:{rwc:s,rwg:s,rwcToken:d,fromNginx:!0},Me([jn(t),On()])})),ft((()=>{const{pingFailedServerList:t,serversLength:r}=e;return t.push(h),t.length===r&&(l&&n&&n.complete(),UE.report(`ping rwc error, ${JSON.stringify({meetingId:a,meetingNumber:GS(o),userName:GS(u)})}`,["Join Meeting Flow","Ping RWC Error"],"error"),Id(Ws,{reason:"connection error",errorCode:Ci.CommonError})),ge})))})),wt(Wi(performance.now())))}return ge})));let $E=0;const WE=YS.getInstance(),GE={meetingStatus:Co.Initial,isWindowOpen:!1,apiKey:"",signature:"",signatureType:"",lang:"en-US",tk:"",customerKey:"",mtkGuid:"",pingRWCTimestamp:0,meetingInfoTimestamp:0,passWord:"",meetingNumber:0,userName:"",userEmail:"",sdkUrl:"",sdkOrigin:"",proxy:1,cv:"",meetingId:"",tid:"",ts:"",auth:"",sign:"",isSupportCallOut:!1,tollNumbers:void 0,recordingEnable:!1,callOutCountry:void 0,inviteEmail:"",xmppConfig:null,isSupportH323:!1,h323GatewayInfo:"",h323Password:"",trackAuth:"",isOriginHost:!1,isWebinar:!1,encryptedRWC:void 0,meetingOptions:{},meetingTopic:"",bLock:!1,bHoldUponEntry:!1,viewOnly:0,listenOnlyPhone:0,bAllowRaiseHand:!1,bAllowAttendeeRename:!1,bBroadcast:void 0,bAllowPlayChimeForEnterOrExit:!1,bIbDisableShare:!1,bIbDisableChat:!1,bAllowShowCount:!1,encryptKey:"",bNoHostTimeOut:!1,confId:"",conId:"",e2eEncrypt:!1,zoomId:"",jid:"",xtoken:"",groups:void 0,svcUrl:"",encType:NaN,userGUID:"",userId:NaN,isHost:!1,isCoHost:!1,participantID:0,isOnHold:!1,isMeetingReset:!1,bRecord:!1,audioVideoBeforeOnHold:void 0,region:void 0,network:void 0,joinMeetingTimeStamp:0,activeAppInfo:void 0,recordingDisclaimerForRecorder:{},recordingDisclaimer:{},ccUrl:"",sessionIdleTimeoutMins:40,reportDomain:"",isAudioBridgeEnabled:!0,discardedRwcList:[],sharePronounType:void 0,stayAwake:!1,wrInfo:{},meetingInfo:{},isNewJoinFlow:!1,gatewayUserList:[],logConfig:"",logEncryptionPubKey:"",failover:{count:0,isCurrentFailoverRecorded:!1,reason:-1,interval:0,joinMeetingSuccessTimestamp:0,sequence:""},enableLongPollingCheckStart:!1,rsPwd:"",chatModerationPolicy:{}},zE=Rn({[`${Bi}`]:hE(((e,t)=>{let{payload:n}=t;n.customerKey=e.customerKey||n.customerKey||"",Object.assign(e,n),e.meetingStatus=Co.Initial})),[`${ji}`]:hE(((e,t)=>{let{payload:n}=t;n.customerKey=e.customerKey||n.customerKey||"",Object.assign(e,n)})),[`${Ui}`]:hE(((e,t)=>{let{payload:n}=t;e.isWindowOpen=n})),[`${Hi}`]:hE(((e,t)=>{let{payload:n}=t;n.useSDK?e.signatureType="sdk":e.signatureType="api",e.apiKey=n.apiKey,e.signature=n.signature,e.lang=n.language})),[`${qi}`]:hE(((e,t)=>{let{payload:n}=t;e.ztk=n})),[`${Ki}`]:hE(((e,t)=>{let{payload:n}=t;e.zsk=n})),[`${$i}`]:hE(((e,t)=>{let{payload:n}=t;e.tk=n.tk,e.mtkGuid=n.mtkGuid})),[`${Wi}`]:hE(((e,t)=>{let{payload:n}=t;e.pingRWCTimestamp=n})),[`${So}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingInfoTimestamp=n})),[`${Gi}`]:hE(((e,t)=>{let{payload:n}=t;e.confId=n.confID,e.conId=n.conID,e.e2eEncrypt=n.e2eEncrypt,e.meetingNumber=parseInt(n.mn,10),e.zoomId=n.zoomID,e.meetingStatus=Co.Joined,e.jid=n.jid,e.xtoken=n.xtoken,e.groups=n.groups,e.svcUrl=n.svcUrl,e.encType=n.encType,e.userGUID=n.userGUID,e.userId=n.userID,e.role=n.role,e.participantID=n.participantID,e.reportDomain=n.reportDomain,e.abToken=n.ABtoken,e.supportLocalAB=!!n.supportLocalAB,n.enableWebTransport&&(e.enableWebtransport=n.enableWebTransport,e.webtransportPort=n.WebTransportPort)})),[`${zi}`]:hE(((e,t)=>{let{payload:n}=t;if(n.gatewayUser){var r;const{userId:t,sn:o}=n.gatewayUser,s=null===(r=e.gatewayUserList)||void 0===r?void 0:r.find((e=>e.userId===t));var i;s?s.sn=o:null===(i=e.gatewayUserList)||void 0===i||i.push(n.gatewayUser)}else Object.assign(e,n)})),[`${Qi}`]:hE(((e,t)=>{let{payload:n}=t;e.isHost=n})),[`${Yi}`]:hE(((e,t)=>{let{payload:n}=t;e.isCoHost=n})),[`${Zi}`]:hE(((e,t)=>{let{payload:n}=t;e.isOnHold=n})),[`${Xi}`]:hE(((e,t)=>{let{payload:n}=t;e.isMeetingReset=n})),[`${eo}`]:hE(((e,t)=>{let{payload:n}=t;e.audioVideoBeforeOnHold=n})),[`${to}`]:hE(((e,t)=>{let{payload:n}=t;e.currentUserAudioBeforeReset=n})),[`${no}`]:hE(((e,t)=>{let{payload:n}=t;e.isCurrentUserMutedBeforeReset=n})),[`${ro}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingStatus=n})),[`${io}`]:hE(((e,t)=>{let{payload:n}=t;e.region=n.region,e.network=n.network})),[`${oo}`]:hE(((e,t)=>{let{payload:n}=t;e.isCurrentUserStartVideoBeforeReset=n})),[`${so}`]:hE(((e,t)=>{let{payload:n}=t;e.joinMeetingTimeStamp=n})),[`${ao}`]:hE(((e,t)=>{let{payload:n}=t;e.activeAppInfo=n})),[`${uo}`]:hE(((e,t)=>{let{payload:n}=t;e.idleStartTime=n})),[`${co}`]:hE(((e,t)=>{let{payload:n}=t;e.sessionIdleTimeoutMins=n})),[`${lo}`]:hE(((e,t)=>{let{payload:n}=t;e.isAudioBridgeEnabled=n})),[`${ho}`]:hE(((e,t)=>{var n,r;let{payload:i}=t;const o=null===(n=e.encryptedGEORWC)||void 0===n||null===(r=n.find((e=>e.rwc===i)))||void 0===r?void 0:r.dc;if(o){var s;const t=null===(s=e.encryptedGEORWC)||void 0===s?void 0:s.filter((e=>e.dc===o));t&&e.discardedRwcList.some((e=>(null==t?void 0:t.findIndex((t=>t.rwc===e)))>=0))&&e.discardedRwcList.push(...t.map((e=>e.rwc))),e.discardedRwcList.push(i)}})),[`${po}`]:hE(((e,t)=>{let{payload:n}=t;e.sharePronounType=n})),[`${fo}`]:hE(((e,t)=>{let{payload:n}=t;e.stayAwake=n})),[`${go}`]:hE(((e,t)=>{let{payload:n}=t;e.failover.joinMeetingSuccessTimestamp=n})),[`${mo}`]:hE((e=>{Object.assign(e.failover,{...GE.failover,count:e.failover.count,joinMeetingSuccessTimestamp:e.failover.joinMeetingSuccessTimestamp})})),[`${vo}`]:hE(((e,t)=>{let{payload:n}=t;const{count:r,reason:i,interval:o,sequence:s}=n;e.failover.count=r,e.failover.reason=i,e.failover.interval=o,e.failover.isCurrentFailoverRecorded=!0,e.failover.sequence=s})),[`${yo}`]:hE(((e,t)=>{let{payload:n}=t;e.quicklyLeave=n})),[`${bo}`]:hE(((e,t)=>{let{payload:n}=t;e.isEnableZmkFromRWG=n})),[`${Ji}`]:(e,t)=>{let{payload:n}=t;const{isFailover:r}=n,i={isMeetingReset:!0,apiKey:e.apiKey,signatureType:e.signatureType,signature:e.signature,lang:e.lang,proxy:1,stayAwake:e.stayAwake};return r&&Object.assign(i,{currentUserAudioBeforeReset:e.audioVideoBeforeOnHold?e.audioVideoBeforeOnHold.audio:n.audio,isCurrentUserMutedBeforeReset:e.audioVideoBeforeOnHold?e.audioVideoBeforeOnHold.muted:n.muted,isCurrentUserStartVideoBeforeReset:e.audioVideoBeforeOnHold?e.audioVideoBeforeOnHold.video:n.video,meetingNumber:e.meetingNumber,userName:e.userName,passWord:e.passWord,userEmail:e.userEmail,sdkUrl:e.sdkUrl,sdkOrigin:e.sdkOrigin,cv:e.cv,zsk:e.zsk,ztk:e.ztk,idleStartTime:e.idleStartTime,sessionIdleTimeoutMins:e.sessionIdleTimeoutMins,customerKey:e.customerKey,failover:e.failover,stayAwake:e.stayAwake,quicklyLeave:e.quicklyLeave}),{...GE,...i}}},GE),JE={meetingFailoverReportEpic0:(e,t)=>e.pipe(Ut(`${Bi}`),It((()=>{const n=0===t.value.meeting.failover.joinMeetingSuccessTimestamp&&!!Do.get(ko.WebclientZoomId);return e.pipe(Ut(`${Gi}`),gt(1),Ye((()=>{const e=[],{count:r,sequence:i}=Do.get(ko.WebclientFailoverCount)||{};let{meeting:{failover:{count:o,reason:s,interval:a}}}=t.value;const{meeting:{pingRWCTimestamp:u}}=t.value;if(n){o=r+1,s=To.RefreshPage,a=0;const t=i?`${i}-${s}`:`${s}`;Do.set(ko.WebclientFailoverCount,{count:o,sequence:t},Oo.SessionStorage),e.push(vo({count:o,reason:s,interval:a,sequence:t}))}const c=performance.now();let l=`WCL_M, JMCT(${c-u})`;return o>0&&s!==To.NormalCase&&(l=`${l},FAILOVER(${o},${s},${(a/1e3).toFixed(1)})`),CE.sendRWGConnectionPerformance(l),e.push(mo(),go(c)),Me(e)})))}))),meetingFailoverReportEpic1:(e,t)=>e.pipe(Ut(`${Ni}`),Ye((e=>{const{payload:n}=e,{meeting:{failover:{joinMeetingSuccessTimestamp:r,isCurrentFailoverRecorded:i},userGUID:o,userId:s}}=t.value,a=[];if(!i){let{count:e,sequence:t}=Do.get(ko.WebclientFailoverCount)||{};t=t?`${t}-${n}`:`${n}`,n!==To.NormalCase&&(e+=1,Do.set(ko.WebclientFailoverCount,{count:e,sequence:t},Oo.SessionStorage));const i=performance.now()-r;a.push(vo({reason:n,count:e,interval:i,sequence:t,userGUID:o,userId:s}))}return Me(a)})))},QE={sessionIdleEpic0:(e,t)=>e.pipe(Ut(`${Gi}`),Tt(t),ht((e=>{let[,t]=e;return void 0!==t.meeting.zlkJwtToken})),It((()=>(IE&&IE.complete(),IE=new z,_E=ut(6e4).pipe(Ke((()=>performance.now()))).subscribe(IE),IE.pipe(Ke((e=>Vi(e)))))))),sessionIdleEpic1:e=>e.pipe(Ut(`${Dn}`)).pipe(At((()=>{IE&&(IE.complete(),_E.unsubscribe())})),St(ge)),sessionIdleEpic2:(e,t)=>e.pipe(Ut(`${Vi}`),Tt(t),Ye((e=>{var t;let[n,r]=e;const{meeting:{idleStartTime:i,sessionIdleTimeoutMins:o,isOriginHost:s,isWebinar:a},participants:{attendeesList:u,xmppAttendeeList:c},recording:l,breakoutRoom:d}=r,h=n.payload,p=[];if(1!==u.length||a&&0!==c.length||(null==d||null===(t=d.currentRoom)||void 0===t?void 0:t.status)===ih.InRoom||(null==l?void 0:l.cmrStatus)===Sa.Start)p.push(uo(void 0));else if(i){const e=s&&Yd(u[0].userRole)?o:40;h-i>60*e*1e3&&(console.warn(`No active for ${e} minutes, will end the session.`),wE.report(`Session idle timeout(${e} minutes), end the session automatically!`,["Join Meeting Flow","Session idle"],"warn"),p.push(Li()),at(500).subscribe((()=>{Td()})))}else p.push(uo(h));return Me(p)}))),sessionIdleEpic3:(e,t)=>e.pipe(Ut(`${xn}`),ht((e=>[rs,is].includes(e.payload.evt)&&void 0!==t.value.meeting.idleStartTime)),ke(de),Ye((()=>{var e;const{participants:{attendeesList:n,xmppAttendeeList:r},recording:i,breakoutRoom:o}=t.value,s=[];return(n.length>1||r.length>0||(null==i?void 0:i.cmrStatus)===Sa.Start||(null==o||null===(e=o.currentRoom)||void 0===e?void 0:e.status)===ih.InRoom)&&s.push(uo(void 0)),Me(s)}))),sessionIdleEpic4:e=>e.pipe(Ut(`${Mi}`,`${Li}`),mt(uo(void 0)))},YE={meetingMainEpics0:(e,t)=>pr(e,0).pipe(At((e=>{var n;if("READY"===(null===(n=e.payload.body)||void 0===n?void 0:n.status)){const{meeting:{zlkJwtToken:e,signatureType:n,sign:r,passWord:i,isHost:o,isOriginHost:s,ztk:a,zsk:u,tk:c,userEmail:l},breakoutRoom:d}=t.value,h=e?{zlkJwtToken:e}:{signType:n,sign:r};if(i&&""!==i&&(e?Object.assign(h,{mpwd:ri(i)}):o&&s||Object.assign(h,{mpwd:i})),(null==d?void 0:d.currentRoom.status)===ih.Joining){const{currentRoom:{boId:e,boConfId:t,boToken:n}}=d;e&&t&&n&&Object.assign(h,{botk:n})}if(!e){a&&Object.assign(h,{zak:a}),(sessionStorage.getItem(ko.WebclientZsk)||u)&&Object.assign(h,{zak:u}),c&&Object.assign(h,{tk:c});const e=Do.get(ko.WebclientWebinarToken);void 0!==e&&Object.assign(h,{tk:e});const t=sessionStorage.getItem(ko.WebclientRecordingToken);t&&Object.assign(h,{localRecordToken:t}),l&&Object.assign(h,{email:l})}yE.sendLaunchParams(h);const p=Do.get(ko.WebclientMeetingToken);p&&yE.joinMeeting(p)}})),St(ge)),meetingMainEpics1:(e,t)=>{return pr(e,as).pipe(Tt(t),(n=e=>{let[t,n]=e;const{payload:{body:{res:r,userID:i,zoomID:o,mn:s,participantID:a,meetingtoken:u,role:c}}}=t,{meeting:{userEmail:l,userName:d,isMeetingReset:h,apiKey:p,zsk:f,signatureType:g}}=n;if(wi.Success===r){const{WebclientParticipantId:e,WebclientZoomId:n,WebclientUserEmail:r,WebclientUserName:m,WebclientMeetingToken:v}=ko;Do.set(n,o,Oo.SessionStorage),Do.set(e,a,Oo.SessionStorage),l&&Do.set(r,l,Oo.SessionStorage),Do.set(m,d,Oo.SessionStorage),u&&Do.set(v,u,Oo.SessionStorage),f&&yE.sendSdkKeyToMonitor(g,p,i);const y=[Gi(t.payload.body),so(performance.now())];return h&&y.push(Xi(!1)),(c&zd.Owner)===zd.Owner&&(Id(Ws,{reason:"dont support assisnt join through widget",errorCode:-1}),yE.leaveMeeting()),Id($s,{meetingNumber:s}),Me(y)}if(wi.MeetingLocked===r)Id(Ws,Ri(r));else if(wi.UserFull===r)Id(Ws,Object.assign({},Ri(r),{lmUrl:t.payload.body.lmURL}));else if(wi.MeetingIsOver===r)Id(Ws,Ri(r));else if(wi.MMRIBReject===r)Id(Ws,Ri(r));else if(wi.MMRConfParticipantExists===r)Id(Ws,Ri(r));else if([wi.UserHasBeenRemoved,wi.WebinarBlockedEmail].includes(r))Id(Ws,Ri(r));else if(wi.MeetingNotStarted===r){var m;const e=Ri(r),{meeting:{meetingNumber:t,passWord:i,userName:o,userEmail:s,inviteEmail:a,meetingTopic:u,region:c,network:l,userId:d,lang:h,meetingId:p,participantID:f,wrInfo:g,meetingInfo:v,isNewJoinFlow:y,enableLongPollingCheckStart:S,tid:b,signature:E,rsPwd:w}}=n;Object.assign(e,{meetingInfo:{meetingNumber:t,password:i,userName:o,userEmail:s,inviteEmail:a,meetingTopic:u,region:c,network:l,userId:d,lang:h,webEndpoint:Tv(),meetingId:p,participantId:f,wrInfo:Object.assign({},g,{isNew:y}),scheduleInfo:v,enableLongPollingCheckStart:S,rid:Yv(b),role:Number(null===(m=mi(E))||void 0===m?void 0:m.role),rsPwd:w}}),Id(Ws,e)}else Id(Ws,Ri(r));return Me(zv(n,!1))},B(It(((e,t)=>n(e)||ge)))));var n},meetingMainEpics2:(e,t)=>pr(e,is).pipe(Tt(t),Ke((e=>{let[t,n]=e;const{payload:{body:r}}=t,{meeting:{zoomId:i,encType:o,gcmSessinKey:s}}=n;if(void 0!==(null==r?void 0:r.encryptKey)&&es.init(i,r.encryptKey,o),void 0!==(null==r?void 0:r.gatewayKey)){const e=Ls.getInstance(),[,t,n]=r.gatewayKey.split(".");e.sendUserNodeList([{userid:Number(t),sn:n&&ai(n)}],s)}return Id(Qs,r),zi(r)}))),meetingMainEpics3:(e,t)=>pr(e,7939).pipe(Tt(t),Ye((e=>{let[t,n]=e;const{payload:{body:r}}=t;if(void 0!==r.reason){if(Ii.Reconnect===r.reason)return _i.WaitingRoomFailover===r.subReason?Id(Gs,{reason:Eo.OnHold}):Id(Gs,{reason:Eo.Failover}),Fe(Ni(To.NormalCase));Ii.KickedByHost===r.reason?Id(zs,{reason:"kicked by host"}):[Ii.EndByHost,Ii.EndByNone,Ii.EndByAdmin,Ii.EndByHostStartAnotherMeeting].includes(r.reason)?Id(zs,{reason:"ended by host"}):Ii.FreeMeetingTimeout===r.reason?Id(zs,{reason:"free meeting ended"}):[Ii.DuplicateSession,Ii.MeetingTransfer].includes(r.reason)&&Id(zs,{reason:"duplicated session"})}return n.meeting.isMeetingReset?ge:Me(zv(n,!1))}))),meetingMainEpics4:(e,t)=>e.pipe(Ut(`${Ni}`),Tt(t),Ye((e=>{let[,t]=e;const n=zv(t,!0);let r;if(t.meeting.zlkJwtToken){const e=function(e){if(e){const{meeting:{topic:t,passWord:n,userName:r,zlkJwtToken:i,lang:o,cv:s,customerKey:a}}=e;return{topic:t,passWord:n,userName:r,zlkJwtToken:i,lang:o,cv:s,customerKey:a}}return null}(t),n={topic:null==e?void 0:e.topic,password:null!=e&&e.passWord?encodeURIComponent(null==e?void 0:e.passWord):"",userName:null==e?void 0:e.userName,zlk:null==e?void 0:e.zlkJwtToken,lang:null==e?void 0:e.lang,cv:null==e?void 0:e.cv,customerKey:null==e?void 0:e.customerKey};r=Fe(ki(n)).pipe(yt(1e3))}else{const e=function(e){var t;const{meeting:{apiKey:n,signature:r,signatureType:i,meetingNumber:o,userName:s,lang:a,passWord:u,userEmail:c,sdkUrl:l,sdkOrigin:d,proxy:h,cv:p,ztk:f,zsk:g,tk:m}}=e;let v=f||sessionStorage.getItem(ko.WebclientZtk),y=g||sessionStorage.getItem(ko.WebclientZsk);const S=1===Number(null===(t=mi(r))||void 0===t?void 0:t.role);return S||(v=y,y=""),{apiKey:n,signature:r,signatureType:i,meetingNumber:o,userName:s,lang:a,passWord:u?encodeURIComponent(u):"",userEmail:c,sdkUrl:l,sdkOrigin:d,proxy:h,cv:p,ztk:v,zsk:y,tk:m||sessionStorage.getItem(ko.WebclientTk),ulsm:S&&y?1:0}}(t);r=Fe(Di(e)).pipe(yt(1e3))}return Xe(Me(n),r)}))),meetingMainEpics5:e=>mr(e,7940).pipe(At((e=>{Id("MEETING_HOST_CHANGE_INDICATION",e.payload.body.bHost)})),Ke((e=>Qi(e.payload.body)))),meetingMainEpics6:e=>mr(e,7941).pipe(At((e=>{Id("MEETING_COHOST_CHANGE_INDICATION",e.payload.body.bCoHost)})),Ke((e=>Yi(e.payload.body)))),meetingMainEpics7:e=>mr(e,7945).pipe(At((e=>{const{payload:{body:{opt:t}}}=e;Do.set(ko.WebclientOpt,t,Oo.SessionStorage)})),St(ge)),meetingMainEpics8:(e,t)=>pr(e,7942).pipe(At((e=>{const{payload:{body:{bHold:t}}}=e;Do.set(ko.WebclientIsOnHold,t?1:0,Oo.SessionStorage),Id(Js,t)})),Tt(t),Ye((e=>{let[t,n]=e;const r=[Zi(t.payload.body.bHold)];if(t.payload.body.bHold){const e=gh(n);if(e){r.push(eo({audio:e.audio,video:e.bVideoOn,muted:e.muted}));const t=nb(Ls.getInstance());if("computer"===e.audio&&(t.leaveComputerAudio(),yE.joinOrLeaveVoip(!1)),e.bVideoOn&&t.stopCaptureVideo(),e.sharerOn&&(yE.stopSharing(e.userId),t.stopDesktopSharing(),r.push(Tp(qa.End))),n.video&&n.video.subscribedVideoList.length>0&&n.video.subscribedVideoList.forEach((e=>{yE.unsubscribeVideo(e)})),n.share&&n.share.isReceiveSharing){const e=n.share.activeNodeId;n.share.remoteControlledUserList.length>0&&(n.share.remoteControlledUserList.forEach((e=>{yE.sharingRequestRemoteControl(e,!1)})),fy(n)&&t.stopRemoteControl()),yE.unsubscribeSharing(e),t.stopRenderSharing()}}}return Me(r)}))),meetingMainEpics9:e=>pr(e,7954).pipe(Ke((e=>io(e.payload.body)))),meetingMainEpics10:e=>pr(e,4216).pipe(At((e=>{Id("MEETING_CLAIM_HOST_KEY_RESPONSE",e.payload.body.bresult)})),St(ge)),meetingMainEpics11:(e,t)=>e.pipe(Ut(`${Mi}`,`${Li}`),Tt(t),Ye((e=>{let[t,n]=e;const r=Ah(n);return t.type===`${Mi}`?(yE.leaveMeeting(r),Id(zs,{})):t.type===`${Li}`&&(yE.endMeeting(),Id(zs,{})),Me(zv(n,!1))}))),meetingMainEpics12:(e,t)=>e.pipe(Ut(`${Fi}`),Tt(t),Ye((e=>{let[t,n]=e;if(t.type===`${Fi}`&&n.meeting.meetingNumber&&!n.meeting.zlkJwtToken){const e={mn:n.meeting.meetingNumber.toString(),name:n.meeting.userName,customerKey:n.meeting.customerKey?ri(n.meeting.customerKey):""},{jbhLeave:t}={jbhLeave:`https://${wv}/wc/jbhLeave`},r=`${t}/?${new URLSearchParams(e).toString()}`;fetch(r,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"}})}return ge}))),meetingMainEpics13:e=>pr(e,2).pipe(At((()=>{console.warn("Upgrade to latest version to optimize meeting experience")})),St(ge)),meetingMainEpics14:e=>pr(e,1).pipe(At((e=>{const{payload:{body:{upgradeVersion:t}}}=e,n=Ri(1e4);if(n&&n.reason){const e=n.reason.replace(/{(\d+)}/g,(()=>t));n.reason=e}Id(Ws,n)})),St(ge)),meetingMainEpics15:e=>pr(e,4265).pipe(Ke((e=>{const{payload:{body:t}}=e,{nShareType:n}=t;return Id(Ys,{userSharePronounType:n}),po(n)}))),meetingMainEpics16:e=>pr(e,4128).pipe(At((e=>{const{payload:{body:{meetingtoken:t}}}=e,{WebclientMeetingToken:n}=ko;t&&Do.set(n,t,Oo.SessionStorage)})),St(ge)),meetingMainEpics17:(e,t)=>e.pipe(Ut(`${Gi}`),ht((()=>!!t.value.meeting.quicklyLeave)),It((()=>it(window,"beforeunload").pipe(At((()=>{yE.leaveMeeting()})),St(ge))))),meetingMainEpics18:(e,t)=>pr(e,8025).pipe(ht((e=>!!e.payload.body.Zmk&&!!t.value.meeting.isEnableZmkFromRWG)),Ke((e=>{const{payload:{body:{Zmk:t}}}=e;return zi({zmk:t})})))},ZE=hr(YE,{wakeLockEpic0:(e,t)=>e.pipe(Ut(`${Gi}`),Tt(t),ht((e=>{let[,t]=e;return!!t.meeting.stayAwake})),At((async()=>{try{const{isSafari:e,isIOSMobile:t}=Uo;AE&&AE.release().then((()=>{AE=null})),"wakeLock"in navigator&&((e||t)&&await Be(pt(it(document,"click").pipe(gt(1)),it(document,"touchend").pipe(gt(1)))),AE=await navigator.wakeLock.request("screen"),AE.addEventListener("release",(()=>{})))}catch(e){}})),It((()=>it(document,"visibilitychange").pipe(Ye((async()=>{if("visible"===document.visibilityState){const{isSafari:e,isIOSMobile:t}=Uo;AE&&AE.release().then((()=>{AE=null})),"wakeLock"in navigator&&((e||t)&&await Be(pt(it(document,"click").pipe(gt(1)),it(document,"touchend").pipe(gt(1)))),AE=await navigator.wakeLock.request("screen"))}else AE&&AE.release().then((()=>{AE=null}))})),St(ge))))),wakeLockEpic1:e=>e.pipe(Ut(`${Dn}`)).pipe(At((()=>{AE&&AE.release().then((()=>{AE=null}))})),St(ge))},JE,QE,{meetingInfoEpic:(e,t)=>e.pipe(Ut(`${ki}`),It((e=>{const n=Object.assign({},e.payload,{password:ri(e.payload.password),topic:ri(e.payload.topic)}),{videoSDKUrl:r}={meetingSDKUrl:`https://${wv}/api/v1/wc/info`,videoSDKUrl:`https://${wv}/wc/lsdk`};return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"zoomsdkjsonpcallback";return new U((r=>{$E++;const i=`${n}${$E}`,o=document.createElement("script");Object.keys(t).forEach((e=>(void 0===t[e]||null===t[e])&&delete t[e])),o.src=`${e}?${new URLSearchParams(Object.assign(t,{callback:i})).toString()}`,o.async=!0,o.onerror=e=>r.error(e),document.getElementsByTagName("head")[0].appendChild(o),window[i]=e=>{o.parentNode&&o.parentNode.removeChild(o),delete window[i],r.next(e),r.complete()}}))}(r,n).pipe(ft((e=>Fe({status:!1,result:e.toString(),errorCode:-3e3}))),Ye((n=>{const[r,i]=(o=Fe(n),[ht(s=e=>!0===e.status&&void 0!==e.result,a)(Oe(o)),ht(dt(s,a))(Oe(o))]);var o,s,a;return i.subscribe((e=>{WE.report(`get meeting info error, ${JSON.stringify(e)}`,["Join Meeting Flow","Get Meeting Info Error"],"error"),e.state||(3e3===e.errorCode&&"Meeting password is incorrect"===e.errorMessage?Id(Ws,{errorCode:Ci.WrongPasscode,reason:"Incorrect passcode."}):3e3===e.errorCode&&"The role type error"===e.errorMessage?Id(Ws,{errorCode:Ci.RoleTypeMissing,reason:"Role type error"}):-3e3===e.errorCode?Id(Ws,{errorCode:Ci.CommonError,reason:"connection error"}):3e3===e.errorCode?Id(Ws,{reason:e.errorMessage,errorCode:Ci.CommonError}):300===e.errorCode?Id(Ws,{reason:"This account does not exist or does not belong to you",errorCode:Ci.CommonError}):124===e.errorCode&&"Parse lite sdk topic and pwd fail"===e.errorMessage?Id(Ws,{reason:"Topic is invalid",errorCode:Ci.CommonError}):124===e.errorCode&&"The java web token is expired or more than 2 days or ineffective."===e.errorMessage?Id(Ws,{reason:"The token has expired, is over 2 days old, or is ineffective.",errorCode:Ci.CommonError}):124===e.errorCode&&Id(Ws,{reason:"Verify JWT failed",errorCode:Ci.CommonError}))})),r.pipe(Xv((n=>{if(!0===n.status){const{result:{mid:i,websdkClientFeatureOptions:o,showRecommendVersion:s}}=n;Do.init(i);const a=((e,t)=>{if(e.result){const{result:{mn:n,ts:r,auth:i,track_auth:o,mid:s,tid:a,encryptedRWC:u,encryptedGEORWC:c,user_identity:l,meetingOptions:d,can_recording:h,wcXMPPConfig:p,call_out_country_json:f,isOriginalHost:g,support_call_out:m,liveTranscription:v,logConfig:y,logEncryptionPubKey:S,toll_numbers_json:b,h323Password:E,liveStreamInfo:w,rc_auto_delete:I,jwt_rc:_,op_rc:C,mediaSDKVersion:A,mediaSDKPathPrefix:T,zmk:R,fileTransfer:O,fileServerDomain:P,accountId:D}}=e,{lang:k,password:x,topic:N,zlk:M,cv:F,userName:L}=t;return{meetingNumber:n,meetingId:s,tid:a,ts:r,auth:i,passWord:x,trackAuth:o,customerKey:l,encryptedRWC:JSON.parse(u||"{}"),encryptedGEORWC:JSON.parse(c||"{}"),meetingOptions:JSON.parse(d||"{}"),recordingEnable:"1"===h,topic:N,userName:Do.get(ko.WebclientUserName)||L,cv:F,zlkJwtToken:M,xmppConfig:JSON.parse(p||"{}"),callOutCountry:JSON.parse(f||"{}"),lang:k,isOriginHost:g,isSupportCallOut:"1"===m,liveTranscription:JSON.parse(v||"{}"),logConfig:y,logEncryptionPubKey:S,tollNumbers:void 0===b?void 0:JSON.parse(b),h323Password:E,liveStreamInfo:JSON.parse(w||"{}"),rcAutoDelete:I,jwtRc:_,opRc:C,mediaSDKPath:A&&T?`${vi(T)}/${A}`:void 0,zmk:R,fileTransfer:JSON.parse(O||"{}"),fileServerDomain:P,accountId:D}}return e})(n,e.payload);var r;s&&(null==e||null===(r=e.payload)||void 0===r||r.lang,console.log("Update VideoSDK-Web to the latest version to optimize meeting experience","https://developers.zoom.us/docs/video-sdk/web/"));const u=[Fe(Bi(a)),lr(KE,t,xi())],c=((e,t)=>{const n=[];if(e){const t=e.split("").reverse();Object.keys(Ao).filter((e=>/M:\d+(,\d+)*;V:\d+(,\d+)*/.test(Ao[e]))).forEach((e=>{const r=Ao[e];let[i,o]=r.split(";");i.startsWith("V:")&&([i,o]=[o,i]);const s=o.slice(2).split(",").map((e=>t[Number(e)-1])).reverse().join(""),a=parseInt(s,16),u=Qv[r];u&&(Array.isArray(u)?u:[u]).forEach((e=>{const t=e.mask?(a&e.mask)>0:a;n.push(Fe(e.action(t)))}))}))}return n})(o);c.length>0&&u.unshift(...c);const l=((e,t)=>{const n=[];if(e){const t=e.split("").reverse(),i=[];Ro.forEach((e=>{var n;const[r,o]=e.split("-"),s=Number(o)-1;i.length<s&&(i.length=s+1),i[s]=null!==(n=t[Number(r)-1])&&void 0!==n?n:"0"}));for(let e=0;e<i.length;e++){var r;i[e]=null!==(r=i[e])&&void 0!==r?r:"0"}n.push(Fe(ur(i.reverse().join(""))))}return n})(o);return l.length>0&&u.unshift(...l),Xe(...u)}})))})),wt(So(performance.now())))}))),pingRWCEpic:KE});var XE={exports:{}};XE.exports=function(){function e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}return function t(n,r){function i(t,i,o){if("undefined"!=typeof document){"number"==typeof(o=e({},r,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in o)o[a]&&(s+="; "+a,!0!==o[a]&&(s+="="+o[a].split(";")[0]));return document.cookie=t+"="+n.write(i,t)+s}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],r={},i=0;i<t.length;i++){var o=t[i].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(r[a]=n.read(s,a),e===a)break}catch(e){}}return e?r[e]:r}},remove:function(t,n){i(t,"",e({},n,{expires:-1}))},withAttributes:function(n){return t(this.converter,e({},this.attributes,n))},withConverter:function(n){return t(e({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(n)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}();var ew=XE.exports;const{WebclientIsOnHold:tw,WebclientOpt:nw,WebclientParticipantId:rw,WebclientZoomId:iw,WebclientMeetingToken:ow}=ko,{WebclientDeviceId:sw}=xo;function aw(e){let{retryCount:t,rwgServerList:n,userName:r,auth:i,trackAuth:o,meetingId:s,customerKey:a,tid:u,lang:c,ts:l,bid:d,botk:h,confID:p,zlkJwtToken:f,isAudioBridgeEnabled:g,isMeetingReset:m,cameraDevicesList:v,isFullHDVideoEnabled:y,isFullHDVideoShareEnabled:S}=e;const b=ew.get("_zm_mtk_guid");let E=Do.get(sw);if(E||(E=Cy(),Do.set(sw,E,Oo.LocalStorage)),n.length>t){var w;const I=n[t],_={dn2:ri(r),auth:i,browser:`${Uo.browser}${Uo.browserVersion} ${null!==(w=window)&&void 0!==w&&w.crossOriginIsolated?"SAB":""}`,trackAuth:o,mid:s,tid:u,lang:c,ts:l,"ZM-CID":E,_ZM_MTG_TRACK_ID:b||"",customer_key:ri(a),cfs:0,islch:1};if(f)try{const{vendor:e}=mi(f);e&&Object.assign(_,{vendor:e})}catch(e){console.log(e)}I.rwcAuth?Object.assign(_,{rwcAuth:I.rwcAuth}):I.rwcToken&&Object.assign(_,{rwcToken:I.rwcToken});const C=qo()?1:Uo.isIE||Uo.isSupportEssentialAudioAndVideoAbility?2:0;Object.assign(_,{as_type:C}),[{key:nw,queryKey:"opt"},{key:rw,queryKey:"participantID"},{key:iw,queryKey:"zoomid"}].forEach((e=>{const t=Do.get(e.key);void 0!==t&&(_[e.queryKey]=t)}));const A=d&&h&&p;A&&Object.assign(_,{bid:ri(d),confID:p}),Do.get(ow)&&Object.assign(_,{isdj:1}),Ho()&&(Object.assign(_,{from:Uo.isAndroidBrowser?"android":"ios"}),g&&Object.assign(_,{useABAudio:1})),Object.assign(_,{clientCaps:uw({isAudioBridgeEnabled:g&&Ho(),isBO:A,isFullHDVideoEnabled:y,isFullHDVideoShareEnabled:S})});const T=m?v.length>0?1:0:1;return Object.assign(_,{isCamera:T}),Object.assign(_,{clientOS:Uo.isAndroidOrIOSBrowser?Uo.isIOSMobile?"ios":"android":Uo.isMacOS?"mac":"win"}),Object.assign(_,{audioFeature:Ls.getAudioFeatureFlag()}),{queryObject:{..._},rwgServer:I}}return null}function uw(e){const{isAudioBridgeEnabled:t,isBO:n,isFullHDVideoEnabled:r,isFullHDVideoShareEnabled:i}=e;let o=Oh.WebCameraIndication|Oh.SendMeetingTokenSeparately|Oh.SmartSummary|Oh.LocalRecording|Oh.LocalRecordingGrantPermission|Oh.UnifyErrorType;const s=Ls.getPTZCapability();return(s.pan||s.tilt||s.zoom)&&(o|=Oh.SupportFarEndCameraControl),Ls.isSupportVideoShare()&&(o|=Oh.SupportVideoShare),t&&Ls.isSupportAudioBridgeAVSync()&&(o|=Oh.WebrtcAudioRtcpTime),Ls.isSupportShareMultiStream()&&(o|=Oh.ShareMultiStream),Ls.isSupportVideoLTR()&&(o|=Oh.VideoLTR),n||(o|=Oh.RequestRemoteControl),r&&Ls.isSupportFullHDVideo()&&(o|=Oh.SupportSend1080PVideo),i&&Ls.isSupportFullHDVideoShare()&&(o|=Oh.SupportSend1080PVideoShare),o}function cw(e,t){return t?B(yt(t),ht((()=>{const{socket:{zoomSocketStatus:t},meeting:{meetingStatus:n,isMeetingReset:r}}=e.value;return t!==Th.Closed&&n===Co.Joined&&!r}))):B(ht((()=>{const{socket:{zoomSocketStatus:t},meeting:{meetingStatus:n,isMeetingReset:r}}=e.value;return t!==Th.Closed&&n===Co.Joined&&!r})))}const lw=Ps.createAgent();let dw;const hw=EE.getInstance();let pw;const fw=Ds.getInstance();let gw;const mw={zoomSocketStatus:Th.Closed,xmppSocketStatus:Th.Closed,mainSessionSocketStatus:Th.Closed,retryCount:0,rwgServerList:[]},vw=Rn({[`${Bn}`]:hE(((e,t)=>{let{payload:n}=t;e.zoomSocketStatus=n.status})),[`${jn}`]:hE(((e,t)=>{let{payload:n}=t;const{rwgServerList:r}=e;r.find((e=>e.rwg===n.rwg))||r.push(n)})),[`${Un}`]:hE(((e,t)=>{let{payload:n}=t;e.retryCount=n})),[`${Hn}`]:hE(((e,t)=>{let{payload:n}=t;e.xmppSocketStatus=n})),[`${qn}`]:hE(((e,t)=>{let{payload:n}=t;e.mainSessionSocketStatus=n})),[`${Kn}`]:()=>mw},mw),yw={epics0:(e,t)=>e.pipe(Ut(`${On}`),Tt(t),ht((e=>{let[,t]=e;return t.socket.zoomSocketStatus===Th.Closed&&!!t.meeting.meetingId})),It((e=>{let[,n]=e;const{media:{patchedMediaSDKStatus:r}}=n;return(r===_u.Loading?Ad(Ll,1):Me([0])).pipe(It((()=>{const{socket:{retryCount:e,rwgServerList:n},meeting:r,breakoutRoom:i,video:o,share:s}=t.value;let a;const u={...r,retryCount:e,rwgServerList:n};if(o){const{cameraDevicesList:e,isFullHDVideoEnabled:t}=o;Object.assign(u,{cameraDevicesList:e,isFullHDVideoEnabled:t})}if(s){const{isFullHDVideoShareEnabled:e}=s;Object.assign(u,{isFullHDVideoShareEnabled:e})}if(i&&i.currentRoom.status===ih.Joining){const{currentRoom:{boId:e,boConfId:t,boToken:n}}=i;Object.assign(u,{bid:e,botk:n,confID:t})}if(a=r.zlkJwtToken?function(e){const t=aw(e);if(t){const{queryObject:n,rwgServer:r}=t,{topic:i,cv:o,meetingNumber:s}=e;return Object.assign(n,{topic:ri(i),iccv:o}),`wss://${r.rwg}/instantsdk/${s}?${new URLSearchParams(n).toString()}`}return null}(u):function(e){const t=aw(e);if(t){const{queryObject:n,rwgServer:r}=t,{cv:i,meetingNumber:o}=e;return Object.assign(n,{jscv:i,browser:n.browser+" ComponentView"}),[{key:tw,queryKey:"cfs"}].forEach((e=>{const t=Do.get(e.key);void 0!==t&&(n[e.queryKey]=t)})),`wss://${r.rwg}/wc/api/${o}?${new URLSearchParams(n).toString()}`}return null}(u),a){const e=(c=a,lw.connect(c),dw=new z,st((e=>lw.on(Rs.Message,e)),(e=>lw.off(Rs.Message,e)),(e=>e.data)).subscribe(dw),dw);return ct(e.pipe(ht((e=>"string"==typeof e)),Ke((e=>{try{return JSON.parse(e)}catch(e){return console.error(e),{evt:0}}})),ry(),Zv((e=>{if(0!==e.evt||!e.body||"invalid parameters!"!==e.body.test)return xn(e);Id(Ws,{errorCode:Ci.InvalidParameter,reason:"Invalid parameter"})})),wt(Bn({status:Th.Connecting,rwgUrl:a}))),e.pipe(ht((e=>e instanceof ArrayBuffer)),Ke((e=>Nn(e)))))}var c;return ge})))}))),epics1:(e,t)=>e.pipe(Ut(`${On}`),Tt(t),ht((e=>{let[,t]=e;return t.socket.zoomSocketStatus===Th.Closed&&!!t.meeting.meetingId})),It((()=>{const[e,n,r,i]=[Rs.Open,Rs.Close,Rs.Error,Rs.Inactive].map((e=>st((t=>lw.on(e,t)),(t=>lw.on(e,t)))));return ct(e.pipe(Ye((()=>ct(Fe(Bn({status:Th.Connected})),at(6e4).pipe(Tt(t),ht((e=>{let[,t]=e;return t.meeting.meetingStatus===Co.Initial&&!t.meeting.isMeetingReset})),Ke((()=>(Id(Gs,{reason:Eo.Failover}),Ni(To.NoHeartbeat))))))))),n.pipe(cw(t),Ke((()=>(Id(Gs,{reason:Eo.Failover}),Ni(To.Disconnect))))),i.pipe(cw(t),Ke((()=>(Id(Gs,{reason:Eo.Failover}),Ni(To.NoHeartbeat))))),r.pipe(Tt(t),Ye((e=>{let[,n]=e;const{meeting:{meetingStatus:r,isMeetingReset:i},socket:{rwgServerList:o,retryCount:s}}=n,a=[];if(r===Co.Initial&&null!=o&&o.length){const e=o[s];return at(5e3).pipe(ht((()=>t.value.meeting.meetingStatus===Co.Initial)),Ye((()=>{const{socket:{rwgServerList:e,retryCount:n}}=t.value,r=[];return e.length>n+1?r.push(Un(n+1),Dn({retry:!0})):(Id(Ws,{reason:"connection error",errorCode:Ci.CommonError}),r.push(...zv(t.value))),Me(r)})),wt(ho(null==e?void 0:e.rwc)))}return i||r!==Co.Joined||(Id(Gs,{reason:Eo.Failover}),a.push(Ni(To.OnError))),Me(a)}))))}))),epics2:(e,t)=>e.pipe(Ut(`${Dn}`),It((e=>e.payload&&e.payload.retry?Fe(On()).pipe(yt(1e3),wt(Bn({status:Th.Closed}))):Fe(Bn({status:Th.Closed})))),yt(100),At((()=>{var e;t.value.socket.zoomSocketStatus===Th.Closed&&(lw.close(),null===(e=dw)||void 0===e||e.complete())})))},Sw=hr(yw,{xmppEpics0:(e,t)=>e.pipe(Ut(`${Gi}`),Ye((()=>{const{meeting:{meetingOptions:e,zlkJwtToken:n,isWebinar:r}}=t.value,i=[];return(e.isPollingEnabled||n||r)&&i.push(Pn()),Me(i)}))),xmppEpics1:(e,t)=>e.pipe(Ut(`${Pn}`),Tt(t),ht((e=>{let[,t]=e;return"closed"===t.socket.xmppSocketStatus})),It((e=>{let[,t]=e;const{meeting:{svcUrl:n,meetingNumber:r,conId:i}}=t,o=function(e,t,n){return`wss://${e}/wc/media/${t}?type=x&cid=${n}`}(n,r,i);return(e=>(hw.connect(e),pw=new z,st((e=>hw.on(bE.Message,e)),(e=>hw.off(bE.Message,e))).subscribe(pw),pw))(o).pipe(ht((e=>void 0!==(null==e?void 0:e.evt))),Ke((e=>Mn(e))),wt(Hn(Th.Connecting)))}))),xmppEpics2:(e,t)=>e.pipe(Ut(`${Pn}`),It((()=>{const[e,n,r]=[bE.Open,bE.Close,bE.Error].map((e=>st((t=>hw.on(e,t)),(t=>hw.on(e,t)))));return ct(e.pipe(At((()=>{const e=function(){const{isSupportEssentialAudioAndVideoAbility:e,isSupportAudioWorklet:t}=Uo;return e&&t?11:10}();hw.join(e)})),mt(Hn(Th.Connected))),n.pipe(cw(t,500),Ke((()=>(Id(Gs,{reason:Eo.Failover}),Ni(To.DisconnectXmpp))))),r.pipe(cw(t,500),Ke((()=>(Id(Gs,{reason:Eo.Failover}),Ni(To.OnError))))))}))),xmppEpics3:e=>e.pipe(Ut(`${kn}`),mt(Hn(Th.Closed)),yt(100),At((()=>{var e;hw.close(),null===(e=pw)||void 0===e||e.complete()})))},{mainSessionEpics0:(e,t)=>e.pipe(Ut(`${Fn}`),Tt(t),ht((e=>{let[,t]=e;return"closed"===t.socket.mainSessionSocketStatus})),It((e=>{let[,t]=e;const{meeting:{svcUrl:n,meetingNumber:r,conId:i}}=t,o=function(e,t,n){return`wss://${e}/wc/media/${t}?type=m&cid=${n}&mode=2`}(n,r,i);return(e=>(fw.connect(e),gw=new z,st((e=>fw.on(Rs.Message,e)),(e=>fw.off(Rs.Message,e))).pipe(Ke((e=>e.data))).subscribe(gw),gw))(o).pipe(Ke((e=>{try{return JSON.parse(e)}catch(e){return console.error(e),{evt:0}}})),ht((e=>0!==e.evt)),ry(),Ke((e=>Vn(e))),wt(qn(Th.Connecting)))}))),mainSessionEpics1:(e,t)=>e.pipe(Ut(`${Fn}`),It((()=>{const[e,n,r]=[Rs.Open,Rs.Close,Rs.Error].map((e=>st((t=>fw.on(e,t)),(t=>fw.on(e,t)))));return ct(e.pipe(mt(qn(Th.Connected))),n.pipe(cw(t,500),Ke((()=>(Id(Gs,{reason:Eo.Failover}),Ni(To.DisconnectMChannel))))),r.pipe(cw(t,500),Ke((()=>(Id(Gs,{reason:Eo.Failover}),Ni(To.OnErrorMChannel))))))}))),mainSessionEpics2:e=>e.pipe(Ut(`${Ln}`),mt(qn(Th.Closed)),At((()=>{var e;fw.close(),null===(e=gw)||void 0===e||e.complete()})))}),bw={id:"userId",type:e=>Zd(e)?{userType:e,avatarBackgroundType:Math.floor(8*Math.random())+1}:{userType:e},role:e=>({userRole:e,isHost:Yd(e)}),dn2:e=>({displayName:ii(e)}),bShareOn:"sharerOn",bSharePause:"sharerPause",bLocalRecordStatus:e=>({bLocalRecord:e}),bGuest:"isGuest",bCapsRequestLT:"isRequestLT",customerKey:"userIdentity"},Ew=e=>{const t={};return["add","remove","update"].forEach((n=>{const r=n,i=e[r];null!=i&&(t[r]=i.reduce(((e,t)=>{const n=Object.keys(t).reduce(((e,n)=>{const r=bw[n];return"function"==typeof r?Object.assign(e,r(t[n])):"string"==typeof r?Object.assign(e,{[`${r}`]:t[n]}):Object.assign(e,{[`${n}`]:t[n]}),e}),{}),r=e.find((e=>e.userId===n.userId));return void 0!==r?Object.assign(r,n):e.push(n),e}),[]))})),t},ww={name:"displayName",node:e=>({userId:Number(e)}),role:e=>({userRole:Number(e)})},Iw=e=>Object.keys(e).reduce(((t,n)=>{const r=ww[n];return"function"==typeof r?Object.assign(t,r(e[n])):"string"==typeof r?Object.assign(t,{[`${r}`]:e[n]}):Object.assign(t,{[`${n}`]:e[n]}),t}),{}),_w={attendeesList:[],assistantList:[],xmppAttendeeList:[],allowTalkAttendeesList:[],failoverAttendeesList:[],isAdmitAllSilentUsers:!1},Cw=Rn({[`${Rd}`]:hE(((e,t)=>{let{payload:n}=t;void 0!==n.add&&n.add.length>0&&n.add.forEach((t=>{if(t.userType===Qd.Assitant){const n=e.assistantList.find((e=>e.userId===t.userId));void 0!==n?Object.assign(n,t):e.assistantList.push(t)}else if(Xd(t.userRole)){const n=e.allowTalkAttendeesList.find((e=>e.userId===t.userId));void 0!==n?Object.assign(n,t):e.allowTalkAttendeesList.push(t)}else{const n=e.attendeesList.find((e=>e.userId===t.userId));void 0!==n?Object.assign(n,t):e.attendeesList.push(t)}})),void 0!==n.update&&n.update.length>0&&n.update.forEach((t=>{const n=e.attendeesList.find((e=>e.userId===t.userId));if(void 0!==n)Object.assign(n,t);else{const n=e.allowTalkAttendeesList.find((e=>e.userId===t.userId));if(void 0!==n)Object.assign(n,t);else{const n=e.assistantList.find((e=>e.userId===t.userId));void 0!==n&&Object.assign(n,t)}}})),void 0!==n.remove&&n.remove.length>0&&n.remove.forEach((t=>{const n=e.attendeesList.findIndex((e=>e.userId===t.userId));if(-1!==n)e.attendeesList.splice(n,1);else{const n=e.allowTalkAttendeesList.findIndex((e=>e.userId===t.userId));if(-1!==n)e.allowTalkAttendeesList.splice(n,1);else{const n=e.assistantList.findIndex((e=>e.userId===t.userId));-1!==n&&e.assistantList.splice(n,1)}}}))})),[`${Vd}`]:hE(((e,t)=>{let{payload:n}=t;const{xmppAttendeeList:r}=e,i=r.map((e=>e.jid));n.forEach((e=>{const{jid:t}=e,n=i.indexOf(t);-1!==n?Object.assign(r[n],e):r.push(e)}))})),[`${Pd}`]:hE(((e,t)=>{let{payload:n}=t;e.isAdmitAllSilentUsers=n})),[`${Nd}`]:hE((e=>{e.attendeesList.forEach((e=>{e.bRaiseHand&&(e.bRaiseHand=!1)}))})),[`${Md}`]:hE((e=>{e.attendeesList.forEach((e=>{e.feedback>0&&(e.feedback=0)}))})),[`${kd}`]:hE(((e,t)=>{let{payload:n}=t;e.failoverAttendeesList.push(n)})),[`${xd}`]:hE(((e,t)=>{let{payload:n}=t;n.forEach((t=>{const n=e.failoverAttendeesList.findIndex((e=>e.zoomID===t.zoomID));-1!==n&&e.failoverAttendeesList.splice(n,1)}))})),[`${Fd}`]:hE(((e,t)=>{let{payload:n}=t;const{jid:r,name:i}=n,o=e.xmppAttendeeList.find((e=>e.jid===r));o&&(o.displayName=i)})),[`${Ld}`]:hE(((e,t)=>{let{payload:n}=t;const{jid:r}=n,i=e.xmppAttendeeList.findIndex((e=>e.jid===r));-1!==r&&e.xmppAttendeeList.splice(i,1)})),[`${Bd}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:r,key:i,value:o}=n,s=e.attendeesList.find((e=>e.userId===r));s&&(s[`${i}`]=o)})),[`${Dd}`]:()=>_w},_w),Aw={epics0:(e,t)=>pr(e,rs).pipe(Ke((e=>Ew(e.payload.body))),Tt(t),Ye((e=>{let[t,n]=e,r=[Rd(t)];const{meeting:{userId:i,isWebinar:o,isOnHold:s},participants:{attendeesList:a,failoverAttendeesList:u,allowTalkAttendeesList:c}}=n,l=c.map((e=>e.userId));if(t.add){const e=t.add.filter((e=>e.userId===i));e.length>0&&e.forEach((e=>{void 0!==e.bHold&&r.push(Zi(e.bHold)),Id(Vs,e)}));const s=t.add.filter((e=>e.userId!==i));if(s.length>0){const e=s.filter((e=>!Xd(e.userRole))).map((e=>{const t={...e};if(Zd(e.userType)){var r;const i=null===(r=n.audio)||void 0===r?void 0:r.dialout.find((t=>t.phoneNodeId===e.userId));i&&Object.assign(t,{phoneNumber:i.phoneNumber})}const i=u.find((t=>t.zoomID===e.zoomID));return i&&Object.assign(t,{source:i.isOnHold?"on hold":"failover"}),t})),t=e.filter((e=>!!e.source)).map((e=>({zoomID:e.zoomID})));if(r.push(xd(t)),Id(js,e),o){const e=s.filter((e=>Xd(e.userRole)));e.length>0&&Id(qs,e.map((e=>({userId:e.userId,isAllowToTalk:!0}))))}}}if(t.update){const e=t.update.filter((e=>e.userId===i));e.length>0&&e.forEach((e=>{Id(Bs,e),void 0!==e.bHold&&r.push(Zi(e.bHold))}));const n=t.update.filter((e=>!(e.userId===i||l.includes(e.userId))));if(n.length>0&&Id(Us,n),o){const e=t.update.filter((e=>e.userId!==i&&l.includes(e.userId)));e.length>0&&Id(qs,e)}}if(t.remove){const e=t.remove.map((e=>{const t=a.find((t=>t.userId===e.userId));return t?2===e.action&&1===e.nUserStatus?t.bHold?(r.push(kd({zoomID:t.zoomID,isOnHold:!0})),{...e,...t,reason:"on hold"}):(r.push(kd({zoomID:t.zoomID,isOnHold:!1})),{...e,...t,reason:"failover"}):{...e,...t}:null})).filter((e=>!!e));if(Id(Hs,e),o){const e=t.remove.filter((e=>l.includes(e.userId)));e.length>0&&Id(qs,e.map((e=>({userId:e.userId,isAllowToTalk:!1}))))}}const d=r.filter((e=>e.type===`${Zi}`));if(d.length>0){const e=d[d.length-1];r=r.filter((e=>e.type!==`${Zi}`)),e.payload!==s&&(r.push(e),Id(Js,!s))}return Me(r)}))),epics1:(e,t)=>gr(e,24595).pipe(Ye((e=>{const{payload:{body:{action:n,data:r}}}=e,{meeting:{jid:i},participants:{xmppAttendeeList:o}}=t.value,s=[];if(n===SE.rename){r.forEach((e=>{s.push(Fd(e))}));const e=r.map((e=>Iw(e)));Id(qs,e)}if(n===SE.Remove){r.forEach((e=>{s.push(Ld(e))}));const e=r.map((e=>({...Iw(e),removed:!0})));Id(Ks,e)}if([SE.Add,SE.List,SE.update].includes(n)){const e=r.map((e=>{const t=Iw(e);return Object.keys(t).reduce(((e,n)=>(""!==t[n]&&Object.assign(e,{[n]:t[n]}),e)),{})}));if(Id(qs,e),s.push(Vd(e)),n===SE.update){const e=r.find((e=>e.jid===i));if(e&&void 0!==e.bRaiseHand){const t=o.find((e=>e.jid===i));(null==t?void 0:t.bRaiseHand)!==e.bRaiseHand&&Id("MEETING_WEBINAR_ATTENDEE_RAISE_HAND",{bRaiseHand:e.bRaiseHand})}}}return Me(s)}))),epics2:e=>pr(e,7951).pipe(At((e=>{!1===e.payload.body.bStarted&&Id("ADMIT_ALL_SILENT_USERS_END",e.payload.body.bStarted)})),Ke((e=>Pd(e.payload.body.bStarted)))),epics3:e=>pr(e,7946).pipe(ht((e=>{var t;return["bRaiseHand","feedback"].includes(null===(t=e.payload.body)||void 0===t?void 0:t.key)&&0===e.payload.body.value})),Ke((e=>(Id(Us,{}),"bRaiseHand"===e.payload.body.key?Nd():Md()))))},Tw=hr(Aw),Rw={audioEncodeStatus:"initial",audioDecodeStatus:"initial",videoEncodeStatus:"initial",videoDecodeStatus:"initial",sharingEncodeStatus:"initial",sharingDecodeStatus:"initial",assetsPath:"",mediaConstraints:void 0,fileWithVersion:!1,enforceMultipleVideos:!1,enforceVirtualBackground:!1,enableAudioQos:!0,enableVideoQos:!0,isAudioBridgeReceiveReady:!1,isAudioBridgeSendReady:!1,isMediaAgentInitialized:!1,disableRenderLimits:!1,adaptedABOptionForMediaSDK:""},Ow=Rn({[`${zn}`]:hE(((e,t)=>{let{payload:n}=t;e.audioDecodeStatus=n})),[`${Gn}`]:hE(((e,t)=>{let{payload:n}=t;e.audioEncodeStatus=n})),[`${Zn}`]:hE(((e,t)=>{let{payload:n}=t;e.sharingDecodeStatus=n})),[`${Yn}`]:hE(((e,t)=>{let{payload:n}=t;e.sharingEncodeStatus=n})),[`${Qn}`]:hE(((e,t)=>{let{payload:n}=t;e.videoDecodeStatus=n})),[`${Jn}`]:hE(((e,t)=>{let{payload:n}=t;e.videoEncodeStatus=n})),[`${Xn}`]:hE(((e,t)=>{let{payload:n}=t;e.mediaConstraints=n.mediaConstraints,e.assetsPath=n.assetsPath,e.fileWithVersion=n.fileWithVersion,e.enforceMultipleVideos=!!n.enforceMultipleVideos,e.enforceVirtualBackground=n.enforceVirtualBackground,e.skipJsMedia=n.skipJsMedia,e.patchJsMedia=n.patchJsMedia,e.alternativeNameForVideoPlayer=n.alternativeNameForVideoPlayer,n.enforceMultipleVideos&&"object"==typeof n.enforceMultipleVideos&&(e.disableRenderLimits=!!n.enforceMultipleVideos.disableRenderLimits)})),[`${er}`]:hE(((e,t)=>{let{payload:n}=t;const{type:r,encrypeKey:i,additionalType:o}=n,s={encrypeKey:i,additionalType:o};"audio"===r?e.audioEncrypt=s:"video"===r?e.videoEncrypt=s:"sharing"===r&&(e.sharingEncrypt=s)})),[`${tr}`]:hE(((e,t)=>{let{payload:n}=t;e.isEnableDecoderInWorklet=n})),[`${nr}`]:hE(((e,t)=>{let{payload:n}=t;e.patchedMediaSDKStatus=n})),[`${rr}`]:hE(((e,t)=>{let{payload:n}=t;e.assetsPath=n})),[`${ir}`]:hE(((e,t)=>{let{payload:n}=t;e.enableAudioQos=n.audioQos,e.enableVideoQos=n.videoQos})),[`${or}`]:hE(((e,t)=>{let{payload:n}=t;e.isAudioBridgeReceiveReady=n})),[`${sr}`]:hE(((e,t)=>{let{payload:n}=t;e.isAudioBridgeSendReady=n})),[`${ar}`]:hE(((e,t)=>{let{payload:n}=t;e.isMediaAgentInitialized=n})),[`${ur}`]:hE(((e,t)=>{let{payload:n}=t;e.adaptedABOptionForMediaSDK=n})),[`${cr}`]:e=>({...Rw,mediaConstraints:e.mediaConstraints,assetsPath:e.assetsPath,fileWithVersion:e.fileWithVersion,enforceMultipleVideos:e.enforceMultipleVideos,disableRenderLimits:e.disableRenderLimits,enforceVirtualBackground:e.enforceVirtualBackground,alternativeNameForVideoPlayer:e.alternativeNameForVideoPlayer})},Rw),Pw=new class{constructor(){this.state={mediaSDK:void 0,mediaSDKInstanceMap:new Map,tagName:"video-player"},this.onceMap=new WeakMap,this.subscribers=[]}get(e){return this.state[e]}dispatch(e,t,n){t&&Object.assign(this.state,t),e&&this.notifySubscribers(e,n)}subscribe(e){return this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);-1!==t&&this.subscribers.splice(t,1)}}once(e,t){this.onceMap.set(t,{event:e,unSubscribe:this.subscribe(t)})}notifySubscribers(e,t){const n=[];this.subscribers.forEach((r=>{r(e,this.state,t);const i=this.onceMap.get(r);if(i){const{event:t,unSubscribe:o}=i;t===e&&(n.push(o),this.onceMap.delete(r))}})),n.forEach((e=>e()))}};var Dw,kw;!function(e){e[e.ADD_RENDER_VIDEO=1]="ADD_RENDER_VIDEO",e[e.STOP_RENDER_VIDEO=2]="STOP_RENDER_VIDEO",e[e.START_SHARING=23]="START_SHARING",e[e.STOP_SHARING=24]="STOP_SHARING",e[e.SWITCH_CANVAS_FOR_VIDEO_CAPTURE=25]="SWITCH_CANVAS_FOR_VIDEO_CAPTURE",e[e.UPDATE_SHARING_DECODE_PARAM=44]="UPDATE_SHARING_DECODE_PARAM",e[e.UPDATE_CANVAS_SIZE=46]="UPDATE_CANVAS_SIZE",e[e.ZOOM_RENDER=48]="ZOOM_RENDER",e[e.REMOVE_EXPIRED_CANVAS=76]="REMOVE_EXPIRED_CANVAS",e[e.WEBGL_LOST_REPLACE_CANVAS=77]="WEBGL_LOST_REPLACE_CANVAS",e[e.UPDATE_VIDEO_QUALITY=78]="UPDATE_VIDEO_QUALITY",e[e.SEND_RENDER_LOG=79]="SEND_RENDER_LOG"}(Dw||(Dw={})),function(e){e[e.WEBGL_LOST_IN_MULTI_VIEW=-32]="WEBGL_LOST_IN_MULTI_VIEW"}(kw||(kw={}));const xw="default-sesssion-key";var Nw,Mw,Fw;function Lw(e,t,n,r,i){const o=document.createElement("canvas");o.id=r;const s=Jw(o,e,t);return i(`VPISC:${window.devicePixelRatio},${s}`),o.style.pointerEvents="none",o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.width=e+"px",o.width=e*Qw(o),o.style.height=t+"px",o.height=t*Qw(o),o.ariaHidden="true",o.style.zIndex=n,o}function Vw(e,t,n=!1){const r=()=>{if(e){Jw(e,t.clientWidth,t.clientHeight),[Dw.UPDATE_CANVAS_SIZE,Dw.UPDATE_SHARING_DECODE_PARAM].forEach((n=>{var r;null===(r=Hw(t.getSessionId()))||void 0===r||r.Notify_MeidaSDK(n,{width:t.clientWidth*Qw(e),height:t.clientHeight*Qw(e),canvas:e})})),e.style.width=t.clientWidth+"px",e.style.height=t.clientHeight+"px";try{e.width=t.clientWidth*Qw(e),e.height=t.clientHeight*Qw(e)}catch(e){}Pw.dispatch("resize",void 0,e.id)}};n&&setTimeout((()=>{r(),e.style.visibility=""}),300);const i=Kw(r,300),o=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),s=new ResizeObserver(i);return o.addEventListener("change",i),s.observe(t),()=>{!function(e){zw.delete(e)}(e),null==s||s.disconnect(),o.removeEventListener("change",i)}}function Bw(e,t){Object.defineProperties(e,t.reduce(((t,n)=>(t[n]={get:()=>e.getAttribute(n),set:t=>{t?e.setAttribute(n,t):e.removeAttribute(n)}},t)),{}))}function jw(e,t){Object.entries(t).forEach((([t,n])=>{e.getAttribute(t)||e.setAttribute(t,n)}))}function Uw(e,t){const n=e.getAttribute(t);return!(!n||"true"!==n)}function Hw(e=xw){var t;return null===(t=Pw.get("mediaSDKInstanceMap").get(e))||void 0===t?void 0:t()}function qw(){if("function"==typeof crypto.randomUUID)return crypto.randomUUID();let e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(n=>{let r=16*Math.random();return e>0?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),("x"===n?r:3&r|8).toString(16)}))}function Kw(e,t){let n;return function(...r){clearTimeout(n),n=setTimeout((()=>{e(...r)}),t)}}function $w(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const r of n){const n=e[r],i=t[r];if("object"==typeof n&&"object"==typeof i){if(!$w(n,i))return!1}else if(n!==i)return!1}return!0}function Ww(e){return!e||"0"===e}function Gw(e,t){null==e||e.Notify_MeidaSDK(Dw.SEND_RENDER_LOG,{message:t})}!function(e){e.Video="video",e.Share="share"}(Nw||(Nw={})),function(e){e.DEFAULT="",e.MAIN="main"}(Mw||(Mw={})),function(e){e.Video_90P="0",e.Video_180P="1",e.Video_360P="2",e.Video_720P="3",e.Video_1080P="4"}(Fw||(Fw={}));const zw=new Map;function Jw(e,t,n){const r=t>=2*window.screen.width||n>=2*window.screen.height?1:window.devicePixelRatio,i=zw.get(e);return zw.set(e,r),i&&i!==r&&Pw.dispatch("scale",void 0,e.id),r}function Qw(e){return zw.get(e)||window.devicePixelRatio}function Yw(e,t){const{left:n,top:r,bottom:i,right:o,width:s,height:a}=e.getBoundingClientRect(),u=t.getBoundingClientRect();return{left:n-u.left,top:r-u.top,bottom:u.bottom-i,right:u.right-o,width:s,height:a}}const Zw=[];for(let e=0;e<=1;e+=.01)Zw.push(e);class Xw{constructor(e,t){if(this.getRenderParams=t,this.el=document.createElement("div"),this.position=null,this.id="",this.removePositionObserve=null,this.viewId=`${Pw.get("tagName")}-${qw()}`,this.getSDK=()=>Hw(this.container.getSessionId()),!e)throw new Error(`The ${Pw.get("tagName")} must have a ${Pw.get("tagName")}-container as its ancestor element.`);this.container=e,this.el.style.width="100%",this.el.style.height="100%"}getElement(){return this.el}init(){this.removeSubscribe=Pw.subscribe(((e,t,n)=>{n===this.getCanvas().id&&("resize"===e?(this.updateVideoPosition(),setTimeout((()=>{this.updateVideoPosition()}),300)):"scale"===e&&Gw(this.getSDK(),`VPSC:${Qw(this.getCanvas())}`))}))}getCanvas(){return this.container.getCanvas()}initObservePosition(){this.stopObservePosition(),this.removePositionObserve=function(e,t,n){const{wrapper:r=document.documentElement}=n,i=Kw(t,300);let o,s;const a=(n=1,s=!1)=>{o&&(o.disconnect(),o=null);const{top:u,left:c,width:l,height:d,right:h,bottom:p}=Yw(e,r);if(!l||!d)return void t({hide:!0,cross:!1,width:0,height:0,top:0,left:0,bottom:0,right:0});const f=((e,t,n,r)=>e<0||t<0||n<0||r<0)(u,p,c,h),g=((e,t,n,r,i,o)=>e<=0&&e+o<=0||t<=0&&t+o<=0||n<=0&&n+i<=0||r<=0&&r+i<=0)(u,p,c,h,l,d),m={root:r,threshold:f?Zw:n};f||(m.rootMargin=`${-u}px ${-h}px ${-p}px ${-c}px`);let v=!0,y=!0;s&&(y=!1),t({hide:g,cross:f,top:u,left:c,width:l,height:d,bottom:p,right:h}),i({hide:g,cross:f,top:u,left:c,width:l,height:d,bottom:p,right:h},!0),o=new IntersectionObserver((([e])=>{if(0===e.intersectionRatio)return y?a(1,!0):void 0;if(n!==e.intersectionRatio){if(!v)return a();a(0===e.intersectionRatio?1e-7:e.intersectionRatio)}1===e.intersectionRatio&&f&&a(),v=!1}),m),o.observe(e)};return a(),s=new ResizeObserver((()=>a())),s.observe(e),()=>{null==o||o.disconnect(),o=null,null==s||s.disconnect(),s=null}}(this.el,((e,t)=>{t?setTimeout((()=>{this.updateVideoPosition()}),300):this.updateVideoPosition(e)}),{wrapper:this.container})}stopObservePosition(){this.removePositionObserve&&(this.removePositionObserve(),this.removePositionObserve=null)}getCurrentPosition(e){return this.transformRectToPosition(Yw(e,this.container))}transformRectToPosition(e){const{left:t,width:n,height:r,bottom:i,top:o}=e,s=Qw(this.getCanvas());return{x:t*s,y:i*s,width:n*s,height:r*s,left:t*s,bottom:i*s,top:o*s}}playVideo(e){this.initObservePosition(),this.id=e;const t=this.getCurrentPosition(this.el);this.addRender(Object.assign(Object.assign(Object.assign({},t),{canvas:this.getCanvas(),zone:this.viewId,userId:Number(e),ssrc:Number(e)}),this.getRenderParams())),this.position=t}updateVideoPosition(e){if(!this.id)return;const t=this.transformRectToPosition(e||Yw(this.el,this.container));this.position&&$w(t,this.position)||(this.zoomRender(Object.assign(Object.assign(Object.assign({},t),{userId:Number(this.id),canvas:this.getCanvas(),RGBA:this.container.getRGBA(),zone:this.viewId}),this.getRenderParams())),this.position=t)}stopVideo(){this.stopObservePosition(),this.id&&this.position&&(this.id&&this.stopRender(Object.assign(Object.assign(Object.assign({},this.position),{userId:Number(this.id),canvas:this.getCanvas(),RGBA:this.container.getRGBA(),zone:this.viewId}),this.getRenderParams())),this.position=null,this.id="")}updateVideoQuality(e){this.getSDK().Notify_MeidaSDK(Dw.UPDATE_VIDEO_QUALITY,{userId:this.id,videoQuality:e})}destroy(){var e;this.stopVideo(),null===(e=this.removeSubscribe)||void 0===e||e.call(this)}}class eI{constructor(e){this.container=e,this.id="",this.getSDK=()=>{var e;return Hw(null===(e=this.container)||void 0===e?void 0:e.getSessionId())},this.el=document.createElement("video"),this.el.style.width="100%",this.el.style.height="100%",this.el.setAttribute("autoplay","true"),this.el.setAttribute("muted","true"),this.el.setAttribute("playsinline","true")}getElement(){return this.el}init(){}playVideo(e){this.id=e,this.addRender({userId:Number(e),videodom:this.el})}stopVideo(){this.id&&(this.stopRender({userId:Number(this.id),videodom:this.el}),this.id="")}updateVideoQuality(e){}destroy(){this.stopVideo()}}class tI extends Xw{addRender({width:e,height:t,x:n,y:r,canvas:i,zone:o,userId:s,left:a,bottom:u,top:c,fillMode:l,videoQuality:d}){var h;null===(h=this.getSDK())||void 0===h||h.Notify_MeidaSDK(Dw.ADD_RENDER_VIDEO,{width:e,height:t,x:n,y:r,canvas:i,zone:o,userId:s,left:a,bottom:u,top:c,fillMode:l,videoQuality:d})}zoomRender({width:e,height:t,x:n,y:r,userId:i,canvas:o,RGBA:s,zone:a,left:u,bottom:c,top:l}){var d;null===(d=this.getSDK())||void 0===d||d.Notify_MeidaSDK(Dw.ZOOM_RENDER,{width:e,height:t,x:n,y:r,userId:i,canvas:o,RGBA:s,zone:a,left:u,bottom:c,top:l})}stopRender({width:e,height:t,x:n,y:r,userId:i,canvas:o,doNotClean:s,RGBA:a,zone:u,left:c,bottom:l,top:d,videoQuality:h}){var p;null===(p=this.getSDK())||void 0===p||p.Notify_MeidaSDK(Dw.STOP_RENDER_VIDEO,{width:e,height:t,x:n,y:r,userId:i,canvas:o,doNotClean:s,RGBA:a,zone:u,left:c,bottom:l,top:d,videoQuality:h})}}class nI extends eI{addRender({userId:e,videodom:t}){var n;null===(n=this.getSDK())||void 0===n||n.Notify_MeidaSDK(Dw.ADD_RENDER_VIDEO,{userId:e,videodom:t})}stopRender({userId:e,videodom:t}){var n;null===(n=this.getSDK())||void 0===n||n.Notify_MeidaSDK(Dw.STOP_RENDER_VIDEO,{userId:e,videodom:t})}}class rI extends Xw{addRender({width:e,height:t,userId:n,canvas:r,isFromMainSession:i}){var o;null===(o=this.getSDK())||void 0===o||o.Notify_MeidaSDK(Dw.START_SHARING,{width:e,height:t,canvas:r,ssrc:n,isFromMainSession:i})}zoomRender(){}stopRender({canvas:e}){var t;null===(t=this.getSDK())||void 0===t||t.Notify_MeidaSDK(Dw.STOP_SHARING,{canvas:e})}}class iI extends eI{addRender({userId:e,videodom:t}){var n,r;null===(n=this.getSDK())||void 0===n||n.Notify_MeidaSDK(Dw.SWITCH_CANVAS_FOR_VIDEO_CAPTURE,[t]),null===(r=this.getSDK())||void 0===r||r.Notify_MeidaSDK(Dw.ADD_RENDER_VIDEO,{userId:e,videodom:t})}stopRender({userId:e,videodom:t}){var n;null===(n=this.getSDK())||void 0===n||n.Notify_MeidaSDK(Dw.STOP_RENDER_VIDEO,{userId:e,videodom:t})}}const oI="node-id",sI="media-type",aI="video-quality",uI="share-source",cI="fill-mode",lI="stop-no-clean";class dI extends HTMLElement{static get observedAttributes(){return[oI,sI,aI]}constructor(){super(),this.container=null,Bw(this,dI.customAttributes),this.getRenderParams=this.getParsedParams.bind(this),this.attachShadow({mode:"open"})}initRender(){var e,t,n;this.render&&this.render.destroy();const r=this.getAttribute(oI),i=r&&(null===(e=this.getCurrentMediaSDK())||void 0===e?void 0:e.isPreviewVideotag(r)),o=this.getAttribute(sI);let s=0;i?(this.render=new iI(this.getContainer()),s=1):o===Nw.Share?(this.render=new rI(this.getContainer(),this.getRenderParams),s=2):(null===(t=this.getCurrentMediaSDK())||void 0===t?void 0:t.getWebRTCFlag())?(this.render=new nI(this.getContainer()),s=4):(this.render=new tI(this.getContainer(),this.getRenderParams),s=3),this.getCurrentMediaSDK()&&Gw(this.getCurrentMediaSDK(),`VPREN:${s}`),this.shadowRoot&&(this.shadowRoot.innerHTML="",this.shadowRoot.appendChild(this.render.getElement())),this.render.init();const a=this.getAttribute(oI);Ww(a)||null===(n=this.render)||void 0===n||n.playVideo(a)}getContainer(){return this.container||(this.container=this.closest(`${Pw.get("tagName")}-container`)),this.container}getCurrentMediaSDK(){var e;return Hw(null===(e=this.getContainer())||void 0===e?void 0:e.getSessionId())}getParsedParams(){return{fillMode:Uw(this,cI),doNotClean:Uw(this,lI),isFromMainSession:"main"===this.getAttribute(uI),videoQuality:this.getAttribute(aI)}}connectedCallback(){this.style.display="block",jw(this,dI.defaultValues),this.initRender(),this.removeSubscribe=Pw.subscribe(((e,t,n)=>{var r,i;"failover"===e&&n===((null===(r=this.getContainer())||void 0===r?void 0:r.getSessionId())||xw)&&(this.initRender(),Ww(this.getAttribute(oI))||null===(i=this.render)||void 0===i||i.playVideo(this.getAttribute(oI)))}))}disconnectedCallback(){var e,t;null===(e=this.removeSubscribe)||void 0===e||e.call(this),null===(t=this.render)||void 0===t||t.destroy()}attributeChangedCallback(e,t,n){var r,i;if(this.render)switch(e){case oI:Boolean(null===(r=this.getCurrentMediaSDK())||void 0===r?void 0:r.isPreviewVideotag(n))!==this.render instanceof iI&&this.initRender(),Ww(t)&&!Ww(n)?this.render.playVideo(n):Ww(t)||Ww(n)?Ww(t)||this.render.stopVideo():(this.render.stopVideo(),this.render.playVideo(n));break;case sI:this.initRender();break;case aI:null===(i=this.render)||void 0===i||i.updateVideoQuality(n)}}}dI.customAttributes=[oI,sI,aI,uI,cI,lI],dI.defaultValues={[oI]:"",[sI]:Nw.Video};const hI="session-id",pI="z-index";class fI extends HTMLElement{static get observedAttributes(){return[hI,pI]}constructor(){super(),this.canvasId="video-player-canvas-"+qw(),this.needInitCanvas=!1,this.callback=null,Bw(this,fI.customAttributes);const e=this.attachShadow({mode:"open"}),t=document.createElement("slot");this.appendCanvas=n=>{e.insertBefore(n,t)},e.appendChild(t)}connectedCallback(){this.style.display="block",this.style.position||(this.style.position="relative"),jw(this,fI.defaultValues),this.needInitCanvas&&this.initCanvasEvents(),this.removeSubscribe=Pw.subscribe(((e,t,n)=>{"failover"===e&&n===(this.getSessionId()||xw)&&(this.replaceCanvas(),this.initCanvasEvents())}))}disconnectedCallback(){var e,t,n,r;null===(e=this.removeListener)||void 0===e||e.call(this),null===(t=this.removeSubscribe)||void 0===t||t.call(this),this.canvas&&(null===(n=Hw(this.getSessionId()))||void 0===n||n.Notify_MeidaSDK(Dw.REMOVE_EXPIRED_CANVAS,{canvasId:this.canvasId})),this.callback&&(null===(r=Hw(this.getSessionId()))||void 0===r||r.removeCallback(this.callback))}attributeChangedCallback(e,t,n){e===pI&&this.canvas&&n&&(this.canvas.style.zIndex=n)}adoptedCallback(){var e;this.canvas&&(null===(e=this.removeListener)||void 0===e||e.call(this),this.canvas.style.visibility="hidden",Vw(this.canvas,this,!0))}createCanvas(){this.getCurrentMediaSDK()&&Gw(this.getCurrentMediaSDK(),"VPCC"),this.canvas=Lw(this.clientWidth,this.clientHeight,this.getAttribute(pI)||"",this.canvasId,(e=>Gw(this.getCurrentMediaSDK(),e))),this.appendCanvas(this.canvas),this.isConnected?this.initCanvasEvents():this.needInitCanvas=!0}initCanvasEvents(){var e;this.removeListener=Vw(this.canvas,this),this.callback=(e,t)=>{var n,r;e===kw.WEBGL_LOST_IN_MULTI_VIEW&&t.replaceCanvas&&t.canvasId===(null===(n=this.canvas)||void 0===n?void 0:n.id)&&(this.replaceCanvas(),null===(r=Hw(this.getSessionId()))||void 0===r||r.Notify_MeidaSDK(Dw.WEBGL_LOST_REPLACE_CANVAS,{canvasId:this.canvasId,canvas:this.canvas}))},null===(e=this.getCurrentMediaSDK())||void 0===e||e.addCallback(this.callback)}replaceCanvas(){var e;if(this.getCurrentMediaSDK()&&Gw(this.getCurrentMediaSDK(),"VPRC"),this.canvas){null===(e=this.removeListener)||void 0===e||e.call(this);const t=Lw(this.clientWidth,this.clientHeight,this.getAttribute(pI)||"",this.canvasId,(e=>Gw(this.getCurrentMediaSDK(),e)));this.removeListener=Vw(t,this),this.shadowRoot&&this.shadowRoot.replaceChild(t,this.canvas),this.canvas=t}}getCanvas(){return this.canvas||this.createCanvas(),this.canvas}getSessionId(){return this.getAttribute(hI)||void 0}getCurrentMediaSDK(){return Hw(this.getSessionId())}getRGBA(){return function(e){let t=0,n=0,r=0,i=0;if("r"===e[0])if("a"===e[3]){const o=e.slice(5,-1).split(",").map((e=>parseInt(e.trim(),10)));t=o[0],n=o[1],r=o[2],i=o[3]}else{const i=e.slice(4,-1).split(",").map((e=>parseInt(e.trim(),10)));t=i[0],n=i[1],r=i[2]}else if("#"===e[0]){let i=e.slice(1);3===i.length&&(i=i.split("").map((e=>e.repeat(2))).join(""));const o=parseInt(i,16);t=o>>16&255,n=o>>8&255,r=255&o}return{R:t/255,G:n/255,B:r/255,A:i}}(getComputedStyle(this).getPropertyValue("background-color"))}}function gI(e){const{audio:{isBackgroundNoiseSuppression:t,originalSound:n,highBitrate:r}}=e,i={currentSelect:Au.Denoise},o={highfidelity:!1,stereo:!1};if(n){Object.assign(i,{currentSelect:Au.OriginalSound});const e={};"boolean"==typeof n?Object.assign(e,o):Object.assign(e,{highfidelity:!!n.hifi,stereo:!!n.stereo}),Object.assign(i,{originalSound:e})}return Object.assign(i,{backgroundNoiseSuppression:t?Cu.Zoom:Cu.Browser,highBitrate:r}),i}function mI(e,t,n,r){const{meeting:{userId:i},audio:{localShareAudioUserMutedList:o},share:{isReceiveSharingFromMainSession:s}}=r;return o.filter((e=>e.userId!==t)).forEach((t=>{e.setSharingAudioVolume(t.userId,!0,t.isFromMainSession)})),e.setSharingAudioVolume(t,n,!!s),t===i?Xh(n):Qh({userId:t,muted:n})}async function vI(e,t,n){var r,i;const{audio:{audioSsrc:o,activeMicrophone:s,activeSpeaker:a,isAllowToTalk:u,customizeAudioOption:{speakerOnly:c,mute:l,microphoneId:d,speakerId:h},isUsingMediaPlayback:p,mediaPlaybackFile:f,isHIDEnabled:g,microphoneDevicesList:m,isVerifiedAudioPermissionOnIOSMobile:v,speakerDevicesList:y},meeting:{svcUrl:S,conId:b,reportDomain:E,isAudioBridgeEnabled:w,userId:I,supportLocalAB:_,abToken:C}}=t,A=gh(t),T=!!c||eh(A.userRole)&&!u,R=null!=n?n:!T;Ho()&&(w||console.warn("Cannot start audio due to the service is not ready."),await Be(Hv(t,!R)).then((e=>{let[t,n]=e;return t&&n?Promise.resolve():Promise.reject()})));let O=s,P=a;if(void 0!==d||void 0!==h){let e=m,t=y;if(0===m.length){const{microphones:n,speakers:r}=await Be(Dv());e=n,t=r}d&&e.findIndex((e=>e.deviceId===d))>-1&&(O=d),h&&t.findIndex((e=>e.deviceId===h))>-1&&(P=h)}if(p&&null!=f&&f.url){const e=Gv.getInstance();await e.setAudioElement(f),O=e.audioElement}else Gv.getInstance().stopAudioElement();return T&&!v&&Uo.isIOSMobile&&await async function(){await navigator.mediaDevices.getUserMedia({audio:!0})}(),null===(r=e.joinComputerAudio(o,O,P,R,gI(t),Ho()?{rwgHost:S,cid:b,nginxHost:E,abToken:C,supportLocalAB:_,useWebRTCOnDesktop:!Uo.isAndroidOrIOSBrowser}:void 0,g?{microphoneLabel:null===(i=m.find((e=>e.deviceId===s)))||void 0===i?void 0:i.label,defaultMuted:!(null==A||!A.muted)}:void 0))||void 0===r?void 0:r.then((()=>{l&&(Ps.createAgent().mute(I,!0),e.muteAudio()),null!=A&&A.muted?e.muteAudio():e.unmuteAudio()}))}async function yI(e,t,n){const r=[],{audio:{isJoinComputerAudioBeforeSharingAudio:i,mutedBeforeSharingAudio:o}}=n,s=gh(n);return!0===i&&(await vI(e,n),r.push(Yh(void 0)),!1===o&&(r.push(gp(Ma.SharingAudio)),t.mute(s.userId,!1)),r.push(zh(void 0))),r}async function SI(e,t,n){const{audio:{isSharingAudio:r},meeting:{userId:i}}=n,o=[];if(o.push(mI(e,i,!0,n)),r){await e.leaveSharingAudio(!1),o.push(ep(!1));const r=await yI(e,t,n);o.push(...r),setTimeout((()=>{Id(Pc,{state:"off"})}),0)}return o.push(Zh(!1)),o}async function bI(e,t,n){const{audio:{audioSsrc:r,activeMicrophone:i,activeSpeaker:o},meeting:{svcUrl:s,conId:a,reportDomain:u,supportLocalAB:c,abToken:l}}=n,d=gh(n),h=[];if(!II()){const t=await async function(e,t){const n=[],r=gh(t),{audio:{isMicrophoneForbidden:i}}=t;return(null==r?void 0:r.audio)===yu.Computer&&(n.push(Yh(!0)),n.push(zh(r.muted)),r.muted||e.muteAudio(),await e.leaveComputerAudio(),n.push(Bh(0)),i&&n.push(Vh(!1))),n}(e,n);h.push(...t)}return await e.leaveSharingAudio(!0),await e.joinSharingAudio({ssrc:r,microphoneDeviceId:i,speakerDeviceId:o,isCaptureAudio:eh(d.userRole),audioBridge:Ho()?{rwgHost:s,cid:a,nginxHost:u,abToken:l,supportLocalAB:c,useWebRTCOnDesktop:!Uo.isAndroidOrIOSBrowser}:void 0}),h.push(Zh(!0)),h.push(ep(!0)),h.push(mI(e,d.userId,!1,n)),h.findIndex((e=>e.type===`${Yh}`&&!0===e.payload))>-1&&(h.push(fp(Na.SharingAudio)),t.mute(n.meeting.userId,!0)),setTimeout((()=>{Id(Pc,{state:"on"})}),0),h}fI.customAttributes=[],fI.defaultValues={};const EI=()=>{if(Wo())return!0;{var e;let{browser:n}=Uo;if(n=null===(e=n)||void 0===e?void 0:e.toLocaleLowerCase(),n.indexOf("safari")>-1&&-1===n.indexOf("ios-safari")){var t;const e=null===(t=navigator.userAgent.match(/version\/(\d+\.?\d+)/i))||void 0===t?void 0:t[1];return ci(e||"","15.2")>=0&&ci(e||"","17.1")<0}return!1}};function wI(e,t,n){for(let r=0;r<n.length&&0!==t.length;r++){const{userId:i,displayName:o}=n[r];if(t.includes(i)){const n=e.find((e=>e.userId===i));n&&(n.displayName=o,t.splice(t.indexOf(i),1))}}}function II(){return Ls.isSupportOpenMicWhenShareAudio()}function _I(e){return Ls.isSupportAudioDenoise(e)}function CI(){return Ls.isSupportStereoAudio()}function AI(){var e;return"function"==typeof(null===(e=window.navigator.hid)||void 0===e?void 0:e.requestDevice)}function TI(e,t,n){const{audio:{isAllowToTalk:r,customizeAudioOption:i},media:{audioDecodeStatus:o,audioEncodeStatus:s}}=e;return{encodeInitStatus:eh(t.userRole)&&!r||n||null!=i&&i.speakerOnly||Ho()?"success":s,decodeInitStatus:Ho()?"success":o}}function RI(e,t,n){Ho()?Hv(t,n).subscribe((t=>{let[n,r]=t;n&&r&&e.joinOrLeaveVoip(!0)})):e.joinOrLeaveVoip(!0)}const OI=Ps.createAgent(),PI=Lv(nb(Ls.getInstance())),DI=e=>!e.muted,kI=Ps.createAgent(),xI=Lv(nb(Ls.getInstance())),NI=Ps.createAgent(),MI=Lv(nb(Ls.getInstance())),FI={asnIds:{asn1:{userId:0,displayName:null},asn2:{userId:0,displayName:null},asn3:{userId:0,displayName:null}},microphoneDevicesList:[],speakerDevicesList:[],activeMicrophone:"default",activeSpeaker:"default",isMicrophoneForbidden:!1,audioSsrc:0,bCanUnmute:!1,bMutedUponEntry:!1,isAllowToTalk:void 0,dialout:[],crcDevice:[],canPlayAudio:!1,mutedSource:void 0,unmutedSource:void 0,isUserGrantCaptureAudio:!1,webrtcRestartCount:0,isComputerAudioLoading:!1,isUsingMediaPlayback:!1,customizeAudioOption:{},localShareAudioUserMutedList:[],locallyMutedAudioList:[],localUserAudioVolumeList:[],isStopAllImcomingAudio:!1,statistic:{encode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,bandwidth:0,bitrate:0},decode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,bandwidth:0,bitrate:0}}},LI=Rn({[`${Ph}`]:hE(((e,t)=>{let{payload:n}=t;e.asnIds={...n}})),[`${Dh}`]:hE(((e,t)=>{let{payload:n}=t;e.bCanUnmute=n})),[`${kh}`]:hE(((e,t)=>{let{payload:n}=t;const{sequence:r,phoneNumber:i}=n;-1===e.dialout.findIndex((e=>e.sequence===r))&&e.dialout.push({sequence:r,phoneNumber:i,returnCode:-1,uuid:Cy()})})),[`${xh}`]:hE(((e,t)=>{let{payload:n}=t;const{sequence:r,code:i,nodeId:o}=n,s=e.dialout.find((e=>e.sequence===r));s&&(s.returnCode=i,o&&(s.phoneNodeId=o))})),[`${Nh}`]:hE(((e,t)=>{let{payload:n}=t;e.isAllowToTalk=n,e.isAllowToTalkAttendeeConnected=!1})),[`${fp}`]:hE(((e,t)=>{let{payload:n}=t;e.mutedSource=n})),[`${gp}`]:hE(((e,t)=>{let{payload:n}=t;e.unmutedSource=n})),[`${Mh}`]:hE(((e,t)=>{let{payload:n}=t;e.audioSsrc=n})),[`${Fh}`]:hE(((e,t)=>{let{payload:n}=t;e.bMutedUponEntry=n})),[`${Lh}`]:hE(((e,t)=>{let{payload:n}=t;e.isUserGrantCaptureAudio=n})),[`${Vh}`]:hE(((e,t)=>{let{payload:n}=t;e.isMicrophoneForbidden=n})),[`${Bh}`]:hE(((e,t)=>{let{payload:n}=t;e.webrtcRestartCount=n})),[`${jh}`]:hE(((e,t)=>{let{payload:n}=t;e.microphoneDevicesList=n})),[`${Uh}`]:hE(((e,t)=>{let{payload:n}=t;e.speakerDevicesList=n})),[`${Hh}`]:hE(((e,t)=>{let{payload:n}=t;e.activeMicrophone=n})),[`${qh}`]:hE(((e,t)=>{let{payload:n}=t;e.activeSpeaker=n})),[`${Kh}`]:hE(((e,t)=>{let{payload:n}=t;e.canPlayAudio=n})),[`${Wh}`]:hE(((e,t)=>{let{payload:n}=t;e.isComputerAudioLoading=n})),[`${ap}`]:hE(((e,t)=>{let{payload:n}=t;if(n){const{speakerOnly:t,mute:r,backgroundNoiseSuppression:i,originalSound:o,syncButtonsOnHeadset:s,mediaFile:a,microphoneId:u,speakerId:c,highBitrate:l}=n;e.customizeAudioOption.speakerOnly=t,e.customizeAudioOption.mute=r,e.customizeAudioOption.microphoneId=u,e.customizeAudioOption.speakerId=c,e.isBackgroundNoiseSuppression=!!i,e.isHIDEnabled=!!s,e.originalSound=o,e.highBitrate=!!l,di(e.mediaPlaybackFile,a)||(e.mediaPlaybackFile=a,e.isUsingMediaPlayback=!(null==a||!a.url)),r&&(e.mutedSource=Na.Inherited)}})),[`${Gh}`]:hE(((e,t)=>{let{payload:n}=t;e.isAllowToTalkAttendeeConnected=n})),[`${zh}`]:hE(((e,t)=>{let{payload:n}=t;e.mutedBeforeSharingAudio=n})),[`${ep}`]:hE(((e,t)=>{let{payload:n}=t;e.isSharingAudio=n})),[`${Xh}`]:hE(((e,t)=>{let{payload:n}=t;e.isShareAudioMuted=n})),[`${Jh}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:r,isFromMainSession:i}=n;-1===e.localShareAudioUserMutedList.findIndex((e=>e.userId===r))&&e.localShareAudioUserMutedList.push({userId:r,isFromMainSession:i,muted:!1})})),[`${Qh}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.localShareAudioUserMutedList.find((e=>e.userId===n.userId));r&&(r.muted=n.muted)})),[`${Yh}`]:hE(((e,t)=>{let{payload:n}=t;e.isJoinComputerAudioBeforeSharingAudio=n})),[`${Zh}`]:hE(((e,t)=>{let{payload:n}=t;e.isShareAudioEnabled=n})),[`${tp}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:r,rate:i,...o}}=n;e.statistic.encode={bitrate:i,...o}})),[`${np}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:r,rate:i,...o}}=n;e.statistic.decode={bitrate:i,...o}})),[`${rp}`]:hE(((e,t)=>{let{payload:n}=t;-1===e.locallyMutedAudioList.findIndex((e=>e===n))&&e.locallyMutedAudioList.push(n)})),[`${ip}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.locallyMutedAudioList.findIndex((e=>e===n));-1!==r&&e.locallyMutedAudioList.splice(r,1)})),[`${op}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.localUserAudioVolumeList.find((e=>e.userId===n.userId));r?r.volume=n.volume:e.localUserAudioVolumeList.push(n)})),[`${sp}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.localUserAudioVolumeList.findIndex((e=>e.userId===n.userId));-1!==r&&e.localUserAudioVolumeList.splice(r,1)})),[`${up}`]:hE(((e,t)=>{let{payload:n}=t;e.isBackgroundNoiseSuppression=n})),[`${cp}`]:hE(((e,t)=>{let{payload:n}=t;e.isHIDEnabled=n})),[`${lp}`]:hE(((e,t)=>{let{payload:n}=t;e.mediaPlaybackFile=n,e.isUsingMediaPlayback=!(null==n||!n.url)})),[`${dp}`]:hE(((e,t)=>{let{payload:n}=t;e.isStopAllImcomingAudio=n})),[`${hp}`]:hE(((e,t)=>{let{payload:n}=t;e.isVerifiedAudioPermissionOnIOSMobile=n})),[`${pp}`]:hE(((e,t)=>{let{payload:n}=t;e.isAudioBridgeSignalReconnecting=n})),[`${mp}`]:hE(((e,t)=>{let{payload:n}=t;e.originalSound=n})),[`${vp}`]:hE(((e,t)=>{let{payload:n}=t;e.leaveAudioSource=n})),[`${yp}`]:hE(((e,t)=>{let{payload:n}=t;e.secondaryAudioMicrophoneId=n})),[`${Sp}`]:hE(((e,t)=>{let{payload:n}=t;const{sequence:r,ip:i,protocol:o}=n;-1===e.crcDevice.findIndex((e=>e.sequence===r))&&e.crcDevice.push({sequence:r,ip:i,protocol:o,transId:0,uuid:Cy()})})),[`${bp}`]:hE(((e,t)=>{let{payload:n}=t;const{sequence:r,transID:i,result:o}=n,s=e.crcDevice.find((e=>e.sequence===r));s&&Object.assign(s,{transId:i,returnCode:o})})),[`${$h}`]:(e,t)=>{let{dialout:n,crcDevice:r,locallyMutedAudioList:i,localUserAudioVolumeList:o,customizeAudioOption:s,originalSound:a,highBitrate:u,isHIDEnabled:c,isBackgroundNoiseSuppression:l,isStopAllImcomingAudio:d,mediaPlaybackFile:h,isUsingMediaPlayback:p,isVerifiedAudioPermissionOnIOSMobile:f,activeSpeaker:g,activeMicrophone:m}=e,{payload:v}=t;return v?{...FI,dialout:n,crcDevice:r,locallyMutedAudioList:i,localUserAudioVolumeList:o,customizeAudioOption:{...FI.customizeAudioOption,speakerOnly:s.speakerOnly},originalSound:a,highBitrate:u,isHIDEnabled:c,isBackgroundNoiseSuppression:l,isStopAllImcomingAudio:d,mediaPlaybackFile:h,isUsingMediaPlayback:p,isVerifiedAudioPermissionOnIOSMobile:f,activeSpeaker:g,activeMicrophone:m}:{...FI}}},FI),VI={dialEpics0:(e,t)=>pr(e,8198).pipe(Tt(t),ht((e=>{let[t,n]=e;return n.audio.dialout.map((e=>e.sequence)).includes(t.payload.seq)})),Ye((e=>{let[t,n]=e;const{payload:{seq:r,body:{phoneNodeID:i,result:o}}}=t,s=[xh({code:o,sequence:r,nodeId:i})],{audio:{dialout:a}}=n,u=a.find((e=>e.sequence===r)),c={code:o};if(u&&(Object.assign(c,{phoneNumber:u.phoneNumber,uuid:u.uuid}),i&&Object.assign(c,{userId:i})),Id(Sc,c),o===Va.Success){if(Id(bc),i&&bh(n).findIndex((e=>e.userId===i))>-1){var l;const e=null===(l=n.audio.dialout.find((e=>e.sequence===r)))||void 0===l?void 0:l.phoneNumber;e&&(s.push(Bd({userId:i,key:"phoneNumber",value:e})),Id(Us,[{userId:i,phoneNumber:e}]))}}else[Va.Canceling,Va.Canceled,Va.CancelFailed].includes(o)?o===Va.Canceled?Id(wc):o===Va.CancelFailed&&Id(Ic):-1===[Va.Calling,Va.Ringing,Va.Accepted,Va.Success].indexOf(o)&&Id(Ec);return Me(s)}))),dialEpics1:(e,t)=>pr(e,4120).pipe(Tt(t),ht((e=>{let[t,n]=e;return n.audio.crcDevice.map((e=>e.sequence)).includes(t.payload.seq)})),Ye((e=>{let[t,n]=e;const{payload:{seq:r,body:{result:i,transID:o}}}=t,{audio:{crcDevice:s}}=n,a=[],u=s.find((e=>e.sequence===r));return u&&(Id(Mc,{code:i,ip:u.ip,protocol:u.protocol,uuid:u.uuid}),a.push(bp({sequence:r,transID:o,result:i}))),i===Ou.Success?Id(Fc):[Ou.Success,Ou.Ringing].includes(i)||Id(Lc),Me(a)})))},BI={epics0:(e,t)=>pr(e,12033).pipe(Tt(t),Ke((e=>{let[t,n]=e;const{participants:{allowTalkAttendeesList:r}}=n,i=t.payload.body;let o={};if(i){const e=bh(n),t=Object.keys(i).map((e=>({key:e,userId:i[e]}))),s=t.map((e=>e.userId));wI(t,s,e),r.length>0&&s.length>0&&wI(t,s,r),o=t.reduce(((e,t)=>({...e,[`${t.key}`]:{userId:t.userId,displayName:t.displayName}})),{}),Id(dc,Object.values(o))}return Ph(o)}))),epics1:(e,t)=>pr(e,16135).pipe(Tt(t),At((e=>{let[t,n]=e;const{payload:{body:{id:r,bLeadershipOn:i}}}=t,{audio:{bCanUnmute:o}}=n,s=gh(n);if(s){const{isHost:e,bCoHost:t,userId:n,audio:a,muted:u}=s,c=e||t;i&&hi(n,r)&&(null!==a&&""!==a&&!0!==u||!c&&!o||Id(hc,xa.Spotlight))}})),St(ge)),epics2:(e,t)=>pr(e,12037).pipe(Tt(t),At((e=>{let[,t]=e;const n=gh(t);null!==(null==n?void 0:n.audio)&&""!==(null==n?void 0:n.audio)&&1==(null==n?void 0:n.muted)&&Id(hc,xa.Unmute)})),St(ge)),epics3:(e,t)=>pr(e,is).pipe(ht((e=>e.payload.body&&["bCanUnmute","bMutedAll","bMutedUponEntry"].some((t=>void 0!==e.payload.body[t])))),Ye((e=>{const{payload:{body:{bCanUnmute:n,bMutedAll:r,bMutedUponEntry:i}}}=e,o=[];if(void 0!==n&&o.push(Dh(e.payload.body.bCanUnmute)),void 0!==r){const n=gh(t.value);(null==n?void 0:n.audio)!==yu.Computer&&(null==n?void 0:n.audio)!==yu.Phone||0!=n.muted||e.payload.body.bMutedAll&&o.push(fp(Na.PassiveByMuteAll))}return void 0!==i&&o.push(Fh(e.payload.body.bMutedUponEntry)),Me(o)}))),epics4:(e,t)=>pr(e,rs).pipe(Tt(t),ht((e=>{let[,t]=e;return t.socket.zoomSocketStatus===Th.Connected})),Ye((e=>{let[n,r]=e;const{payload:{body:{update:i}}}=n;if(null!=i&&i.some((e=>void 0!==e.audio||void 0!==e.muted))){const{meeting:{userId:e}}=r,n=i.filter((t=>t.id!==e)),o=i.filter((t=>t.id===e));if(n&&n.forEach((e=>{Id(yc,e)})),o.length>0)return Ov(t).pipe(Ye((e=>{const{audio:{mutedSource:n,unmutedSource:r,isAllowToTalk:i,isShareAudioEnabled:s,isSharingAudio:a,isAudioBridgeSignalReconnecting:u,leaveAudioSource:c,customizeAudioOption:{speakerOnly:l}}}=t.value,d=e;return Me(o).pipe(ey((async e=>{const t=[];if(e.audio!==d.audio)if(""===e.audio)Id(gc,{source:c}),t.push(vp(void 0));else if(e.audio===yu.Computer){const e=eh(d.userRole)&&!i||!!l;a&&Id(pc),e&&(Id(pc),Uo.isIOSMobile&&t.push(hp(!0))),u&&(Id(pc),t.push(pp(!1)))}else e.audio===yu.Phone&&(d.audio===yu.Computer&&(await PI.leaveComputerAudio(),t.push(vp(Fa.Pstn)),OI.joinOrLeaveVoip(!1)),Id(fc));if(""!==d.audio&&e.muted!==d.muted){if(e.muted!==d.muted)if(!0===e.muted){if(n!==Na.Inherited){const e=null!=n?n:Na.PassiveByMuteOne;Id(mc,{source:e})}d.audio!==yu.Computer||s&&!II()||PI.muteAudio()}else if(!1===e.muted){if(r!==Ma.Inherited){const e=null!=r?r:Ma.Passive;Id(vc,{source:e})}d.audio===yu.Computer&&PI.unmuteAudio()}void 0!==e.muted&&t.push(fp(void 0),gp(void 0))}return t})))})))}return ge}))),epics5:(e,t)=>pr(e,12036).pipe(Tt(t),Ye((e=>{let[t,n]=e;const r=gh(n),{media:{audioEncodeStatus:i}}=n,{promoterID:o,bAllowTalk:s}=t.payload.body;if((null==r?void 0:r.userId)===o){if(Id(Oc,s),s)return"success"!==i&&PI.enableAudioEncode(),Rv("audio",i,"success").pipe(Ye((e=>(e&&Id(hc,xa.AllowToTalk),ge))),wt(Nh(!0)));if(OI.mute(o,!0),(null==r?void 0:r.audio)===yu.Computer)return PI.leaveComputerAudio(),at(300).pipe(At((async()=>{(EI()?Be(pt(it(document,"click").pipe(gt(1)),it(document,"touchend").pipe(gt(1)))):Promise.resolve(!0)).then((()=>{vI(PI,n,!1)}))})),St(ge),wt(Nh(!1),fp(Na.Inherited)))}return ge}))),epics6:e=>pr(e,8205).pipe(At((e=>{Id("AUDIO_ALLOW_TO_TALK_RESPONSE",e.payload.body)})),St(ge)),epics7:(e,t)=>gr(e,24597).pipe(Tt(t),At((e=>{let[t,n]=e;const r=gh(n);(null==r?void 0:r.audio)===yu.Phone?OI.audioDrop(r.userId):(null==r?void 0:r.audio)===yu.Computer&&t.payload.body.bPromote})),St(ge)),epics8:(e,t)=>pr(e,12035).pipe(Tt(t),It((e=>{let[n,r]=e;const{meeting:{currentUserAudioBeforeReset:i}}=r,{payload:{body:{ssrc:o}}}=n,s=Ov(t).pipe(Ye((e=>{if(i===yu.Computer&&(null==e||!e.audio)){const{encodeInitStatus:n,decodeInitStatus:r}=TI(t.value,e);return Rv("audio",n,r).pipe(ht((e=>{let[t,n]=e;return t&&n})),At((()=>{(EI()?Be(pt(it(document,"click").pipe(gt(1)),it(document,"touchend").pipe(gt(1)))):Promise.resolve(!0)).then((()=>{RI(OI,t.value),vI(PI,t.value)}));const{audio:{locallyMutedAudioList:e,localUserAudioVolumeList:n,isStopAllImcomingAudio:r}}=t.value;e.length>0&&e.forEach((e=>{PI.muteOrUnmuteOtherAudio(e,!0)})),n.length>0&&n.forEach((e=>{PI.adjustOtherAudioVolume(e.userId,e.volume)})),r&&PI.stopAllIncomingAudio(!0)})),mt(to(void 0)))}return ge})));return Id(kc,o),ct(Fe(Mh(o)),s)}))),epics9:(e,t)=>pr(e,7952).pipe(It((e=>Ad(fc,1).pipe(Tt(t),At((t=>{let[,n]=t;const{BindStatus:r,nOperatorUserId:i}=e.payload.body,o=n.participants.attendeesList.find((e=>e.userId===i));!0===r&&Id(_c,{operatorName:null==o?void 0:o.displayName,operatorUserId:i,operatorRole:null==o?void 0:o.userRole})})),St(ge))))),epics10:(e,t)=>vr(e,Da.UserGrantCaptureAudio).pipe(Tt(t),Ye((e=>{let[t,n]=e;const r=gh(n);var i;(i=r,(null==i?void 0:i.audio)===yu.Computer?Promise.resolve():Cd({event:Bs,operations:[ht((e=>void 0!==e.audio&&""!==e.audio)),gt(1)]},(e=>{let{audio:t}=e;return t===yu.Phone||t===yu.Computer}))).then((()=>{Id(pc)}));const{meeting:{isCurrentUserMutedBeforeReset:o},audio:{bMutedUponEntry:s,isUserGrantCaptureAudio:a,isAllowToTalk:u,activeMicrophone:c}}=n,{payload:{data:l}}=t,d=[Lh(!0)];if(r){!0===r.muted&&!1===u&&(d.push(fp(Na.Inherited)),OI.mute(r.userId,!0));const e=a||r.isHost||u;(!0===o||!e&&s)&&(d.push(fp(Na.Inherited)),OI.mute(r.userId,!0),o&&d.push(no(void 0))),l&&c!==l&&d.push(Hh(l))}return Me(d)}))),epics11:e=>vr(e,Da.UserForbiddedCaptureAudio).pipe(At((()=>{Id(Cc)})),mt(Vh(!0))),epics12:e=>vr(e,Da.AudioWebsocketBroken).pipe(At((()=>{Id(Ac)})),St(ge)),epics13:(e,t)=>vr(e,Da.AudioZeroData).pipe(Tt(t),Zv((e=>{let[,t]=e;const{audio:{webrtcRestartCount:n,activeMicrophone:r}}=t;if(n<3)return PI.restoreWebRTC(r),Bh(n+1)}))),epics14:(e,t)=>e.pipe(Ut(`${Kh}`),ht((e=>!1===e.payload)),Ye((()=>(Id(Tc),pt(it(document,"click").pipe(gt(1)),it(document,"touchend").pipe(gt(1))).pipe(At((()=>{RI(OI,t.value),vI(PI,t.value)})),mt(Kh(!0))))))),epics15:e=>vr(e,[Da.JoinComputerAudioComplete,Da.JoinSharingAudioComplete,Da.LeaveComputerAudioComplete,Da.LeaveSharingAudioComplete]).pipe(At((()=>{Fv.completeAudioAction()})),St(ge)),epics16:(e,t)=>vr(e,Da.AudioQosData).pipe(Tt(t),Ke((e=>{var t;let[n,r]=e;const{meeting:{isWebinar:i},media:{audioEncodeStatus:o,audioDecodeStatus:s},participants:{xmppAttendeeList:a,allowTalkAttendeesList:u}}=r,c=gh(r),l=_h(r);let d=l.length>0,h=l.some(DI);const p=Ho();i&&(d=d||Boolean(a.length),h=h||u.some(DI));const f=((null==c?void 0:c.audio)===yu.Computer||(null==c?void 0:c.audio)===yu.Phone)&&("success"===o||p)&&!(null!=c&&c.muted)&&d,g=((null==c?void 0:c.audio)===yu.Computer||(null==c?void 0:c.audio)===yu.Phone)&&("success"===s||p)&&d&&h;return null!==(t=n.payload.data)&&void 0!==t&&t.encoding?f?(Id(Dc,n.payload),tp(n.payload)):tp(cu):g?(Id(Dc,n.payload),np(n.payload)):np(cu)}))),epics17:(e,t)=>pr(e,rs).pipe(Tt(t),ht((e=>{let[t,n]=e;const{payload:{body:r}}=t,{audio:{locallyMutedAudioList:i,localUserAudioVolumeList:o}}=n;return(i.length>0||o.length>0)&&(null==r?void 0:r.remove)&&r.remove.length>0})),Ye((e=>{let[t,n]=e;const{payload:{body:{remove:r}}}=t,{audio:{locallyMutedAudioList:i,localUserAudioVolumeList:o}}=n,s=i.concat(o.map((e=>e.userId))).filter((e=>-1!==r.indexOf((t=>t.id===e))));return s.length>0?(s.forEach((e=>{PI.muteOrUnmuteOtherAudio(e,!1)})),Me(s.map((e=>[ip(e),sp({userId:e})])).flat())):ge}))),epics18:(e,t)=>vr(e,Da.HidStatusMute).pipe(Ye((e=>{const{payload:{data:n}}=e,r=t.value,{meeting:{userId:i},audio:{isShareAudioEnabled:o,bCanUnmute:s}}=r,a=[];if(n)o&&!II()&&a.push(zh(!0)),a.push(fp(Na.Active)),OI.mute(i,!0);else if(!o||II()){o&&a.push(zh(!1));const e=gh(r);(s||null!=e&&e.isHost||null!=e&&e.bCoHost)&&(a.push(gp(Ma.Active)),OI.mute(i,!1))}return Me(a)}))),epics19:e=>pr(e,12040).pipe(At((e=>{const{payload:{body:{mode:t}}}=e;PI.setAudioCodecMode(t)})),St(ge)),epics20:(e,t)=>vr(e,[Da.AudioSpeakerSetSuccess,Da.JoinComputerAudioComplete,Da.AudioSpeakerSetError]).pipe(Ye((e=>{const{payload:{data:n,type:r}}=e,{audio:{activeSpeaker:i,activeMicrophone:o}}=t.value,s=[];return r===Da.AudioSpeakerSetSuccess&&i!==n?s.push(qh(n)):r===Da.JoinComputerAudioComplete&&null!==n&&o!==n&&s.push(Hh(n)),r===Da.AudioSpeakerSetSuccess?Id(xc,!0):r===Da.AudioSpeakerSetError&&Id(xc,!1),Me(s)}))),epics21:(e,t)=>vr(e,Da.AudioLevelIndicator).pipe(ht((()=>{const e=gh(t.value);return!!e&&e.audio===yu.Computer&&!e.muted})),At((e=>{const{payload:{data:t}}=e;Id(Vc,{level:t.value})})),Ye((()=>ge)))},jI=hr(BI,{shareAudioEpics0:(e,t)=>mr(e,rs).pipe(ht((e=>{const t=e.payload.body.update;return t&&t.length>0&&t.findIndex((e=>void 0!==e.bShareOn))>-1})),Tt(t),Ye((e=>{let[t,n]=e;const{payload:{body:{update:r}}}=t,{audio:{localShareAudioUserMutedList:i}}=n,o=r.filter((e=>!0===e.bShareOn&&!0===e.bShareAudioOn)),s=[];return o.length>0&&o.forEach((e=>{-1===i.findIndex((t=>t.userId===e.id))&&s.push(Jh({userId:e.id,isFromMainSession:!!e.bShareToBORooms}))})),Me(s)}))),shareAudioEpics1:(e,t)=>vr(e,Da.SharingDesktopStreamHaveAudio).pipe(ht((()=>!t.value.audio.secondaryAudioMicrophoneId)),It((()=>pr(e,rs).pipe(ht((e=>{var n;const{payload:{body:r}}=e,{meeting:{userId:i}}=t.value;return(null==r||null===(n=r.update)||void 0===n?void 0:n.findIndex((e=>e.id===i&&!0===e.bShareOn)))>-1})),gt(1),ey((async()=>{const e=t.value;return await bI(xI,kI,e)})),wt(Zh(!0)))))),shareAudioEpics2:(e,t)=>vr(e,Da.SharingDesktopStreamHaveNoAudio).pipe(Tt(t),ht((e=>{var t;let[,n]=e;return!0===(null===(t=n.audio)||void 0===t?void 0:t.isShareAudioEnabled)})),ey((async e=>{let[,t]=e;return await SI(xI,kI,t)}))),shareAudioEpics3:(e,t)=>pr(e,rs).pipe(Tt(t),ht((e=>{let[,t]=e;return t.socket.zoomSocketStatus===Th.Connected&&!0===t.audio.isSharingAudio})),Ye((e=>{var n;let[r,i]=e;if(null!==(n=r.payload.body.update)&&void 0!==n&&n.some((e=>void 0!==e.audio||void 0!==e.muted))){const{meeting:{userId:e}}=i,n=r.payload.body.update.filter((t=>t.id===e));return Ov(t).pipe(Ye((e=>{const t=[];return n.findIndex((e=>e.audio===yu.Computer))>-1&&(null==e?void 0:e.audio)!==yu.Computer&&!II()&&(t.push(Yh(!0)),t.push(zh(!0))),Me(t)})))}return ge}))),shareAudioEpics4:(e,t)=>e.pipe(Ut(`${Tp}`),ke(de),Tt(t),ht((e=>{var t;let[,n]=e;return!0===(null===(t=n.audio)||void 0===t?void 0:t.isShareAudioEnabled)})),ey((async e=>{let[t,n]=e;const{payload:r}=t,{audio:{isShareAudioMuted:i,isSharingAudio:o}}=n,s=[];if(r===qa.End){const e=await SI(xI,kI,n);s.push(...e)}else if(r===qa.Paused){if(!1===i&&!0===o){await xI.leaveSharingAudio(!0),s.push(ep(!1));const e=await yI(xI,kI,n);s.push(...e),setTimeout((()=>{Id(Pc,{state:"off"})}),0)}}else if(r===qa.Sharing&&!1===i&&!1===o){const e=await bI(xI,kI,n);s.push(...e)}return s}))),shareAudioEpics5:(e,t)=>vr(e,Da.SharingDesktopStreamHaveAudio).pipe(ht((()=>!!t.value.audio.secondaryAudioMicrophoneId)),At((()=>{const{audio:{audioSsrc:e,secondaryAudioMicrophoneId:n},meeting:{svcUrl:r,conId:i,reportDomain:o,supportLocalAB:s,abToken:a}}=t.value;xI.joinSharingAudio({ssrc:e,microphoneDeviceId:n,speakerDeviceId:null,isCaptureAudio:!0,audioBridge:Ho()?{rwgHost:r,cid:i,nginxHost:o,abToken:a,supportLocalAB:s,useWebRTCOnDesktop:!Uo.isAndroidOrIOSBrowser}:void 0}),Id(Nc)})),Ye((()=>ge)))},{audioBridgEpics0:e=>pr(e,4299).pipe(At((e=>{const{payload:t}=e;MI.passThroughRWGMessage(t)})),St(ge)),audioBridgEpics1:e=>vr(e,Da.AudioBridgeReconnectStart).pipe(Ye((()=>(NI.joinOrLeaveVoip(!1),Me([pp(!0),vp(Fa.Failover)]))))),audioBridgEpics2:(e,t)=>vr(e,Da.AudioBridgeReconnectEnd).pipe(At((()=>{RI(NI,t.value)})),St(ge)),audioBridgEpics3:e=>pr(e,rs).pipe(ht((e=>{var t,n;return Ho()&&((null===(t=e.payload.body.update)||void 0===t?void 0:t.some((e=>void 0!==e.muted)))||(null===(n=e.payload.body.remove)||void 0===n?void 0:n.length)>0)})),At((e=>{const{payload:{body:{update:t,remove:n}}}=e;MI.sendUserAudioStatus({update:(t||[]).filter((e=>void 0!==e.muted)).map((e=>({userId:e.id,muted:e.muted}))),remove:(n||[]).map((e=>({userId:e.id})))})})),St(ge)),audioBridgEpics4:(e,t)=>vr(e,Da.NotifyUIFailover).pipe(ht((()=>!t.value.meeting.isMeetingReset&&t.value.meeting.meetingStatus===Co.Joined)),Ke((()=>(Id(Gs,{reason:Eo.Failover}),Ni(To.NotifyUiFailover))))),audioBridgEpics5:(e,t)=>yr(e,t).pipe(ht((()=>{const{meeting:{isAudioBridgeEnabled:e,abToken:n}}=t.value;return e&&Ho()&&!!n})),At((()=>{const{meeting:{abToken:e,svcUrl:n,reportDomain:r,conId:i,supportLocalAB:o}}=t.value;MI.preInitAudioBridge({abToken:e,rwgHost:n,cid:i,nginxHost:r,supportLocalAB:o,useWebRTCOnDesktop:!Uo.isAndroidOrIOSBrowser})})),St(ge)),audioBridgEpics6:(e,t)=>pr(e,16129).pipe(ht((e=>{const{payload:{body:{bVideoOn:n}}}=e,{meeting:{isAudioBridgeEnabled:r}}=t.value;return r&&Ho()&&!!n})),At((e=>{const{payload:{body:{id:t}}}=e;MI.changeActiveVideoSsrc(t)})),St(ge)),audioBridgEpics7:(e,t)=>vr(e,[Da.RecoverWebrtcAudio,Da.AudioStreamFailed]).pipe(Ye((()=>{const e=gh(t.value),n=[];return(null==e?void 0:e.audio)===yu.Computer&&(MI.leaveComputerAudio(),EI()?(NI.joinOrLeaveVoip(!1),n.push(vp(Fa.EndedBySystem)),n.push(Bh(0))):vI(MI,t.value)),Me(n)}))),audioBridgEpics8:e=>vr(e,[Da.AudioBridgeFirstRecvData,Da.AudioBridgeCanSendData]).pipe(Ke((e=>{const{payload:{type:t}}=e;return t===Da.AudioBridgeFirstRecvData?(Id(Vl),or(!0)):(Id(Bl),sr(!0))}))),audioBridgEpics9:(e,t)=>e.pipe(Ut(`${Bi}`),ht((()=>!!t.value.meeting.zlkJwtToken)),At((()=>{const{meeting:{zlkJwtToken:e}}=t.value;if(e){const{enforce_web_rtc_audio:t,audio_compatible_mode:n}=mi(e);void 0===t&&void 0===n||Do.set(No.EnforceWebRTCAudio,1===Number(t)||1===Number(n),Oo.Memory)}})),St(ge))},VI);var UI="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,HI="object"==typeof self&&self&&self.Object===Object&&self,qI=UI||HI||Function("return this")(),KI=qI.Symbol,$I=Object.prototype,WI=$I.hasOwnProperty,GI=$I.toString,zI=KI?KI.toStringTag:void 0,JI=Object.prototype.toString,QI="[object Null]",YI="[object Undefined]",ZI=KI?KI.toStringTag:void 0;function XI(e){return null==e?void 0===e?YI:QI:ZI&&ZI in Object(e)?function(e){var t=WI.call(e,zI),n=e[zI];try{e[zI]=void 0;var r=!0}catch(e){}var i=GI.call(e);return r&&(t?e[zI]=n:delete e[zI]),i}(e):function(e){return JI.call(e)}(e)}function e_(e){return null!=e&&"object"==typeof e}var t_=Array.isArray;function n_(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var r_="[object AsyncFunction]",i_="[object Function]",o_="[object GeneratorFunction]",s_="[object Proxy]";function a_(e){if(!n_(e))return!1;var t=XI(e);return t==i_||t==o_||t==r_||t==s_}var u_,c_=qI["__core-js_shared__"],l_=(u_=/[^.]+$/.exec(c_&&c_.keys&&c_.keys.IE_PROTO||""))?"Symbol(src)_1."+u_:"",d_=Function.prototype.toString;function h_(e){if(null!=e){try{return d_.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var p_=/^\[object .+?Constructor\]$/,f_=Function.prototype,g_=Object.prototype,m_=f_.toString,v_=g_.hasOwnProperty,y_=RegExp("^"+m_.call(v_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function S_(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!n_(e)||(t=e,l_&&l_ in t))&&(a_(e)?y_:p_).test(h_(e));var t}(n)?n:void 0}var b_=S_(qI,"WeakMap"),E_=9007199254740991,w_=/^(?:0|[1-9]\d*)$/;function I_(e,t){var n=typeof e;return!!(t=null==t?E_:t)&&("number"==n||"symbol"!=n&&w_.test(e))&&e>-1&&e%1==0&&e<t}function __(e,t){return e===t||e!=e&&t!=t}var C_=9007199254740991;function A_(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=C_}function T_(e){return null!=e&&A_(e.length)&&!a_(e)}var R_=Object.prototype;function O_(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||R_)}function P_(e){return e_(e)&&"[object Arguments]"==XI(e)}var D_=Object.prototype,k_=D_.hasOwnProperty,x_=D_.propertyIsEnumerable,N_=P_(function(){return arguments}())?P_:function(e){return e_(e)&&k_.call(e,"callee")&&!x_.call(e,"callee")},M_="object"==typeof t&&t&&!t.nodeType&&t,F_=M_&&e&&!e.nodeType&&e,L_=F_&&F_.exports===M_?qI.Buffer:void 0,V_=(L_?L_.isBuffer:void 0)||function(){return!1},B_={};B_["[object Float32Array]"]=B_["[object Float64Array]"]=B_["[object Int8Array]"]=B_["[object Int16Array]"]=B_["[object Int32Array]"]=B_["[object Uint8Array]"]=B_["[object Uint8ClampedArray]"]=B_["[object Uint16Array]"]=B_["[object Uint32Array]"]=!0,B_["[object Arguments]"]=B_["[object Array]"]=B_["[object ArrayBuffer]"]=B_["[object Boolean]"]=B_["[object DataView]"]=B_["[object Date]"]=B_["[object Error]"]=B_["[object Function]"]=B_["[object Map]"]=B_["[object Number]"]=B_["[object Object]"]=B_["[object RegExp]"]=B_["[object Set]"]=B_["[object String]"]=B_["[object WeakMap]"]=!1;var j_,U_="object"==typeof t&&t&&!t.nodeType&&t,H_=U_&&e&&!e.nodeType&&e,q_=H_&&H_.exports===U_&&UI.process,K_=function(){try{return H_&&H_.require&&H_.require("util").types||q_&&q_.binding&&q_.binding("util")}catch(e){}}(),$_=K_&&K_.isTypedArray,W_=$_?(j_=$_,function(e){return j_(e)}):function(e){return e_(e)&&A_(e.length)&&!!B_[XI(e)]},G_=Object.prototype.hasOwnProperty,z_=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),J_=Object.prototype.hasOwnProperty;function Q_(e){if(!O_(e))return z_(e);var t=[];for(var n in Object(e))J_.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Y_(e){return T_(e)?function(e,t){var n=t_(e),r=!n&&N_(e),i=!n&&!r&&V_(e),o=!n&&!r&&!i&&W_(e),s=n||r||i||o,a=s?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=a.length;for(var c in e)!G_.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||I_(c,u))||a.push(c);return a}(e):Q_(e)}var Z_=S_(Object,"create"),X_=Object.prototype.hasOwnProperty,eC=Object.prototype.hasOwnProperty;function tC(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function nC(e,t){for(var n=e.length;n--;)if(__(e[n][0],t))return n;return-1}tC.prototype.clear=function(){this.__data__=Z_?Z_(null):{},this.size=0},tC.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},tC.prototype.get=function(e){var t=this.__data__;if(Z_){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return X_.call(t,e)?t[e]:void 0},tC.prototype.has=function(e){var t=this.__data__;return Z_?void 0!==t[e]:eC.call(t,e)},tC.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Z_&&void 0===t?"__lodash_hash_undefined__":t,this};var rC=Array.prototype.splice;function iC(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}iC.prototype.clear=function(){this.__data__=[],this.size=0},iC.prototype.delete=function(e){var t=this.__data__,n=nC(t,e);return!(n<0||(n==t.length-1?t.pop():rC.call(t,n,1),--this.size,0))},iC.prototype.get=function(e){var t=this.__data__,n=nC(t,e);return n<0?void 0:t[n][1]},iC.prototype.has=function(e){return nC(this.__data__,e)>-1},iC.prototype.set=function(e,t){var n=this.__data__,r=nC(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var oC=S_(qI,"Map");function sC(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function aC(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function uC(e){var t=this.__data__=new iC(e);this.size=t.size}aC.prototype.clear=function(){this.size=0,this.__data__={hash:new tC,map:new(oC||iC),string:new tC}},aC.prototype.delete=function(e){var t=sC(this,e).delete(e);return this.size-=t?1:0,t},aC.prototype.get=function(e){return sC(this,e).get(e)},aC.prototype.has=function(e){return sC(this,e).has(e)},aC.prototype.set=function(e,t){var n=sC(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},uC.prototype.clear=function(){this.__data__=new iC,this.size=0},uC.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},uC.prototype.get=function(e){return this.__data__.get(e)},uC.prototype.has=function(e){return this.__data__.has(e)},uC.prototype.set=function(e,t){var n=this.__data__;if(n instanceof iC){var r=n.__data__;if(!oC||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new aC(r)}return n.set(e,t),this.size=n.size,this};var cC=Object.prototype.propertyIsEnumerable,lC=Object.getOwnPropertySymbols,dC=lC?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s)&&(o[i++]=s)}return o}(lC(e),(function(t){return cC.call(e,t)})))}:function(){return[]};function hC(e){return function(e,t,n){var r=t(e);return t_(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,Y_,dC)}var pC=S_(qI,"DataView"),fC=S_(qI,"Promise"),gC=S_(qI,"Set"),mC="[object Map]",vC="[object Promise]",yC="[object Set]",SC="[object WeakMap]",bC="[object DataView]",EC=h_(pC),wC=h_(oC),IC=h_(fC),_C=h_(gC),CC=h_(b_),AC=XI;(pC&&AC(new pC(new ArrayBuffer(1)))!=bC||oC&&AC(new oC)!=mC||fC&&AC(fC.resolve())!=vC||gC&&AC(new gC)!=yC||b_&&AC(new b_)!=SC)&&(AC=function(e){var t=XI(e),n="[object Object]"==t?e.constructor:void 0,r=n?h_(n):"";if(r)switch(r){case EC:return bC;case wC:return mC;case IC:return vC;case _C:return yC;case CC:return SC}return t});var TC=AC,RC=qI.Uint8Array;function OC(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new aC;++t<n;)this.add(e[t])}function PC(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}OC.prototype.add=OC.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},OC.prototype.has=function(e){return this.__data__.has(e)};var DC=1,kC=2;function xC(e,t,n,r,i,o){var s=n&DC,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var c=o.get(e),l=o.get(t);if(c&&l)return c==t&&l==e;var d=-1,h=!0,p=n&kC?new OC:void 0;for(o.set(e,t),o.set(t,e);++d<a;){var f=e[d],g=t[d];if(r)var m=s?r(g,f,d,t,e,o):r(f,g,d,e,t,o);if(void 0!==m){if(m)continue;h=!1;break}if(p){if(!PC(t,(function(e,t){if(s=t,!p.has(s)&&(f===e||i(f,e,n,r,o)))return p.push(t);var s}))){h=!1;break}}else if(f!==g&&!i(f,g,n,r,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function NC(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function MC(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var FC=KI?KI.prototype:void 0,LC=FC?FC.valueOf:void 0,VC=Object.prototype.hasOwnProperty,BC="[object Arguments]",jC="[object Array]",UC="[object Object]",HC=Object.prototype.hasOwnProperty;function qC(e,t,n,r,i){return e===t||(null==e||null==t||!e_(e)&&!e_(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var s=t_(e),a=t_(t),u=s?jC:TC(e),c=a?jC:TC(t),l=(u=u==BC?UC:u)==UC,d=(c=c==BC?UC:c)==UC,h=u==c;if(h&&V_(e)){if(!V_(t))return!1;s=!0,l=!1}if(h&&!l)return o||(o=new uC),s||W_(e)?xC(e,t,n,r,i,o):function(e,t,n,r,i,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new RC(e),new RC(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return __(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=NC;case"[object Set]":var u=1&r;if(a||(a=MC),e.size!=t.size&&!u)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var l=xC(a(e),a(t),r,i,o,s);return s.delete(e),l;case"[object Symbol]":if(LC)return LC.call(e)==LC.call(t)}return!1}(e,t,u,n,r,i,o);if(!(1&n)){var p=l&&HC.call(e,"__wrapped__"),f=d&&HC.call(t,"__wrapped__");if(p||f){var g=p?e.value():e,m=f?t.value():t;return o||(o=new uC),i(g,m,n,r,o)}}return!!h&&(o||(o=new uC),function(e,t,n,r,i,o){var s=1&n,a=hC(e),u=a.length;if(u!=hC(t).length&&!s)return!1;for(var c=u;c--;){var l=a[c];if(!(s?l in t:VC.call(t,l)))return!1}var d=o.get(e),h=o.get(t);if(d&&h)return d==t&&h==e;var p=!0;o.set(e,t),o.set(t,e);for(var f=s;++c<u;){var g=e[l=a[c]],m=t[l];if(r)var v=s?r(m,g,l,t,e,o):r(g,m,l,e,t,o);if(!(void 0===v?g===m||i(g,m,n,r,o):v)){p=!1;break}f||(f="constructor"==l)}if(p&&!f){var y=e.constructor,S=t.constructor;y==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof S&&S instanceof S||(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,r,i,o))}(e,t,n,r,qC,i))}var KC=Object.prototype.hasOwnProperty;const $C=e=>4294966272&e,WC=e=>{let t={R:0,G:0,B:0,A:0};if("string"==typeof e&&e.startsWith("#")){const a=e.slice(1);try{if(3===a.length){const e=Array.from(a).map((e=>e.repeat(2))).map((e=>parseInt(e,16)));t={R:e[0]/255,G:e[1]/255,B:e[2]/255,A:1}}else if(6===a.length||8===a.length){var n,r,i,o,s;const e=null===(n=a.match(/\S{2}/g))||void 0===n?void 0:n.map((e=>parseInt(e,16)));t={R:(null!==(r=null==e?void 0:e[0])&&void 0!==r?r:0)/255,G:(null!==(i=null==e?void 0:e[1])&&void 0!==i?i:0)/255,B:(null!==(o=null==e?void 0:e[2])&&void 0!==o?o:0)/255,A:null!=e&&e[3]?(null!==(s=null==e?void 0:e[3])&&void 0!==s?s:0)/255:1}}}catch(t){console.warn("error color representation:",e)}}else"object"==typeof e&&(t={R:e.R/255,G:e.G/255,B:e.B/255,A:e.A||1});return t};function GC(e){let{captureWidth:t=0,captureHeight:n=0}=e||{};const{hd:r}=e||{};var i,o;return 0!==t&&0!==n||(r&&Ls.isSupportSending720P()?(t=1280,n=720):(t=640,n=360)),{captureWidth:t,captureHeight:n,isCustomizedResolution:!(null==e||!e.captureWidth||!e.captureHeight||(i=t,o=n,Math.abs(Math.floor(i/o*10)-Math.floor(16/9*10))<=1))}}function zC(e,t){return"default"===e||t.some((t=>t.deviceId===e))||[Za.Environment,Za.User,Za.Left,Za.Right].includes(e)}function JC(e,t){if("function"==typeof DOMMatrixReadOnly){const n=new DOMMatrixReadOnly(getComputedStyle(e).transform).scale(-1,1).toString();e.style.transform=n,e.dataset.mirrored=t?"1":"0"}}function QC(e,t,n){const r=[],{video:{videoSsrc:i,activeCamera:o}}=t,{cameraId:s=o,videoElement:a,originalRatio:u,ptz:c,hd:l,fullHd:d,mediaFile:h,fps:p,mirrored:f}=n||{};let g;if(void 0!==a){let e=a instanceof HTMLVideoElement?a:null;if("string"==typeof a){let[t,n]=[document.body,a];if(a.indexOf(">")>-1){const[e,r]=a.split(">");t=document.querySelector(e),n=r}t&&(e=t.querySelector(n))}if(!e)return[];g=e,e.id||(e.id=fi("__ZOOM_SDK_SELF_VIDEO_@__")),f&&"1"!==e.dataset.mirrored&&JC(e,f)}let m=null!=p?p:Iu.Default;m=Math.max(Iu.Min,m),m=Math.min(Iu.Max,m);const{captureWidth:v,captureHeight:y,isCustomizedResolution:S}=GC(n);if(S)e.updateVideoHDValue(!1);else{e.updateVideoHDValue(!!l||!!d);const t=!!d&&Ls.isSupportFullHDVideo();e.updateVideoFullhdValue(t)}let b=Promise.resolve(s);if(h&&h.url){const e=Gv.getInstance();b=e.setVideoElement(h).then((()=>e.videoElement))}else Gv.getInstance().stopVideoElement();return b.then((t=>{e.startCaptureVideo(i,t,v,y,g,Uo.isAndroidOrIOSBrowser&&Xa.includes(t),!u&&function(){var e,t;const{isAndroidOrIOSBrowser:n,isFirefox:r,isSafari:i}=Uo;return n||!(null!==(e=navigator.mediaDevices)&&void 0!==e&&null!==(t=e.getSupportedConstraints)&&void 0!==t&&t.call(e).aspectRatio)||r||i||Wo()}(),c,m)})),r.push(Nf({cameraId:s,captureWidth:v,captureHeight:y,videoElement:"string"==typeof a?a:a instanceof HTMLVideoElement?bi(a):void 0,originalRatio:u,ptz:c,hd:l,fullHd:d,mediaFile:h,fps:m,mirrored:f})),r}function YC(e,t,n){const{max:r,min:i,step:o}=e;let s=n/100*(r-i);o&&(s=Math.min(Math.floor(s/o)*o,Math.floor(s)));let a=t+s;return a=Math.min(r,a),a=Math.max(i,a),a}function ZC(e,t){let n="",r=t;switch(e){case hu.Down:r=-t,n="tilt";break;case hu.Up:n="tilt";break;case hu.Left:r=-t,n="pan";break;case hu.Right:n="pan";break;case hu.ZoomIn:n="zoom";break;case hu.ZoomOut:r=-t,n="zoom"}return{key:n,range:r}}function XC(e){const t=["pan","tilt","zoom"].reduce(((t,n)=>e[n]&&0!==e[n].value?{...t,[n]:e[n].value}:t),{});return function(e){if(null==e)return!0;if(T_(e)&&(t_(e)||"string"==typeof e||"function"==typeof e.splice||V_(e)||W_(e)||N_(e)))return!e.length;var t=TC(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(O_(e))return!Q_(e).length;for(var n in e)if(KC.call(e,n))return!1;return!0}(t)?null:t}function eA(e){return{pan:(e&pu.Pan)===pu.Pan,tilt:(e&pu.Tilt)===pu.Tilt,zoom:(e&pu.Zoom)===pu.Zoom}}function tA(e){const{isAndroidBrowser:t,isIOSMobile:n,isFirefox:r,isSupportImageCapture:i,isSupportMediaStreamTrackProcessor:o,isSupportOffscreenCanvas:s}=Uo,a=t&&!r,u="function"!=typeof window.SharedArrayBuffer&&a;return n&&"function"==typeof VideoFrame||u||!Ko()&&!e&&!Nv()&&(i||o)&&s}function nA(){var e,t;return"orientation"in window.screen?null===(e=screen.orientation.type)||void 0===e?void 0:e.startsWith("landscape"):"orientation"in window?90===Math.abs(window.orientation):"matchMedia"in window?!(null===(t=window.matchMedia("(orientation: landscape)"))||void 0===t||!t.matches):screen.availWidth>screen.availHeight}function rA(e,t,n){const{meeting:{userId:r},video:{isSupportHDVideo:i,renderedVideoList:o,maximumNumbeOfHDSubscriptions:s,receivedVideoMaxQuality:a}}=n,u=e===r;let c=t;if(t>=Ka.Video_720P)if(i){const t=o.filter((e=>e.videoQuality===Ka.Video_720P)).map((e=>e.userId)),n=null!=s?s:1;t.length>=n&&(t.includes(e)||u||(console.warn(`Warning: Web Video SDK currently only supports subscribing to ${n} 720p video stream, so quality has been downgraded to 360p`),c=Ka.Video_360P))}else console.warn("Can not subscribe 720P video stream,will downgrade to 360P stream"),c=Ka.Video_360P;const l=Math.max(a,Ka.Video_360P);return[c,Math.min(c,l)]}const iA=Ps.createAgent(),oA=nb(Ls.getInstance());let sA,aA;async function uA(e,t,n){const r=fi(e),i=document.createElement("img");return i.src=t,i.id=r,i.style.display="none",gi(t)&&i.setAttribute("crossorigin",""),await new Promise(((e,r)=>{i.onload=()=>{n&&URL.revokeObjectURL(t),e("")},i.onerror=()=>{n&&URL.revokeObjectURL(t),r("Cannot load  image.")}})),{imageId:r,imgElement:i}}async function cA(e,t,n){if(e===Ya)return Ya;{let r=e;if(t){const t=await function(e){return new Promise(((t,n)=>{try{sA&&aA||(sA=document.createElement("canvas"),aA=sA.getContext("2d"));const r=sA,i=aA;if(i){i.clearRect(0,0,sA.width,sA.height);const o=new Image;o.src=e,gi(e)&&(o.crossOrigin="");const s=16/9,a=1280,u=Math.floor(a/s);r.width=a,r.height=u,o.onload=()=>{const{width:e,height:c}=o,l=c*s;if(l>e){const t=e,n=Math.floor(e/s),r=0,l=(c-n)/2;null==i||i.drawImage(o,r,l,t,n,0,0,a,u)}else{const t=l,n=c,r=(e-t)/2,s=0;i.drawImage(o,r,s,t,n,0,0,a,u)}try{r.toBlob((e=>{t(e)}))}catch(e){e instanceof DOMException&&e.code===DOMException.SECURITY_ERR&&console.error("Image is not from the same origin, add CORS header to solve this issue"),n(e)}},o.onerror=e=>{n("Cannot load  image.")}}}catch(e){n(e)}}))}(e);r=URL.createObjectURL(t)}if(r){const{imageId:e,imgElement:i}=await uA(iu,r,!!t);return(null!=n?n:document.body).appendChild(i),e}}return null}async function lA(e,t,n){var r;const i=null!==(r=n&&n.parentNode)&&void 0!==r?r:document.body,{imageUrl:o,cropped:s,rootWidth:a,rootHeight:u}=e;let c=e;!t.video.customizedVideoOption||e.captureWidth&&e.captureHeight||(c=t.video.customizedVideoOption);const{captureWidth:l,captureHeight:d}=GC(c),h=document.createElement("div");let p;h.style.display="none",p=o?await cA(o,s,h):null;let f,g=fi(ru);if(n){const t=xv(n);t.id?g=t.id:t.id=g,f=t;try{a&&n.width!==a&&(n.width=a),u&&n.height!==u&&(n.height=u)}catch(e){console.warn("Cannot set the canvas width/height, and pay attention the canvas dimension is different from the setting")}}else{const e=document.createElement("canvas");e.width=null!=a?a:380,e.height=null!=u?u:214,e.id=g,f=e,h.appendChild(e)}return null==i||i.appendChild(h),{captureWidth:l,captureHeight:d,imageId:p,canvas:f,divElement:h}}async function dA(e,t,n,r){const i=Array.isArray(e)?e:e&&[e];if((null==i?void 0:i.length)>0){sA&&aA||(sA=document.createElement("canvas"),aA=sA.getContext("2d"));const o=sA,s=aA;if(o.width=t,o.height=n,s)try{s.fillStyle="#fff",s.clearRect(0,0,t,n);for(let e=0;e<i.length;e++){const t=i[e],{type:n,x:r,y:o}=t;if("rectangle"===n){const{width:e,height:n}=t;s.fillRect(r,o,e,n)}else if("square"===n){const{length:e}=t;s.fillRect(r,o,e,e)}else if("circle"===n){const{radius:e}=t;s.beginPath(),s.arc(r,o,e,0,2*Math.PI),s.fill()}else if("svg"===n){const{svg:e,width:n,height:i}=t,a=new Image;a.src=e,gi(e)&&(a.crossOrigin=""),await new Promise(((e,t)=>{a.onload=()=>{e("")},a.onerror=()=>{t()}}));const{width:u,height:c}=a;s.drawImage(a,0,0,u,c,r,o,n,i)}}const e=await new Promise((e=>{null==o||o.toBlob((t=>{e(t)}))}));if(e){const t=URL.createObjectURL(e),{imageId:n,imgElement:i}=await uA(ou,t,!0);return(null!=r?r:document.body).appendChild(i),n}}catch(e){e instanceof DOMException&&e.code===DOMException.SECURITY_ERR&&console.error("Image is not from the same origin, add CORS header to solve this issue")}}return null}function hA(e,t){if(e===t)return!0;if(null==e&&null==t)return!0;const n=Array.isArray(e)?[...e]:[e],r=Array.isArray(t)?[...t]:[t];if(n.length!==r.length)return!1;const i=(e,t)=>e.type<t.type?-1:e.type===t.type?0:1;n.sort(i),r.sort(i);for(let e=0;e<n.length;e++)if(!di(n[e],r[e]))return!1;return!0}function pA(e,t,n,r){const{video:{isCurrentUserStartedVideo:i,virtualBackground:{isVBPreloadReady:o,isVBConfigured:s,imageSrc:a},backgroundMode:u},meeting:{isCurrentUserStartVideoBeforeReset:c}}=n;return Be(function(e){return void 0!==e?Me([e]):Ad(zu,1).pipe(Ke((e=>e)))}(o)).then((o=>o?r||!s&&e.imageUrl!==Ya&&e.imageUrl?async function(e,t,n,r){const{canvas:i,imageId:o,captureHeight:s,captureWidth:a,divElement:u}=await lA(e,n,r),{cameraId:c}=e,{video:{videoSsrc:l,activeCamera:d}}=n;return t.startVirtualBackgroundSetting(i,o,l,null!=c?c:d,a,s),u}(e,t,n,r).then((e=>i?Of(!0):Be(Ad(Ju,1)).then((n=>{var i;return r||t.stopVirtualBackgroundSetting(),n?(null==e||null===(i=e.parentNode)||void 0===i||i.removeChild(e),!0):Promise.reject("Cannot access the virtual background image.")})))):a===e.imageUrl&&u===vu.VirtualBackground&&!c||async function(e,t,n){const{imageUrl:r,cropped:i}=e;if(r){const e=await cA(r,i);e&&(n.video.backgroundMode===vu.Mask&&(t.stopMaskSetting(!0),await pi((()=>{t.stopVirtualBackgroundSetting()}),0)),t.updateVirtualBackgroundImage(e),e!==Ya&&setTimeout((()=>{Ev(e)}),0))}else t.updateVirtualBackgroundImage(null)}(e,t,n):Promise.reject("Cannot load virtual background model.")))}function fA(e,t,n,r){const{video:{mask:{isMaskConfigured:i,imageSrc:o,clip:s},backgroundMode:a,isCurrentUserStartedVideo:u},meeting:{isCurrentUserStartVideoBeforeReset:c}}=n;return r||!i&&e.imageUrl?async function(e,t,n,r){const{canvas:i,imageId:o,captureHeight:s,captureWidth:a,divElement:u}=await lA(e,n,r),{cameraId:c,clip:l,rootWidth:d=1280,rootHeight:h=720}=e,p=l?await dA(l,d,h,u):null,{video:{videoSsrc:f,activeCamera:g}}=n;return p?(t.startMaskSetting(i,o,p,f,null!=c?c:g,d,h,a,s),u):Promise.reject("Clip is empty")}(e,t,n,r).then((e=>u?$f(!0):Be(Ad(rc,1)).then((n=>{var i;return r||t.stopMaskSetting(),n?(null==e||null===(i=e.parentNode)||void 0===i||i.removeChild(e),!0):Promise.reject("Cannot set video mask")})))):a===vu.Mask&&e.imageUrl===o&&hA(e.clip,s)&&!c?Promise.resolve(!0):async function(e,t,n){const{imageUrl:r,cropped:i,clip:o,rootWidth:s,rootHeight:a}=e,{video:{mask:{imageSrc:u,cropped:c,clip:l},backgroundMode:d}}=n;if(r){if(d===vu.VirtualBackground&&(t.stopVirtualBackgroundSetting(!0),await pi((()=>{t.stopMaskSetting()}),0)),r!==u||i!==c){const e=await cA(r,i);e&&(t.updateMaskBackgroundImage(e),setTimeout((()=>{Ev(e)}),0))}if((!hA(o,l)||!u)&&o&&s&&a){const e=await dA(o,s,a);e&&(t.updateMaskClip(e,s,a),setTimeout((()=>{Ev(e)}),0))}}else t.updateMaskBackgroundImage(null),t.updateMaskClip(null,s,a)}(e,t,n)}const gA=Ps.createAgent(),mA=nb(Ls.getInstance()),vA=Ps.createAgent(),yA=nb(Ls.getInstance()),SA={videoSsrc:0,cameraDevicesList:[],activeCamera:Uo.isAndroidOrIOSBrowser?Za.User:"default",activeVideoId:0,isCurrentUserStartedVideo:!1,spotlightUserList:[],isCaptureForbidden:!1,isMirrored:!1,receivedVideoMaxQuality:navigator.hardwareConcurrency>=8?Ka.Video_1080P:Ka.Video_360P,subscribedVideoList:[],renderedVideoList:[],ensuredCanvas:[],isVideoMuted:!1,isCaptureCameraLoading:!1,isCameraTaken:!1,isUsingMediaPlayback:!1,receivedVideoDimension:{width:0,height:0},capturedVideoDimension:{width:0,height:0},isFollowHostVideoLayout:!1,hostDragLayout:[],isSupportHDVideo:!1,isFullHDVideoEnabled:!1,bCanUnmuteVideo:!1,virtualBackground:{isVBConfigured:!1,isVBPreloadReady:void 0,imageSrc:void 0,cropped:void 0},mask:{imageSrc:void 0,cropped:void 0,clip:void 0},backgroundMode:vu.Null,statistic:{encode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0},decode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0}},hardwareAcceleration:{encode:!1,decode:!1},networkQuality:{},ptz:{},currentCameraControlStatus:{isRequested:!1,isInControl:!1,isCameraMoving:!1},farEndCameraControlStatus:{controlledUserList:[],isControlling:!1},subscriptionStatus:{encode:!1,decode:!1,detailed:!1},videoAttachments:{},rendererType:Tu.WebGL,selfPreviewVideoList:[]},bA=Rn({[`${sf}`]:hE(((e,t)=>{let{payload:n}=t;e.videoSsrc=n})),[`${uf}`]:hE(((e,t)=>{let{payload:n}=t;e.cameraDevicesList=n})),[`${cf}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.activeCamera;if(r in e.ptz){const t=e.ptz[r];["pan","tilt","zoom"].forEach((e=>{t[e]&&(t[e].value=0)}))}e.activeCamera=n})),[`${af}`]:hE(((e,t)=>{let{payload:n}=t;e.activeVideoId=n.userId})),[`${lf}`]:hE(((e,t)=>{let{payload:n}=t;e.isCurrentUserStartedVideo=n})),[`${df}`]:hE(((e,t)=>{let{payload:n}=t;e.spotlightUserList=n})),[`${hf}`]:hE(((e,t)=>{let{payload:n}=t;e.isCaptureForbidden=n})),[`${pf}`]:hE(((e,t)=>{let{payload:n}=t;e.receivedVideoMaxQuality=n})),[`${ff}`]:hE(((e,t)=>{let{payload:n}=t;e.isVideoMuted=n})),[`${gf}`]:hE(((e,t)=>{let{payload:n}=t;e.isCaptureCameraLoading=n})),[`${mf}`]:hE(((e,t)=>{let{payload:n}=t;e.isCameraTaken=n})),[`${yf}`]:hE(((e,t)=>{let{payload:n}=t;e.receivedVideoDimension=n})),[`${Sf}`]:hE(((e,t)=>{let{payload:n}=t;e.subscribedVideoList.includes(n)||e.subscribedVideoList.push(n)})),[`${bf}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.subscribedVideoList.indexOf(n);r>=0&&e.subscribedVideoList.splice(r,1)})),[`${If}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.renderedVideoList.find((e=>e.userId===n.userId&&e.key===n.key&&e.canvasId===n.canvasId));r?(void 0!==n.videoQuality&&(r.videoQuality=n.videoQuality),void 0!==n.aspectRatio&&(r.aspectRatio=n.aspectRatio)):e.renderedVideoList.push({...n})})),[`${_f}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.renderedVideoList.findIndex((e=>e.userId===n.userId&&e.key===n.key&&e.canvasId===n.canvasId));r>=0&&e.renderedVideoList.splice(r,1)})),[`${Ef}`]:hE(((e,t)=>{let{payload:n}=t;e.isFollowHostVideoLayout=n})),[`${wf}`]:hE(((e,t)=>{let{payload:n}=t;e.hostDragLayout=n})),[`${Cf}`]:hE(((e,t)=>{let{payload:n}=t;e.isSupportHDVideo=n})),[`${Af}`]:hE(((e,t)=>{let{payload:n}=t;e.maximumNumbeOfHDSubscriptions=n})),[`${Tf}`]:hE(((e,t)=>{let{payload:n}=t;e.bCanUnmuteVideo=n})),[`${Rf}`]:hE(((e,t)=>{let{payload:n}=t;e.virtualBackground.isVBPreloadReady=n})),[`${Of}`]:hE(((e,t)=>{let{payload:n}=t;e.virtualBackground.isVBConfigured=n})),[`${Pf}`]:hE(((e,t)=>{let{payload:n}=t;e.virtualBackground.imageSrc=n.imageUrl,e.virtualBackground.cropped=n.cropped,e.backgroundMode=vu.VirtualBackground})),[`${xf}`]:hE(((e,t)=>{let{payload:n}=t;const{encode:r,decode:i}=n;void 0!==r&&(e.hardwareAcceleration.encode=r),void 0!==i&&(e.hardwareAcceleration.decode=i)})),[`${Df}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:r,rate:i,...o}}=n;e.statistic.encode={bitrate:i,...o}})),[`${kf}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:r,rate:i,...o}}=n;e.statistic.decode={bitrate:i,...o}})),[`${Nf}`]:hE(((e,t)=>{let{payload:n}=t;const{cameraId:r,captureWidth:i,captureHeight:o,videoElement:s,originalRatio:a,ptz:u,hd:c,fullHd:l,mediaFile:d,fps:h,mirrored:p}=n;e.activeCamera=r,e.customizedVideoOption={captureWidth:i,captureHeight:o,videoElement:s,originalRatio:a,ptz:u,hd:c,fullHd:l,fps:h},di(e.mediaPlaybackFile,d)||(e.mediaPlaybackFile=d,e.isUsingMediaPlayback=!(null==d||!d.url)),void 0!==p&&(e.isMirrored=!!p)})),[`${Mf}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:r,level:i,bwLevel:o,type:s}=n;if(Object.prototype.hasOwnProperty.call(e.networkQuality,`${r}`))e.networkQuality[`${r}`][`${s}`]={level:i,bwLevel:o};else{const t={[s]:{level:i,bwLevel:o}};Object.assign(e.networkQuality,{[`${r}`]:t})}})),[`${Ff}`]:hE(((e,t)=>{let{payload:n}=t;const{deviceId:r,ptzRange:i}=n;if(Object.prototype.hasOwnProperty.call(e.ptz,r)){const t=e.ptz[r];t&&["pan","tilt","zoom"].forEach((e=>{const n=i[e];if(n){var r;const i=null===(r=t[e])||void 0===r?void 0:r.capability;i?Object.assign(i,{...n}):t[e]={capability:{...n},value:0}}}))}else Object.assign(e.ptz,{[r]:{pan:i.pan?{capability:{...i.pan},value:0}:null,tilt:i.tilt?{capability:{...i.tilt},value:0}:null,zoom:i.zoom?{capability:{...i.zoom},value:0}:null}})})),[`${Lf}`]:hE(((e,t)=>{let{payload:n}=t;e.currentCameraControlStatus.isRequested=n})),[`${Vf}`]:hE(((e,t)=>{let{payload:n}=t;const{isInControl:r,userId:i}=n;e.currentCameraControlStatus.isInControl=r,e.currentCameraControlStatus.controllingUserId=i})),[`${Bf}`]:hE(((e,t)=>{let{payload:n}=t;e.farEndCameraControlStatus.controlledUserList.includes(n)||e.farEndCameraControlStatus.controlledUserList.push(n)})),[`${jf}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.farEndCameraControlStatus.controlledUserList.indexOf(n);-1!==r&&e.farEndCameraControlStatus.controlledUserList.splice(r,1)})),[`${Uf}`]:hE(((e,t)=>{let{payload:n}=t;e.currentCameraControlStatus.isCameraMoving="start"===n.cmd})),[`${Hf}`]:hE(((e,t)=>{let{payload:n}=t;const{constraints:r,deviceId:i}=n,o=e.ptz[i];["pan","tilt","zoom"].forEach((e=>{void 0!==r[e]&&(o[e].value=r[e])}))})),[`${qf}`]:hE(((e,t)=>{let{payload:n}=t;e.farEndCameraControlStatus.isControlling=n})),[`${Kf}`]:hE(((e,t)=>{let{payload:n}=t;e.networkQualityBroadcastTime=n})),[`${$f}`]:hE(((e,t)=>{let{payload:n}=t;e.mask.isMaskConfigured=n})),[`${Gf}`]:hE(((e,t)=>{let{payload:n}=t;const{imageUrl:r,cropped:i,rootHeight:o,rootWidth:s,clip:a}=n;e.mask.imageSrc=r,e.mask.cropped=i,e.mask.clip=a,e.mask.rootWidth=s,e.mask.rootHeight=o,e.backgroundMode=vu.Mask})),[`${Wf}`]:hE(((e,t)=>{let{payload:n}=t;e.backgroundMode=n})),[`${zf}`]:hE(((e,t)=>{let{payload:n}=t;e.capturedVideoDimension=n})),[`${Jf}`]:hE(((e,t)=>{let{payload:n}=t;e.ensuredCanvas.includes(n)||e.ensuredCanvas.push(n)})),[`${Qf}`]:hE(((e,t)=>{let{payload:n}=t;e.mediaPlaybackFile=n,e.isUsingMediaPlayback=!(null==n||!n.url)})),[`${Yf}`]:hE(((e,t)=>{let{payload:n}=t;if(n){const{lastCopy:t,...r}=n;e.prefetchedVideo=r}else e.prefetchedVideo=n})),[`${Zf}`]:hE(((e,t)=>{let{payload:n}=t;Object.assign(e.subscriptionStatus,n)})),[`${Xf}`]:hE(((e,t)=>{let{payload:n}=t;e.isFullHDVideoEnabled=n})),[`${eg}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:r,element:i}=n,o=e.videoAttachments[`${r}`];if(o)-1===o.indexOf(i)&&o.push(i);else{const t=[];t.push(i),Object.assign(e.videoAttachments,{[`${r}`]:t})}})),[`${tg}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:r,element:i}=n,o=e.videoAttachments[`${r}`];let s=i;Array.isArray(i)||(s=[i]),s.forEach((e=>{if(o){const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}))})),[`${ng}`]:hE(((e,t)=>{let{payload:n}=t;n&&(e.rendererType=Tu.WebGL2)})),[`${rg}`]:hE(((e,t)=>{let{payload:n}=t;n&&(e.rendererType=Tu.WebGPU)})),[`${ig}`]:hE(((e,t)=>{let{payload:n}=t;e.rendererType=n})),[`${og}`]:hE(((e,t)=>{let{payload:n}=t;e.isMirrored=n})),[`${sg}`]:hE(((e,t)=>{let{payload:n}=t;e.selfPreviewVideoList.includes(n)||e.selfPreviewVideoList.push(n)})),[`${ag}`]:hE(((e,t)=>{let{payload:n}=t;if(n){const t=e.selfPreviewVideoList.indexOf(n);t>=0&&e.selfPreviewVideoList.splice(t,1)}else e.selfPreviewVideoList=[]})),[`${vf}`]:(e,t)=>{let{payload:n}=t;const r={cameraDevicesList:e.cameraDevicesList};return n&&Object.assign(r,{activeCamera:e.activeCamera,customizedVideoOption:e.customizedVideoOption,virtualBackground:{imageSrc:e.virtualBackground.imageSrc,cropped:e.virtualBackground.cropped},mask:{imageSrc:e.mask.imageSrc,cropped:e.mask.cropped,rootWidth:e.mask.rootWidth,rootHeight:e.mask.rootHeight,clip:e.mask.clip},backgroundMode:e.backgroundMode,ptz:e.ptz,subscriptionStatus:e.subscriptionStatus}),{...SA,...r}}},SA),EA={cameraPtzEpics0:(e,t)=>pr(e,8004).pipe(Ye((e=>{const{payload:{body:{nCmd:n,nUserID:r,nReason:i,nButtonID:o}}}=e,s=t.value,a=bh(s),{video:{currentCameraControlStatus:{isInControl:u,controllingUserId:c},cameraDevicesList:l,activeCamera:d}}=s,h=a.find((e=>hi(e.userId,r))),p=[];if(p.push(Lf(!0)),n===du.Request){const e={userId:null==h?void 0:h.userId,displayName:null==h?void 0:h.displayName};if(u){const t=a.find((e=>e.userId===c));Object.assign(e,{currentControllingUserId:null==t?void 0:t.userId,currentControllingDisplayName:null==t?void 0:t.displayName})}Id(Xu,e)}else if(n===du.Approve)p.push(Bf(null==h?void 0:h.userId)),Id(ec,{isApproved:!0,userId:null==h?void 0:h.userId,displayName:null==h?void 0:h.displayName});else if(n===du.Decline)p.push(jf(null==h?void 0:h.userId)),Id(ec,{isApproved:!1,userId:null==h?void 0:h.userId,displayName:null==h?void 0:h.displayName,reason:i});else if(n===du.GiveUp)p.push(Vf({isInControl:!1,userId:0})),Id(tc,{isControlled:!1});else if(n===du.StartControl||n===du.StopControl)p.push(Uf({cmd:n===du.StartControl?"start":"stop",type:o}));else if(n===du.SwitchCamera){const e=l.findIndex((e=>e.deviceId===d)),t=e+1===l.length?0:e+1;if(t!==e){const e=l[t].deviceId;yA.changeCamera(e,Xa.includes(e))}}return Me(p)}))),cameraPtzEpics1:(e,t)=>pr(e,rs).pipe(ht((e=>{var t;const{payload:{body:n}}=e;return null==n||null===(t=n.update)||void 0===t?void 0:t.some((e=>void 0!==e.nFECC||void 0!==e.nFECCExecutive))})),At((e=>{const{payload:{body:{update:n}}}=e,r=n.find((e=>void 0!==e.nFECC||void 0!==e.nFECCExecutive));if(r){const{meeting:{userId:e}}=t.value;hi(r.nFECCExecutive,e)&&Id(nc,{userId:r.id,ptz:eA(r.nFECC)})}})),St(ge)),cameraPtzEpics2:(e,t)=>pr(e,rs).pipe(ht((e=>{var n;const{payload:{body:r}}=e,{video:{farEndCameraControlStatus:{controlledUserList:i}}}=t.value;return null==r||null===(n=r.remove)||void 0===n?void 0:n.some((e=>i.includes(e.id)))})),Ye((e=>{var n;const{payload:{body:r}}=e,i=[],{video:{farEndCameraControlStatus:{controlledUserList:o}}}=t.value,s=null==r||null===(n=r.remove)||void 0===n?void 0:n.find((e=>o.includes(e.id)));return s&&i.push(jf(s.id)),Me(i)}))),cameraPtzEpics3:(e,t)=>e.pipe(Ut(`${Uf}`),It((e=>{const{payload:{cmd:n,type:r}}=e;return"start"===n?at(0,200).pipe(Ct((()=>!!t.value.video.currentCameraControlStatus.isCameraMoving)),Ye((()=>{const{video:{ptz:e,activeCamera:n}}=t.value,i=e[n],o=XC(i)||{},{key:s,range:a}=ZC(r,2);return i[s]?(Object.assign(o,{[s]:YC(i[s].capability,i[s].value,a)}),yA.movePTZCamera(o).then((()=>Hf({deviceId:n,constraints:o})))):Promise.resolve(void 0)})),Ye((e=>"object"==typeof e&&void 0!==e.type?Fe(e):ge))):ge}))),cameraPtzEpics4:(e,t)=>e.pipe(Ut(`${cf}`),Ye((e=>{const{payload:n}=e,{video:{customizedVideoOption:r,ptz:i}}=t.value;if(null!=r&&r.ptz){const e=null==i?void 0:i[n];void 0!==e&&vA.sendCameraAblity({pan:!!e.pan,tilt:!!e.tilt,zoom:!!e.zoom})}return ge})))},wA={videoCaptureEpics0:(e,t)=>vr(e,Da.StartVideoCaptureSuccess).pipe(Ye((e=>{const{video:{cameraDevicesList:n,activeCamera:r,ptz:i,isCurrentUserStartedVideo:o,isUsingMediaPlayback:s},meeting:{userId:a}}=t.value,{payload:{data:{currentDeviceID:u,PTZRange:c}}}=e,l=[];if(n.length<1&&!s&&(Id(Mu,{reason:"Cannot detect camera devices"}),mA.stopCaptureVideo()),zC(r,n)||s){if(o||gA.muteAttendeeVideo(a,!1),Id(ic),s)l.push(cf("default"));else if(u&&c&&l.push(Ff({deviceId:u,ptzRange:c})),r!==u&&l.push(cf(u)),Object.prototype.hasOwnProperty.call(i,u)){const e=i[u];if(e){const t=XC(e);t&&mA.movePTZCamera(t)}}}else Id(Fu,{reason:"cannot find target camera"}),mA.stopCaptureVideo();return Me(l)}))),videoCaptureEpics1:(e,t)=>pr(e,rs).pipe(ht((e=>{const{payload:{body:{update:n}}}=e,{meeting:{userId:r}}=t.value;return null==n?void 0:n.some((e=>e.id===r&&void 0!==e.bVideoOn))})),Ke((e=>{const{payload:{body:{update:n}}}=e,{meeting:{userId:r}}=t.value,i=n.find((e=>e.id===r));return!0===i.bVideoOn?Id(Uu):Id(Hu),lf(!!i.bVideoOn)}))),videoCaptureEpics2:e=>vr(e,[Da.UserForbiddedCaptureVideo,Da.UserCameraIsTakenByOtherPrograms,Da.VideoWebsocketBroken,Da.StopVideoCaptureFailed]).pipe(Ye((e=>{const{payload:{type:t}}=e,n=[];switch(t){case Da.UserForbiddedCaptureVideo:Id(Lu),n.push(hf(!0));break;case Da.UserCameraIsTakenByOtherPrograms:Id(Vu,{reason:"User camera is taken by other programs."}),n.push(mf(!0));break;case Da.VideoWebsocketBroken:Id(ju,{reason:"Video websocket broken."});break;case Da.StopVideoCaptureFailed:Id(Hu,{failed:!0,reason:"Unknown."})}return Me(n)}))),videoCaptureEpics3:(e,t)=>vr(e,Da.StopVideoCaptureSuccess).pipe(Tt(t),Zv((e=>{let[,t]=e;const{meeting:{userId:n},video:{isCurrentUserStartedVideo:r}}=t;r||Id(Hu),gA.muteAttendeeVideo(n,!0)}))),videoCaptureEpics4:(e,t)=>pr(e,16133).pipe(Tt(t),ht((e=>{var t,n;let[r,i]=e;return(null==r||null===(t=r.payload)||void 0===t||null===(n=t.body)||void 0===n?void 0:n.id)===i.meeting.userId})),Zv((e=>{let[t]=e;const{id:n,bVideoMute:r}=t.payload.body;return Id(Du,{id:n,isVideoMuted:r}),!0===r&&mA.stopCaptureVideo(),!1===r&&Id(ku,{id:n,isVideoMuted:r}),ff(r)}))),videoCaptureEpics5:(e,t)=>pr(e,16131).pipe(ht((e=>void 0!==e.payload.body.ssrc)),It((e=>{const{payload:{body:{ssrc:n}}}=e;return Id(sc,n),ct(Fe(sf(n)),Ov(t).pipe(Ye((e=>{const{meeting:{isCurrentUserStartVideoBeforeReset:n},media:{videoEncodeStatus:r}}=t.value;return!0!==(null==e?void 0:e.bVideoOn)&&!0===n?Rv("video",r,"success").pipe(ht((e=>{let[t,n]=e;return t&&n})),Ke((()=>{const e=t.value,{video:{backgroundMode:n,mask:r,virtualBackground:i,activeCamera:o,customizedVideoOption:s}}=e;let a=Promise.resolve(!0);return n===vu.VirtualBackground&&i.imageSrc?a=pA({imageUrl:i.imageSrc,cropped:i.cropped},mA,e):n===vu.Mask&&r.imageSrc&&r.clip&&(a=fA({imageUrl:r.imageSrc,cropped:r.cropped,clip:r.clip,rootHeight:r.rootHeight,rootWidth:r.rootWidth},mA,e)),a.then((()=>{QC(mA,e,{cameraId:o,...s})})),oo(void 0)}))):ge}))))}))),videoCaptureEpics6:(e,t)=>e.pipe(Ut(`${uf}`),At((e=>{const{payload:n}=e,r=t.value,{meeting:{userId:i}}=r,o=gh(r);0===n.length?o&&!o.bVideoConnect||gA.connectCamera(i,!1):null!=o&&o.bVideoConnect||gA.connectCamera(i,!0)})),St(ge)),videoCaptureEpics7:e=>vr(e,Da.InitSuccessVideo).pipe(ht((e=>!Uo.isIPad&&Uo.isAndroidOrIOSBrowser&&e.payload.data===ka.EncodeSuccess)),It((()=>"orientation"in window.screen?it(screen.orientation,"change").pipe(Ye((()=>(mA.setMobileRotateMode(nA()),ge)))):it(window,"orientationchange").pipe(Ye((e=>{var t,n,r;const i=null===(t=e.target)||void 0===t||null===(n=t.screen)||void 0===n||null===(r=n.orientation)||void 0===r?void 0:r.angle,o=90===Math.abs(i);return mA.setMobileRotateMode(o),ge})))))),videoCaptureEpics8:e=>vr(e,Da.StartVideoCaptureSuccess).pipe(ht((()=>!Uo.isIPad&&Uo.isAndroidOrIOSBrowser)),At((()=>{mA.setMobileRotateMode(nA())})),St(ge)),videoCaptureEpics9:(e,t)=>vr(e,Da.VideoStreamFailed).pipe(ht((()=>!!t.value.video.isCurrentUserStartedVideo&&Uo.isIOSMobile)),At((()=>{mA.stopCaptureVideo()})),St(ge))},IA={videoRenderEpics0:e=>pr(e,16129).pipe(Ke((e=>{const{payload:{body:{id:t,bVideoOn:n}}}=e,r=$C(t);return Id(Pu,{bVideoOn:n,userId:r}),af({bVideoOn:n,userId:r})}))),videoRenderEpics1:(e,t)=>vr(e,Da.VideoDecodeMaxSize).pipe(ht((e=>{var t;return null==e||null===(t=e.payload)||void 0===t?void 0:t.data})),Ke((e=>{const{size:n}=e.payload.data,{video:{renderedVideoList:r,receivedVideoMaxQuality:i},meeting:{userId:o}}=t.value,s=r.filter((e=>e.videoQuality>=Ka.Video_720P&&e.userId!==o));return i!==n&&s.length>0&&(n>=Ka.Video_720P||i>=Ka.Video_720P)&&s.forEach((e=>{iA.subscribeVideo(e.userId,e.videoQuality,!1)})),pf(n)}))),videoRenderEpics2:e=>pr(e,16135).pipe(Ke((e=>{const{payload:{body:{bLeadershipOn:t,id:n}}}=e,r=[];return t&&r.push($C(n)),Id(qu,{spotlightList:r}),df(r)}))),videoRenderEpics3:(e,t)=>pr(e,7958).pipe(Tt(t),Ke((e=>{let[t,n]=e;const{payload:{body:r}}=t;let i=[];r&&r.group_list&&r.group_list[0]&&(i=r.group_list[0].map((e=>e.id)));const o=bh(n);return i=i.filter((e=>o.findIndex((t=>t.userId===e))>=0)),Id(qu,{spotlightList:i}),df(i)}))),videoRenderEpics4:e=>vr(e,Da.CurrentVideoResolution).pipe(Zv((e=>(Id(xu,e.payload.data),yf(e.payload.data))))),videoRenderEpics5:e=>vr(e,[Da.CurrentVideoResolution,Da.CurrentCaptureVideoWidthHeight]).pipe(ht((e=>!!e.payload.data)),Ke((e=>{const{payload:{data:t,type:n}}=e;return n===Da.CurrentVideoResolution?(Id(xu,t),yf(t)):(Id(Nu,t),zf(t))}))),videoRenderEpics6:e=>pr(e,is).pipe(ht((e=>{const{payload:{body:t}}=e;return["bFollowHostVideo","VideoHd","bCanUnmuteVideo"].some((e=>void 0!==t[e]))})),Ke((e=>{const{payload:{body:{bFollowHostVideo:t,VideoHd:n,bCanUnmuteVideo:r}}}=e;if(void 0!==t)return Id(Ku,{bOn:t}),Ef(t);if(void 0!==r)return Tf(r);{const e=1===n;return oA.updateVideoHDValue(e),oA.enableHardwareAccelerationForVideoEncode(!1),Cf(e)}}))),videoRenderEpics7:(e,t)=>pr(e,7957).pipe(Tt(t),Ke((e=>{let[t,n]=e;const{video:{isFollowHostVideoLayout:r}}=n,{payload:{body:i}}=t,o=i&&i.drag_list&&i.drag_list.map((e=>e.id));return r&&Id($u,{layout:o}),wf(o)}))),videoRenderEpics8:(e,t)=>pr(e,rs).pipe(Tt(t),ht((e=>{let[t,n]=e;const{meeting:{userId:r},video:{subscribedVideoList:i}}=n,o=t.payload.body.update,s=t.payload.body.remove;return o&&o.length>0&&o.findIndex((e=>e.id!==r&&(void 0!==e.bVideoOn||e.bHold)))>-1||s&&s.some((e=>i.includes(e.id)))})),At((e=>{let[t,n]=e;const{payload:{body:{remove:r,update:i}}}=t,{video:{subscribedVideoList:o}}=n,s=Sh(n);if(r&&r.length>0&&r.filter((e=>o.includes(e.id))).forEach((e=>{Id(Gu,{userId:e.id})})),i&&i.length>0){const e=i.filter((e=>void 0!==e.bVideoOn)).filter((e=>-1===s.findIndex((t=>t.userId===e.id)))),t=i.filter((e=>!0===e.bHold));t.length>0&&t.filter((e=>o.includes(e.id))).forEach((e=>{Id(Gu,{userId:e.id})})),e.forEach((e=>{e.bVideoOn?Id(Wu,{userId:e.id}):o.includes(e.id)&&Id(Gu,{userId:e.id})}))}})),St(ge)),videoRenderEpics9:(e,t)=>vr(e,Da.VideoQosData).pipe(Tt(t),Ke((e=>{var t;let[n,r]=e;const{video:{isCaptureForbidden:i,isCameraTaken:o},media:{videoEncodeStatus:s,videoDecodeStatus:a}}=r,u=gh(r),c=_h(r),l=c.length>0,d=(null==u?void 0:u.bVideoOn)&&!i&&!o,h=c.some((e=>e.bVideoOn)),p="success"===s&&d&&l,f="success"===a&&l&&h;return null!==(t=n.payload.data)&&void 0!==t&&t.encoding?p?(Id(Qu,n.payload),Df(n.payload)):Df(lu):f?(Id(Qu,n.payload),kf(n.payload)):kf(lu)}))),videoRenderEpics10:(e,t)=>vr(e,[Da.CurrentDecodeVideoQuality,Da.CurrentDecodeVideoFps]).pipe(At((e=>{const{payload:{type:n,data:r}}=e,{video:{subscriptionStatus:i}}=t.value;if(i.detailed)if(n===Da.CurrentDecodeVideoQuality){const{ssrc:e,width:t,height:n,quality:i}=r;Id(Yu,{userId:e,width:t,height:n,quality:i})}else if(n===Da.CurrentDecodeVideoFps){const{ssrc:e,fps:t}=r;Id(Yu,{userId:e,fps:t})}})),St(ge)),videoRenderEpics11:(e,t)=>yr(e,t).pipe(Ye((async()=>Uo.isAndroidOrIOSBrowser?1:await Ls.isSupportVideoDecodeHardwareAcceleration()?4:1)),Ke((e=>Af(e)))),videoRenderEpics12:(e,t)=>vr(e,Da.NetworkQualityChange).pipe(ht((e=>!!e.payload.data)),Ye((e=>{var n;const{payload:{data:{bwLevel:r,isUplink:i,networkLevel:o}}}=e,s=[],{meeting:{userId:a},video:{networkQuality:u,subscribedVideoList:c,networkQualityBroadcastTime:l}}=t.value,d=i?"uplink":"downlink";s.push(Mf({userId:a,level:o,bwLevel:r,type:d}));const h=di(null===(n=u[`${a}`])||void 0===n?void 0:n[d],{level:o,bwLevel:r});if(h||-1===o||(!i&&c.filter((e=>e!==a)).length>0||i)&&Id(Zu,{userId:a,type:d,level:o}),i){const e=performance.now();(!h||e-(null!=l?l:0)>3e4)&&(iA.broadcastUserNetworkQuality({isUplink:i,level:o,bwLevel:r}),s.push(Kf(e)))}return Me(s)}))),videoRenderEpics13:(e,t)=>mr(e,8005).pipe(ht((e=>{var t;return!(null===(t=e.payload.body)||void 0===t||!t.nUserID)})),Ye((e=>{const{payload:{body:{nLevel:n,nUserID:r}}}=e,{video:{networkQuality:i}}=t.value,o=i[`${r}`],s=[];return o&&o.uplink.level===n||(Id(Zu,{userId:r,level:n,type:"uplink"}),s.push(Mf({userId:r,level:n,type:"uplink"}))),Me(s)}))),videoRenderEpics14:(e,t)=>pr(e,rs).pipe(ht((e=>{const{payload:{body:n}}=e,{video:{prefetchedVideo:r}}=t.value;return(null==r?void 0:r.userId)&&(n.update||n.remove)})),Ye((e=>{const{payload:{body:n}}=e,r=[],{video:{prefetchedVideo:i}}=t.value;let o=!1;return n.remove&&(o=-1!==n.remove.findIndex((e=>e.id===(null==i?void 0:i.userId)))),n.update&&(o=-1!==n.update.findIndex((e=>e.id===(null==i?void 0:i.userId)&&!1===e.bVideoOn))),o&&i&&(i.loaded||oA.cancelPrefetchVideoSsrc(i.userId),iA.unsubscribeVideo(i.userId),r.push(Yf(void 0))),Me(r)}))),videoRenderEpics15:(e,t)=>e.pipe(Ut(`${Yf}`),ht((e=>!!e.payload)),At((e=>{const{payload:{lastCopy:n}}=e,{video:{prefetchedVideo:r}}=t.value;!r||n&&n.userId===r.userId||(null!=n&&n.userId&&(n.loaded&&oA.cancelPrefetchVideoSsrc(n.userId),iA.unsubscribeVideo(n.userId)),iA.subscribeVideo(r.userId,Ka.Video_360P,!1),oA.prefetchVideoSsrc(r.userId))})),St(ge)),videoRenderEpics16:(e,t)=>vr(e,Da.NewActiveSpeakerFirstFrameCallback).pipe(ht((()=>!!t.value.video.prefetchedVideo)),Ye((e=>{const{payload:{data:{ssrc:n}}}=e,{video:{prefetchedVideo:r}}=t.value,i=[];return r&&(hi(r.userId,n)?(i.push(Yf({userId:r.userId,loaded:!0,lastCopy:r})),Id(oc,{userId:r.userId})):iA.unsubscribeVideo(r.userId)),Me(i)}))),videoRenderEpics17:(e,t)=>pr(e,16131).pipe(ht((e=>void 0!==e.payload.body.ssrc)),At((()=>{const{media:{videoDecodeStatus:e,videoEncodeStatus:n}}=t.value;Rv("video",n,e).subscribe((e=>{let[n,r]=e;const{video:{subscriptionStatus:i}}=t.value;n&&i.encode&&oA.subscribeToQos([Ms.VideoEncode],eu),r&&(i.decode&&oA.subscribeToQos([Ms.VideoDecode],eu),i.detailed&&oA.enableVideoObserver(!0))}))})),St(ge)),videoRenderEpics18:(e,t)=>e.pipe(Ut(`${If}`,`${_f}`),ht((()=>{const e=t.value.video.renderedVideoList.length;return[0,1].includes(e)})),At((()=>{const e=t.value.video.renderedVideoList.length;1===e?oA.enableVideoObserver(!0,!0):0===e&&oA.enableVideoObserver(!1)})),St(ge)),videoRenderEpics19:(e,t)=>vr(e,Da.CurrentDecodeVideoQuality).pipe(Ye((e=>{const{payload:{data:n}}=e,{video:{renderedVideoList:r,videoAttachments:i}}=t.value,o=[],{ssrc:s,width:a,height:u}=n,c=u?a/u:0,l=r.filter((e=>hi(e.userId,s)));if(l.some((e=>e.aspectRatio&&Math.abs(e.aspectRatio-c)>.2))){const e=l.filter((e=>e.canvasId===au));if(e.length>0){const e=i[`${s}`];e&&e.every((e=>{if(e){const{clientWidth:t,clientHeight:n}=e,r=n?t/n:0;return Math.abs(r-c)<=.2}return!0}))&&o.push(If({userId:s,key:nu,canvasId:au,aspectRatio:c}))}e.length===l.length&&0!==o.length||Id(ac,{userId:s,aspectRatio:c})}return Me(o)}))),videoRenderEpics20:(e,t)=>vr(e,Da.SyncRendererTypeResponse).pipe(Ye((e=>{const{payload:{data:{rendererType:n}}}=e,{video:{rendererType:r}}=t.value,i=[];return r!==n&&i.push(ig(n)),Me(i)})))},_A=hr(IA,wA,{vbEpics0:e=>vr(e,[Da.VbModelPreloadingOk,Da.VbModelPreloading_3S,Da.VbModelPreloading_10S,Da.VbSettingParaError]).pipe(Ye((e=>{const{payload:{type:t,data:n}}=e,r=[];return[Da.VbModelPreloadingOk,Da.VbModelPreloading_3S,Da.VbModelPreloading_10S].includes(t)?(r.push(Rf(!0)),Id(zu,!0),t===Da.VbModelPreloading_10S&&console.warn("Virtual Background is taking longer than expected to load.")):t===Da.VbSettingParaError&&(n===Qa.VBModelNotMatch?(Id(zu,!1),r.push(Rf(!1))):(Id(Ju,!1),r.push(Of(!1)))),Me(r)}))),vbEpics1:e=>vr(e,Da.StartVideoStreamInVbSettingSuccess).pipe(Ke((()=>(Id(Ju,!0),Of(!0))))),vbEpics2:e=>vr(e,Da.StartVideoStreamInMaskSettingSuccess).pipe(Ke((()=>(Id(rc,!0),$f(!0))))),vbEpics3:e=>vr(e,Da.MaskSettingParaError).pipe(Ke((()=>(Id(rc,!1),$f(!1)))))},EA);class CA{constructor(){this.assetsPath=void 0,this.instance=void 0,this.callbackList=void 0,this.mediaWorkersPath=void 0,this.mediaOptions=void 0,this.inProgress=void 0,this.callbackList=[]}static getInstance(){return void 0===this.agentInstance&&(this.agentInstance=new CA),this.agentInstance}init(e,t){var n,r,i,o,s;if(!this.instance&&window.JsMediaSDK_Instance){const e={ivObj:{[zo.AUDIO_ENCODE]:void 0,[zo.VIDEO_ENCODE]:void 0,[zo.SHARING_ENCODE]:void 0}};this.instance=new window.JsMediaSDK_Instance(e)}this.mediaWorkersPath=Ns(e,!1),this.onMediaSDKCallback=this.onMediaSDKCallback.bind(this),this.mediaOptions=t,null===(n=this.instance)||void 0===n||n.JsMediaSDK_PreLoad(this.mediaWorkersPath,this.onMediaSDKCallback,t);const a=$o(null===(r=this.mediaOptions)||void 0===r?void 0:r.enableMultiDecodeVideoWithoutSAB);null===(i=this.instance)||void 0===i||i.setPropsBeforeInit({callback:this.onMediaSDKCallback,audioWorkerPath:null===(o=this.mediaWorkersPath)||void 0===o?void 0:o.audioWorkletPath,isEnableListenInitEvent:!0}),null===(s=this.instance)||void 0===s||s.initVideoEncode(this.mediaWorkersPath,"",0,!1,"",0,a,!1,!1,!0,!0,!1,!0),this.inProgress=!0}onMediaSDKCallback(e,t){this.callbackList.length>0&&this.callbackList.forEach((n=>n(e,t)))}registerCallback(e){this.callbackList.push(e)}unregisterCallback(e){this.callbackList=this.callbackList.filter((t=>t!==e))}async destroy(){var e;this.callbackList=[],await(null===(e=this.instance)||void 0===e?void 0:e.destroy()),this.instance=null,this.inProgress=!1}disconnect(){var e,t;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(17,{}),null===(t=this.instance)||void 0===t||t.JsMediaSDK_UnInit()}startVirtualBackgroundSetting(e,t,n,r,i,o){var s;let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];null===(s=this.instance)||void 0===s||s.Notify_MeidaSDK(91,{canvas:e,bgdom:t,width:i,height:o,ssid:0,VideoSelectValue:"default"===r?null:r,disableOriginalRatio:a,usingFacingMode:["user","environment"].includes(r)})}updateVirtualBackgroundImage(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(92,{bgdom:e})}stopVirtualBackgroundSetting(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(93,{isSwitch:t})}startMaskSetting(e,t,n,r,i,o,s,a,u){var c;null===(c=this.instance)||void 0===c||c.Notify_MeidaSDK(62,{canvas:e,maskdom:null,bgdom:null,dx:0,dy:0,dWidth:170,dHeight:170,width:1280,height:720,ssid:0,originWidth:379,originHeight:213,VideoSelectValue:"default"===i?null:i,usingFacingMode:["user","environment"].includes(i)})}stopMaskSetting(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(65,{isSwitch:t})}}CA.agentInstance=void 0;const AA="PREVIEW_VIDEO_ENCODE_SUCCESS",TA="PREVIEW_VIDEO_VB_MODEL_READY";async function RA(e,t,n,r){const{imageUrl:i,cropped:o,deviceId:s}=n,a=fi("__ZOOM_SDK_PREVIEW_VIRTUAL_BACKGROUND_CANVAS_@__");t.id||(t.id=a);let[u,c]=[640,360];if(Ls.isSupportSending720P()&&(u=1280,c=720),i&&Vv(r)){const n=await cA(i,o);return e.startVirtualBackgroundSetting(t,n,0,null!=s?s:"default",u,c),n&&n!==Ya&&setTimeout((()=>{Ev(n)}),0),"vb"}return e.startMaskSetting(t,null,null,0,null!=s?s:"default",0,0,0,0),"mask"}class OA{constructor(){this.previewMediaAgent=CA.getInstance(),this.isInit=void 0,this.isVideoEncoded=void 0,this.isVBModelReady=void 0,this.state=void 0,this.eventHandler=(e,t)=>{switch(e){case Da.InitSuccessVideo:t===ka.EncodeSuccess&&(this.isVideoEncoded=!0,Id(AA));break;case Da.VbModelPreloadingOk:case Da.VbModelPreloading_3S:case Da.VbModelPreloading_10S:this.isVBModelReady=!0,Id(TA,!0);break;case Da.VbSettingParaError:t===Qa.VBModelNotMatch&&(this.isVBModelReady=!1,Id(TA,!1))}}}static setMediaOption(e){OA.mediaOption=e}setup(){if(OA.mediaOption){if(Ls.getInstance().inProgress)return Promise.resolve("");if(!CA.getInstance().inProgress){this.isVideoEncoded=void 0,this.isVBModelReady=void 0,this.previewMediaAgent.unregisterCallback(this.eventHandler);const{assetsPath:e,enforceMultipleVideos:t,enforceVirtualBackground:n}=OA.mediaOption,r={...Uv(e,t,n)};this.previewMediaAgent.init(e,r),this.previewMediaAgent.registerCallback(this.eventHandler)}return Promise.resolve("")}return Promise.reject({type:yl,reason:"Cannot preview video with virtual background before `client.init` method."})}async startPreview(e,t){var n;Ls.getInstance().inProgress?RA(Ls.getInstance(),e,t,null===(n=OA.mediaOption)||void 0===n?void 0:n.enforceVirtualBackground):(void 0!==this.isVBModelReady?Me([this.isVBModelReady]):Ad(TA,1)).subscribe((n=>{n&&(this.isVideoEncoded?Me([!0]):Ad(AA,1)).subscribe((()=>{var n;RA(CA.getInstance(),e,t,null===(n=OA.mediaOption)||void 0===n?void 0:n.enforceVirtualBackground).then((n=>{this.state={mode:n,canvas:e,vb:t}}))}))}))}async stopPreview(){var e;Ls.getInstance().inProgress?Ls.getInstance().stopVirtualBackgroundSetting():"vb"===(null===(e=this.state)||void 0===e?void 0:e.mode)?CA.getInstance().stopVirtualBackgroundSetting():CA.getInstance().stopMaskSetting()}async updatePreview(e,t){const n=Ls.getInstance().inProgress?Ls.getInstance():CA.getInstance();var r;if(e)if("mask"===(null===(r=this.state)||void 0===r?void 0:r.mode)){var i;Uo.isChrome?(await this.stopPreview(),await this.startPreview(this.state.canvas,{imageUrl:e,cropped:t,deviceId:null===(i=this.state.vb)||void 0===i?void 0:i.deviceId})):console.warn('use the `start` method with the virtual background image parameter instead of using `updateVirtualBackground` to preview the video." ')}else{const r=await cA(e,t);r&&(n.updateVirtualBackgroundImage(r),r!==Ya&&setTimeout((()=>{Ev(r)}),0))}else n.updateVirtualBackgroundImage(null)}}OA.mediaOption=void 0;const{InitSuccessVideo:PA,InitSuccessAudio:DA,InitSuccessSharing:kA,InitFailedVideo:xA,InitFailedAudio:NA,InitFailedSharing:MA}=Da,FA=nb(Ls.getInstance()),LA=YS.getInstance().makeLogger(["Media Agent"]),VA=[_v,Av,Cv].map((e=>bv(e,{hostname:!0}))),BA=[],jA={epics0:(e,t)=>e.pipe(Ut(`${Bi}`),It((()=>{const{meeting:{isMeetingReset:n}}=t.value;return e.pipe(Ut(`${Gi}`),gt(1),ey((e=>{var r;const{logger:i,media:{mediaConstraints:o,assetsPath:s},meeting:{zlkJwtToken:a,cv:u}}=t.value,{payload:{disableAqos:c,disableVqos:l}}=e,d=null!=i&&null!==(r=i.options)&&void 0!==r&&r.enable?YS.getInstance().makeLogger(["MEDIA SDK"]):void 0;return function(e){const{media:{patchedMediaSDKStatus:t}}=e;return t===_u.Loading?Be(Ad(Ll,1)):Promise.resolve()}(t.value).then((()=>{const e=[];let t=!l;const r=!c;return a&&ci(u,"1.3.0")<0&&(t=!1),e.push(ir({audioQos:r,videoQos:t})),FA.init(function(e){return e?new Proxy(e,{get:(e,t)=>"string"==typeof t&&"error"===t?function(){try{var e;ZS.report(arguments.length<=0?void 0:arguments[0],["MEDIA SDK",...null!==(e=arguments.length<=1?void 0:arguments[1])&&void 0!==e?e:[]],"error")}catch(e){}}:Reflect.get(e,t)}):e}(d)),e.push(ar(!0)),n&&void 0!==o&&void 0!==s&&e.push($n()),e}))})))}))),epics1:(e,t)=>e.pipe(Ut(`${Bi}`),ht((e=>{const{payload:{mediaSDKPath:n}}=e,{media:{skipJsMedia:r,patchJsMedia:i,assetsPath:o},meeting:{isMeetingReset:s}}=t.value;return!r&&VA.some((e=>new RegExp(`^https://${e}`).test(null!=o?o:"")))&&!!i&&!!n&&!s})),It((e=>{const{payload:{mediaSDKPath:t}}=e,n=vi(t);return Me(new Promise(((e,t)=>{const r=`${n}/${wo}`;"JsMediaSDK_Instance"in window&&(window.JsMediaSDK_Instance_backup=window.JsMediaSDK_Instance,delete window.JsMediaSDK_Instance),Sv(r,(()=>{"JsMediaSDK_Instance_backup"in window&&delete window.JsMediaSDK_Instance_backup,LA.info(`patched media sdk url:${r}`),e("")}),(()=>{"JsMediaSDK_Instance_backup"in window&&(window.JsMediaSDK_Instance=window.JsMediaSDK_Instance_backup,delete window.JsMediaSDK_Instance_backup),LA.error(`cannot load patched media sdk :${r}`),t()}))}))).pipe(Ye((()=>(Id(Ll),Me([nr(_u.Done),rr(n)])))),ft((()=>(Id(Ll),Me([nr(_u.Done)])))),wt(nr(_u.Loading)))}))),epics2:(e,t)=>yr(e,t).pipe(At((()=>{const{media:{assetsPath:e,mediaConstraints:n,fileWithVersion:r,enforceMultipleVideos:i,enforceVirtualBackground:o,isEnableDecoderInWorklet:s},meeting:{isAudioBridgeEnabled:a}}=t.value;if(FA.notifySDKMeetingReady(),e&&n){const t={enableDecoderInWorklet:s,enableAudioBridge:a&&Ho()};Object.assign(t,Uv(e,i,o)),FA.setAssetsAndConstraint(e,n,r,t)}Ov(t).pipe(It((e=>Me($v.acquire().then((()=>e)))))).subscribe((e=>{const{meeting:{svcUrl:n,meetingNumber:r,conId:i,e2eEncrypt:o,userId:s,isWebinar:a,enableWebtransport:u,webtransportPort:c},media:{enableAudioQos:l,enableVideoQos:d,alternativeNameForVideoPlayer:h,adaptedABOptionForMediaSDK:p},video:{rendererType:f}}=t.value;e&&(FA.connect({svcUrl:n,meetingNumber:r,conId:i,e2eEncrypt:o,isViewOnly:eh(e.userRole),currentUserId:s,isWebinar:a,enableAudioQos:l,enableVideoQos:d,enableWebtransport:u,webtransportPort:c,rendererType:f,adaptedABOptionForMediaSDK:p}),function(e){var t;let n="video-player";e.tagName&&(n=e.tagName,Pw.dispatch("",{tagName:e.tagName}),Gw(null===(t=e.mediaSDK)||void 0===t?void 0:t.call(e),`VPTN:${n}`));const r=`${n}-container`,i=e.sessionId||qw();Pw.get("mediaSDKInstanceMap").set(xw,e.mediaSDK),Pw.get("mediaSDKInstanceMap").set(i,e.mediaSDK),e.failover&&Pw.dispatch("failover",void 0,e.sessionId||xw),customElements.get(r)||customElements.define(r,fI),customElements.get(n)||customElements.define(n,dI)}({mediaSDK:()=>FA.instance,tagName:h,failover:"1"}))}))})),It((()=>st((e=>FA.registerCallback(e)),(e=>FA.unregisterCallback(e)),((e,t)=>({type:e,data:t}))).pipe(Ke((e=>Wn(e))))))),epics3:e=>vr(e,[PA,DA,kA,xA,NA,MA]).pipe(Xv((e=>{const{payload:{type:t,data:n}}=e;if(t===DA||t===NA){if(n===ka.EncodeSuccess)return Id(_l),Fe(Gn("success"));if(n===ka.DecodeSuccess)return Id(Cl),Fe(zn("success"));if(n===ka.EncodeFailed)return Id(Pl),Fe(Gn("failed"));if(n===ka.DecodeFailed)return Id(Dl),Fe(zn("failed"))}else if(t===PA||t===xA){if(n===ka.EncodeSuccess)return Id(Al),Fe(Jn("success"));if(n===ka.DecodeSuccess)return Id(Tl),Fe(Qn("success"));if(n===ka.EncodeFailed)return Id(kl),Fe(Jn("failed"));if(n===ka.DecodeFailed)return Id(xl),Fe(Qn("failed"))}else if(t===kA||t===MA){if(n===ka.EncodeSuccess)return Id(Rl),Fe(Yn("success"));if(n===ka.DecodeSuccess)return Id(Ol),Fe(Zn("success"));if(n===ka.EncodeFailed)return Id(Nl),Fe(Yn("failed"));if(n===ka.DecodeFailed)return Id(Ml),Fe(Zn("failed"));if(t===kA&&void 0===n)return Id(Ol),Fe(Zn("success"))}}))),epics4:(e,t)=>vr(e,[PA,DA]).pipe(It((()=>"object"==typeof navigator.mediaDevices?ct(Dv(),ct(vr(e,Da.StartVideoCaptureSuccess),it(navigator.mediaDevices,"devicechange"),vr(e,Da.UserGrantCaptureAudio).pipe(ht((()=>!t.value.audio.isUserGrantCaptureAudio)))).pipe(Ye((()=>Dv().pipe(At((()=>{setTimeout((()=>{Id(Fl)}),50)}))))))).pipe(Tt(t),Ye((e=>{let[t,n]=e;const r=[jh(t.microphones),Uh(t.speakers),uf(t.cameras)];if(n.audio){const{audio:{activeMicrophone:e,activeSpeaker:s,microphoneDevicesList:a,speakerDevicesList:u}}=n,c=gh(n),{microphones:l,speakers:d}=t,h=a.filter((e=>-1===l.findIndex((t=>t.deviceId===e.deviceId)))),p=u.filter((e=>-1===d.findIndex((t=>t.deviceId===e.deviceId))));if(h.length>0){if(qv(h[0],e,a)){const e=Kv(l);FA.changeMicrophone("default",null==e?void 0:e.label,!(null==c||!c.muted)),r.push(Hh("default"))}}else if("default"===e){const e=Kv(a),t=Kv(l);a.length>0&&(null==e?void 0:e.label)!==(null==t?void 0:t.label)&&FA.changeMicrophone("default",null==t?void 0:t.label,!(null==c||!c.muted))}var i,o;p.length>0?qv(p[0],s,u)&&(FA.changeSpeaker("default"),r.push(qh("default"))):"default"===s&&u.length>0&&(null===(i=Kv(u))||void 0===i?void 0:i.label)!==(null===(o=Kv(d))||void 0===o?void 0:o.label)&&FA.changeSpeaker("default")}return Me(r)}))):ge))),epics5:(e,t)=>mr(e,rs).pipe(At((e=>{const{type:n,payload:{body:r}}=e,i=n===`${Vn}`;if(r.add){const e=r.add.map((e=>({userid:e.id,sn:e.zoomID&&ai(e.zoomID)})));if(!i){const{meeting:{gcmSessinKey:n}}=t.value;FA.sendUserNodeList(e,n)}FA.updateUserMediaSN({added:e,isFromMainSession:i,iVType:zo.SHARING_DECODE}),i&&FA.updateUserMediaSN({added:e,isFromMainSession:i,iVType:zo.AUDIO_DECODE})}if(r.remove&&r.remove.length>0){if(!i){const{meeting:{gcmSessinKey:e}}=t.value;FA.sendUserNodeList(r.remove.map((e=>({userid:e.id,bremove:!0}))),e)}FA.updateUserMediaSN({removed:r.remove.map((e=>e.id)),isFromMainSession:i,iVType:zo.SHARING_DECODE}),i&&FA.updateUserMediaSN({removed:r.remove.map((e=>e.id)),isFromMainSession:i,iVType:zo.AUDIO_DECODE})}})),St(ge)),epics6:e=>vr(e,Da.AesGcmIvResponse).pipe(At((e=>{const{payload:{data:{workerType:t,iv:n}}}=e,r=Do.get(ko.WebclientIVState);if(r){const e={...r,[t]:n};Do.set(ko.WebclientIVState,e,Oo.SessionStorage)}})),St(ge)),epics7:e=>e.pipe(Ut(`${xn}`),ht((e=>[os,ss,ns].includes(e.payload.evt))),Ke((e=>{const{payload:{evt:t,body:{encryptKey:n,additionalType:r}}}=e;return er({type:t===os?"audio":t===ss?"video":"sharing",encryptKey:n,additionalType:r})}))),epics8:e=>e.pipe(Ut(`${Xn}`),At((e=>{const{payload:t}=e;OA.setMediaOption({assetsPath:t.assetsPath,enforceMultipleVideos:t.enforceMultipleVideos,enforceVirtualBackground:t.enforceVirtualBackground})})),St(ge)),epics9:e=>e.pipe(Ut(`${ki}`,`${Di}`),At((()=>{CA.getInstance().inProgress&&(CA.getInstance().disconnect(),$v.watch(CA.getInstance().destroy()))})),St(ge)),epics10:e=>e.pipe(Ut(`${ki}`,`${Di}`),It((()=>"permissions"in navigator?["microphone","camera"].map((e=>{navigator.permissions.query({name:e}).then((t=>{const n=()=>{Id(jl,{name:e,state:t.state})};n(),t.addEventListener("change",n),BA.push((()=>{t.removeEventListener("change",n)}))})).catch((()=>{}))})):ge)),St(ge)),epics11:e=>e.pipe(Ut(`${ro}`),ht((e=>e.payload===Co.Closed)),At((()=>{BA.length>0&&(BA.forEach((e=>e())),BA.length=0)})),St(ge))},UA=hr(jA),HA={meeting:zE,socket:vw,participants:Cw,media:Ow},qA=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Lt;function KA(e){return function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];"function"==typeof e[i]&&(n[i]=e[i])}var o,s=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:Mt.INIT}))throw new Error(kt(12));if(void 0===n(void 0,{type:Mt.PROBE_UNKNOWN_ACTION()}))throw new Error(kt(13))}))}(n)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var r=!1,i={},a=0;a<s.length;a++){var u=s[a],c=n[u],l=e[u],d=c(l,t);if(void 0===d)throw t&&t.type,new Error(kt(14));i[u]=d,r=r||d!==l}return(r=r||s.length!==Object.keys(e).length)?i:e}}({...HA,...e})}function $A(e,t,n,r,i){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}const WA=Symbol("store"),GA=Symbol("getState"),zA=Symbol("dispatch"),JA=Symbol("additionFeatures"),QA=Symbol("mediaContext");function YA(e,t,n){const r=n.value;n.value=function(){const e=this[WA];if(e){const{meeting:{isOnHold:t,isMeetingReset:n,meetingStatus:r}}=e.getState();if(r!==Co.Joined)return Promise.reject({type:wl,reason:"closed"});if(n)return Promise.reject({type:wl,reason:"reconnecting"});if(t)return Promise.reject({type:wl,reason:"on hold"})}for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.apply(this,n)}}function ZA(e,t,n){const r=n.value;n.value=function(){const e=this[WA];if(e){const t=e.getState();if(!mh(t))return Promise.reject({type:El,reason:"only host or co-host can do the operation"})}for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.apply(this,n)}}function XA(e,t,n){const r=n.value;n.value=function(){const e=this[WA];if(e){const t=e.getState();if(!vh(t))return Promise.reject({type:El,reason:"only host can do the operation"})}for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.apply(this,n)}}function eT(e){return function(t,n,r){const i=r.value;r.value=function(){const t=this[WA];if(t&&void 0===t.getState()[e])return Promise.reject({type:yl,reason:`Module:${e} is not enabled`});for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return i.apply(this,r)}}}function tT(e){return function(t,n,r){const i=r.value;r.value=function(){const t=this[WA];if(t){const{meeting:{meetingOptions:n}}=t.getState();if(!0===n[e])return Promise.reject({type:"OPERATION_LOCKED",reason:`${e} is locked`})}for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return i.apply(this,r)}}}let nT=function(e){return e.Self="Self",e.Other="Other",e.Client="Client",e.Phone="Phone",e.Attendee="Attendee",e}({});function rT(e){return function(t,n,r){const i=r.value;r.value=function(t){const n=this[WA];if(n){const r=n.getState(),i=Array.isArray(e)?e:[e];let o=bh(r).find((e=>e.userId===t));if(i.findIndex((e=>e===nT.Attendee))>-1&&(o=yh(r).find((e=>e.userId===t))),!o)return Promise.reject({type:Il,reason:"no matching user"});{const{meeting:{userId:e}}=n.getState();for(let n=0;n<i.length;n++){const r=i[n];if(r===nT.Other&&t===e)return Promise.reject({type:yl,reason:"operation is not applicable to self"});if(r===nT.Self&&t!==e)return Promise.reject({type:yl,reason:"operation is only applicable to self "});if(r===nT.Client&&Zd(o.userType)||r===nT.Phone&&!Zd(o.userType))return Promise.reject({types:yl,reason:"improper target client"})}}}for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];const a=[t,...o];return i.apply(this,a)}}}const iT=YS.getInstance();function oT(e,t){return function(n,r,i){const o=i.value;i.value=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];if(iT.checkLaplace())try{var a;const n=iT.makeLogger([e]),s=null===(a=t?i.map(((e,n)=>t.includes(n+1)?GS(e):e)):i)||void 0===a?void 0:a.map((e=>Ei(e)));return n.info(`${r},params:${JSON.stringify(s)}`),o.apply(this,i).then((e=>(n.info(`${r} success`),e))).catch((t=>{let n=`${r},params:${JSON.stringify(s)},return failed,`;return"object"==typeof t&&(n=`${n},${t.type?`type:${t.type},`:""}${t.reason?`reason:${t.reason}`:""}`),iT.report(n,`${e} exception flow`,"error"),Promise.reject(t)}))}catch(e){}return o.apply(this,i)}}}function sT(e,t,n){return function(r,i,o){const s=o.value;o.value=function(){for(var r,i,o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];const c=a[t];let l=e;return Array.isArray(l)||(l=[l]),!l.some((e=>c instanceof e))||n&&!n.every((e=>!!c[e]))?Promise.reject({type:Il,reason:`Expected to accept ${null===(r=l)||void 0===r?void 0:r.map((e=>e.name)).join(" or ")}, but actual it is ${"object"==typeof c&&null!==c?null===(i=Object.getPrototypeOf(c))||void 0===i?void 0:i.constructor.name:c}`}):s.apply(this,a)}}}class aT{constructor(e){this[WA]=void 0,this[zA]=void 0,this[GA]=void 0,this[JA]=void 0,this[WA]=e,this[zA]=e.dispatch,this[GA]=e.getState}}const uT=["userId","displayName","audio","isHost","avatar","bRaiseHand","bHold","bVideoOn","sharerOn","sharerPause","feedback","bLocalRecord","strPronoun","sdkKey","audioConnectionStatus","caps","bAllowISORecord","bVideoConnect","userIdentity","isSpeakerOnly","bVideoShare","bShareAudioOn","bShareToBORooms","bid",{from:"bInFailover",to:"isInFailover"},{from:"userGUID",to:"userGuid"},{from:"bGuest",to:"isGuest"},{from:"sharerPause",to:"sharePause"},{from:"bCoHost",to:e=>({isCoHost:!!e})},{from:"muted",to:(e,t)=>({muted:null!=t&&t.isSpeakerOnly||""===(null==t?void 0:t.audio)?void 0:e})},{from:"userType",to:(e,t)=>{const n=Zd(e),r={isPhoneUser:n};return n&&null!=t&&t.phoneNumber&&Object.assign(r,{phoneNumber:t.phoneNumber}),r}}];function cT(e){return uT.reduce(((t,n)=>{const r="string"==typeof n?n:n.from,i=function(e,t,n){if("string"==typeof e)return{[`${e}`]:t};if("object"==typeof e&&void 0!==e.from){const{to:r}=e;return"string"==typeof r?{[`${r}`]:t}:r(t,n)}}(n,e[r],e);return{...t,...i}}),{})}function lT(){const{isSupportAudioWorklet:e,isSupportEssentialAudioAndVideoAbility:t,isAndroidOrIOSBrowser:n,isSupportSendScreenSharing:r}=Uo;return{audio:t&&e||n,video:t&&void 0!==navigator.mediaDevices&&void 0!==navigator.mediaCapabilities,screen:t&&r}}const dT=e=>{let{breakoutRoom:{mainSessionAttendeeList:t}}=e;return t},hT=e=>{let{meeting:{zoomId:t}}=e;return t},pT=e=>{let{breakoutRoom:{isHugeBO:t}}=e;return t},fT=Kd([e=>{let{breakoutRoom:{controlStatus:t}}=e;return t},e=>{let{breakoutRoom:{currentRoom:{status:t}}}=e;return t},e=>{let{breakoutRoom:{currentRoom:{boId:t}}}=e;return t}],((e,t,n)=>!(e!==nh.InProgress&&e!==nh.Closing||t!==ih.InRoom&&t!==ih.TimeUp||!n))),gT=Kd([e=>{let{breakoutRoom:{rooms:t}}=e;return t},$d,hT,dT,fT,pT],((e,t,n,r,i,o)=>{const s=e.reduce(((e,t)=>{const{attendeeGuidList:n}=t;return e.concat(n)}),[]);return(i?r:t).filter((e=>!e.bHold&&!e.isHost&&e.zoomID!==n&&!e.bid&&!s.includes(e.userGUID)&&(!o||ay(e.caps))))})),mT=Kd([fT,dT,$d,hT,pT],((e,t,n,r,i)=>(e?t:n).filter((e=>!e.bHold&&!e.isHost&&e.zoomID!==r&&!e.bid&&(!i||ay(e.caps)))))),vT=Kd([fT,dT,bh],((e,t,n)=>e?t.find((e=>e.isHost)):n.find((e=>e.isHost))));var yT,ST,bT,ET;const wT=Ps.createAgent();let IT=(yT=rT(nT.Other),ST=rT(nT.Other),bT=rT(nT.Other),ET=class extends aT{constructor(e){super(e),this.modules=void 0,this.useSDK=void 0,this.useSDK=!1,this.modules=new Map}initWithSDK(e,t,n){return this.useSDK=!0,this.init(e,t,n)}init(e,t,n){const{audio:r,video:i}=lT();if(!r||!i)return console.error("https://developers.zoom.us/docs/video-sdk/web/browser-support"),Promise.reject({type:yl,reason:"Please update to the latest Chrome, Edge, Safari, or Firefox, as your current browser doesn't support audio/video. Retry after the upgrade."});const{[zA]:o,[WA]:s}=this;let a=Cv;const u=(null==n?void 0:n.fileWithVersion)||!1;let c="en-US",l=`${Cv}/${wo}`;if(n){const{dependentAssets:e,additionalFeatures:t,constraints:r,language:i,webEndpoint:o}=n;i&&(c=i),o&&function(e){wv=bv(e,{hostname:!0})}(o),e===Io.CDN||e===_v?(a=_v,l=`${_v}/${wo}`):e===Io.Global||e===Cv?(a=Cv,l=`${Cv}/${wo}`):e===Io.CN||e===Av?(a=Av,l=`${Av}/${wo}`):e&&/^https?:\/\//.test(e)&&(a=vi(e),l=u?`${a}/1506_js_media.min.js`:`${a}/${wo}`),t&&Array.isArray(t)&&t.forEach((e=>{if(this[JA][e]&&void 0===s.getState()[e]){const{epic:t,reducer:n,Client:r}=this[JA][e];s.injectReducer(e,n),s.injectEpic(t);const i=new r(s);this.modules.set(e,i)}})),null!=r&&r.audio&&void 0===s.getState().audio&&(s.injectReducer("audio",LI),s.injectEpic(jI)),null!=r&&r.video&&void 0===s.getState().video&&(s.injectReducer("video",bA),s.injectEpic(_A)),null!=r&&r.screen&&void 0===s.getState().share&&(s.injectReducer("share",fE),s.injectEpic(vE))}return o(Hi({apiKey:e,signature:t,language:c,useSDK:this.useSDK})),o(Xn({mediaConstraints:n&&n.constraints||{},assetsPath:a,fileWithVersion:u,enforceMultipleVideos:null==n?void 0:n.enforceMultipleVideos,enforceVirtualBackground:null==n?void 0:n.enforceVirtualBackground,skipJsMedia:null==n?void 0:n.skipJsMedia,patchJsMedia:null==n?void 0:n.patchJsMedia,alternativeNameForVideoPlayer:null==n?void 0:n.alternativeNameForVideoPlayer})),void 0!==(null==n?void 0:n.stayAwake)&&o(fo(n.stayAwake)),void 0!==(null==n?void 0:n.quicklyLeaveMeeting)&&o(yo(n.quicklyLeaveMeeting)),new Promise(((e,t)=>{null!=n&&n.skipJsMedia?e(""):Sv(l,(()=>{e("")}),(()=>{t({type:Il,reason:"dependent assets are not accessible"})}))}))}on(e,t){((e,t)=>{const n=Sd[e];if(n){const r=Ed.get(e);if(r)r.push(t),Ed.set(e,r);else{const r=[t];Ed.set(e,r);const i=ct(...n.map((e=>{const{event:t,payload:n}=e;return it(bd,t).pipe(Ke((e=>n(e))),ke(le))}))).subscribe((t=>{const n=Ed.get(e);n&&n.forEach((e=>{e(t)}))}));wd.push(i)}}})(e,t)}off(e,t){((e,t)=>{if(Sd[e]){const n=Ed.get(e);if(Array.isArray(n)){const r=n.filter((e=>e!==t));Ed.set(e,r)}}})(e,t)}getFeatureModule(e){return this.modules.get(e)}leave(){const{[GA]:e,[zA]:t}=this;return"connected"===e().socket.zoomSocketStatus?t(Mi()):t(Fi()),Be(at(500).pipe(mt("")))}end(){const{[GA]:e,[zA]:t}=this;return"connected"===e().socket.zoomSocketStatus?(t(Li()),Be(at(500).pipe(At((()=>{Td()})),mt("")))):Promise.resolve("")}changeName(e,t){const n=this[WA].getState(),{meeting:{bAllowAttendeeRename:r}}=n,i=gh(n),o=eh(i.userRole),s=mh(n);if(o)return Promise.reject({type:El});if(t&&t!==(null==i?void 0:i.userId)){if(s){const{participants:{attendeesList:r}}=n,i=r.find((e=>e.userId===t));if(i)return wT.rename(t,ri(e),ri(i.displayName)),Jv({userId:t,key:"displayName"},(t=>t.displayName===e));{const r=yh(n).find((e=>e.userId===t));if(r){const t=EE.getInstance();return wT.rename(r.userId,ri(e),ri(r.displayName)),t.rename(r.jid,e),Cd(qs,(t=>{const n=t.find((e=>e.jid===r.jid));return n&&n.displayName===e}))}return Promise.reject({type:Il,reason:"no matching user"})}}return Promise.reject({type:El})}return e===i.displayName?Promise.resolve():s||r?(wT.rename(i.userId,ri(e),ri(i.displayName)),Cd(Bs,(t=>t.displayName===e))):Promise.reject({type:El,reason:"host disallow rename themselves"})}makeHost(e){return wT.assignHost(e,!1),Jv({userId:e,key:"isHost"},(e=>!0===e.isHost))}makeCoHost(e){const t=this[WA].getState(),n=bh(t).find((t=>t.userId===e));return!0===(null==n?void 0:n.bCoHost)?Promise.reject({type:Il,reason:`user:[${e}] is already co-host `}):(wT.assignHost(e,!0),Jv({userId:e,key:"bCoHost"},(e=>!0===e.bCoHost)))}revokeCoHost(e){const t=this[WA].getState(),n=bh(t).find((t=>t.userId===e));return!1===(null==n?void 0:n.bCoHost)?Promise.reject({type:Il,reason:`user:[${e}] is not a co-host`}):(wT.revokeCoHost(e),Jv({userId:e,key:"bCoHost"},(e=>!1===e.bCoHost)))}reclaimHost(){const e=this[GA](),{meeting:{isOriginHost:t}}=e,n=gh(e);return null!=n&&n.isHost?Promise.resolve(""):t?(wT.reclaimHost(n.userId,!1),Cd(Bs,(e=>!0===e.isHost))):Promise.reject({type:El,reason:"You are not the origin host"})}isHost(){const e=this[WA].getState(),t=gh(e);return!!t&&t.isHost}isCoHost(){const e=this[WA].getState(),t=gh(e);return!!t&&!!t.bCoHost}isOriginHost(){const{meeting:{isOriginHost:e}}=this[GA]();return e}getCurrentUserInfo(){const e=this[WA].getState(),t=gh(e);if(t){const n=cT(t);if(e.meeting.isWebinar&&eh(t.userRole)){const{audio:t}=e,r=null==t?void 0:t.isAllowToTalk;Object.assign(n,{isAllowToTalk:r})}if(e.breakoutRoom&&fT(e)){const{breakoutRoom:{currentRoom:{boId:t}}}=e;Object.assign(n,{bid:t})}return n}return null}getParticipantsList(){const e=this[WA].getState(),{meeting:{meetingStatus:t}}=e,n=gh(e);if(t===Co.Joined&&n&&!n.bHold){var r,i;const t=e.breakoutRoom&&fT(e)?null===(r=e.breakoutRoom)||void 0===r||null===(i=r.currentRoom)||void 0===i?void 0:i.boId:"";return bh(e).map((e=>{const n=cT(e);return t&&Object.assign(n,{bid:t}),n}))}return[]}getAssistantsList(){const e=this[WA].getState(),{meeting:{meetingStatus:t}}=e,n=gh(e);return t===Co.Joined&&n?Eh(e).map((e=>({userId:e.userId,displayName:e.displayName,isNewAst:!0}))):[]}getMeetingHost(){var e;const t=this[GA]();let n=wh(t);return n||(null===(e=t.breakoutRoom)||void 0===e?void 0:e.currentRoom.status)!==ih.InRoom||(n=t.breakoutRoom.mainSessionAttendeeList.find((e=>e.isHost))),void 0!==n?cT(n):null}getMeetingInfo(){const{meeting:{meetingStatus:e,isOnHold:t,meetingNumber:n,passWord:r,userName:i,userEmail:o,meetingTopic:s,meetingOptions:a,encType:u,region:c,network:l,topic:d,zlkJwtToken:h,userId:p,lang:f,inviteEmail:g,meetingId:m,participantID:v,h323Password:y,recordingDisclaimer:S,recordingDisclaimerForRecorder:b,wrInfo:E,meetingInfo:w,isNewJoinFlow:I,chatModerationPolicy:_}}=this[GA](),C=e===Co.Joined&&!t;if(h)return{topic:d,password:r,userName:i,isInMeeting:C,userId:p,meetingId:m};{let e="";return 0===u?e="None":1===u?e="AES ECB":2===u&&(e="AES GCM"),{meetingNumber:n,password:r,userName:i,userEmail:o,inviteEmail:g,meetingTopic:s,encryptionType:e,region:c,network:l,isInMeeting:C,userId:p,lang:f,webEndpoint:Tv(),meetingId:m,participantId:v,telPwd:y,recordingInfo:{recordingDisclaimer:S,recordingDisclaimerForRecorder:b,isUserEnableRecordingReminder:null==a?void 0:a.isUserEnableRecordingReminder},wrInfo:Object.assign({},E,{isNew:I}),scheduleInfo:w,chatModerationPolicy:_}}}},$A(ET.prototype,"end",[XA,YA],Object.getOwnPropertyDescriptor(ET.prototype,"end"),ET.prototype),$A(ET.prototype,"changeName",[YA],Object.getOwnPropertyDescriptor(ET.prototype,"changeName"),ET.prototype),$A(ET.prototype,"makeHost",[yT,XA,YA],Object.getOwnPropertyDescriptor(ET.prototype,"makeHost"),ET.prototype),$A(ET.prototype,"makeCoHost",[ST,XA,YA],Object.getOwnPropertyDescriptor(ET.prototype,"makeCoHost"),ET.prototype),$A(ET.prototype,"revokeCoHost",[bT,XA,YA],Object.getOwnPropertyDescriptor(ET.prototype,"revokeCoHost"),ET.prototype),$A(ET.prototype,"reclaimHost",[YA],Object.getOwnPropertyDescriptor(ET.prototype,"reclaimHost"),ET.prototype),ET);const _T=Ps.createAgent(),CT=EE.getInstance(),AT=(e,t,n)=>{const r=null==t?void 0:t.userId;if(null==e||!e.zoomID||null==t||!t.displayName||r===e.userId)return{type:Il,reason:"invalid target user"};const{chat:{chatPrivilege:i,panelistChatPrivilege:o},meeting:{isWebinar:s}}=n,a=mh(n),u=t.isHost||t.bCoHost;let c=!1;if(!a){if(s)if(eh(e.userRole))(i===ds.NoAttendee||i===ds.AllPanelist&&r!==ps.Panelist||i===ds.All&&r!==ps.All&&r!==ps.Panelist)&&(c=!0);else{const e=eh(null==t?void 0:t.userRole);(o===hs.Invalid||o===hs.AllPanelist&&(e||r===ps.All))&&(c=!0)}else(i===ds.NoAttendee||i===ds.Host&&!u||r===ps.SilentModeUsers||i===ds.EveryonePublicly&&r!==ps.All&&!u)&&(c=!0);if(c)return{type:El,reason:"Insufficient chat privilege"}}return null};function TT(e,t){if(t===ps.All)return bs;if(t===ps.Panelist)return Es;if(t===ps.SilentModeUsers)return ws;{const{meeting:{isWebinar:n},participants:{xmppAttendeeList:r,attendeesList:i}}=e;return n?i.find((e=>e.userId===t))||r.find((e=>e.userId===t)):i.find((e=>e.userId===t))}}function RT(e,t,n){if(null!=n&&n.host)return[wh(e),...Ih(e)].filter((e=>(null==e?void 0:e.userId)!==t)).map((e=>({userId:null==e?void 0:e.userId,displayName:null==e?void 0:e.displayName,isHost:null==e?void 0:e.isHost,isCoHost:null==e?void 0:e.bCoHost})));{let r=[wh(e),...Ih(e),...e.participants.attendeesList.filter((e=>!(e.bCoHost||e.isHost||e.bHold)))];if(null!=n&&n.includeAttendee){const t=yh(e).filter((e=>!Zd(e.userType)));r=[...r,...t]}return r.filter((e=>void 0!==e&&e.userId!==t)).map((e=>({userId:null==e?void 0:e.userId,displayName:null==e?void 0:e.displayName,isHost:null==e?void 0:e.isHost,isCoHost:null==e?void 0:e.bCoHost})))}}function OT(e){const{text:t,destId:n,sn:r,attendeeId:i}=e;return es.beginEncrypt({text:t,type:Qo.RWG_CHAT}).then((e=>{_T.chat(e,n,r,i)}))}function PT(e,t){const{chat:{chatHistory:n}}=t;return n.find((t=>{var n,r;return(null===(n=t.file)||void 0===n||null===(r=n.upload)||void 0===r?void 0:r.uniqueId)===e}))}function DT(e,t){const{meeting:{isWebinar:n},participants:{attendeesList:r}}=t,{destNodeID:i,senderName:o,attendeeNodeID:s}=e,a=r.find((e=>e.userId===i)),u=e.sn?e.sn:null==a?void 0:a.zoomID,c=o?ii(o):null==a?void 0:a.displayName;let l,d="";if(s===ps.SilentModeUsers)return{sender:{name:"Host",userId:i},receiver:{name:"Everyone (in Waiting Room)",userId:s},timestamp:(new Date).getTime()};if(s===ps.All)d=n?"All panelists and attendees":"Everyone";else if(s===ps.Panelist)d="All panelists";else{if(n){const e=yh(t).find((e=>e.userId===s));e&&(d=e.displayName)}if(!d){const e=r.find((e=>e.userId===s));e&&(d=e.displayName,l=e.userGUID)}}return{sn:u,sender:{name:c,userId:i,userGuid:null==a?void 0:a.userGUID,avatar:null==a?void 0:a.avatar},receiver:{name:d,userId:s,userGuid:l},timestamp:(new Date).getTime()}}function kT(e){var t;const[n]=e.split(".").reverse();return null!==(t=Ts[n])&&void 0!==t?t:""}function xT(e,t){const n=[];for(let r=e.length-1;r>=0;r--){const i=e[r];if(!i.file&&(!i.id&&i.sender.userId===t.userId&&[ps.All,ps.Panelist,ps.IndividualCcPanelist,t.destNodeID].includes(i.receiver.userId)&&n.unshift(i),i.id))break}return n.length>0?n[0]:null}const NT=YS.getInstance(),MT=NT.makeLogger(["File Transfer"]);function FT(e,t,n){const{name:r,size:i}=e,{meeting:{reportDomain:o,svcUrl:s,conId:a}}=n;return`https://${o}${t}?${new URLSearchParams({filename:r,filesize:i,rwg:s,cid:a}).toString()}`}function LT(e,t){return t.fileObj?`${e}/zoomfile/download?objkey=${t.fileObj}`:`${e}/file/${t.fileID}`}function VT(e,t){return{fileName:e.name,fileSize:e.size,receiverId:null==t?void 0:t.userId,receiverGuid:null==t?void 0:t.userGuid}}function BT(e,t,n){NT.report(`${e}. file name:${GS(t.name)},file size:${t.size}, ${"type"in t?`file type:${t.type}`:""}, error:${n.name};${n.message}`,["File Transfer"])}function jT(e){var t,n,r;return{id:e.id,fileName:null===(t=e.file)||void 0===t?void 0:t.name,fileSize:null===(n=e.file)||void 0===n?void 0:n.size,fileUrl:null===(r=e.file)||void 0===r?void 0:r.fileUrl,senderId:e.sender.userId,senderGuid:e.sender.userGuid}}function UT(e,t,n){return new Promise(((r,i)=>{const o=new FileReader;o.readAsArrayBuffer(e.slice(t,n)),o.onload=e=>{var t;return r(null===(t=e.target)||void 0===t?void 0:t.result)},o.onerror=e=>i(e)}))}async function HT(e,t){let[n,r]=[e.size,0];null!=t&&(n=Math.min(_s.ChunkSize,e.size-t),r=t);const i=e.size-r<=_s.ChunkSize,o=Math.ceil(n/_s.EncodeBlockSize);try{return function(e){const t=e.reduce(((e,t)=>e+t.byteLength),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(new Uint8Array(t),r),r+=t.byteLength;return n}(await Promise.all(Array.from({length:i?Math.max(o-1,1):o},((e,t)=>({start:t*_s.EncodeBlockSize+r,end:(i&&t===o-2?t+2:t+1)*_s.EncodeBlockSize+r}))).map((async n=>{let{start:r,end:i}=n;try{const t=await UT(e,r,i);return t?await es.beginEncrypt({text:new Uint8Array(t),type:Qo.CHAT_FILE}):Promise.reject(null)}catch(n){return BT(`encrypt file buffer error. offset:${t},`,e,n),Promise.reject(n)}}))))}catch(e){console.warn(e)}return null}function qT(e,t,n,r){return r.pipe(Ut(`${Pg}`,`${Dn}`),ht((r=>{if(r.type===`${Dn}`)return!0;const{payload:{uniqueId:i,fileName:o,userId:s}}=r;return t===i&&e.name===o&&n.userId===s})),At((r=>{MT.info(`Cancel file upload. file name:${GS(e.name)},file size:${e.size},receiver id:${n.userId}`),Id(la,{...VT(e,n),progress:0,status:Cs.Cancel,retryToken:r.type===`${Pg}`?t:void 0})})))}function KT(e,t){if(null!=e&&e.file){const{file:n,receiver:r}=e,{upload:{chunkIndex:i,totalChunks:o,uniqueId:s}}=n;return Id(la,{...VT(t,r),progress:Math.floor((null!=i?i:0)/(null!=o?o:1)*100),status:Cs.Fail,retryToken:s}),Me([Og({upload:{status:Cs.Fail,progress:0,uniqueId:s}}),Dg({uniqueId:s,file:t})])}return ge}function $T(e,t){return Id(la,{...VT(e),progress:0,status:Cs.Fail}),Fe(Og({upload:{status:Cs.Fail,progress:0,uniqueId:t}}))}async function WT(e,t,n,r){const i=FT(e,"/wc/fileupload",r.value),o=new FormData;try{const s=await HT(e),a=PT(t,r.value);if(s&&a){o.append("file",new File([s],e.name));const{meeting:{zmk:u}}=r.value,{receiver:c}=a;return xE({url:i,method:"POST",headers:{"Zoom-File-Origin":"redirect=support_auth",zmk:u},crossDomain:gi(i),body:o,includeUploadProgress:!0}).pipe(_t(qT(e,t,c,n)),Ye((n=>{const{type:i,loaded:o,responseHeaders:s,total:a}=n;let u=0,l=Cs.InProgress;const d={upload:{uniqueId:t}},h=[];if("upload_loadstart"===i)u=0;else if("upload_progress"===i)u=Math.floor(o/a*100*.9);else if("upload_load"===i)u=90;else if("download_load"===i){var p,f;u=100,l=Cs.Success;const{chat:{fileServerDomain:e}}=r.value,t=null===(p=s["zoom-file-id"])||void 0===p?void 0:p.trim(),n=null===(f=s["zoom-file-obj"])||void 0===f?void 0:f.trim(),i=LT(e,{fileObj:n});Object.assign(d,{fileID:t,fileObj:n,fileUrl:i})}return Object.assign(d.upload,{progress:u,status:l}),(u>0||"upload_loadstart"===i)&&(Id(la,{...VT(e,c),progress:u,status:l}),h.push(Og(d))),Me(h)})),ft((t=>(console.warn(t),BT("Upload small file error.",e,t),KT(a,e)))))}}catch(e){console.warn(e)}return $T(e,t)}const GT=(()=>{const e=new yv;return t=>async function(){await e.acquire(),t(...arguments),setTimeout((()=>{e.release()}),3e3)}})(),zT=function(e){const t=["chatFileTransfer"];return new Proxy(e,{get:(e,n)=>"string"==typeof n&&t.includes(n)?function(){return GT(e[n].bind(e))(...arguments)}:Reflect.get(e,n)})}(Ps.createAgent()),JT={chatHistory:[],chatPrivilege:ds.All,panelistChatPrivilege:hs.AllPanelist,isAllowAttendeeChat:!0,isFileTransferEnable:!0,isEnableFileTransferEncrypted:!0,fileTransferFileType:[],fileDownloadPromptIgnoreList:[],fileTransferSizeLimit:0,fileServerDomain:"",failedFileTransfer:{}},QT=Rn({[`${wg}`]:hE(((e,t)=>{let{payload:n}=t;e.chatHistory.push(n)})),[`${bg}`]:hE(((e,t)=>{let{payload:n}=t;e.chatPrivilege=n})),[`${Eg}`]:hE(((e,t)=>{let{payload:n}=t;e.panelistChatPrivilege=n})),[`${_g}`]:hE(((e,t)=>{let{payload:n}=t;e.isAllowAttendeeChat=n})),[`${Cg}`]:hE(((e,t)=>{let{payload:n}=t;const{destNodeID:r,msgID:i,userId:o}=n,s=xT(e.chatHistory,{userId:o,destNodeID:r});s&&Object.assign(s,{id:i})})),[`${Ag}`]:hE(((e,t)=>{let{payload:n}=t;const{msgId:r}=n,i=e.chatHistory.findIndex((e=>e.id===r));i>=0&&e.chatHistory.splice(i,1)})),[`${Tg}`]:hE(((e,t)=>{let{payload:n}=t;Object.assign(e,n)})),[`${Rg}`]:hE(((e,t)=>{let{payload:n}=t;const{originFile:r,...i}=n;e.chatHistory.push(i)})),[`${Og}`]:hE(((e,t)=>{let{payload:n}=t;const{upload:r,download:i,originFile:o,...s}=n;if(r){var a;const{uniqueId:t,...n}=r,i=e.chatHistory.find((e=>{var n;return e.file&&(null===(n=e.file.upload)||void 0===n?void 0:n.uniqueId)===t}));null!=i&&null!==(a=i.file)&&void 0!==a&&a.upload&&(Object.assign(i.file.upload,{...n}),Object.assign(i.file,{...s}),i.file.upload.status===Cs.Success&&e.failedFileTransfer[i.file.upload.uniqueId]&&delete e.failedFileTransfer[i.file.upload.uniqueId])}else if(i){const{id:t,fileUrl:n}=s,r=e.chatHistory.find((e=>{var r;return e.id===t&&(null===(r=e.file)||void 0===r?void 0:r.fileUrl)===n}));null!=r&&r.file&&(r.file.download?Object.assign(r.file.download,{...i}):Object.assign(r.file,{download:i}))}})),[`${Pg}`]:hE(((e,t)=>{let{payload:n}=t;const{uniqueId:r,fileName:i,userId:o}=n,s=e.chatHistory.find((e=>e.file&&e.file.name==i&&e.file.upload.uniqueId===r&&e.file.upload.status===Cs.InProgress&&e.receiver.userId===o));var a;null!=s&&s.file&&Object.assign(null===(a=s.file)||void 0===a?void 0:a.upload,{status:Cs.Cancel,progress:0})})),[`${Dg}`]:hE(((e,t)=>{let{payload:n}=t;const{uniqueId:r,file:i}=n;e.failedFileTransfer[`${r}`]||Object.assign(e.failedFileTransfer,{[`${r}`]:i})})),[`${kg}`]:hE(((e,t)=>{let{payload:n}=t;const{fileID:r,msgID:i,senderId:o}=n,s=e.chatHistory.find((e=>{var t;return(null===(t=e.file)||void 0===t?void 0:t.fileID)===r&&e.sender.userId===o}));s&&Object.assign(s,{id:i})})),[`${xg}`]:hE(((e,t)=>{let{payload:n}=t;const{id:r,fileUrl:i}=n,o=e.chatHistory.find((e=>{var t,n;return e.id===r&&(null===(t=e.file)||void 0===t?void 0:t.fileUrl)===i&&(null===(n=e.file)||void 0===n?void 0:n.download.status)===As.InProgress}));var s;null!=o&&o.file&&Object.assign(null===(s=o.file)||void 0===s?void 0:s.download,{status:As.Cancel,progress:0})})),[`${Ig}`]:()=>({...JT})},JT);var YT;const ZT=Ps.createAgent();let XT=(YT=class extends aT{send(e,t){if(!e)return Promise.reject({type:Il,reason:"Text is empty"});const{[GA]:n,[zA]:r}=this,i=n(),o=gh(i),s=TT(i,t),a=AT(o,s,i);if(a)return Promise.reject(a);const{meeting:{isWebinar:u,encType:c}}=i,l=c===Jo.AES_GCM;let d=Promise.resolve(),h=!1;const p=u&&eh(s.userRole);return t===ps.SilentModeUsers?ZT.chat(ri(e),t):u?p?8&~s.clientCap?(d=OT({text:e,destId:ps.Panelist,sn:null==o?void 0:o.zoomID,attendeeId:t}).then((()=>function(e){const{text:t,jid:n,isGCMEnabled:r}=e;return es.beginEncrypt({text:t,type:Qo.XMPP_CHAT}).then((e=>{CT.sendWebinarMseeage(e,n,ps.IndividualCcPanelist,r)}))}({text:e,jid:s.jid,isGCMEnabled:l}))),h=!0):d=OT({text:e,destId:ps.IndividualCcPanelist,sn:null==o?void 0:o.zoomID,attendeeId:t}):s&&(d=OT({text:e,destId:s.userId,sn:null==o?void 0:o.zoomID})):d=OT({text:e,destId:s.userId,sn:null==o?void 0:o.zoomID}),d.then((()=>{const n=function(e,t,n,r){const i=(new Date).getTime(),o=performance.now();return{message:e,sender:{name:t.displayName,userId:t.userId,userGuid:t.userGUID,avatar:t.avatar},receiver:{name:null==n?void 0:n.displayName,userId:r?ps.IndividualCcPanelist:null==n?void 0:n.userId,userGuid:null==n?void 0:n.userGUID},timestamp:i,highResTimeStampForIdentification:o}}(e,o,s,p);return r(wg(n)),h?(Id(sa,n),n):new Promise(((e,r)=>{Ad(ua).pipe(He(5e3),Et((e=>n.highResTimeStampForIdentification!==e.identification||!([e.receiverId,ps.All,ps.Panelist].includes(t)||e.receiverId===ps.IndividualCcPanelist))),gt(1)).subscribe((t=>{const{msgId:r}=t,{highResTimeStampForIdentification:i,...o}=n,a={id:r,...o,...p&&{receiver:{name:null==s?void 0:s.displayName,userId:null==s?void 0:s.userId}}};Id(sa,a),e(a)}),(()=>{r({type:bl})}))}))}))}setPrivilege(e){const t=this[GA](),{meeting:{isWebinar:n},chat:{chatPrivilege:r},breakoutRoom:i}=t;return r===e?Promise.resolve(""):(null==i?void 0:i.controlStatus)===nh.InProgress&&fT(t)?Promise.reject({type:yl,reason:"Cannot update chat privilege in a subsession"}):!n&&!ms.includes(e)||n&&!vs.includes(e)?Promise.reject({type:Il,reason:"invalid privilege value of parameter"}):(ZT.setChatPriviledge(e),Cd(aa,(t=>t.chatPrivilege===e)))}setPanelistPrivilege(e){const t=this[GA](),{chat:{panelistChatPrivilege:n}}=t,r=Ss[e];return n===r?Promise.resolve(""):Object.values(ys).includes(e)?(ZT.setPanelistChatPrivilege(e),Cd(aa,(e=>e.panelistChatPrivilege===r))):Promise.reject({type:Il,reason:"Panelist privilege value is invalid"})}deleteMessage(e){const t=this[GA](),{chat:{chatHistory:n},meeting:{meetingOptions:r,userId:i}}=t;if(null!=r&&r.isEnableDeleteChatMsg){const r=mh(t),o=n.find((t=>t.id===e));if(o){const{sender:t}=o;if(r)ZT.chatCmdReq(e,fs.Delete);else{if(t.userId!==i)return Promise.reject({type:El,reason:"can not delete message"});ZT.chatCmdReq(e,fs.Delete)}return Cd(ca,(t=>t.id===e)).then((()=>({id:e})))}return Promise.reject({type:Il,reason:"msgId is wrong"})}return Promise.reject({type:yl,reason:"can not delete messages"})}lockChat(e){const t=this[GA](),{meeting:{meetingOptions:n}}=t,r=null!=n&&n.isPrivateChatEnabled?ds.All:ds.EveryonePublicly;return this.setPrivilege(e?ds.NoOne:r)}sendFile(e,t){if(!e)return Promise.reject({type:Il,reason:"File is empty"});const{[GA]:n,[zA]:r}=this,i=n(),{chat:{isFileTransferEnable:o,fileTransferFileType:s,fileTransferSizeLimit:a,failedFileTransfer:u}}=i;if(!o)return Promise.reject({type:yl,reason:"Send files via in-session chat is not enabled"});if("string"==typeof e){const t=PT(e,i);if(null!=t&&t.file&&u[e]){const{file:{upload:n,...i}}=t,{file:{name:o,upload:{uniqueId:s}},receiver:{userId:a}}=t;return r(Og({originFile:u[e],...i,upload:{...n,status:Cs.InProgress}})),Promise.resolve((()=>{r(Pg({uniqueId:s,fileName:o,userId:a}))}))}return Promise.reject({type:Il,reason:"Retry token is not correct."})}{const{name:n}=e;if(s.length>0){const[e]=n.split(".").reverse();if(!s.some((t=>t===e)))return Promise.reject({type:yl,reason:"File is not in the allow list"})}if(e.size>a)return Promise.reject({type:yl,reason:"File size exceeds the maximum limit."});const o=gh(i),u=TT(i,t),c=AT(o,u,i);if(c)return Promise.reject(c);const l=li();return r(Rg(function(e,t,n,r,i){const o=(new Date).getTime();return{file:{name:e.name,size:e.size,type:e.type,upload:{progress:0,uniqueId:t,totalChunks:0,chunkIndex:0}},originFile:e,sender:{name:n.displayName,userId:n.userId,userGuid:n.userGUID,avatar:n.avatar},receiver:{name:null==r?void 0:r.displayName,userId:null==r?void 0:r.userId,attendeeId:void 0,userGuid:null==r?void 0:r.userGUID},timestamp:o}}(e,l,o,u))),Promise.resolve((()=>{r(Dg({uniqueId:l,file:e})),r(Pg({uniqueId:l,fileName:n,userId:null==u?void 0:u.userId}))}))}}downloadFile(e,t,n){const{[GA]:r,[zA]:i}=this,{chat:{chatHistory:o}}=r();if(!e||!t)return Promise.reject({type:Il,reason:"Invalid message id or file url!"});const s=o.find((n=>{var r;return n.id===e&&(null===(r=n.file)||void 0===r?void 0:r.fileUrl)===t}));return s?(i(Og({id:e,fileUrl:t,download:{status:As.InProgress,progress:0,blob:n}})),Promise.resolve((()=>i(xg({id:e,fileUrl:t}))))):Promise.reject({type:Il,reason:"Invalid message id or file url!"})}getPrivilege(){const{chat:{chatPrivilege:e,isAllowAttendeeChat:t}}=this[GA]();return t?e:ds.NoAttendee}getReceivers(){const e=this[GA](),{chat:{chatPrivilege:t,panelistChatPrivilege:n,isAllowAttendeeChat:r},meeting:{isWebinar:i}}=e;if(!i&&!r)return[];const o=gh(e),s=mh(e);if(o)if(i)if(eh(o.userRole)){if(!r)return[];if(t===ds.All)return[Es,bs];if(t===ds.AllPanelist)return[Es];if(t===ds.NoOne)return[]}else{if(s||n===hs.Everyone){const t=RT(e,o.userId,{includeAttendee:!0});return[Es,bs,...t]}if(n===hs.AllPanelist){const t=RT(e,o.userId);return[Es,...t]}}else{const n=mh(e);if(t===ds.All||n){const t=RT(e,o.userId);return[bs,...t]}if(t===ds.Host)return RT(e,o.userId,{host:!0});if(t===ds.EveryonePublicly){const t=RT(e,o.userId,{host:!0});return[bs,...t]}if(t===ds.NoOne)return[]}return[]}getHistory(){return this[GA]().chat.chatHistory.map((e=>{const{highResTimeStampForIdentification:t,...n}=e;if(n.file){const{name:e,size:t,type:r,fileUrl:i,upload:o,download:s}=n.file,a={name:e,size:t,type:r,fileUrl:i};return o&&Object.assign(a,{upload:{status:o.status,progress:o.progress}}),s&&Object.assign(a,{download:{status:s.status,progress:s.progress}}),{...n,file:a}}return n}))}isAllowToDeleteMessages(){const e=this[GA](),{meeting:{meetingOptions:t}}=e;return null==t?void 0:t.isEnableDeleteChatMsg}isFileTransferEnabled(){return this[GA]().chat.isFileTransferEnable}getFileTransferSetting(){const e=this[GA](),{chat:{fileTransferFileType:t,fileTransferSizeLimit:n}}=e;return{typeLimit:(null!=t?t:[]).map((e=>`.${e}`)).join(","),sizeLimit:n}}},$A(YT.prototype,"send",[YA],Object.getOwnPropertyDescriptor(YT.prototype,"send"),YT.prototype),$A(YT.prototype,"setPrivilege",[ZA,YA],Object.getOwnPropertyDescriptor(YT.prototype,"setPrivilege"),YT.prototype),$A(YT.prototype,"setPanelistPrivilege",[ZA,YA,function(e,t,n){const r=n.value;n.value=function(){const e=this[WA];if(e){const{meeting:{isWebinar:t}}=e.getState();if(!t)return Promise.reject({type:wl,reason:"non-webinar"})}for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.apply(this,n)}}],Object.getOwnPropertyDescriptor(YT.prototype,"setPanelistPrivilege"),YT.prototype),$A(YT.prototype,"deleteMessage",[YA],Object.getOwnPropertyDescriptor(YT.prototype,"deleteMessage"),YT.prototype),$A(YT.prototype,"lockChat",[ZA,YA],Object.getOwnPropertyDescriptor(YT.prototype,"lockChat"),YT.prototype),$A(YT.prototype,"sendFile",[YA],Object.getOwnPropertyDescriptor(YT.prototype,"sendFile"),YT.prototype),$A(YT.prototype,"downloadFile",[YA],Object.getOwnPropertyDescriptor(YT.prototype,"downloadFile"),YT.prototype),YT);const eR={epics0:(e,t)=>gr(e,24583).pipe(Tt(t),Ye((e=>{let[t,n]=e;if(n.meeting.zlkJwtToken)return ge;const{payload:{body:{sn:r,senderName:i,senderJid:o,receiver:s,text:a,type:u}}}=t,c=gh(n),l=yh(n),{meeting:{jid:d,userId:h},participants:{xmppAttendeeList:p}}=n;return es.beginDecrypt({decryptedText:a,type:Qo.XMPP_CHAT,zoomId:r}).then((e=>{var t;let{message:n}=e,r=null,a=0,f="";c&&eh(c.userRole)&&d===s?(r=p.find((e=>e.jid===o)),a=h,f=c.displayName):u===ps.Panelist&&(r=l.find((e=>e.jid===o)),a=ps.Panelist,f=Es.displayName);const g={message:n,sender:{name:i,userId:(null===(t=r)||void 0===t?void 0:t.userId)||0,avatar:""},receiver:{name:f,userId:a},timestamp:(new Date).getTime()};return Id(sa,g),wg(g)}))}))),epics1:(e,t)=>pr(e,7944).pipe(Tt(t),Ye((e=>{let[t,n]=e;const{meeting:{bIbDisableChat:r}}=n,{payload:{body:{attendeeNodeID:i,sn:o,destNodeID:s,text:a,senderName:u,msgID:c}}}=t,l=gh(n);if(l){const e=eh(null==l?void 0:l.userRole)&&i===l.userId&&!c;if(!r&&!e){const{sn:e,...t}=DT({destNodeID:s,attendeeNodeID:i,senderName:u,sn:o},n);return(i===ps.SilentModeUsers?Promise.resolve({id:c,message:ii(a),...t}):es.beginDecrypt({decryptedText:a,zoomId:e,type:Qo.RWG_CHAT}).then((e=>{let{message:n}=e;return{id:c,message:n,...t}}))).then((e=>(Id(sa,e),wg(e))))}}return ge}))),epics2:(e,t)=>pr(e,is).pipe(ht((e=>{var t,n;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.chatPriviledge)||void 0!==(null===(n=e.payload.body)||void 0===n?void 0:n.bAllowAttendeeChat)})),Tt(t),Ke((e=>{let[t,n]=e;const{payload:{body:{chatPriviledge:r,bAllowAttendeeChat:i}}}=t,{chat:{chatPrivilege:o}}=n;return void 0!==i?(Id(aa,!0===i?{chatPrivilege:o}:{chatPrivilege:ds.NoAttendee}),_g(i)):(Id(aa,{chatPrivilege:r}),bg(r))}))),epics3:e=>pr(e,is).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.panelistChatPriviledge)})),Ke((e=>{const{payload:{body:{panelistChatPriviledge:t}}}=e;return Id(aa,{panelistChatPrivilege:t}),Eg(t)}))),epics4:(e,t)=>pr(e,4136).pipe(Tt(t),Ye((e=>{let[t,n]=e;const{payload:{body:{result:r,destNodeID:i,msgID:o,fileID:s}}}=t,{meeting:{userId:a},chat:{chatHistory:u}}=n,c=[];if(r===gs.Success)if(s){const e=u.find((e=>{var t;return(null===(t=e.file)||void 0===t?void 0:t.fileID)===s}));if(e){const{file:t,receiver:n,...r}=e,{name:i,size:u,type:l,fileUrl:d}=null!=t?t:{},{attendeeId:h,...p}=n;Id(sa,{id:o,file:{name:i,size:u,type:l,fileUrl:d,upload:{status:Cs.Complete,progress:100}},receiver:{...p},...r}),c.push(kg({fileID:s,msgID:o,senderId:a}))}}else{const e=xT(u,{userId:a,destNodeID:i});var l;e&&(Id(ua,{msgId:o,receiverId:i,identification:null!==(l=e.highResTimeStampForIdentification)&&void 0!==l?l:0}),c.push(Cg({destNodeID:i,msgID:o,userId:a})))}else r!==gs.Delete&&r!==gs.Block||c.push(Ag({msgId:o}));return Me(c)}))),epics5:e=>pr(e,4238).pipe(Ye((e=>{const{payload:{body:{bSuccess:t,cmd:n,msgID:r}}}=e,i=[];return t&&n===fs.Delete&&(i.push(Ag({msgId:r})),Id(ca,{id:r})),Me(i)}))),epics6:e=>pr(e,7960).pipe(Ye((e=>{const{payload:{body:{cmd:t,msgID:n}}}=e,r=[];return t===fs.Delete&&(r.push(Ag({msgId:n})),Id(ca,{id:n})),Me(r)})))},tR=hr(eR,{chatFileEpics0:e=>e.pipe(Ut(`${Bi}`),Ke((e=>{var t,n,r;const{payload:{fileTransfer:i,fileServerDomain:o}}=e;return Tg({isFileTransferEnable:null==i?void 0:i.isEnable,isEnableFileTransferEncrypted:null==i?void 0:i.isEnableFileTransferEncrypted,fileTransferFileType:(null!==(t=null==i?void 0:i.fileType)&&void 0!==t?t:"").replace(/\./g,"").split(",").filter(Boolean),fileTransferSizeLimit:1024*(null!==(n=null==i?void 0:i.sizeLimit)&&void 0!==n?n:0)*1024||_s.MaxSize,fileDownloadPromptIgnoreList:(null!==(r=null==i?void 0:i.fileDownloadPromptIgnoreList)&&void 0!==r?r:"").replace(/\./g,"").split(","),fileServerDomain:`https://${o}`})}))),chatFileEpics1:(e,t)=>e.pipe(Ut(`${Rg}`),Ye((async n=>{const{payload:{originFile:r,file:{upload:{uniqueId:i}}}}=n;return r.size>_s.ChunkSize?await async function(e,t,n,r){const i=FT(e,"/wc/multiupload/init",r.value),o=await async function(e){const t=Math.ceil(e.size/_s.ReaderChunkSize);return(await Promise.all(Array.from({length:t},((e,t)=>({start:t*_s.ReaderChunkSize,end:(t+1)*_s.ReaderChunkSize}))).map((async t=>{let{start:n,end:r}=t;try{const t=await UT(e,n,r);return yi(await window.crypto.subtle.digest("SHA-256",t))}catch(t){return BT("calculate file hash error.",e,t),Promise.reject(t)}})))).join("")}(e),{meeting:{zmk:s,meetingId:a}}=r.value,u=PT(t,r.value);if(o&&u){const{receiver:r}=u,c={fileName:e.name,length:e.size,channelType:4,digest:o,shareJid:a};return xE({url:i,method:"POST",headers:{"Zoom-File-Origin":"redirect=support_auth",zmk:s},crossDomain:gi(i),body:c}).pipe(_t(qT(e,t,r,n)),Ke((n=>{var r;const{responseHeaders:i,response:o}=n,s=null===(r=i["x-zm-trackingid"])||void 0===r?void 0:r.trim(),{uploadid:a,path:u,metadata:c}=o,l=Math.ceil(e.size/_s.ChunkSize);return Og({originFile:e,upload:{uniqueId:t,status:Cs.InProgress,progress:0,chunkIndex:0,totalChunks:l,uploadid:a,trackingId:s,path:u,metadata:c}})})),ft((t=>(console.warn(t),BT("Upload file meta error.",e,t),KT(u,e)))),wt(Og({upload:{uniqueId:t,status:Cs.Init}})))}return $T(e,t)}(r,i,e,t):await WT(r,i,e,t)})),Ye((e=>e))),chatFileEpics2:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{var t;return(null===(t=e.payload.upload)||void 0===t?void 0:t.status)===Cs.Success})),ey((async e=>{const{payload:{upload:{uniqueId:n}}}=e,{chat:{isEnableFileTransferEncrypted:r,chatHistory:i}}=t.value,o=i.find((e=>{var t,r;return(null===(t=e.file)||void 0===t||null===(r=t.upload)||void 0===r?void 0:r.uniqueId)===n})),s=[];if(o&&o.file){const{file:{name:e,size:t,fileObj:i,fileID:a,type:u},receiver:{userId:c,attendeeId:l}}=o;let[d,h]=["",""];if(r){const[n,r]=await Promise.all([e,`${t}`].map((e=>es.beginEncrypt({text:e,type:Qo.RWG_CHAT}))));[d,h]=[n,r]}else[d,h]=[e,`${t}`].map((e=>ri(e)));await zT.chatFileTransfer({fileID:a,fileSize:h,fileName:d,fileObj:i,type:u,destNodeID:c,attendeeNodeID:l}),s.push(Og({upload:{uniqueId:n,status:Cs.Complete}}))}return s}))),chatFileEpics3:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{const{payload:{upload:t,originFile:n}}=e;return!!t&&!!t.uniqueId&&t.status===Cs.InProgress&&(null==n?void 0:n.size)<=_s.ChunkSize&&0===t.totalChunks})),Ye((async n=>{const{payload:{originFile:r,upload:{uniqueId:i}}}=n;return await WT(r,i,e,t)})),Ye((e=>e))),chatFileEpics4:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{const{payload:{upload:t}}=e;return!!t&&!!t.uniqueId&&t.totalChunks>0&&t.chunkIndex!==t.totalChunks})),Ye((async n=>{const{payload:{originFile:r,upload:{uniqueId:i}}}=n;return await async function(e,t,n,r){const i=PT(t,r.value);if(null!=i&&i.file){const{file:{upload:{chunkIndex:o,totalChunks:s,uploadid:a,path:u,trackingId:c,etags:l},size:d},receiver:h}=i,p=o*_s.ChunkSize,f=await HT(e,p);if(f){const{chat:{fileServerDomain:p},meeting:{zmk:g}}=r.value,m=`${p}/upload/parts?${new URLSearchParams({uploadid:a,partNumber:o+1}).toString()}`,v=new FormData,y=new File([f],e.name);return v.append("file",y),xE({url:m,method:"POST",headers:{"Zoom-File-Size":y.size,"Zoom-File-Path":u,"x-zm-trackingid":c,"Zoom-File-Origin":"redirect=support_auth",zmk:g},crossDomain:gi(m),body:v,includeUploadProgress:!0}).pipe(_t(qT(e,t,h,n)),Ye((n=>{var i;const{type:a,loaded:u,total:c,responseHeaders:p}=n;let f=0;const g={upload:{uniqueId:t,status:Cs.InProgress}},m=[],v=PT(t,r.value),y=null==v||null===(i=v.file)||void 0===i?void 0:i.upload.progress;if("upload_loadstart"===a)f=y||Math.floor(o/s*100);else if("upload_progress"===a)f=Math.floor((o*_s.ChunkSize+.9*u)/d*100);else if("upload_load"===a)f=Math.floor((o*_s.ChunkSize+.9*c)/d*100);else if("download_load"===a){f=y||Math.floor((o+1)/s*100);const t=p["x-zm-etag"].trim(),n=l?{...l,[`${o+1}`]:t}:{[`${o+1}`]:t};Object.assign(g.upload,{etags:n,chunkIndex:o+1,totalChunks:s}),Object.assign(g,{originFile:e})}return(f>0||"upload_loadstart"===a)&&(Object.assign(g.upload,{progress:f}),Id(la,{...VT(e,h),progress:f,status:Cs.InProgress}),m.push(Og(g))),Me(m)})),ft((t=>(console.warn(t),BT(`Upload file chunk error. chunk:${o},total chunks:${s},uploadid:${a},trackingId:${c}`,e,t),KT(i,e)))))}}return $T(e,t)}(r,i,e,t)})),Ye((e=>e))),chatFileEpics5:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{const{payload:{upload:t}}=e;return!!t&&!!t.uniqueId&&t.totalChunks>0&&t.chunkIndex==t.totalChunks})),Ye((n=>{const{payload:{originFile:r,upload:{uniqueId:i}}}=n;return function(e,t,n,r){const{chat:{fileServerDomain:i},meeting:{zmk:o}}=r.value,s=PT(t,r.value);if(null!=s&&s.file){const{file:{upload:{uploadid:a,metadata:u,etags:c,trackingId:l}},receiver:d}=s,h=`${i}/upload/complete?uploadid=${a}`;return xE({url:h,method:"POST",headers:{"x-zm-trackingid":l,"Zoom-File-Origin":"redirect=support_auth",zmk:o},crossDomain:gi(h),body:{metadata:u,etags:c}}).pipe(_t(qT(e,t,d,n)),Ke((n=>{var i,o;const{chat:{fileServerDomain:s}}=r.value,{responseHeaders:a}=n,u=null===(i=a["zoom-file-id"])||void 0===i?void 0:i.trim(),c=null===(o=a["zoom-file-obj"])||void 0===o?void 0:o.trim(),l=`${s}/zoomfile/download?objkey=${c}`;return Id(la,{...VT(e,d),progress:100,status:Cs.Success}),Og({fileID:u,fileObj:c,fileUrl:l,upload:{uniqueId:t,progress:100,status:Cs.Success}})})),ft((t=>(console.warn(t),BT(`Upload chunks checksum error.uploadid${a},trackingId${l}`,e,t),KT(s,e)))))}return $T(e,t)}(r,i,e,t)}))),chatFileEpics6:(e,t)=>pr(e,4308).pipe(ey((async e=>{const{payload:{body:{attendeeNodeID:n,destNodeID:r,fileID:i,fileName:o,fileObj:s,fileSize:a,fileType:u,msgID:c,senderName:l}}}=e,{meeting:{bIbDisableChat:d},chat:{fileServerDomain:h,isEnableFileTransferEncrypted:p}}=t.value,f=[];if(!d){const e=LT(h,{fileObj:s,fileID:i});if(u===Is.Local){const{sn:u,...d}=DT({destNodeID:r,attendeeNodeID:n,senderName:l},t.value);let[h,g]=["",0];if(p){const[e,t]=await Promise.all([o,a].map((e=>es.beginDecrypt({decryptedText:e,zoomId:u,type:Qo.RWG_CHAT}))));h=e.message,g=Number(t.message)}else h=ii(o),g=Number(ii(a));const m={id:c,file:{name:h,size:g,fileUrl:e},...d};f.push(wg({...m,file:{...m.file,fileID:i,fileObj:s}})),setTimeout((()=>{Id(sa,m)}),0)}}return f}))),chatFileEpics7:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{var t,n;const{payload:r}=e;return r.id&&r.fileUrl&&(null===(t=r.download)||void 0===t?void 0:t.status)===As.InProgress&&0===(null===(n=r.download)||void 0===n?void 0:n.progress)})),Ye((n=>function(e,t,n){var r;const{chat:{chatHistory:i},meeting:{zmk:o},participants:{attendeesList:s}}=n.value,a=i.find((t=>t.id===e));if(null!=a&&null!==(r=a.file)&&void 0!==r&&r.fileUrl){const{file:{fileUrl:n}}=a;return xE({url:n,method:"GET",headers:{"Zoom-File-Origin":"redirect=support_auth",zmk:o},crossDomain:gi(n),responseType:"arraybuffer",includeDownloadProgress:!0}).pipe(_t(function(e,t){return t.pipe(Ut(`${xg}`,`${Dn}`),ht((t=>{if(t.type===`${Dn}`)return!0;const{payload:{id:n}}=t;return e.id===n})),At((()=>{var t,n,r;MT.info(`Cancel file download. file name:${GS(null===(t=e.file)||void 0===t?void 0:t.name)},file size:${null===(n=e.file)||void 0===n?void 0:n.size},sender id:${null===(r=e.sender)||void 0===r?void 0:r.userId}`),Id(da,{...jT(e),progress:0,status:As.Cancel})})))}(a,t)),ey((async t=>{const{type:n,loaded:r,total:i}=t,o=[],u={...jT(a),progress:0,status:As.InProgress};if("download_loadstart"===n&&Object.assign(u,{progress:0}),"download_progress"===n){var c;const t=Math.floor(r/i*100);o.push(Og({id:e,fileUrl:null===(c=a.file)||void 0===c?void 0:c.fileUrl,download:{progress:t}})),Object.assign(u,{progress:t})}else if("download_load"===n){var l,d,h;const n=100,r=As.Success;Object.assign(u,{progress:n,status:r}),o.push(Og({id:e,fileUrl:null===(l=a.file)||void 0===l?void 0:l.fileUrl,download:{progress:n,status:r}}));const i=null===(d=s.find((e=>e.userId===a.sender.userId)))||void 0===d?void 0:d.zoomID,c=await async function(e,t,n){const r=Math.ceil(e.byteLength/_s.DecodeBlockSize);try{const i=await Promise.all(Array.from({length:Math.max(r-1,1)},((e,t)=>({start:t*_s.DecodeBlockSize,end:(t===r-2?t+2:t+1)*_s.DecodeBlockSize}))).map((async r=>{let{start:i,end:o}=r;try{const t=e.slice(i,o),{message:r}=await es.beginDecrypt({decryptedText:t,zoomId:n,type:Qo.CHAT_FILE});return r}catch(n){return BT("decrypt file buffer error.",{name:t,size:e.byteLength},n),Promise.reject(n)}})));return new Blob(i,{type:kT(t)})}catch(e){return null}}(t.response,null===(h=a.file)||void 0===h?void 0:h.name,i);var p,f;c&&(null!==(p=a.file)&&void 0!==p&&p.download.blob?Object.assign(u,{fileBlob:c}):function(e,t){const n=document.createElement("a"),r=window.URL.createObjectURL(e);n.href=r,n.download=t,n.click(),window.URL.revokeObjectURL(r)}(c,null===(f=a.file)||void 0===f?void 0:f.name))}return(u.progress>0||"download_loadstart"===n)&&Id(da,u),o})),ft((t=>(console.warn(t),BT(`download file error. file url:${n}`,{name:void 0,size:void 0},t),Id(da,{...jT(a),progress:0,status:As.Fail}),Fe(Og({id:e,fileUrl:n,download:{status:As.Fail,progress:0}}))))))}return ge}(n.payload.id,e,t))))});function nR(e,t){const{meeting:{isMeetingReset:n,meetingId:r,meetingNumber:i,userName:o,userEmail:s,tid:a,userId:u,userGUID:c},breakoutRoom:l}=e;let d="";var h;return d=n?null!=l&&null!==(h=l.currentRoom)&&void 0!==h&&h.boConfId?"join breakout room":"meeting failover":"join meeting",{label:d,payload:{meetingId:r,tid:a,userId:u||(null==t?void 0:t.userId),userGUID:c||(null==t?void 0:t.userGUID),meetingNumber:GS(i),userName:GS(o),userEmail:GS(s)}}}function rR(e,t,n){return B(It((r=>{let i=!1;try{var o,s;const{logger:{options:e},meeting:{logConfig:n}}=t.value;i=null!==(o=null==e?void 0:e.enable)&&void 0!==o?o:null===(s=JSON.parse(n||"{}"))||void 0===s?void 0:s.enable}catch(e){}try{if(i){const{logger:{isLaplaceInitialized:i}}=t.value;if(!i)return e.pipe(Ut(`${dv}`),gt(1),Ye((e=>(e.payload&&n(r),ge))));n(r)}}catch(e){console.warn(e)}return ge})))}function iR(e,t,n,r){return vr(e,n).pipe(rR(e,t,r))}function oR(e,t,n,r){return pr(e,n).pipe(rR(e,t,r))}function sR(e){var t,n;const{audio:{activeMicrophone:r,activeSpeaker:i,microphoneDevicesList:o,speakerDevicesList:s}}=e;return`microphone: [${r} - ${null==o||null===(t=o.find((e=>e.deviceId===r)))||void 0===t?void 0:t.label}]; speaker: [${i} - ${null==s||null===(n=s.find((e=>e.deviceId===i)))||void 0===n?void 0:n.label}]`}function aR(e){var t;const{video:{activeCamera:n,cameraDevicesList:r}}=e;return`camera: [${n} - ${null==r||null===(t=r.find((e=>e.deviceId===n)))||void 0===t?void 0:t.label}]`}function uR(e,t){return t?` ,${e}:${t}`:""}const{InitSuccessAudio:cR,InitFailedAudio:lR,InitSuccessVideo:dR,InitFailedVideo:hR,InitSuccessSharing:pR,InitFailedSharing:fR}=Da,{DecodeSuccess:gR,DecodeFailed:mR,EncodeSuccess:vR,EncodeFailed:yR}=ka,SR={[`${cR}`]:{name:"Audio",isException:!1},[`${lR}`]:{name:"Audio",isException:!0},[`${dR}`]:{name:"Video",isException:!1},[`${hR}`]:{name:"Video",isException:!0},[`${pR}`]:{name:"Sharing",isException:!1},[`${fR}`]:{name:"Sharing",isException:!0}};function bR(e){const t=(null!=e?e:"").split("-");return[...new Set(t)].map((e=>({reason:e,count:t.filter((t=>e===t)).length})))}const ER=YS.getInstance(),wR=()=>{if("connection"in navigator){const{effectiveType:e,rtt:t,downlink:n}=navigator.connection;ER.makeLogger(["Network Connection Type"]).info(`Network connection. ect:${e},rtt:${t},downlink:${n}`)}},IR=YS.getInstance().makeLogger(["Remote Control"]),_R=nb(Ls.getInstance()),CR=[{event:Da.AudioBridgeReconnectStart,message:$S.AudioBridgeReconnectStart,logType:"info",additionalTags:["Audio Join Flow"]},{event:Da.AudioBridgeReconnectEnd,message:$S.AudioBridgeReconnectEnd,logType:"info",additionalTags:["Audio Join Flow"]},{event:Da.UserGrantCaptureAudio,message:e=>`${$S.DeviceAudioStreamCaptured},${sR(e)}`,logType:"info",additionalTags:["Audio Capture Flow"]},{event:Da.JoinComputerAudioComplete,message:$S.AudioJoinComplete,logType:"info",additionalTags:["Audio Join Flow"]},{event:Da.LeaveComputerAudioComplete,message:$S.AudioLeaveComplete,logType:"info",additionalTags:["Audio Join Flow"]},{event:Da.JoinSharingAudioComplete,message:$S.SharingAudioStartComplete,logType:"info",additionalTags:["Audio Sharing Flow"]},{event:Da.LeaveSharingAudioComplete,message:$S.SharingAudioStopComplete,logType:"info",additionalTags:["Audio Sharing Flow"]}],AR=[{event:Da.StartVideoCaptureSuccess,message:e=>`${WS.StartCaptureVideoSuccess}, ${aR(e)}`,logType:"info",additionalTags:["Video Join Flow"]},{event:Da.StopVideoCaptureSuccess,message:WS.StopCaptureVideoSuccess,logType:"info",additionalTags:["Video Join Flow"]},{event:Da.StartVideoStreamInVbSettingSuccess,message:WS.VBSettingSuccess,logType:"info",additionalTags:["Video VB Flow"]},{event:Da.VbModelPreloadingOk,message:WS.VBPreloadSuccess,logType:"info",additionalTags:["Video VB Flow"]},{event:Da.VbModelPreloading_3S,message:WS.VBPreloading3S,logType:"warn",additionalTags:["Video VB Flow"]},{event:Da.VbModelPreloading_10S,message:WS.VBPreloading10S,logType:"warn",additionalTags:["Video VB Flow"]},{event:Da.VbSettingParaError,message:WS.VBSettingFailed,logType:"error",additionalTags:["Video VB Flow"]}],TR=CR.map((e=>({...e,tag:"Audio"}))).concat(AR.map((e=>({...e,tag:"Video"})))),RR=YS.getInstance(),{InitSuccessVideo:OR,InitSuccessAudio:PR,InitSuccessSharing:DR,InitFailedVideo:kR,InitFailedAudio:xR,InitFailedSharing:NR,RecoverWebrtcAudio:MR,AudioBridgeFirstRecvData:FR,AudioBridgeCanSendData:LR,UserForbiddedCaptureAudio:VR,AudioWebsocketBroken:BR,AudioZeroData:jR,UserForbiddedCaptureVideo:UR,UserCameraIsTakenByOtherPrograms:HR,VideoWebsocketBroken:qR,StopVideoCaptureFailed:KR,DesktopSharingPermissionDenied:$R,DesktopSharingSystemError:WR,AudioSpeakerSetError:GR,VbSettingParaError:zR,MaskSettingParaError:JR,WebglLostInMultiView:QR,VideoStreamFailed:YR,AudioStreamFailed:ZR,NotifyUIFailover:XR}=Da,eO=YS.getInstance(),tO={options:void 0,isLaplaceInitialized:!1},nO=Rn({[`${lv}`]:hE(((e,t)=>{let{payload:n}=t;e.options=n})),[`${dv}`]:hE(((e,t)=>{let{payload:n}=t;e.isLaplaceInitialized=n})),[`${hv}`]:(e,t)=>{let{options:n}=e,{payload:r}=t;return r?{...tO,options:n}:{...tO}}},tO),rO={mlEpics0:(e,t)=>vr(e,[OR,PR,DR,kR,xR,NR]).pipe(rR(e,t,(e=>{const{payload:{type:n,data:r}}=e,{meeting:{userId:i}}=t.value,o=function(e,t){const n=SR[`${e}`];if(n){const{name:e,isException:r}=n,i=[e,`${e} Init Flow`];r&&i.push(`${e} exception flow`);let o="";return[gR,mR].includes(t)&&(o=`${o} decode`.trim()),[vR,yR].includes(t)&&(o=`${o} encode`.trim()),[vR,gR].includes(t)&&(o=`${o} success`.trim()),[mR,yR].includes(t)&&(o=`${o} failed`.trim()),{message:`init ${e.toLowerCase()} ${o}`,tags:i,isException:r}}return null}(n,r);if(o){const{message:e,tags:t,isException:n}=o;n?RR.report(`${e}. userId:${i}`,t):RR.makeLogger(t).info(e)}}))),mlEpics1:(e,t)=>iR(e,t,TR.map((e=>e.event)),(e=>{const{payload:{type:n}}=e,r=TR.find((e=>e.event===n));if(r){const{message:e,logType:n,additionalTags:i,tag:o}=r;let s=e;"function"==typeof e&&(s=e(t.value)),s&&RR.makeLogger([o])[n](s,i)}})),mlEpics2:(e,t)=>e.pipe(Ut(`${Kh}`),ht((e=>!e.payload)),rR(e,t,(()=>{RR.makeLogger(["Audio"]).warn(`Auto play audio failed,${sR(t.value)}`)}))),mlEpics3:(e,t)=>iR(e,t,MR,(()=>{RR.report("Audio bridge, recover audio failed, need to rejoin the audio",["Audio exception flow"])})),mlEpics4:(e,t)=>iR(e,t,[FR,LR],(e=>{const{payload:{type:t}}=e;RR.makeLogger(["Audio"]).log("Audio bridge connection: "+(t===FR?"first receive data":"can send data"))})),mlEpics5:(e,t)=>iR(e,t,XR,(e=>{RR.report(`Audio bridge, notify ui failover, subreason:${e.payload.data}`,["Audio exception flow"])})),mlEpics6:(e,t)=>iR(e,t,[VR,BR,jR,GR,ZR],(e=>{const{payload:{type:n}}=e;let r=`Audio error case:${n}`;n===VR?r="Audio capture is forbidden by the user":n===jR?t.value.audio.webrtcRestartCount<3&&(r="audio capture zero data, auto failover"):n===GR?r="audio change speaker error":n===ZR&&(r="audio stream ended or muted, stop capture audio"),RR.report(`${r},${sR(t.value)}`,["Audio exception flow"])})),mlEpics7:(e,t)=>iR(e,t,[UR,HR,qR,KR,YR],(e=>{const{payload:{type:n,data:r}}=e;let i=`Video error case:${n}`;if(n===UR)i="Video capture is forbidden by the user"+(r?` (error name:${null==r?void 0:r.name};error message:${null==r?void 0:r.message})`:"");else if(n===HR)i="Camera is taken by other programs"+(r?` (error name:${null==r?void 0:r.name};error message:${null==r?void 0:r.message})`:"");else if(n===zR){var o;i=`VB setting error, param:${JSON.stringify(null!==(o=t.value.video.virtualBackground)&&void 0!==o?o:{})}`}else if(n===JR){var s;i=`Mask setting error, param:${JSON.stringify(null!==(s=t.value.video.mask)&&void 0!==s?s:{})}`}else n===YR&&(i=`Video stream ended or muted, if it is on iOS platform, will stop capture video.platform:${Uo.browser}`);RR.report(`${i},${aR(t.value)}`,["Video exception flow"])})),mlEpics8:(e,t)=>iR(e,t,[$R,WR],(e=>{const{payload:{type:t}}=e;let n="";t===WR?Uo.isMacOS&&(n="Need to allow screen recording access in system setting on MacOS"):n="Need to allow the permission request",RR.report(`${n}`,["Sharing exception flow"])})),mlEpics9:(e,t)=>iR(e,t,QR,(e=>{const{payload:{data:n}}=e,{video:{renderedVideoList:r}}=t.value;if(null!=n&&n.canvasId){const e=r.filter((e=>e.canvasId===n.canvasId));RR.report(`WebGl Context lost, canvas ID:${n.canvasId}, affected video node Ids:${e.map((e=>e.userId)).join(",")}`,["Video exception flow"])}})),mlEpics10:(e,t)=>it(document,"visibilitychange").pipe(rR(e,t,(()=>{RR.makeLogger(["Video"]).log(`Page visibility ${document.visibilityState} `),setTimeout((()=>{const e="visible"!==document.visibilityState,{video:{subscribedVideoList:n},meeting:{userId:r}}=t.value,i=n.filter((e=>e!==r)).length>0;e&&i&&(Ps.createAgent().sendRWGConnectionPerformance("VCSV"),RR.makeLogger(["Video"]).warn("Still subscribing videos after switching to background"))}),1e3)})))},iO={rmclEpics0:(e,t)=>e.pipe(Ut(`${tf}`),rR(e,t,(e=>{const{payload:{isRemoteControlEnabled:t,isEnableAutoDeleteRcApp:n}}=e;IR.log(`isRemoteControlEnabled:${t},auto delete:${n}`)}))),rmclEpics1:(e,t)=>e.pipe(Ut(`${Yp}`),ht((e=>!!e.payload)),rR(e,t,(e=>{IR.log(`Launch Remote control app, scheme:${e.payload}`)}))),rmclEpics2:(e,t)=>e.pipe(Ut(`${Kp}`),ht((e=>!!e.payload)),rR(e,t,(e=>{IR.log(`Remote control session starts, controlling ssrc:${e.payload}`)}))),rmclEpics3:(e,t)=>oR(e,t,16430,(()=>{IR.log("Remote control app connected to rwg.")})),rmclEpics4:(e,t)=>oR(e,t,ls,(()=>{IR.log("Remote control app disconnected to rwg.")})),rmclEpics5:(e,t)=>oR(e,t,ls,(e=>{const{share:{status:n,isRemoteControlEnabled:r}}=t.value;r&&n!==qa.End&&e.payload.body.bOn&&IR.log(`Remote control sharing device info.${JSON.stringify(_R.getShareStreamInfo())}`)})),rmclEpics6:(e,t)=>iR(e,t,Da.CurrentDesktopSharingWidthHeight,(()=>{const{share:{isRemoteControlEnabled:e}}=t.value;e&&IR.log(`Remote control sharing device info changes.${JSON.stringify(_R.getShareStreamInfo())}`)})),rmclEpics7:(e,t)=>iR(e,t,Da.SendRemoteControlQrCode,(e=>{const{share:{status:n}}=t.value,{payload:{data:r}}=e;IR.log(`Remote control QR code result. sharing status:${n}, result${JSON.stringify(r)}`)}))},oO={epics0:(e,t)=>e.pipe(Ut(`${Bi}`),Ye((async e=>{const{meeting:{logConfig:n,logEncryptionPubKey:r,zlkJwtToken:i,accountId:o,enableAutoLog:s,collectionToggleEnable:a,zsk:u},logger:{options:c}}=t.value;let l=c||{};if(n)try{const{enable:e,enableReport:t}=JSON.parse(n);l={...l,enable:e,enableReport:t}}catch(e){}if(i){const{telemetry_tracking_id:t}=mi(i),{payload:{meetingId:n}}=e,r=null!=t?t:n;l={...l,enable:!0,enableReport:!0,trackingId:r}}else{let e=!1;e=u&&void 0!==a?!(s&&a):!s,Do.set(No.DisableAutoReportLogs,e,Oo.Memory)}return ER.init({...l,logConfig:n,logEncryptionPubKey:r,accountId:o}).then((()=>[dv(!0),lv(l)])).catch((()=>[dv(!1)]))})),Ye((e=>Me(e)))),epics1:(e,t)=>oR(e,t,as,(e=>{var n,r,i,o;const{payload:{body:s}}=e;if(s&&s.res===wi.Success){ER.makeLogger(["A/V Performance Info"]).info(`CPU cores:${navigator.hardwareConcurrency}, SharedArrayBuffer:${!!window.crossOriginIsolated}, browser:${Uo.browser} ${Uo.browserVersion}, OS:${Uo.os} ${Uo.osVersion}${uR("wow64",Uo.wow64)}${uR("GPU",Uo.gpu)}${uR("architecture",Uo.architecture)}${uR("bitness",Uo.bitness)}${uR("model",Uo.model)}${Do.get(No.EnforceWebRTCAudio)?"; Enforce WebTRC audio":""}`,["CPU_CORES"]);const{media:{enforceMultipleVideos:e,enforceVirtualBackground:n,assetsPath:r,disableRenderLimits:i},meeting:{stayAwake:o,quicklyLeave:s}}=t.value;ER.makeLogger(["Init Option"]).info(`Init option:${JSON.stringify({enforceMultipleVideos:e,disableRenderLimits:i,enforceVirtualBackground:n,assetsPath:r,stayAwake:o,leaveOnPageUnload:s})}`),"connection"in navigator&&(wR(),navigator.connection.addEventListener("change",wR))}else ER.report(`join meeting failed, error:${JSON.stringify(Ri(null==s?void 0:s.res))}, rwg error code:${null==s?void 0:s.res}, rwg conID:${null==s?void 0:s.conID}, error message:${null==s?void 0:s.error_desc}, rwg url:${null==s?void 0:s.svcUrl},mid:${t.value.meeting.meetingId}`,"JOIN_MEETING_FAILED","error");const{meeting:{meetingInfoTimestamp:a,pingRWCTimestamp:u,tid:c,meetingId:l,topic:d,accountId:h,cv:p},socket:{rwgServerList:f,retryCount:g},video:{rendererType:m},media:{patchJsMedia:v,assetsPath:y}}=t.value;let S=["conID","confID","mmrFeature","mmrFeatureEx","reportDomain","res","role","svcUrl","userID"].reduce(((e,t)=>void 0!==s[t]?{...e,[`${t}`]:s[t]}:e),{});S=["jid","mn","participantID","zoomID"].reduce(((e,t)=>void 0!==s[t]?{...e,[`${t}`]:GS(s[t])}:e),S),S.response=S.res,delete S.res;const b=["connection_info_map"];let E;if(s.res===wi.Success&&b.push("Command Socket Event","User Info Map"),c){const e=c.match(/clid=(\S+);/);e&&e.length>1&&(E=e[1])}const w=Math.floor(performance.now()-a),I=Math.floor(performance.now()-u);ER.report(JSON.stringify({...S,tid:c,mid:l,userRegion:E,rwgUrl:f.length>0?null===(n=f[g])||void 0===n?void 0:n.rwg:void 0,hardwareConcurrency:navigator.hardwareConcurrency,sharedArrayBuffer:!!window.crossOriginIsolated,browserVersion:`${Uo.browser} ${Uo.browserVersion}`,osVersion:`${Uo.os} ${Uo.osVersion}`,gpu:Uo.gpu,architecture:Uo.architecture,model:Uo.model,bitness:Uo.bitness,totalDurationOfJoining:w,durationOfRWG:I,rendererType:m,sdkVersion:p,mediaSdkVersion:null===(r=window.JsMediaSDK_Instance)||void 0===r?void 0:r.version,topic:d?GS(d):void 0,accountId:h?GS(h):void 0,patchJSMediaSDK:v,dependentAssets:y}),b,"info"),Ps.createAgent().sendRWGConnectionPerformance(`WCL_M, conId: ${null==s?void 0:s.conID}, trackingId: ${null===(i=t.value.logger)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.trackingId}, JOINFS(${w}), JOINFRWC(${I})`)})),epics2:(e,t)=>e.pipe(Ut(`${xi}`),Tt(t),ht((e=>{let[,t]=e;return void 0===t.meeting.encryptedRWC&&(void 0===t.meeting.encryptedGEORWC||0===t.meeting.encryptedGEORWC.length)})),rR(e,t,(()=>{const{label:e,payload:n}=nR(t.value);ER.report(`${e} ${JSON.stringify(n)}`,["Join Meeting Flow","Ping RWC Domain Empty"],"error")}))),epics3:(e,t)=>e.pipe(Ut(`${Ni}`),ht((e=>e.payload===To.OnError||e.payload===To.Disconnect||e.payload===To.NoHeartbeat)),rR(e,t,(e=>{const{payload:n}=e,{socket:{rwgServerList:r,retryCount:i}}=t.value,{payload:o}=nR(t.value);ER.report(`websocket unexpected disconnected,${JSON.stringify({code:n,rwgHost:r[i],...o})}`,["Join Meeting Flow","RWG Disconnect"])}))),epics4:(e,t)=>e.pipe(Ut(`${vo}`),rR(e,t,(e=>{const{payload:{reason:n,count:r,interval:i,sequence:o,userId:s,userGUID:a}}=e,{payload:u}=nR(t.value,{userId:s,userGUID:a});ER.report(`meeting failover,${JSON.stringify({reason:n,count:r,interval:i,sequence:o,detailed:bR(o),...u})}`,["Join Meeting Flow","Failover"]),"connection"in navigator&&navigator.connection.removeEventListener("change",wR)}))),epics5:(e,t)=>e.pipe(Ut(`${Bn}`),ht((e=>e.payload.status===Th.Connecting)),rR(e,t,(e=>{const{payload:{rwgUrl:n}}=e;let r=n.replace(/(\d+)\?/,`${GS("$1")}?`);r=["email","zoomid","participantID","dn2","customer_key","mpwd","topic"].reduce(((e,t)=>e.indexOf(t)>-1?e.replace(new RegExp(`${t}=([^&]+)`,"g"),`${t}=${GS("$1")}`):e),r);const{payload:i}=nR(t.value);ER.makeLogger(["Join Meeting Flow"]).info(`RWG URL,${JSON.stringify({rwgUrl:r,...i})}`,["RWG Url"])}))),epics6:(e,t)=>e.pipe(Ut(`${Dn}`),ht((e=>{const{payload:n}=e;return n?n.retry:t.value.meeting.meetingStatus===Co.Initial})),rR(e,t,(()=>{const{meeting:{meetingStatus:e},socket:{rwgServerList:n,retryCount:r}}=t.value;if(e!==Co.Joined){const{payload:e}=nR(t.value),i=(null==n?void 0:n.length)>0?n[r]:void 0;ER.report(JSON.stringify({...e,rwc:null==i?void 0:i.rwc,rwg:null==i?void 0:i.rwg}),["UNAVAILABLE_RWG"])}}))),epics7:(e,t)=>oR(e,t,1,(e=>{const{payload:{body:n}}=e;ER.report(`join meeting failed, version blocked. Current version:${t.value.meeting.cv},upgrade version:${null==n?void 0:n.upgradeVersion}`,"JOIN_MEETING_FAILED","error")})),epics8:(e,t)=>oR(e,t,2,(()=>{ER.report(`join meeting with low version of SDK. Current version:${t.value.meeting.cv}.`,"Join Meeting Flow","warn")})),epics9:(e,t)=>e.pipe(Ut(`${Di}`,`${ki}`),It((()=>Ad(Ws,1).pipe(At((e=>{try{const{payload:n}=nR(t.value);ER.report(`Connection change with join meeting failed. payload:${JSON.stringify(e)}. meeting info:${JSON.stringify(n)}`,"JOIN_MEETING_FAILED","error")}catch(e){}})),Ye((()=>ge))))))},sO=hr(oO,iO,rO),aO=Ps.createAgent(),uO={cmrStatus:Sa.Stop,recordingEnable:!1,recordingIsoEnable:!1,allowStopAutoRecording:!1,automaticCloudRecordingEnable:!1,isZoomIQ:!1,zoomIQChanging:!1,localStatus:ba.Stop,supportLocalRecording:Ea.None,localGrantPermissionOption:wa.None,localPermissionUserList:[]},cO=Rn({[`${bm}`]:hE(((e,t)=>{let{payload:n}=t;e.cmrStatus=n})),[`${Em}`]:hE(((e,t)=>{let{payload:n}=t;e.recordingEnable=n})),[`${wm}`]:hE(((e,t)=>{let{payload:n}=t;e.recordingIsoEnable=n})),[`${Im}`]:hE(((e,t)=>{let{payload:n}=t;e.allowStopAutoRecording=n})),[`${_m}`]:hE(((e,t)=>{let{payload:n}=t;e.automaticCloudRecordingEnable=n})),[`${Cm}`]:hE(((e,t)=>{let{payload:n}=t;e.isZoomIQ=n})),[`${Am}`]:hE(((e,t)=>{let{payload:n}=t;e.zoomIQChanging=n})),[`${Tm}`]:hE(((e,t)=>{let{payload:n}=t;e.localStatus=n})),[`${Rm}`]:hE(((e,t)=>{let{payload:n}=t;e.supportLocalRecording=n})),[`${Om}`]:hE(((e,t)=>{let{payload:n}=t;e.localGrantPermissionOption=n})),[`${Pm}`]:hE(((e,t)=>{let{payload:n}=t;e.localPermissionUserList=n})),[`${Dm}`]:()=>({...uO})},uO);var lO,dO,hO,pO,fO,gO,mO,vO,yO;const SO=Ps.createAgent(),bO=oT("Recording");let EO=(lO=eT("recording"),dO=eT("recording"),hO=eT("recording"),pO=eT("recording"),fO=eT("recording"),gO=eT("recording"),mO=eT("recording"),vO=eT("recording"),yO=class extends aT{startRecording(){const e=this[GA](),{meeting:{bIbDisableRecording:t,recordingEnable:n},recording:{cmrStatus:r}}=e;return t?Promise.reject({type:yl,reason:"Rejected by Information Barrier"}):n?r===Sa.Start?Promise.resolve(""):(SO.recordMeeting(!0,!1),Cd(Ia,(e=>e.cmrServerStatus===Sa.Start))):Promise.reject({type:yl,reason:"The account of the meeting disabled the cloud recording"})}pauseRecording(){const e=this[GA](),{recording:{cmrStatus:t,allowStopAutoRecording:n}}=e;return t===Sa.Pause?Promise.resolve(""):t!==Sa.Start?Promise.reject({type:yl,reason:"Recording is not started"}):n?(SO.recordMeeting(!1,!0),Cd(Ia,(e=>e.cmrServerStatus===Sa.Pause))):Promise.reject({type:yl,reason:"Cannot pause cloud recording due to web setting config"})}stopRecording(){const e=this[GA](),{recording:{cmrStatus:t,allowStopAutoRecording:n}}=e;return t===Sa.Stop?Promise.resolve(""):n?(SO.recordMeeting(!1,!1),Cd(Ia,(e=>e.cmrServerStatus===Sa.Stop))):Promise.reject({type:yl,reason:"Cannot stop cloud recording due to web setting config"})}accept(){const e=this[GA](),{recording:{cmrStatus:t,recordingIsoEnable:n}}=e,r=gh(e);return n?t!==Sa.Start&&t!==Sa.Pause?Promise.reject({type:yl,reason:"Recording is not started"}):null!=r&&r.bAllowISORecord?Promise.resolve("You accepted ISO recording"):(SO.allowSelfRecord(!0),Cd(_a,(e=>(null==e?void 0:e.userId)===(null==r?void 0:r.userId)&&(null==e?void 0:e.status)===ya.Accept))):Promise.reject({type:yl,reason:"ISO Recording is not enabled"})}decline(){const e=this[GA](),{recording:{cmrStatus:t,recordingIsoEnable:n}}=e,r=gh(e);return n?t!==Sa.Start&&t!==Sa.Pause?Promise.reject({type:yl,reason:"Recording is not started"}):!0===(null==r?void 0:r.bAllowISORecord)?Promise.reject({type:yl,reason:"You had accept ISO recording, cant change it"}):(SO.allowSelfRecord(!1),Promise.resolve("")):Promise.reject({type:yl,reason:"ISO Recording is not enabled"})}getRecordingStatus(){const e=this[GA](),{recording:{cmrStatus:t}}=e,n=Ch(e);return t===Sa.Start?ya.Recording:t===Sa.Pause?ya.Paused:n?ya.Recording:ya.Stopped}isRecordingEnabled(){const e=this[GA](),{recording:{recordingEnable:t}}=e;return t}isAllowedToStopAutoRecording(){const e=this[GA](),{recording:{allowStopAutoRecording:t}}=e;return t}isAutomaticCloudRecordingEnabled(){const e=this[GA](),{recording:{automaticCloudRecordingEnable:t}}=e;return t}enableRecordingWithIQ(e){const{[GA]:t,[zA]:n}=this,r=t(),{recording:{isZoomIQ:i,zoomIQChanging:o},meeting:{meetingOptions:s}}=t();return s.isEnableKiwiRecording?mh(r)?o?Promise.reject({type:yl,reason:"We are changing, please wait"}):e===i?Promise.reject({type:yl,reason:`You have ${e?"enable":"disable"} Zoom IQ, don't need change`}):(n(Am(!o)),n(Cm(!i)),SO.enableZoomIQRecord(e),Cd(Ra,(e=>null==e?void 0:e.success))):Promise.reject({type:yl,reason:"Only Host or co-host can enable/disable Zoom IQ"}):Promise.reject({type:yl,reason:"You not have zoom IQ license or not enable zoom IQ, please check and retry"})}isSupportLocalRecording(){const e=this[GA](),{meeting:{meetingOptions:t,isWebinar:n},breakoutRoom:r}=e;if((null==r?void 0:r.currentRoom.status)===ih.InRoom)return!1;const i=gh(e);return(!n||!eh(i.userRole))&&(null==t?void 0:t.isLocalRecordingEnabled)}isSupportLocalRecordingPermission(){const e=this[GA](),{recording:{supportLocalRecording:t}}=e;if(!this.isSupportLocalRecording())return!1;const n=gh(e);return!(null==n||!n.isHost)||t===Ea.Allow}askLocalRecordingPermission(){const{[GA]:e}=this,{recording:{supportLocalRecording:t}}=e();return this.isSupportLocalRecording()?t===Ea.None?(SO.localRecordingRequestPermission(),Promise.resolve("")):t===Ea.Allow?Promise.resolve(""):Promise.reject("permission is denied"):Promise.reject("not support")}startLocalRecording(e){const{[GA]:t,[zA]:n}=this,r=t(),{recording:{localStatus:i,supportLocalRecording:o},meeting:{userId:s}}=r;if(!(e in ba))return Promise.reject({type:yl,reason:"not support you parameter, only support type are 0(stop)/1(start)/2(pause)."});if(!this.isSupportLocalRecording())return Promise.reject({type:yl,reason:"not support local recording"});if(e===i)return Promise.resolve(`you currently status is ${i}, do nothing`);const a=gh(r);return o===Ea.Allow||null!=a&&a.isHost?(SO.localRecordingMeeting(e),Cd(Ca,(t=>(null==t?void 0:t.userId)===s&&(n(Tm(t.bLocalRecord)),t.bLocalRecord===e)),1e3)):Promise.reject({type:yl,reason:"you not have local recording permission, please use askLocalRecordingPermission request it first"})}isSupportLocalRecordingGrantPermission(){const e=this[GA]();if(!this.isSupportLocalRecording())return!1;const t=gh(e);return!(null==t||!t.isHost||!uy(t.caps))}grantLocalRecordingPermission(e,t,n){const{[GA]:r,[zA]:i}=this,o=r(),{recording:{localPermissionUserList:s}}=o;if(!this.isSupportLocalRecording())return Promise.resolve(!1);const a=gh(o);if(!uy(a.caps))return Promise.reject({type:yl,reason:"you can not grant permission"});let u=!1;if(n&&(u=!0),s.filter((t=>t===e)).length>0){if(t===Ea.Allow)SO.localRecordingGrantPermission(e,!0,u);else{if(t!==Ea.Deny)return Promise.reject({type:yl,reason:"only support DENY(1)/ALLOW(2)"});SO.localRecordingGrantPermission(e,!1,u)}return i(Pm(s.filter((t=>t!==e)))),Id(Aa,{type:"answer",value:t===Ea.Allow}),Promise.resolve(!1)}return t!==Ea.Deny?Promise.reject({type:yl,reason:"Direct grant only support DENY(1)"}):(SO.hostGrantPermission(e,!1),Cd(Aa,(n=>(null==n?void 0:n.value)===e&&(t===Ea.Allow?(i(Pm([...s,e])),!0===(null==n?void 0:n.canRecord)):(i(Pm(s.filter((t=>t!==e)))),!1===(null==n?void 0:n.canRecord)))),1e3))}getLocalRecordingPermissionUserList(){const e=this[GA](),{recording:{localPermissionUserList:t}}=e;if(!this.isSupportLocalRecording())return[];const n=gh(e);return uy(n.caps)?t:Promise.reject({type:yl,reason:"you can not grant permission"})}getLocalRecordingPermissionOperation(){const e=this[GA](),{recording:{localGrantPermissionOption:t}}=e;if(!this.isSupportLocalRecording())return null;const n=gh(e);return uy(n.caps)?t:null}},$A(yO.prototype,"startRecording",[ZA,YA,lO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"startRecording"),yO.prototype),$A(yO.prototype,"pauseRecording",[ZA,YA,dO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"pauseRecording"),yO.prototype),$A(yO.prototype,"stopRecording",[ZA,YA,hO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"stopRecording"),yO.prototype),$A(yO.prototype,"accept",[YA,pO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"accept"),yO.prototype),$A(yO.prototype,"decline",[YA,fO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"decline"),yO.prototype),$A(yO.prototype,"askLocalRecordingPermission",[YA,gO],Object.getOwnPropertyDescriptor(yO.prototype,"askLocalRecordingPermission"),yO.prototype),$A(yO.prototype,"startLocalRecording",[YA,mO],Object.getOwnPropertyDescriptor(yO.prototype,"startLocalRecording"),yO.prototype),$A(yO.prototype,"grantLocalRecordingPermission",[YA,XA,vO],Object.getOwnPropertyDescriptor(yO.prototype,"grantLocalRecordingPermission"),yO.prototype),yO);const wO={moduleEpics0:e=>e.pipe(Ut(`${Bi}`),Ke((e=>{const{payload:{recordingEnable:t}}=e;return Em(t)}))),moduleEpics1:(e,t)=>pr(e,is).pipe(ht((e=>{var t,n,r;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.cmrServerStatus)||void 0!==(null===(n=e.payload.body)||void 0===n?void 0:n.disAllowClientStopAutoCmr)||void 0!==(null===(r=e.payload.body)||void 0===r?void 0:r.enableAutomicRecordingCloud)})),Tt(t),Ye((e=>{let[t,n]=e;const{cmrServerStatus:r,disAllowClientStopAutoCmr:i,enableAutomicRecordingCloud:o}=t.payload.body,s=[];return void 0!==r&&(r!==Sa.Init&&(Id(Ia,{cmrServerStatus:r}),n.recording.recordingIsoEnable&&r===Sa.Start&&Id(_a,{status:ya.Ask})),s.push(bm(r))),void 0!==i&&s.push(Im(!i)),void 0!==o&&s.push(_m(o)),Me(s)}))),moduleEpics2:e=>pr(e,is).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.bCmrIsoEnble)})),Ke((e=>{const{bCmrIsoEnble:t}=e.payload.body;return wm(t)}))),moduleEpics3:(e,t)=>pr(e,rs).pipe(Tt(t),ht((e=>{let[t]=e;const{payload:{body:{update:n,add:r}}}=t;return(null==n?void 0:n.some((e=>void 0!==e.bLocalRecordStatus||void 0!==e.canRecord)))||(null==r?void 0:r.some((e=>void 0!==e.bLocalRecordStatus||void 0!==e.canRecord)))})),Ye((e=>{let[t,n]=e;const{payload:{body:{update:r,add:i}}}=t,{meeting:{userId:o,isHost:s},recording:{supportLocalRecording:a},participants:{attendeesList:u}}=n,c=[];return null==r||r.concat(i||[]).filter((e=>void 0!==e.bLocalRecordStatus||void 0!==e.canRecord)).forEach((e=>{if(void 0!==e.canRecord){const t=Boolean(e.canRecord);if(o===e.id||s){const n=u.find((e=>e.userId===o));!t&&null!=n&&n.bLocalRecord&&(Id(Aa,{type:"revoke",value:e.id,canRecord:t}),aO.localRecordingMeeting(ba.Stop)),!t||null!=n&&n.bLocalRecord||Id(Aa,{type:"grant",value:e.id,canRecord:t})}o===e.id&&((a!==Ea.None||t)&&c.push(Rm(t?Ea.Allow:Ea.Deny)),t||c.push(Tm(ba.Stop)))}else Id(Ca,{userId:e.id,bLocalRecord:e.bLocalRecordStatus})})),Me(c)}))),moduleEpics4:(e,t)=>pr(e,rs).pipe(Ke((e=>Ew(e.payload.body))),Tt(t),Ye((e=>{let[t,n]=e;const r=[],{recording:{localPermissionUserList:i}}=n;return t.remove&&t.remove.forEach((e=>{i.filter((t=>t===(null==e?void 0:e.userId)))&&(r.push(Pm(i.filter((t=>t!==(null==e?void 0:e.userId))))),Id(Aa,{type:"remove",value:null==e?void 0:e.userId}))})),Me(r)}))),moduleEpics5:e=>pr(e,rs).pipe(ht((e=>{const{payload:{body:{update:t}}}=e;return null==t?void 0:t.some((e=>void 0!==e.bAllowISORecord))})),At((e=>{const{payload:{body:{update:t}}}=e;t.filter((e=>void 0!==e.bAllowISORecord)).forEach((e=>{Id(_a,{userId:e.id,status:e.bAllowISORecord?ya.Accept:ya.Decline})}))})),St(ge)),moduleEpics6:e=>pr(e,is).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.SalesRecordingAnalytics)})),Ke((e=>{const{SalesRecordingAnalytics:t}=e.payload.body;return Id(Ta,{isZoomIQ:t}),Cm(t)}))),moduleEpics7:(e,t)=>pr(e,4319).pipe(Tt(t),ht((e=>{var t;let[n]=e;return void 0!==(null===(t=n.payload.body)||void 0===t?void 0:t.success)})),Ye((e=>{let[t,n]=e;const r=[],{success:i}=t.payload.body,{recording:{zoomIQChanging:o}}=n;return Id(Ra,{success:i}),i&&r.push(Am(!o)),Me(r)}))),moduleEpics8:(e,t)=>pr(e,4344).pipe(Tt(t),ht((e=>{var t;let[n]=e;return void 0!==(null===(t=n.payload.body)||void 0===t?void 0:t.cmdType)})),Ye((e=>{var t;let[n,r]=e;const i=[],{cmdType:o}=n.payload.body,{recording:{localPermissionUserList:s},meeting:{isHost:a}}=r;var u,c,l,d;return"permission_req_option"===o&&(Id(Aa,{type:"option",value:null===(u=n.payload.body)||void 0===u?void 0:u.option}),i.push(Om(null===(c=n.payload.body)||void 0===c?void 0:c.option))),"request_permission"===o&&null!==(t=n.payload.body)&&void 0!==t&&t.userId&&(a&&Id(Aa,{type:"request",value:null===(d=n.payload.body)||void 0===d?void 0:d.userId}),i.push(Pm([...s,null===(l=n.payload.body)||void 0===l?void 0:l.userId]))),"permission_request_answer"===o&&(Id(Aa,{type:"answer",value:n.payload.body.agreed}),i.push(Rm(n.payload.body.agreed?Ea.Allow:Ea.Deny))),Me(i)})))},IO=hr(wO);let _O=function(e){return e[e.All=1]="All",e[e.Private=2]="Private",e}({}),CO=function(e){return e.SUCCESS="success",e}({}),AO=function(e){return e.CustomizedKey="__zoom_internal_message_customized_key__@@",e.SpeakerOnly="__zoom_internal_message_speaker_only__@@",e}({});const TO=EE.getInstance(),RO=(e,t,n)=>{const{meeting:{encType:r}}=n,i=t,o=oi(e),s=i?_O.Private:_O.All;return r===Jo.AES_GCM?es.beginEncrypt({text:o,type:Qo.XMPP_CHAT}).then((e=>{TO.sendWebinarMseeage(e,i,s,!0)})):TO.sendWebinarMseeage(o,i,s,!1)};function OO(e,t){const{cmd:{jids:n}}=t;return Object.prototype.hasOwnProperty.call(n,e)?Promise.resolve():Be(Ad(qs).pipe(Et((t=>-1===t.findIndex((t=>Number(t.userId)===e)))),gt(1),ke(de)))}function PO(e){const{cmd:{connectionStatus:t}}=e;return t===CO.SUCCESS?Promise.resolve(!0):Be(Ad(ga,1)).then((e=>e===_o.Connected||Promise.reject({type:yl,reason:"Cannot establish the command channel"})))}function DO(e,t){for(const[n,r]of Object.entries(e))if(r.jid===t)return n}const kO={connectionStatus:"initial",jids:{}},xO=Rn({[`${Mm}`]:()=>({...kO}),[`${km}`]:hE(((e,t)=>{let{payload:n}=t;const{data:r,attendees:i}=n;r.forEach((t=>{const{jid:n,node:r}=t;if(!e.jids[r]||e.jids[r].jid!==n){const t=i.find((e=>e.userId===Number(r)));e.jids[r]={jid:n,userGuid:null==t?void 0:t.userGUID}}}))})),[`${xm}`]:hE(((e,t)=>{let{payload:n}=t;n.forEach((t=>{const{jid:n}=t,r=DO(e.jids,n);r&&delete e.jids[r]}))})),[`${Nm}`]:hE(((e,t)=>{let{payload:n}=t;e.connectionStatus=n}))},kO);var NO;let MO=(NO=class extends aT{send(e,t){if(!e)return Promise.reject({type:Il,reason:"Text is empty"});if("string"!=typeof e)return Promise.reject({type:Il,reason:"Text is not a string"});if(e.length>512)return Promise.reject({type:Il,reason:"Text exceeds the max length(512)."});const{[GA]:n}=this,r=n(),{socket:{xmppSocketStatus:i},meeting:{userId:o}}=r;return i!==Th.Connected?Promise.reject({type:wl,reason:"Command channel is not ready"}):PO(r).then((()=>t?-1!==bh(n()).findIndex((e=>e.userId===t))?OO(t,r).then((()=>{const{cmd:{jids:r}}=n();return r[t]?(RO(e,r[t].jid,n()),{timestamp:(new Date).getTime(),text:e,receiverId:t,senderId:o}):Promise.reject({type:Sl})})):Promise.reject({type:Il,reason:"Cannot find the user"}):(RO(e,"",r),{timestamp:(new Date).getTime(),text:e,receiverId:0,senderId:o})))}getJids(){const{[GA]:e}=this,t=e(),{cmd:{jids:n}}=t;return n}},$A(NO.prototype,"send",[YA],Object.getOwnPropertyDescriptor(NO.prototype,"send"),NO.prototype),NO);const FO={extraEpics0:(e,t)=>e.pipe(Ut(`${ap}`),It((e=>{const{payload:{speakerOnly:n}}=e,r=gh(t.value);return(void 0!==(null==r?void 0:r.audio)?Me([r.audio]):Ad(Bs).pipe(ht((e=>void 0!==e.audio)),gt(1))).pipe(At((()=>{PO(t.value).then((()=>{RO(`${AO.SpeakerOnly}${n?1:0}`,"",t.value)}))})),St(ge))}))),extraEpics1:(e,t)=>pr(e,rs).pipe(ht((e=>{var n,r;const{payload:{body:i}}=e;return!!i.add&&!(null===(n=t.value.audio)||void 0===n||null===(r=n.customizeAudioOption)||void 0===r||!r.speakerOnly)})),ke(de),At((async e=>{const{payload:{body:{add:n}}}=e,r=t.value,{meeting:{userId:i}}=r;for(let e=0;e<n.length;e++){const{id:r}=n[e];if(r!==i){await OO(r,t.value);const{cmd:{jids:e},participants:{attendeesList:n}}=t.value;e[r]&&setTimeout((()=>{RO(`${AO.SpeakerOnly}1`,e[r].jid,t.value)}),Math.floor(Math.random()*Math.log10(n.length)*1e3))}}})),St(ge))},LO={epics0:(e,t)=>gr(e,24577).pipe(Tt(t),Ke((e=>{let[t]=e;const{payload:{body:{status:n}}}=t;return n===CO.SUCCESS&&Id(ga,_o.Connected),Nm(n)}))),epics1:(e,t)=>gr(e,24583).pipe(Tt(t),Ye((e=>{let[t,n]=e;const{meeting:{userId:r,encType:i},cmd:{jids:o}}=n,{payload:{body:{senderName:s,senderJid:a,text:u,type:c,receiver:l,msgid:d,sn:h}}}=t,p=DO(o,l),f=i===Jo.AES_GCM,g=DO(o,a),m=(new Date).getTime();let v=Promise.resolve({message:u});return f&&(v=es.beginDecrypt({decryptedText:u,type:Qo.XMPP_CHAT,zoomId:h})),v.then((e=>{let{message:t}=e;if(c===_O.Private&&Number(p)===r||c===_O.All){const e=ii(t);if(null!=e&&e.startsWith(AO.SpeakerOnly)){const t=e.substring(AO.SpeakerOnly.length),n=1===Number(t);return Bd({userId:Number(g),key:"isSpeakerOnly",value:n})}{var n;const t=g&&(null===(n=o[g])||void 0===n?void 0:n.userGuid);Id(fa,{senderId:g,senderName:s,senderGuid:t,text:e,timestamp:m,msgid:d})}}return""}))})),ht((e=>"object"==typeof e&&null!==e&&void 0!==e.type)),At((e=>{const{payload:{userId:t,key:n,value:r}}=e;Id(Us,[{userId:t,[`${n}`]:r}])}))),epics2:(e,t)=>gr(e,24595).pipe(Ye((e=>{const{payload:{body:{action:n,data:r}}}=e,i=[];if([SE.List,SE.Add,SE.update].includes(n)&&r){const{breakoutRoom:e,participants:{attendeesList:n}}=t.value,o=(null==e?void 0:e.currentRoom.status)===ih.InRoom?n.concat(e.mainSessionAttendeeList):n;i.push(km({data:r,attendees:o}))}return n===SE.Remove&&r&&i.push(xm(r)),Me(i)})))},VO=hr(LO,FO),BO=(e,t,n,r)=>{const{getState:i,dispatch:o}=n,s=i(),{participants:{attendeesList:a},audio:{localShareAudioUserMutedList:u},share:{isReceiveSharingFromMainSession:c},breakoutRoom:l}=s,d=(c?null==l?void 0:l.mainSessionAttendeeList:a).find((t=>t.userId==e));if(d){if(d.bShareAudioOn){const n=u.find((t=>t.userId===e));return n&&n.muted===!t&&o(mI(r,e,t,s)),Promise.resolve("")}return Promise.reject({type:yl,reason:`Cannot ${t?"mute":"unmute"} share audio when the user's share audio is not enable.`})}return Promise.reject({type:Il,reason:"Cannot find the user"})},jO=(e,t)=>{const{store:{getState:n},rwgAgent:r}=e,{share:{sharePrivilege:i}}=n();return i===t?Promise.resolve(""):Object.values(Ha).includes(t)?(r.lockSharing(t),Wv("lockShare",t)):Promise.reject({type:Il})},UO=Kd([bh],(e=>e.filter((e=>e.bVideoOn)))),HO=Kd([UO],(e=>e.filter((e=>(e.caps&oy)===oy)))),qO=(e,t)=>{const n=e.store.getState(),r=hy(n).find((e=>e.userId===t));if(r){const{caps:e}=r;return(e=>!(512&~e))(e)}return!1};var KO,$O,WO,GO,zO,JO,QO,YO,ZO,XO,eP,tP,nP,rP,iP,oP,sP,aP,uP,cP,lP,dP,hP,pP,fP,gP,mP,vP,yP,SP,bP,EP,wP,IP,_P,CP,AP,TP,RP,OP,PP,DP,kP,xP,NP,MP,FP,LP,VP,BP,jP,UP,HP,qP,KP,$P,WP,GP,zP,JP,QP,YP,ZP,XP,eD,tD,nD,rD,iD,oD,sD,aD,uD,cD,lD,dD,hD,pD,fD;const gD=oT("Audio"),mD=oT("Video"),vD=oT("Sharing"),yD=oT("CameraControl"),SD=oT("Remote Control"),bD=sT(HTMLCanvasElement,0),ED=sT([HTMLCanvasElement,HTMLVideoElement],0),wD=sT(HTMLCanvasElement,0,["id"]),ID=sT([HTMLCanvasElement,HTMLVideoElement],0,["id"]);let _D=(KO=eT("audio"),$O=eT("audio"),WO=eT("audio"),GO=eT("audio"),zO=eT("audio"),JO=oT("Audio",[1,2,3]),QO=eT("audio"),YO=oT("Audio",[1,2]),ZO=eT("audio"),XO=eT("audio"),eP=eT("audio"),tP=eT("audio"),nP=eT("share"),rP=eT("audio"),iP=eT("share"),oP=eT("audio"),sP=eT("audio"),aP=eT("audio"),uP=eT("audio"),cP=eT("audio"),lP=eT("audio"),dP=oT("Audio",[1,2]),hP=eT("audio"),pP=oT("Audio",[1,2]),fP=eT("audio"),gP=eT("audio"),mP=eT("video"),vP=eT("video"),yP=eT("video"),SP=eT("video"),bP=eT("video"),EP=eT("video"),wP=eT("video"),IP=eT("video"),_P=eT("video"),CP=eT("video"),AP=eT("video"),TP=eT("video"),RP=eT("video"),OP=eT("video"),PP=eT("video"),DP=eT("video"),kP=eT("video"),xP=eT("video"),NP=eT("video"),MP=eT("video"),FP=eT("video"),LP=eT("video"),VP=eT("video"),BP=eT("video"),jP=eT("video"),UP=eT("video"),HP=eT("share"),qP=eT("share"),KP=eT("share"),$P=eT("share"),WP=eT("share"),GP=eT("share"),zP=eT("share"),JP=eT("share"),QP=tT("isShareOptionLocked"),YP=tT("isShareOptionLocked"),ZP=eT("share"),XP=eT("share"),eD=eT("share"),tD=eT("share"),nD=eT("share"),rD=eT("share"),iD=eT("share"),oD=eT("share"),sD=eT("share"),aD=eT("share"),uD=eT("share"),cD=eT("share"),lD=eT("share"),dD=eT("share"),hD=eT("share"),pD=eT("share"),fD=class extends aT{constructor(e){super(e),this[WA].dispatch($n()),this[QA]={store:e,mediaAgent:Lv(nb(Ls.getInstance())),rwgAgent:Ps.createAgent()}}startAudio(e){return((e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i,mediaAgent:o}=e,s=n(),a=gh(s);if((null==a?void 0:a.audio)===yu.Computer)return Promise.resolve("");if((null==a?void 0:a.audio)===yu.Phone)return Promise.reject({type:yl,reason:"joined by phone"});{const{audio:{isAllowToTalk:e,isComputerAudioLoading:u,canPlayAudio:c,customizeAudioOption:{speakerOnly:l}},media:{audioDecodeStatus:d,audioEncodeStatus:h}}=s;if(u)return Promise.reject({type:yl,reason:"Computer audio has been loading, please wait."});const p=function(e){const t=e?{...e}:void 0;if(_I(Ho())||!0!==(null==t?void 0:t.backgroundNoiseSuppression)||(console.warn("Background noise suppression requires SharedArrayBuffer and is only supported on desktop browser"),Object.assign(t,{backgroundNoiseSuppression:void 0})),void 0!==(null==t?void 0:t.originalSound)){t.backgroundNoiseSuppression&&t.originalSound&&(console.warn("Enabling original sound will disable background noise suppression."),Object.assign(t,{backgroundNoiseSuppression:!1}));const{originalSound:e}=t;"object"==typeof e&&e.stereo&&!CI()&&(console.warn("Cannot enable stereo audio on current platform due to the browser limitation"),Object.assign(e,{stereo:!1}))}return AI()||!0!==(null==t?void 0:t.syncButtonsOnHeadset)||(console.warn("Sync buttons on headset is not supported on the current platform"),Object.assign(t,{syncButtonsOnHeadset:void 0})),null!=t&&t.mediaFile&&!Ls.isSupportMediaPlaybackAsVideoInput()&&(console.warn("Cannot use media file as audio input due to the browser limitation"),Object.assign(t,{mediaFile:void 0})),t}(t);r(ap(null!=p?p:{}));const{speakerOnly:f,autoStartAudioInSafari:g}=p||{};if(!!l!=!!f&&r(Bd({userId:s.meeting.userId,key:"isSpeakerOnly",value:!!f})),!a)return Promise.reject({type:yl,reason:"Please call `startAudio` method after the `join` has been resolved"});{const t=eh(a.userRole)&&!e||f,{encodeInitStatus:u,decodeInitStatus:l}=TI(s,a,f);if(EI()&&("success"!==l||"success"!==u))return Promise.reject({type:yl,reason:"It is required to wait for the audio encoding and decoding to be ready before calling `startAudio` method"});r(Wh(!0)),Rv("audio",u,l).subscribe((s=>{let[u,l]=s;if(u&&l){let s=c||(EI()||Uo.isIOSMobile)&&!g?Promise.resolve():function(){const e=URL.createObjectURL(Ba),t=new Audio(e);t.muted=!1;const n=pi((()=>Promise.reject()),3e3),r=Uo.isIOSMobile?new Promise(((e,n)=>{var r;t.addEventListener("canplaythrough",(()=>{t.play().then((()=>{e(!0)})).catch((e=>{n(e)}))})),null===(r=t.load)||void 0===r||r.call(t)})):t.play();return Promise.race([r,n]).finally((()=>{URL.revokeObjectURL(e)}))}();void 0===s&&(s=Promise.resolve()),s.then((()=>Pv("audio",n()))).then((()=>{const s=n(),{audio:{isSharingAudio:u}}=s;RI(i,s,t),u&&!II()||vI(o,s,!t),eh(a.userRole)&&e&&r(Gh(!0)),r(Kh(!0))})).catch((()=>{r(Kh(!1)),r(Wh(!1))}))}else r(Wh(!1))}))}return"failed"===h||"failed"===d?(r(Wh(!1)),Promise.reject({type:Sl,reason:"audio encode or decode error"})):new Promise(((e,t)=>{pt(Ad(jc.JoinComputerAudio.success,1),ct(...jc.JoinComputerAudio.fail.map((e=>Ad(e,1).pipe(Ye((()=>Le({type:El,reason:e}))))))),at(45e3).pipe(Ye((()=>Le({type:bl}))))).subscribe({next:()=>{r(Wh(!1)),e("")},error:e=>{Ls.getInstance().leaveComputerAudio();const o=gh(n());(null==o?void 0:o.audio)!==yu.Phone&&(r(vp(Fa.MicrophoneError)),i.joinOrLeaveVoip(!1)),r(Wh(!1)),t(e)}})}))}})(this[QA],e)}stopAudio(){return(async e=>{const{store:{getState:t,dispatch:n},mediaAgent:r,rwgAgent:i}=e,o=t(),{audio:{isComputerAudioLoading:s,isShareAudioEnabled:a,isSharingAudio:u,isUsingMediaPlayback:c,customizeAudioOption:{speakerOnly:l}}}=o,d=gh(o);if(s)return Promise.reject({type:yl,reason:"Computer audio has not finished joining, please wait."});if(a){if(u&&!II())return Promise.reject({type:yl,reason:"Cannot stop audio during sharing with audio"});n(Yh(void 0)),n(zh(void 0))}return(null==d?void 0:d.audio)===yu.Computer?(n(vp(Fa.Active)),await r.leaveComputerAudio(),i.joinOrLeaveVoip(!1),l&&n(Bd({userId:o.meeting.userId,key:"isSpeakerOnly",value:void 0})),c&&Gv.getInstance().stopAudioElement(),n(Bh(0)),Cd(gc)):Promise.resolve("")})(this[QA])}muteAudio(e){return((e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i,mediaAgent:o}=e,s=n(),a=gh(s);if(null==t||t===(null==a?void 0:a.userId))return""===(null==a?void 0:a.audio)||null===(null==a?void 0:a.audio)?Promise.reject({type:yl,reason:"no audio joined"}):!0===(null==a?void 0:a.muted)?Promise.resolve(""):(r(fp(Na.Active)),i.mute(a.userId,!0),o.muteAudio(),s.audio.isShareAudioEnabled&&!II()&&r(zh(!0)),Cd(mc).then((()=>"")));if(mh(s)){const{participants:{allowTalkAttendeesList:e,attendeesList:n}}=s,r=e.concat(n).find((e=>e.userId===t));return r?""===r.audio||null===r?Promise.reject({type:yl,reason:"no audio joined"}):!1===r.muted?(i.mute(t,!0),Cd(yc,(e=>e.id===t&&1==e.muted))):Promise.resolve(""):Promise.reject({type:Il,reason:"no matching user"})}return Promise.reject({type:El})})(this[QA],e)}unmuteAudio(e){return(async(e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i,mediaAgent:o}=e,s=n(),a=gh(s);if(void 0===t||t===(null==a?void 0:a.userId)){if(""===(null==a?void 0:a.audio)||null===(null==a?void 0:a.audio))return Promise.reject({type:yl,reason:"no audio joined"});if(!1===(null==a?void 0:a.muted))return Promise.resolve("");if(s.audio.isShareAudioEnabled&&!II()){if(s.audio.isSharingAudio)return Promise.reject({type:yl,reason:"Cannot unmute audio during sharing with audio"});r(zh(!1))}if(s.audio.bCanUnmute||null!=a&&a.isHost||null!=a&&a.bCoHost){if(eh(a.userRole)){const{audio:{isAllowToTalk:e,isAllowToTalkAttendeeConnected:t}}=s;e?t||(await o.leaveComputerAudio(),await vI(o,s,!0),r(Gh(!0))):Promise.reject({type:yl,reason:"Webinar attendee cannot unmute self audio."})}return r(gp(Ma.Active)),i.mute(a.userId,!1),o.unmuteAudio(),Cd(vc).then((()=>""))}return Promise.reject({type:El,reason:"host not allow unmute themselves"})}if(mh(s)){const{participants:{allowTalkAttendeesList:e,attendeesList:n}}=s,r=e.concat(n).find((e=>e.userId===t));return r?""===r.audio||null===r?Promise.reject({type:yl,reason:"no audio joined"}):(!0===r.muted&&i.mute(t,!1),Promise.resolve("")):Promise.reject({type:Il,reason:"no matching user"})}return Promise.reject({type:El})})(this[QA],e)}dialOut(e,t,n,r){return((e,t,n,r,i)=>{const{store:{getState:o,dispatch:s},rwgAgent:a}=e,u=o(),{meeting:{callOutCountry:c,isSupportCallOut:l}}=u;if(l&&Array.isArray(c)&&c.findIndex((e=>e.code===t))>-1){const{seq:e}=a.audioDialout(t+n,r,!(null==i||!i.callMe),!(null==i||!i.pressingOne),!(null==i||!i.greeting));return s(kh({sequence:e,phoneNumber:t+n})),_d(jc.JoinAudioByCallMe)}return Promise.reject({type:Il,reason:"no matching country code"})})(this[QA],e,t,n,r)}cancelDialOut(e,t,n){return((e,t,n,r)=>{const{rwgAgent:i}=e;return i.audioCancelDialout(t+n,!(null==r||!r.callMe)),_d(jc.cancelDialOut)})(this[QA],e,t,n)}hangup(){return(e=>{const{store:{getState:t},rwgAgent:n}=e,r=t(),i=gh(r);return(null==i?void 0:i.audio)===yu.Phone&&null!==i.userId?(n.audioDrop(i.userId),_d(jc.hangup)):Promise.reject({type:yl,reason:"not joined audio by phone"})})(this[QA])}switchMicrophone(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i}=e,o=n(),{audio:{microphoneDevicesList:s,activeMicrophone:a,mediaPlaybackFile:u,isUsingMediaPlayback:c}}=o,l=s.find((e=>e.deviceId===t));if("default"===t||"string"!=typeof t||l){const e=gh(o);if((null==e?void 0:e.audio)===yu.Computer){let n=!1;if("string"==typeof t)t!==a&&(i.changeMicrophone(t,null==l?void 0:l.label,!(null==e||!e.muted)),r(lp(void 0)),Gv.getInstance().stopAudioElement(),n=!0);else if(t&&(!c||(null==u?void 0:u.url)!==t.url)){const o=Gv.getInstance();o.setAudioElement(t).then((()=>{i.changeMicrophone(o.audioElement,void 0,!(null==e||!e.muted)),r(lp(t))})),n=!0}if(n)return _d(jc.JoinComputerAudio)}else"string"==typeof t&&r(Hh(t));return Promise.resolve("")}return Promise.reject({type:Rc})})(this[QA],e)}switchSpeaker(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i}=e,{audio:{speakerDevicesList:o,activeSpeaker:s}}=n();if("default"!==t&&-1==o.findIndex((e=>e.deviceId===t)))return Promise.reject({type:Rc});var a;if((null===(a=gh(n()))||void 0===a?void 0:a.audio)===yu.Computer){if(t!==s)return i.changeSpeaker(t),Cd(xc,(e=>e))}else r(qh(t));return Promise.resolve("")})(this[QA],e)}muteShareAudio(e){return((e,t)=>{const{mediaAgent:n,rwgAgent:r,store:{getState:i,dispatch:o}}=e,s=i(),{meeting:{userId:a}}=s;if(t&&t!==a)return BO(t,!0,e.store,n);{const{audio:{isSharingAudio:e,isShareAudioEnabled:t,isShareAudioMuted:i}}=s;if(!t)return Promise.reject({type:yl,reason:"Cannot mute sharing audio when sharing audio is not enable"});if(i)return Promise.resolve("");{r.muteShareAudio(!0);let t=Promise.resolve();var u;return e&&(t=null===(u=n.leaveSharingAudio(!0))||void 0===u?void 0:u.then((()=>yI(n,r,s).then((e=>{e.forEach((e=>o(e)))}))))),mI(n,a,!0,s),Promise.all([Cd({event:Bs,operations:[ht((e=>void 0!==e.bShareAudioOn)),gt(1)]},(e=>!1===e.bShareAudioOn)),t]).then((()=>(o(Xh(!0)),e&&(o(ep(!1)),Id(Pc,{state:"off"})),"")))}}})(this[QA],e)}unmuteShareAudio(e){return((e,t)=>{const{mediaAgent:n,rwgAgent:r,store:{getState:i,dispatch:o}}=e,s=i(),{meeting:{userId:a}}=s;if(t&&t!==a)return BO(t,!1,e.store,n);{const{audio:{isSharingAudio:e,isShareAudioEnabled:t,isShareAudioMuted:i},share:{status:u}}=s;if(!t)return Promise.reject({type:yl,reason:"Cannot unmute sharing audio when sharing audio is not enable"});if(!1===i)return Promise.resolve("");{r.muteShareAudio(!1);let t=Promise.resolve();return!1===e&&u===qa.Sharing&&(t=bI(n,r,s).then((e=>{e.forEach((e=>o(e)))}))),mI(n,a,!1,s),Promise.all([Cd({event:Bs,operations:[ht((e=>void 0!==e.bShareAudioOn)),gt(1)]},(e=>!0===e.bShareAudioOn)),t]).then((()=>(o(Xh(!1)),!1===e&&u===qa.Sharing&&(o(ep(!0)),Id(Pc,{state:"on"})),"")))}}})(this[QA],e)}subscribeAudioStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{getState:r}}=e,i=r(),o=gh(i),s=!t||t.decode,a=!t||t.encode;if(!o)return Promise.reject({type:yl,reason:"Call this function after the 'join' method resolved."});{const{encodeInitStatus:e,decodeInitStatus:t}=TI(i,o);Rv("audio",e,t).subscribe((e=>{let[t,r]=e;t&&r&&(s&&n.subscribeToQos([Ms.AudioDecode],eu),a&&n.subscribeToQos([Ms.AudioEncode],eu))}))}return""})(this[QA],e)}unsubscribeAudioStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{dispatch:r}}=e,i=!t||t.decode,o=!t||t.encode;return i&&(n.unsubscribeFromQos([Ms.AudioDecode]),r(tp(cu))),o&&(n.unsubscribeFromQos([Ms.AudioEncode]),r(np(cu))),null})(this[QA],e)}enableBackgroundNoiseSuppression(e){return((e,t)=>{const{mediaAgent:n,store:{getState:r,dispatch:i}}=e,{audio:{isBackgroundNoiseSuppression:o,originalSound:s}}=r();let a=t;return a===!!o||(a&&!_I(Ho())?(console.warn("Background noise suppression requires SharedArrayBuffer and is only supported on desktop browser"),a=!1):(a&&s&&(console.warn("Enabling noise suppression will disable original sound."),i(mp(!1))),i(up(a)),n.changeAudioProfile(gI(r())))),Promise.resolve("")})(this[QA],e)}enableSyncButtonsOnHeadset(e){return((e,t)=>{const{mediaAgent:n,store:{getState:r,dispatch:i}}=e,o=r(),{audio:{isHIDEnabled:s,microphoneDevicesList:a,activeMicrophone:u}}=o;if(t===!!s)return Promise.resolve("");{const e=gh(o);var c;return e?(t&&!AI()?console.warn("Sync buttons on headset is not supported on the current platform"):(n.enableSyncButtonsOnHeadset(t,null===(c=a.find((e=>e.deviceId===u)))||void 0===c?void 0:c.label,e.muted),i(cp(t))),Promise.resolve("")):Promise.reject({type:yl,reason:"Please call `enableSyncButtonsOnHeadset` method after the `join` has been resolved"})}})(this[QA],e)}enableOriginalSound(e){return((e,t)=>{const{mediaAgent:n,store:{getState:r,dispatch:i}}=e,{audio:{isBackgroundNoiseSuppression:o,originalSound:s}}=r(),a=t;return a===s||"object"==typeof t&&di(t,s)||("object"!=typeof a||!0!==(null==a?void 0:a.stereo)||CI()||(console.warn("Cannot enable stereo audio on current platform due to the browser limitation"),a.stereo=!1),o&&a&&(console.warn("Enabling original sound will disable background noise suppression."),i(up(!1))),i(mp(a)),n.changeAudioProfile(gI(r()))),Promise.resolve("")})(this[QA],e)}callCRCDevice(e,t){return((e,t,n)=>{const{rwgAgent:r,store:{dispatch:i,getState:o}}=e,{seq:s}=r.inviteCRCDevice(t,n);return i(Sp({sequence:s,ip:t,protocol:n})),_d(jc.crcCallOut).then((()=>{var e;const{audio:{crcDevice:r}}=o();return null===(e=r.find((e=>e.ip===t&&e.protocol===n&&e.sequence===s)))||void 0===e?void 0:e.uuid}))})(this[QA],e,t)}cancelCallCRCDevice(e,t){return((e,t,n)=>{const{rwgAgent:r,store:{getState:i}}=e,{audio:{crcDevice:o}}=i(),s=o.find((e=>e.ip===t&&e.protocol===n));return s&&s.returnCode===Ou.Ringing?(r.cancelInviteCRCDevice(s.transId),Promise.resolve("")):Promise.reject({type:yl,reason:"Cannot cancel call out "})})(this[QA],e,t)}muteAllAudio(){return(e=>{const{rwgAgent:t}=e;return t.audioMuteAll(!0),Wv("bMutedAll",!0)})(this[QA])}unmuteAllAudio(){return(e=>{const{rwgAgent:t}=e;return t.audioMuteAll(!1),Wv("bMutedAll",!1)})(this[QA])}getMicList(){return(e=>{let{store:{getState:t}}=e;const n=t();return n.audio?[...n.audio.microphoneDevicesList]:[]})(this[QA])}getSpeakerList(){return(e=>{let{store:{getState:t}}=e;const n=t();return n.audio?[...n.audio.speakerDevicesList]:[]})(this[QA])}getAudioState(e){return((e,t)=>{let{store:{getState:n}}=e;const r=n(),{meeting:{isWebinar:i}}=r;let o=null;return null==t?o=gh(r):(o=r.participants.attendeesList.find((e=>e.userId===t)),i&&!o&&(o=r.participants.xmppAttendeeList.find((e=>e.userId===t)))),o?o.audio:null})(this[QA],e)}isAudioMuted(e){return((e,t)=>{let{store:{getState:n}}=e;const r=n(),{meeting:{isWebinar:i}}=r;let o=null;return void 0===t?o=gh(r):(o=r.participants.attendeesList.find((e=>e.userId===t)),i&&!o&&(o=r.participants.xmppAttendeeList.find((e=>e.userId===t)))),!!o&&!!o.muted})(this[QA],e)}getActiveMicrophone(){return(e=>{let{store:{getState:t}}=e;const n=t();return n.audio?n.audio.activeMicrophone:null})(this[QA])}getActiveSpeaker(){return(e=>{let{store:{getState:t}}=e;const n=t();return n.audio?n.audio.activeSpeaker:null})(this[QA])}isSupportCallOut(){return(e=>{let{store:{getState:t}}=e;const{meeting:{isSupportCallOut:n,callOutCountry:r}}=t();return n&&Array.isArray(r)&&(null==r?void 0:r.length)>0})(this[QA])}getDialOutStatus(){return(e=>{let{store:{getState:t}}=e;const{audio:n}=t();return null==n?void 0:n.dialout[n.dialout.length-1].returnCode})(this[QA])}getDialOutCountries(){return(e=>{let{store:{getState:t}}=e;const{meeting:{callOutCountry:n}}=t();return Array.isArray(n)?n:[]})(this[QA])}getShareAudioStatus(){return(e=>{let{store:{getState:t}}=e;const{audio:{isShareAudioEnabled:n,isShareAudioMuted:r,isSharingAudio:i}}=t();return{isShareAudioEnabled:n,isShareAudioMuted:r,isSharingAudio:i}})(this[QA])}isOthersShareAudioMutedLocally(e){return((e,t)=>{var n;let{store:{getState:r}}=e;const{audio:{localShareAudioUserMutedList:i}}=r();return null===(n=i.find((e=>e.userId===t)))||void 0===n?void 0:n.muted})(this[QA],e)}getAudioStatisticData(){return(e=>{let{store:{getState:t}}=e;const{audio:{statistic:n}}=t();return{...n}})(this[QA])}getDialInInfo(){return(e=>{let{store:{getState:t}}=e;const{meeting:{meetingNumber:n,tollNumbers:r,participantID:i,h323Password:o}}=t();return void 0===r?null:{meetingId:n,participantId:i,password:o||"",tollNumbers:r.map((e=>({...e})))}})(this[QA])}isSupportMicrophoneAndShareAudioSimultaneously(){return II()}startVideo(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i}=e,o=n(),{media:{videoDecodeStatus:s,videoEncodeStatus:a,enforceVirtualBackground:u},video:{isCaptureCameraLoading:c,isCurrentUserStartedVideo:l,isVideoMuted:d}}=o,h=t?{...t}:void 0;if(l)return Promise.reject({type:yl,reason:"Video is started"});if(c)return Promise.reject({type:yl,reason:"Camera is starting,please wait."});if(d&&!mh(o))return Promise.reject({type:yl,reason:"Video is muted by the host"});if(tA(u)&&!((null==h?void 0:h.videoElement)instanceof HTMLVideoElement)){console.warn('Rendering self-view on Chromium browser, Android browser without SharedArrayBuffer or iOS browser requires video tag, Please pass a video element instead of a canvas element in the "renderVideo" method');let e=document.body.querySelector(`#${uu}`);if(!e){e=document.createElement("video");const t=Uo.isSafari||Uo.isIOSMobile?"position:fixed;top:-10000px;left:-10000px":"display:none";e.setAttribute("style",t),e.muted=!0,e.playsInline=!0,e.autoplay=!0,e.id=uu,document.body.appendChild(e)}h&&Object.assign(h,{videoElement:e})}return!Vv(u)&&null!=h&&h.virtualBackground?Promise.reject({type:Il,reason:"Virtual background only compatible with Chrome and Edge with SharedArrayBuffer enabled."}):(r(gf(!0)),Rv("video",a,s).subscribe((e=>{let[t]=e;if(t){const e=n(),{video:{activeCamera:t,isSupportHDVideo:o,virtualBackground:{imageSrc:s},mask:{imageSrc:a}}}=e,{cameraId:u=t,captureWidth:c=0,captureHeight:l=0,mirrored:d,hd:p,fullHd:f,virtualBackground:g,mask:m}=h||{};d&&i.mirrorVideo(d),(p||f)&&(console.log("HD support is currently limited, and comes with a number of restrictions and limitations. Please visit https://developers.zoom.us/docs/video-sdk/web/video/#720p-video for more details"),o&&Ls.isCompatibleHardwareForEncode()&&Ls.isSupportVideoEncodeHardwareAcceleration().then((e=>{e&&(i.enableHardwareAccelerationForVideoEncode(!0),r(xf({encode:e})))})),o||console.warn("Cannot capture HD video due to either account restriction and/or hardware limitation"));const v=g||void 0===g&&!!s&&void 0===m,y=m||void 0===m&&!!a;let S=Promise.resolve({});if(v){const t=g||{imageUrl:void 0,cropped:void 0};S=pA({...t,captureWidth:c,captureHeight:l,cameraId:u,hd:p},i,e).then((()=>t))}else if(y){const t=m||{imageUrl:void 0,cropped:void 0,clip:void 0,rootWidth:void 0,rootHeight:void 0};t.rootWidth||Object.assign(t,{rootWidth:1280}),t.rootHeight||Object.assign(t,{rootHeight:720}),S=fA({...t,captureWidth:c,captureHeight:l,cameraId:u,hd:p},i,e).then((()=>t))}null!=h&&h.mediaFile&&!Ls.isSupportMediaPlaybackAsVideoInput()&&(console.warn("Cannot use media file as video input due to the browser limitation."),Object.assign(h,{mediaFile:void 0})),S.then((e=>Pv("video",n()).then((()=>e)))).then((t=>{QC(i,e,h).forEach((e=>{r(e)})),v?r(Pf(t)):y&&r(Gf(t))})).catch((e=>{r(gf(!1)),Id(Bu,{reason:e})}))}else r(gf(!1))})),_d(uc.startCaptureVideo).then((()=>{r(mf(!1)),r(hf(!1))})).finally((()=>{r(gf(!1))})))})(this[QA],e)}stopVideo(){return(e=>{const{store:{getState:t},mediaAgent:n}=e,{video:{isCaptureCameraLoading:r,isCurrentUserStartedVideo:i,isUsingMediaPlayback:o}}=t();return r?Promise.reject({type:yl,reason:"Camera is starting,please wait."}):i?(n.stopCaptureVideo(),o&&Gv.getInstance().stopVideoElement(),Cd(Hu,(e=>!0!==(null==e?void 0:e.failed)))):Promise.reject({type:yl,reason:"camera is closed"})})(this[QA])}switchCamera(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i}=e,o=n(),{video:{cameraDevicesList:s,isCurrentUserStartedVideo:a,virtualBackground:u,mask:c,mediaPlaybackFile:l,isUsingMediaPlayback:d,customizedVideoOption:h}}=o;if("string"==typeof t&&!zC(t,s))return Promise.reject({type:Il,reason:"Cannot find cameraDeviceId in camera devices list."});if(a||null!=u&&u.isVBConfigured||c.isMaskConfigured){if("string"==typeof t){const{captureWidth:e,captureHeight:n}=GC(h);i.changeCamera(t,Xa.includes(t),{width:e,height:n}),r(Qf(void 0)),Gv.getInstance().stopVideoElement()}else if(t&&(!d||(null==l?void 0:l.url)!==t.url)){const e=Gv.getInstance();e.setVideoElement(t).then((()=>{i.changeCamera(e.videoElement),r(Qf(t))}))}return _d(uc.switchCameraVideo).then((()=>{r(mf(!1)),r(hf(!1))}))}return Promise.resolve()})(this[QA],e)}renderVideo(e,t,n,r,i,o,s,a,u){return((e,t,n,r,i,o,s,a,u,c)=>{const{store:{getState:l,dispatch:d},mediaAgent:h,rwgAgent:p}=e,f=l(),{meeting:{userId:g},media:{enforceMultipleVideos:m,enforceVirtualBackground:v,disableRenderLimits:y},video:{subscribedVideoList:S,renderedVideoList:b}}=f,E=$o(!!m,y),w=tA(v)&&n===g;if(t instanceof HTMLCanvasElement&&!S.includes(n)&&S.length>=E&&new Set(b.map((e=>e.canvasId))).has(t.id))return Promise.reject({type:yl,reason:`subscribe video counts greater than maximum size (${E})`});if(-1===UO(f).findIndex((e=>e.userId===n)))return Promise.reject({type:Il,reason:"user is not send video"});if(t.id||(t.id=fi("__ZOOM_SDK_VIDEO_CANVAS_@__")),w){if(t instanceof HTMLVideoElement){t.playsInline=!0,t.muted=!0,t.autoplay=!0,Uo.isIOSMobile&&(h.switchCanvasForVideoCapture(t),d(ag())),h.renderVideo(t,n,u||nu,r,i,o,s,a,!0,c||"",!1),d(Sf(n)),d(sg(t.id));const e=document.querySelector(`#${uu}`);return e&&e.remove(),Promise.resolve("")}return Promise.reject({type:Il,reason:"You must use a <video> element to render self video for Chromium browser, Android browser without SharedArrayBuffer or iOS browser "})}const I=!!c,{media:{videoDecodeStatus:_}}=f;return Rv("video","success",_).subscribe((async e=>{let[f,m]=e;if(m){const{video:{ensuredCanvas:e,renderedVideoList:f}}=l();let m=t;e.includes(t.id)||(m=xv(t),d(Jf(t.id)));const v=n===g,[y,b]=rA(n,a,l()),E=u||nu,w=await async function(e,t){const{video:{prefetchedVideo:n}}=t;return(null==n?void 0:n.userId)!==e||n.loaded?"":Be(pt(Ad(oc,1),at(1e3).pipe(mt(""))))}(n,l());f.some((e=>e.userId===n&&e.key===E&&e.canvasId===m.id))||h.renderVideo(m,n,E,r,i,o,s,b,v,c||"",I),n!==g&&p.subscribeVideo(n,b,!1),S.includes(n)||d(Sf(n)),w&&d(Yf(void 0)),d(If({userId:n,key:E,canvasId:m.id,videoQuality:y,aspectRatio:i?r/i:0}))}})),"failed"===_?Promise.reject({type:Sl,reason:"Video  decode status is failed"}):Promise.resolve("")})(this[QA],e,t,n,r,i,o,s,a,u)}stopRenderVideo(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;return function(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6?arguments[6]:void 0;const{store:{getState:a,dispatch:u},mediaAgent:c,rwgAgent:l}=e,d=a(),{video:{subscribedVideoList:h,renderedVideoList:p},meeting:{userId:f},media:{enforceVirtualBackground:g}}=d;if(h.includes(n)){const e=r||nu;if(tA(g)&&n===f&&t instanceof HTMLVideoElement)return t.pause(),u(bf(n)),u(ag(t.id)),Promise.resolve("");if(p.find((r=>r.userId===n&&r.key===e&&r.canvasId===t.id))&&(c.stopRenderVideo(t.id,n,e,WC(i),o),1==p.filter((e=>e.userId===n)).length&&(n!==f&&l.unsubscribeVideo(n),u(bf(n))),u(_f({userId:n,key:e,canvasId:t.id}))),s&&f!==s){const{video:{subscribedVideoList:e,prefetchedVideo:t}}=a();UO(d).find((e=>e.userId===s))&&!e.includes(s)&&(null==t?void 0:t.userId)!==s&&u(Yf({userId:s,lastCopy:t}))}}return Promise.resolve("")}(this[QA],e,t,n,r,i,o)}updateVideoCanvasDimension(e,t,n){return((e,t,n,r)=>{const{mediaAgent:i}=e;return n>=0&&r>=0&&i.updateRenderedVideoCanvasDimension(t,n,r),Promise.resolve("")})(this[QA],e,t,n)}adjustRenderedVideoPosition(e,t,n,r,i,o,s){return((e,t,n,r,i,o,s,a)=>{const{store:{getState:u,dispatch:c},mediaAgent:l}=e,{video:{subscribedVideoList:d}}=u();if(d.includes(n)){if(t instanceof HTMLVideoElement)return Promise.resolve("");const e=a||nu;l.adjustRenderedVideoPosition(t.id,n,e,o,s,r,i,WC("#000")),c(If({userId:n,key:e,canvasId:t.id,aspectRatio:i?r/i:0}))}else console.warn("Cannot adjust the size or position of the video as the video has not been rendered yet.");return Promise.resolve("")})(this[QA],e,t,n,r,i,o,s)}clearVideoCanvas(e,t){return((e,t,n)=>{const{mediaAgent:r}=e;return r.clearVideoCanvas(t.id,WC(n)),Promise.resolve("")})(this[QA],e,t)}mirrorVideo(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i}=e,{media:{enforceVirtualBackground:o},video:{isCurrentUserStartedVideo:s,virtualBackground:a,selfPreviewVideoList:u,customizedVideoOption:c,videoAttachments:l,isMirrored:d},meeting:{userId:h}}=n();if(d===t)return Promise.resolve("");if(s||null!=a&&a.isVBConfigured){if(tA(o)){const e=[];u.length>0&&u.forEach((t=>{e.push(document.getElementById(t))})),null!=c&&c.videoElement&&e.push(document.querySelector(null==c?void 0:c.videoElement)),l&&l[`${h}`]&&l[`${h}`].forEach((t=>{e.push(t.render.el)})),e.filter((e=>!!e)).forEach((e=>{e&&JC(e,t)}))}else i.mirrorVideo(t);r(og(t))}return Promise.resolve("")})(this[QA],e)}enableHardwareAcceleration(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i}=e,{video:{isSupportHDVideo:o}}=n();if("boolean"==typeof t||void 0!==t.decode){const e="boolean"==typeof t?t:!!t.decode;return e?Ls.isSupportVideoDecodeHardwareAcceleration().then((e=>(e&&i.enableHardwareAccelerationForVideoDecode(e),r(xf({decode:e})),e))):(i.enableHardwareAccelerationForVideoDecode(e),r(xf({decode:e})),Promise.resolve(!0))}if("boolean"==typeof t||void 0!==t.encode){const e="boolean"==typeof t?t:!!t.encode;if(o){if(!e)return i.enableHardwareAccelerationForVideoEncode(!1),r(xf({encode:!1})),Promise.resolve(!0);if(Ls.isCompatibleHardwareForEncode())return Ls.isSupportVideoEncodeHardwareAcceleration().then((e=>(e&&i.enableHardwareAccelerationForVideoEncode(e),r(xf({encode:e})),e)));console.warn("Can not turn on hardware acceleration with your graphic card due to the technical limitation")}else"boolean"!=typeof t&&null!=t&&t.encode&&console.warn("Can not use the hardware acceleration for video encoding due to the account restriction")}return Promise.resolve(!1)})(this[QA],e)}subscribeVideoStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{getState:r,dispatch:i}}=e,{media:{videoDecodeStatus:o,videoEncodeStatus:s},video:{subscriptionStatus:a}}=r(),u=!t||t.decode,c=!t||t.encode;return Rv("video",s,o).subscribe((e=>{let[r,o]=e;const s={};u&&o&&!a.decode&&(n.subscribeToQos([Ms.VideoDecode],eu),Object.assign(s,{decode:!0})),c&&r&&!a.encode&&(n.subscribeToQos([Ms.VideoEncode],eu),Object.assign(s,{encode:!0})),null!=t&&t.detailed&&o&&!a.detailed&&(n.enableVideoObserver(!0),Object.assign(s,{detailed:!0})),i(Zf(s))})),null})(this[QA],e)}unsubscribeVideoStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{dispatch:r}}=e,i=!t||t.decode,o=!t||t.encode,s={};return i&&(n.unsubscribeFromQos([Ms.VideoDecode]),r(Df(lu)),Object.assign(s,{decode:!1})),o&&(n.unsubscribeFromQos([Ms.VideoEncode]),r(kf(lu)),Object.assign(s,{encode:!1})),null!=t&&t.detailed&&(n.enableVideoObserver(!1),Object.assign(s,{detailed:!1})),r(Zf(s)),null})(this[QA],e)}previewVirtualBackground(e,t,n,r){return((e,t,n,r,i)=>{const{store:{getState:o,dispatch:s},mediaAgent:a}=e,u=o();return pA({imageUrl:n,cropped:r,cameraId:i},a,u,t).then((e=>("object"==typeof e&&null!=e&&e.type&&s(e),s(Pf({imageUrl:n,cropped:r})),!0))).catch((e=>Promise.reject({type:yl,reason:e})))})(this[QA],e,t,n,r)}updateVirtualBackgroundImage(e,t){return((e,t,n)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,s=r(),{video:{virtualBackground:{imageSrc:a,cropped:u},backgroundMode:c}}=s;return t===a&&n===u?Promise.resolve(!0):c===vu.Mask?Promise.reject({type:yl,reason:"Cannot update virtual background in the mask mode"}):pA({imageUrl:t,cropped:n},o,s).then((e=>("object"==typeof e&&null!=e&&e.type&&i(e),i(Pf({imageUrl:t,cropped:n})),!0))).catch((e=>Promise.reject({type:yl,reason:e})))})(this[QA],e,t)}stopPreviewVirtualBackground(){return(e=>{const{store:{getState:t},mediaAgent:n}=e,{video:{virtualBackground:{isVBConfigured:r}}}=t();return r?(n.stopVirtualBackgroundSetting(),Promise.resolve(!0)):Promise.reject({type:yl,reason:"Cannot stop preview virtual background before start"})})(this[QA])}previewVideoMask(e,t){return((e,t,n)=>{const{store:{getState:r,dispatch:i},mediaAgent:o}=e,s=r();return n.rootWidth&&n.rootHeight||Object.assign(n,{rootWidth:t.width,rootHeight:t.height}),fA(n,o,s,t).then((e=>("object"==typeof e&&null!=e&&e.type&&i(e),i(Gf(n)),!0))).catch((e=>Promise.reject({type:yl,reason:e})))})(this[QA],e,t)}updateVideoMask(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i}=e,o=n(),{video:{mask:s,backgroundMode:a}}=o,{isMaskConfigured:u}=s;if(a===vu.VirtualBackground)return Promise.reject({type:yl,reason:"Cannot update mask in the virtual background mode"});if(u){const e={...t};return["imageUrl","cropped","clip","rootHeight","rootWidth"].forEach((n=>{void 0===(null==t?void 0:t[n])&&("imageUrl"===n?Object.assign(e,{imageUrl:s.imageSrc}):Object.assign(e,{[`${n}`]:s[n]}))})),fA(e,i,o).then((t=>("object"==typeof t&&null!=t&&t.type&&r(t),r(Gf(e)),!0))).catch((e=>Promise.reject({type:yl,reason:e})))}return Promise.reject({type:yl,reason:"Cannot update mask"})})(this[QA],e)}stopPreviewVideoMask(){return(e=>{const{store:{getState:t},mediaAgent:n}=e,{video:{mask:{isMaskConfigured:r}}}=t();return r?(n.stopMaskSetting(),Promise.resolve(!0)):Promise.reject({type:yl,reason:"Cannot stop preview mask before start"})})(this[QA])}requestFarEndCameraControl(e){return((e,t)=>{const{store:{getState:n},rwgAgent:r}=e,i=n(),{meeting:{userId:o},video:{farEndCameraControlStatus:{controlledUserList:s}}}=i;return o===t?Promise.reject({type:yl,reason:'Using "stream.controlCamera" method to control self camera'}):-1!==HO(i).findIndex((e=>e.userId===t))?(s.includes(t)||r.sendFarEndCameraControl(du.Request,t),Promise.resolve("")):Promise.reject({type:Il,reason:"Cannot request control camera with video off"})})(this[QA],e)}approveFarEndCameraControl(e){return((e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i}=e,{video:{currentCameraControlStatus:{isRequested:o,isInControl:s,controllingUserId:a},ptz:u,activeCamera:c}}=n();if(o){if(s&&(!a||t===a))return Promise.resolve("");i.sendFarEndCameraControl(du.Approve,t);const e=null==u?void 0:u[c];return void 0!==e&&i.sendCameraAblity({pan:!!e.pan,tilt:!!e.tilt,zoom:!!e.zoom}),r(Lf(!1)),r(Vf({isInControl:!0,userId:t})),Id(tc,{isControlled:!0,userId:t}),Promise.resolve("")}return Promise.reject({type:yl,reason:"Cannot approve before request"})})(this[QA],e)}declineFarEndCameraControl(e){return((e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i}=e,{video:{currentCameraControlStatus:{isInControl:o,isRequested:s}}}=n();return s||o?(i.sendFarEndCameraControl(du.Decline,t),r(Lf(!1)),r(Vf({isInControl:!1,userId:0})),Id(tc,{isControlled:!1}),Promise.resolve("")):Promise.reject({type:yl,reason:"Cannot decline before request"})})(this[QA],e)}giveUpFarEndCameraControl(e){return((e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i}=e,{video:{farEndCameraControlStatus:{controlledUserList:o}}}=n();return o.includes(t)?(i.sendFarEndCameraControl(du.GiveUp,t),r(jf(t)),Promise.resolve("")):Promise.reject({type:yl,reason:"Cannot give up control befire aquired"})})(this[QA],e)}controlCamera(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i}=e,{video:{isCurrentUserStartedVideo:o,ptz:s,activeCamera:a}}=n();if(o){const{cmd:e,range:n,reset:o}=t,u=s[a];if(u){const t=XC(u)||{},{key:s,range:c}=ZC(e,n);if(u[s])return Object.assign(t,{[s]:o?0:YC(u[s].capability,u[s].value,c)}),i.movePTZCamera(t).then((()=>{r(Hf({constraints:t,deviceId:a}))})).catch((e=>Promise.reject({type:yl,reason:e})))}return Promise.resolve("")}return Promise.reject({type:yl,reason:"Cannot control the camera before it's started"})})(this[QA],e)}controlFarEndCamera(e){return((e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i}=e,o=n(),{video:{farEndCameraControlStatus:{controlledUserList:s,isControlling:a}}}=o,{userId:u,cmd:c,range:l}=t;if(a)return Promise.reject({type:yl,reason:"Cannot send new command while the previous control is not done"});if(s.includes(u)){if(c===hu.SwitchCamera)return i.sendFarEndCameraControl(du.SwitchCamera,u,hu.SwitchCamera),Promise.resolve("");{const e=HO(o).find((e=>e.userId===u));if(null==e||!e.nFECC)return Promise.reject({type:yl,reason:"The far end camera does not support PTZ"});if(l&&l>0){const e=l/100*1e4;return i.sendFarEndCameraControl(du.StartControl,u,c),r(qf(!0)),ut(200).pipe(_t(at(e-100))).subscribe((()=>{i.sendFarEndCameraControl(du.ContinueControl,u,c)})),Be(at(e).pipe(At((()=>{i.sendFarEndCameraControl(du.StopControl,u,c),r(qf(!1))})))).then((()=>""))}return Promise.reject({type:Il,reason:"Range cannot be negative or 0"})}}return Promise.reject({type:yl,reason:"Cannot control before request granted"})})(this[QA],e)}attachVideo(e,t,n){return((e,t,n,r)=>{const{store:{getState:i,dispatch:o},rwgAgent:s}=e,a=i(),{meeting:{userId:u},media:{enforceMultipleVideos:c,alternativeNameForVideoPlayer:l,enforceVirtualBackground:d,disableRenderLimits:h},video:{videoAttachments:p,subscribedVideoList:f}}=a,g=$o(!!c,h);if(g>1&&f.length>g)throw Promise.reject({type:yl,reason:`subscribe video counts greater than maximum size (${g})`});if(-1===UO(a).findIndex((e=>e.userId===t)))return Promise.reject({type:Il,reason:"user is not send video"});const{media:{videoDecodeStatus:m}}=a;let v;const y=null!=l?l:"video-player";if(r){var S,b,E;if("string"==typeof r){if(v=document.querySelector(r),!v)return Promise.reject({type:"INVALID_PARAMETERS",reason:"Cannot find the element"})}else v=r;if((null===(S=v)||void 0===S||null===(b=S.tagName)||void 0===b?void 0:b.toUpperCase())!==y.toUpperCase())return Promise.reject({type:"INVALID_PARAMETERS",reason:"Invalid element type"});const e=Number(null!==(E=v.getAttribute("node-id"))&&void 0!==E?E:"0");if(e!==t&&tA(d)&&[e,t].includes(u)){var w;const t=document.createElement(y);for(const e of v.attributes)t.setAttribute(e.name,e.value);e&&(v.setAttribute("node-id","0"),o(tg({userId:e,element:v}))),null===(w=v.parentElement)||void 0===w||w.replaceChild(t,v),v=t}}else v=document.createElement(y);return Rv("video","success",m).subscribe((async e=>{let[r,a]=e;if(a){const[e,r]=rA(t,n,i()),a=p[`${t}`];var c;v&&a&&-1!==a.findIndex((e=>e===v))?v.setAttribute("video-quality",`${r}`):null===(c=v)||void 0===c||c.setAttribute("node-id",`${t}`),o(eg({userId:t,element:v})),t!==u&&s.subscribeVideo(t,r,!1),f.includes(t)||o(Sf(t)),o(If({userId:t,key:nu,canvasId:au,videoQuality:e,aspectRatio:16/9}))}})),Promise.resolve(v)})(this[QA],e,t,n)}detachVideo(e,t){return((e,t,n)=>{const{store:{getState:r,dispatch:i},rwgAgent:o}=e,s=r(),{video:{subscribedVideoList:a,videoAttachments:u},meeting:{userId:c},media:{alternativeNameForVideoPlayer:l}}=s;if(a.includes(t)){let e;const s=null!=l?l:"video-player";var d,h;n&&(e="string"==typeof n?document.querySelector(n):n,(null===(d=e)||void 0===d||null===(h=d.tagName)||void 0===h?void 0:h.toUpperCase())!==s.toUpperCase()&&(e=void 0));const a=u[`${t}`];let f;if(a&&0!==a.length){var p;e?-1!==a.findIndex((t=>t===e))?(f=e,f.setAttribute("node-id","0"),i(tg({userId:t,element:f}))):console.warn(`${n} has not been attached with userID:${t}`):(f=[...a],f.forEach((e=>{e.setAttribute("node-id","0")})),i(tg({userId:t,element:f})));const{video:{videoAttachments:s,renderedVideoList:u}}=r();0===(null===(p=s[`${t}`])||void 0===p?void 0:p.length)&&(0===u.filter((e=>e.userId===t&&e.canvasId!==au)).length&&(t!==c&&o.unsubscribeVideo(t),i(bf(t))),i(_f({userId:t,key:nu,canvasId:au})))}else console.warn(`UserId:${t} has not been attached.`);return Promise.resolve(f)}return Promise.resolve(void 0)})(this[QA],e,t)}isCapturingVideo(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.video&&n.video.isCurrentUserStartedVideo})(this[QA])}isCameraTaken(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.video&&n.video.isCameraTaken})(this[QA])}isCaptureForbidden(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.video&&n.video.isCaptureForbidden})(this[QA])}getCameraList(){return(e=>{const{store:{getState:t}}=e,n=t();if(!n.video)return[];const{video:{cameraDevicesList:r}}=n;return r.map((e=>Object.assign({},e)))})(this[QA])}getActiveCamera(){return(e=>{const{store:{getState:t}}=e,n=t();return n.video?n.video.activeCamera:""})(this[QA])}getActiveVideoId(){return(e=>{const{store:{getState:t}}=e,n=t();return n.video?n.video.activeVideoId:0})(this[QA])}getVideoMaxQuality(){return(e=>{const{store:{getState:t}}=e,n=t();return n.video?n.video.receivedVideoMaxQuality:Ka.Video_90P})(this[QA])}getReceivedVideoDimension(){return(e=>{const{store:{getState:t}}=e,n=t();return n.video?n.video.receivedVideoDimension:null})(this[QA])}getCapturedVideoResolution(){return(e=>{const{store:{getState:t}}=e;return{...t().video.capturedVideoDimension}})(this[QA])}isSupportMultipleVideos(){return(e=>{const{store:{getState:t}}=e,{media:{enforceMultipleVideos:n}}=t();return Ko()||!!n&&!window.crossOriginIsolated&&$o(n)>1})(this[QA])}isSupportHDVideo(){return(e=>{var t;const{store:{getState:n}}=e;return null===(t=n().video)||void 0===t?void 0:t.isSupportHDVideo})(this[QA])}getHardwareAccelerationStatus(){return(e=>{var t;const{store:{getState:n}}=e;return null===(t=n().video)||void 0===t?void 0:t.hardwareAcceleration})(this[QA])}getVideoStatisticData(){return(e=>{let{store:{getState:t}}=e;const{video:{statistic:n}}=t();return{...n}})(this[QA])}isSupportVirtualBackground(){return(e=>{const{store:{getState:t}}=e;return Vv(t().media.enforceVirtualBackground)})(this[QA])}getVirtualbackgroundStatus(){return(e=>{const{store:{getState:t}}=e;return{...t().video.virtualBackground}})(this[QA])}isRenderSelfViewWithVideoElement(){return tA(this[WA].getState().media.enforceVirtualBackground)}getNetworkQuality(e){return((e,t)=>{var n;const{store:{getState:r}}=e,i=r(),{video:o,meeting:{userId:s}}=i,a=null!=t?t:s,u=null==o||null===(n=o.networkQuality)||void 0===n?void 0:n[`${a}`];if(u){const e={};return u.uplink&&Object.assign(e,{uplink:u.uplink.level}),u.downlink&&Object.assign(e,{downlink:u.downlink.level}),e}return null})(this[QA],e)}getFarEndCameraPTZCapability(e){return((e,t)=>{const{store:{getState:n}}=e,r=HO(n()).find((e=>e.userId===t));return void 0!==(null==r?void 0:r.nFECC)?eA(null==r?void 0:r.nFECC):{pan:!1,tilt:!1,zoom:!1}})(this[QA],e)}getCameraPTZCapability(e){return((e,t)=>{const{store:{getState:n}}=e,{video:{ptz:r,activeCamera:i}}=n(),o=r[null!=t?t:i];return{pan:!(null==o||!o.pan),tilt:!(null==o||!o.tilt),zoom:!(null==o||!o.zoom)}})(this[QA],e)}isBrowserSupportPTZ(){const{pan:e,tilt:t,zoom:n}=Ls.getPTZCapability();return e||t||n}getVideoMaskStatus(){return(e=>{var t;const{store:{getState:n}}=e,r=n(),{isMaskConfigured:i,imageSrc:o,...s}=(null===(t=r.video)||void 0===t?void 0:t.mask)||{};return{...s,imageUrl:o}})(this[QA])}isVideoMirrored(){return(e=>{const{store:{getState:t}}=e,{video:{isMirrored:n}}=t();return n})(this[QA])}startShareView(e,t,n){return((e,t,n,r)=>{const{store:{getState:i,dispatch:o},mediaAgent:s,rwgAgent:a}=e,{share:{isReceiveSharing:u,isRemoteSharingActive:c,activeNodeId:l,activeSsrc:d,status:h,renderedEnsuredCanvas:p,isReceiveSharingFromMainSession:f},media:{sharingDecodeStatus:g}}=i();if(!t||n!==l)return Promise.reject({type:Il,reason:""});if(!c||u||h!==qa.End)return Promise.reject({type:yl,reason:""});t.id||(t.id=fi("__ZOOM_SDK_SHARE_CANVAS_@__"));const m=!!r;return Rv("sharing","success",g).subscribe((e=>{let[,u]=e;if(u){let e=t;p.includes(t.id)||(e=xv(t),o(Hp(t.id))),o(Ip(!0)),ob(a,i(),n),s.renderSharing(d,e,m,r,f);const{audio:u}=i();if(null!=u&&u.localShareAudioUserMutedList){const e=u.localShareAudioUserMutedList.find((e=>e.userId===n));e&&s.setSharingAudioVolume(n,e.muted,e.isFromMainSession)}}})),"failed"===g?Promise.reject({type:Sl,reason:""}):Cd(Wc,(e=>!!e),6e4)})(this[QA],e,t,n)}stopShareView(){return(e=>{const{store:{dispatch:t,getState:n},rwgAgent:r,mediaAgent:i}=e,{share:{isReceiveSharing:o,activeNodeId:s},breakoutRoom:a}=n();if(!o)return Promise.resolve("");let u=!1;return(null==a?void 0:a.currentRoom.status)===ih.InRoom&&a.mainSessionAttendeeList.length>0&&(u=a.mainSessionAttendeeList.findIndex((e=>e.userId===s))>-1),i.stopRenderSharing(),r.unsubscribeSharing(s,u),t(Ip(!1)),Promise.resolve("")})(this[QA])}switchShareView(e){return((e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i,mediaAgent:o}=e,s=n(),{share:{isReceiveSharing:a,activeNodeId:u,isReceiveSharingFromMainSession:c,remoteControlledUserList:l,isGrabRemoteControl:d},audio:h,breakoutRoom:p}=s;if(!a)return Promise.reject({type:yl});if(t===u)return Promise.resolve("");let f=[];return f=c?p.mainSessionAttendeeList.filter((e=>e.bShareToBORooms&&e.sharerOn)):hy(s),f.findIndex((e=>e.userId===u))>-1?(l.includes(u)&&(d&&i.subscribeGrabRemoteControl(u,!1),o.updateRemoteControlProperties({isControllerNow:!1})),i.unsubscribeSharing(u,c),ob(i,n(),t),o.switchSharingSource(t,c),l.includes(t)&&hb(t,void 0,s,i,o),null==h||h.localShareAudioUserMutedList.forEach((e=>{o.setSharingAudioVolume(t,e.userId!==t||e.muted,e.isFromMainSession)})),r(wp({bStatus:1,activeNodeID:t,ssrc:t})),Id(el,{userId:t}),Promise.resolve("")):Promise.reject({type:Il,reason:"no matching user id"})})(this[QA],e)}updateSharingCanvasDimension(e,t){return((e,t,n)=>{const{store:{getState:r},mediaAgent:i}=e,o=r(),{share:{isReceiveSharing:s,isGrabRemoteControl:a,remoteControlViewportDomSelector:u}}=o;if(s&&(i.updateRenderedSharingDimension(t,n),a&&u)){const e=document.querySelector(u);i.updateRemoteControlProperties({dimension:e&&kv(e)})}return Promise.resolve("")})(this[QA],e,t)}startShareScreen(e,t){return((e,t,n)=>{var r;const{store:{getState:i,dispatch:o},mediaAgent:s}=e,a=i(),{meeting:{bIbDisableShare:u,meetingOptions:c},share:{sharePrivilege:l,ssrc:d,isChromeExtensionInstalled:h,capturedEnsuredCanvas:p,isReceiveSharingFromMainSession:f},media:{sharingEncodeStatus:g},breakoutRoom:m}=a,{isSupportMediaStreamTrackProcessor:v,isLegacyChrome:y}=Uo;if(u)return Promise.reject({type:yl,reason:"information barrier"});if("function"!=typeof(null===(r=navigator.mediaDevices)||void 0===r?void 0:r.getDisplayMedia))return Promise.reject({type:yl,reason:"Unable to share your screen due to the technical limitation"});if(f)return Promise.reject({type:yl,reason:"Unable to share your screen while someone is sharing from the main session"});var S;if(v){if(!(t instanceof HTMLVideoElement))return Promise.reject({type:Il,reason:"Use Video element instead of Canvas element when WebCodecs enabled"})}else if(!(t instanceof HTMLCanvasElement))return Promise.reject({type:Il,reason:`Expected to accept HTMLCanvasElement, but actual it is ${"object"==typeof t&&null!==t?null===(S=Object.getPrototypeOf(t))||void 0===S?void 0:S.constructor.name:t}`});const b=mh(a);if(null!=n&&n.broadcastToBreakoutRoom){if(!b||(null==m?void 0:m.currentRoom.status)===ih.InRoom)return b?Promise.reject({type:yl,reason:"Unable to share screen to breakout room when in the room"}):Promise.reject({type:El});o(Np(!0))}else o(Np(!1));void 0!==(null==n?void 0:n.requestReadReceipt)&&o(Lp(null==n?void 0:n.requestReadReceipt)),void 0!==(null==n?void 0:n.optimizedForSharedVideo)&&l!==Ha.MultipleShare&&o(Vp((null==n?void 0:n.optimizedForSharedVideo)&&Ls.isSupportVideoShareSend()));const E=hy(a);if(l===Ha.OnlyHost&&!b)return Promise.reject({type:El,reason:"only host can start screen share"});if(l===Ha.HostGrab&&!b&&E.length>0)return Promise.reject({type:El,reason:"only host can grab screen share"});const w=gh(a);if(!0===(null==w?void 0:w.sharerOn))return Promise.reject({type:yl,reason:"you have already started screen share."});let I=Fe(!0);return y&&!h&&(s.checkChromeSharingExtension(),I=Ad(qc,1)),t.id||(t.id=fi("__ZOOM_SDK_SELF_SHARE_CANVAS_@__")),et([Rv("sharing",g,"success"),I]).subscribe((e=>{let[r,i]=e;const[a]=r;if(a&&i){p.includes(t.id)||(xv(t),o(Up(t.id)));let e=document.querySelector(`#${tu}`);e&&"VIDEO"===e.tagName||(e=document.createElement("video"),e.id=tu,e.style.display="none",document.body.appendChild(e));const r=null!=n&&n.secondaryCameraId?{cameraId:n.secondaryCameraId,width:n.captureWidth,height:n.captureHeight}:void 0,i=!(null!=n&&n.hideShareAudioOption);s.startDesktopSharing(d,t,e,r,null!=c&&c.isDisableShareAudioIntoBo?i&&!(null!=n&&n.broadcastToBreakoutRoom):i,null==n?void 0:n.displaySurface,null==n?void 0:n.sourceId,null==n?void 0:n.controls),o(yp(void 0)),o(Mp(!!r))}})),new Promise(((e,t)=>{pt(Ad(Bs).pipe(ht((e=>void 0!==e.sharerOn)),gt(1)),Ad(qc).pipe(ht((e=>!e)),gt(1),St(Le({reason:"required extension",extensionUrl:"https://chrome.google.com/webstore/detail/zoom-scheduler/kgjfgplpablkjnlkjmjdecgdpfankdle"}))),Ad(Kc,1).pipe(Ye((e=>Le({reason:e.reason||"user deny screen share"}))))).subscribe((n=>{if(!0===n.sharerOn){const{share:{isSharingToBreakoutRoom:t},meeting:{meetingOptions:n}}=i(),r=!(null!=n&&n.isDisableShareAudioIntoBo||!t);s.enableShareAudioToBreakoutRoom(r),e("")}else t({type:Sl})}),(e=>{t({type:yl,...e})}))}))})(this[QA],e,t)}stopShareScreen(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:r,mediaAgent:i}=e,{share:{status:o},meeting:{userId:s}}=t();return o===qa.End?Promise.resolve(""):(n(Tp(qa.End)),r.stopSharing(s),i.stopDesktopSharing(),Cd(Bs,(e=>!1===e.sharerOn)))})(this[QA])}pauseShareScreen(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:r,mediaAgent:i}=e,{share:{status:o}}=t();return o===qa.Sharing?(r.pauseSharing(),i.pauseDesktopSharing(),Cd(Bs,(e=>!0===e.sharerPause)).then((()=>(n(Tp(qa.Paused)),"")))):Promise.reject({type:yl})})(this[QA])}resumeShareScreen(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:r,mediaAgent:i}=e,{share:{status:o}}=t();return o===qa.Paused?(r.resumeSharing(),i.resumeDesktopSharing(),Cd(Bs,(e=>!0===e.sharerOn&&!1===e.sharerPause)).then((()=>(n(Tp(qa.Sharing)),"")))):Promise.reject({type:yl})})(this[QA])}setSharePrivilege(e){return jO(this[QA],e)}lockShare(e){return((e,t)=>jO(e,t?Ha.OnlyHost:Ha.HostGrab))(this[QA],e)}shareToBreakoutRoom(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:r,mediaAgent:i}=e,{meeting:{userId:o},breakoutRoom:s,share:{isSharingToBreakoutRoom:a,status:u}}=t();return u===qa.End?Promise.reject({type:yl,reason:"Invalid sharing status"}):a?Promise.resolve(""):s.currentRoom.status===ih.InRoom?Promise.reject({type:yl,reason:"Unable to share screen to breakout room when in the room"}):(r.startShareToBreakoutRoom(o),n(Np(!0)),i.enableShareAudioToBreakoutRoom(!0),Promise.resolve(""))})(this[QA])}stopShareToBreakoutRoom(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:r,mediaAgent:i}=e,{meeting:{userId:o},share:{isSharingToBreakoutRoom:s}}=t();return s&&(r.stopShareToBreakoutRoom(o),n(Np(!1)),i.enableShareAudioToBreakoutRoom(!1)),Promise.resolve("")})(this[QA])}muteOthersScreenShare(e){return((e,t)=>{const{store:{getState:n},rwgAgent:r}=e,i=n(),{meeting:{userId:o}}=i,s=hy(i);return t===o?Promise.reject({type:yl,reason:"Cannot mute self share, use 'stopScreenShare' instead"}):-1===s.findIndex((e=>e.userId===t))?Promise.reject({type:Il,reason:"Target user is not sharing"}):(r.stopSharing(t),Cd(Us,(e=>e.some((e=>e.userId===t&&!1===e.sharerOn)))))})(this[QA],e)}enableOptimizeForSharedVideo(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i,rwgAgent:o}=e,{share:{status:s,isOptimizedForSharedVideo:a,isSharingToBreakoutRoom:u,sharePrivilege:c},audio:{isSharingAudio:l},meeting:{userId:d}}=n();return s!==qa.End?a===t?Promise.resolve(""):c!==Ha.MultipleShare?t&&!Ls.isSupportVideoShareSend()?Promise.reject({type:yl,reason:"Cannot enable optimize for shared video due to the platform is not supported "}):(o.startSharing(d,{bShareAudio:l,bShareToBO:u,bShareVideo:t}),i.switchSharingMode(t?mu.VideoMode:mu.Normal),Cd({event:Bs,operations:[ht((e=>void 0!==e.bVideoShare)),gt(1)]},(e=>e.bVideoShare===t)).then((()=>(r(Vp(t)),"")))):Promise.reject({type:yl,reason:"Cannot enable optimize for shared video when enabling multiple screen shares"}):Promise.reject({type:yl,reason:"Cannot enable optimize for shared video when screen share is not started"})})(this[QA],e)}updateSharedVideoQuality(e){return((e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i}=e,o=n(),{share:{shareQuality:s,activeNodeId:a,isReceiveSharing:u}}=o,c=py(o);return u&&0!==a?(c&&s!==t&&(ob(i,o,a,t),r(Op(t))),Promise.resolve("")):Promise.reject({type:yl,reason:"Cannot update shared video quality when screen share is not started"})})(this[QA],e)}subscribeShareStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{getState:r}}=e,i=r(),{media:{sharingEncodeStatus:o,sharingDecodeStatus:s}}=r(),a=gh(i),u=!t||t.decode,c=!t||t.encode;if(!a)return Promise.reject({type:yl,reason:"Call this function after the 'join' method resolved."});{const e=eh(a.userRole)||!Uo.isSupportSendScreenSharing?"failed":o;Rv("sharing",e,s).subscribe((e=>{let[t,r]=e;t&&r&&(u&&n.subscribeToQos([Ms.SharingDecode],eu),c&&n.subscribeToQos([Ms.SharingEncode],eu))}))}return""})(this[QA],e)}unsubscribeShareStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{dispatch:r}}=e,i=!t||t.decode,o=!t||t.encode;return i&&(n.unsubscribeFromQos([Ms.SharingDecode]),r(jp(lu))),o&&(n.unsubscribeFromQos([Ms.SharingEncode]),r(jp(lu))),null})(this[QA],e)}getShareUserList(){return(e=>{const{store:{getState:t}}=e,n=t();if(!n.share)return[];const{share:{isReceiveSharingFromMainSession:r}}=n;if(r){const{breakoutRoom:{mainSessionAttendeeList:e}}=n;return e.filter((e=>e.bShareToBORooms&&(e.sharerOn||e.sharerPause))).map((e=>cT(e)))}return hy(n).map((e=>cT(e)))})(this[QA])}getActiveShareUserId(){return(e=>{const{store:{getState:t}}=e,n=t();return n.share&&n.share.isRemoteSharingActive?n.share.activeNodeId:0})(this[QA])}isReceiveSharing(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.isReceiveSharing})(this[QA])}getShareViewDimension(){return(e=>{const{store:{getState:t}}=e,n=t();if(n.share){if(n.share.status!==qa.End)return{...n.share.shareDimension};{const{share:{receivedShareDimension:e}}=n;return{width:e.width,height:e.height}}}return null})(this[QA])}getShareStatus(){return(e=>{const{store:{getState:t}}=e,n=t();return n.share?n.share.status:null})(this[QA])}isShareLocked(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.sharePrivilege===Ha.OnlyHost})(this[QA])}isReceiveSharingFromMainSession(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.isReceiveSharingFromMainSession})(this[QA])}getSharePrivilege(){return(e=>{const{store:{getState:t}}=e,n=t();return n.share?n.share.sharePrivilege:null})(this[QA])}isStartShareScreenWithVideoElement(){return Uo.isSupportMediaStreamTrackProcessor}isOptimizeForSharedVideoEnabled(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.isOptimizedForSharedVideo})(this[QA])}isSupportOptimizedForSharedVideo(){return Ls.isSupportVideoShareSend()}getShareStatisticData(){return(e=>{let{store:{getState:t}}=e;const{share:{statistic:n}}=t();return{...n}})(this[QA])}requestRemoteControl(){return(e=>{const{store:{getState:t},rwgAgent:n}=e,{share:{isReceiveSharing:r,activeNodeId:i,isRemoteControlEnabled:o}}=t();return o?qO(e,i)?r?fy(t())?Promise.reject({type:yl,reason:"Already get the approval"}):(n.sharingRequestRemoteControl(i,!0),new Promise((e=>{Ad(tl,1).subscribe((t=>{e(t)}))}))):Promise.reject({type:yl,reason:"Cannot request control due to no sharing available"}):Promise.reject({type:Il}):Promise.reject({type:yl,reason:"Cannot request control due to the feature is not enabled."})})(this[QA])}giveUpRemoteControl(){return(e=>{const{store:{getState:t},rwgAgent:n}=e,{share:{isGrabRemoteControl:r,activeNodeId:i}}=t();return fy(t())?(r&&n.subscribeGrabRemoteControl(i,!1),n.sharingRequestRemoteControl(i,!1),Cd(tl,(e=>!1===e))):Promise.reject({type:yl})})(this[QA])}startRemoteControl(e){return(async(e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i,rwgAgent:o}=e,{share:{isSDKGrabControl:s,activeNodeId:a}}=n();return fy(n())?(await hb(a,t,n(),o,i),t.dataset.zmrvId||t.setAttribute("data-zmrv-id",fi("__ZOOM_SDK_RC_VIEWPORT_DATA_ID_@__")),r(nf(`${t.tagName}[data-zmrv-id="${t.dataset.zmrvId}"]`)),s?Cd(nl,(e=>!!e)):_d({success:il,fail:[ol]})):Promise.reject({type:yl,reason:"required to be approved"})})(this[QA],e)}grabRemotoControl(){return(e=>{const{store:{getState:t},rwgAgent:n}=e,{share:{isGrabRemoteControl:r,activeNodeId:i}}=t();return fy(t())?r?Promise.resolve(""):(n.subscribeGrabRemoteControl(i,!0),Cd(nl,(e=>!!e))):Promise.reject({type:yl,reason:"should be approved before grab"})})(this[QA])}updateRemoteControlViewportDimension(e){return((e,t)=>{const{store:{getState:n},mediaAgent:r}=e;return fy(n())&&r.updateRemoteControlProperties({dimension:{scaleWidth:t.width,scaleHeight:t.height,srcOffsetX:t.left,srcOffsetY:t.top}}),Promise.resolve("")})(this[QA],e)}approveRemoteControl(e){return((e,t)=>{const{store:{getState:n,dispatch:r},rwgAgent:i,mediaAgent:o}=e,s=n(),{share:{status:a,isEnableAutoDeleteRcApp:u,remoteControllingSsrc:c,userSsrcMapping:l},meeting:{userId:d}}=s;if(a===qa.End)return Promise.reject({type:yl,reason:"Cannot approve remote control when sharing is not ongoing."});if(a===qa.Paused&&(i.resumeSharing(),o.resumeDesktopSharing(),r(Tp(qa.Sharing))),o.isSharingEntireScreen()){var h;c&&!hi(c,t)&&(db(s,i),r(Yp("")));const e=null!==(h=l[`${t}`])&&void 0!==h?h:t;return i.remoteControlConsent(Su.Approve,e,d,{...o.getShareStreamInfo(),platform:Uo.isMacOS?"mac":"win"},u),r($p(e)),Cd(hl)}return Promise.reject({type:yl,reason:"Cannot approve remote control when not sharing entire screen."})})(this[QA],e)}declineRemoteControl(e){return((e,t)=>{var n;const{store:{getState:r},rwgAgent:i,mediaAgent:o}=e,s=r(),{meeting:{userId:a},share:{isEnableAutoDeleteRcApp:u,userSsrcMapping:c}}=s,l=null!==(n=c[`${t}`])&&void 0!==n?n:t;return i.remoteControlConsent(Su.Decline,l,a,{...o.getShareStreamInfo(),platform:Uo.isMacOS?"mac":"win"},u),Promise.resolve("")})(this[QA],e)}stopRemoteControl(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:r}=e;return db(t(),r),n(Yp("")),n($p(0)),Promise.resolve("")})(this[QA])}launchRemoteControlApp(e){return((e,t)=>{const{store:{getState:n,dispatch:r}}=e,i=n(),{share:{remoteControlAppLaunchSheme:o}}=i;return o?(r(Yp(t?`${o}&bAutoDelete=1`:o)),r(Gp(bu.Unknown)),Promise.resolve("")):Promise.reject({type:yl,reason:"Cannot launch app due to no permission"})})(this[QA],e)}isRemoteControlEnabled(){return(e=>{var t;const{store:{getState:n}}=e;return!(null===(t=n().share)||void 0===t||!t.isRemoteControlEnabled)})(this[QA])}getRemoteControlAppDownloadUrl(){return(e=>{const{store:{getState:t}}=e,n=t();return n.share?n.share.remoteControlAppDownloadUrl:null})(this[QA])}isTargetShareSupportRemoteControl(e){return qO(this[QA],e)}isRemotelyControlApproved(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&fy(n)})(this[QA])}isControllingUserRemotely(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.isGrabRemoteControl})(this[QA])}getRemotelyControllingUser(){return(e=>{const{store:{getState:t}}=e,n=t();if(n.share){const{remoteControllingSsrc:e}=n.share;if(e)return bh(n).find((t=>hi(t.userId,e)))}return null})(this[QA])}},$A(fD.prototype,"startAudio",[YA,KO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"startAudio"),fD.prototype),$A(fD.prototype,"stopAudio",[YA,$O,gD],Object.getOwnPropertyDescriptor(fD.prototype,"stopAudio"),fD.prototype),$A(fD.prototype,"muteAudio",[YA,WO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"muteAudio"),fD.prototype),$A(fD.prototype,"unmuteAudio",[YA,GO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"unmuteAudio"),fD.prototype),$A(fD.prototype,"dialOut",[YA,zO,JO],Object.getOwnPropertyDescriptor(fD.prototype,"dialOut"),fD.prototype),$A(fD.prototype,"cancelDialOut",[YA,QO,YO],Object.getOwnPropertyDescriptor(fD.prototype,"cancelDialOut"),fD.prototype),$A(fD.prototype,"hangup",[YA,ZO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"hangup"),fD.prototype),$A(fD.prototype,"switchMicrophone",[YA,XO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"switchMicrophone"),fD.prototype),$A(fD.prototype,"switchSpeaker",[YA,eP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"switchSpeaker"),fD.prototype),$A(fD.prototype,"muteShareAudio",[YA,tP,nP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"muteShareAudio"),fD.prototype),$A(fD.prototype,"unmuteShareAudio",[YA,rP,iP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"unmuteShareAudio"),fD.prototype),$A(fD.prototype,"subscribeAudioStatisticData",[YA,oP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"subscribeAudioStatisticData"),fD.prototype),$A(fD.prototype,"unsubscribeAudioStatisticData",[YA,sP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"unsubscribeAudioStatisticData"),fD.prototype),$A(fD.prototype,"enableBackgroundNoiseSuppression",[YA,aP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"enableBackgroundNoiseSuppression"),fD.prototype),$A(fD.prototype,"enableSyncButtonsOnHeadset",[YA,uP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"enableSyncButtonsOnHeadset"),fD.prototype),$A(fD.prototype,"enableOriginalSound",[YA,cP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"enableOriginalSound"),fD.prototype),$A(fD.prototype,"callCRCDevice",[YA,lP,dP],Object.getOwnPropertyDescriptor(fD.prototype,"callCRCDevice"),fD.prototype),$A(fD.prototype,"cancelCallCRCDevice",[YA,hP,pP],Object.getOwnPropertyDescriptor(fD.prototype,"cancelCallCRCDevice"),fD.prototype),$A(fD.prototype,"muteAllAudio",[ZA,YA,fP],Object.getOwnPropertyDescriptor(fD.prototype,"muteAllAudio"),fD.prototype),$A(fD.prototype,"unmuteAllAudio",[ZA,YA,gP],Object.getOwnPropertyDescriptor(fD.prototype,"unmuteAllAudio"),fD.prototype),$A(fD.prototype,"startVideo",[YA,mP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"startVideo"),fD.prototype),$A(fD.prototype,"stopVideo",[YA,vP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"stopVideo"),fD.prototype),$A(fD.prototype,"switchCamera",[YA,yP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"switchCamera"),fD.prototype),$A(fD.prototype,"renderVideo",[ED,YA,SP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"renderVideo"),fD.prototype),$A(fD.prototype,"stopRenderVideo",[ID,YA,bP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"stopRenderVideo"),fD.prototype),$A(fD.prototype,"updateVideoCanvasDimension",[wD,YA,EP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"updateVideoCanvasDimension"),fD.prototype),$A(fD.prototype,"adjustRenderedVideoPosition",[ID,YA,wP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"adjustRenderedVideoPosition"),fD.prototype),$A(fD.prototype,"clearVideoCanvas",[wD,YA,IP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"clearVideoCanvas"),fD.prototype),$A(fD.prototype,"mirrorVideo",[YA,_P,mD],Object.getOwnPropertyDescriptor(fD.prototype,"mirrorVideo"),fD.prototype),$A(fD.prototype,"enableHardwareAcceleration",[YA,CP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"enableHardwareAcceleration"),fD.prototype),$A(fD.prototype,"subscribeVideoStatisticData",[YA,AP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"subscribeVideoStatisticData"),fD.prototype),$A(fD.prototype,"unsubscribeVideoStatisticData",[YA,TP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"unsubscribeVideoStatisticData"),fD.prototype),$A(fD.prototype,"previewVirtualBackground",[bD,YA,RP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"previewVirtualBackground"),fD.prototype),$A(fD.prototype,"updateVirtualBackgroundImage",[YA,OP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"updateVirtualBackgroundImage"),fD.prototype),$A(fD.prototype,"stopPreviewVirtualBackground",[YA,PP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"stopPreviewVirtualBackground"),fD.prototype),$A(fD.prototype,"previewVideoMask",[bD,YA,DP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"previewVideoMask"),fD.prototype),$A(fD.prototype,"updateVideoMask",[YA,kP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"updateVideoMask"),fD.prototype),$A(fD.prototype,"stopPreviewVideoMask",[YA,xP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"stopPreviewVideoMask"),fD.prototype),$A(fD.prototype,"requestFarEndCameraControl",[YA,NP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"requestFarEndCameraControl"),fD.prototype),$A(fD.prototype,"approveFarEndCameraControl",[YA,MP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"approveFarEndCameraControl"),fD.prototype),$A(fD.prototype,"declineFarEndCameraControl",[YA,FP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"declineFarEndCameraControl"),fD.prototype),$A(fD.prototype,"giveUpFarEndCameraControl",[YA,LP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"giveUpFarEndCameraControl"),fD.prototype),$A(fD.prototype,"controlCamera",[YA,VP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"controlCamera"),fD.prototype),$A(fD.prototype,"controlFarEndCamera",[YA,BP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"controlFarEndCamera"),fD.prototype),$A(fD.prototype,"attachVideo",[YA,jP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"attachVideo"),fD.prototype),$A(fD.prototype,"detachVideo",[YA,UP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"detachVideo"),fD.prototype),$A(fD.prototype,"startShareView",[bD,YA,HP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"startShareView"),fD.prototype),$A(fD.prototype,"stopShareView",[YA,qP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"stopShareView"),fD.prototype),$A(fD.prototype,"switchShareView",[YA,KP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"switchShareView"),fD.prototype),$A(fD.prototype,"updateSharingCanvasDimension",[YA,$P,vD],Object.getOwnPropertyDescriptor(fD.prototype,"updateSharingCanvasDimension"),fD.prototype),$A(fD.prototype,"startShareScreen",[YA,WP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"startShareScreen"),fD.prototype),$A(fD.prototype,"stopShareScreen",[YA,GP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"stopShareScreen"),fD.prototype),$A(fD.prototype,"pauseShareScreen",[YA,zP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"pauseShareScreen"),fD.prototype),$A(fD.prototype,"resumeShareScreen",[YA,JP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"resumeShareScreen"),fD.prototype),$A(fD.prototype,"setSharePrivilege",[ZA,QP,YA,vD],Object.getOwnPropertyDescriptor(fD.prototype,"setSharePrivilege"),fD.prototype),$A(fD.prototype,"lockShare",[ZA,YP,YA,vD],Object.getOwnPropertyDescriptor(fD.prototype,"lockShare"),fD.prototype),$A(fD.prototype,"shareToBreakoutRoom",[YA,ZA,ZP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"shareToBreakoutRoom"),fD.prototype),$A(fD.prototype,"stopShareToBreakoutRoom",[YA,ZA,XP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"stopShareToBreakoutRoom"),fD.prototype),$A(fD.prototype,"muteOthersScreenShare",[YA,ZA,eD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"muteOthersScreenShare"),fD.prototype),$A(fD.prototype,"enableOptimizeForSharedVideo",[YA,tD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"enableOptimizeForSharedVideo"),fD.prototype),$A(fD.prototype,"updateSharedVideoQuality",[YA,nD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"updateSharedVideoQuality"),fD.prototype),$A(fD.prototype,"subscribeShareStatisticData",[YA,rD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"subscribeShareStatisticData"),fD.prototype),$A(fD.prototype,"unsubscribeShareStatisticData",[YA,iD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"unsubscribeShareStatisticData"),fD.prototype),$A(fD.prototype,"requestRemoteControl",[YA,oD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"requestRemoteControl"),fD.prototype),$A(fD.prototype,"giveUpRemoteControl",[YA,sD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"giveUpRemoteControl"),fD.prototype),$A(fD.prototype,"startRemoteControl",[YA,aD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"startRemoteControl"),fD.prototype),$A(fD.prototype,"grabRemotoControl",[YA,uD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"grabRemotoControl"),fD.prototype),$A(fD.prototype,"updateRemoteControlViewportDimension",[YA,cD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"updateRemoteControlViewportDimension"),fD.prototype),$A(fD.prototype,"approveRemoteControl",[YA,lD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"approveRemoteControl"),fD.prototype),$A(fD.prototype,"declineRemoteControl",[YA,dD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"declineRemoteControl"),fD.prototype),$A(fD.prototype,"stopRemoteControl",[YA,hD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"stopRemoteControl"),fD.prototype),$A(fD.prototype,"launchRemoteControlApp",[YA,pD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"launchRemoteControlApp"),fD.prototype),fD);var CD,AD,TD,RD,OD,PD,DD,kD,xD;const ND=oT("Audio"),MD=oT("Sharing");let FD=(CD=eT("share"),AD=eT("audio"),TD=eT("audio"),RD=eT("audio"),OD=eT("audio"),PD=eT("audio"),DD=eT("audio"),kD=eT("audio"),xD=class extends _D{switchSharingSecondaryCamera(e){return((e,t)=>{const{store:{getState:n,dispatch:r},mediaAgent:i}=e,o=n(),{video:{cameraDevicesList:s},share:{status:a,isSharingWithSecondCamera:u}}=o;return"default"!==t&&-1===s.map((e=>e.deviceId)).indexOf(t)?Promise.reject({type:Il,reason:"Cannot find cameraDeviceId in camera devices list."}):(a===qa.Sharing&&u&&i.changeSharingSecondCamera(t),r(Fp(t)),Promise.resolve())})(this[QA],e)}muteUserAudioLocally(e){return((e,t)=>{const{mediaAgent:n,store:{getState:r,dispatch:i}}=e,o=r(),{audio:{locallyMutedAudioList:s}}=o,a=bh(o).filter((e=>e.audio===yu.Computer));return s.includes(t)||-1===a.findIndex((e=>e.userId===t))||(n.muteOrUnmuteOtherAudio(t,!0),i(rp(t))),Promise.resolve("")})(this[QA],e)}unmuteUserAudioLocally(e){return((e,t)=>{const{mediaAgent:n,store:{getState:r,dispatch:i}}=e,{audio:{locallyMutedAudioList:o}}=r();return o.includes(t)?(n.muteOrUnmuteOtherAudio(t,!1),i(ip(t)),Promise.resolve("")):Promise.resolve("")})(this[QA],e)}adjustUserAudioVolumeLocally(e,t){return((e,t,n)=>{const{mediaAgent:r,store:{getState:i,dispatch:o}}=e,s=i();return-1!==bh(s).findIndex((e=>e.userId===t))&&(r.adjustOtherAudioVolume(t,n),o(op({userId:t,volume:n}))),Promise.resolve("")})(this[QA],e,t)}muteAllUserAudioLocally(){return(e=>{const{mediaAgent:t,store:{getState:n,dispatch:r}}=e,{audio:{isStopAllImcomingAudio:i}}=n();return i||(t.stopAllIncomingAudio(!0),r(dp(!0))),Promise.resolve("")})(this[QA])}unmuteAllUserAudioLocally(){return(e=>{const{mediaAgent:t,store:{getState:n,dispatch:r}}=e,{audio:{isStopAllImcomingAudio:i,locallyMutedAudioList:o}}=n();return i&&(t.stopAllIncomingAudio(!1),r(dp(!1)),o.length>0&&o.forEach((e=>{t.muteOrUnmuteOtherAudio(e,!1),r(ip(e))}))),Promise.resolve("")})(this[QA])}startSecondaryAudio(e,t){return(async(e,t,n)=>{const{mediaAgent:r,rwgAgent:i,store:{getState:o,dispatch:s}}=e,a=o(),{audio:{microphoneDevicesList:u,activeMicrophone:c},share:{status:l}}=a,d=gh(a);if(!Ls.isSupportShare2ndAudioDevice(Ho()))return Promise.reject({type:yl,reason:"Cannot start secondary audio due to platform is not supported"});if((null==d?void 0:d.audio)===yu.Computer&&c===t)return Promise.reject({type:yl,reason:"Cannot start secondary audio with the same microphone"});if(l!==qa.End)return Promise.reject({type:yl,reason:"Cannot start secondary audio while screen sharing is in progress"});let h=u;if(0===u.length){const{microphones:e}=await Be(Dv());h=e}return t&&-1===h.findIndex((e=>e.deviceId===t))?Promise.reject({type:Il,reason:"Cannot find the microphone"}):(i.muteShareAudio(!1,!0),r.share2ndAudio(t,n),s(yp(t)),Cd(Nc))})(this[QA],e,t)}stopSecondaryAudio(){return(async e=>{const{mediaAgent:t,rwgAgent:n,store:{getState:r,dispatch:i}}=e,o=r(),{audio:{secondaryAudioMicrophoneId:s}}=o;if(!s)return Promise.reject({type:yl,reason:"Cannot stop secondary audio due to not started "});n.muteShareAudio(!0,!0),t.leaveSharingAudio(!1),i(yp(void 0))})(this[QA])}isUserAudioMutedLocally(e){return((e,t)=>{let{store:{getState:n}}=e;const{audio:{locallyMutedAudioList:r}}=n();return r.includes(t)})(this[QA],e)}getUserVolumeLocally(e){return((e,t)=>{var n,r;let{store:{getState:i}}=e;const{audio:{localUserAudioVolumeList:o,locallyMutedAudioList:s}}=i();return null!==(n=null===(r=o.find((e=>e.userId===t)))||void 0===r?void 0:r.volume)&&void 0!==n?n:s.includes(t)?0:100})(this[QA],e)}},$A(xD.prototype,"switchSharingSecondaryCamera",[YA,CD,MD],Object.getOwnPropertyDescriptor(xD.prototype,"switchSharingSecondaryCamera"),xD.prototype),$A(xD.prototype,"muteUserAudioLocally",[YA,AD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"muteUserAudioLocally"),xD.prototype),$A(xD.prototype,"unmuteUserAudioLocally",[YA,TD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"unmuteUserAudioLocally"),xD.prototype),$A(xD.prototype,"adjustUserAudioVolumeLocally",[YA,RD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"adjustUserAudioVolumeLocally"),xD.prototype),$A(xD.prototype,"muteAllUserAudioLocally",[YA,OD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"muteAllUserAudioLocally"),xD.prototype),$A(xD.prototype,"unmuteAllUserAudioLocally",[YA,PD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"unmuteAllUserAudioLocally"),xD.prototype),$A(xD.prototype,"startSecondaryAudio",[YA,DD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"startSecondaryAudio"),xD.prototype),$A(xD.prototype,"stopSecondaryAudio",[YA,kD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"stopSecondaryAudio"),xD.prototype),xD);const LD={controlStatus:nh.NotStarted,sequenceId:1,rooms:[],isHugeBO:!1,allocationPattern:th.Automatically,currentRoom:{status:ih.Initial,boStatus:rh.NoToken,boConfId:"",boId:"",name:"",boToken:""},options:{isAutoJoinRoom:!1,isBackToMainSessionEnabled:!0,isTimerEnabled:!1,timerDuration:1800,isTimerAutoEnabled:!1,waitSeconds:60,isAutoMovetoMainSession:!1,isRoomSelectionEnabled:!1},mainSessionAttendeeList:[],preAssignedRooms:[],meetingElapsedTime:0,startRoomElapsedTime:0,closingRoomTime:0,broadcastMessage:"",hostReplyToQuestionerType:void 0,hostReplyToRequestId:void 0,isUserRoleUpdated:!1,mainSessionConfId:"",isEnableBOBroadcast:!1,isEnableBreakoutRoom:!1,isEnableBOViewActivityStatus:!1,inRoomUserActivityStatusMap:{},isEnableBOBroadcastVoice:!1,isBroadcastVoice:!1},VD=Rn({[`${Qg}`]:hE(((e,t)=>{let{payload:n}=t;Array.isArray(n)?e.rooms.push(...n):e.rooms.push(n)})),[`${Yg}`]:hE(((e,t)=>{let{payload:n}=t;e.allocationPattern=n})),[`${Zg}`]:hE(((e,t)=>{let{payload:n}=t;e.sequenceId=n})),[`${Xg}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingElapsedTime=n})),[`${em}`]:hE(((e,t)=>{let{payload:n}=t;e.startRoomElapsedTime=n})),[`${tm}`]:hE(((e,t)=>{let{payload:n}=t;const{options:r}=e;Object.assign(r,n)})),[`${nm}`]:hE(((e,t)=>{let{payload:n}=t;e.controlStatus=n})),[`${rm}`]:hE(((e,t)=>{let{payload:n}=t;e.rooms=n})),[`${im}`]:hE(((e,t)=>{let{payload:n}=t;const{currentRoom:r}=e;Object.assign(r,n)})),[`${om}`]:hE(((e,t)=>{let{payload:n}=t;const{currentRoom:r}=e;r.status=n})),[`${sm}`]:hE(((e,t)=>{let{payload:n}=t;const{currentRoom:r}=e;r.boConfId=n})),[`${am}`]:hE(((e,t)=>{let{payload:n}=t;const{currentRoom:r}=e;r.boToken=n})),[`${cm}`]:hE(((e,t)=>{let{payload:n}=t;e.closingRoomTime=n})),[`${lm}`]:hE(((e,t)=>{let{payload:n}=t;e.broadcastMessage=n})),[`${dm}`]:hE(((e,t)=>{let{payload:n}=t;e.hostReplyToQuestionerType=n})),[`${hm}`]:hE(((e,t)=>{let{payload:n}=t;e.hostReplyToRequestId=n})),[`${pm}`]:hE(((e,t)=>{let{payload:n}=t;void 0!==n.add&&n.add.length>0&&n.add.forEach((t=>{const n=e.mainSessionAttendeeList.find((e=>e.userId===t.userId));void 0!==n?Object.assign(n,t):Xd(t.userRole)||e.mainSessionAttendeeList.push(t)})),void 0!==n.update&&n.update.length>0&&n.update.forEach((t=>{const n=e.mainSessionAttendeeList.find((e=>e.userId===t.userId));void 0!==n&&Object.assign(n,t)})),void 0!==n.remove&&n.remove.length>0&&n.remove.forEach((t=>{const n=e.mainSessionAttendeeList.findIndex((e=>e.userId===t.userId));-1!==n&&e.mainSessionAttendeeList.splice(n,1)}))})),[`${fm}`]:hE(((e,t)=>{let{payload:n}=t;e.isHugeBO=n})),[`${mm}`]:hE(((e,t)=>{let{payload:n}=t;e.isUserRoleUpdated=n})),[`${gm}`]:hE(((e,t)=>{let{payload:n}=t;e.preAssignedRooms=n})),[`${vm}`]:hE(((e,t)=>{let{payload:n}=t;e.isEnableBreakoutRoom=n.isEnableBreakoutRoom,e.isEnableBOBroadcast=n.isEnableBOBroadcast,e.isEnableBOViewActivityStatus=n.isEnableBOViewActivityStatus,e.isEnableBOBroadcastVoice=n.isEnableBOBroadcastVoice})),[`${ym}`]:hE(((e,t)=>{let{payload:n}=t;const{userGuid:r,status:i}=n,{inRoomUserActivityStatusMap:o}=e;o[`${r}`]=i})),[`${Sm}`]:hE(((e,t)=>{let{payload:n}=t;e.isBroadcastVoice=n})),[`${um}`]:e=>{const{currentRoom:{status:t}}=e;return t===ih.Joining?{...LD,preAssignedRooms:e.preAssignedRooms,currentRoom:e.currentRoom,closingRoomTime:e.closingRoomTime}:t===ih.Leaving?{...LD,preAssignedRooms:e.preAssignedRooms,closingRoomTime:e.closingRoomTime}:{...LD,preAssignedRooms:e.preAssignedRooms}}},LD);var BD=Uint8Array,jD=Uint16Array,UD=Uint32Array,HD=new BD([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),qD=new BD([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),KD=new BD([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$D=function(e,t){for(var n=new jD(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new UD(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},WD=$D(HD,2),GD=WD[0],zD=WD[1];GD[28]=258,zD[258]=28;for(var JD=$D(qD,0),QD=JD[0],YD=JD[1],ZD=new jD(32768),XD=0;XD<32768;++XD){var ek=(43690&XD)>>>1|(21845&XD)<<1;ek=(61680&(ek=(52428&ek)>>>2|(13107&ek)<<2))>>>4|(3855&ek)<<4,ZD[XD]=((65280&ek)>>>8|(255&ek)<<8)>>>1}var tk=function(e,t,n){for(var r=e.length,i=0,o=new jD(t);i<r;++i)e[i]&&++o[e[i]-1];var s,a=new jD(t);for(i=0;i<t;++i)a[i]=a[i-1]+o[i-1]<<1;if(n){s=new jD(1<<t);var u=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],l=t-e[i],d=a[e[i]-1]++<<l,h=d|(1<<l)-1;d<=h;++d)s[ZD[d]>>>u]=c}else for(s=new jD(r),i=0;i<r;++i)e[i]&&(s[i]=ZD[a[e[i]-1]++]>>>15-e[i]);return s},nk=new BD(288);for(XD=0;XD<144;++XD)nk[XD]=8;for(XD=144;XD<256;++XD)nk[XD]=9;for(XD=256;XD<280;++XD)nk[XD]=7;for(XD=280;XD<288;++XD)nk[XD]=8;var rk=new BD(32);for(XD=0;XD<32;++XD)rk[XD]=5;var ik=tk(nk,9,0),ok=tk(nk,9,1),sk=tk(rk,5,0),ak=tk(rk,5,1),uk=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},ck=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},lk=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},dk=function(e){return(e+7)/8|0},hk=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(2==e.BYTES_PER_ELEMENT?jD:4==e.BYTES_PER_ELEMENT?UD:BD)(n-t);return r.set(e.subarray(t,n)),r},pk=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],fk=function(e,t,n){var r=new Error(t||pk[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,fk),!n)throw r;return r},gk=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8},mk=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},vk=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,o=n.slice();if(!i)return[_k,0];if(1==i){var s=new BD(n[0].s+1);return s[n[0].s]=1,[s,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var a=n[0],u=n[1],c=0,l=1,d=2;for(n[0]={s:-1,f:a.f+u.f,l:a,r:u};l!=i-1;)a=n[n[c].f<n[d].f?c++:d++],u=n[c!=l&&n[c].f<n[d].f?c++:d++],n[l++]={s:-1,f:a.f+u.f,l:a,r:u};var h=o[0].s;for(r=1;r<i;++r)o[r].s>h&&(h=o[r].s);var p=new jD(h+1),f=yk(n[l-1],p,0);if(f>t){r=0;var g=0,m=f-t,v=1<<m;for(o.sort((function(e,t){return p[t.s]-p[e.s]||e.f-t.f}));r<i;++r){var y=o[r].s;if(!(p[y]>t))break;g+=v-(1<<f-p[y]),p[y]=t}for(g>>>=m;g>0;){var S=o[r].s;p[S]<t?g-=1<<t-p[S]++-1:++r}for(;r>=0&&g;--r){var b=o[r].s;p[b]==t&&(--p[b],++g)}f=t}return[new BD(p),f]},yk=function(e,t,n){return-1==e.s?Math.max(yk(e.l,t,n+1),yk(e.r,t,n+1)):t[e.s]=n},Sk=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new jD(++t),r=0,i=e[0],o=1,s=function(e){n[r++]=e},a=1;a<=t;++a)if(e[a]==i&&a!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=e[a]}return[n.subarray(0,r),t]},bk=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},Ek=function(e,t,n){var r=n.length,i=dk(t+2);e[i]=255&r,e[i+1]=r>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<r;++o)e[i+o+4]=n[o];return 8*(i+4+r)},wk=function(e,t,n,r,i,o,s,a,u,c,l){gk(t,l++,n),++i[256];for(var d=vk(i,15),h=d[0],p=d[1],f=vk(o,15),g=f[0],m=f[1],v=Sk(h),y=v[0],S=v[1],b=Sk(g),E=b[0],w=b[1],I=new jD(19),_=0;_<y.length;++_)I[31&y[_]]++;for(_=0;_<E.length;++_)I[31&E[_]]++;for(var C=vk(I,7),A=C[0],T=C[1],R=19;R>4&&!A[KD[R-1]];--R);var O,P,D,k,x=c+5<<3,N=bk(i,nk)+bk(o,rk)+s,M=bk(i,h)+bk(o,g)+s+14+3*R+bk(I,A)+(2*I[16]+3*I[17]+7*I[18]);if(x<=N&&x<=M)return Ek(t,l,e.subarray(u,u+c));if(gk(t,l,1+(M<N)),l+=2,M<N){O=tk(h,p,0),P=h,D=tk(g,m,0),k=g;var F=tk(A,T,0);for(gk(t,l,S-257),gk(t,l+5,w-1),gk(t,l+10,R-4),l+=14,_=0;_<R;++_)gk(t,l+3*_,A[KD[_]]);l+=3*R;for(var L=[y,E],V=0;V<2;++V){var B=L[V];for(_=0;_<B.length;++_){var j=31&B[_];gk(t,l,F[j]),l+=A[j],j>15&&(gk(t,l,B[_]>>>5&127),l+=B[_]>>>12)}}}else O=ik,P=nk,D=sk,k=rk;for(_=0;_<a;++_)if(r[_]>255){j=r[_]>>>18&31,mk(t,l,O[j+257]),l+=P[j+257],j>7&&(gk(t,l,r[_]>>>23&31),l+=HD[j]);var U=31&r[_];mk(t,l,D[U]),l+=k[U],U>3&&(mk(t,l,r[_]>>>5&8191),l+=qD[U])}else mk(t,l,O[r[_]]),l+=P[r[_]];return mk(t,l,O[256]),l+P[256]},Ik=new UD([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),_k=new BD(0),Ck=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),Ak=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8};var Tk="undefined"!=typeof TextEncoder&&new TextEncoder,Rk="undefined"!=typeof TextDecoder&&new TextDecoder;try{Rk.decode(_k,{stream:!0})}catch(h){}const{WebclientBreakoutRoomAttendeeStatus:Ok,WebclientBreakoutRoomCommand:Pk}=ko,Dk=nb(Ls.getInstance());function kk(e,t){let n=0;for(;n<e.length;n++){const r=e[n],{attendeeGuidList:i}=r;if(null!=i&&i.includes(t))break}return n<e.length?e[n]:void 0}function xk(){Do.remove(Ok),Do.remove(Pk)}function Nk(){return Ps.createAgent().leaveBO(1),Id(Gs,{reason:Eo.BackToMainSession}),xk(),[om(ih.Leaving),Ni(To.NormalCase)]}function Mk(e,t){return Id(Gs,{reason:Eo.JoinBreakoutRoom,roomName:e}),t===ih.InRoom&&Ps.createAgent().leaveBO(1),[om(ih.Joining),Ni(To.NormalCase)]}function Fk(e){return Id(Gs,{reason:Eo.MoveToBreakoutRoom,roomName:e}),Ps.createAgent().leaveBO(1),[om(ih.Joining),Ni(To.NormalCase)]}function Lk(e){return e!==ih.InRoom&&e!==ih.Joining&&e!==ih.Leaving}function Vk(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?ih.InRoom:ih.Invited;return Do.set(Ok,JSON.stringify({status:t,boId:e.boId}),Oo.SessionStorage),im({status:t,boId:e.boId,name:e.name,boStatus:e.boStatus})}function Bk(e){const{breakoutRoom:{isUserRoleUpdated:t,currentRoom:{boConfId:n}}}=e.value,r=gh(e.value);if(r&&(!n||n&&t))return Fe(r.isHost);{const t=n?Ad(Xl,1):Ad(Vs,2).pipe(q((function(e,t){var n=[];e.subscribe(K(t,(function(e){n.push(e),1<n.length&&n.shift()}),(function(){var e,r;try{for(var i=m(n),o=i.next();!o.done;o=i.next()){var s=o.value;t.next(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}t.complete()}),void 0,(function(){n=null})))})));return t.pipe(ke(le),Tt(e),Ke((e=>{let[,t]=e;return gh(t).isHost})))}}function jk(e){return et({boIdList:Ad(ql).pipe(bt(((e,t)=>[...e,t]),[]),gt(e))}).pipe(He(1e4))}const Uk=[{mask:lh.Connect,key:"audio",value:""},{mask:lh.Voip,key:"audio",value:"computer"},{mask:lh.Muted,key:"muted",value:!0},{mask:dh.Connect,key:"bVideoOn",value:!1},{mask:dh.On,key:"bVideoOn",value:!0},{mask:hh.Share,key:"sharerOn",value:!0},{mask:hh.ShareAudio,key:"bShareAudioOn",value:!0}];function Hk(e,t){const n=(fT(t)?t.breakoutRoom.mainSessionAttendeeList:t.participants.attendeesList).find((t=>t.userId===Number(e)));return n?{inviterId:n.userId,inviterGuid:n.userGUID,inviterName:n.displayName}:{}}const qk=Ps.createAgent(),Kk=["userRole","bCoHost","bCCEditor","bHold"],$k=Ps.createAgent(),Wk=nb(Ls.getInstance());var Gk;const zk=Ps.createAgent(),Jk=nb(Ls.getInstance()),Qk=oT("Breakout Room");let Yk=(Gk=class extends aT{createRooms(e,t){const n=this[GA](),r=this[zA],{breakoutRoom:{isHugeBO:i,sequenceId:o,rooms:s,controlStatus:a,isEnableBreakoutRoom:u}}=n;if(!u)return Promise.reject({type:yl,reason:"Breakout room feature is not enabled."});if(a===nh.InProgress||a===nh.Closing)return Promise.resolve({type:yl,reason:"breakout room has started!"});let c;c="string"==typeof e?[e]:"number"==typeof e?Array.from({length:e}).map(((e,t)=>`${sh} ${t+o}`)):e;const l=i?100:50;return c.length<1||s.length+c.length>l?Promise.reject({type:Il,reason:"exceed maximum size"}):(zk.batchCreateBOToken(c),new Promise(((e,i)=>{jk(c.length).subscribe((i=>{let{boIdList:s}=i,a=s.map(((e,t)=>({boId:e,name:c[t]})));if(t===th.Automatically){const e=gT(n),t=a.length,r=e.length;a=a.map(((n,i)=>{const o=[];let s=i;for(;s<r;)o.push(e[s]),s+=t;return{...n,attendeeList:o}}))}const u=a.map((e=>{let{boId:t,name:n,attendeeList:r}=e;return{boId:t,name:n,attendeeGuidList:r&&r.map((e=>e.userGUID))}}));if(r(Qg(u)),r(Yg(t)),r(Zg(o+a.length)),t===th.Automatically){const t=a.map((e=>({roomId:e.boId,name:e.name,attendeeList:e.attendeeList.map((e=>({userId:e.userId,avatar:e.avatar,displayName:e.displayName})))})));e(t)}else e(a.map((e=>({roomId:e.boId,name:e.name,attendeeList:[]}))))}),(()=>{i({type:Sl})}))})))}recreateRooms(e,t){const n=this[GA](),r=this[zA],{breakoutRoom:{isHugeBO:i,sequenceId:o,rooms:s,controlStatus:a,isEnableBreakoutRoom:u}}=n;if(!u)return Promise.reject({type:yl,reason:"Breakout room feature is not enabled."});if(a===nh.InProgress||a===nh.Closing)return Promise.resolve({type:yl,reason:"breakout room has started!"});let c;c="string"==typeof e?[e]:"number"==typeof e?Array.from({length:e}).map(((e,t)=>`${sh} ${t+o}`)):e;const l=i?100:50;return c.length<1||s.length+c.length>l?Promise.reject({type:Il,reason:"exceed maximum size"}):(zk.batchCreateBOToken(c),new Promise(((e,i)=>{jk(c.length).subscribe((i=>{let{boIdList:s}=i,a=s.map(((e,t)=>({boId:e,name:c[t]})));if(t===th.Automatically){const e=a.length,t=mT(n),r=t.length;a=a.map(((n,i)=>{const o=[];let s=i;for(;s<r;)o.push(t[s]),s+=e;return{...n,attendeeList:o}}))}const u=a.map((e=>{let{boId:t,name:n,attendeeList:r}=e;return{boId:t,name:n,attendeeGuidList:r&&r.map((e=>e.userGUID))}}));if(r(rm(u)),r(Yg(t)),r(Zg(o+a.length)),t===th.Automatically){const t=a.map((e=>({roomId:e.boId,name:e.name,attendeeList:e.attendeeList.map((e=>({userId:e.userId,avatar:e.avatar,displayName:e.displayName})))})));e(t)}else e(a.map((e=>({roomId:e.boId,name:e.name,attendeeList:[]}))))}),(()=>{i({type:Sl})}))})))}openRooms(e,t){var n;const r=this[GA](),i={isAutoJoinRoom:!1,isBackToMainSessionEnabled:!0,isTimerEnabled:!1,timerDuration:1800,isTimerAutoEnabled:!1,waitSeconds:60,isAutoMoveBackToMainSession:!1,isRoomSelectionEnabled:!1},{breakoutRoom:{controlStatus:o,rooms:s,sequenceId:a,isHugeBO:u}}=r;if(o===nh.InProgress||o===nh.Closing)return Promise.resolve({type:yl,reason:"breakout room has started!"});if(e.some((e=>-1===s.findIndex((t=>t.boId===e.roomId)))))return Promise.reject({type:Il,reason:"roomId is wrong"});const c=bh(r);if(e.reduce(((e,t)=>e.concat(t.attendeeList)),[]).some((e=>-1===c.findIndex((t=>t.userId===e.userId)))))return Promise.reject({type:Il,reason:"bad user"});const l=e.map((e=>{const{attendeeList:t}=e,n=t.map((e=>{const t=c.find((t=>t.userId===e.userId));return null==t?void 0:t.userGUID}));return{BID:e.roomId,MeetingTitle:e.name,MeetingToken:void 0,Status:rh.Started,HostID:"",ParticipantList:n}})),d=t?{...i,...t}:i,h={ControlStatus:nh.InProgress,NameIndex:a,IsAutoJoinEnabled:+d.isAutoJoinRoom,IsBackToMainSessionEnabled:+d.isBackToMainSessionEnabled,IsTimerEnabled:+d.isTimerEnabled,TimerDuration:d.timerDuration,IsTimerAutoEndEnabled:+d.isTimerAutoEnabled,WaitSeconds:d.waitSeconds<0?0:d.waitSeconds,StartTimeOnMMR:void 0,ItemList:l,IsAutoMovetoMainSessionEnabled:d.isAutoMoveBackToMainSession,IsParticipantsChooseRoomEnabled:+d.isRoomSelectionEnabled};let p=oi(JSON.stringify(h));if(u&&(p=(e=>ni.fromUint8Array(function(e,t){t||(t={});var n=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=Ck[255&n^t[r]]^n>>>8;e=n},d:function(){return~e}}}(),r=e.length;n.p(e);var i=function(e,t,n,r,i){return function(e,t,n,r,i,o){var s=e.length,a=new BD(r+s+5*(1+Math.ceil(s/7e3))+8),u=a.subarray(r,a.length-8),c=0;if(!t||s<8)for(var l=0;l<=s;l+=65535){var d=l+65535;d>=s&&(u[c>>3]=o),c=Ek(u,c+1,e.subarray(l,d))}else{for(var h=Ik[t-1],p=h>>>13,f=8191&h,g=(1<<n)-1,m=new jD(32768),v=new jD(g+1),y=Math.ceil(n/3),S=2*y,b=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<S)&g},E=new UD(25e3),w=new jD(288),I=new jD(32),_=0,C=0,A=(l=0,0),T=0,R=0;l<s;++l){var O=b(l),P=32767&l,D=v[O];if(m[P]=D,v[O]=P,T<=l){var k=s-l;if((_>7e3||A>24576)&&k>423){c=wk(e,u,0,E,w,I,C,A,R,l-R,c),A=_=C=0,R=l;for(var x=0;x<286;++x)w[x]=0;for(x=0;x<30;++x)I[x]=0}var N=2,M=0,F=f,L=P-D&32767;if(k>2&&O==b(l-L))for(var V=Math.min(p,k)-1,B=Math.min(32767,l),j=Math.min(258,k);L<=B&&--F&&P!=D;){if(e[l+N]==e[l+N-L]){for(var U=0;U<j&&e[l+U]==e[l+U-L];++U);if(U>N){if(N=U,M=L,U>V)break;var H=Math.min(L,U-2),q=0;for(x=0;x<H;++x){var K=l-L+x+32768&32767,$=K-m[K]+32768&32767;$>q&&(q=$,D=K)}}}L+=(P=D)-(D=m[P])+32768&32767}if(M){E[A++]=268435456|zD[N]<<18|YD[M];var W=31&zD[N],G=31&YD[M];C+=HD[W]+qD[G],++w[257+W],++I[G],T=l+N,++_}else E[A++]=e[l],++w[e[l]]}}c=wk(e,u,o,E,w,I,C,A,R,l-R,c)}return hk(a,0,r+dk(c)+8)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,0,!0)}(e,t,function(e){return 10+(e.filename&&e.filename.length+1||0)}(t)),o=i.length;return function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&Ak(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}}(i,t),Ak(i,o-8,n.d()),Ak(i,o-4,r),i}(function(e,t){var n;if(Tk)return Tk.encode(e);var r=e.length,i=new BD(e.length+(e.length>>1)),o=0,s=function(e){i[o++]=e};for(n=0;n<r;++n){if(o+5>i.length){var a=new BD(o+8+(r-n<<1));a.set(i),i=a}var u=e.charCodeAt(n);u<128?s(u):u<2048?(s(192|u>>6),s(128|63&u)):u>55295&&u<57344?(s(240|(u=65536+(1047552&u)|1023&e.charCodeAt(++n))>>18),s(128|u>>12&63),s(128|u>>6&63),s(128|63&u)):(s(224|u>>12),s(128|u>>6&63),s(128|63&u))}return hk(i,0,o)}(e))))(p)),null!==(n=gh(r))&&void 0!==n&&n.isHost)zk.startBO(p);else{const e=vT(r);e&&zk.coHostStartBO(p,e.userId)}return Cd(Ql,(e=>e.controlStatus===nh.InProgress))}joinRoom(e){const t=this[GA](),n=gh(t),{breakoutRoom:{controlStatus:r,rooms:i,mainSessionAttendeeList:o,options:{isRoomSelectionEnabled:s},currentRoom:{status:a,boId:u}},meeting:{userGUID:c}}=t;if(r!==nh.InProgress)return Promise.reject({type:wl,reason:"Breakout room is not started"});if(null!=n&&n.isHost){const t=i.find((t=>t.boId===e));if(!t)return Promise.reject({type:Il,reason:"Room ID is not correct"});zk.joinBO(t.boId)}else if(null!=n&&n.bCoHost&&a===ih.InRoom){if(!i.find((t=>t.boId===e)))return Promise.reject({type:Il,reason:"Room ID is not correct"});{const t=o.find((e=>e.isHost));t&&zk.wantJoinBO(null==t?void 0:t.userId,e)}}else{if(a===ih.InRoom&&u===e)return Promise.resolve("");{let n=!1;const r=kk(i,c);if(r&&r.boId===e)zk.joinBO(r.boId);else if(s)if(-1!==i.findIndex((t=>t.boId===e))){const n=vT(t);n&&zk.wantJoinBO(n.userId,e)}else n=!0;else n=!0;if(n)return Promise.reject({type:Il,reason:"Room ID is not correct"})}}return Cd(Yl,(t=>t.boId===e))}leaveRoom(){const e=this[GA](),t=this[zA],{breakoutRoom:{controlStatus:n,options:r,currentRoom:{status:i}}}=e;if(n!==nh.InProgress&&n!==nh.Closing||i!==ih.InRoom)return Promise.reject({type:yl});{const n=mh(e);if(!r.isBackToMainSessionEnabled&&!n)return Promise.reject({type:El,reason:"Can not return main session during the breakout room"});Nk().forEach((e=>t(e)))}return Promise.resolve("")}askForHelp(){const e=this[GA](),{breakoutRoom:{controlStatus:t,mainSessionAttendeeList:n,currentRoom:{status:r}},participants:{attendeesList:i}}=e,o=mh(e);if(t!==nh.InProgress||r!==ih.InRoom)return Promise.reject({type:yl,reason:"you are not in breakout room"});if(o)return Promise.reject({type:yl,reason:"host or co-host can not ask for help"});{const e=n.find((e=>e.isHost));if(e){if(i.findIndex((t=>t.zoomID===e.zoomID))>-1)return Promise.reject({type:yl,reason:"host is in room"});zk.askForHelpBO(e.userId)}}return Cd(Jl,(e=>e.result===ah.Received))}postponeHelping(e){const t=this[GA](),n=this[zA],{breakoutRoom:{mainSessionAttendeeList:r,currentRoom:{status:i}},participants:{attendeesList:o}}=t;let s=o;return i===ih.InRoom&&(s=r),s.findIndex((t=>t.userId===e))>-1?(zk.askForHelpResultBO(e,ah.Ignore),n(dm(ah.Ignore)),Promise.resolve("")):Promise.reject({type:Il,reason:"user id is not correct"})}broadcast(e){const{breakoutRoom:{isEnableBOBroadcast:t}}=this[GA]();return t?e?es.beginEncrypt({text:e,type:Qo.BO_BROADCAST}).then((e=>(zk.broadcastBO(e),Promise.resolve("")))):Promise.reject({type:Il,reason:"content empty"}):Promise.reject({type:yl,reason:"Cannot broadcast message due to the feature is not enable"})}startBroadcastVoice(){const e=this[GA](),t=this[zA],{breakoutRoom:{isEnableBOBroadcast:n,isEnableBOBroadcastVoice:r,isBroadcastVoice:i}}=e;if(n&&r){if(fT(e))return Promise.reject({type:yl,reason:"Cannot broadcast voice in the room"});{if(i)return Promise.resolve("");const n=gh(e);return(null==n?void 0:n.audio)===yu.Computer&&!1===n.muted?(zk.broadcastVoiceReq(!0),Jk.broadcastVoiceToBreakoutRoom(!0),t(Sm(!0)),Promise.resolve("")):Promise.reject({type:yl,reason:"Start audio and unmute to broadcast"})}}return Promise.reject({type:yl,reason:"Cannot broadcast voice due to the feature is not enable"})}stopBroadcastVoice(){const e=this[GA](),t=this[zA],{breakoutRoom:{isBroadcastVoice:n}}=e;return n?(zk.broadcastVoiceReq(!1),Jk.broadcastVoiceToBreakoutRoom(!1),t(Sm(!1)),Promise.resolve("")):Promise.reject({type:yl,reason:"Cannot stop broadcast voice due to it is not started"})}assignUserToRoom(e,t){const n=this[GA](),{breakoutRoom:{rooms:r}}=n,i=gT(n).find((t=>t.userId===e));if(!(i&&r.findIndex((e=>e.boId===t))>-1))return Promise.reject({type:Il,reason:""});var o;if(null!==(o=gh(n))&&void 0!==o&&o.isHost)zk.assignToBO(e,t);else{const e=vT(n);e&&zk.coHostAssignToBO(i.userGUID,t,e.userId)}return Cd(Ql,(e=>{const{controlStatus:n,roomList:r}=e,o=r.find((e=>e.boId===t));return n===nh.InProgress&&o&&o.attendeeGuidList.includes(i.userGUID)}))}moveUserToRoom(e,t){const n=this[GA](),{breakoutRoom:{rooms:r,mainSessionAttendeeList:i},participants:{attendeesList:o}}=n,s=(fT(n)?i:o).find((t=>t.userId===e));if(!s)return Promise.reject({type:Il,reason:"user id not correct"});{const i=kk(r,s.userGUID);if(!i)return Promise.reject({type:yl,reason:"user not in a room"});if(i.boId===t)return Promise.reject({type:yl,reason:"user already in the target room"});{const i=r.find((e=>e.boId===t));if(!i)return Promise.reject({type:Il,reason:"invalid room id"});var a;if(null!==(a=gh(n))&&void 0!==a&&a.isHost)zk.switchBO(e,i.boId);else{const e=vT(n);e&&zk.coHostAssignToBO(s.userGUID,i.boId,e.userId)}}}return Cd(Ql,(e=>{const{controlStatus:n,roomList:r}=e,i=r.find((e=>e.boId===t));return n===nh.InProgress&&i&&i.attendeeGuidList.includes(s.userGUID)}))}moveBackToMainSession(e){const t=this[GA](),{breakoutRoom:{rooms:n,mainSessionAttendeeList:r},participants:{attendeesList:i}}=t,o=(fT(t)?r:i).find((t=>t.userId===e));if(!o)return Promise.reject({type:Il,reason:"user id not correct"});if(!kk(n,o.userGUID))return Promise.reject({type:yl,reason:"user not in a room"});var s;if(null!==(s=gh(t))&&void 0!==s&&s.isHost)zk.moveToMainSession(o.userGUID);else{const e=vT(t);e&&zk.coHostMoveToMainSession(o.userGUID,e.userId)}return Cd(Ql,(e=>{const{controlStatus:t,roomList:n}=e;return t===nh.InProgress&&n.some((e=>{const{attendeeGuidList:t}=e;return t.includes(o.userGUID)}))}))}closeRoom(){const e=this[GA](),{breakoutRoom:{controlStatus:t}}=e;if(t!==nh.InProgress)return Promise.reject({type:yl,reason:"room is not started"});var n;if(null!==(n=gh(e))&&void 0!==n&&n.isHost)zk.stopBO(nh.Closing);else{const t=vT(e);t&&zk.coHostStopBO(nh.Closing,t.userId)}return Cd(Ql,(e=>e.controlStatus===nh.Closing))}loadPreAssignedRooms(){const e=this[GA](),{meeting:{meetingOptions:t},breakoutRoom:{controlStatus:n}}=e;return!t.isAllowBreakoutRoomPreAssign||n!==nh.NotStarted&&n!==nh.Closed?Promise.reject({type:yl}):(zk.preAssignBreakoutRoom(),Cd(ed))}getUnassignedAttendeeList(){const e=this[GA](),t=gh(e);return null!=t&&t.isHost||null!=t&&t.bCoHost?gT(e).map((e=>cT(e))):[]}getRoomList(){const e=this[GA](),{breakoutRoom:{rooms:t,currentRoom:{status:n,boId:r},mainSessionAttendeeList:i,inRoomUserActivityStatusMap:o,options:{isRoomSelectionEnabled:s}},participants:{attendeesList:a}}=e,u=gh(e);if(u&&(u.isHost||u.bCoHost||s)){const e=n===ih.InRoom,s=e?i:a;return t.map((t=>{const{attendeeGuidList:n,boId:i,name:a}=t,c=(n||[]).map((e=>s.find((t=>t.userGUID===e)))).filter((e=>!(null!=e&&e.isHost))).filter(Boolean);return e&&u.isHost&&i===r&&c.unshift(u),{roomId:i,name:a,attendeeList:c.filter((e=>!!e)).map((e=>{var t;const n=null!==(t=o[e.userGUID])&&void 0!==t?t:{};return{userId:e.userId,displayName:e.displayName,avatar:e.avatar,isInRoom:e.bid===i,userGuid:e.userGUID,...n}}))}}))}return e.breakoutRoom.rooms.map((e=>{const{boId:t,name:n}=e;return{roomId:t,name:n,attendeeList:[]}}))}getAttendeeStatus(){return this[GA]().breakoutRoom.currentRoom.status}getRoomStatus(){return this[GA]().breakoutRoom.controlStatus}getCurrentRoom(){const e=this[GA](),{breakoutRoom:{currentRoom:{status:t,name:n,boId:r}}}=e;return{attendeeStatus:t,name:n,roomId:r}}getRoomOptions(){const e=this[GA](),{breakoutRoom:{options:t}}=e,{whoStart:n,whoStop:r,...i}=t;return{...i}}},$A(Gk.prototype,"createRooms",[YA,ZA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"createRooms"),Gk.prototype),$A(Gk.prototype,"recreateRooms",[YA,ZA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"recreateRooms"),Gk.prototype),$A(Gk.prototype,"openRooms",[YA,ZA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"openRooms"),Gk.prototype),$A(Gk.prototype,"joinRoom",[YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"joinRoom"),Gk.prototype),$A(Gk.prototype,"leaveRoom",[YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"leaveRoom"),Gk.prototype),$A(Gk.prototype,"askForHelp",[YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"askForHelp"),Gk.prototype),$A(Gk.prototype,"postponeHelping",[XA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"postponeHelping"),Gk.prototype),$A(Gk.prototype,"broadcast",[ZA,YA],Object.getOwnPropertyDescriptor(Gk.prototype,"broadcast"),Gk.prototype),$A(Gk.prototype,"startBroadcastVoice",[XA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"startBroadcastVoice"),Gk.prototype),$A(Gk.prototype,"stopBroadcastVoice",[XA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"stopBroadcastVoice"),Gk.prototype),$A(Gk.prototype,"assignUserToRoom",[ZA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"assignUserToRoom"),Gk.prototype),$A(Gk.prototype,"moveUserToRoom",[ZA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"moveUserToRoom"),Gk.prototype),$A(Gk.prototype,"moveBackToMainSession",[ZA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"moveBackToMainSession"),Gk.prototype),$A(Gk.prototype,"closeRoom",[ZA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"closeRoom"),Gk.prototype),$A(Gk.prototype,"loadPreAssignedRooms",[XA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"loadPreAssignedRooms"),Gk.prototype),Gk);const Zk={breakoutRoomSharingEpics0:(e,t)=>fr(e,rs).pipe(ht((e=>{var t;const{payload:{body:n}}=e;return null==n||null===(t=n.update)||void 0===t?void 0:t.some((e=>void 0!==e.bShareToBORooms||void 0!==e.bShareOn))})),Tt(t),Ke((e=>{let[t,n]=e;const{payload:{body:{update:r}}}=t,{breakoutRoom:{mainSessionAttendeeList:i}}=n,o=r.filter((e=>e.bShareOn&&e.bShareToBORooms)),s=r.filter((e=>!e.bShareOn||!e.bShareToBORooms)),a=i.filter((e=>e.sharerOn&&e.bShareToBORooms));return o.length>0&&o.forEach((e=>{-1===a.findIndex((t=>t.userId===e.id))&&Id(Qc,{...e,isFromMainSession:!0})})),s.length>0&&s.forEach((e=>{Id(Yc,{...e,isFromMainSession:!0})})),r.map((e=>{if(e.bShareOn&&e.bShareToBORooms){if(0===i.filter((t=>t.sharerOn&&t.bShareToBORooms&&t.userId!==e.id)).length)return{activeNodeID:e.id,bStatus:1,ssrc:e.shareSsrc};{const t=i.find((t=>t.userId===e.id));if(null!=t&&t.isHost)return{activeNodeID:e.id,bStatus:1,ssrc:e.shareSsrc}}}else if(!e.bShareOn||!e.bShareToBORooms){const t=i.filter((e=>e.bShareToBORooms&&e.sharerOn));if(1===t.length&&t[0].userId===e.id)return{activeNodeID:e.id,bStatus:0,ssrc:0};{const n=t.filter((t=>t.userId!==e.id)),r=n.find((e=>e.isHost));if(r)return{activeNodeID:r.userId,bStatus:1,ssrc:r.shareSsrc};{const e=n[0];if(e)return{activeNodeID:e.userId,bStatus:1,ssrc:e.shareSsrc}}}}})).filter(Boolean)})),Ye((e=>{const{share:{status:n},meeting:{userId:r}}=t.value,i=[];return e.map((e=>{const{activeNodeID:o,bStatus:s,ssrc:a}=e,u=1===s;i.push(xp(u)),u&&n!==qa.End&&($k.stopSharing(r),Wk.stopDesktopSharing(),i.push(Tp(qa.End)),Id(Jc));let c={activeNodeID:o,bStatus:s,ssrc:a,fromMainSession:!0};if(!u){const{participants:{attendeesList:e}}=t.value,n=e.filter((e=>e.sharerOn));if(n.length>0){const e=n[0];c={activeNodeID:e.userId,bStatus:1,ssrc:e.shareSsrc||0}}}i.push(xn({evt:ts,body:c}))})),Me(i)}))),breakoutRoomSharingEpics1:(e,t)=>fr(e,as).pipe(It((n=>{const{payload:{body:{userID:r,confID:i}}}=n;return ct(...["sharing","audio"].map((n=>function(e,t,n,r,i){return fr(t,"audio"===e?os:ns).pipe(gt(1),At((t=>{const{payload:{body:{encryptKey:o,additionalType:s}}}=t,{media:{sharingDecodeStatus:a,audioDecodeStatus:u},meeting:{svcUrl:c,meetingNumber:l,conId:d,zoomId:h,meetingId:p}}=n.value;Rv(e,"success","audio"===e?u:a).subscribe((t=>{let[,a]=t;if(a){const t=`wss://${c}/wc/media/${l}?type=${"audio"===e?"ma":"ms"}&cid=${d}&mode=1`;Dk.createMainSessionChannel(e,t),Dk.updateMediaParams({iVType:"audio"===e?zo.AUDIO_DECODE:zo.SHARING_DECODE,isFromMainSession:!0,updateParams:{userId:r,sn:ai(h),confId:i,encryptType:s,encryptKey:ai(o),meetingId:p,meetingNumber:l}});const{breakoutRoom:{mainSessionAttendeeList:a}}=n.value;if((null==a?void 0:a.length)>0){const t=a.map((e=>({userid:e.userId,sn:e.zoomID&&ai(e.zoomID)})));Dk.updateUserMediaSN({added:t,isFromMainSession:!0,iVType:"audio"===e?zo.AUDIO_DECODE:zo.SHARING_DECODE})}}}))})),St(ge))}(n,e,t,r,i))))})))},Xk={epics0:(e,t)=>e.pipe(Ut(`${Gi}`),It((e=>{const{breakoutRoom:n,meeting:{meetingOptions:r}}=t.value,{payload:{hugeBO:i,elapsed:o}}=e,s=[];return n&&(r&&(s.push(fm(i&&!0===r.isBO100Enabled)),s.push(vm({isEnableBreakoutRoom:r.isEnableBreakoutRoom,isEnableBOBroadcast:r.isEnableBOBroadcast,isEnableBOViewActivityStatus:r.isEnableBOViewActivityStatus,isEnableBOBroadcastVoice:r.isEnableBOBroadcastVoice}))),n.currentRoom.boConfId&&s.push(Fn()),void 0!==o&&s.push(Xg(o))),Me(s)}))),epics1:e=>pr(e,4174).pipe(At((e=>{Id(ql,e.payload.body.bid)})),St(ge)),epics2:(e,t)=>mr(e,7950).pipe(Tt(t),It((e=>{let[n,r]=e;const{payload:{body:{proto:i}}}=n,{breakoutRoom:{isHugeBO:o,currentRoom:{status:s,boId:a}},meeting:{userGUID:u}}=r;let c=i;o&&(c=function(e,t){if(Rk)return Rk.decode(e);var n=function(e){for(var t="",n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239);if(n+i>e.length)return[t,hk(e,n-1)];i?3==i?(r=((15&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,t+=String.fromCharCode(55296|r>>10,56320|1023&r)):t+=1&i?String.fromCharCode((31&r)<<6|63&e[n++]):String.fromCharCode((15&r)<<12|(63&e[n++])<<6|63&e[n++]):t+=String.fromCharCode(r)}}(e),r=n[0];return n[1].length&&fk(8),r}(function(e,t){return function(e,t,n){var r=e.length;if(!r||n&&n.f&&!n.l)return t||new BD(0);var i=!t||n,o=!n||n.i;n||(n={}),t||(t=new BD(3*r));var s=function(e){var n=t.length;if(e>n){var r=new BD(Math.max(2*n,e));r.set(t),t=r}},a=n.f||0,u=n.p||0,c=n.b||0,l=n.l,d=n.d,h=n.m,p=n.n,f=8*r;do{if(!l){a=ck(e,u,1);var g=ck(e,u+1,3);if(u+=3,!g){var m=e[(T=dk(u)+4)-4]|e[T-3]<<8,v=T+m;if(v>r){o&&fk(0);break}i&&s(c+m),t.set(e.subarray(T,v),c),n.b=c+=m,n.p=u=8*v,n.f=a;continue}if(1==g)l=ok,d=ak,h=9,p=5;else if(2==g){var y=ck(e,u,31)+257,S=ck(e,u+10,15)+4,b=y+ck(e,u+5,31)+1;u+=14;for(var E=new BD(b),w=new BD(19),I=0;I<S;++I)w[KD[I]]=ck(e,u+3*I,7);u+=3*S;var _=uk(w),C=(1<<_)-1,A=tk(w,_,1);for(I=0;I<b;){var T,R=A[ck(e,u,C)];if(u+=15&R,(T=R>>>4)<16)E[I++]=T;else{var O=0,P=0;for(16==T?(P=3+ck(e,u,3),u+=2,O=E[I-1]):17==T?(P=3+ck(e,u,7),u+=3):18==T&&(P=11+ck(e,u,127),u+=7);P--;)E[I++]=O}}var D=E.subarray(0,y),k=E.subarray(y);h=uk(D),p=uk(k),l=tk(D,h,1),d=tk(k,p,1)}else fk(1);if(u>f){o&&fk(0);break}}i&&s(c+131072);for(var x=(1<<h)-1,N=(1<<p)-1,M=u;;M=u){var F=(O=l[lk(e,u)&x])>>>4;if((u+=15&O)>f){o&&fk(0);break}if(O||fk(2),F<256)t[c++]=F;else{if(256==F){M=u,l=null;break}var L=F-254;if(F>264){var V=HD[I=F-257];L=ck(e,u,(1<<V)-1)+GD[I],u+=V}var B=d[lk(e,u)&N],j=B>>>4;if(B||fk(3),u+=15&B,k=QD[j],j>3&&(V=qD[j],k+=lk(e,u)&(1<<V)-1,u+=V),u>f){o&&fk(0);break}i&&s(c+131072);for(var U=c+L;c<U;c+=4)t[c]=t[c-k],t[c+1]=t[c+1-k],t[c+2]=t[c+2-k],t[c+3]=t[c+3-k];c=U}}n.l=l,n.p=M,n.b=c,n.f=a,l&&(a=1,n.m=h,n.d=d,n.n=p)}while(!a);return c==t.length?t:hk(t,0,c)}(e.subarray(function(e){31==e[0]&&139==e[1]&&8==e[2]||fk(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=e[10]|2+(e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)}(e),-8),new BD(function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}(e)))}(ai(i))));const l=[];let d;try{const e=JSON.parse(ii(c)),{ControlStatus:i,NameIndex:o,IsAutoJoinEnabled:h,IsBackToMainSessionEnabled:p,IsParticipantsChooseRoomEnabled:f,IsTimerEnabled:g,TimerDuration:m,IsTimerAutoEndEnabled:v,WaitSeconds:y,StartTimeOnMMR:S,ItemList:b,WhoStart:E,WhoStop:w,IsAutoMovetoMainSessionEnabled:I}=e,_={isAutoJoinRoom:h,isBackToMainSessionEnabled:p,isTimerEnabled:g,timerDuration:m,isTimerAutoEnabled:v,waitSeconds:y,isAutoMoveBackToMainSession:I,isRoomSelectionEnabled:f,whoStart:E,whoStop:w};l.push(tm(_)),l.push(em(S)),l.push(Zg(o)),l.push(nm(i));const C=b&&b.map((e=>({boId:e.BID,name:e.MeetingTitle,boStatus:e.Status,hostId:e.HostID,attendeeGuidList:e.ParticipantList||[]})))||[];switch(l.push(rm(C)),Id(Ql,{controlStatus:i,roomList:C}),i){case nh.InProgress:if(s!==ih.InRoom&&s!==ih.Joining){const e=function(e,t){const{meeting:{isHost:n,userGUID:r},breakoutRoom:{currentRoom:{status:i,boId:o}}}=t.value,s=Do.get(Ok),a=[];if(s)try{const{status:u,boId:c}=JSON.parse(s);if(u===ih.Invited)if(n)xk();else{const t=kk(e,r);t&&(a.push(Vk(t)),i!==ih.Initial&&o===t.boId||Id(Kl,{roomId:t.boId,name:t.name}))}else if(u===ih.InRoom){let i;if(i=n?e.find((e=>e.boId===c)):kk(e,r),i){a.push(Vk(i));const e=i.boId;Ov(t).subscribe((()=>{Ps.createAgent().joinBO(e)}))}xk()}}catch(e){console.error(e)}return a}(C,t);if(0===e.length){const e=kk(C,u);e&&l.push(Vk(e))}else l.push(...e)}else if(s===ih.InRoom&&n.type===`${Vn}`){const e=kk(C,u);e&&Bk(t).subscribe((t=>{a===e.boId||t||qk.joinBO(e.boId)}))}_.isTimerEnabled&&_.timerDuration>0&&(d=function(e,t,n){return Bk(e).pipe(Tt(e),It((r=>{let[i,o]=r;const{breakoutRoom:{currentRoom:{status:s},meetingElapsedTime:a},meeting:{joinMeetingTimeStamp:u}}=o,c=u-1e3*a+1e3*n+1e3*t;if(performance.now()<c){if(i)return ut(1e3).pipe(Ke((()=>Math.floor((c-performance.now())/1e3))),Tt(e),Ct((e=>{let[t,n]=e;const{breakoutRoom:{controlStatus:r,currentRoom:{status:i}},socket:{zoomSocketStatus:o},meeting:{isHost:s}}=n;return t>=0&&s&&r===nh.InProgress&&(i===ih.InRoom||i===ih.MainSession||i===ih.Initial)&&o===Th.Connected})),At((e=>{let[t]=e;Id(Wl,{countdown:t})})),ht((e=>{let[t]=e;return 0===t})),At((e=>{let[,t]=e;const{breakoutRoom:{options:n}}=t;n.isTimerAutoEnabled?Ps.createAgent().stopBO(nh.Closing):Id(Zl)})),St(ge));if(s===ih.InRoom)return ut(1e3).pipe(Ke((()=>Math.floor((c-performance.now())/1e3))),Tt(e),Ct((e=>{let[t,n]=e;const{breakoutRoom:{currentRoom:{status:r}},meeting:{isHost:i},socket:{zoomSocketStatus:o}}=n;return t>=0&&r===ih.InRoom&&!i&&o===Th.Connected})),At((e=>{let[t]=e;Id(Wl,{countdown:t})})),St(ge))}return ge})))}(t,_.timerDuration,S));break;case nh.Closing:d=Bk(t).pipe(ht((e=>e)),Ye((()=>{const e=[],{breakoutRoom:{closingRoomTime:n,currentRoom:{status:i}},participants:{attendeesList:o}}=r;let s=_.waitSeconds;if(0!==n&&_.waitSeconds>0){const e=Math.floor((performance.now()-n)/1e3);s=Math.max(_.waitSeconds-e,0)}if(0===s)return qk.stopBO(nh.Closed),ge;{if(i!==ih.InRoom&&o.length>1&&o.every((e=>!e.bid)))return qk.stopBO(nh.Closed),ge;n||e.push(cm(performance.now()));const r=performance.now()+1e3*s;return ct(Me(e),ut(1e3).pipe(Ke((()=>Math.floor((r-performance.now())/1e3))),Tt(t),Ct((e=>{let[t,n]=e;const{breakoutRoom:{controlStatus:r},meeting:{isHost:i},socket:{zoomSocketStatus:o}}=n;return t>=0&&r===nh.Closing&&o===Th.Connected&&i})),At((e=>{let[t]=e;t>=0&&Id($l,{countdown:t})})),ht((e=>{let[t]=e;return 0===t})),At((()=>{qk.stopBO(nh.Closed)})),St(ge)))}})));break;case nh.Closed:l.push(cm(0)),s===ih.Leaving?l.push(om(ih.MainSession)):s===ih.Invited?l.push(om(ih.Initial)):s!==ih.InRoom&&s!==ih.Joining||l.push(...Nk()),xk()}}catch(e){console.error(e)}return d?ct(Me(l),d):Me(l)}))),epics3:(e,t)=>mr(e,4194).pipe(Tt(t),It((e=>{let[t,n]=e;const{payload:{body:{bid:r,botoken:i,confID:o}}}=t,{meeting:{isHost:s},breakoutRoom:{rooms:a,currentRoom:{status:u}}}=n,c=[],l=a.find((e=>e.boId===r));return l&&(c.push(Vk(l,s)),c.push(sm(o)),c.push(am(i)),s||u!==ih.InRoom?c.push(...Mk(l.name,u)):c.push(...Fk(l.name))),Id(Yl,{boId:r}),Me(c)}))),epics4:(e,t)=>e.pipe(Ut(`${xn}`,`${Vn}`),ht((e=>7949===e.payload.evt)),Tt(t),Ye((e=>{var n;let[r,i]=e;const{payload:{body:o}}=r,{meeting:{userGUID:s},breakoutRoom:{rooms:a,options:{isAutoJoinRoom:u,isAutoMovetoMainSession:c},currentRoom:{status:l},mainSessionAttendeeList:d},participants:{attendeesList:h}}=i,{commandType:p}=o,f=[];let g;const m=null===(n=(Lk(l)?h:d).find((e=>e.userGUID===s)))||void 0===n?void 0:n.userId;switch(p){case oh.Join:{const{targetBID:e,botoken:t,confID:n,joinReason:r,requestSourceID:c}=o,l=kk(a,s);if(l&&l.boId===e){f.push(sm(n)),f.push(am(t));const o=Number(r)===ch.Active&&m===Number(c);u||o?(o&&Id(Yl,{boId:e}),f.push(...Mk(l.name))):(Do.set(ko.WebclientBreakoutRoomCommand,p,Oo.SessionStorage),Id(Kl,{roomId:e,name:l.name,...Hk(c,i)}))}break}case oh.Switch:{const{targetBID:e,botoken:t,confID:n,joinMethod:r,requestSourceID:c}=o,d=kk(a,s);if(d&&d.boId===e){f.push(im({boId:d.boId,boToken:t,boConfId:n,name:d.name}));const o=m===Number(c)&&Number(r)===uh.AskToLeave;l===ih.Invited?(Do.set(ko.WebclientBreakoutRoomCommand,p,Oo.SessionStorage),u||m===Number(c)?f.push(...Mk(d.name)):Id(Kl,{roomId:e,name:d.name,...Hk(c,i)})):f.push(...Fk(d.name)),o&&Id(Yl,{boId:e})}break}case oh.Leave:{const{waitTime:e,joinMethod:n}=o;if(Lk(l))f.push(im({boId:"",boToken:"",boConfId:"",status:ih.Initial}));else{const r=Number(e);if(r>0){const e=performance.now()+1e3*r;g=ut(1e3).pipe(Ke((()=>Math.floor((e-performance.now())/1e3))),Tt(t),Ct((e=>{let[t,n]=e;const{breakoutRoom:{controlStatus:r,currentRoom:{status:i}},meeting:{isHost:o},socket:{zoomSocketStatus:s}}=n;return t>=0&&s===Th.Connected&&r===nh.Closing&&i===ih.InRoom&&!o})),At((e=>{let[t]=e;t>=0&&Id($l,{countdown:t})})),St(ge))}else if(Number(n)!==uh.AskToLeave||c)f.push(...Nk());else{var v,y,S;const{requestSourceID:e}=o,t=Number(e),{participants:{attendeesList:n}}=i;let r=n.find((e=>e.userId===t));if(!r){const{breakoutRoom:{mainSessionAttendeeList:e}}=i;r=e.find((e=>e.userId===t))}Id(nd,{inviterId:null===(v=r)||void 0===v?void 0:v.userId,inviterGuid:null===(y=r)||void 0===y?void 0:y.userGUID,inviterName:null===(S=r)||void 0===S?void 0:S.displayName})}xk()}break}case oh.Broadcast:{const{textContent:e,requestID:t}=o;if(e){const{meeting:{encType:n},participants:{attendeesList:r},breakoutRoom:{mainSessionAttendeeList:o}}=i;let s="";if(n===Jo.AES_GCM){const e=(Lk(l)?r:o).find((e=>e.userId===Number(t)));e&&(s=e.zoomID)}g=Me(es.beginDecrypt({decryptedText:e,type:Qo.BO_BROADCAST,zoomId:s}).then((e=>{let{message:t}=e;return Id(Gl,{message:t}),lm(t)})))}break}case oh.HelpReq:{const{requestID:e}=o,{breakoutRoom:{mainSessionAttendeeList:t,rooms:n,currentRoom:{boId:r},hostReplyToQuestionerType:s,hostReplyToRequestId:a},participants:{attendeesList:u}}=i;if(e){if(l===ih.InRoom){const n=t.find((t=>t.userId===e));if(n&&n.bid===r){qk.askForHelpResultBO(e,ah.AlreadyInRoom);break}}if(s===ah.Received&&a!==e)qk.askForHelpResultBO(e,ah.Busy);else{qk.askForHelpResultBO(e,ah.Received),f.push(dm(ah.Received),hm(e));const r=(l===ih.InRoom?t:u).find((t=>t.userId===e));if(r){const t=r.bid,i=n.find((e=>e.boId===t));i&&Id(zl,{userId:e,userGuid:r.userGUID,displayName:r.displayName,roomName:i.name,roomId:i.boId})}}}break}case oh.HelpRes:{const{helpResult:e}=o;Id(Jl,{result:Number(e)});break}case oh.BOActivity:{var b;const{activityRoster:e,activityTalking:t,requestID:n}=o,r=null===(b=(fT(i)?i.breakoutRoom.mainSessionAttendeeList:i.participants.attendeesList).find((e=>e.userId===n)))||void 0===b?void 0:b.userGUID;if(r){const{breakoutRoom:{rooms:o}}=i,s=kk(o,r),a=function(e,t){const n={isTalking:1===t};return Uk.forEach((t=>{const{mask:r,key:i,value:o}=t;return(r&e)===r&&Object.assign(n,{[`${i}`]:o}),n})),n}(Number(e),Number(t));f.push(ym({userGuid:r,status:a})),Id(rd,{...a,userId:n,userGuid:r,roomId:null==s?void 0:s.boId,roomName:null==s?void 0:s.name})}break}}return g?ct(Me(f),g):Me(f)}))),epics5:(e,t)=>fr(e,as).pipe(Tt(t),It((e=>{let[t,n]=e;const{payload:{body:{res:r,elapsed:i}}}=t,o=[];return r===wi.MeetingHasClosed||r===wi.UserHasBeenRemoved?(xk(),o.push(...zv(n,!1))):r===wi.Success&&(o.push(Xg(i)),o.push(om(ih.InRoom)),Do.set(ko.WebclientBreakoutRoomAttendeeStatus,JSON.stringify({status:ih.InRoom,boId:n.breakoutRoom.currentRoom.boId}),Oo.SessionStorage)),Me(o)}))),epics6:(e,t)=>fr(e,rs).pipe(Ke((e=>Ew(e.payload.body))),Tt(t),Ye((e=>{let[t,n]=e;const r=[pm(t)],{participants:{attendeesList:i},breakoutRoom:{mainSessionAttendeeList:o,isUserRoleUpdated:s},meeting:{userId:a}}=n;let u=[];return["add","update"].forEach((e=>t[e]&&u.push(...t[e]))),u=u.filter((e=>Kk.some((t=>void 0!==e[t])))).map((e=>{const t=o.find((t=>t.userId===e.userId));if(t){const n=i.find((e=>e.zoomID===t.zoomID));if(n)return void 0===e.userRole||s||n.userId!==a||(r.push(mm(!0)),Id(Xl,e)),void 0!==e.bCCEditor&&r.push(Ng({editorId:e.bCCEditor?n.userId:"",isEditor:!!e.bCCEditor,editorZoomId:e.bCCEditor?n.zoomID:""})),delete e.bRaiseHand,delete e.bCapsPinMultiVideo,{...e,userId:n.userId}}return null})).filter((e=>!!e)),u.length>0&&(Id(Us,u),r.push(Rd({update:u}))),Id(td),Me(r)}))),epics7:e=>fr(e,is).pipe(ht((e=>{const{payload:{body:t}}=e;return void 0!==(null==t?void 0:t.bAllowAttendeeRename)||void 0!==(null==t?void 0:t.chatPriviledge)||void 0!==(null==t?void 0:t.lockShare)})),Ke((e=>{const{payload:{body:t}}=e;return void 0!==t.bAllowAttendeeRename?zi(e.payload.body):void 0!==t.chatPriviledge?bg(t.chatPriviledge):void 0!==t.lockShare?Ep(t.lockShare):void 0}))),epics8:(e,t)=>pr(e,rs).pipe(Tt(t),ht((e=>{let[,t]=e;const{meeting:{isHost:n},breakoutRoom:{controlStatus:r,currentRoom:{status:i}}}=t;return n&&r===nh.Closing&&i!==ih.InRoom})),ke(le),At((()=>{const{participants:{attendeesList:e}}=t.value;e.every((e=>!e.bid))&&e.length>1&&qk.stopBO(nh.Closed)})),St(ge)),epics9:(e,t)=>pr(e,4214).pipe(Tt(t),It((e=>{let[n,r]=e;const{payload:{body:{proto:i}}}=n,{breakoutRoom:{rooms:o,isHugeBO:s}}=r;try{const e=JSON.parse(ii(i)),n=[];if(e&&e.PreAssignBoList&&Array.isArray(e.PreAssignBoList)){const r=e.PreAssignBoList.map((e=>({name:e.BoName,emails:e.email})));n.push(gm(r));const i=s?100:50;if(o.length+r.length<i){const e=r.map((e=>e.name));return qk.batchCreateBOToken(e),ct(Me(n),jk(e.length).pipe(Tt(t),Ye((e=>{let[{boIdList:t},n]=e;const i=bh(n),o=r.map(((e,n)=>{const{emails:r,name:o}=e;let s=[];return r&&Array.isArray(r)&&(s=r.map((e=>i.filter((t=>t.userEmail===e)).map((e=>e.userGUID)))).reduce(((e,t)=>[...e,...t]),[])),{boId:t[n],name:o,attendeeGuidList:s}})),s=o.map(((e,t)=>({roomId:e.boId,name:e.name,emails:r[t].emails})));return Id(ed,{rooms:s}),Me([rm(o),gm(s)])}))))}return Me(n)}}catch(e){console.error("pre assign proto is not valid")}return ge}))),epics10:(e,t)=>mr(e,rs).pipe(Tt(t),ht((e=>{let[t,n]=e;const{meeting:{isHost:r,meetingStatus:i,meetingOptions:o},breakoutRoom:{controlStatus:s}}=n,{payload:{body:a}}=t;return i===Co.Joined&&(null==o?void 0:o.isAllowBreakoutRoomPreAssign)&&r&&(s===nh.NotStarted||s===nh.InProgress)&&Array.isArray(a.add)})),Ye((e=>{let[t,n]=e;const{breakoutRoom:{controlStatus:r,rooms:i,preAssignedRooms:o,currentRoom:{status:s}},participants:{failoverAttendeesList:a}}=n,u=null==o?void 0:o.filter((e=>i.findIndex((t=>t.boId===e.roomId))>-1)),{payload:{body:{add:c}}}=t,l=[];return u.length>0&&c.filter((e=>e.userEmail&&e.userGUID)).filter((e=>-1===a.findIndex((t=>t.zoomID===e.zoomID)))).forEach((e=>{if(!kk(i,e.userGUID))for(let n=0;n<(null==u?void 0:u.length);n++){const o=u[n];if(o.emails.includes(e.userEmail)){if(r===nh.NotStarted){const t=hE(i,(t=>{const n=t.find((e=>e.boId===o.roomId));null==n||n.attendeeGuidList.push(e.userGUID)}));l.push(rm(t))}else r===nh.InProgress&&(s===ih.InRoom&&t.type===`${Vn}`?qk.assignToBO(e.id,String(o.roomId)):s!==ih.Initial&&s!==ih.MainSession||qk.assignToBO(e.id,String(o.roomId)));break}}})),Me(l)}))),epics11:(e,t)=>pr(e,rs).pipe(ht((e=>{const{breakoutRoom:{mainSessionAttendeeList:n}}=t.value,{payload:{body:r}}=e;return n.length>0&&(void 0!==r.add||void 0!==r.update)})),ke(de),Ke((e=>Ew(e.payload.body))),Ye((e=>{const{breakoutRoom:{mainSessionAttendeeList:n,isUserRoleUpdated:r},participants:{attendeesList:i}}=t.value;let o=[];const s=[];["add","update"].forEach((t=>e[t]&&o.push(...e[t])));const a=[...Kk,"isHost"];o=o.filter((e=>a.some((t=>void 0!==e[t]))));const u=o.filter((e=>void 0!==e.zoomID));return o=o.map((e=>{var t,o,c,l;const d=null!==(t=null!==(o=e.zoomID)&&void 0!==o?o:null===(c=u.find((t=>t.userId===e.userId)))||void 0===c?void 0:c.zoomID)&&void 0!==t?t:null===(l=i.find((t=>t.userId===e.userId)))||void 0===l?void 0:l.zoomID;if(d){const t=n.find((e=>e.zoomID===d));if(t)return r||(s.push(mm(!0)),Id(Xl,t)),Object.keys(e).filter((t=>Object.prototype.hasOwnProperty.call(e,t))).filter((e=>a.includes(e))).reduce(((n,r)=>{const i=t[r];if(void 0!==i||"bCoHost"===r){const t="boolean"==typeof e[r]?!!i:i;Object.assign(n,{[r]:t})}return n}),{userId:e.userId})}})).filter(Boolean),o.length>0&&(Id(Us,o),s.push(Rd({update:o}))),Me(s)}))),epics12:e=>fr(e,7999).pipe(At((e=>{const{payload:{body:{bStatus:t}}}=e;Id(id,{status:!!t})})),Ye((()=>ge))),epics13:(e,t)=>pr(e,7940).pipe(Ye((e=>{const{payload:{body:{bHost:n}}}=e,{breakoutRoom:{isBroadcastVoice:r}}=t.value,i=[];return!n&&r&&(Ls.getInstance().broadcastVoiceToBreakoutRoom(!1),i.push(Sm(!1))),Me(i)})))},ex=hr(Xk,Zk);let tx=function(e){return e[e.Ready=0]="Ready",e[e.UserSub=1]="UserSub",e[e.ManualCaptionerEnabled=2]="ManualCaptionerEnabled",e[e.ManualCaptionerDisabled=3]="ManualCaptionerDisabled",e}({}),nx=function(e){return e[e.Unspecified=-1]="Unspecified",e[e.English=0]="English",e[e["Chinese (Simplified)"]=1]="Chinese (Simplified)",e[e.Japanese=2]="Japanese",e[e.German=3]="German",e[e.French=4]="French",e[e.Russian=5]="Russian",e[e.Portuguese=6]="Portuguese",e[e.Spanish=7]="Spanish",e[e.Korean=8]="Korean",e[e.Italian=9]="Italian",e[e.Reserved=10]="Reserved",e[e.Vietnamese=11]="Vietnamese",e[e.Dutch=12]="Dutch",e[e.Ukrainian=13]="Ukrainian",e[e.Arabic=14]="Arabic",e[e.Bengali=15]="Bengali",e[e["Chinese (Traditional)"]=16]="Chinese (Traditional)",e[e.Czech=17]="Czech",e[e.Estonian=18]="Estonian",e[e.Finnish=19]="Finnish",e[e.Greek=20]="Greek",e[e.Hebrew=21]="Hebrew",e[e.Hindi=22]="Hindi",e[e.Hungarian=23]="Hungarian",e[e.Indonesian=24]="Indonesian",e[e.Malay=25]="Malay",e[e.Persian=26]="Persian",e[e.Polish=27]="Polish",e[e.Romanian=28]="Romanian",e[e.Swedish=29]="Swedish",e[e.Tamil=30]="Tamil",e[e.Telugu=31]="Telugu",e[e.Tagalog=32]="Tagalog",e[e.Turkish=33]="Turkish",e[e.NoTranslation=400]="NoTranslation",e[e.DefaultManualInput=401]="DefaultManualInput",e[e.Customized=500]="Customized",e}({}),rx=function(e){return e[e.Unknown=0]="Unknown",e[e.Close=1]="Close",e[e.New=2]="New",e[e.Insert=3]="Insert",e[e.Delete=4]="Delete",e[e.Reset=5]="Reset",e[e.Audiodesc=6]="Audiodesc",e[e.Speaker=7]="Speaker",e[e.Error=8]="Error",e}({}),ix=function(e){return e[e.TranslateNotSupport=1]="TranslateNotSupport",e}({}),ox=function(e){return e[e.Unspecified=0]="Unspecified",e[e.InMeetingManual=1]="InMeetingManual",e[e.ExternalCaptioner=2]="ExternalCaptioner",e[e.ASR=4]="ASR",e}({});const sx={en:0,zh:1,ja:2,de:3,fr:4,ru:5,pt:6,es:7,ko:8,it:9,en1:10,vi:11,nl:12,uk:13,ar:14,bn:15,"zh-hant":16,cs:17,et:18,fi:19,el:20,he:21,hi:22,hu:23,id:24,ms:25,fa:26,pl:27,ro:28,sv:29,ta:30,te:31,tl:32,tr:33},ax=Object.keys(nx).filter((e=>/\d+/.test(nx[e]))).reduce(((e,t)=>({...e,[`${nx[t]}`]:t})),{}),ux=Object.keys(sx).reduce(((e,t)=>(Object.assign(e,{[`${sx[`${t}`]}`]:t}),e)),{}),cx="zoom-sdk-live-trasncription",lx="live-trasncription";let dx=function(e){return e[e.English=0]="English",e[e.Chinese=1]="Chinese",e[e.Japanese=2]="Japanese",e[e.German=3]="German",e[e.French=4]="French",e[e.Russian=5]="Russian",e[e.Portuguese=6]="Portuguese",e[e.Spanish=7]="Spanish",e[e.Korean=8]="Korean",e[e.Italian=9]="Italian",e[e.Reserved=10]="Reserved",e[e.Vietnamese=11]="Vietnamese",e[e.Dutch=12]="Dutch",e[e.Ukrainian=13]="Ukrainian",e[e.Arabic=14]="Arabic",e[e.Bengali=15]="Bengali",e[e["Chinese (Traditional)"]=16]="Chinese (Traditional)",e[e.Czech=17]="Czech",e[e.Estonian=18]="Estonian",e[e.Finnish=19]="Finnish",e[e.Greek=20]="Greek",e[e.Hebrew=21]="Hebrew",e[e.Hindi=22]="Hindi",e[e.Hungarian=23]="Hungarian",e[e.Indonesian=24]="Indonesian",e[e.Malay=25]="Malay",e[e.Persian=26]="Persian",e[e.Polish=27]="Polish",e[e.Romanian=28]="Romanian",e[e.Swedish=29]="Swedish",e[e.Tamil=30]="Tamil",e[e.Telugu=31]="Telugu",e[e.Tagalog=32]="Tagalog",e[e.Turkish=33]="Turkish",e[e.NoTranslation=400]="NoTranslation",e[e.DefaultManualInput=401]="DefaultManualInput",e}({}),hx=function(e){return e.English="en",e["Chinese (Simplified)"]="zh",e.Japanese="ja",e.German="de",e.French="fr",e.Russian="ru",e.Portuguese="pt",e.Spanish="es",e.Korean="ko",e.Italian="it",e.Reserved="en1",e.Vietnamese="vi",e.Dutch="nl",e.Ukrainian="uk",e.Arabic="ar",e.Bengali="bn",e["Chinese (Traditional)"]="zh-hant",e.Czech="cs",e.Estonian="et",e.Finnish="fi",e.Greek="el",e.Hebrew="he",e.Hindi="hi",e.Hungarian="hu",e.Indonesian="id",e.Malay="ms",e.Persian="fa",e.Polish="pl",e.Romanian="ro",e.Swedish="sv",e.Tamil="ta",e.Telugu="te",e.Tagalog="tl",e.Turkish="tr",e}({});function px(e){const t=e===nx.Unspecified?nx.Reserved:e;Ls.getInstance().selectLanguageChannelForNewLTT(t)}const fx=qd(Hd,(function(e,t){return qC(e,t)}))([bh,e=>{let{meeting:{gatewayUserList:t}}=e;return t}],((e,t)=>{const n={};return e.forEach((e=>{Object.assign(n,{[`${e.userId}`]:e.zoomID})})),null==t||t.forEach((e=>{Object.assign(n,{[`${e.userId}`]:e.sn})})),n})),gx=Kd([bh],(e=>e.find((e=>!0===e.bCCEditor)))),mx=Kd([bh,Wd],((e,t)=>e.some((e=>!0===e.bCCEditor&&e.userId===t)))),vx=Ps.createAgent(),yx={isEnableTranslatedCaptions:!1,isHostLockSpeakingLanguage:!1,transcriptionLang:[],isEnableAutomatedCaptions:!1,supportedTranscriptionLanguage:[],isLiveTranscriptionEnabled:!1,isHostDisableCaptions:!1,isManualCaptionerEnabled:!1,gatewayId:void 0,isLiveTranscriptionSubscribed:!1,messageRecords:[],isRecordsReduced:!1,reducedRecordsCount:0},Sx=Rn({[`${jm}`]:hE(((e,t)=>{let{payload:n}=t;e.isLiveTranscriptionEnabled=n})),[`${Um}`]:hE(((e,t)=>{let{payload:n}=t;const{transcriptionLang:r,translatedSetting:i,...o}=n;r&&(e.transcriptionLang=r.split(";").map((e=>{const t=e&&sx[e];return void 0!==t?{lang:e,code:t}:null})).filter(Boolean)),i&&(e.translatedSetting=Object.keys(i).map((e=>{const t=i[e];if(t){const n=t.split(";").map((e=>{const t=e&&sx[e];return void 0!==t?{lang:e,code:t}:null})).filter(Boolean);return{lang:e,code:sx[e],translatedToLanguage:n}}return null})).filter(Boolean)),Object.assign(e,o)})),[`${Hm}`]:hE(((e,t)=>{let{payload:n}=t;e.isManualCaptionerEnabled=n})),[`${qm}`]:hE(((e,t)=>{let{payload:n}=t;e.gatewayId=n})),[`${tv}`]:hE(((e,t)=>{let{payload:n}=t;e.isHostDisableCaptions=n})),[`${Km}`]:hE(((e,t)=>{let{payload:n}=t;e.supportedTranscriptionLanguage=n})),[`${Wm}`]:hE(((e,t)=>{let{payload:n}=t;e.currentTranscriptionLang=n})),[`${Gm}`]:hE(((e,t)=>{let{payload:n}=t;e.currentTranslationLang=n})),[`${zm}`]:hE(((e,t)=>{let{payload:n}=t;e.messageRecords.push(n)})),[`${Jm}`]:hE(((e,t)=>{let{payload:n}=t;const r=e.messageRecords.find((e=>e.msgId===n.msgId));r&&Object.assign(r,n)})),[`${Qm}`]:hE(((e,t)=>{let{payload:n}=t;const{remains:r,reducedRecordsCount:i}=n,o=e.messageRecords.length-r;e.isRecordsReduced=!0,e.reducedRecordsCount=i,e.messageRecords.splice(0,o)})),[`${$m}`]:hE(((e,t)=>{let{payload:n}=t;e.isLiveTranscriptionSubscribed=n})),[`${Ym}`]:hE(((e,t)=>{let{payload:n}=t;e.liveTransEngineType=n})),[`${Zm}`]:hE((e=>{e.stateBeforeFailover=void 0})),[`${Xm}`]:hE(((e,t)=>{let{payload:n}=t;e.lastManualCaption=n})),[`${ev}`]:(e,t)=>{let{payload:n}=t;return n?{...yx,stateBeforeFailover:{currentTranscriptionLang:e.currentTranscriptionLang,currentTranslationLang:e.currentTranslationLang,isLiveTranscriptionSubscribed:e.isLiveTranscriptionSubscribed},messageRecords:e.messageRecords,isRecordsReduced:e.isRecordsReduced,reducedRecordsCount:e.reducedRecordsCount}:{...yx}}},yx);var bx;const Ex=Ps.createAgent(),wx=oT("Live transcription");let Ix=(bx=class extends aT{startLiveTranscription(){const{[GA]:e,[zA]:t}=this,{liveTranscription:{isLiveTranscriptionEnabled:n,isEnableTranslatedCaptions:r,isLiveTranscriptionSubscribed:i,isHostLockSpeakingLanguage:o,isHostDisableCaptions:s}}=e();return i?Promise.resolve(""):s?Promise.reject({type:yl,reason:"Captions has been disabled by host."}):n?(Ex.enableNewLLT(),Cd(na).then((()=>(o?Ex.setSpokenLanguage(nx.English):px(nx.Unspecified),t(Wm(nx.English)),r&&Ex.setTranslationLanguage(),Cd({event:na,operations:[ht((e=>!0===e.autoCaption&&void 0!==e.lang))]}))))):Promise.reject({type:yl,reason:"Live transcription is not enabled."})}disableCaptions(e){const{[GA]:t}=this,{liveTranscription:{isHostDisableCaptions:n}}=t();return e?n?Promise.resolve():(Ex.disableCaptions(!0),Cd(ia)):n?(Ex.disableCaptions(!1),Cd(ia)):Promise.resolve()}setSpeakingLanguage(e){const{[GA]:t,[zA]:n}=this,{liveTranscription:{isLiveTranscriptionSubscribed:r,isHostLockSpeakingLanguage:i,transcriptionLang:o}}=t(),s=o.find((t=>t.lang===e));if(s){const{code:e}=s;return r?(i?Ex.setSpokenLanguage(e):px(e),n(Wm(e)),Promise.resolve("")):Promise.reject({type:yl,reason:"Cannot set speaking language before starting live transcription"})}return Promise.reject({type:Il,reason:"Unsupported transcription language"})}setTranslationLanguage(e){const{[GA]:t,[zA]:n}=this,r=t(),{liveTranscription:{isEnableTranslatedCaptions:i,isLiveTranscriptionSubscribed:o,translatedSetting:s,currentTranscriptionLang:a}}=r;if(!i)return Promise.reject({type:yl,reason:"Live translation is not enabled."});if(!o)return Promise.reject({type:yl,reason:"Cannot set translation language before starting live transcription"});if(e){const t=null==s?void 0:s.find((e=>e.code===a));if(t){const{translatedToLanguage:n}=t,r=n.find((t=>t.lang===e));if(r)return Ex.setTranslationLanguage(r.code),Cd({event:na,operations:[ht((e=>!0===e.autoCaption&&e.lang===r.code)),gt(1)]},(e=>{let{lang:t}=e;return t===r.code}))}return Promise.reject({type:yl,reason:`Cannot support translating ${ax[a||0]} to ${e}`})}return Ex.setTranslationLanguage(),n(Gm(void 0)),Promise.resolve("")}enableManualCaptioner(){const{[GA]:e}=this,{meeting:{meetingOptions:t},liveTranscription:{isManualCaptionerEnabled:n,isHostDisableCaptions:r}}=e();if(r)return Promise.reject({type:yl,reason:"Captions has been disabled by host."});const{isEnableManualCaptions:i,isEnableClosedCaption:o}=t;return(null!=i?i:o)?n?Promise.resolve():(Ex.enableManualCaption(!0),Cd(na,(e=>{let{autoCaption:t}=e;return!1===t}))):Promise.reject({type:yl,reason:"Manual caption is not enabled."})}disableManualCaptioner(){const{[GA]:e}=this,{liveTranscription:{isManualCaptionerEnabled:t}}=e();return t?(Ex.enableManualCaption(!1),Cd(na,(e=>{let{autoCaption:t}=e;return!0===t}))):Promise.resolve()}assignManualCaption(e){var t;const{[GA]:n}=this,r=n(),{liveTranscription:{isManualCaptionerEnabled:i},participants:{attendeesList:o},meeting:{userId:s}}=r;if(!i)return Promise.reject({type:yl,reason:"Cannot assign caption editor due to the manual captioner is not enabled."});if((null===(t=gx(r))||void 0===t?void 0:t.userId)===e)return Promise.resolve("");const a=o.find((t=>t.userId===e));return a?(Ex.assignCC(e,!0),Cd({event:s===e?Bs:Us,operations:[ht((t=>t.userId===e)),gt(1)]},(e=>!0===e.bCCEditor))):Promise.reject({type:Il,reason:"Cannot find the user"})}sendCaptionTextManually(e,t){var n;const{[GA]:r,[zA]:i}=this,o=r(),{liveTranscription:{lastManualCaption:s},meeting:{userId:a}}=o,u=gh(o);let c=Promise.resolve();const l=null===(n=gx(o))||void 0===n?void 0:n.userId;return null!=u&&u.isHost&&l!==a&&(c=this.assignManualCaption(a)),c.then((()=>mx(r())?function(e,t,n){const r=e.length,i=[];var o;if(n)i.push({op:"close",text:e,msgId:null!==(o=null==t?void 0:t.msgId)&&void 0!==o?o:li()});else if(t&&null!=t&&t.text){const n=t.text.length;let o=0,s=0;for(;e[o]===t.text[o]&&o<r;)s+=ui(e[o]),o+=1;o===n&&o===r?i.push({op:"same"}):o===n&&o<r?i.push({op:"insert",text:e.slice(o),size:0,pos:s,msgId:t.msgId}):o<n&&o===r?i.push({op:"delete",size:0,pos:s,msgId:t.msgId}):(i.push({op:"delete",size:0,pos:s,msgId:t.msgId}),i.push({op:"insert",text:e.slice(o),pos:s,msgId:t.msgId}))}else r>0&&i.push({op:"start",text:e,pos:0,size:0,msgId:li()});return i.filter((e=>"same"!==e.op))}(e,s,t):Promise.reject({type:El,reason:"Cannot type caption "}))).then((e=>Array.isArray(e)?(e.forEach((e=>{const{text:n,...r}=e;es.beginEncrypt({text:null!=n?n:"",type:Qo.CC_MESSAGE}).then((o=>{Ex.sendManualCaption({text:o,...r});const s=t?void 0:{text:n,msgId:e.msgId};i(Xm(s))}))})),Cd(ta,(e=>e.source===ox.InMeetingManual))):""))}getLiveTranscriptionStatus(){const{[GA]:e}=this,{liveTranscription:{isLiveTranscriptionEnabled:t,isEnableTranslatedCaptions:n,isManualCaptionerEnabled:r,transcriptionLang:i,translatedSetting:o,isHostDisableCaptions:s}}=e();return{isLiveTranscriptionEnabled:t,isLiveTranslationEnabled:n,isHostDisableCaptions:s,isManualCaptionerEnabled:r,transcriptionLanguage:i.map((e=>e.lang)).join(";"),translationLanguage:null==o?void 0:o.map((e=>({speakingLanguage:e.lang,translatedToLanguage:e.translatedToLanguage.map((e=>e.lang)).join(";")})))}}getLiveTranscriptionSetting(){const{[GA]:e}=this,{meeting:{meetingOptions:t}}=e(),{isEnableManualCaptions:n,isEnableLiveTranscription:r,isEnableClosedCaption:i,isEnableAllowThirdPartyCCToken:o,isEnableViewFullTranscript:s,isEnableSaveCaptions:a}=t||{};return{isEnableManualCaptions:n,isEnableLiveTranscription:r,isEnableClosedCaption:i,isEnableAllowThirdPartyCCToken:o,isEnableViewFullTranscript:s,isEnableSaveCaptions:a}}getCurrentTranscriptionLanguage(){const{[GA]:e}=this,{liveTranscription:{currentTranscriptionLang:t}}=e();return void 0!==t?{code:ux[t],name:ax[t]}:null}getCurrentTranslationLanguage(){const{[GA]:e}=this,{liveTranscription:{currentTranslationLang:t}}=e();return void 0!==t?{code:ux[t],name:ax[t]}:null}getLatestTranscription(){const{[GA]:e}=this,{liveTranscription:{messageRecords:t,isManualCaptionerEnabled:n}}=e(),r=n?nx.DefaultManualInput:nx.NoTranslation,i=t.filter((e=>e.language===r));return i.length?i[i.length-1].text:""}getLatestTranslation(){const{[GA]:e}=this,{liveTranscription:{messageRecords:t,currentTranslationLang:n,isEnableTranslatedCaptions:r}}=e();if(r||void 0!==n){const e=t.filter((e=>e.language===n));return e.length?e[e.length-1].text:""}return""}getFullTranscriptionHistory(){const{[GA]:e}=this,t=e(),{liveTranscription:{messageRecords:n,isRecordsReduced:r}}=t;return r?function(e){return void 0!==window.indexedDB?new Promise((t=>{const n=window.indexedDB.open(cx,1);n.addEventListener("success",(()=>{const r=n.result;if(r.objectStoreNames.contains(lx)){const n=r.transaction([lx],"readonly").objectStore(lx),i=[],o=e.meeting.meetingId,s=n.openCursor();s.onsuccess=()=>{const e=s.result;e?(e.value.mid===o&&i.push(...e.value.records),e.continue()):(t(i),r.close())}}else t("")}))})):Promise.resolve("")}(t).then((e=>Array.isArray(e)?e.concat(n):[...n])):[...n]}getManualCaptionEditor(){const{[GA]:e}=this,t=e(),{closedCaption:{editorId:n}}=t;let r;if(!n)return{};if(r=bh(t).find((e=>e.userId===n)),!r)return{};const{userId:i,isHost:o,displayName:s,avatar:a,bCoHost:u,zoomID:c}=r;return{userId:i,isHost:o,displayName:s,avatar:a,bCoHost:u,zoomID:c}}getManualCaptionUrl(){const{[GA]:e}=this,{meeting:{meetingOptions:t,ccUrl:n}}=e(),{isEnableManualCaptions:r}=t||{};return r?n:(console.warn("you not enable manual caption"),"")}},$A(bx.prototype,"startLiveTranscription",[YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"startLiveTranscription"),bx.prototype),$A(bx.prototype,"disableCaptions",[XA,YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"disableCaptions"),bx.prototype),$A(bx.prototype,"setSpeakingLanguage",[YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"setSpeakingLanguage"),bx.prototype),$A(bx.prototype,"setTranslationLanguage",[YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"setTranslationLanguage"),bx.prototype),$A(bx.prototype,"enableManualCaptioner",[XA,YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"enableManualCaptioner"),bx.prototype),$A(bx.prototype,"disableManualCaptioner",[XA,YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"disableManualCaptioner"),bx.prototype),$A(bx.prototype,"assignManualCaption",[YA,XA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"assignManualCaption"),bx.prototype),$A(bx.prototype,"sendCaptionTextManually",[YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"sendCaptionTextManually"),bx.prototype),bx);const _x={epics0:e=>e.pipe(Ut(`${Bi}`),Ke((e=>{const{payload:{liveTranscription:t}}=e;return Um(t)}))),epics1:(e,t)=>pr(e,is).pipe(ht((e=>{var t,n;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.NewLttAvaliable)||void 0!==(null===(n=e.payload.body)||void 0===n?void 0:n.LiveTransEngineType)})),Ke((e=>{const{payload:{body:{NewLttAvaliable:n,LiveTransEngineType:r}}}=e,{liveTranscription:{isEnableAutomatedCaptions:i}}=t.value;return void 0!==n?(Id(ra,!!n),jm(i&&!!n)):Ym(r)}))),epics2:(e,t)=>pr(e,7982).pipe(Ye((e=>{const{payload:{body:{status:n,gwId:r}}}=e,i=[];switch(n){case tx.Ready:i.push(qm(r));break;case tx.ManualCaptionerEnabled:Id(na,{autoCaption:!1}),i.push(Hm(!0));break;case tx.ManualCaptionerDisabled:Id(na,{autoCaption:!0}),i.push(Ng({editorId:"",isEditor:!1,editorZoomId:""})),i.push(Hm(!1));break;case tx.UserSub:{Id(na,{autoCaption:t.value.liveTranscription.isLiveTranscriptionEnabled});const{liveTranscription:{stateBeforeFailover:e}}=t.value;if(null!=e&&e.isLiveTranscriptionSubscribed){var o;vx.enableNewLLT();const t=null!==(o=e.currentTranscriptionLang)&&void 0!==o?o:nx.Unspecified;px(t),i.push(Wm(t)),void 0!==e.currentTranslationLang&&vx.setTranslationLanguage(e.currentTranslationLang),i.push(Zm())}break}}return Me(i)}))),epics3:e=>pr(e,7984).pipe(Ke((e=>{const{payload:{body:{langs:t}}}=e;return Km(t)}))),epics4:e=>pr(e,8011).pipe(Ye((e=>{const{payload:{body:{disabled:t}}}=e,n=[];return Id(ia,t),n.push(tv(t)),t&&n.push($m(!1)),Me(n)}))),epics5:e=>pr(e,7985).pipe(ht((e=>{var t;return!0===(null===(t=e.payload.body)||void 0===t?void 0:t.success)})),Ye((e=>{const{payload:{body:{src:t,lang:n,success:r}}}=e,i=[];return r&&i.push($m(!0)),t===ox.ASR?(n===nx.NoTranslation?i.push(Gm(void 0)):i.push(Gm(n)),Id(na,{autoCaption:!0,lang:n})):[ox.InMeetingManual,ox.ExternalCaptioner].includes(t)&&Id(na,{autoCaption:!1}),Me(i)}))),epics6:(e,t)=>pr(e,7986).pipe(Tt(t),Ye((e=>{let[t,n]=e;const r=gh(n),{liveTranscription:{currentTranscriptionLang:i}}=n,{payload:{body:o}}=t,s=[];if(void 0!==(null==o?void 0:o.lang)){const{lang:e}=o;"computer"===(null==r?void 0:r.audio)&&i!==e&&px(e),s.push(Wm(e))}return Me(s)}))),epics7:(e,t)=>vr(e,Da.JoinComputerAudioComplete).pipe(ht((()=>t.value.liveTranscription.isLiveTranscriptionSubscribed)),At((()=>{const{liveTranscription:{currentTranscriptionLang:e}}=t.value;e&&px(e)})),St(ge)),epics8:(e,t)=>pr(e,7983).pipe(ht((e=>void 0!==e.payload.body)),Ye((e=>{const{payload:{body:{msgType:n,errorCode:r,language:i,source:o,content:s,keyNodeId:a,msgId:u,nodeId:c,pos:l,size:d,audioLanguage:h}}}=e;if(n===rx.Error){if(r===ix.TranslateNotSupport){const{liveTranscription:{currentTranslationLang:e}}=t.value;e&&Id(ta,{error:ix.TranslateNotSupport,errorMessage:`${ax[h]} to ${ax[e]} translation is not supported!`,audioLanguage:h,translationLang:e})}}else{const e=t.value,r=bh(e),{liveTranscription:{isManualCaptionerEnabled:h}}=e;if(h&&o===ox.ASR)return Promise.resolve();if(function(e,t){const{liveTranscription:{isEnableTranslatedCaptions:n,isLiveTranscriptionEnabled:r},meeting:{meetingOptions:i}}=t,{isEnableManualCaptions:o,isEnableAllowHostAssignTypeCC:s,isEnableClosedCaption:a,isEnableAllowThirdPartyCCToken:u}=i;return e===ox.ASR?n||r:e===ox.InMeetingManual?o&&s||void 0===o&&a:e===ox.ExternalCaptioner?u:void 0}(o,e)&&s&&a){const p=fx(e)[a];if(p)return es.beginDecrypt({decryptedText:s,type:Qo.CC_MESSAGE,zoomId:p}).then((e=>{let{message:s}=e;const{liveTranscription:{messageRecords:a}}=t.value,p=[],f=a.find((e=>e.msgId===u));if(f){const{text:e}=f,t=((e,t)=>{if(!e||0===t)return"";let n=0;for(let r=0;r<e.length;r++)if(n+=ui(e[r]),n===t)return e.slice(0,r+1);return e})(e,l);let r;n===rx.Insert&&0===d||n===rx.Delete&&0===d?r={...f,text:t+s,msgType:n}:n===rx.Close&&(r={...f,text:s,msgType:n,done:!0}),r&&(p.push(Jm(r)),Id(ta,r))}else if([rx.New,rx.Close].includes(n)||h&&n===rx.Insert){const e=r.find((e=>e.userId===c)),t={msgId:u,userId:c,displayName:null==e?void 0:e.displayName,avatar:null==e?void 0:e.avatar,text:s,source:o,language:i,timestamp:(new Date).getTime(),done:n===rx.Close};p.push(zm({...t,msgType:n})),Id(ta,t)}return p}))}}return Promise.resolve()})),Ye((e=>Array.isArray(e)?Me(e):ge))),epics9:(e,t)=>e.pipe(Ut(`${zm}`),ke(le),Ye((()=>{const{liveTranscription:{messageRecords:e}}=t.value;return e.length>=1e5?function(e){const{meeting:{meetingId:t},liveTranscription:{messageRecords:n,reducedRecordsCount:r}}=e;return void 0!==window.indexedDB?new Promise((e=>{const i=window.indexedDB.open(cx,1);i.addEventListener("upgradeneeded",(()=>{const e=i.result;if(!e.objectStoreNames.contains(lx)){const t=e.createObjectStore(lx,{keyPath:["startIndex","mid"],autoIncrement:!1});t.createIndex("mid","mid",{unique:!1}),t.transaction.oncomplete=()=>{console.log(`Create objectStore [${lx}] complete`)}}})),i.addEventListener("success",(()=>{const o=i.result,s=n.length,a=.9*s,u=s-a,c=n.slice(0,a),l=r+c.length,d=o.transaction([lx],"readwrite");d.objectStore(lx).put({startIndex:r,mid:t,records:c}),d.oncomplete=()=>{e(Qm({remains:u,reducedRecordsCount:l})),o.close()},d.onerror=()=>{e(""),o.close()}}))})):Promise.resolve("")}(t.value):Promise.resolve("")})),ht((e=>"object"==typeof e))),epics10:(e,t)=>e.pipe(Ut(`${Mi}`,`${Li}`),ht((()=>t.value.liveTranscription.isRecordsReduced)),At((()=>{!function(){if(void 0!==window.indexedDB){const e=window.indexedDB.open(cx,1);e.addEventListener("success",(()=>{const t=e.result;t.objectStoreNames.contains(lx)&&(window.indexedDB.deleteDatabase(cx),t.close())}))}}()})),St(ge)),epics11:(e,t)=>vr(e,[Da.AudiobridgeSetCcLangSuccess,Da.AudiobridgeSetCcLangFailure]).pipe(Ye((e=>{const{payload:{type:n,data:r}}=e,{liveTranscription:{currentTranscriptionLang:i}}=t.value,o=[];return n===Da.AudiobridgeSetCcLangSuccess&&r!==i?o.push(Wm(r)):n===Da.AudiobridgeSetCcLangFailure&&o.push(Wm(void 0)),Me(o)})))},Cx=hr(_x),Ax={isLiveStreamEnable:!1,status:0},Tx=Rn({[`${pv}`]:hE(((e,t)=>{let{payload:n}=t;e.isLiveStreamEnable=n})),[`${fv}`]:hE(((e,t)=>{let{payload:n}=t;e.status=n})),[`${gv}`]:(e,t)=>{let{payload:n}=t;return n?{...e}:{...Ax}}},Ax);let Rx=function(e){return e[e.Ended=0]="Ended",e[e.InProgress=1]="InProgress",e[e.Connecting=2]="Connecting",e[e.Timeout=3]="Timeout",e}({});var Ox;const Px=Ps.createAgent();let Dx=($A((Ox=class extends aT{startLiveStream(e,t,n){const{[GA]:r,[zA]:i}=this,{liveStream:{isLiveStreamEnable:o,status:s}}=r();return s===Rx.InProgress?Promise.reject({type:yl,reason:"Live stream is already on"}):o?e&&t&&n?(Px.startLiveStream(e,t,n),Cd({event:vd,operations:[ht((e=>e===Rx.InProgress)),gt(1)]},void 0,3e4).then((()=>"")).catch((()=>{const{liveStream:{status:e}}=r();return e===Rx.Connecting?(Id(vd,Rx.Timeout),i(fv(Rx.Timeout)),Promise.reject({type:Sl})):Promise.resolve("")}))):Promise.reject({type:Il,reason:"parameter cannot be empty"}):Promise.reject({type:yl,reason:"Live stream is not enabled"})}stopLiveStream(){const{[GA]:e,[zA]:t}=this,{liveStream:{status:n}}=e();return n===Rx.InProgress&&(Px.stopLiveStream(),Id(vd,Rx.Ended),t(fv(Rx.Ended))),Promise.resolve("")}isLiveStreamEnabled(){var e;const{[GA]:t}=this;return!(null===(e=t().liveStream)||void 0===e||!e.isLiveStreamEnable)}getLiveStreamStatus(){var e;const{[GA]:t}=this;return null===(e=t().liveStream)||void 0===e?void 0:e.status}}).prototype,"startLiveStream",[XA],Object.getOwnPropertyDescriptor(Ox.prototype,"startLiveStream"),Ox.prototype),$A(Ox.prototype,"stopLiveStream",[XA],Object.getOwnPropertyDescriptor(Ox.prototype,"stopLiveStream"),Ox.prototype),Ox);const kx=hr({epics0:e=>e.pipe(Ut(`${Bi}`),Ke((e=>{const{payload:{liveStreamInfo:t}}=e;return pv(!(null==t||!t.isEnabledLiveStream))}))),epics1:e=>pr(e,7970).pipe(Ke((e=>{const{payload:{body:{channelName:t,liveStreamOn:n,isApiCall:r,status:i,viewerUrl:o}}}=e;return Id(vd,i),fv(i)})))}),{setSummaryEnable:xx,setSmartSummaryStatus:Nx,resetSummary:Mx}=In("SET_SUMMARY_ENABLE","SET_SMART_SUMMARY_STATUS","RESET_SUMMARY"),{setMeetingQueryEnable:Fx,setMeetingQueryStatus:Lx}=In("SET_MEETING_QUERY_ENABLE","SET_MEETING_QUERY_STATUS");let Vx=function(e){return e.Default="",e.Start="Start",e.Paused="Paused",e.Stopped="Stopped",e}({}),Bx=function(e){return e[e.GW_IND_NONE=0]="GW_IND_NONE",e[e.GW_IND_START=1]="GW_IND_START",e[e.GW_IND_PAUSE=2]="GW_IND_PAUSE",e[e.GW_IND_STOP=3]="GW_IND_STOP",e}({}),jx=function(e){return e.Default="",e.Start="Start",e.Paused="Paused",e.Stopped="Stopped",e}({}),Ux=function(e){return e[e.GW_IND_NONE=0]="GW_IND_NONE",e[e.GW_IND_START=1]="GW_IND_START",e[e.GW_IND_PAUSE=2]="GW_IND_PAUSE",e[e.GW_IND_STOP=3]="GW_IND_STOP",e}({});const Hx={summaryStatus:Bx.GW_IND_STOP,summaryEnable:!1,meetingQueryStatus:Ux.GW_IND_STOP,meetingQueryEnable:!1},qx=Rn({[`${xx}`]:hE(((e,t)=>{let{payload:n}=t;e.summaryEnable=n})),[`${Nx}`]:hE(((e,t)=>{let{payload:n}=t;e.summaryStatus=n})),[`${Fx}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingQueryEnable=n})),[`${Lx}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingQueryStatus=n})),[`${Mx}`]:()=>({...Hx})},Hx);var Kx,$x,Wx,Gx,zx;const Jx=Ps.createAgent();let Qx=(Kx=eT("summary"),$x=eT("summary"),Wx=eT("summary"),Gx=eT("summary"),$A((zx=class extends aT{startSummary(){const e=this[GA](),{summary:{summaryEnable:t,summaryStatus:n}}=e;return t?n===Bx.GW_IND_START?Promise.resolve(""):(Jx.summaryMeeting(!0),Cd(pd,(e=>e.status===Vx.Start))):Promise.reject({type:yl,reason:"The account of the meeting disabled the smart summary"})}stopSummary(){const e=this[GA](),{summary:{summaryStatus:t}}=e;return t!==Bx.GW_IND_START?Promise.resolve("not start summary, do nothing"):(Jx.summaryMeeting(!1),Cd(pd,(e=>e.status===Vx.Stopped)))}getSummaryStatus(){const e=this[GA](),{summary:{summaryStatus:t}}=e;return t===Bx.GW_IND_START?Vx.Start:t===Bx.GW_IND_STOP?Vx.Stopped:Vx.Default}isSummaryEnabled(){const e=this[GA](),{summary:{summaryEnable:t}}=e;return t}startMeetingQuery(){const e=this[GA](),{summary:{meetingQueryEnable:t,meetingQueryStatus:n}}=e;return t?n===Ux.GW_IND_START?Promise.resolve(""):(Jx.startMeetingQuery(!0),Cd(fd,(e=>e.status===jx.Start))):Promise.reject({type:yl,reason:"The account of the meeting disabled the smart summary"})}stopMeetingQuery(){const e=this[GA](),{summary:{meetingQueryStatus:t}}=e;return t!==Ux.GW_IND_START?Promise.resolve("not start meeting query, do nothing"):(Jx.startMeetingQuery(!1),Cd(fd,(e=>e.status===jx.Stopped)))}getMeetingQueryStatus(){const e=this[GA](),{summary:{meetingQueryStatus:t}}=e;return t===Ux.GW_IND_START?jx.Start:t===Ux.GW_IND_STOP?jx.Stopped:jx.Default}isMeetingQueryEnabled(){const e=this[GA](),{summary:{meetingQueryEnable:t}}=e;return t}}).prototype,"startSummary",[XA,YA,Kx],Object.getOwnPropertyDescriptor(zx.prototype,"startSummary"),zx.prototype),$A(zx.prototype,"stopSummary",[XA,YA,$x],Object.getOwnPropertyDescriptor(zx.prototype,"stopSummary"),zx.prototype),$A(zx.prototype,"startMeetingQuery",[XA,YA,Wx],Object.getOwnPropertyDescriptor(zx.prototype,"startMeetingQuery"),zx.prototype),$A(zx.prototype,"stopMeetingQuery",[XA,YA,Gx],Object.getOwnPropertyDescriptor(zx.prototype,"stopMeetingQuery"),zx.prototype),zx);const Yx=hr({moduleEpics0:e=>pr(e,8007).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.supported)})),Ke((e=>{const{supported:t}=e.payload.body;return Id(pd,{supported:t}),xx(t)}))),moduleEpics1:(e,t)=>pr(e,8008).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.status)})),Tt(t),Ye((e=>{let[t,n]=e;const{status:r}=t.payload.body,{summary:{summaryStatus:i}}=n,o=[];if(r!==i)switch(r){case Bx.GW_IND_START:Id(pd,{status:Vx.Start});break;case Bx.GW_IND_PAUSE:Id(pd,{status:Vx.Paused});break;case Bx.GW_IND_STOP:Id(pd,{status:Vx.Stopped});break;default:Id(pd,{status:""})}return o.push(Nx(r)),Me(o)}))),moduleEpics2:(e,t)=>pr(e,8015).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.supported)})),Tt(t),Ke((e=>{let[t,n]=e;const{supported:r}=t.payload.body;Id(fd,{supported:r});const{meeting:{zlkJwtToken:i}}=n;if(i){const{auto_transcription:e}=mi(i);e&&(r?Ps.createAgent().startMeetingQuery(!0):console.warn("You account don't support auto transcription"))}return Fx(r)}))),moduleEpics3:(e,t)=>pr(e,8016).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.status)})),Tt(t),Ye((e=>{let[t,n]=e;const{status:r}=t.payload.body,{summary:{meetingQueryStatus:i}}=n,o=[];if(r!==i)switch(r){case Ux.GW_IND_START:Id(fd,{status:jx.Start});break;case Ux.GW_IND_PAUSE:Id(fd,{status:jx.Paused});break;case Ux.GW_IND_STOP:Id(fd,{status:jx.Stopped});break;default:Id(fd,{status:""})}return o.push(Lx(r)),Me(o)})))});var Zx;const Xx={chat:{epic:tR,reducer:QT,Client:XT},logger:{epic:sO,reducer:nO,Client:class extends aT{getLogs(e){return eO.getLogs(this[WA],e)}getStore(){return eO.doNotUseDirtyGetStore()}setLogOptions(e){e&&this[WA].dispatch(lv(e))}isAutoReportInAccountSettingEnabled(){const{meeting:{zlkJwtToken:e,enableAutoLog:t,collectionToggleEnable:n,zsk:r}}=this[WA].getState();return!!e||(r?t&&n:t)}reportMeetingProblem(e){var t;const{product:n,problem:r,timeOfOccurrence:i,description:o,ticket:s,isLogIncluded:a}=e,{meeting:{userId:u,confId:c,conId:l,svcUrl:d}}=this[WA].getState(),h=`'product':${n}\n'problem':${r}\n'timeOfOccurrence':${i}\n'description':${o}\n'ticketID':${s}\n'isLogIncluded':${a?"Logs included":""}\n'nodeId':${u}\n'confId':${c}\n'conId':${l}\n'svcUrl':${d}`,p=["REPORT_NOTIFICATION"];return null===(t=eO.makeLogger(p).logWithExtraProperties("",{IM_NOTIFICATION:`${h}\nTrackingId:${eO.trackingId}`}))||void 0===t?void 0:t.then((()=>{eO.reportToGlobalTracing(a?void 0:p,!0)}))}reportToGlobalTracing(e){return eO.reportToGlobalTracing(e)}reportRating(e,t){const{meeting:n,media:r,socket:i}=this[WA].getState();if(n){var o,s,a,u,c;const{zlkJwtToken:l,meetingStatus:d}=n,{assetsPath:h,enforceMultipleVideos:p,enforceVirtualBackground:f,disableRenderLimits:g}=r;eO.report(`rating:${e}, feedback:${t}, appKey:${l?null===(o=mi(l))||void 0===o?void 0:o.app_key:""}, CPU:${navigator.hardwareConcurrency}, GPU:${null!==(s=Uo.gpu)&&void 0!==s?s:""}, browser:${Uo.browser} ${Uo.browserVersion}, OS:${Uo.os} ${Uo.osVersion}, SharedArrayBuffer:${!!window.crossOriginIsolated}, assetPath:${h}, enforceMultipleVideos:${p},disableRenderLimits:${g} enforceVirtualBackground:${f}, ${d===Co.Joined?`session duration:${Math.floor((null!==(a=performance.now()-(null==n?void 0:n.pingRWCTimestamp))&&void 0!==a?a:0)/1e3)}, rwg:${null==i||null===(u=i.rwgServerList)||void 0===u||null===(c=u[i.retryCount])||void 0===c?void 0:c.rwg}, failover count:${null==n?void 0:n.failover.count}`:""}`,"User Rating","info"),Number(e)<=2&&this.reportToGlobalTracing()}return Promise.resolve()}}},recording:{epic:IO,reducer:cO,Client:EO},cmd:{epic:VO,reducer:xO,Client:MO},breakoutRoom:{epic:ex,reducer:VD,Client:Yk},liveTranscription:{epic:Cx,reducer:Sx,Client:Ix},liveStream:{epic:kx,reducer:Tx,Client:Dx},summary:{epic:Yx,reducer:qx,Client:Qx}},eN=Ps.createAgent();let tN=(Zx=class extends IT{constructor(e){super(e),this.mediaStream=void 0,this[JA]=Xx}getMediaStream(){return void 0===this.mediaStream&&(this.mediaStream=new FD(this[WA])),this.mediaStream}joinInstant(e,t,n,r,i,o){const{[GA]:s,[zA]:a}=this,{meeting:{lang:u,meetingStatus:c},socket:{zoomSocketStatus:l}}=s();return t?c!==Co.Joined&&l===Th.Closed?(a(ki({topic:e,password:i?encodeURIComponent(i):"",userName:n,zlk:t,lang:u,cv:r})),o&&a(co(o)),_d(Xs.JoinMeeting)):Promise.reject({type:yl,reason:"duplicated operation"}):Promise.reject({type:yl,reason:"invalid  signature"})}removeUser(e){const t=this[WA].getState(),{participants:{attendeesList:n}}=t,r=n.find((t=>t.userId===e));return r?(eN.expel(e),Cd(Hs,(t=>t.some((t=>t.userId===e))))):Promise.reject({type:Il,reason:"no matched user"})}},$A(Zx.prototype,"removeUser",[ZA,YA],Object.getOwnPropertyDescriptor(Zx.prototype,"removeUser"),Zx.prototype),Zx);class nN{constructor(e){this.instant=void 0,this.context=void 0,this.script=void 0,this.mic=void 0,this.instant=0,this.context=e,this.mic=null,this.script=e.createScriptProcessor(2048,1,1),this.script.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let n,r=0;for(n=0;n<t.length;++n)r+=t[n]*t[n];this.instant=Math.sqrt(r/t.length)}}connectToSource(e){console.log("InputMicDetector is listening");try{var t;this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),null===(t=this.script)||void 0===t||t.connect(this.context.destination)}catch(e){console.error(e)}}stop(){var e,t;console.log("Audio Previewer stopped"),null===(e=this.mic)||void 0===e||e.disconnect(),this.mic=null,null===(t=this.script)||void 0===t||t.disconnect(),this.script=null}getMicVolume(){return this.instant}}const rN="https://st1.zoom.us/web_client/4qu8baa/audio/ring.mp3";class iN{constructor(){this.sampleAudio=void 0,this.audioCtx=void 0,this.destinationNode=void 0,this.audioPlayer=void 0,this.analyzserInterval=void 0,this.analyserNode=void 0,this.analyserNodeBufferDataArray=void 0,this.analyserCallback=void 0,this.sourceNode=void 0,this.mAudioStream=void 0,this.mSourceNode=void 0,this.mediaRecorder=void 0,this.isRecording=void 0,this.recorderChunks=[],this.recorderObjUrl=void 0,this.recorderPlayer=void 0,this.maximumRecordingTimer=void 0,this.shouldPlayAfterRecording=!0,this.isRunning=!1}testSpeaker(e){var t;if("function"!=typeof AudioContext||"function"!=typeof MediaStreamAudioDestinationNode||!AudioContext.prototype.decodeAudioData)return void console.warn("Cannot test the speaker due to the browser capability");const{speakerId:n,sampleAudioUrl:r=rN,onAnalyseFrequency:i}=e||{};if(this.isRunning)return void console.warn("A tester is running,please stop it first");this.isRunning=!0,this.initAudioContext(),((null===(t=this.sampleAudio)||void 0===t?void 0:t.url)===r&&this.sampleAudio.data?Promise.resolve(this.sampleAudio.data):window.fetch(r).then((e=>e.arrayBuffer())).then((e=>this.audioCtx.decodeAudioData(e))).then((e=>(this.sampleAudio={url:r,data:e},e)))).then((e=>{var t,r,o;this.sourceNode=this.audioCtx.createBufferSource(),this.sourceNode.buffer=e,this.sourceNode.loop=!0,n&&null!==(t=this.audioPlayer)&&void 0!==t&&t.setSinkId&&this.audioPlayer.setSinkId(n),i?"function"==typeof AudioContext.prototype.createAnalyser?(this.analyzserInterval&&window.clearInterval(this.analyzserInterval),this.analyserCallback=i,this.initAnalyserNode(),this.analyserNode&&this.sourceNode.connect(this.analyserNode)):(this.sourceNode.connect(this.destinationNode),console.warn("Cannot analyze the stream due to the browser capability")):(this.analyserCallback=void 0,this.sourceNode.connect(this.destinationNode)),this.sourceNode.start(0),"running"!==(null===(r=this.audioCtx)||void 0===r?void 0:r.state)&&(null===(o=this.audioCtx)||void 0===o||o.resume()),this.audioPlayer&&(this.audioPlayer.muted=!1,this.audioPlayer.currentTime=0,this.audioPlayer.play())}));const o=()=>{this.isRunning=!1,this.audioPlayer&&(this.audioPlayer.currentTime=0,this.audioPlayer.pause()),this.analyserNode&&this.analyzserInterval&&(window.clearInterval(this.analyzserInterval),this.analyzserInterval=void 0,this.analyserNodeBufferDataArray=void 0),this.sourceNode&&(this.sourceNode.stop(0),this.sourceNode.disconnect(),this.sourceNode.buffer=null,this.sourceNode=void 0)};return{stop:o,destroy:()=>{var e;o(),this.analyserNode&&this.destinationNode&&(this.analyserNode.disconnect(this.destinationNode),this.analyserNode=void 0),null===(e=this.audioCtx)||void 0===e||e.close(),this.audioCtx=void 0}}}testMicrophone(e){var t;if("function"!=typeof AudioContext||"function"!=typeof MediaStreamAudioDestinationNode||"function"!=typeof AudioContext.prototype.createMediaStreamSource||"function"!=typeof(null===(t=navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia))return void console.warn("Cannot test the microphone due to the browser capability");const{microphoneId:n,speakerId:r,recordAndPlay:i,maxRecordDuration:o,onAnalyseFrequency:s,onStartRecording:a,onStopRecording:u,onStartPlayRecording:c,onStopPlayRecording:l}=e||{};if(this.isRunning)return void console.warn("A tester is running,please stop it first");this.isRunning=!0,this.initAudioContext();const d=()=>{i&&this.mediaRecorder&&this.isRecording&&(this.shouldPlayAfterRecording=!0,"inactive"!==this.mediaRecorder.state&&this.mediaRecorder.stop())};window.navigator.mediaDevices.getUserMedia({audio:!n||{deviceId:{exact:n}}}).then((e=>{var t,n,h,p;this.mAudioStream=e,this.mSourceNode=null===(t=this.audioCtx)||void 0===t?void 0:t.createMediaStreamSource(e),this.audioPlayer.muted=!0,s?(this.analyzserInterval&&window.clearInterval(this.analyzserInterval),this.analyserCallback=s,this.initAnalyserNode(),this.analyserNode&&(null===(h=this.mSourceNode)||void 0===h||h.connect(this.analyserNode))):this.analyserCallback=void 0,i&&("function"==typeof MediaRecorder?(this.recorderObjUrl&&window.URL.revokeObjectURL(this.recorderObjUrl),this.mediaRecorder=new MediaRecorder(this.mAudioStream),this.mediaRecorder.ondataavailable=e=>{e.data&&this.recorderChunks.push(e.data)},this.mediaRecorder.onstop=()=>{if(this.isRecording=!1,this.maximumRecordingTimer&&(window.clearTimeout(this.maximumRecordingTimer),this.maximumRecordingTimer=void 0),null==u||u(),this.recorderChunks.length>0){var e;const t=new Blob(this.recorderChunks,{type:(null===(e=this.recorderChunks[0])||void 0===e?void 0:e.type)||"audio/ogg; codecs=opus"});this.recorderObjUrl=window.URL.createObjectURL(t),this.shouldPlayAfterRecording&&this.playRecording(this.recorderObjUrl,r,c,l).catch((e=>{this.analyzserInterval&&(window.clearInterval(this.analyzserInterval),this.analyzserInterval=void 0,this.analyserNodeBufferDataArray=void 0),console.warn(e)})),this.recorderChunks=[],this.mediaRecorder&&(this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,this.mediaRecorder=void 0)}},this.mediaRecorder.start(),this.isRecording=!0,null==a||a(),this.maximumRecordingTimer=window.setTimeout((()=>{d()}),o||1e4)):console.warn("Cannot record the sound due to the browser capability")),"running"!==(null===(n=this.audioCtx)||void 0===n?void 0:n.state)&&(null===(p=this.audioCtx)||void 0===p||p.resume()),this.audioPlayer&&(this.audioPlayer.currentTime=0,this.audioPlayer.play())}));const h=()=>{this.isRunning=!1,this.maximumRecordingTimer&&(window.clearTimeout(this.maximumRecordingTimer),this.maximumRecordingTimer=void 0),this.audioPlayer&&(this.audioPlayer.currentTime=0,this.audioPlayer.pause()),this.analyserNode&&this.analyzserInterval&&(window.clearInterval(this.analyzserInterval),this.analyzserInterval=void 0,this.analyserNodeBufferDataArray=void 0),this.mSourceNode&&(s&&this.analyserNode&&this.mSourceNode.disconnect(this.analyserNode),this.mSourceNode=void 0),this.mAudioStream&&(this.mAudioStream.getAudioTracks().forEach((e=>{e.stop()})),this.mAudioStream=void 0),this.mediaRecorder&&(this.shouldPlayAfterRecording=!1,this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,"inactive"!==this.mediaRecorder.state&&this.mediaRecorder.stop(),this.isRecording=!1,this.mediaRecorder=void 0,this.recorderChunks=[]),this.recorderPlayer&&(this.recorderPlayer.currentTime=0,this.recorderPlayer.pause())};return{stop:h,stopRecording:d,destroy:()=>{var e;h(),this.analyserNode&&this.destinationNode&&(this.analyserNode.disconnect(this.destinationNode),this.analyserNode=void 0),null===(e=this.audioCtx)||void 0===e||e.close(),this.audioCtx=void 0}}}initAudioContext(){this.audioCtx&&this.audioPlayer||(this.audioCtx=new AudioContext,this.destinationNode=new MediaStreamAudioDestinationNode(this.audioCtx),this.audioPlayer=new Audio,this.audioPlayer.loop=!0,this.audioPlayer.srcObject=this.destinationNode.stream)}initAnalyserNode(){this.analyserNode||(this.analyserNode=this.audioCtx.createAnalyser(),this.analyserNode.connect(this.destinationNode),this.analyserNode.fftSize=1024);const e=this.analyserNode.frequencyBinCount;this.analyserNodeBufferDataArray=new Uint8Array(e),this.analyzserInterval=window.setInterval(this.audioAnalyserCallback.bind(this),20)}audioAnalyserCallback(){if(this.analyserNodeBufferDataArray&&this.analyserNode&&this.analyserCallback){this.analyserNode.getByteFrequencyData(this.analyserNodeBufferDataArray);let e=0;for(const t of this.analyserNodeBufferDataArray)e+=t;const t=e/this.analyserNodeBufferDataArray.length;this.analyserCallback(t)}}playRecording(e,t,n,r){this.recorderPlayer=new Audio,this.recorderPlayer.src=e,this.recorderPlayer.currentTime=0,this.recorderPlayer.setSinkId&&t&&this.recorderPlayer.setSinkId(t);const i=()=>{null==r||r(),this.recorderPlayer&&(this.recorderPlayer.onpause=null,this.recorderPlayer.onended=null,this.recorderPlayer=void 0,this.isRunning=!1)};return new Promise(((e,t)=>{this.recorderPlayer&&(this.recorderPlayer.onpause=()=>{e(!0)},this.recorderPlayer.onended=()=>{e(!0)},this.recorderPlayer.onerror=t,null==n||n(),this.recorderPlayer.play().catch(t))})).finally((()=>{window.URL.revokeObjectURL(e),i()}))}}const oN="AudioNotStartedError";class sN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.audioContext=void 0,this.inputMicDetector=void 0,this.isMicUnmuted=void 0,this.isAudioStarted=void 0,this.audioStream=void 0,this.deviceId=void 0,this.tester=void 0,this.audioContext=null,this.inputMicDetector=null,this.isMicUnmuted=!1,this.isAudioStarted=!1,this.audioStream=null,this.deviceId=e,this.tester=new iN}async start(){if(this.audioStream||this.isAudioStarted)throw new Error("AudioAlreadyStartedError");try{const e=await navigator.mediaDevices.getUserMedia(this.getAudioConstraints());this.audioStream=e,this.isAudioStarted=!0}catch(e){throw e}}async unmute(){if(!this.audioStream||!this.isAudioStarted)throw new Error(oN);if(this.isMicUnmuted)throw new Error("AudioAlreadyUnmutedError");return this.toggleMicIsMuted(!0)}async mute(){if(!this.audioStream||!this.isAudioStarted)throw new Error(oN);if(!this.isMicUnmuted)throw new Error("AudioAlreadyMutedError");return this.toggleMicIsMuted(!1)}getCurrentVolume(){return this.inputMicDetector?this.inputMicDetector.getMicVolume():0}async stop(){if(!this.audioStream||!this.isAudioStarted)throw new Error(oN);this.audioStream.getAudioTracks().forEach((e=>e.stop())),this.audioStream=null,this.isAudioStarted=!1}async toggleMicIsMuted(e){if(e){if(!this.audioContext){const e=window.AudioContext||window.webkitAudioContext;this.audioContext=new e}this.inputMicDetector=new nN(this.audioContext),this.inputMicDetector.connectToSource(this.audioStream)}else this.inputMicDetector&&this.inputMicDetector.stop(),this.inputMicDetector=null;this.isMicUnmuted=e}getAudioConstraints(){return{audio:""===this.deviceId||{deviceId:{exact:this.deviceId}},video:!1}}testSpeaker(e){return this.tester.testSpeaker(e)}testMicrophone(e){return this.tester.testMicrophone(e)}}const aN={width:{min:1024,ideal:1280,max:1920},height:{min:576,ideal:720,max:1080},aspectRatio:{ideal:1.777777778}};class uN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.isVideoStarted=void 0,this.videoStream=void 0,this.deviceId=void 0,this.localPreview=void 0,this.vbPreviewInProgress=void 0,this.videoParams=void 0,this.isVideoStarted=!1,this.videoStream=null,this.vbPreviewInProgress=!1,this.deviceId=e,this.localPreview=new OA}async start(e,t){if(!e)throw new Error("Video DOM element is falsy");if(this.isVideoStarted||this.videoStream)throw new Error("VideoAlreadyStartedError");this.videoParams={videoDOMElement:e,virtualBackground:t};const n=async t=>{if(!t||"OverconstrainedError"!==t.name&&"ConstraintNotSatisfiedError"!==t.name)throw t;console.log(`Warning: detected ${t.name} -- trying to fall back to lower aspect ratio`);try{const t=await navigator.mediaDevices.getUserMedia(this.getVideoConstraints(!0));return this.tryPlayVideo(e,t)}catch(e){throw e}};if(e instanceof HTMLVideoElement)try{const t=await navigator.mediaDevices.getUserMedia(this.getVideoConstraints());return this.tryPlayVideo(e,t)}catch(e){return n(e)}else{if(!(e instanceof HTMLCanvasElement))throw new Error("Cannot start video with virtual background");this.localPreview.setup().then((()=>this.localPreview.startPreview(e,{...t,deviceId:this.deviceId}))).then((()=>{this.vbPreviewInProgress=!0}))}}async stop(){if(this.vbPreviewInProgress)await this.localPreview.stopPreview(),this.vbPreviewInProgress=!1;else{if(!this.videoStream||!this.isVideoStarted)throw new Error("VideoNotStartedError");this.videoStream.getVideoTracks().forEach((e=>e.stop())),this.videoStream=null,this.isVideoStarted=!1}}async switchCamera(e){e!==this.deviceId&&(this.deviceId=e,await this.stop(),this.videoParams&&await this.start(this.videoParams.videoDOMElement,this.videoParams.virtualBackground))}async updateVirtualBackground(e,t){this.vbPreviewInProgress&&await this.localPreview.updatePreview(e,t)}getVideoConstraints(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=aN;return Xa.includes(this.deviceId)?{audio:!1,video:{facingMode:this.deviceId}}:(e?t=""===this.deviceId||{deviceId:{exact:this.deviceId}}:""!==this.deviceId&&(t.deviceId={exact:this.deviceId}),{audio:!1,video:t})}async tryPlayVideo(e,t){if(!e)throw new Error("Video DOM element is falsy");try{this.videoStream=t,e.srcObject=this.videoStream,await e.play(),this.isVideoStarted=!0}catch(e){throw e}}}class cN{static createClient(){if(!this.meetingClient){const e=function(){const e=function(e){void 0===e&&(e={});var t,n=new fe.constructor(fe.schedulerActionCtor),r=new z,i=function(i){t=i;var o=new z,s=new z,a=o.asObservable().pipe(ke(n)),u=new Bt(s.pipe(ke(n)),t.getState());return r.pipe(Ke((function(t){var n=t(a,u,e.dependencies);if(!n)throw new TypeError('Your root Epic "'+(t.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return n})),Ye((function(e){return Me(e).pipe(xe(n),ke(n))}))).subscribe(t.dispatch),function(e){return function(n){var r=e(n);return s.next(t.getState()),o.next(n),r}}};return i.run=function(e){r.next(e)},i}(),{epicSubject:t,rootEpic:n}=function(){const e=new Q(dr(ZE,Sw,Tw,UA));return{epicSubject:e,rootEpic:(t,n,r)=>e.pipe(Ye((e=>e(t,n,r))))}}(),r=[e],i=Ft(KA(),qA(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(kt(15))},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=t.map((function(e){return e(i)}));return r=Lt.apply(void 0,o)(n.dispatch),Dt(Dt({},n),{},{dispatch:r})}}}(...r)));return i.asyncReducers={},i.injectReducer=(e,t)=>{void 0===i.asyncReducers[e]&&(i.asyncReducers[e]=t,i.replaceReducer(KA(i.asyncReducers)))},i.injectEpic=e=>{t.next(e)},e.run(n),i}();this.meetingClient=new tN(e)}return this.meetingClient}static destroyClient(){this.meetingClient&&(this.meetingClient.leave().then((()=>{at(500).subscribe((()=>{Td()}))})),this.meetingClient=null)}static checkFeatureRequirements(){return function(){const e=[],t=[],{isAndroidOrIOSBrowser:n,browser:r,browserVersion:i,os:o,osVersion:s,isChrome:a,isFirefox:u,isSafari:c}=Uo;!n&&(a||u||c)&&Go()?e.push("Virtual Background"):t.push("Virtual Background"),(n||a)&&Go()?e.push("Share Chrome Tab Audio"):t.push("Share Chrome Tab Audio"),!n&&Go()?(e.push("Screen Share (send)"),e.push("720p Video (receive)"),e.push("Share 2nd Camera")):(t.push("Screen Share (send)"),t.push("720p Video (receive)"),t.push("Share 2nd Camera")),Go()?(e.push("Audio"),e.push("Video"),e.push("Screen Share (receive)"),e.push("Chat"),e.push("Closed Captioning"),e.push("Live Transcription"),e.push("Live Translation"),e.push("Cloud Recording"),e.push("Call Out (PSTN)"),e.push("Command Channel"),e.push("RTMP Live Streaming"),e.push("Encryption"),e.push("720p Video (send)"),e.push("Render Multiple Videos")):(t.push("Audio"),t.push("Video"),t.push("Screen Share (receive)"),t.push("Chat"),t.push("Closed Captioning"),t.push("Live Transcription"),t.push("Live Translation"),t.push("Cloud Recording"),t.push("Call Out (PSTN)"),t.push("Command Channel"),t.push("RTMP Live Streaming"),t.push("Encryption"),e.push("720p Video (send)"),e.push("Render Multiple Videos"));const l=n?`${o}${s}`:`${r}${i}`;return t.length>0&&console.log("Some features are not supported on your platform, please refer to https://developers.zoom.us/docs/video-sdk/web/browser-support/"),{platform:l,supportFeatures:e,unSupportFeatures:t}}()}static checkSystemRequirements(){return lT()}static getDevices(e){return e?navigator.mediaDevices.enumerateDevices():navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((e=>(e.getTracks().forEach((e=>e.stop())),navigator.mediaDevices.enumerateDevices()))).catch((e=>(console.warn(e),navigator.mediaDevices.enumerateDevices())))}static createLocalAudioTrack(){return new sN(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}static createLocalVideoTrack(){return new uN(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}static preloadDependentAssets(e){(async e=>{const t=e||Cv,n=`${t}/${wo}`,r=[],i=[],o=`${t}/`;if(Mv()){const{workers:e,wasms:t}=jv("audio","simd",o);r.push(...e),i.push(...t)}else{const{workers:e,wasms:t}=jv("audio","",o);r.push(...e),i.push(...t)}if(Mv()&&function(){const{browser:e,browserVersion:t,isAndroidBrowser:n}=Uo;return!n&&"chrome"===e.toLowerCase()&&ci(t,"100")>0&&window.crossOriginIsolated}()){const{workers:e,wasms:t}=jv(["video","sharing"],"videoShare",o);r.push(...e),i.push(...t)}else if(Mv()&&Nv()){const{workers:e,wasms:t}=jv(["video","sharing"],"simd,thread",o);r.push(...e),i.push(...t)}else if(Nv()){const{workers:e,wasms:t}=jv(["video","sharing"],"thread",o);r.push(...e),i.push(...t)}else if(Mv()){const{workers:e,wasms:t}=jv(["video","sharing"],"simd",o);r.push(...e),i.push(...t)}else{const{workers:e,wasms:t}=jv(["video","sharing"],"",o);r.push(...e),i.push(...t)}const s=[Bv(n,"script")];r.forEach((e=>{s.push(Bv(e,"fetch"))})),i.forEach((e=>{s.push(Bv(e,"fetch"))}));try{document.head.append(...s)}catch(e){}})(e)}}cN.meetingClient=void 0,cN.VERSION=Iv;var lN="1.11.10",dN="INVALID_PARAMETERS",hN="https://dmogdx0jrul3u.cloudfront.net/videosdk/".concat(lN,"/lib"),pN="https://source.zoom.us/videosdk/".concat(lN,"/lib"),fN="https://jssdk.zoomus.cn/videosdk/".concat(lN,"/lib"),gN=function(e){return"string"==typeof e&&e.length>0},mN=function(e){var t="";switch(e){case"Global":t=pN;break;case"CN":t=fN;break;case"CDN":t=hN;break;default:t=e}return t},vN=["userId","avatar","displayName","isHost","audio","muted","bVideoOn","sharerOn","sharerPause","userIdentity","isSpeakerOnly","bVideoShare","bShareAudioOn","userGuid","isPhoneUser","isInFailover",{from:"isCoHost",to:"isManager"},{from:"bAllowISORecord",to:"isAllowIndividualRecording"},{from:"bVideoConnect",to:"isVideoConnect"},{from:"bShareToBORooms",to:"bShareToSubsession"},{from:"bid",to:"subsessionId"},{from:"phoneNumber",to:function(e){return void 0===e?{}:{phoneNumber:e}}}],yN=[].concat(vN,[{from:"userGUID",to:"userGuid"},{from:"bCoHost",to:function(e){return{isManager:!!e}}},{from:"userType",to:function(e){return{isPhoneUser:!(5&~e)}}},{from:"bid",to:function(e){return e?{subsessionId:e}:{}}}]),SN=yN.map((function(e){return"string"==typeof e?e:e.from}));function bN(e,t){return"string"==typeof e?c({},"".concat(e),t):"string"==typeof e.to?c({},"".concat(e.to),t):e.to(t)}function EN(e){if(e)return vN.reduce((function(t,n){var r="string"==typeof n?n:n.from,o=bN(n,e[r]);return i(i({},t),o)}),{})}function wN(e){if(e)return Object.keys(e).reduce((function(t,n){var r=SN.indexOf(n);if(r>-1){var o=yN[r],s="string"==typeof o?o:o.from,a=bN(o,e[s]);return i(i({},t),a)}return t}),{})}var IN,_N,CN,AN,TN,RN,ON,PN,DN=Symbol("stream"),kN=function(){function e(t){s(this,e),this[DN]=void 0,this[DN]=t}return u(e,[{key:"startAudio",value:function(e){return this[DN].startAudio(e)}},{key:"stopAudio",value:function(){return this[DN].stopAudio()}},{key:"muteAudio",value:function(e){return this[DN].muteAudio(e)}},{key:"unmuteAudio",value:function(e){return this[DN].unmuteAudio(e)}},{key:"inviteByPhone",value:function(e,t,n,r){return this[DN].dialOut(e,t,n,r)}},{key:"cancelInviteByPhone",value:function(e,t,n){return this[DN].cancelDialOut(e,t,n)}},{key:"hangup",value:function(){return this[DN].hangup()}},{key:"getCurrentSessionCallinInfo",value:function(){return this[DN].getDialInInfo()}},{key:"muteShareAudio",value:function(e){return this[DN].muteShareAudio(e)}},{key:"unmuteShareAudio",value:function(e){return this[DN].unmuteShareAudio(e)}},{key:"subscribeAudioStatisticData",value:function(e){return this[DN].subscribeAudioStatisticData(e)}},{key:"unsubscribeAudioStatisticData",value:function(e){return this[DN].unsubscribeAudioStatisticData(e)}},{key:"muteUserAudioLocally",value:function(e){return this[DN].muteUserAudioLocally(e)}},{key:"unmuteUserAudioLocally",value:function(e){return this[DN].unmuteUserAudioLocally(e)}},{key:"adjustUserAudioVolumeLocally",value:function(e,t){return this[DN].adjustUserAudioVolumeLocally(e,t)}},{key:"enableBackgroundNoiseSuppression",value:function(e){return this[DN].enableBackgroundNoiseSuppression(e)}},{key:"enableSyncButtonsOnHeadset",value:function(e){return this[DN].enableSyncButtonsOnHeadset(e)}},{key:"muteAllUserAudioLocally",value:function(){return this[DN].muteAllUserAudioLocally()}},{key:"unmuteAllUserAudioLocally",value:function(){return this[DN].unmuteAllUserAudioLocally()}},{key:"enableOriginalSound",value:function(e){return this[DN].enableOriginalSound(e)}},{key:"callCRCDevice",value:function(e,t){return this[DN].callCRCDevice(e,t)}},{key:"cancelCallCRCDevice",value:function(e,t){return this[DN].cancelCallCRCDevice(e,t)}},{key:"startSecondaryAudio",value:function(e,t){return this[DN].startSecondaryAudio(e,t)}},{key:"stopSecondaryAudio",value:function(){return this[DN].stopSecondaryAudio()}},{key:"muteAllAudio",value:function(){return this[DN].muteAllAudio()}},{key:"unmuteAllAudio",value:function(){return this[DN].unmuteAllAudio()}},{key:"isAudioMuted",value:function(e){return this[DN].isAudioMuted(e)}},{key:"getMicList",value:function(){return this[DN].getMicList()}},{key:"getSpeakerList",value:function(){return this[DN].getSpeakerList()}},{key:"getActiveMicrophone",value:function(){return this[DN].getActiveMicrophone()}},{key:"getActiveSpeaker",value:function(){return this[DN].getActiveSpeaker()}},{key:"switchMicrophone",value:function(e){return this[DN].switchMicrophone(e)}},{key:"switchSpeaker",value:function(e){return this[DN].switchSpeaker(e)}},{key:"isSupportPhoneFeature",value:function(){return this[DN].isSupportCallOut()}},{key:"getSupportCountryInfo",value:function(){return this[DN].getDialOutCountries()}},{key:"getInviteByPhoneStatus",value:function(){return this[DN].getDialOutStatus()}},{key:"getShareAudioStatus",value:function(){return this[DN].getShareAudioStatus()}},{key:"isOthersShareAudioMutedLocally",value:function(e){return this[DN].isOthersShareAudioMutedLocally(e)}},{key:"getAudioStatisticData",value:function(){return this[DN].getAudioStatisticData()}},{key:"isUserAudioMutedLocally",value:function(e){return this[DN].isUserAudioMutedLocally(e)}},{key:"getUserVolumeLocally",value:function(e){return this[DN].getUserVolumeLocally(e)}},{key:"isSupportMicrophoneAndShareAudioSimultaneously",value:function(){return this[DN].isSupportMicrophoneAndShareAudioSimultaneously()}},{key:"startVideo",value:function(e){return this[DN].startVideo(e)}},{key:"stopVideo",value:function(){return this[DN].stopVideo()}},{key:"renderVideo",value:function(e,t,n,r,i,o,s,a){return this[DN].renderVideo(e,t,n,r,i,o,s,a)}},{key:"stopRenderVideo",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;return this[DN].stopRenderVideo(e,t,n,r,i,o)}},{key:"updateVideoCanvasDimension",value:function(e,t,n){return this[DN].updateVideoCanvasDimension(e,t,n)}},{key:"adjustRenderedVideoPosition",value:function(e,t,n,r,i,o,s){return this[DN].adjustRenderedVideoPosition(e,t,n,r,i,o,s)}},{key:"clearVideoCanvas",value:function(e,t){return this[DN].clearVideoCanvas(e,t)}},{key:"mirrorVideo",value:function(e){return this[DN].mirrorVideo(e)}},{key:"enableHardwareAcceleration",value:function(e){return this[DN].enableHardwareAcceleration(e)}},{key:"previewVirtualBackground",value:function(e,t,n,r){return this[DN].previewVirtualBackground(e,t,n,r)}},{key:"updateVirtualBackgroundImage",value:function(e,t){return this[DN].updateVirtualBackgroundImage(e,t)}},{key:"stopPreviewVirtualBackground",value:function(){return this[DN].stopPreviewVirtualBackground()}},{key:"previewVideoMask",value:function(e,t){return this[DN].previewVideoMask(e,t)}},{key:"updateVideoMask",value:function(e){return this[DN].updateVideoMask(e)}},{key:"stopPreviewVideoMask",value:function(){return this[DN].stopPreviewVideoMask()}},{key:"switchCamera",value:function(e){return this[DN].switchCamera(e)}},{key:"subscribeVideoStatisticData",value:function(e){return this[DN].subscribeVideoStatisticData(e)}},{key:"unsubscribeVideoStatisticData",value:function(e){return this[DN].unsubscribeVideoStatisticData(e)}},{key:"attachVideo",value:function(e,t,n){return this[DN].attachVideo(e,t,n)}},{key:"detachVideo",value:function(e,t){return this[DN].detachVideo(e,t)}},{key:"isCapturingVideo",value:function(){return this[DN].isCapturingVideo()}},{key:"isCameraTaken",value:function(){return this[DN].isCameraTaken()}},{key:"getActiveVideoId",value:function(){return this[DN].getActiveVideoId()}},{key:"getActiveCamera",value:function(){return this[DN].getActiveCamera()}},{key:"getCameraList",value:function(){return this[DN].getCameraList()}},{key:"isCaptureForbidden",value:function(){return this[DN].isCaptureForbidden()}},{key:"getVideoMaxQuality",value:function(){return this[DN].getVideoMaxQuality()}},{key:"getReceivedVideoDimension",value:function(){return this[DN].getReceivedVideoDimension()}},{key:"isSupportMultipleVideos",value:function(){return this[DN].isSupportMultipleVideos()}},{key:"isSupportHDVideo",value:function(){return this[DN].isSupportHDVideo()}},{key:"isSupportVirtualBackground",value:function(){return this[DN].isSupportVirtualBackground()}},{key:"getVirtualbackgroundStatus",value:function(){return this[DN].getVirtualbackgroundStatus()}},{key:"getVideoStatisticData",value:function(){return this[DN].getVideoStatisticData()}},{key:"isRenderSelfViewWithVideoElement",value:function(){return this[DN].isRenderSelfViewWithVideoElement()}},{key:"getCapturedVideoResolution",value:function(){return this[DN].getCapturedVideoResolution()}},{key:"getVideoMaskStatus",value:function(){return this[DN].getVideoMaskStatus()}},{key:"isVideoMirrored",value:function(){return this[DN].isVideoMirrored()}},{key:"startShareView",value:function(e,t){return this[DN].startShareView(e,t)}},{key:"stopShareView",value:function(){return this[DN].stopShareView()}},{key:"switchShareView",value:function(e){return this[DN].switchShareView(e)}},{key:"startShareScreen",value:function(e,t){return void 0!==(null==t?void 0:t.broadcastToSubsession)&&Object.assign(t||{},{broadcastToBreakoutRoom:null==t?void 0:t.broadcastToSubsession}),this[DN].startShareScreen(e,t)}},{key:"pauseShareScreen",value:function(){return this[DN].pauseShareScreen()}},{key:"resumeShareScreen",value:function(){return this[DN].resumeShareScreen()}},{key:"stopShareScreen",value:function(){return this[DN].stopShareScreen()}},{key:"lockShare",value:function(e){return this[DN].lockShare(e)}},{key:"updateSharingCanvasDimension",value:function(e,t){return this[DN].updateSharingCanvasDimension(e,t)}},{key:"switchSharingSecondaryCamera",value:function(e){return this[DN].switchSharingSecondaryCamera(e)}},{key:"setSharePrivilege",value:function(e){return this[DN].setSharePrivilege(e)}},{key:"shareToSubsession",value:function(){return this[DN].shareToBreakoutRoom()}},{key:"stopShareToSubsession",value:function(){return this[DN].stopShareToBreakoutRoom()}},{key:"enableOptimizeForSharedVideo",value:function(e){return this[DN].enableOptimizeForSharedVideo(e)}},{key:"updateSharedVideoQuality",value:function(e){return this[DN].updateSharedVideoQuality(e)}},{key:"subscribeShareStatisticData",value:function(e){return this[DN].subscribeShareStatisticData(e)}},{key:"unsubscribeShareStatisticData",value:function(e){return this[DN].unsubscribeShareStatisticData(e)}},{key:"isShareLocked",value:function(){return this[DN].isShareLocked()}},{key:"getSharePrivilege",value:function(){return this[DN].getSharePrivilege()}},{key:"getActiveShareUserId",value:function(){return this[DN].getActiveShareUserId()}},{key:"getShareStatus",value:function(){return this[DN].getShareStatus()}},{key:"getShareUserList",value:function(){return this[DN].getShareUserList().map((function(e){return EN(e)}))}},{key:"isStartShareScreenWithVideoElement",value:function(){return this[DN].isStartShareScreenWithVideoElement()}},{key:"isOptimizeForSharedVideoEnabled",value:function(){return this[DN].isOptimizeForSharedVideoEnabled()}},{key:"isSupportOptimizedForSharedVideo",value:function(){return this[DN].isSupportOptimizedForSharedVideo()}},{key:"getShareStatisticData",value:function(){return this[DN].getShareStatisticData()}},{key:"requestFarEndCameraControl",value:function(e){return this[DN].requestFarEndCameraControl(e)}},{key:"approveFarEndCameraControl",value:function(e){return this[DN].approveFarEndCameraControl(e)}},{key:"declineFarEndCameraControl",value:function(e){return this[DN].declineFarEndCameraControl(e)}},{key:"giveUpFarEndCameraControl",value:function(e){return this[DN].giveUpFarEndCameraControl(e)}},{key:"controlCamera",value:function(e){return this[DN].controlCamera(e)}},{key:"controlFarEndCamera",value:function(e){return this[DN].controlFarEndCamera(e)}},{key:"getFarEndCameraPTZCapability",value:function(e){return this[DN].getFarEndCameraPTZCapability(e)}},{key:"getCameraPTZCapability",value:function(e){return this[DN].getCameraPTZCapability(e)}},{key:"isBrowserSupportPTZ",value:function(){return this[DN].isBrowserSupportPTZ()}},{key:"getNetworkQuality",value:function(e){return this[DN].getNetworkQuality(e)}},{key:"requestRemoteControl",value:function(){return this[DN].requestRemoteControl()}},{key:"giveUpRemoteControl",value:function(){return this[DN].giveUpRemoteControl()}},{key:"startRemoteControl",value:function(e){return this[DN].startRemoteControl(e)}},{key:"grabRemotoControl",value:function(){return this[DN].grabRemotoControl()}},{key:"approveRemoteControl",value:function(e){return this[DN].approveRemoteControl(e)}},{key:"declineRemoteControl",value:function(e){return this[DN].declineRemoteControl(e)}},{key:"stopRemoteControl",value:function(){return this[DN].stopRemoteControl()}},{key:"launchRemoteControlApp",value:function(e){return this[DN].launchRemoteControlApp(e)}},{key:"isRemotelyControlApproved",value:function(){return this[DN].isRemotelyControlApproved()}},{key:"isControllingUserRemotely",value:function(){return this[DN].isControllingUserRemotely()}},{key:"isTargetShareSupportRemoteControl",value:function(e){return this[DN].isTargetShareSupportRemoteControl(e)}},{key:"getRemoteControlAppDownloadUrl",value:function(){return this[DN].getRemoteControlAppDownloadUrl()}},{key:"getRemotelyControllingUser",value:function(){return this[DN].getRemotelyControllingUser()}},{key:"isRemoteControlEnabled",value:function(){return this[DN].isRemoteControlEnabled()}}]),e}(),xN=["isCoHost"],NN=Symbol("chat"),MN=function(){function e(t){s(this,e),this[NN]=void 0,this[NN]=t}return u(e,[{key:"send",value:function(e,t){return this[NN].send(e,t)}},{key:"sendToAll",value:function(e){return this[NN].send(e,ps.All)}},{key:"sendFile",value:function(e,t){return this[NN].sendFile(e,t)}},{key:"downloadFile",value:function(e,t,n){return this[NN].downloadFile(e,t,n)}},{key:"setPrivilege",value:function(e){return this[NN].setPrivilege(e)}},{key:"getPrivilege",value:function(){return this[NN].getPrivilege()}},{key:"getReceivers",value:function(){return this[NN].getReceivers().map((function(e){return i({isManager:e.isCoHost},l(e,xN))}))}},{key:"getHistory",value:function(){return this[NN].getHistory()}},{key:"isFileTransferEnabled",value:function(){return this[NN].isFileTransferEnabled()}},{key:"getFileTransferSetting",value:function(){return this[NN].getFileTransferSetting()}}]),e}(),FN=Symbol("recording"),LN=function(){function e(t){s(this,e),this[FN]=void 0,this[FN]=t}return u(e,[{key:"canStartRecording",value:function(){return this[FN].isRecordingEnabled()}},{key:"startCloudRecording",value:function(){return this[FN].startRecording()}},{key:"pauseCloudRecording",value:function(){return this[FN].pauseRecording()}},{key:"resumeCloudRecording",value:function(){return this[FN].startRecording()}},{key:"stopCloudRecording",value:function(){return this[FN].stopRecording()}},{key:"getCloudRecordingStatus",value:function(){return this[FN].getRecordingStatus()}},{key:"acceptIndividualRecording",value:function(){return this[FN].accept()}},{key:"declineIndividualRecording",value:function(){return this[FN].decline()}}]),e}(),VN=Symbol("command"),BN=function(){function e(t){s(this,e),this[VN]=void 0,this[VN]=t}return u(e,[{key:"send",value:function(e,t){return this[VN].send(e,t)}}]),e}(),jN=["isInRoom"],UN=["isAutoJoinRoom","isRoomSelectionEnabled"],HN=Symbol("breakout-room"),qN=function(){function e(t){s(this,e),this[HN]=void 0,this[HN]=t}return u(e,[{key:"createSubsessions",value:function(e,t){return this[HN].createRooms(e,t).then((function(e){return e.map((function(e){return{subsessionId:e.roomId,subsessionName:e.name,userList:e.attendeeList}}))}))}},{key:"openSubsessions",value:function(e,t){var n=t?i(i({},t),{},{isAutoJoinRoom:t.isAutoJoinSubsession,isRoomSelectionEnabled:t.isSubsessionSelectionEnabled}):void 0,r=e.map((function(e){return{roomId:e.subsessionId,name:e.subsessionName,attendeeList:e.userList}}));return this[HN].openRooms(r,n)}},{key:"joinSubsession",value:function(e){return this[HN].joinRoom(e)}},{key:"leaveSubsession",value:function(){return this[HN].leaveRoom()}},{key:"askForHelp",value:function(){return this[HN].askForHelp()}},{key:"postponeHelping",value:function(e){return this[HN].postponeHelping(e)}},{key:"broadcast",value:function(e){return this[HN].broadcast(e)}},{key:"assignUserToSubsession",value:function(e,t){return this[HN].assignUserToRoom(e,t)}},{key:"moveUserToSubsession",value:function(e,t){return this[HN].moveUserToRoom(e,t)}},{key:"moveBackToMainSession",value:function(e){return this[HN].moveBackToMainSession(e)}},{key:"closeAllSubsessions",value:function(){return this[HN].closeRoom()}},{key:"startBroadcastVoice",value:function(){return this[HN].startBroadcastVoice()}},{key:"stopBroadcastVoice",value:function(){return this[HN].stopBroadcastVoice()}},{key:"getUnassignedUserList",value:function(){return this[HN].getUnassignedAttendeeList().map((function(e){return EN(e)}))}},{key:"getSubsessionList",value:function(){return this[HN].getRoomList().map((function(e){return{subsessionId:e.roomId,subsessionName:e.name,userList:e.attendeeList.map((function(e){var t=e;return i({isInSubsession:t.isInRoom},l(t,jN))}))}}))}},{key:"getUserStatus",value:function(){return this[HN].getAttendeeStatus()}},{key:"getSubsessionStatus",value:function(){return this[HN].getRoomStatus()}},{key:"getCurrentSubsession",value:function(){var e=this[HN].getCurrentRoom();return{userStatus:e.attendeeStatus,subsessionName:e.name,subsessionId:e.roomId}}},{key:"getSubsessionOptions",value:function(){var e=this[HN].getRoomOptions();return i({isAutoJoinSubsession:e.isAutoJoinRoom,isSubsessionSelectionEnabled:e.isRoomSelectionEnabled},l(e,UN))}}]),e}(),KN=Symbol("liveTranscription"),$N=function(){function e(t){s(this,e),this[KN]=void 0,this[KN]=t}return u(e,[{key:"startLiveTranscription",value:function(){return this[KN].startLiveTranscription()}},{key:"setSpeakingLanguage",value:function(e){return this[KN].setSpeakingLanguage(e)}},{key:"setTranslationLanguage",value:function(e){return this[KN].setTranslationLanguage(e)}},{key:"getLiveTranscriptionStatus",value:function(){return this[KN].getLiveTranscriptionStatus()}},{key:"getCurrentTranscriptionLanguage",value:function(){return this[KN].getCurrentTranscriptionLanguage()}},{key:"getCurrentTranslationLanguage",value:function(){return this[KN].getCurrentTranslationLanguage()}},{key:"getLatestTranscription",value:function(){return this[KN].getLatestTranscription()}},{key:"getLatestTranslation",value:function(){return this[KN].getLatestTranslation()}},{key:"getFullTranscriptionHistory",value:function(){return this[KN].getFullTranscriptionHistory()}},{key:"disableCaptions",value:function(e){return this[KN].disableCaptions(e)}}]),e}(),WN=Symbol("liveStream"),GN=function(){function e(t){s(this,e),this[WN]=void 0,this[WN]=t}return u(e,[{key:"startLiveStream",value:function(e,t,n){return this[WN].startLiveStream(e,t,n)}},{key:"stopLiveStream",value:function(){return this[WN].stopLiveStream()}},{key:"isLiveStreamEnabled",value:function(){return this[WN].isLiveStreamEnabled()}},{key:"getLiveStreamStatus",value:function(){return this[WN].getLiveStreamStatus()}}]),e}(),zN=Symbol("logger"),JN=function(){function e(t,n){if(s(this,e),this[zN]=void 0,this[zN]=t,n){var r=n.debugMode,i=n.trackingId;this[zN].setLogOptions({debugMode:r,trackingId:i})}}return u(e,[{key:"reportToGlobalTracing",value:function(e){return this[zN].reportToGlobalTracing(e)}},{key:"reportRating",value:function(e,t){return this[zN].reportRating(e,t)}}]),e}(),QN=["roomName"],YN=["roomId","roomName"],ZN=[{event:"connection-change",originalEvent:"connection-change",payloadTransform:function(e){var t=e.roomName,n=l(e,QN);return t?i(i({},n),{},{subsessionName:t}):e}},{event:"user-added",originalEvent:"user-added",payloadTransform:function(e){return e.map((function(e){return wN(e)}))}},{event:"user-updated",originalEvent:"user-updated",payloadTransform:function(e){return e.map((function(e){return wN(e)}))}},{event:"user-removed",originalEvent:"user-removed",payloadTransform:function(e){return e.map((function(e){return wN(e)}))}},{event:"subsession-invite-to-join",originalEvent:"invite-to-join",payloadTransform:function(e){return{subsessionId:e.roomId,subsessionName:e.name}}},{event:"subsession-countdown",originalEvent:"room-countdown"},{event:"subsession-time-up",originalEvent:"room-time-up"},{event:"closing-subsession-countdown",originalEvent:"closing-room-countdown"},{event:"subsession-broadcast-message",originalEvent:"broadcast-message"},{event:"subsession-broadcast-voice",originalEvent:"broadcast-voice"},{event:"subsession-ask-for-help",originalEvent:"ask-for-help",payloadTransform:function(e){return{userId:e.userId,userGuid:e.userGuid,displayName:e.displayName,subsessionId:e.roomId,subsessionName:e.roomName}}},{event:"subsession-ask-for-help-response",originalEvent:"ask-for-help-response"},{event:"subsession-invite-back-to-main-session",originalEvent:"invite-back-to-main-session"},{event:"subsession-state-change",originalEvent:"room-state-change"},{event:"host-ask-unmute-audio",originalEvent:"unmute-audio-consent"},{event:"subsession-user-update",originalEvent:"room-user-update",payloadTransform:function(e){return i({subsessionId:e.roomId,subsessionName:e.roomName},l(e,YN))}}],XN=Symbol("summary"),eM=function(){function e(t){s(this,e),this[XN]=void 0,this[XN]=t}return u(e,[{key:"startSummary",value:function(){return this[XN].startSummary()}},{key:"stopSummary",value:function(){return this[XN].stopSummary()}},{key:"isSummaryEnabled",value:function(){return this[XN].isSummaryEnabled()}},{key:"getSummaryStatus",value:function(){return this[XN].getSummaryStatus()}},{key:"startMeetingQuery",value:function(){return this[XN].startMeetingQuery()}},{key:"stopMeetingQuery",value:function(){return this[XN].stopMeetingQuery()}},{key:"isMeetingQueryEnabled",value:function(){return this[XN].isMeetingQueryEnabled()}},{key:"getMeetingQueryStatus",value:function(){return this[XN].getMeetingQueryStatus()}}]),e}(),tM=Symbol("Client"),nM=new WeakMap,rM=function(){function e(){s(this,e),this[tM]=void 0,this.stream=void 0,this.chat=void 0,this.command=void 0,this.recording=void 0,this.subsession=void 0,this.liveTranscription=void 0,this.logger=void 0,this.liveStream=void 0,this.aiClient=void 0,this[tM]=cN.createClient(),nM.set(this,new Map)}return u(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US",t=arguments.length>2?arguments[2]:void 0,n=mN(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Global");return!1===window.isSecureContext&&console.warn("The page is not in a secure context, to use audio, video, screen, a secure context must be enabled."),function(){var e="__ZOOM_VIDEO_SDK_DOM_STORAGE_TEST__";try{return localStorage.setItem(e,e),localStorage.removeItem(e),sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(e){return!1}}()||console.warn("localstorage or sessionstorage is not enabled, please enable to use the video sdk,"),this[tM].init("","",{language:e,dependentAssets:n,constraints:i(i({},cN.checkSystemRequirements()),{},{screen:"object"===("undefined"==typeof WebAssembly?"undefined":o(WebAssembly))&&"function"==typeof Worker}),additionalFeatures:["chat","cmd","recording","breakoutRoom","liveTranscription","logger","liveStream","summary"],webEndpoint:(null==t?void 0:t.webEndpoint)||"zoom.us",skipJsMedia:null==t?void 0:t.skipJsMedia,enforceMultipleVideos:null==t?void 0:t.enforceMultipleVideos,stayAwake:null==t?void 0:t.stayAwake,enforceVirtualBackground:null==t?void 0:t.enforceVirtualBackground,quicklyLeaveMeeting:null==t?void 0:t.leaveOnPageUnload,patchJsMedia:null==t?void 0:t.patchJsMedia,alternativeNameForVideoPlayer:null==t?void 0:t.alternativeNameForVideoPlayer})}},{key:"join",value:function(e,t,n,r,i){return gN(e)&&gN(t)&&gN(n)?e.length>200?Promise.reject({type:dN,reason:"The maximum length of topic is 200"}):n.length>200?Promise.reject({type:dN,reason:"The maximum length of username is 200"}):r&&("string"!=typeof r||r.length>10)?Promise.reject({type:dN,reason:"The maximum length of password is 10"}):this[tM].joinInstant(e,t,n,lN,r,i):Promise.reject({type:dN,reason:"Topic, token and userName must be string and required"})}},{key:"leave",value:function(){var e;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(null===(e=nM.get(this))||void 0===e||e.clear(),this[tM].end()):this[tM].leave()}},{key:"on",value:function(e,t){var n=ZN.find((function(t){return t.event===e}));if(n){var r=n.originalEvent,i=n.payloadTransform;if(i){var o=function(e){var n=i(e);t(n)};this[tM].on(r,o);var s=nM.get(this);if(s){s.has(e)||s.set(e,[]);var a=s.get(e);null==a||a.push({originalCb:t,newCb:o})}}else this[tM].on(r,t)}else this[tM].on(e,t)}},{key:"off",value:function(e,t){var n=ZN.find((function(t){return t.event===e}));if(n){var r=n.originalEvent;if(n.payloadTransform){var i=nM.get(this);if(i){var o=i.get(e),s=null==o?void 0:o.find((function(e){return e.originalCb===t}));if(s&&o){this[tM].off(r,s.newCb);var a=null==o?void 0:o.filter((function(e){return e.originalCb!==t}));i.set(e,a)}}}else this[tM].off(r,t)}else this[tM].off(e,t)}},{key:"getMediaStream",value:function(){return this.stream||(this.stream=new kN(this[tM].getMediaStream())),this.stream}},{key:"getChatClient",value:function(){return this.chat||(this.chat=new MN(this[tM].getFeatureModule("chat"))),this.chat}},{key:"getRecordingClient",value:function(){return this.recording||(this.recording=new LN(this[tM].getFeatureModule("recording"))),this.recording}},{key:"getCommandClient",value:function(){return this.command||(this.command=new BN(this[tM].getFeatureModule("cmd"))),this.command}},{key:"getSubsessionClient",value:function(){return this.subsession||(this.subsession=new qN(this[tM].getFeatureModule("breakoutRoom"))),this.subsession}},{key:"getLiveTranscriptionClient",value:function(){return this.liveTranscription||(this.liveTranscription=new $N(this[tM].getFeatureModule("liveTranscription"))),this.liveTranscription}},{key:"getLoggerClient",value:function(e){return this.logger||(this.logger=new JN(this[tM].getFeatureModule("logger"),e)),this.logger}},{key:"getLiveStreamClient",value:function(){return this.liveStream||(this.liveStream=new GN(this[tM].getFeatureModule("liveStream"))),this.liveStream}},{key:"getAIClient",value:function(){return this.aiClient||(this.aiClient=new eM(this[tM].getFeatureModule("summary"))),this.aiClient}},{key:"getSessionInfo",value:function(){var e=this[tM].getMeetingInfo();return{isInMeeting:e.isInMeeting||!1,password:e.password||"",topic:e.topic,userName:e.userName,userId:e.userId,sessionId:e.meetingId}}},{key:"getCurrentUserInfo",value:function(){return EN(this[tM].getCurrentUserInfo())}},{key:"getUser",value:function(e){return EN(this[tM].getParticipantsList().find((function(t){return t.userId===e})))}},{key:"getAllUser",value:function(){return this[tM].getParticipantsList().map((function(e){return EN(e)}))}},{key:"changeName",value:function(e,t){return this[tM].changeName(e,t)}},{key:"makeHost",value:function(e){return this[tM].makeHost(e)}},{key:"removeUser",value:function(e){return this[tM].removeUser(e)}},{key:"makeManager",value:function(e){return this[tM].makeCoHost(e)}},{key:"revokeManager",value:function(e){return this[tM].revokeCoHost(e)}},{key:"reclaimHost",value:function(){return this[tM].reclaimHost()}},{key:"isHost",value:function(){return this[tM].isHost()}},{key:"isOriginalHost",value:function(){return this[tM].isOriginHost()}},{key:"getSessionHost",value:function(){return EN(this[tM].getMeetingHost())}},{key:"isManager",value:function(){return this[tM].isCoHost()}}]),e}(),iM=function(){function e(){s(this,e)}return u(e,null,[{key:"createClient",value:function(){return this.videoClient||(this.videoClient=new rM),this.videoClient}},{key:"destroyClient",value:function(){this.videoClient&&(this.videoClient.leave(),this.videoClient=null)}},{key:"checkSystemRequirements",value:function(){return cN.checkSystemRequirements()}},{key:"checkFeatureRequirements",value:function(){return cN.checkFeatureRequirements()}},{key:"getDevices",value:function(e){return cN.getDevices(e)}},{key:"createLocalAudioTrack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return cN.createLocalAudioTrack(e)}},{key:"createLocalVideoTrack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return cN.createLocalVideoTrack(e)}},{key:"preloadDependentAssets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Global";cN.preloadDependentAssets(mN(e))}}]),e}();iM.videoClient=void 0,iM.VERSION=lN,t.ChatPrivilege=void 0,(IN=t.ChatPrivilege||(t.ChatPrivilege={}))[IN.All=1]="All",IN[IN.NoOne=4]="NoOne",IN[IN.EveryonePublicly=5]="EveryonePublicly",t.ChatMsgType=void 0,(_N=t.ChatMsgType||(t.ChatMsgType={}))[_N.All=0]="All",t.SubsessionAllocationPattern=void 0,(CN=t.SubsessionAllocationPattern||(t.SubsessionAllocationPattern={}))[CN.Automatically=th.Automatically]="Automatically",CN[CN.Manually=th.Manually]="Manually",t.SubsessionUserStatus=void 0,(AN=t.SubsessionUserStatus||(t.SubsessionUserStatus={}))[AN.Initial=ih.Initial]="Initial",AN[AN.Invited=ih.Invited]="Invited",AN[AN.Joining=ih.Joining]="Joining",AN[AN.InSubsession=ih.InRoom]="InSubsession",AN[AN.Leaving=ih.Leaving]="Leaving",AN[AN.MainSession=ih.MainSession]="MainSession",t.SubsessionStatus=void 0,(TN=t.SubsessionStatus||(t.SubsessionStatus={}))[TN.NotStarted=nh.NotStarted]="NotStarted",TN[TN.InProgress=nh.InProgress]="InProgress",TN[TN.Closing=nh.Closing]="Closing",TN[TN.Closed=nh.Closed]="Closed",t.ReconnectReason=void 0,(RN=t.ReconnectReason||(t.ReconnectReason={}))[RN.Failover=Eo.Failover]="Failover",RN[RN.JoinSubsession=Eo.JoinBreakoutRoom]="JoinSubsession",RN[RN.MoveToSubsession=Eo.MoveToBreakoutRoom]="MoveToSubsession",RN[RN.BackToMainSession=Eo.BackToMainSession]="BackToMainSession",t.SharePrivilege=void 0,(ON=t.SharePrivilege||(t.SharePrivilege={}))[ON.Unlocked=Ha.HostGrab]="Unlocked",ON[ON.Locked=Ha.OnlyHost]="Locked",ON[ON.MultipleShare=Ha.MultipleShare]="MultipleShare",t.RemoteControlAppStatus=void 0,(PN=t.RemoteControlAppStatus||(t.RemoteControlAppStatus={}))[PN.Unknown=bu.Unknown]="Unknown",PN[PN.Uninstalled=bu.Uninstalled]="Uninstalled",PN[PN.Installed=bu.Installed]="Installed",PN[PN.Unlaunched=Eu.Unlaunched]="Unlaunched",PN[PN.Launched=Eu.Launched]="Launched",t.ApprovedState=za,t.AskHostHelpResponse=ah,t.AudioChangeAction=La,t.CRCProtocol=Ru,t.CRCReturnCode=Ou,t.CameraControlCmd=fu,t.ChatFileDownloadStatus=As,t.ChatFileUploadStatus=Cs,t.ConnectionState=_o,t.DialoutState=Va,t.FarEndCameraControlDeclinedReason=gu,t.LeaveAudioSource=Fa,t.LiveStreamStatus=Rx,t.LiveTranscriptionLanguage=hx,t.LiveTranscriptionLanguageCode=dx,t.LiveTranscriptionMessageSource=ox,t.MobileVideoFacingMode=Za,t.MutedSource=Na,t.PassiveStopShareReason=Ja,t.RecordingStatus=ya,t.RemoteControlSessionStatus=wu,t.ShareStatus=qa,t.VideoActiveState=$a,t.VideoCapturingState=Ga,t.VideoQuality=Ka,t.default=iM,Object.defineProperty(t,"__esModule",{value:!0})}(t)},355:(e,t)=>{var n,r,i,o,s,a,u,c,l,d,h,p={userAgent:!1},f={},g=g||(n=Math,i=(r={}).lib={},o=i.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[r+o>>>2]|=s<<24-(r+o)%4*8}else for(o=0;o<i;o+=4)t[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=n.ceil(t/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(4294967296*n.random()|0);return new s.init(t,e)}}),a=r.enc={},u=a.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},c=a.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var o=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},d=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,r=t.words,i=t.sigBytes,o=this.blockSize,a=i/(4*o),u=(a=e?n.ceil(a):n.max((0|a)-this._minBufferSize,0))*o,c=n.min(4*u,i);if(u){for(var l=0;l<u;l+=o)this._doProcessBlock(r,l);var d=r.splice(0,u);t.sigBytes-=c}return new s.init(d,c)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),i.Hasher=d.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}}),h=r.algo={},r);!function(e){var t,n=(t=g).lib,r=n.Base,i=n.WordArray;(t=t.x64={}).Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var o=e[r];n.push(o.high),n.push(o.low)}return i.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;i<n;i++)t[i]=t[i].clone();return e}})}(),g.lib.Cipher||function(e){var t=(p=g).lib,n=t.Base,r=t.WordArray,i=t.BufferedBlockAlgorithm,o=p.enc.Base64,s=p.algo.EvpKDF,a=t.Cipher=i.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?f:h).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?f:h).decrypt(e,t,n,r)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=p.mode={},c=function(e,t,n){var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=r[i]},l=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;c.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),l.Decryptor=l.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=e.slice(t,t+r);n.decryptBlock(e,t),c.call(this,e,t,r),this._prevBlock=i}}),u=u.CBC=l,l=(p.pad={}).Pkcs7={pad:function(e,t){for(var n,i=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,o=[],s=0;s<n;s+=4)o.push(i);n=r.create(o,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:u,padding:l}),reset:function(){a.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var d=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),h=(u=(p.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?r.create([1398893684,1701076831]).concat(e).concat(t):t).toString(o)},parse:function(e){var t=(e=o.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=r.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return d.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r);return t=i.finalize(t),i=i.cfg,d.create({ciphertext:t,key:n,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),p=(p.kdf={}).OpenSSL={execute:function(e,t,n,i){return i||(i=r.random(8)),e=s.create({keySize:t+n}).compute(e,i),n=r.create(e.words.slice(t),4*n),e.sigBytes=4*t,d.create({key:e,iv:n,salt:i})}},f=t.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:p}),encrypt:function(e,t,n,r){return n=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,(e=h.encrypt.call(this,e,t,n.key,r)).mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,h.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=g,t=e.lib.BlockCipher,n=e.algo,r=[],i=[],o=[],s=[],a=[],u=[],c=[],l=[],d=[],h=[],p=[],f=0;256>f;f++)p[f]=128>f?f<<1:f<<1^283;var m=0,v=0;for(f=0;256>f;f++){var y=(y=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&y^99;r[m]=y,i[y]=m;var S=p[m],b=p[S],E=p[b],w=257*p[y]^16843008*y;o[m]=w<<24|w>>>8,s[m]=w<<16|w>>>16,a[m]=w<<8|w>>>24,u[m]=w,w=16843009*E^65537*b^257*S^16843008*m,c[y]=w<<24|w>>>8,l[y]=w<<16|w>>>16,d[y]=w<<8|w>>>24,h[y]=w,m?(m=S^p[p[p[E^S]]],v^=p[p[v]]):m=v=1}var I=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),i=this._keySchedule=[],o=0;o<n;o++)if(o<t)i[o]=e[o];else{var s=i[o-1];o%t?6<t&&4==o%t&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=I[o/t|0]<<24),i[o]=i[o-t]^s}for(e=this._invKeySchedule=[],t=0;t<n;t++)o=n-t,s=t%4?i[o]:i[o-4],e[t]=4>t||4>=o?s:c[r[s>>>24]]^l[r[s>>>16&255]]^d[r[s>>>8&255]]^h[r[255&s]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,s,a,u,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,c,l,d,h,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,o,s,a){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],h=e[t+3]^n[3],p=4,f=1;f<u;f++){var g=r[c>>>24]^i[l>>>16&255]^o[d>>>8&255]^s[255&h]^n[p++],m=r[l>>>24]^i[d>>>16&255]^o[h>>>8&255]^s[255&c]^n[p++],v=r[d>>>24]^i[h>>>16&255]^o[c>>>8&255]^s[255&l]^n[p++];h=r[h>>>24]^i[c>>>16&255]^o[l>>>8&255]^s[255&d]^n[p++],c=g,l=m,d=v}g=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[d>>>8&255]<<8|a[255&h])^n[p++],m=(a[l>>>24]<<24|a[d>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[p++],v=(a[d>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[p++],h=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&d])^n[p++],e[t]=g,e[t+1]=m,e[t+2]=v,e[t+3]=h},keySize:8}),e.AES=t._createHelper(n)}(),function(){function e(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function t(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}var n=g,r=(i=n.lib).WordArray,i=i.BlockCipher,o=n.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=o.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;56>n;n++){var r=s[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(e=this._subKeys=[],r=0;16>r;r++){var i=e[r]=[],o=u[r];for(n=0;24>n;n++)i[n/6|0]|=t[(a[n]-1+o)%28]<<31-n%6,i[4+(n/6|0)]|=t[28+(a[n+24]-1+o)%28]<<31-n%6;for(i[0]=i[0]<<1|i[0]>>>31,n=1;7>n;n++)i[n]>>>=4*(n-1)+3;i[7]=i[7]<<5|i[7]>>>27}for(t=this._invSubKeys=[],n=0;16>n;n++)t[n]=e[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(n,r,i){this._lBlock=n[r],this._rBlock=n[r+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var o=0;16>o;o++){for(var s=i[o],a=this._lBlock,u=this._rBlock,d=0,h=0;8>h;h++)d|=c[h][((u^s[h])&l[h])>>>0];this._lBlock=u,this._rBlock=a^d}i=this._lBlock,this._lBlock=this._rBlock,this._rBlock=i,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),n[r]=this._lBlock,n[r+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});n.DES=i._createHelper(d),o=o.TripleDES=i.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(r.create(e.slice(0,2))),this._des2=d.createEncryptor(r.create(e.slice(2,4))),this._des3=d.createEncryptor(r.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2}),n.TripleDES=i._createHelper(o)}(),function(){var e=g,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var i=0;i<n;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;4>s&&i+.75*s<n;s++)e.push(r.charAt(o>>>6*(3-s)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map;(i=r.charAt(64))&&-1!=(i=e.indexOf(i))&&(n=i);for(var i=[],o=0,s=0;s<n;s++)if(s%4){var a=r.indexOf(e.charAt(s-1))<<s%4*2,u=r.indexOf(e.charAt(s))>>>6-s%4*2;i[o>>>2]|=(a|u)<<24-o%4*8,o++}return t.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,r,i,o,s){return((e=e+(t&n|~t&r)+i+s)<<o|e>>>32-o)+t}function n(e,t,n,r,i,o,s){return((e=e+(t&r|n&~r)+i+s)<<o|e>>>32-o)+t}function r(e,t,n,r,i,o,s){return((e=e+(t^n^r)+i+s)<<o|e>>>32-o)+t}function i(e,t,n,r,i,o,s){return((e=e+(n^(t|~r))+i+s)<<o|e>>>32-o)+t}for(var o=g,s=(u=o.lib).WordArray,a=u.Hasher,u=o.algo,c=[],l=0;64>l;l++)c[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,o){for(var s=0;16>s;s++){var a=e[u=o+s];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}s=this._hash.words;var u=e[o+0],l=(a=e[o+1],e[o+2]),d=e[o+3],h=e[o+4],p=e[o+5],f=e[o+6],g=e[o+7],m=e[o+8],v=e[o+9],y=e[o+10],S=e[o+11],b=e[o+12],E=e[o+13],w=e[o+14],I=e[o+15],_=t(_=s[0],T=s[1],A=s[2],C=s[3],u,7,c[0]),C=t(C,_,T,A,a,12,c[1]),A=t(A,C,_,T,l,17,c[2]),T=t(T,A,C,_,d,22,c[3]);_=t(_,T,A,C,h,7,c[4]),C=t(C,_,T,A,p,12,c[5]),A=t(A,C,_,T,f,17,c[6]),T=t(T,A,C,_,g,22,c[7]),_=t(_,T,A,C,m,7,c[8]),C=t(C,_,T,A,v,12,c[9]),A=t(A,C,_,T,y,17,c[10]),T=t(T,A,C,_,S,22,c[11]),_=t(_,T,A,C,b,7,c[12]),C=t(C,_,T,A,E,12,c[13]),A=t(A,C,_,T,w,17,c[14]),_=n(_,T=t(T,A,C,_,I,22,c[15]),A,C,a,5,c[16]),C=n(C,_,T,A,f,9,c[17]),A=n(A,C,_,T,S,14,c[18]),T=n(T,A,C,_,u,20,c[19]),_=n(_,T,A,C,p,5,c[20]),C=n(C,_,T,A,y,9,c[21]),A=n(A,C,_,T,I,14,c[22]),T=n(T,A,C,_,h,20,c[23]),_=n(_,T,A,C,v,5,c[24]),C=n(C,_,T,A,w,9,c[25]),A=n(A,C,_,T,d,14,c[26]),T=n(T,A,C,_,m,20,c[27]),_=n(_,T,A,C,E,5,c[28]),C=n(C,_,T,A,l,9,c[29]),A=n(A,C,_,T,g,14,c[30]),_=r(_,T=n(T,A,C,_,b,20,c[31]),A,C,p,4,c[32]),C=r(C,_,T,A,m,11,c[33]),A=r(A,C,_,T,S,16,c[34]),T=r(T,A,C,_,w,23,c[35]),_=r(_,T,A,C,a,4,c[36]),C=r(C,_,T,A,h,11,c[37]),A=r(A,C,_,T,g,16,c[38]),T=r(T,A,C,_,y,23,c[39]),_=r(_,T,A,C,E,4,c[40]),C=r(C,_,T,A,u,11,c[41]),A=r(A,C,_,T,d,16,c[42]),T=r(T,A,C,_,f,23,c[43]),_=r(_,T,A,C,v,4,c[44]),C=r(C,_,T,A,b,11,c[45]),A=r(A,C,_,T,I,16,c[46]),_=i(_,T=r(T,A,C,_,l,23,c[47]),A,C,u,6,c[48]),C=i(C,_,T,A,g,10,c[49]),A=i(A,C,_,T,w,15,c[50]),T=i(T,A,C,_,p,21,c[51]),_=i(_,T,A,C,b,6,c[52]),C=i(C,_,T,A,d,10,c[53]),A=i(A,C,_,T,y,15,c[54]),T=i(T,A,C,_,a,21,c[55]),_=i(_,T,A,C,m,6,c[56]),C=i(C,_,T,A,I,10,c[57]),A=i(A,C,_,T,f,15,c[58]),T=i(T,A,C,_,E,21,c[59]),_=i(_,T,A,C,h,6,c[60]),C=i(C,_,T,A,S,10,c[61]),A=i(A,C,_,T,l,15,c[62]),T=i(T,A,C,_,v,21,c[63]),s[0]=s[0]+_|0,s[1]=s[1]+T|0,s[2]=s[2]+A|0,s[3]=s[3]+C|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var o=e.floor(r/4294967296);for(n[15+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,r=0;4>r;r++)i=n[r],n[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=a._createHelper(u),o.HmacMD5=a._createHmacHelper(u)}(Math),function(){var e=g,t=(i=e.lib).WordArray,n=i.Hasher,r=[],i=e.algo.SHA1=n.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],s=n[2],a=n[3],u=n[4],c=0;80>c;c++){if(16>c)r[c]=0|e[t+c];else{var l=r[c-3]^r[c-8]^r[c-14]^r[c-16];r[c]=l<<1|l>>>31}l=(i<<5|i>>>27)+u+r[c],l=20>c?l+(1518500249+(o&s|~o&a)):40>c?l+(1859775393+(o^s^a)):60>c?l+((o&s|o&a|s&a)-1894007588):l+((o^s^a)-899497514),u=a,a=s,s=o<<30|o>>>2,o=i,i=l}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=n._createHelper(i),e.HmacSHA1=n._createHmacHelper(i)}(),function(e){for(var t=g,n=(i=t.lib).WordArray,r=i.Hasher,i=t.algo,o=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var d=e.sqrt(l),h=2;h<=d;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(8>c&&(o[c]=a(e.pow(u,.5))),s[c]=a(e.pow(u,1/3)),c++),u++}var p=[];i=i.SHA256=r.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],c=n[5],l=n[6],d=n[7],h=0;64>h;h++){if(16>h)p[h]=0|e[t+h];else{var f=p[h-15],g=p[h-2];p[h]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+p[h-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+p[h-16]}f=d+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+s[h]+p[h],g=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&o^i&o),d=l,l=c,c=u,u=a+f|0,a=o,o=i,i=r,r=f+g|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA256=r._createHelper(i),t.HmacSHA256=r._createHmacHelper(i)}(Math),function(){var e=g,t=e.lib.WordArray,n=(r=e.algo).SHA256,r=r.SHA224=n.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=n._createHelper(r),e.HmacSHA224=n._createHmacHelper(r)}(),function(){function e(){return r.create.apply(r,arguments)}for(var t=g,n=t.lib.Hasher,r=(o=t.x64).Word,i=o.WordArray,o=t.algo,s=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],a=[],u=0;80>u;u++)a[u]=e();o=o.SHA512=n.extend({_doReset:function(){this._hash=new i.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=(d=this._hash.words)[0],r=d[1],i=d[2],o=d[3],u=d[4],c=d[5],l=d[6],d=d[7],h=n.high,p=n.low,f=r.high,g=r.low,m=i.high,v=i.low,y=o.high,S=o.low,b=u.high,E=u.low,w=c.high,I=c.low,_=l.high,C=l.low,A=d.high,T=d.low,R=h,O=p,P=f,D=g,k=m,x=v,N=y,M=S,F=b,L=E,V=w,B=I,j=_,U=C,H=A,q=T,K=0;80>K;K++){var $=a[K];if(16>K)var W=$.high=0|e[t+2*K],G=$.low=0|e[t+2*K+1];else{W=((G=(W=a[K-15]).high)>>>1|(z=W.low)<<31)^(G>>>8|z<<24)^G>>>7;var z=(z>>>1|G<<31)^(z>>>8|G<<24)^(z>>>7|G<<25),J=((G=(J=a[K-2]).high)>>>19|(Q=J.low)<<13)^(G<<3|Q>>>29)^G>>>6,Q=(Q>>>19|G<<13)^(Q<<3|G>>>29)^(Q>>>6|G<<26),Y=(G=a[K-7]).high,Z=(X=a[K-16]).high,X=X.low;W=(W=(W=W+Y+((G=z+G.low)>>>0<z>>>0?1:0))+J+((G+=Q)>>>0<Q>>>0?1:0))+Z+((G+=X)>>>0<X>>>0?1:0),$.high=W,$.low=G}Y=F&V^~F&j,X=L&B^~L&U,$=R&P^R&k^P&k;var ee=O&D^O&x^D&x,te=(z=(R>>>28|O<<4)^(R<<30|O>>>2)^(R<<25|O>>>7),J=(O>>>28|R<<4)^(O<<30|R>>>2)^(O<<25|R>>>7),(Q=s[K]).high),ne=Q.low;Z=H+((F>>>14|L<<18)^(F>>>18|L<<14)^(F<<23|L>>>9))+((Q=q+((L>>>14|F<<18)^(L>>>18|F<<14)^(L<<23|F>>>9)))>>>0<q>>>0?1:0),H=j,q=U,j=V,U=B,V=F,B=L,F=N+(Z=(Z=(Z=Z+Y+((Q+=X)>>>0<X>>>0?1:0))+te+((Q+=ne)>>>0<ne>>>0?1:0))+W+((Q+=G)>>>0<G>>>0?1:0))+((L=M+Q|0)>>>0<M>>>0?1:0)|0,N=k,M=x,k=P,x=D,P=R,D=O,R=Z+($=z+$+((G=J+ee)>>>0<J>>>0?1:0))+((O=Q+G|0)>>>0<Q>>>0?1:0)|0}p=n.low=p+O,n.high=h+R+(p>>>0<O>>>0?1:0),g=r.low=g+D,r.high=f+P+(g>>>0<D>>>0?1:0),v=i.low=v+x,i.high=m+k+(v>>>0<x>>>0?1:0),S=o.low=S+M,o.high=y+N+(S>>>0<M>>>0?1:0),E=u.low=E+L,u.high=b+F+(E>>>0<L>>>0?1:0),I=c.low=I+B,c.high=w+V+(I>>>0<B>>>0?1:0),C=l.low=C+U,l.high=_+j+(C>>>0<U>>>0?1:0),T=d.low=T+q,d.high=A+H+(T>>>0<q>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=n._createHelper(o),t.HmacSHA512=n._createHmacHelper(o)}(),function(){var e=g,t=(i=e.x64).Word,n=i.WordArray,r=(i=e.algo).SHA512,i=i.SHA384=r.extend({_doReset:function(){this._hash=new n.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var e=r._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=r._createHelper(i),e.HmacSHA384=r._createHmacHelper(i)}(),function(){var e=g,t=(r=e.lib).WordArray,n=r.Hasher,r=e.algo,i=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),s=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=t.create([0,1518500249,1859775393,2400959708,2840853838]),c=t.create([1352829926,1548603684,1836072691,2053994217,0]);r=r.RIPEMD160=n.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;16>n;n++){var r=e[E=t+n];e[E]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var l,d,h,p,f,g,m,v,y,S,b,E=this._hash.words,w=(r=u.words,c.words),I=i.words,_=o.words,C=s.words,A=a.words;for(g=l=E[0],m=d=E[1],v=h=E[2],y=p=E[3],S=f=E[4],n=0;80>n;n+=1)b=l+e[t+I[n]]|0,b=16>n?b+((d^h^p)+r[0]):32>n?b+((d&h|~d&p)+r[1]):48>n?b+(((d|~h)^p)+r[2]):64>n?b+((d&p|h&~p)+r[3]):b+((d^(h|~p))+r[4]),b=(b=(b|=0)<<C[n]|b>>>32-C[n])+f|0,l=f,f=p,p=h<<10|h>>>22,h=d,d=b,b=g+e[t+_[n]]|0,b=16>n?b+((m^(v|~y))+w[0]):32>n?b+((m&y|v&~y)+w[1]):48>n?b+(((m|~v)^y)+w[2]):64>n?b+((m&v|~m&y)+w[3]):b+((m^v^y)+w[4]),b=(b=(b|=0)<<A[n]|b>>>32-A[n])+S|0,g=S,S=y,y=v<<10|v>>>22,v=m,m=b;b=E[1]+h+y|0,E[1]=E[2]+p+S|0,E[2]=E[3]+f+g|0,E[3]=E[4]+l+m|0,E[4]=E[0]+d+v|0,E[0]=b},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;for(t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process(),t=(e=this._hash).words,n=0;5>n;n++)r=t[n],t[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return e},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),e.RIPEMD160=n._createHelper(r),e.HmacRIPEMD160=n._createHmacHelper(r)}(Math),function(){var e=g,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,i=4*r;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),s=this._iKey=n.clone(),a=o.words,u=s.words,c=0;c<r;c++)a[c]^=1549556828,u[c]^=909522486;o.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e,t=g,n=(e=t.lib).Base,r=e.WordArray,i=(e=t.algo).HMAC,o=e.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:e.SHA1,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){var n=this.cfg,o=i.create(n.hasher,e),s=r.create(),a=r.create([1]),u=s.words,c=a.words,l=n.keySize;for(n=n.iterations;u.length<l;){var d=o.update(t).finalize(a);o.reset();for(var h=d.words,p=h.length,f=d,g=1;g<n;g++){f=o.finalize(f),o.reset();for(var m=f.words,v=0;v<p;v++)h[v]^=m[v]}s.concat(d),c[0]++}return s.sigBytes=4*l,s}});t.PBKDF2=function(e,t,n){return o.create(n).compute(e,t)}}();var m,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y="=";function S(e){var t,n,r="";for(t=0;t+3<=e.length;t+=3)n=parseInt(e.substring(t,t+3),16),r+=v.charAt(n>>6)+v.charAt(63&n);if(t+1==e.length?(n=parseInt(e.substring(t,t+1),16),r+=v.charAt(n<<2)):t+2==e.length&&(n=parseInt(e.substring(t,t+2),16),r+=v.charAt(n>>2)+v.charAt((3&n)<<4)),y)for(;(3&r.length)>0;)r+=y;return r}function b(e){var t,n,r,i="",o=0;for(t=0;t<e.length&&e.charAt(t)!=y;++t)(r=v.indexOf(e.charAt(t)))<0||(0==o?(i+=T(r>>2),n=3&r,o=1):1==o?(i+=T(n<<2|r>>4),n=15&r,o=2):2==o?(i+=T(n),i+=T(r>>2),n=3&r,o=3):(i+=T(n<<2|r>>4),i+=T(15&r),o=0));return 1==o&&(i+=T(n<<2)),i}function E(e,t,n){null!=e&&("number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function w(){return new E(null)}"Microsoft Internet Explorer"==p.appName?(E.prototype.am=function(e,t,n,r,i,o){for(var s=32767&t,a=t>>15;--o>=0;){var u=32767&this[e],c=this[e++]>>15,l=a*u+c*s;i=((u=s*u+((32767&l)<<15)+n[r]+(1073741823&i))>>>30)+(l>>>15)+a*c+(i>>>30),n[r++]=1073741823&u}return i},m=30):"Netscape"!=p.appName?(E.prototype.am=function(e,t,n,r,i,o){for(;--o>=0;){var s=t*this[e++]+n[r]+i;i=Math.floor(s/67108864),n[r++]=67108863&s}return i},m=26):(E.prototype.am=function(e,t,n,r,i,o){for(var s=16383&t,a=t>>14;--o>=0;){var u=16383&this[e],c=this[e++]>>14,l=a*u+c*s;i=((u=s*u+((16383&l)<<14)+n[r]+i)>>28)+(l>>14)+a*c,n[r++]=268435455&u}return i},m=28),E.prototype.DB=m,E.prototype.DM=(1<<m)-1,E.prototype.DV=1<<m,E.prototype.FV=Math.pow(2,52),E.prototype.F1=52-m,E.prototype.F2=2*m-52;var I,_,C="0123456789abcdefghijklmnopqrstuvwxyz",A=new Array;for(I="0".charCodeAt(0),_=0;_<=9;++_)A[I++]=_;for(I="a".charCodeAt(0),_=10;_<36;++_)A[I++]=_;for(I="A".charCodeAt(0),_=10;_<36;++_)A[I++]=_;function T(e){return C.charAt(e)}function R(e,t){var n=A[e.charCodeAt(t)];return null==n?-1:n}function O(e){var t=w();return t.fromInt(e),t}function P(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function D(e){this.m=e}function k(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function x(e,t){return e&t}function N(e,t){return e|t}function M(e,t){return e^t}function F(e,t){return e&~t}function L(e){if(0==e)return-1;var t=0;return 65535&e||(e>>=16,t+=16),255&e||(e>>=8,t+=8),15&e||(e>>=4,t+=4),3&e||(e>>=2,t+=2),1&e||++t,t}function V(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function B(){}function j(e){return e}function U(e){this.r2=w(),this.q3=w(),E.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}D.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},D.prototype.revert=function(e){return e},D.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},D.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},D.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},k.prototype.convert=function(e){var t=w();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(E.ZERO)>0&&this.m.subTo(t,t),t},k.prototype.revert=function(e){var t=w();return e.copyTo(t),this.reduce(t),t},k.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e[t],r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[n=t+this.m.t]+=this.m.am(0,r,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},k.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},k.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},E.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},E.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},E.prototype.fromString=function(e,t){var n;if(16==t)n=4;else if(8==t)n=3;else if(256==t)n=8;else if(2==t)n=1;else if(32==t)n=5;else{if(4!=t)return void this.fromRadix(e,t);n=2}this.t=0,this.s=0;for(var r=e.length,i=!1,o=0;--r>=0;){var s=8==n?255&e[r]:R(e,r);s<0?"-"==e.charAt(r)&&(i=!0):(i=!1,0==o?this[this.t++]=s:o+n>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,(o+=n)>=this.DB&&(o-=this.DB))}8==n&&128&e[0]&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&E.ZERO.subTo(this,this)},E.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},E.prototype.dlShiftTo=function(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s},E.prototype.drShiftTo=function(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s},E.prototype.lShiftTo=function(e,t){var n,r=e%this.DB,i=this.DB-r,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)t[n+s+1]=this[n]>>i|a,a=(this[n]&o)<<r;for(n=s-1;n>=0;--n)t[n]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},E.prototype.rShiftTo=function(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)t.t=0;else{var r=e%this.DB,i=this.DB-r,o=(1<<r)-1;t[0]=this[n]>>r;for(var s=n+1;s<this.t;++s)t[s-n-1]|=(this[s]&o)<<i,t[s-n]=this[s]>>r;r>0&&(t[this.t-n-1]|=(this.s&o)<<i),t.t=this.t-n,t.clamp()}},E.prototype.subTo=function(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);n<i;)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()},E.prototype.multiplyTo=function(e,t){var n=this.abs(),r=e.abs(),i=n.t;for(t.t=i+r.t;--i>=0;)t[i]=0;for(i=0;i<r.t;++i)t[i+n.t]=n.am(0,r[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&E.ZERO.subTo(t,t)},E.prototype.squareTo=function(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()},E.prototype.divRemTo=function(e,t,n){var r=e.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t)return null!=t&&t.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=w());var o=w(),s=this.s,a=e.s,u=this.DB-P(r[r.t-1]);u>0?(r.lShiftTo(u,o),i.lShiftTo(u,n)):(r.copyTo(o),i.copyTo(n));var c=o.t,l=o[c-1];if(0!=l){var d=l*(1<<this.F1)+(c>1?o[c-2]>>this.F2:0),h=this.FV/d,p=(1<<this.F1)/d,f=1<<this.F2,g=n.t,m=g-c,v=null==t?w():t;for(o.dlShiftTo(m,v),n.compareTo(v)>=0&&(n[n.t++]=1,n.subTo(v,n)),E.ONE.dlShiftTo(c,v),v.subTo(o,o);o.t<c;)o[o.t++]=0;for(;--m>=0;){var y=n[--g]==l?this.DM:Math.floor(n[g]*h+(n[g-1]+f)*p);if((n[g]+=o.am(0,y,n,m,0,c))<y)for(o.dlShiftTo(m,v),n.subTo(v,n);n[g]<--y;)n.subTo(v,n)}null!=t&&(n.drShiftTo(c,t),s!=a&&E.ZERO.subTo(t,t)),n.t=c,n.clamp(),u>0&&n.rShiftTo(u,n),s<0&&E.ZERO.subTo(n,n)}}},E.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(!(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},E.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},E.prototype.exp=function(e,t){if(e>4294967295||e<1)return E.ONE;var n=w(),r=w(),i=t.convert(this),o=P(e)-1;for(i.copyTo(n);--o>=0;)if(t.sqrTo(n,r),(e&1<<o)>0)t.mulTo(r,i,n);else{var s=n;n=r,r=s}return t.revert(n)},E.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,r=(1<<t)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(n=this[s]>>a)>0&&(i=!0,o=T(n));s>=0;)a<t?(n=(this[s]&(1<<a)-1)<<t-a,n|=this[--s]>>(a+=this.DB-t)):(n=this[s]>>(a-=t)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=T(n));return i?o:"0"},E.prototype.negate=function(){var e=w();return E.ZERO.subTo(this,e),e},E.prototype.abs=function(){return this.s<0?this.negate():this},E.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(0!=(t=n-e.t))return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0},E.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+P(this[this.t-1]^this.s&this.DM)},E.prototype.mod=function(e){var t=w();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(E.ZERO)>0&&e.subTo(t,t),t},E.prototype.modPowInt=function(e,t){var n;return n=e<256||t.isEven()?new D(t):new k(t),this.exp(e,n)},E.ZERO=O(0),E.ONE=O(1),B.prototype.convert=j,B.prototype.revert=j,B.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n)},B.prototype.sqrTo=function(e,t){e.squareTo(t)},U.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=w();return e.copyTo(t),this.reduce(t),t},U.prototype.revert=function(e){return e},U.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},U.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},U.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var H=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],q=(1<<26)/H[H.length-1];function K(){this.i=0,this.j=0,this.S=new Array}E.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},E.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),r=O(n),i=w(),o=w(),s="";for(this.divRemTo(r,i,o);i.signum()>0;)s=(n+o.intValue()).toString(e).substr(1)+s,i.divRemTo(r,i,o);return o.intValue().toString(e)+s},E.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var n=this.chunkSize(t),r=Math.pow(t,n),i=!1,o=0,s=0,a=0;a<e.length;++a){var u=R(e,a);u<0?"-"==e.charAt(a)&&0==this.signum()&&(i=!0):(s=t*s+u,++o>=n&&(this.dMultiply(r),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(s,0)),i&&E.ZERO.subTo(this,this)},E.prototype.fromNumber=function(e,t,n){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(E.ONE.shiftLeft(e-1),N,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(E.ONE.shiftLeft(e-1),this);else{var r=new Array,i=7&e;r.length=1+(e>>3),t.nextBytes(r),i>0?r[0]&=(1<<i)-1:r[0]=0,this.fromString(r,256)}},E.prototype.bitwiseTo=function(e,t,n){var r,i,o=Math.min(e.t,this.t);for(r=0;r<o;++r)n[r]=t(this[r],e[r]);if(e.t<this.t){for(i=e.s&this.DM,r=o;r<this.t;++r)n[r]=t(this[r],i);n.t=this.t}else{for(i=this.s&this.DM,r=o;r<e.t;++r)n[r]=t(i,e[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()},E.prototype.changeBit=function(e,t){var n=E.ONE.shiftLeft(e);return this.bitwiseTo(n,t,n),n},E.prototype.addTo=function(e,t){for(var n=0,r=0,i=Math.min(e.t,this.t);n<i;)r+=this[n]+e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;n<this.t;)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<e.t;)r+=e[n],t[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[n++]=r:r<-1&&(t[n++]=this.DV+r),t.t=n,t.clamp()},E.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},E.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},E.prototype.multiplyLowerTo=function(e,t,n){var r,i=Math.min(this.t+e.t,t);for(n.s=0,n.t=i;i>0;)n[--i]=0;for(r=n.t-this.t;i<r;++i)n[i+this.t]=this.am(0,e[i],n,i,0,this.t);for(r=Math.min(e.t,t);i<r;++i)this.am(0,e[i],n,i,0,t-i);n.clamp()},E.prototype.multiplyUpperTo=function(e,t,n){--t;var r=n.t=this.t+e.t-t;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n[this.t+r-t]=this.am(t-r,e[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)},E.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(0==t)n=this[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this[r])%e;return n},E.prototype.millerRabin=function(e){var t=this.subtract(E.ONE),n=t.getLowestSetBit();if(n<=0)return!1;var r=t.shiftRight(n);(e=e+1>>1)>H.length&&(e=H.length);for(var i=w(),o=0;o<e;++o){i.fromInt(H[Math.floor(Math.random()*H.length)]);var s=i.modPow(r,this);if(0!=s.compareTo(E.ONE)&&0!=s.compareTo(t)){for(var a=1;a++<n&&0!=s.compareTo(t);)if(0==(s=s.modPowInt(2,this)).compareTo(E.ONE))return!1;if(0!=s.compareTo(t))return!1}}return!0},E.prototype.clone=function(){var e=w();return this.copyTo(e),e},E.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},E.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},E.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},E.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},E.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var n,r=this.DB-e*this.DB%8,i=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),128&n&&(n|=-256),0==i&&(128&this.s)!=(128&n)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t},E.prototype.equals=function(e){return 0==this.compareTo(e)},E.prototype.min=function(e){return this.compareTo(e)<0?this:e},E.prototype.max=function(e){return this.compareTo(e)>0?this:e},E.prototype.and=function(e){var t=w();return this.bitwiseTo(e,x,t),t},E.prototype.or=function(e){var t=w();return this.bitwiseTo(e,N,t),t},E.prototype.xor=function(e){var t=w();return this.bitwiseTo(e,M,t),t},E.prototype.andNot=function(e){var t=w();return this.bitwiseTo(e,F,t),t},E.prototype.not=function(){for(var e=w(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},E.prototype.shiftLeft=function(e){var t=w();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},E.prototype.shiftRight=function(e){var t=w();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},E.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+L(this[e]);return this.s<0?this.t*this.DB:-1},E.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=V(this[n]^t);return e},E.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:!!(this[t]&1<<e%this.DB)},E.prototype.setBit=function(e){return this.changeBit(e,N)},E.prototype.clearBit=function(e){return this.changeBit(e,F)},E.prototype.flipBit=function(e){return this.changeBit(e,M)},E.prototype.add=function(e){var t=w();return this.addTo(e,t),t},E.prototype.subtract=function(e){var t=w();return this.subTo(e,t),t},E.prototype.multiply=function(e){var t=w();return this.multiplyTo(e,t),t},E.prototype.divide=function(e){var t=w();return this.divRemTo(e,t,null),t},E.prototype.remainder=function(e){var t=w();return this.divRemTo(e,null,t),t},E.prototype.divideAndRemainder=function(e){var t=w(),n=w();return this.divRemTo(e,t,n),new Array(t,n)},E.prototype.modPow=function(e,t){var n,r,i=e.bitLength(),o=O(1);if(i<=0)return o;n=i<18?1:i<48?3:i<144?4:i<768?5:6,r=i<8?new D(t):t.isEven()?new U(t):new k(t);var s=new Array,a=3,u=n-1,c=(1<<n)-1;if(s[1]=r.convert(this),n>1){var l=w();for(r.sqrTo(s[1],l);a<=c;)s[a]=w(),r.mulTo(l,s[a-2],s[a]),a+=2}var d,h,p=e.t-1,f=!0,g=w();for(i=P(e[p])-1;p>=0;){for(i>=u?d=e[p]>>i-u&c:(d=(e[p]&(1<<i+1)-1)<<u-i,p>0&&(d|=e[p-1]>>this.DB+i-u)),a=n;!(1&d);)d>>=1,--a;if((i-=a)<0&&(i+=this.DB,--p),f)s[d].copyTo(o),f=!1;else{for(;a>1;)r.sqrTo(o,g),r.sqrTo(g,o),a-=2;a>0?r.sqrTo(o,g):(h=o,o=g,g=h),r.mulTo(g,s[d],o)}for(;p>=0&&!(e[p]&1<<i);)r.sqrTo(o,g),h=o,o=g,g=h,--i<0&&(i=this.DB-1,--p)}return r.revert(o)},E.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return E.ZERO;for(var n=e.clone(),r=this.clone(),i=O(1),o=O(0),s=O(0),a=O(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),t?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(e,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;r.isEven();)r.rShiftTo(1,r),t?(s.isEven()&&a.isEven()||(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);n.compareTo(r)>=0?(n.subTo(r,n),t&&i.subTo(s,i),o.subTo(a,o)):(r.subTo(n,r),t&&s.subTo(i,s),a.subTo(o,a))}return 0!=r.compareTo(E.ONE)?E.ZERO:a.compareTo(e)>=0?a.subtract(e):a.signum()<0?(a.addTo(e,a),a.signum()<0?a.add(e):a):a},E.prototype.pow=function(e){return this.exp(e,new B)},E.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n,n=r}var i=t.getLowestSetBit(),o=n.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),n.rShiftTo(o,n));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return o>0&&n.lShiftTo(o,n),n},E.prototype.isProbablePrime=function(e){var t,n=this.abs();if(1==n.t&&n[0]<=H[H.length-1]){for(t=0;t<H.length;++t)if(n[0]==H[t])return!0;return!1}if(n.isEven())return!1;for(t=1;t<H.length;){for(var r=H[t],i=t+1;i<H.length&&r<q;)r*=H[i++];for(r=n.modInt(r);t<i;)if(r%H[t++]==0)return!1}return n.millerRabin(e)},E.prototype.square=function(){var e=w();return this.squareTo(e),e},K.prototype.init=function(e){var t,n,r;for(t=0;t<256;++t)this.S[t]=t;for(n=0,t=0;t<256;++t)n=n+this.S[t]+e[t%e.length]&255,r=this.S[t],this.S[t]=this.S[n],this.S[n]=r;this.i=0,this.j=0},K.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var $,W,G,z=256;function J(){!function(e){W[G++]^=255&e,W[G++]^=e>>8&255,W[G++]^=e>>16&255,W[G++]^=e>>24&255,G>=z&&(G-=z)}((new Date).getTime())}if(null==W){var Q;if(W=new Array,G=0,void 0!==f&&(void 0!==f.crypto||void 0!==f.msCrypto)){var Y=f.crypto||f.msCrypto;if(Y.getRandomValues){var Z=new Uint8Array(32);for(Y.getRandomValues(Z),Q=0;Q<32;++Q)W[G++]=Z[Q]}else if("Netscape"==p.appName&&p.appVersion<"5"){var X=f.crypto.random(32);for(Q=0;Q<X.length;++Q)W[G++]=255&X.charCodeAt(Q)}}for(;G<z;)Q=Math.floor(65536*Math.random()),W[G++]=Q>>>8,W[G++]=255&Q;G=0,J()}function ee(){if(null==$){for(J(),($=new K).init(W),G=0;G<W.length;++G)W[G]=0;G=0}return $.next()}function te(){}function ne(e,t){return new E(e,t)}function re(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function ie(e,t){this.x=t,this.q=e}function oe(e,t,n,r){this.curve=e,this.x=t,this.y=n,this.z=null==r?E.ONE:r,this.zinv=null}function se(e,t,n){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(n),this.infinity=new oe(this,null,null)}te.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=ee()},re.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},re.prototype.setPublic=function(e,t){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof e)this.n=e,this.e=t;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA public key";this.n=ne(e,16),this.e=parseInt(t,16)}},re.prototype.type="RSA",re.prototype.doPrivate=function(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),n=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(n)<0;)t=t.add(this.p);return t.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},re.prototype.setPrivate=function(e,t,n){if(this.isPrivate=!0,"string"!=typeof e)this.n=e,this.e=t,this.d=n;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA private key";this.n=ne(e,16),this.e=parseInt(t,16),this.d=ne(n,16)}},re.prototype.setPrivateEx=function(e,t,n,r,i,o,s,a){if(this.isPrivate=!0,this.isPublic=!1,null==e)throw"RSASetPrivateEx N == null";if(null==t)throw"RSASetPrivateEx E == null";if(0==e.length)throw"RSASetPrivateEx N.length == 0";if(0==t.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=ne(e,16),this.e=parseInt(t,16),this.d=ne(n,16),this.p=ne(r,16),this.q=ne(i,16),this.dmp1=ne(o,16),this.dmq1=ne(s,16),this.coeff=ne(a,16)},re.prototype.generate=function(e,t){var n=new te,r=e>>1;this.e=parseInt(t,16);for(var i=new E(t,16),o=e/2-100,s=E.ONE.shiftLeft(o);;){for(;this.p=new E(e-r,1,n),0!=this.p.subtract(E.ONE).gcd(i).compareTo(E.ONE)||!this.p.isProbablePrime(10););for(;this.q=new E(r,1,n),0!=this.q.subtract(E.ONE).gcd(i).compareTo(E.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var a=this.p;this.p=this.q,this.q=a}var u=this.q.subtract(this.p).abs();if(!(u.bitLength()<o||u.compareTo(s)<=0)){var c=this.p.subtract(E.ONE),l=this.q.subtract(E.ONE),d=c.multiply(l);if(0==d.gcd(i).compareTo(E.ONE)&&(this.n=this.p.multiply(this.q),this.n.bitLength()==e)){this.d=i.modInverse(d),this.dmp1=this.d.mod(c),this.dmq1=this.d.mod(l),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0},ie.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)},ie.prototype.toBigInteger=function(){return this.x},ie.prototype.negate=function(){return new ie(this.q,this.x.negate().mod(this.q))},ie.prototype.add=function(e){return new ie(this.q,this.x.add(e.toBigInteger()).mod(this.q))},ie.prototype.subtract=function(e){return new ie(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},ie.prototype.multiply=function(e){return new ie(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},ie.prototype.square=function(){return new ie(this.q,this.x.square().mod(this.q))},ie.prototype.divide=function(e){return new ie(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},ie.prototype.sqrt=function(){return new ie(this.q,this.x.sqrt().mod(this.q))},oe.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},oe.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},oe.prototype.equals=function(e){return e==this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(E.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(E.ZERO))},oe.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(E.ZERO)&&!this.y.toBigInteger().equals(E.ZERO)},oe.prototype.negate=function(){return new oe(this.curve,this.x,this.y.negate(),this.z)},oe.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),n=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(E.ZERO.equals(n))return E.ZERO.equals(t)?this.twice():this.curve.getInfinity();var r=new E("3"),i=this.x.toBigInteger(),o=this.y.toBigInteger(),s=(e.x.toBigInteger(),e.y.toBigInteger(),n.square()),a=s.multiply(n),u=i.multiply(s),c=t.square().multiply(this.z),l=c.subtract(u.shiftLeft(1)).multiply(e.z).subtract(a).multiply(n).mod(this.curve.q),d=u.multiply(r).multiply(t).subtract(o.multiply(a)).subtract(c.multiply(t)).multiply(e.z).add(t.multiply(a)).mod(this.curve.q),h=a.multiply(this.z).multiply(e.z).mod(this.curve.q);return new oe(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(d),h)},oe.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new E("3"),t=this.x.toBigInteger(),n=this.y.toBigInteger(),r=n.multiply(this.z),i=r.multiply(n).mod(this.curve.q),o=this.curve.a.toBigInteger(),s=t.square().multiply(e);E.ZERO.equals(o)||(s=s.add(this.z.square().multiply(o)));var a=(s=s.mod(this.curve.q)).square().subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(r).mod(this.curve.q),u=s.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(s.square().multiply(s)).mod(this.curve.q),c=r.square().multiply(r).shiftLeft(3).mod(this.curve.q);return new oe(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(u),c)},oe.prototype.multiply=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,n=e,r=n.multiply(new E("3")),i=this.negate(),o=this,s=this.curve.q.subtract(e),a=s.multiply(new E("3")),u=new oe(this.curve,this.x,this.y),c=u.negate();for(t=r.bitLength()-2;t>0;--t){o=o.twice();var l=r.testBit(t);l!=n.testBit(t)&&(o=o.add(l?this:i))}for(t=a.bitLength()-2;t>0;--t){u=u.twice();var d=a.testBit(t);d!=s.testBit(t)&&(u=u.add(d?u:c))}return o},oe.prototype.multiplyTwo=function(e,t,n){var r;r=e.bitLength()>n.bitLength()?e.bitLength()-1:n.bitLength()-1;for(var i=this.curve.getInfinity(),o=this.add(t);r>=0;)i=i.twice(),e.testBit(r)?i=n.testBit(r)?i.add(o):i.add(this):n.testBit(r)&&(i=i.add(t)),--r;return i},se.prototype.getQ=function(){return this.q},se.prototype.getA=function(){return this.a},se.prototype.getB=function(){return this.b},se.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)},se.prototype.getInfinity=function(){return this.infinity},se.prototype.fromBigInteger=function(e){return new ie(this.q,e)},se.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var t=e.substr(0,2),n=(e.substr(2),this.fromBigInteger(new E(a,16))),r=this.getA(),i=this.getB(),o=n.square().add(r).multiply(n).add(i).sqrt();return"03"==t&&(o=o.negate()),new oe(this,n,o);case 4:case 6:case 7:var s=(e.length-2)/2,a=e.substr(2,s),u=e.substr(s+2,s);return new oe(this,this.fromBigInteger(new E(a,16)),this.fromBigInteger(new E(u,16)));default:return null}},ie.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},oe.prototype.getEncoded=function(e){var t=function(e,t){var n=e.toByteArrayUnsigned();if(t<n.length)n=n.slice(n.length-t);else for(;t>n.length;)n.unshift(0);return n},n=this.getX().toBigInteger(),r=this.getY().toBigInteger(),i=t(n,32);return e?r.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(t(r,32))),i},oe.decodeFrom=function(e,t){t[0];var n=t.length-1,r=t.slice(1,1+n/2),i=t.slice(1+n/2,1+n);r.unshift(0),i.unshift(0);var o=new E(r),s=new E(i);return new oe(e,e.fromBigInteger(o),e.fromBigInteger(s))},oe.decodeFromHex=function(e,t){t.substr(0,2);var n=t.length-2,r=t.substr(2,n/2),i=t.substr(2+n/2,n/2),o=new E(r,16),s=new E(i,16);return new oe(e,e.fromBigInteger(o),e.fromBigInteger(s))},oe.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),n=e.y.subtract(this.y).divide(t),r=n.square().subtract(this.x).subtract(e.x),i=n.multiply(this.x.subtract(r)).subtract(this.y);return new oe(this.curve,r,i)},oe.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(E.valueOf(2)),t=this.curve.fromBigInteger(E.valueOf(3)),n=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),r=n.square().subtract(this.x.multiply(e)),i=n.multiply(this.x.subtract(r)).subtract(this.y);return new oe(this.curve,r,i)},oe.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,n=e,r=n.multiply(new E("3")),i=this.negate(),o=this;for(t=r.bitLength()-2;t>0;--t){o=o.twice();var s=r.testBit(t);s!=n.testBit(t)&&(o=o.add2D(s?this:i))}return o},oe.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),n=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),i=this.curve.getQ(),o=t.multiply(t).mod(i),s=e.multiply(e).multiply(e).add(n.multiply(e)).add(r).mod(i);return o.equals(s)},oe.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},oe.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),n=this.getY().toBigInteger();if(t.compareTo(E.ONE)<0||t.compareTo(e.subtract(E.ONE))>0)throw new Error("x coordinate out of bounds");if(n.compareTo(E.ONE)<0||n.compareTo(e.subtract(E.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var ae=function(){var e=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),t=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function r(e,t,r){return t?n[t]:String.fromCharCode(parseInt(r,16))}var i=new String(""),o=Object.hasOwnProperty;return function(n,s){var a,u,c=n.match(e),l=c[0],d=!1;"{"===l?a={}:"["===l?a=[]:(a=[],d=!0);for(var h=[a],p=1-d,f=c.length;p<f;++p){var g;switch((l=c[p]).charCodeAt(0)){default:(g=h[0])[u||g.length]=+l,u=void 0;break;case 34:if(-1!==(l=l.substring(1,l.length-1)).indexOf("\\")&&(l=l.replace(t,r)),g=h[0],!u){if(!(g instanceof Array)){u=l||i;break}u=g.length}g[u]=l,u=void 0;break;case 91:g=h[0],h.unshift(g[u||g.length]=[]),u=void 0;break;case 93:case 125:h.shift();break;case 102:(g=h[0])[u||g.length]=!1,u=void 0;break;case 110:(g=h[0])[u||g.length]=null,u=void 0;break;case 116:(g=h[0])[u||g.length]=!0,u=void 0;break;case 123:g=h[0],h.unshift(g[u||g.length]={}),u=void 0}}if(d){if(1!==h.length)throw new Error;a=a[0]}else if(h.length)throw new Error;if(s){var m=function(e,t){var n=e[t];if(n&&"object"==typeof n){var r=null;for(var i in n)if(o.call(n,i)&&n!==e){var a=m(n,i);void 0!==a?n[i]=a:(r||(r=[]),r.push(i))}if(r)for(var u=r.length;--u>=0;)delete n[r[u]]}return s.call(e,t,n)};a=m({"":a},"")}return a}}();void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),ue.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){return Ue(e)},this.getPEMStringFromHex=function(e,t){return Ie(e,t)},this.newObject=function(e){var t=ue.asn1,n=t.ASN1Object,r=t.DERBoolean,i=t.DERInteger,o=t.DERBitString,s=t.DEROctetString,a=t.DERNull,u=t.DERObjectIdentifier,c=t.DEREnumerated,l=t.DERUTF8String,d=t.DERNumericString,h=t.DERPrintableString,p=t.DERTeletexString,f=t.DERIA5String,g=t.DERUTCTime,m=t.DERGeneralizedTime,v=t.DERVisibleString,y=t.DERBMPString,S=t.DERSequence,b=t.DERSet,E=t.DERTaggedObject,w=t.ASN1Util.newObject;if(e instanceof t.ASN1Object)return e;var I=Object.keys(e);if(1!=I.length)throw new Error("key of param shall be only one.");var _=I[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+_+":"))throw new Error("undefined key: "+_);if("bool"==_)return new r(e[_]);if("int"==_)return new i(e[_]);if("bitstr"==_)return new o(e[_]);if("octstr"==_)return new s(e[_]);if("null"==_)return new a(e[_]);if("oid"==_)return new u(e[_]);if("enum"==_)return new c(e[_]);if("utf8str"==_)return new l(e[_]);if("numstr"==_)return new d(e[_]);if("prnstr"==_)return new h(e[_]);if("telstr"==_)return new p(e[_]);if("ia5str"==_)return new f(e[_]);if("utctime"==_)return new g(e[_]);if("gentime"==_)return new m(e[_]);if("visstr"==_)return new v(e[_]);if("bmpstr"==_)return new y(e[_]);if("asn1"==_)return new n(e[_]);if("seq"==_){for(var C=e[_],A=[],T=0;T<C.length;T++){var R=w(C[T]);A.push(R)}return new S({array:A})}if("set"==_){for(C=e[_],A=[],T=0;T<C.length;T++)R=w(C[T]),A.push(R);return new b({array:A})}if("tag"==_){var O=e[_];if("[object Array]"===Object.prototype.toString.call(O)&&3==O.length){var P=w(O[2]);return new E({tag:O[0],explicit:O[1],obj:P})}return new E(O)}},this.jsonToASN1HEX=function(e){return this.newObject(e).tohex()}},ue.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",n=parseInt(e.substr(0,2),16),r=(t=Math.floor(n/40)+"."+n%40,""),i=2;i<e.length;i+=2){var o=("00000000"+parseInt(e.substr(i,2),16).toString(2)).slice(-8);r+=o.substr(1,7),"0"==o.substr(0,1)&&(t=t+"."+new E(r,2).toString(10),r="")}return t},ue.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},n=function(e){var n="",r=new E(e,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var o="",s=0;s<i;s++)o+="0";for(r=o+r,s=0;s<r.length-1;s+=7){var a=r.substr(s,7);s!=r.length-7&&(a="1"+a),n+=t(parseInt(a,2))}return n};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var r="",i=e.split("."),o=40*parseInt(i[0])+parseInt(i[1]);r+=t(o),i.splice(0,2);for(var s=0;s<i.length;s++)r+=n(i[s]);return r},ue.asn1.ASN1Object=function(e){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n=0,v="+this.hV);var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var n=t.length/2;if(n>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+e.toString(16));return(128+n).toString(16)+t},this.tohex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(e){this.params=e},null!=e&&null!=e.tlv&&(this.hTLV=e.tlv,this.isModified=!1)},ue.asn1.DERAbstractString=function(e){ue.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=ye(this.s).toLowerCase()},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},$e(ue.asn1.DERAbstractString,ue.asn1.ASN1Object),ue.asn1.DERAbstractTime=function(e){ue.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){var t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t)},this.formatDate=function(e,t,n){var r=this.zeroPadding,i=this.localDateToUTC(e),o=String(i.getFullYear());"utc"==t&&(o=o.substr(2,2));var s=o+r(String(i.getMonth()+1),2)+r(String(i.getDate()),2)+r(String(i.getHours()),2)+r(String(i.getMinutes()),2)+r(String(i.getSeconds()),2);if(!0===n){var a=i.getMilliseconds();if(0!=a){var u=r(String(a),3);s=s+"."+(u=u.replace(/[0]+$/,""))}}return s+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.setByParam=function(e){this.hV=null,this.hTLV=null,this.params=e},this.getString=function(){},this.setString=function(e){this.hTLV=null,this.isModified=!0,null==this.params&&(this.params={}),this.params.str=e},this.setByDate=function(e){this.hTLV=null,this.isModified=!0,null==this.params&&(this.params={}),this.params.date=e},this.setByDateValue=function(e,t,n,r,i,o){var s=new Date(Date.UTC(e,t-1,n,r,i,o,0));this.setByDate(s)},this.getFreshValueHex=function(){return this.hV}},$e(ue.asn1.DERAbstractTime,ue.asn1.ASN1Object),ue.asn1.DERAbstractStructured=function(e){ue.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},$e(ue.asn1.DERAbstractStructured,ue.asn1.ASN1Object),ue.asn1.DERBoolean=function(e){ue.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==e?"010100":"0101ff"},$e(ue.asn1.DERBoolean,ue.asn1.ASN1Object),ue.asn1.DERInteger=function(e){ue.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var t=Ue;this.setByBigInteger=function(e){this.isModified=!0,this.params={bigint:e}},this.setByInteger=function(e){this.isModified=!0,this.params=e},this.setValueHex=function(e){this.isModified=!0,this.params={hex:e}},this.getFreshValueHex=function(){var e=this.params,n=null;if(null==e)throw new Error("value not set");if("object"==typeof e&&null!=e.hex)return this.hV=e.hex,this.hV;if("number"==typeof e)n=new E(String(e),10);else if(null!=e.int)n=new E(String(e.int),10);else{if(null==e.bigint)throw new Error("wrong parameter");n=e.bigint}return this.hV=t(n),this.hV},null!=e&&(this.params=e)},$e(ue.asn1.DERInteger,ue.asn1.ASN1Object),ue.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ue.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.tohex()}ue.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var n="0"+e;this.hTLV=null,this.isModified=!0,this.hV=n+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0),e+="0000000".substr(0,t);for(var n="",r=0;r<e.length-1;r+=8){var i=e.substr(r,8),o=parseInt(i,2).toString(16);1==o.length&&(o="0"+o),n+=o}this.hTLV=null,this.isModified=!0,this.hV="0"+t+n},this.setByBooleanArray=function(e){for(var t="",n=0;n<e.length;n++)1==e[n]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},$e(ue.asn1.DERBitString,ue.asn1.ASN1Object),ue.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ue.asn1.ASN1Util.newObject(e.obj);e.hex=t.tohex()}ue.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},$e(ue.asn1.DEROctetString,ue.asn1.DERAbstractString),ue.asn1.DERNull=function(){ue.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},$e(ue.asn1.DERNull,ue.asn1.ASN1Object),ue.asn1.DERObjectIdentifier=function(e){ue.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){var t=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},n=function(e){var n="",r=parseInt(e,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var o="",s=0;s<i;s++)o+="0";for(r=o+r,s=0;s<r.length-1;s+=7){var a=r.substr(s,7);s!=r.length-7&&(a="1"+a),n+=t(parseInt(a,2))}return n};try{if(!e.match(/^[0-9.]+$/))return null;var r="",i=e.split("."),o=40*parseInt(i[0],10)+parseInt(i[1],10);r+=t(o),i.splice(0,2);for(var s=0;s<i.length;s++)r+=n(i[s]);return r}catch(e){return null}}(e);if(null==t)throw new Error("malformed oid string: "+e);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){var t=ue.asn1.x509.OID.name2oid(e);if(""===t)throw new Error("DERObjectIdentifier oidName undefined: "+e);this.setValueOidString(t)},this.setValueNameOrOid=function(e){e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){"string"==typeof e?this.setValueNameOrOid(e):void 0!==e.oid?this.setValueNameOrOid(e.oid):void 0!==e.name?this.setValueNameOrOid(e.name):void 0!==e.hex&&this.setValueHex(e.hex)},void 0!==e&&this.setByParam(e)},$e(ue.asn1.DERObjectIdentifier,ue.asn1.ASN1Object),ue.asn1.DEREnumerated=function(e){ue.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=Ue(e)},this.setByInteger=function(e){var t=new E(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},$e(ue.asn1.DEREnumerated,ue.asn1.ASN1Object),ue.asn1.DERUTF8String=function(e){ue.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},$e(ue.asn1.DERUTF8String,ue.asn1.DERAbstractString),ue.asn1.DERNumericString=function(e){ue.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},$e(ue.asn1.DERNumericString,ue.asn1.DERAbstractString),ue.asn1.DERPrintableString=function(e){ue.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},$e(ue.asn1.DERPrintableString,ue.asn1.DERAbstractString),ue.asn1.DERTeletexString=function(e){ue.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},$e(ue.asn1.DERTeletexString,ue.asn1.DERAbstractString),ue.asn1.DERIA5String=function(e){ue.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},$e(ue.asn1.DERIA5String,ue.asn1.DERAbstractString),ue.asn1.DERVisibleString=function(e){ue.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"},$e(ue.asn1.DERVisibleString,ue.asn1.DERAbstractString),ue.asn1.DERBMPString=function(e){ue.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"},$e(ue.asn1.DERBMPString,ue.asn1.DERAbstractString),ue.asn1.DERUTCTime=function(e){ue.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var e=this.params;if(null==this.params&&(e={date:new Date}),"string"==typeof e){if(!e.match(/^[0-9]{12}Z$/)&&!e.match(/^[0-9]{12}\.[0-9]+Z$/))throw new Error("malformed string for UTCTime: "+e);this.hV=pe(e)}else if(null!=e.str)this.hV=pe(e.str);else if(null==e.date&&1==e.millis){var t=new Date;this.hV=pe(this.formatDate(t,"utc",!0))}else if(null!=e.date&&e.date instanceof Date){var n=!0===e.millis;this.hV=pe(this.formatDate(e.date,"utc",n))}else e instanceof Date&&(this.hV=pe(this.formatDate(e,"utc")));if(null==this.hV)throw new Error("parameter not specified properly for UTCTime");return this.hV},null!=e&&this.setByParam(e)},$e(ue.asn1.DERUTCTime,ue.asn1.DERAbstractTime),ue.asn1.DERGeneralizedTime=function(e){ue.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.params=e,this.getFreshValueHex=function(){var e=this.params;if(null==this.params&&(e={date:new Date}),"string"==typeof e){if(!e.match(/^[0-9]{14}Z$/)&&!e.match(/^[0-9]{14}\.[0-9]+Z$/))throw new Error("malformed string for GeneralizedTime: "+e);this.hV=pe(e)}else if(null!=e.str)this.hV=pe(e.str);else if(null==e.date&&1==e.millis){var t=new Date;this.hV=pe(this.formatDate(t,"gen",!0))}else if(null!=e.date&&e.date instanceof Date){var n=!0===e.millis;this.hV=pe(this.formatDate(e.date,"gen",n))}else e instanceof Date&&(this.hV=pe(this.formatDate(e,"gen")));if(null==this.hV)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},null!=e&&this.setByParam(e)},$e(ue.asn1.DERGeneralizedTime,ue.asn1.DERAbstractTime),ue.asn1.DERSequence=function(e){ue.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++)e+=this.asn1Array[t].tohex();return this.hV=e,this.hV}},$e(ue.asn1.DERSequence,ue.asn1.DERAbstractStructured),ue.asn1.DERSet=function(e){ue.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var n=this.asn1Array[t];e.push(n.tohex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},$e(ue.asn1.DERSet,ue.asn1.DERAbstractStructured),ue.asn1.DERTaggedObject=function(e){ue.asn1.DERTaggedObject.superclass.constructor.call(this);var t=ue.asn1,n=de,r=n.getV,i=(n.isASN1HEX,t.ASN1Util.newObject);this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(e,t,n){this.params={tag:t,explicit:e,obj:n}},this.getFreshValueHex=function(){var e=this.params;if(null==e.explicit&&(e.explicit=!0),null!=e.tage&&(e.tag=e.tage,e.explicit=!0),null!=e.tagi&&(e.tag=e.tagi,e.explicit=!1),null!=e.str)this.hV=ye(e.str);else if(null!=e.hex)this.hV=e.hex;else{if(null==e.obj)throw new Error("str, hex nor obj not specified");var n;e.obj instanceof t.ASN1Object?n=e.obj.tohex():"object"==typeof e.obj&&(n=i(e.obj).tohex()),e.explicit?this.hV=n:this.hV=r(n,0)}return null==e.tag&&(e.tag="a0"),this.hT=e.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.DERTaggedObject,ue.asn1.ASN1Object);var ue,ce,le,de=new function(){};function he(e){for(var t="",n=0;n<e.length;n++){var r=e[n].toString(16);1==r.length&&(r="0"+r),t+=r}return t}function pe(e){return he(function(e){for(var t=new Array,n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e))}function fe(e){return(e=(e=e.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function ge(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),(e=e.replace(/-/g,"+")).replace(/_/g,"/")}function me(e){return e.length%2==1&&(e="0"+e),fe(S(e))}function ve(e){return b(ge(e))}function ye(e){return Ae(Me(e)).toLowerCase()}function Se(e){try{return decodeURIComponent(Te(e))}catch(e){return null}}function be(e){return Se(function(e){for(var t=e.match(/.{1,2}/g),n=[],r=0;r<t.length;r++){var i=parseInt(t[r],16);161<=i&&i<=191?(n.push("c2"),n.push(t[r])):192<=i&&i<=255?(n.push("c3"),n.push((i-64).toString(16))):n.push(t[r])}return n.join("")}(e))}function Ee(e){for(var t="",n=0;n<e.length-1;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t}function we(e){for(var t="",n=0;n<e.length;n++)t+=("0"+e.charCodeAt(n).toString(16)).slice(-2);return t}function Ie(e,t){return"-----BEGIN "+t+"-----\r\n"+function(e,t){return(e=e.replace(new RegExp("(.{"+t+"})","g"),"$1\r\n")).replace(/\s+$/,"")}(function(e){return S(e)}(e),64)+"\r\n-----END "+t+"-----\r\n"}function _e(e,t){if(-1==e.indexOf("-----BEGIN "))throw new Error("can't find PEM header");return function(e){return b(e.replace(/[^0-9A-Za-z\/+=]*/g,""))}(e=void 0!==t?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),"")).replace(new RegExp("-----END "+t+"-----[^]*$"),""):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function Ce(e){return Math.round(function(e){var t,n,r,i,o,s,a,u,c,l;if(l=(e=function(e){return e.match(/^[0-9]{12}Z$/)||e.match(/^[0-9]{12}[.][0-9]*Z$/)?e.match(/^[0-4]/)?"20"+e:"19"+e:e}(e)).match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return t=parseInt(l[1]),n=parseInt(l[2])-1,r=parseInt(l[3]),i=parseInt(l[4]),o=parseInt(l[5]),s=parseInt(l[6]),a=0,""!==(u=l[7])&&(c=(u.substr(1)+"00").substr(0,3),a=parseInt(c)),Date.UTC(t,n,r,i,o,s,a);throw new Error("unsupported zulu format: "+e)}(e)/1e3)}function Ae(e){return e.replace(/%/g,"")}function Te(e){return e.replace(/(..)/g,"%$1")}function Re(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;var n=(e=e.toLowerCase()).split(":").length-1;if(n<2)throw t;var r=":".repeat(7-n+2),i=(e=e.replace("::",r)).split(":");if(8!=i.length)throw t;for(var o=0;o<8;o++)i[o]=("0000"+i[o]).slice(-4);return i.join("")}function Oe(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+e);var t=(e=e.toLowerCase()).match(/.{1,4}/g);t=t.map((function(e){return e.replace(/^0+/,"")})),t=t.map((function(e){return""==e?"0":e}));var n=(e=":"+t.join(":")+":").match(/:(0:){2,}/g);if(null==n)return e.slice(1,-1);var r=n.sort().slice(-1)[0];return"::"!=(e=e.replace(r.substr(0,r.length-1),":")).substr(0,2)&&(e=e.substr(1)),"::"!=e.substr(-2,2)&&(e=e.substr(0,e.length-1)),e}function Pe(e){var t=new Error("malformed hex value");if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(8==e.length)try{return parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16)}catch(e){throw t}else{if(16!=e.length){if(32==e.length)return Oe(e);if(64==e.length){try{return Oe(e.substr(0,32))+"/"+De(e.substr(32))}catch(e){throw t}return}return e}try{return Pe(e.substr(0,8))+"/"+De(e.substr(8))}catch(e){throw t}}}function De(e){var t,n=new Error("malformed mask");try{t=new E(e,16).toString(2)}catch(e){throw n}if(!t.match(/^1*0*$/))throw n;return t.replace(/0+$/,"").length}function ke(e){var t=new Error("malformed IP address");if(!(e=e.toLowerCase(e)).match(/^[0-9a-f.:/]+$/))throw t;if(!e.match(/^[0-9.]+$/)){var n;if(e.match(/^[0-9.]+\/[0-9]+$/))return ke((n=e.split("/"))[0])+xe(parseInt(n[1]),32);if(e.match(/^[0-9a-f:]+$/)&&-1!==e.indexOf(":"))return Re(e);if(e.match(/^[0-9a-f:]+\/[0-9]+$/)&&-1!==e.indexOf(":"))return Re((n=e.split("/"))[0])+xe(parseInt(n[1]),128);throw t}var r=e.split(".");if(4!==r.length)throw t;var i="";try{for(var o=0;o<4;o++)i+=("0"+parseInt(r[o]).toString(16)).slice(-2);return i}catch(e){throw t}}function xe(e,t){return 32==t&&0==e?"00000000":128==t&&0==e?"00000000000000000000000000000000":new E(Array(e+1).join("1")+Array(t-e+1).join("0"),2).toString(16)}function Ne(e){var t=e.match(/.{4}/g).map((function(e){var t=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2),16);if(0==t&n<128)return String.fromCharCode(n);if(t<8){var r=128|63&n;return Se((192|(7&t)<<3|(192&n)>>6).toString(16)+r.toString(16))}r=128|(15&t)<<2|(192&n)>>6;var i=128|63&n;return Se((224|(240&t)>>4).toString(16)+r.toString(16)+i.toString(16))}));return t.join("")}function Me(e){for(var t=encodeURIComponent(e),n="",r=0;r<t.length;r++)"%"==t[r]?(n+=t.substr(r,3),r+=2):n=n+"%"+pe(t[r]);return n}function Fe(e){return!(e.length%2!=0||!e.match(/^[0-9a-f]+$/)&&!e.match(/^[0-9A-F]+$/))}function Le(e){return!!e.match(/^[0-9A-Za-z-_.]+$/)}function Ve(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function Be(e){if(!Fe(e))return null;try{var t=[],n=e.substr(0,2),r=parseInt(n,16);t[0]=new String(Math.floor(r/40)),t[1]=new String(r%40);for(var i=e.substr(2),o=[],s=0;s<i.length/2;s++)o.push(parseInt(i.substr(2*s,2),16));var a=[],u="";for(s=0;s<o.length;s++)128&o[s]?u+=He((127&o[s]).toString(2),7):(u+=He((127&o[s]).toString(2),7),a.push(new String(parseInt(u,2))),u="");var c=t.join(".");return a.length>0&&(c=c+"."+a.join(".")),c}catch(e){return null}}function je(e){return Ue(new E(String(e),10))}function Ue(e){var t=e.toString(16);if("-"!=t.substr(0,1))return t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t),t;var n=t.substr(1).length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var r="",i=0;i<n;i++)r+="f";return new E(r,16).xor(e).add(E.ONE).toString(16).replace(/^-/,"")}de.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var n=parseInt(e.substr(t+3,1));return 0==n?-1:0<n&&n<10?n+1:-2},de.getL=function(e,t){var n=de.getLblen(e,t);return n<1?"":e.substr(t+2,2*n)},de.getVblen=function(e,t){var n;return""==(n=de.getL(e,t))?-1:("8"===n.substr(0,1)?new E(n.substr(2),16):new E(n,16)).intValue()},de.getVidx=function(e,t){var n=de.getLblen(e,t);return n<0?n:t+2*(n+1)},de.getV=function(e,t){var n=de.getVidx(e,t),r=de.getVblen(e,t);return e.substr(n,2*r)},de.getTLV=function(e,t){return e.substr(t,2)+de.getL(e,t)+de.getV(e,t)},de.getTLVblen=function(e,t){return 2+2*de.getLblen(e,t)+2*de.getVblen(e,t)},de.getNextSiblingIdx=function(e,t){return de.getVidx(e,t)+2*de.getVblen(e,t)},de.getChildIdx=function(e,t){var n,r,i,o=de,s=[];n=o.getVidx(e,t),r=2*o.getVblen(e,t),"03"==e.substr(t,2)&&(n+=2,r-=2),i=0;for(var a=n;i<=r;){var u=o.getTLVblen(e,a);if((i+=u)<=r&&s.push(a),a+=u,i>=r)break}return s},de.getNthChildIdx=function(e,t,n){return de.getChildIdx(e,t)[n]},de.getIdxbyList=function(e,t,n,r){var i,o,s=de;return 0==n.length?void 0!==r&&e.substr(t,2)!==r?-1:t:(i=n.shift())>=(o=s.getChildIdx(e,t)).length?-1:s.getIdxbyList(e,o[i],n,r)},de.getIdxbyListEx=function(e,t,n,r){var i,o,s=de;if(0==n.length)return void 0!==r&&e.substr(t,2)!==r?-1:t;i=n.shift(),o=s.getChildIdx(e,t);for(var a=0,u=0;u<o.length;u++){var c=e.substr(o[u],2);if("number"==typeof i&&!s.isContextTag(c)&&a==i||"string"==typeof i&&s.isContextTag(c,i))return s.getIdxbyListEx(e,o[u],n,r);s.isContextTag(c)||a++}return-1},de.getTLVbyList=function(e,t,n,r){var i=de,o=i.getIdxbyList(e,t,n,r);return-1==o||o>=e.length?null:i.getTLV(e,o)},de.getTLVbyListEx=function(e,t,n,r){var i=de,o=i.getIdxbyListEx(e,t,n,r);return-1==o?null:i.getTLV(e,o)},de.getVbyList=function(e,t,n,r,i){var o,s,a=de;return-1==(o=a.getIdxbyList(e,t,n,r))||o>=e.length?null:(s=a.getV(e,o),!0===i&&(s=s.substr(2)),s)},de.getVbyListEx=function(e,t,n,r,i){var o,s,a=de;return-1==(o=a.getIdxbyListEx(e,t,n,r))?null:(s=a.getV(e,o),"03"==e.substr(o,2)&&!1!==i&&(s=s.substr(2)),s)},de.getInt=function(e,t,n){null==n&&(n=-1);try{var r=e.substr(t,2);if("02"!=r&&"03"!=r)return n;var i=de.getV(e,t);return"02"==r?parseInt(i,16):function(e){if(e.length%2!=0)return-1;if(null==(e=e.toLowerCase()).match(/^[0-9a-f]+$/))return-1;try{var t=e.substr(0,2);if("00"==t)return parseInt(e.substr(2),16);var n=parseInt(t,16);if(n>7)return-1;var r=e.substr(2),i=parseInt(r,16).toString(2);"0"==i&&(i="00000000"),i=i.slice(0,0-n);var o=parseInt(i,2);return NaN==o?-1:o}catch(e){return-1}}(i)}catch(e){return n}},de.getOID=function(e,t,n){null==n&&(n=null);try{return"06"!=e.substr(t,2)?n:Be(de.getV(e,t))}catch(e){return n}},de.getOIDName=function(e,t,n){null==n&&(n=null);try{var r=de.getOID(e,t,n);if(r==n)return n;var i=ue.asn1.x509.OID.oid2name(r);return""==i?r:i}catch(e){return n}},de.getString=function(e,t,n){null==n&&(n=null);try{return Ee(de.getV(e,t))}catch(e){return n}},de.hextooidstr=function(e){var t=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},n=[],r=e.substr(0,2),i=parseInt(r,16);n[0]=new String(Math.floor(i/40)),n[1]=new String(i%40);for(var o=e.substr(2),s=[],a=0;a<o.length/2;a++)s.push(parseInt(o.substr(2*a,2),16));var u=[],c="";for(a=0;a<s.length;a++)128&s[a]?c+=t((127&s[a]).toString(2),7):(c+=t((127&s[a]).toString(2),7),u.push(new String(parseInt(c,2))),c="");var l=n.join(".");return u.length>0&&(l=l+"."+u.join(".")),l},de.dump=function(e,t,n,r){var i=de,o=i.getV,s=i.dump,a=i.getChildIdx,u=e;e instanceof ue.asn1.ASN1Object&&(u=e.tohex());var c=function(e,t){return e.length<=2*t?e:e.substr(0,t)+"..(total "+e.length/2+"bytes).."+e.substr(e.length-t,t)};void 0===t&&(t={ommit_long_octet:32}),void 0===n&&(n=0),void 0===r&&(r="");var l,d=t.ommit_long_octet;if("01"==(l=u.substr(n,2)))return"00"==(h=o(u,n))?r+"BOOLEAN FALSE\n":r+"BOOLEAN TRUE\n";if("02"==l)return r+"INTEGER "+c(h=o(u,n),d)+"\n";if("03"==l){var h=o(u,n);return i.isASN1HEX(h.substr(2))?(E=r+"BITSTRING, encapsulates\n")+s(h.substr(2),t,0,r+"  "):r+"BITSTRING "+c(h,d)+"\n"}if("04"==l)return h=o(u,n),i.isASN1HEX(h)?(E=r+"OCTETSTRING, encapsulates\n")+s(h,t,0,r+"  "):r+"OCTETSTRING "+c(h,d)+"\n";if("05"==l)return r+"NULL\n";if("06"==l){var p=o(u,n),f=ue.asn1.ASN1Util.oidHexToInt(p),g=ue.asn1.x509.OID.oid2name(f),m=f.replace(/\./g," ");return""!=g?r+"ObjectIdentifier "+g+" ("+m+")\n":r+"ObjectIdentifier ("+m+")\n"}if("0a"==l)return r+"ENUMERATED "+parseInt(o(u,n))+"\n";if("0c"==l)return r+"UTF8String '"+Se(o(u,n))+"'\n";if("13"==l)return r+"PrintableString '"+Se(o(u,n))+"'\n";if("14"==l)return r+"TeletexString '"+Se(o(u,n))+"'\n";if("16"==l)return r+"IA5String '"+Se(o(u,n))+"'\n";if("17"==l)return r+"UTCTime "+Se(o(u,n))+"\n";if("18"==l)return r+"GeneralizedTime "+Se(o(u,n))+"\n";if("1a"==l)return r+"VisualString '"+Se(o(u,n))+"'\n";if("1e"==l)return r+"BMPString '"+Ne(o(u,n))+"'\n";if("30"==l){if("3000"==u.substr(n,4))return r+"SEQUENCE {}\n";E=r+"SEQUENCE\n";var v=t;if((2==(b=a(u,n)).length||3==b.length)&&"06"==u.substr(b[0],2)&&"04"==u.substr(b[b.length-1],2)){g=i.oidname(o(u,b[0]));var y=JSON.parse(JSON.stringify(t));y.x509ExtName=g,v=y}for(var S=0;S<b.length;S++)E+=s(u,v,b[S],r+"  ");return E}if("31"==l){E=r+"SET\n";var b=a(u,n);for(S=0;S<b.length;S++)E+=s(u,t,b[S],r+"  ");return E}if(128&(l=parseInt(l,16))){var E,w=31&l;if(32&l){for(E=r+"["+w+"]\n",b=a(u,n),S=0;S<b.length;S++)E+=s(u,t,b[S],r+"  ");return E}return h=o(u,n),de.isASN1HEX(h)?(E=r+"["+w+"]\n")+s(h,t,0,r+"  "):(("68747470"==h.substr(0,8)||"subjectAltName"===t.x509ExtName&&2==w)&&(h=Se(h)),r+"["+w+"] "+h+"\n")}return r+"UNKNOWN("+l+") "+o(u,n)+"\n"},de.parse=function(e){var t=de,n=t.parse,r=t.isASN1HEX,i=t.getV,o=t.getTLV,s=t.getChildIdx,a=ue.asn1,u=a.ASN1Util.oidHexToInt,c=a.x509.OID.oid2name,l=Se,d=Ne,h=be,p={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},f=e.substr(0,2),g={},m=i(e,0);if("01"==f)return"0101ff"==e?{bool:!0}:{bool:!1};if("02"==f)return{int:{hex:m}};if("03"==f)try{if("00"!=m.substr(0,2))throw"not encap";var v=m.substr(2);if(!r(v))throw"not encap";return{bitstr:{obj:n(v)}}}catch(e){var y=null;return m.length<=10&&(y=function(e){if("string"!=typeof e)return null;if(e.length%2!=0)return null;if(!e.match(/^[0-9a-f]+$/))return null;try{var t=parseInt(e.substr(0,2),16);if(t<0||7<t)return null;for(var n=e.substr(2),r="",i=0;i<n.length;i+=2){var o=n.substr(i,2),s=parseInt(o,16).toString(2);r+=s=("0000000"+s).slice(-8)}return r.substr(0,r.length-t)}catch(e){return null}}(m)),null==y?{bitstr:{hex:m}}:{bitstr:{bin:y}}}else if("04"==f)try{if(!r(m))throw"not encap";return{octstr:{obj:n(m)}}}catch(e){return{octstr:{hex:m}}}else{if("05"==f)return{null:""};if("06"==f){var S=u(m),b=c(S);return""==b?{oid:S}:{oid:b}}if("0a"==f)return m.length>4?{enum:{hex:m}}:{enum:parseInt(m,16)};if("30"==f||"31"==f)return g[p[f]]=function(e){for(var t=[],r=s(e,0),i=0;i<r.length;i++){var a=r[i],u=o(e,a),c=n(u);t.push(c)}return t}(e),g;if("14"==f){var E=h(m);return g[p[f]]={str:E},g}if("1e"==f)return E=d(m),g[p[f]]={str:E},g;if(-1!=":0c:12:13:16:17:18:1a:".indexOf(f))return E=l(m),g[p[f]]={str:E},g;if(f.match(/^8[0-9]$/))return null==(E=l(m))|""==E||null!=E.match(/[\x00-\x1F\x7F-\x9F]/)||null!=E.match(/[\u0000-\u001F\u0080\u009F]/)?{tag:{tag:f,explicit:!1,hex:m}}:{tag:{tag:f,explicit:!1,str:E}};if(!f.match(/^a[0-9]$/)){var w=new ue.asn1.ASN1Object;return w.hV=m,{asn1:{tlv:f+w.getLengthHexFromValue()+m}}}try{if(!r(m))throw new Error("not encap");return{tag:{tag:f,explicit:!0,obj:n(m)}}}catch(e){return{tag:{tag:f,explicit:!0,hex:m}}}}},de.isContextTag=function(e,t){var n,r;e=e.toLowerCase();try{n=parseInt(e,16)}catch(e){return-1}if(void 0===t)return 128==(192&n);try{return null!=t.match(/^\[[0-9]+\]$/)&&!((r=parseInt(t.substr(1,t.length-1),10))>31)&&128==(192&n)&&(31&n)==r}catch(e){return!1}},de.isASN1HEX=function(e){var t=de;if(e.length%2==1)return!1;var n=t.getVblen(e,0),r=e.substr(0,2),i=t.getL(e,0);return e.length-r.length-i.length==2*n},de.checkStrictDER=function(e,t,n,r,i){var o=de;if(void 0===n){if("string"!=typeof e)throw new Error("not hex string");if(e=e.toLowerCase(),!ue.lang.String.isHex(e))throw new Error("not hex string");n=e.length,i=(r=e.length/2)<128?1:Math.ceil(r.toString(16))+1}if(o.getL(e,t).length>2*i)throw new Error("L of TLV too long: idx="+t);var s=o.getVblen(e,t);if(s>r)throw new Error("value of L too long than hex: idx="+t);var a=o.getTLV(e,t),u=a.length-2-o.getL(e,t).length;if(u!==2*s)throw new Error("V string length and L's value not the same:"+u+"/"+2*s);if(0===t&&e.length!=a.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+a.length);var c=e.substr(t,2);if("02"===c){var l=o.getVidx(e,t);if("00"==e.substr(l,2)&&e.charCodeAt(l+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(c,16)){for(var d=o.getVblen(e,t),h=0,p=o.getChildIdx(e,t),f=0;f<p.length;f++)h+=o.getTLV(e,p[f]).length,o.checkStrictDER(e,p[f],n,r,i);if(2*d!=h)throw new Error("sum of children's TLV length and L unmatch: "+2*d+"!="+h)}},de.oidname=function(e){var t=ue.asn1;ue.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var n=t.x509.OID.oid2name(e);return""===n&&(n=e),n},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.x509&&ue.asn1.x509||(ue.asn1.x509={}),ue.asn1.x509.Certificate=function(e){ue.asn1.x509.Certificate.superclass.constructor.call(this);var t=ue.asn1,n=t.DERBitString,r=t.DERSequence,i=t.x509,o=i.TBSCertificate,s=i.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(e){this.params=e},this.sign=function(){var e=this.params,t=e.sigalg;null!=e.sigalg.name&&(t=e.sigalg.name);var n=e.tbsobj.tohex(),r=new ue.crypto.Signature({alg:t});r.init(e.cakey),r.updateHex(n),e.sighex=r.sign()},this.getPEM=function(){return Ie(this.tohex(),"CERTIFICATE")},this.tohex=function(){var e=this.params;if(null!=e.tbsobj&&null!=e.tbsobj||(e.tbsobj=new o(e)),null==e.sighex&&null!=e.cakey&&this.sign(),null==e.sighex)throw new Error("sighex or cakey parameter not defined");var t=[];return t.push(e.tbsobj),t.push(new s({name:e.sigalg})),t.push(new n({hex:"00"+e.sighex})),new r({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&(this.params=e)},$e(ue.asn1.x509.Certificate,ue.asn1.ASN1Object),ue.asn1.x509.TBSCertificate=function(e){ue.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=ue.asn1,n=t.x509,r=t.DERTaggedObject,i=t.DERInteger,o=t.DERSequence,s=n.AlgorithmIdentifier,a=n.Time,u=n.X500Name,c=n.Extensions,l=n.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=[],t=this.params;if(null!=t.version||1!=t.version){var n=2;null!=t.version&&(n=t.version-1);var d=new r({obj:new i({int:n})});e.push(d)}return e.push(new i(t.serial)),e.push(new s({name:t.sigalg})),e.push(new u(t.issuer)),e.push(new o({array:[new a(t.notbefore),new a(t.notafter)]})),e.push(new u(t.subject)),e.push(new l(We.getKey(t.sbjpubkey))),void 0!==t.ext&&t.ext.length>0&&e.push(new r({tag:"a3",obj:new c(t.ext)})),new ue.asn1.DERSequence({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.TBSCertificate,ue.asn1.ASN1Object),ue.asn1.x509.Extensions=function(e){ue.asn1.x509.Extensions.superclass.constructor.call(this);var t=ue.asn1,n=t.DERSequence,r=t.x509;this.aParam=[],this.setByParam=function(e){this.aParam=e},this.tohex=function(){for(var e=[],t=0;t<this.aParam.length;t++){var i=this.aParam[t],o=i.extname,s=null;if(null!=i.extn)s=new r.PrivateExtension(i);else if("subjectKeyIdentifier"==o)s=new r.SubjectKeyIdentifier(i);else if("keyUsage"==o)s=new r.KeyUsage(i);else if("subjectAltName"==o)s=new r.SubjectAltName(i);else if("issuerAltName"==o)s=new r.IssuerAltName(i);else if("basicConstraints"==o)s=new r.BasicConstraints(i);else if("nameConstraints"==o)s=new r.NameConstraints(i);else if("cRLDistributionPoints"==o)s=new r.CRLDistributionPoints(i);else if("certificatePolicies"==o)s=new r.CertificatePolicies(i);else if("policyMappings"==o)s=new r.PolicyMappings(i);else if("policyConstraints"==o)s=new r.PolicyConstraints(i);else if("inhibitAnyPolicy"==o)s=new r.InhibitAnyPolicy(i);else if("authorityKeyIdentifier"==o)s=new r.AuthorityKeyIdentifier(i);else if("extKeyUsage"==o)s=new r.ExtKeyUsage(i);else if("authorityInfoAccess"==o)s=new r.AuthorityInfoAccess(i);else if("cRLNumber"==o)s=new r.CRLNumber(i);else if("cRLReason"==o)s=new r.CRLReason(i);else if("ocspNonce"==o)s=new r.OCSPNonce(i);else if("ocspNoCheck"==o)s=new r.OCSPNoCheck(i);else if("adobeTimeStamp"==o)s=new r.AdobeTimeStamp(i);else{if("subjectDirectoryAttributes"!=o)throw new Error("extension not supported:"+JSON.stringify(i));s=new r.SubjectDirectoryAttributes(i)}null!=s&&e.push(s)}return new n({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.x509.Extensions,ue.asn1.ASN1Object),ue.asn1.x509.Extension=function(e){ue.asn1.x509.Extension.superclass.constructor.call(this);var t=ue.asn1,n=t.DERObjectIdentifier,r=t.DEROctetString,i=(t.DERBitString,t.DERBoolean),o=t.DERSequence;this.tohex=function(){var e=new n({oid:this.oid}),t=new r({hex:this.getExtnValueHex()}),s=new Array;return s.push(e),this.critical&&s.push(new i),s.push(t),new o({array:s}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,void 0!==e&&void 0!==e.critical&&(this.critical=e.critical)},$e(ue.asn1.x509.Extension,ue.asn1.ASN1Object),ue.asn1.x509.KeyUsage=function(e){ue.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=Error,n={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var e=this.getBinValue();return this.asn1ExtnValue=new ue.asn1.DERBitString({bin:e}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var e=this.params;if("object"!=typeof e||"object"!=typeof e.names&&"string"!=typeof e.bin)throw new t("parameter not yet set");if(null!=e.names)return qe(e.names,n);if(null!=e.bin)return e.bin;throw new t("parameter not set properly")},this.oid="2.5.29.15",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.KeyUsage,ue.asn1.x509.Extension),ue.asn1.x509.BasicConstraints=function(e){ue.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERBoolean,r=t.DERInteger,i=t.DERSequence;this.getExtnValueHex=function(){var e=new Array;this.cA&&e.push(new n),this.pathLen>-1&&e.push(new r({int:this.pathLen}));var t=new i({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==e&&(void 0!==e.cA&&(this.cA=e.cA),void 0!==e.pathLen&&(this.pathLen=e.pathLen))},$e(ue.asn1.x509.BasicConstraints,ue.asn1.x509.Extension),ue.asn1.x509.CRLDistributionPoints=function(e){ue.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=ue.asn1,n=t.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(e){for(var r=[],i=0;i<e.length;i++)if(e[i]instanceof ue.asn1.ASN1Object)r.push(e[i]);else{var o=new n.DistributionPoint(e[i]);r.push(o)}this.asn1ExtnValue=new t.DERSequence({array:r})},this.setByOneURI=function(e){var t=new n.DistributionPoint({fulluri:e});this.setByDPArray([t])},this.oid="2.5.29.31",void 0!==e&&(void 0!==e.array?this.setByDPArray(e.array):void 0!==e.uri&&this.setByOneURI(e.uri))},$e(ue.asn1.x509.CRLDistributionPoints,ue.asn1.x509.Extension),ue.asn1.x509.DistributionPoint=function(e){ue.asn1.x509.DistributionPoint.superclass.constructor.call(this);var t=ue.asn1,n=t.x509.DistributionPointName;this.tohex=function(){var e=new t.DERSequence;if(null!=this.asn1DP){var n=new t.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});e.appendASN1Object(n)}return this.hTLV=e.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(void 0!==e.dpobj?this.asn1DP=e.dpobj:void 0!==e.dpname?this.asn1DP=new n(e.dpname):void 0!==e.fulluri&&(this.asn1DP=new n({full:[{uri:e.fulluri}]})))},$e(ue.asn1.x509.DistributionPoint,ue.asn1.ASN1Object),ue.asn1.x509.DistributionPointName=function(e){ue.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=ue.asn1,n=t.DERTaggedObject;if(this.tohex=function(){if("full"!=this.type)throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new n({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e)if(t.x509.GeneralNames.prototype.isPrototypeOf(e))this.type="full",this.tag="a0",this.asn1V=e;else{if(void 0===e.full)throw new Error("This class supports GeneralNames only as argument");this.type="full",this.tag="a0",this.asn1V=new t.x509.GeneralNames(e.full)}},$e(ue.asn1.x509.DistributionPointName,ue.asn1.ASN1Object),ue.asn1.x509.CertificatePolicies=function(e){ue.asn1.x509.CertificatePolicies.superclass.constructor.call(this,e);var t=ue.asn1,n=t.x509,r=t.DERSequence,i=n.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var e=[],t=0;t<this.params.array.length;t++)e.push(new i(this.params.array[t]));var n=new r({array:e});return this.asn1ExtnValue=n,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.CertificatePolicies,ue.asn1.x509.Extension),ue.asn1.x509.PolicyInformation=function(e){ue.asn1.x509.PolicyInformation.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERSequence,r=t.DERObjectIdentifier,i=t.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(void 0===this.params.policyoid&&void 0===this.params.array)throw new Error("parameter oid and array missing");var e=[new r(this.params.policyoid)];if(void 0!==this.params.array){for(var t=[],o=0;o<this.params.array.length;o++)t.push(new i(this.params.array[o]));t.length>0&&e.push(new n({array:t}))}return new n({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(this.params=e)},$e(ue.asn1.x509.PolicyInformation,ue.asn1.ASN1Object),ue.asn1.x509.PolicyQualifierInfo=function(e){ue.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERSequence,r=t.DERIA5String,i=t.DERObjectIdentifier,o=t.x509.UserNotice;this.params=null,this.tohex=function(){return void 0!==this.params.cps?new n({array:[new i({oid:"1.3.6.1.5.5.7.2.1"}),new r({str:this.params.cps})]}).tohex():null!=this.params.unotice?new n({array:[new i({oid:"1.3.6.1.5.5.7.2.2"}),new o(this.params.unotice)]}).tohex():void 0},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(this.params=e)},$e(ue.asn1.x509.PolicyQualifierInfo,ue.asn1.ASN1Object),ue.asn1.x509.UserNotice=function(e){ue.asn1.x509.UserNotice.superclass.constructor.call(this,e);var t=ue.asn1.DERSequence,n=(ue.asn1.DERInteger,ue.asn1.x509.DisplayText),r=ue.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var e=[];return void 0!==this.params.noticeref&&e.push(new r(this.params.noticeref)),void 0!==this.params.exptext&&e.push(new n(this.params.exptext)),new t({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(this.params=e)},$e(ue.asn1.x509.UserNotice,ue.asn1.ASN1Object),ue.asn1.x509.NoticeReference=function(e){ue.asn1.x509.NoticeReference.superclass.constructor.call(this,e);var t=ue.asn1.DERSequence,n=ue.asn1.DERInteger,r=ue.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var e=[];if(void 0!==this.params.org&&e.push(new r(this.params.org)),void 0!==this.params.noticenum){for(var i=[],o=this.params.noticenum,s=0;s<o.length;s++)i.push(new n(o[s]));e.push(new t({array:i}))}if(0==e.length)throw new Error("parameter is empty");return new t({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(this.params=e)},$e(ue.asn1.x509.NoticeReference,ue.asn1.ASN1Object),ue.asn1.x509.DisplayText=function(e){ue.asn1.x509.DisplayText.superclass.constructor.call(this,e),this.hT="0c",void 0!==e&&("ia5"===e.type?this.hT="16":"vis"===e.type?this.hT="1a":"bmp"===e.type&&(this.hT="1e"))},$e(ue.asn1.x509.DisplayText,ue.asn1.DERAbstractString),ue.asn1.x509.PolicyMappings=function(e){ue.asn1.x509.PolicyMappings.superclass.constructor.call(this,e);var t=ue.asn1,n=(t.x509,t.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){for(var e=this.params,t=[],r=0;r<e.array.length;r++){var i=e.array[r];t.push({seq:[{oid:i[0]},{oid:i[1]}]})}return this.asn1ExtnValue=n({seq:t}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.PolicyMappings,ue.asn1.x509.Extension),ue.asn1.x509.PolicyConstraints=function(e){ue.asn1.x509.PolicyConstraints.superclass.constructor.call(this,e);var t=ue.asn1,n=(t.x509,t.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){var e=this.params,t=[];return null!=e.reqexp&&t.push({tag:{tagi:"80",obj:{int:e.reqexp}}}),null!=e.inhibit&&t.push({tag:{tagi:"81",obj:{int:e.inhibit}}}),this.asn1ExtnValue=n({seq:t}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.PolicyConstraints,ue.asn1.x509.Extension),ue.asn1.x509.InhibitAnyPolicy=function(e){ue.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,e);var t=ue.asn1,n=(t.x509,t.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=n({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.InhibitAnyPolicy,ue.asn1.x509.Extension),ue.asn1.x509.NameConstraints=function(e){ue.asn1.x509.NameConstraints.superclass.constructor.call(this,e);var t=ue.asn1,n=t.x509,r=t.ASN1Util.newObject,i=n.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var e=this.params,t=[];if(null!=e.permit&&null!=e.permit.length){for(var n=[],o=0;o<e.permit.length;o++)n.push(new i(e.permit[o]));t.push({tag:{tagi:"a0",obj:{seq:n}}})}if(null!=e.exclude&&null!=e.exclude.length){var s=[];for(o=0;o<e.exclude.length;o++)s.push(new i(e.exclude[o]));t.push({tag:{tagi:"a1",obj:{seq:s}}})}return this.asn1ExtnValue=r({seq:t}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.NameConstraints,ue.asn1.x509.Extension),ue.asn1.x509.GeneralSubtree=function(e){ue.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var t=ue.asn1,n=t.x509.GeneralName,r=t.ASN1Util.newObject;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params,t=[new n(e)];return null!=e.min&&t.push({tag:{tagi:"80",obj:{int:e.min}}}),null!=e.max&&t.push({tag:{tagi:"81",obj:{int:e.max}}}),r({seq:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.GeneralSubtree,ue.asn1.ASN1Object),ue.asn1.x509.ExtKeyUsage=function(e){ue.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var t=ue.asn1;this.setPurposeArray=function(e){this.asn1ExtnValue=new t.DERSequence;for(var n=0;n<e.length;n++){var r=new t.DERObjectIdentifier(e[n]);this.asn1ExtnValue.appendASN1Object(r)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",void 0!==e&&void 0!==e.array&&this.setPurposeArray(e.array)},$e(ue.asn1.x509.ExtKeyUsage,ue.asn1.x509.Extension),ue.asn1.x509.AuthorityKeyIdentifier=function(e){ue.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var t=ue,n=t.asn1,r=n.DERTaggedObject,i=n.x509.GeneralNames;t.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var e=new Array;this.asn1KID&&e.push(new r({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&e.push(new r({explicit:!1,tag:"a1",obj:new i([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&e.push(new r({explicit:!1,tag:"82",obj:this.asn1CertSN}));var t=new n.DERSequence({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(e){if(void 0!==e.str||void 0!==e.hex)this.asn1KID=new ue.asn1.DEROctetString(e);else if("object"==typeof e&&ue.crypto.Util.isKey(e)||"string"==typeof e&&-1!=e.indexOf("BEGIN ")){var t=e;"string"==typeof e&&(t=We.getKey(e));var n=We.getKeyID(t);this.asn1KID=new ue.asn1.DEROctetString({hex:n})}},this.setCertIssuerByParam=function(e){void 0!==e.str||void 0!==e.ldapstr||void 0!==e.hex||void 0!==e.certsubject||void 0!==e.certissuer?this.asn1CertIssuer=new ue.asn1.x509.X500Name(e):"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&-1!=e.indexOf("CERTIFICATE")&&(this.asn1CertIssuer=new ue.asn1.x509.X500Name({certissuer:e}))},this.setCertSNByParam=function(e){if(void 0!==e.str||void 0!==e.bigint||void 0!==e.hex)this.asn1CertSN=new ue.asn1.DERInteger(e);else if("string"==typeof e&&-1!=e.indexOf("BEGIN ")&&e.indexOf("CERTIFICATE")){var t=new Qe;t.readCertPEM(e);var n=t.getSerialNumberHex();this.asn1CertSN=new ue.asn1.DERInteger({hex:n})}},this.oid="2.5.29.35",void 0!==e&&(void 0!==e.kid&&this.setKIDByParam(e.kid),void 0!==e.issuer&&this.setCertIssuerByParam(e.issuer),void 0!==e.sn&&this.setCertSNByParam(e.sn),void 0!==e.issuersn&&"string"==typeof e.issuersn&&-1!=e.issuersn.indexOf("BEGIN ")&&e.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(e.issuersn),this.setCertIssuerByParam(e.issuersn)))},$e(ue.asn1.x509.AuthorityKeyIdentifier,ue.asn1.x509.Extension),ue.asn1.x509.SubjectKeyIdentifier=function(e){ue.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,e);var t=ue.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(e){if(void 0!==e.str||void 0!==e.hex)this.asn1KID=new t(e);else if("object"==typeof e&&ue.crypto.Util.isKey(e)||"string"==typeof e&&-1!=e.indexOf("BEGIN")){var n=e;"string"==typeof e&&(n=We.getKey(e));var r=We.getKeyID(n);this.asn1KID=new ue.asn1.DEROctetString({hex:r})}},this.oid="2.5.29.14",void 0!==e&&void 0!==e.kid&&this.setKIDByParam(e.kid)},$e(ue.asn1.x509.SubjectKeyIdentifier,ue.asn1.x509.Extension),ue.asn1.x509.AuthorityInfoAccess=function(e){ue.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(e){for(var t=new Array,n=ue.asn1,r=n.DERSequence,i=n.DERObjectIdentifier,o=n.x509.GeneralName,s=0;s<e.length;s++){var a,u=e[s];if(void 0!==u.ocsp)a=new r({array:[new i({oid:"1.3.6.1.5.5.7.48.1"}),new o({uri:u.ocsp})]});else{if(void 0===u.caissuer)throw new Error("unknown AccessMethod parameter: "+JSON.stringify(u));a=new r({array:[new i({oid:"1.3.6.1.5.5.7.48.2"}),new o({uri:u.caissuer})]})}t.push(a)}this.asn1ExtnValue=new r({array:t})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==e&&void 0!==e.array&&this.setAccessDescriptionArray(e.array)},$e(ue.asn1.x509.AuthorityInfoAccess,ue.asn1.x509.Extension),ue.asn1.x509.SubjectAltName=function(e){ue.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new ue.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},$e(ue.asn1.x509.SubjectAltName,ue.asn1.x509.Extension),ue.asn1.x509.IssuerAltName=function(e){ue.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new ue.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},$e(ue.asn1.x509.IssuerAltName,ue.asn1.x509.Extension),ue.asn1.x509.SubjectDirectoryAttributes=function(e){ue.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERSequence,r=t.ASN1Util.newObject,i=t.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var e=[],t=0;t<this.params.array.length;t++){var o=this.params.array[t];if(null==o.attr||null==o.array){var s={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if("dateOfBirth"==o.attr)s.seq[0].oid=i(o.attr),s.seq[1].set[0]={gentime:o.str};else if("placeOfBirth"==o.attr)s.seq[0].oid=i(o.attr),s.seq[1].set[0]={utf8str:o.str};else if("gender"==o.attr)s.seq[0].oid=i(o.attr),s.seq[1].set[0]={prnstr:o.str};else if("countryOfCitizenship"==o.attr)s.seq[0].oid=i(o.attr),s.seq[1].set[0]={prnstr:o.str};else{if("countryOfResidence"!=o.attr)throw new Error("unsupported attribute: "+o.attr);s.seq[0].oid=i(o.attr),s.seq[1].set[0]={prnstr:o.str}}e.push(new r(s))}else{var a={seq:[{oid:o.attr},{set:o.array}]};e.push(r(a))}}var u=new n({array:e});return this.asn1ExtnValue=u,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.SubjectDirectoryAttributes,ue.asn1.x509.Extension),ue.asn1.x509.PrivateExtension=function(e){ue.asn1.x509.PrivateExtension.superclass.constructor.call(this,e);var t=ue,n=t.lang.String.isHex,r=t.asn1,i=r.x509.OID.name2oid,o=r.ASN1Util.newObject;this.params=null,this.setByParam=function(e){this.oid=i(e.extname),this.params=e},this.getExtnValueHex=function(){if(null==this.params.extname||null==this.params.extn)throw new Error("extname or extnhex not specified");var e=this.params.extn;if("string"==typeof e&&n(e))return e;if("object"==typeof e)try{return o(e).tohex()}catch(e){}throw new Error("unsupported extn value")},null!=e&&this.setByParam(e)},$e(ue.asn1.x509.PrivateExtension,ue.asn1.x509.Extension),ue.asn1.x509.CRL=function(e){ue.asn1.x509.CRL.superclass.constructor.call(this);var t=ue.asn1,n=t.DERSequence,r=t.DERBitString,i=t.x509,o=i.AlgorithmIdentifier,s=i.TBSCertList;this.params=void 0,this.setByParam=function(e){this.params=e},this.sign=function(){var e=new s(this.params).tohex(),t=new ue.crypto.Signature({alg:this.params.sigalg});t.init(this.params.cakey),t.updateHex(e);var n=t.sign();this.params.sighex=n},this.getPEM=function(){return Ie(this.tohex(),"X509 CRL")},this.tohex=function(){var e=this.params;if(null==e.tbsobj&&(e.tbsobj=new s(e)),null==e.sighex&&null!=e.cakey&&this.sign(),null==e.sighex)throw new Error("sighex or cakey parameter not defined");var t=[];return t.push(e.tbsobj),t.push(new o({name:e.sigalg})),t.push(new r({hex:"00"+e.sighex})),new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&(this.params=e)},$e(ue.asn1.x509.CRL,ue.asn1.ASN1Object),ue.asn1.x509.TBSCertList=function(e){ue.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=ue.asn1,n=t.DERInteger,r=t.DERSequence,i=t.DERTaggedObject,o=(t.DERObjectIdentifier,t.x509),s=o.AlgorithmIdentifier,a=o.Time,u=o.Extensions,c=o.X500Name;this.params=null,this.setByParam=function(e){this.params=e},this.getRevCertSequence=function(){for(var e=[],t=this.params.revcert,i=0;i<t.length;i++){var o=[new n(t[i].sn),new a(t[i].date)];null!=t[i].ext&&o.push(new u(t[i].ext)),e.push(new r({array:o}))}return new r({array:e})},this.tohex=function(){var e=[],t=this.params;if(null!=t.version){var o=t.version-1,l=new n({int:o});e.push(l)}if(e.push(new s({name:t.sigalg})),e.push(new c(t.issuer)),e.push(new a(t.thisupdate)),null!=t.nextupdate&&e.push(new a(t.nextupdate)),null!=t.revcert&&e.push(this.getRevCertSequence()),null!=t.ext){var d=new u(t.ext);e.push(new i({tag:"a0",explicit:!0,obj:d}))}return new r({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.TBSCertList,ue.asn1.ASN1Object),ue.asn1.x509.CRLEntry=function(e){ue.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=ue.asn1;this.setCertSerial=function(e){this.sn=new t.DERInteger(e)},this.setRevocationDate=function(e){this.time=new t.x509.Time(e)},this.tohex=function(){var e=new t.DERSequence({array:[this.sn,this.time]});return this.TLV=e.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(void 0!==e.time&&this.setRevocationDate(e.time),void 0!==e.sn&&this.setCertSerial(e.sn))},$e(ue.asn1.x509.CRLEntry,ue.asn1.ASN1Object),ue.asn1.x509.CRLNumber=function(e){ue.asn1.x509.CRLNumber.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",null!=e&&(this.params=e)},$e(ue.asn1.x509.CRLNumber,ue.asn1.x509.Extension),ue.asn1.x509.CRLReason=function(e){ue.asn1.x509.CRLReason.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",null!=e&&(this.params=e)},$e(ue.asn1.x509.CRLReason,ue.asn1.x509.Extension),ue.asn1.x509.OCSPNonce=function(e){ue.asn1.x509.OCSPNonce.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",null!=e&&(this.params=e)},$e(ue.asn1.x509.OCSPNonce,ue.asn1.x509.Extension),ue.asn1.x509.OCSPNoCheck=function(e){ue.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",null!=e&&(this.params=e)},$e(ue.asn1.x509.OCSPNoCheck,ue.asn1.x509.Extension),ue.asn1.x509.AdobeTimeStamp=function(e){ue.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERInteger,r=t.DERBoolean,i=t.DERSequence,o=t.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var e=this.params,t=[new n(1)];return t.push(new o({uri:e.uri})),null!=e.reqauth&&t.push(new r(e.reqauth)),this.asn1ExtnValue=new i({array:t}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.AdobeTimeStamp,ue.asn1.x509.Extension),ue.asn1.x509.X500Name=function(e){ue.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=ue.asn1,n=t.x509,r=n.RDN;this.setByString=function(e,t){void 0!==t&&(this.sRule=t);var n=e.split("/");n.shift();for(var i=[],o=0;o<n.length;o++)if(n[o].match(/^[^=]+=.+$/))i.push(n[o]);else{var s=i.length-1;i[s]=i[s]+"/"+n[o]}for(o=0;o<i.length;o++)this.asn1Array.push(new r({str:i[o],rule:this.sRule}))},this.setByLdapString=function(e,t){void 0!==t&&(this.sRule=t);var r=n.X500Name.ldapToCompat(e);this.setByString(r,t)},this.setByObject=function(e,t){for(var n in void 0!==t&&(this.sRule=t),e)if(e.hasOwnProperty(n)){var i=new r({str:n+"="+e[n],rule:this.sRule});this.asn1Array?this.asn1Array.push(i):this.asn1Array=[i]}},this.setByParam=function(e){var t;void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.array?this.paramArray=e.array:void 0!==e.str?this.setByString(e.str):void 0!==e.ldapstr?this.setByLdapString(e.ldapstr):void 0!==e.hex?this.hTLV=e.hex:void 0!==e.certissuer?((t=new Qe).readCertPEM(e.certissuer),this.hTLV=t.getIssuerHex()):void 0!==e.certsubject?((t=new Qe).readCertPEM(e.certsubject),this.hTLV=t.getSubjectHex()):"object"==typeof e&&void 0===e.certsubject&&void 0===e.certissuer&&this.setByObject(e)},this.tohex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(0==this.asn1Array.length&&this.paramArray.length>0)for(var e=0;e<this.paramArray.length;e++){var n={array:this.paramArray[e]};"utf8"!=this.sRule&&(n.rule=this.sRule);var i=new r(n);this.asn1Array.push(i)}var o=new t.DERSequence({array:this.asn1Array});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.X500Name,ue.asn1.ASN1Object),ue.asn1.x509.X500Name.compatToLDAP=function(e){if("/"!==e.substr(0,1))throw"malformed input";var t=(e=e.substr(1)).split("/");return t.reverse(),t=t.map((function(e){return e.replace(/,/,"\\,")})),t.join(",")},ue.asn1.x509.X500Name.onelineToLDAP=function(e){return ue.asn1.x509.X500Name.compatToLDAP(e)},ue.asn1.x509.X500Name.ldapToCompat=function(e){for(var t=e.split(","),n=!1,r=[],i=0;t.length>0;i++){var o=t.shift();if(!0===n){var s=(r.pop()+","+o).replace(/\\,/g,",");r.push(s),n=!1}else r.push(o);"\\"===o.substr(-1,1)&&(n=!0)}return r=r.map((function(e){return e.replace("/","\\/")})),r.reverse(),"/"+r.join("/")},ue.asn1.x509.X500Name.ldapToOneline=function(e){return ue.asn1.x509.X500Name.ldapToCompat(e)},ue.asn1.x509.RDN=function(e){ue.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=ue.asn1.x509.AttributeTypeAndValue;this.setByParam=function(e){void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.str&&this.addByMultiValuedString(e.str),void 0!==e.array&&(this.paramArray=e.array)},this.addByString=function(e){this.asn1Array.push(new ue.asn1.x509.AttributeTypeAndValue({str:e,rule:this.sRule}))},this.addByMultiValuedString=function(e){for(var t=ue.asn1.x509.RDN.parseString(e),n=0;n<t.length;n++)this.addByString(t[n])},this.tohex=function(){if(0==this.asn1Array.length&&this.paramArray.length>0)for(var e=0;e<this.paramArray.length;e++){var n=this.paramArray[e];void 0!==n.rule&&"utf8"!=this.sRule&&(n.rule=this.sRule);var r=new t(n);this.asn1Array.push(r)}var i=new ue.asn1.DERSet({array:this.asn1Array});return this.TLV=i.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.RDN,ue.asn1.ASN1Object),ue.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),n=!1,r=[],i=0;t.length>0;i++){var o=t.shift();if(!0===n){var s=(r.pop()+"+"+o).replace(/\\\+/g,"+");r.push(s),n=!1}else r.push(o);"\\"===o.substr(-1,1)&&(n=!0)}var a=!1,u=[];for(i=0;r.length>0;i++){if(o=r.shift(),!0===a){var c=u.pop();o.match(/"$/)?(s=(c+"+"+o).replace(/^([^=]+)="(.*)"$/,"$1=$2"),u.push(s),a=!1):u.push(c+"+"+o)}else u.push(o);o.match(/^[^=]+="/)&&(a=!0)}return u},ue.asn1.x509.AttributeTypeAndValue=function(e){ue.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var t=ue,n=t.asn1,r=n.DERSequence,i=n.DERUTF8String,o=n.DERPrintableString,s=n.DERTeletexString,a=n.DERIA5String,u=n.DERVisibleString,c=n.DERBMPString,l=t.lang.String.isMail,d=t.lang.String.isPrintable;this.setByParam=function(e){if(void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.ds&&(this.dsType=e.ds),void 0===e.value&&void 0!==e.str){var t=e.str.match(/^([^=]+)=(.+)$/);if(!t)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.sType=t[1],this.sValue=t[2]}else this.sType=e.type,this.sValue=e.value},this.setByString=function(e,t){void 0!==t&&(this.sRule=t);var n=e.match(/^([^=]+)=(.+)$/);if(!n)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.setByAttrTypeAndValueStr(n[1],n[2])},this._getDsType=function(){var e=this.sType,t=this.sValue,n=this.sRule;return"prn"===n?"CN"==e&&l(t)?"ia5":d(t)?"prn":"utf8":"utf8"===n?"CN"==e&&l(t)?"ia5":"C"==e?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(e,t,n){void 0!==n&&(this.sRule=n),this.sType=e,this.sValue=t},this.getValueObj=function(e,t){if("utf8"==e)return new i({str:t});if("prn"==e)return new o({str:t});if("tel"==e)return new s({str:t});if("ia5"==e)return new a({str:t});if("vis"==e)return new u({str:t});if("bmp"==e)return new c({str:t});throw new Error("unsupported directory string type: type="+e+" value="+t)},this.tohex=function(){null==this.dsType&&(this.dsType=this._getDsType());var e=ue.asn1.x509.OID.atype2obj(this.sType),t=this.getValueObj(this.dsType,this.sValue),n=new r({array:[e,t]});return this.TLV=n.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.AttributeTypeAndValue,ue.asn1.ASN1Object),ue.asn1.x509.SubjectPublicKeyInfo=function(e){ue.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=ue,n=t.asn1,r=n.DERInteger,i=n.DERBitString,o=n.DERObjectIdentifier,s=n.DERSequence,a=n.ASN1Util.newObject,u=n.x509.AlgorithmIdentifier,c=t.crypto;c.ECDSA,c.DSA,this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new s({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.tohex=function(){var e=this.getASN1Object();return this.hTLV=e.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(e){try{if(e instanceof re){var t=a({seq:[{int:{bigint:e.n}},{int:{int:e.e}}]}).tohex();this.asn1AlgId=new u({name:"rsaEncryption"}),this.asn1SubjPKey=new i({hex:"00"+t})}}catch(e){}try{if(e instanceof ue.crypto.ECDSA){var n=new o({name:e.curveName});this.asn1AlgId=new u({name:"ecPublicKey",asn1params:n}),this.asn1SubjPKey=new i({hex:"00"+e.pubKeyHex})}}catch(e){}try{if(e instanceof ue.crypto.DSA){n=new a({seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}),this.asn1AlgId=new u({name:"dsa",asn1params:n});var s=new r({bigint:e.y});this.asn1SubjPKey=new i({hex:"00"+s.tohex()})}}catch(e){}},void 0!==e&&this.setPubKey(e)},$e(ue.asn1.x509.SubjectPublicKeyInfo,ue.asn1.ASN1Object),ue.asn1.x509.Time=function(e){ue.asn1.x509.Time.superclass.constructor.call(this);var t=ue.asn1,n=t.DERUTCTime,r=t.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(e){this.timeParams=e},this.setByParam=function(e){this.params=e},this.getType=function(e){return e.match(/^[0-9]{12}Z$/)?"utc":e.match(/^[0-9]{14}Z$/)?"gen":e.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":e.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var e=this.params,t=null;if("string"==typeof e&&(e={str:e}),null==e||!e.str||null!=e.type&&null!=e.type||(e.type=this.getType(e.str)),null!=e&&e.str?("utc"==e.type&&(t=new n(e.str)),"gen"==e.type&&(t=new r(e.str))):t="gen"==this.type?new r:new n,null==t)throw new Error("wrong setting for Time");return this.TLV=t.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},ue.asn1.x509.Time_bak=function(e){ue.asn1.x509.Time_bak.superclass.constructor.call(this);var t=ue.asn1,n=t.DERUTCTime,r=t.DERGeneralizedTime;this.setTimeParams=function(e){this.timeParams=e},this.tohex=function(){var e=null;return e=null!=this.timeParams?"utc"==this.type?new n(this.timeParams):new r(this.timeParams):"utc"==this.type?new n:new r,this.TLV=e.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",void 0!==e&&(void 0!==e.type?this.type=e.type:void 0!==e.str&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)},$e(ue.asn1.x509.Time,ue.asn1.ASN1Object),ue.asn1.x509.AlgorithmIdentifier=function(e){ue.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var t=ue.asn1,n=t.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw new Error("algorithm not specified");if(null!==this.nameAlg){var e=null;for(var r in n)r===this.nameAlg&&(e=n[r]);if(null!==e)return this.hTLV=e,this.hTLV}null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=t.x509.OID.name2obj(this.nameAlg));var i=[this.asn1Alg];null!==this.asn1Params&&i.push(this.asn1Params);var o=new t.DERSequence({array:i});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(void 0!==e.name&&(this.nameAlg=e.name),void 0!==e.asn1params&&(this.asn1Params=e.asn1params),void 0!==e.paramempty&&(this.paramEmpty=e.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){void 0!==this.nameAlg.name&&(this.nameAlg=this.nameAlg.name);var r=this.nameAlg.toLowerCase();"withdsa"!==r.substr(-7,7)&&"withecdsa"!==r.substr(-9,9)&&(this.asn1Params=new t.DERNull)}},$e(ue.asn1.x509.AlgorithmIdentifier,ue.asn1.ASN1Object),ue.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},ue.asn1.x509.GeneralName=function(e){ue.asn1.x509.GeneralName.superclass.constructor.call(this);var t=ue.asn1,n=t.x509,r=n.X500Name,i=n.OtherName,o=t.DERIA5String,s=(t.DERPrintableString,t.DEROctetString),a=t.DERTaggedObject,u=t.ASN1Object,c=Error;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e,t,n=this.params,l=!1;if(void 0!==n.other)e="a0",t=new i(n.other);else if(void 0!==n.rfc822)e="81",t=new o({str:n.rfc822});else if(void 0!==n.dns)e="82",t=new o({str:n.dns});else if(void 0!==n.dn)e="a4",l=!0,t="string"==typeof n.dn?new r({str:n.dn}):n.dn instanceof ue.asn1.x509.X500Name?n.dn:new r(n.dn);else if(void 0!==n.ldapdn)e="a4",l=!0,t=new r({ldapstr:n.ldapdn});else if(void 0!==n.certissuer||void 0!==n.certsubj){var d,h;e="a4",l=!0;var p=null;if(void 0!==n.certsubj?(d=!1,h=n.certsubj):(d=!0,h=n.certissuer),h.match(/^[0-9A-Fa-f]+$/),-1!=h.indexOf("-----BEGIN ")&&(p=_e(h)),null==p)throw new Error("certsubj/certissuer not cert");var f,g=new Qe;g.hex=p,f=d?g.getIssuerHex():g.getSubjectHex(),(t=new u).hTLV=f}else if(void 0!==n.uri)e="86",t=new o({str:n.uri});else{if(void 0===n.ip)throw new c("improper params");var m;e="87";var v=n.ip;try{if(v.match(/^[0-9a-f]+$/)){var y=v.length;if(8!=y&&16!=y&&32!=y&&64!=y)throw"err";m=v}else m=ke(v)}catch(e){throw new c("malformed IP address: "+n.ip+":"+e.message)}t=new s({hex:m})}return new a({tag:e,explicit:l,obj:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.GeneralName,ue.asn1.ASN1Object),ue.asn1.x509.GeneralNames=function(e){ue.asn1.x509.GeneralNames.superclass.constructor.call(this);var t=ue.asn1;this.setByParamArray=function(e){for(var n=0;n<e.length;n++){var r=new t.x509.GeneralName(e[n]);this.asn1Array.push(r)}},this.tohex=function(){return new t.DERSequence({array:this.asn1Array}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,void 0!==e&&this.setByParamArray(e)},$e(ue.asn1.x509.GeneralNames,ue.asn1.ASN1Object),ue.asn1.x509.OtherName=function(e){ue.asn1.x509.OtherName.superclass.constructor.call(this);var t=ue.asn1,n=t.DERObjectIdentifier,r=t.DERSequence,i=t.ASN1Util.newObject;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params;if(null==e.oid||null==e.value)throw new Error("oid or value not specified");var t=new n({oid:e.oid}),o=i({tag:{tag:"a0",explicit:!0,obj:e.value}});return new r({array:[t,o]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.OtherName,ue.asn1.ASN1Object),ue.asn1.x509.OID=new function(){var e=ue.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.name2oidList[t])throw"Name of ObjectIdentifier not defined: "+t;var n=this.name2oidList[t],r=new e({oid:n});return this.objCache[t]=r,r},this.atype2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];var n;if(t.match(/^\d+\.\d+\.[0-9.]+$/))n=t;else if(void 0!==this.atype2oidList[t])n=this.atype2oidList[t];else{if(void 0===this.name2oidList[t])throw new Error("AttributeType name undefined: "+t);n=this.name2oidList[t]}var r=new e({oid:n});return this.objCache[t]=r,r},this.registerOIDs=function(e){if(this.checkOIDs(e))for(var t in e)this.name2oidList[t]=e[t]},this.checkOIDs=function(e){try{var t=Object.keys(e);return 0!=t.length&&(t.map((function(e,t,n){if(!this[e].match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")}),e),!0)}catch(e){return!1}}},ue.asn1.x509.OID.oid2name=function(e){var t=ue.asn1.x509.OID.name2oidList;for(var n in t)if(t[n]==e)return n;return""},ue.asn1.x509.OID.oid2atype=function(e){var t=ue.asn1.x509.OID.atype2oidList;for(var n in t)if(t[n]==e)return n;return e},ue.asn1.x509.OID.name2oid=function(e){if(e.match(/^[0-9.]+$/))return e;var t=ue.asn1.x509.OID.name2oidList;return void 0===t[e]?"":t[e]},ue.asn1.x509.X509Util={},ue.asn1.x509.X509Util.newCertPEM=function(e){var t=ue.asn1.x509;return t.TBSCertificate,new(0,t.Certificate)(e).getPEM()},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.cms&&ue.asn1.cms||(ue.asn1.cms={}),ue.asn1.cms.Attribute=function(e){var t=Error,n=ue.asn1,r=n.DERSequence,i=n.DERSet,o=n.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(e){this.params=e},this.getValueArray=function(){throw new t("not yet implemented abstract")},this.tohex=function(){var e=new o({oid:this.typeOid}),t=new i({array:this.getValueArray()});return new r({array:[e,t]}).tohex()},this.getEncodedHex=function(){return this.tohex()}},$e(ue.asn1.cms.Attribute,ue.asn1.ASN1Object),ue.asn1.cms.ContentType=function(e){var t=ue.asn1;t.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){return[new t.DERObjectIdentifier(this.params.type)]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.ContentType,ue.asn1.cms.Attribute),ue.asn1.cms.MessageDigest=function(e){var t=ue.asn1,n=t.DEROctetString;t.cms.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){return[new n(this.params)]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.MessageDigest,ue.asn1.cms.Attribute),ue.asn1.cms.SigningTime=function(e){var t=ue.asn1;t.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){return[new t.x509.Time(this.params)]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SigningTime,ue.asn1.cms.Attribute),ue.asn1.cms.SigningCertificate=function(e){var t=Error,n=ue,r=n.asn1,i=r.DERSequence,o=r.cms,s=o.ESSCertID;n.crypto,o.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(null==this.params||null==this.params||null==this.params.array)throw new t("parameter 'array' not specified");for(var n=this.params.array,r=[],o=0;o<n.length;o++){var a=n[o];0!=e.hasis||"string"!=typeof a||-1==a.indexOf("-----BEGIN")&&!de.isASN1HEX(a)||(a={cert:a}),0!=a.hasis&&0==e.hasis&&(a.hasis=!1),r.push(new s(a))}var u=new i({array:r});return[new i({array:[u]})]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SigningCertificate,ue.asn1.cms.Attribute),ue.asn1.cms.ESSCertID=function(e){ue.asn1.cms.ESSCertID.superclass.constructor.call(this);var t=Error,n=ue,r=n.asn1,i=r.DEROctetString,o=r.DERSequence,s=r.cms.IssuerSerial;this.params=null,this.getCertHash=function(e,r){if(null!=e.hash)return e.hash;if("string"==typeof e&&-1==e.indexOf("-----BEGIN")&&!de.isASN1HEX(e))return e;var i,o,s;if("string"==typeof e)i=e;else{if(null==e.cert)throw new t("hash nor cert unspecified");i=e.cert}if(o=-1!=i.indexOf("-----BEGIN")?_e(i):i,"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?o=_e(e):de.isASN1HEX(e)&&(o=e)),null!=e.alg)s=e.alg;else{if(null==r)throw new t("hash alg unspecified");s=r}return n.crypto.Util.hashHex(o,s)},this.tohex=function(){var e=this.params,t=this.getCertHash(e,"sha1"),n=[];return n.push(new i({hex:t})),("string"==typeof e&&-1!=e.indexOf("-----BEGIN")||null!=e.cert&&0!=e.hasis||null!=e.issuer&&null!=e.serial)&&n.push(new s(e)),new o({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.ESSCertID,ue.asn1.ASN1Object),ue.asn1.cms.SigningCertificateV2=function(e){var t=Error,n=ue,r=n.asn1,i=r.DERSequence,o=(r.x509,r.cms),s=o.ESSCertIDv2;n.crypto,o.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(null==this.params||null==this.params||null==this.params.array)throw new t("parameter 'array' not specified");for(var n=this.params.array,r=[],o=0;o<n.length;o++){var a=n[o];null==e.alg&&0!=e.hasis||"string"!=typeof a||-1==a.indexOf("-----BEGIN")&&!de.isASN1HEX(a)||(a={cert:a}),null==a.alg&&null!=e.alg&&(a.alg=e.alg),0!=a.hasis&&0==e.hasis&&(a.hasis=!1),r.push(new s(a))}var u=new i({array:r});return[new i({array:[u]})]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SigningCertificateV2,ue.asn1.cms.Attribute),ue.asn1.cms.ESSCertIDv2=function(e){ue.asn1.cms.ESSCertIDv2.superclass.constructor.call(this),Error;var t=ue.asn1,n=t.DEROctetString,r=t.DERSequence,i=t.cms.IssuerSerial,o=t.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var e=this.params,t=this.getCertHash(e,"sha256"),s=[];return null!=e.alg&&"sha256"!=e.alg&&s.push(new o({name:e.alg})),s.push(new n({hex:t})),("string"==typeof e&&-1!=e.indexOf("-----BEGIN")||null!=e.cert&&0!=e.hasis||null!=e.issuer&&null!=e.serial)&&s.push(new i(e)),new r({array:s}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.ESSCertIDv2,ue.asn1.cms.ESSCertID),ue.asn1.cms.IssuerSerial=function(e){var t=Error,n=ue.asn1,r=n.DERInteger,i=n.DERSequence,o=n.cms,s=n.x509.GeneralNames,a=Qe;o.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(e){this.params=e},this.tohex=function(){var e,n,o=this.params;if("string"==typeof o&&-1!=o.indexOf("-----BEGIN")||null!=o.cert){var u;u=null!=o.cert?o.cert:o;var c=new a;c.readCertPEM(u),e=c.getIssuer(),n={hex:c.getSerialNumberHex()}}else{if(null==o.issuer||!o.serial)throw new t("cert or issuer and serial parameter not specified");e=o.issuer,n=o.serial}var l=new s([{dn:e}]),d=new r(n);return new i({array:[l,d]}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.IssuerSerial,ue.asn1.ASN1Object),ue.asn1.cms.SignerIdentifier=function(e){var t=ue.asn1,n=(t.DERInteger,t.DERSequence,t.cms),r=n.IssuerAndSerialNumber,i=n.SubjectKeyIdentifier;t.x509.X500Name,Error,n.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if("isssn"==e.type)return new r(e).tohex();if("skid"==e.type)return new i(e).tohex();throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SignerIdentifier,ue.asn1.ASN1Object),ue.asn1.cms.IssuerAndSerialNumber=function(e){var t=ue.asn1,n=t.DERInteger,r=t.DERSequence,i=t.cms,o=t.x509.X500Name,s=Qe,a=Error;i.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e,t,i=this.params;if("string"==typeof i&&-1!=i.indexOf("-----BEGIN")||null!=i.cert){var u;u=null!=i.cert?i.cert:i;var c=new s;c.readCertPEM(u),e=c.getIssuer(),t={hex:c.getSerialNumberHex()}}else{if(null==i.issuer||!i.serial)throw new a("cert or issuer and serial parameter not specified");e=i.issuer,t=i.serial}var l=new o(e),d=new n(t);return new r({array:[l,d]}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.IssuerAndSerialNumber,ue.asn1.ASN1Object),ue.asn1.cms.SubjectKeyIdentifier=function(e){var t=ue.asn1,n=(t.DERInteger,t.DERSequence,t.ASN1Util.newObject),r=t.cms,i=(r.IssuerAndSerialName,r.SubjectKeyIdentifier,t.x509.X500Name,Qe),o=Error;r.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var e,t=this.params;if(null==t.cert&&null==t.skid)throw new o("property cert nor skid undefined");return null!=t.cert?e=new i(t.cert).getExtSubjectKeyIdentifier().kid.hex:null!=t.skid&&(e=t.skid),n({tag:{tage:"a0",obj:{octstr:{hex:e}}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SubjectKeyIdentifier,ue.asn1.ASN1Object),ue.asn1.cms.AttributeList=function(e){var t=Error,n=ue.asn1,r=n.DERSet,i=n.cms;i.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params;if(null!=this.hTLV)return this.hTLV;var n=!0;null!=e.sortflag&&(n=e.sortflag);for(var o=e.array,s=[],a=0;a<o.length;a++){var u=o[a],c=u.attr;if("contentType"==c)s.push(new i.ContentType(u));else if("messageDigest"==c)s.push(new i.MessageDigest(u));else if("signingTime"==c)s.push(new i.SigningTime(u));else if("signingCertificate"==c)s.push(new i.SigningCertificate(u));else if("signingCertificateV2"==c)s.push(new i.SigningCertificateV2(u));else if("signaturePolicyIdentifier"==c)s.push(new ue.asn1.cades.SignaturePolicyIdentifier(u));else{if("signatureTimeStamp"!=c&&"timeStampToken"!=c)throw new t("unknown attr: "+c);s.push(new ue.asn1.cades.SignatureTimeStamp(u))}}var l=new r({array:s,sortflag:n});return this.hTLV=l.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.AttributeList,ue.asn1.ASN1Object),ue.asn1.cms.SignerInfo=function(e){var t=Error,n=ue,r=n.asn1,i=r.DERInteger,o=r.DEROctetString,s=r.DERSequence,a=r.DERTaggedObject,u=r.cms,c=u.SignerIdentifier,l=u.AttributeList,d=(u.ContentType,u.EncapsulatedContentInfo,u.MessageDigest,u.SignedData,r.x509.AlgorithmIdentifier),h=n.crypto,p=We;u.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var e=this.params,t=e.sigalg,n=new l(e.sattrs).tohex(),r=p.getKey(e.signkey),i=new h.Signature({alg:t});i.init(r),i.updateHex(n);var o=i.sign();e.sighex=o},this.tohex=function(){var e=this.params,n=[];if(n.push(new i({int:e.version})),n.push(new c(e.id)),n.push(new d({name:e.hashalg})),null!=e.sattrs){var r=new l(e.sattrs);try{n.push(new a({tag:"a0",explicit:!1,obj:r}))}catch(e){throw new t("si sattr error: "+e)}}if(null!=e.sigalgfield?n.push(new d({name:e.sigalgfield})):n.push(new d({name:e.sigalg})),null==e.sighex&&null!=e.signkey&&this.sign(),n.push(new o({hex:e.sighex})),null!=e.uattrs){r=new l(e.uattrs);try{n.push(new a({tag:"a1",explicit:!1,obj:r}))}catch(e){throw new t("si uattr error: "+e)}}return new s({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SignerInfo,ue.asn1.ASN1Object),ue.asn1.cms.EncapsulatedContentInfo=function(e){var t=ue.asn1,n=t.DERTaggedObject,r=t.DERSequence,i=t.DERObjectIdentifier,o=t.DEROctetString;t.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];if(t.push(new i(e.type)),null!=e.content&&(null!=e.content.hex||null!=e.content.str)&&1!=e.isDetached){var s=new o(e.content),a=new n({tag:"a0",explicit:!0,obj:s});t.push(a)}return new r({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.EncapsulatedContentInfo,ue.asn1.ASN1Object),ue.asn1.cms.ContentInfo=function(e){var t=ue.asn1,n=t.DERTaggedObject,r=t.DERSequence,i=t.DERObjectIdentifier;t.x509.OID.name2obj,ue.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];t.push(new i(e.type));var o=new n({tag:"a0",explicit:!0,obj:e.obj});return t.push(o),new r({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.ContentInfo,ue.asn1.ASN1Object),ue.asn1.cms.SignedData=function(e){Error;var t=ue.asn1,n=(t.ASN1Object,t.DERInteger),r=t.DERSet,i=t.DERSequence,o=(t.DERTaggedObject,t.cms),s=o.EncapsulatedContentInfo,a=o.SignerInfo,u=o.ContentInfo,c=o.CertificateSet,l=o.RevocationInfoChoices,d=t.x509.AlgorithmIdentifier;ue.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var e=this.params;this._setDigestAlgs(e),this._setContentTypeByEContent(e),this._setMessageDigestByEContent(e),this._setSignerInfoVersion(e),this._setSignedDataVersion(e)},this._setDigestAlgs=function(e){for(var t={},n=e.sinfos,r=0;r<n.length;r++)t[n[r].hashalg]=1;e.hashalgs=Object.keys(t).sort()},this._setContentTypeByEContent=function(e){for(var t=e.econtent.type,n=e.sinfos,r=0;r<n.length;r++){var i=n[r];this._getAttrParamByName(i,"contentType").type=t}},this._setMessageDigestByEContent=function(e){var t=e.econtent,n=(e.econtent.type,t.content.hex);null==n&&"data"==t.type&&null!=t.content.str&&(n=we(t.content.str));for(var r=e.sinfos,i=0;i<r.length;i++){var o=r[i],s=o.hashalg,a=this._getAttrParamByName(o,"messageDigest"),u=ue.crypto.Util.hashHex(n,s);a.hex=u}},this._getAttrParamByName=function(e,t){for(var n=e.sattrs.array,r=0;r<n.length;r++)if(n[r].attr==t)return n[r]},this._setSignerInfoVersion=function(e){for(var t=e.sinfos,n=0;n<t.length;n++){var r=t[n],i=1;"skid"==r.id.type&&(i=3),r.version=i}},this._setSignedDataVersion=function(e){var t=this._getSignedDataVersion(e);e.version=t},this._getSignedDataVersion=function(e){if(null!=e.revinfos)for(var t=e.revinfos,n=0;n<t.length;n++)if(null!=t[n].ocsp)return 5;var r=e.sinfos;for(n=0;n<r.length;n++)if(3==e.sinfos[n].version)return 3;return"data"!=e.econtent.type?3:1},this.tohex=function(){var e=this.params;null!=this.getEncodedHexPrepare&&this.getEncodedHexPrepare(),1!=e.fixed&&this.checkAndFixParam();var t=[];t.push(new n({int:e.version}));for(var o=[],u=0;u<e.hashalgs.length;u++){var h=e.hashalgs[u];o.push(new d({name:h}))}t.push(new r({array:o})),t.push(new s(e.econtent)),null!=e.certs&&t.push(new c(e.certs)),null!=e.revinfos&&t.push(new l(e.revinfos));var p=[];for(u=0;u<e.sinfos.length;u++){var f=e.sinfos[u];p.push(new a(f))}return t.push(new r({array:p})),new i({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){return new u({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SignedData,ue.asn1.ASN1Object),ue.asn1.cms.CertificateSet=function(e){ue.asn1.cms.CertificateSet.superclass.constructor.call(this);var t=Error,n=ue.asn1,r=n.DERTaggedObject,i=n.DERSet,o=n.ASN1Object;this.params=null,this.tohex=function(){var e,n=this.params,s=[];if(n instanceof Array)e=n;else{if(null==n.array)throw new t("cert array not specified");e=n.array}for(var a=0;a<e.length;a++){var u=_e(e[a]),c=new o;c.hTLV=u,s.push(c)}var l={array:s};0==n.sortflag&&(l.sortflag=!1);var d=new i(l);return new r({tag:"a0",explicit:!1,obj:d}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.CertificateSet,ue.asn1.ASN1Object),ue.asn1.cms.RevocationInfoChoices=function(e){ue.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(!e instanceof Array)throw new Error("params is not array");for(var t=[],n=0;n<e.length;n++)t.push(new ue.asn1.cms.RevocationInfoChoice(e[n]));return ue.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:t}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.RevocationInfoChoices,ue.asn1.ASN1Object),ue.asn1.cms.RevocationInfoChoice=function(e){ue.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(null!=e.crl&&"string"==typeof e.crl){var t=e.crl;return-1!=e.crl.indexOf("-----BEGIN")&&(t=_e(e.crl)),t}if(null!=e.ocsp)return ue.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new ue.asn1.cms.OtherRevocationFormat(e)}}).tohex();throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.RevocationInfoChoice,ue.asn1.ASN1Object),ue.asn1.cms.OtherRevocationFormat=function(e){ue.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var t=Error,n=ue,r=n.asn1.ASN1Util.newObject,i=n.lang.String.isHex;this.params=null,this.tohex=function(){var e=this.params;if(null==e.ocsp)throw new t("property ocsp not specified");if(!i(e.ocsp)||!de.isASN1HEX(e.ocsp))throw new t("ocsp value not ASN.1 hex string");return r({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:e.ocsp}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.OtherRevocationFormat,ue.asn1.ASN1Object),ue.asn1.cms.CMSUtil=new function(){},ue.asn1.cms.CMSUtil.newSignedData=function(e){return new ue.asn1.cms.SignedData(e)},ue.asn1.cms.CMSUtil.verifySignedData=function(e){var t=ue,n=t.asn1,r=n.cms,i=(r.SignerInfo,r.SignedData,r.SigningTime,r.SigningCertificate,r.SigningCertificateV2,n.cades.SignaturePolicyIdentifier,t.lang.String.isHex),o=de,s=o.getVbyList,a=o.getTLVbyList,u=o.getIdxbyList,c=o.getChildIdx,l=o.getTLV,d=o.oidname,h=t.crypto.Util.hashHex;void 0===e.cms&&i(e.cms);var p=e.cms,f=function(e,t){var n=t.idx;t.signerid_issuer1=a(e,n,[1,0],"30"),t.signerid_serial1=s(e,n,[1,1],"02"),t.hashalg=d(s(e,n,[2,0],"06"));var r=u(e,n,[3],"a0");t.idxSignedAttrs=r,g(e,t,r);var i=c(e,n).length;if(i<6)throw"malformed SignerInfo";t.sigalg=d(s(e,n,[i-2,0],"06")),t.sigval=s(e,n,[i-1],"04")},g=function(e,t,n){var r=c(e,n);t.signedAttrIdxList=r;for(var i=0;i<r.length;i++){var o,a=r[i],u=s(e,a,[0],"06");"2a864886f70d010905"===u?(o=Se(s(e,a,[1,0])),t.saSigningTime=o):"2a864886f70d010904"===u&&(o=s(e,a,[1,0],"04"),t.saMessageDigest=o)}},m=function(e,t,n,r){n.verifyDetail={};var i=n.verifyDetail,o=t.parse.econtent,s=n.hashalg,a=n.saMessageDigest;i.validMessageDigest=!1,h(o,s)===a&&(i.validMessageDigest=!0),function(e,t,n,r){var i,o=t.parse.certsIdx;if(void 0===t.certs){i=[],t.certkeys=[];for(var s=c(e,o),a=0;a<s.length;a++){var u=l(e,s[a]),d=new Qe;d.readCertHex(u),i[a]=d,t.certkeys[a]=d.getPublicKey()}t.certs=i}else i=t.certs;for(t.cccc=i.length,t.cccci=s.length,a=0;a<i.length;a++){var h=d.getIssuerHex(),p=d.getSerialNumberHex();n.signerid_issuer1===h&&n.signerid_serial1===p&&(n.certkey_idx=a)}}(e,t,n),i.validSignatureValue=!1;var u=n.sigalg,d="31"+l(e,n.idxSignedAttrs).substr(2);n.signedattrshex=d;var p=t.certs[n.certkey_idx].getPublicKey(),f=new ue.crypto.Signature({alg:u});f.init(p),f.updateHex(d);var g=f.verify(n.sigval);i.validSignatureValue_isValid=g,!0===g&&(i.validSignatureValue=!0),n.isValid=!1,i.validMessageDigest&&i.validSignatureValue&&(n.isValid=!0)},v={isValid:!1,parse:{}};return function(e,t){if("2a864886f70d010702"!==s(e,0,[0],"06"))return t;t.cmsType="signedData",t.econtent=s(e,0,[1,0,2,1,0]),function(e,t){for(var n,r=3;r<6;r++)if(void 0!==(n=u(e,0,[1,0,r]))){var i=e.substr(n,2);"a0"===i&&(t.certsIdx=n),"a1"===i&&(t.revinfosIdx=n),"31"===i&&(t.signerinfosIdx=n)}}(e,t),t.signerInfos=[],function(e,t){var n=t.signerinfosIdx;if(void 0!==n){var r=c(e,n);t.signerInfoIdxList=r;for(var i=0;i<r.length;i++){var o={idx:r[i]};f(e,o),t.signerInfos.push(o)}}}(e,t)}(p,v.parse),function(e,t){for(var n=t.parse.signerInfos,r=n.length,i=!0,o=0;o<r;o++){var s=n[o];m(e,t,s),s.isValid||(i=!1)}t.isValid=i}(p,v),v},ue.asn1.cms.CMSParser=function(){var e=Error,t=Qe,n=new t,r=de,i=r.getV,o=r.getTLV,s=(r.getIdxbyList,r.getTLVbyList),a=r.getTLVbyListEx,u=r.getVbyList,c=r.getVbyListEx,l=r.getChildIdx;this.getCMSSignedData=function(e){var t=s(e,0,[1,0]);return this.getSignedData(t)},this.getSignedData=function(e){var t=l(e,0),n={},r=i(e,t[0]),s=parseInt(r,16);n.version=s;var u=o(e,t[1]);n.hashalgs=this.getHashAlgArray(u);var c=o(e,t[2]);n.econtent=this.getEContent(c);var d=a(e,0,["[0]"]);null!=d&&(n.certs=this.getCertificateSet(d)),a(e,0,["[1]"]);var h=a(e,0,[3]);return n.sinfos=this.getSignerInfos(h),n},this.getHashAlgArray=function(e){for(var n=l(e,0),r=new t,i=[],s=0;s<n.length;s++){var a=o(e,n[s]),u=r.getAlgorithmIdentifierName(a);i.push(u)}return i},this.getEContent=function(e){var t={},n=u(e,0,[0]),r=u(e,0,[1,0]);return t.type=ue.asn1.x509.OID.oid2name(de.hextooidstr(n)),t.content={hex:r},t},this.getSignerInfos=function(e){for(var t=[],n=l(e,0),r=0;r<n.length;r++){var i=o(e,n[r]),s=this.getSignerInfo(i);t.push(s)}return t},this.getSignerInfo=function(e){var t={},i=l(e,0),s=r.getInt(e,i[0],-1);-1!=s&&(t.version=s);var u=o(e,i[1]),d=this.getIssuerAndSerialNumber(u);t.id=d;var h=o(e,i[2]),p=n.getAlgorithmIdentifierName(h);t.hashalg=p;var f=a(e,0,["[0]"]);if(null!=f){var g=this.getAttributeList(f);t.sattrs=g}var m=a(e,0,[3]),v=n.getAlgorithmIdentifierName(m);t.sigalg=v;var y=c(e,0,[4]);t.sighex=y;var S=a(e,0,["[1]"]);if(null!=S){var b=this.getAttributeList(S);t.uattrs=b}return t},this.getSignerIdentifier=function(e){if("30"==e.substr(0,2))return this.getIssuerAndSerialNumber(e);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(e){var t={type:"isssn"},r=l(e,0),s=o(e,r[0]);t.issuer=n.getX500Name(s);var a=i(e,r[1]);return t.serial={hex:a},t},this.getAttributeList=function(e){for(var t=[],n=l(e,0),r=0;r<n.length;r++){var i=o(e,n[r]),s=this.getAttribute(i);t.push(s)}return{array:t}},this.getAttribute=function(e){var t={},n=l(e,0),i=r.getOID(e,n[0]),s=ue.asn1.x509.OID.oid2name(i);t.attr=s;var a=o(e,n[1]),u=l(a,0);if(1==u.length)t.valhex=o(a,u[0]);else{for(var c=[],d=0;d<u.length;d++)c.push(o(a,u[d]));t.valhex=c}return"contentType"==s?this.setContentType(t):"messageDigest"==s?this.setMessageDigest(t):"signingTime"==s?this.setSigningTime(t):"signingCertificate"==s?this.setSigningCertificate(t):"signingCertificateV2"==s?this.setSigningCertificateV2(t):"signaturePolicyIdentifier"==s&&this.setSignaturePolicyIdentifier(t),t},this.setContentType=function(e){var t=r.getOIDName(e.valhex,0,null);null!=t&&(e.type=t,delete e.valhex)},this.setSigningTime=function(e){var t=Se(i(e.valhex,0));e.str=t,delete e.valhex},this.setMessageDigest=function(e){var t=i(e.valhex,0);e.hex=t,delete e.valhex},this.setSigningCertificate=function(e){var t=l(e.valhex,0);if(t.length>0){for(var n=o(e.valhex,t[0]),r=l(n,0),i=[],s=0;s<r.length;s++){var a=o(n,r[s]),u=this.getESSCertID(a);i.push(u)}e.array=i}if(t.length>1){var c=o(e.valhex,t[1]);e.polhex=c}delete e.valhex},this.setSignaturePolicyIdentifier=function(e){var n=l(e.valhex,0);if(n.length>0){var s=r.getOID(e.valhex,n[0]);e.oid=s}if(n.length>1){var a=new t,u=l(e.valhex,n[1]),c=o(e.valhex,u[0]),d=a.getAlgorithmIdentifierName(c);e.alg=d;var h=i(e.valhex,u[1]);e.hash=h}delete e.valhex},this.setSigningCertificateV2=function(e){var t=l(e.valhex,0);if(t.length>0){for(var n=o(e.valhex,t[0]),r=l(n,0),i=[],s=0;s<r.length;s++){var a=o(n,r[s]),u=this.getESSCertIDv2(a);i.push(u)}e.array=i}if(t.length>1){var c=o(e.valhex,t[1]);e.polhex=c}delete e.valhex},this.getESSCertID=function(e){var t={},n=l(e,0);if(n.length>0){var r=i(e,n[0]);t.hash=r}if(n.length>1){var s=o(e,n[1]),a=this.getIssuerSerial(s);null!=a.serial&&(t.serial=a.serial),null!=a.issuer&&(t.issuer=a.issuer)}return t},this.getESSCertIDv2=function(t){var r={},s=l(t,0);if(s.length<1||3<s.length)throw new e("wrong number of elements");var a=0;if("30"==t.substr(s[0],2)){var u=o(t,s[0]);r.alg=n.getAlgorithmIdentifierName(u),a++}else r.alg="sha256";var c=i(t,s[a]);if(r.hash=c,s.length>a+1){var d=o(t,s[a+1]),h=this.getIssuerSerial(d);r.issuer=h.issuer,r.serial=h.serial}return r},this.getIssuerSerial=function(e){var t={},r=l(e,0),s=o(e,r[0]),a=n.getGeneralNames(s)[0].dn;t.issuer=a;var u=i(e,r[1]);return t.serial={hex:u},t},this.getCertificateSet=function(e){for(var t=l(e,0),n=[],r=0;r<t.length;r++){var i=o(e,t[r]);if("30"==i.substr(0,2)){var s=Ie(i,"CERTIFICATE");n.push(s)}}return{array:n,sortflag:!1}}},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.tsp&&ue.asn1.tsp||(ue.asn1.tsp={}),ue.asn1.tsp.TimeStampToken=function(e){var t=ue.asn1.tsp;t.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var e=new t.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=e.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.TimeStampToken,ue.asn1.cms.SignedData),ue.asn1.tsp.TSTInfo=function(e){Error;var t=ue.asn1,n=t.DERSequence,r=t.DERInteger,i=t.DERBoolean,o=t.DERGeneralizedTime,s=t.DERObjectIdentifier,a=t.DERTaggedObject,u=t.tsp,c=u.MessageImprint,l=u.Accuracy,d=(t.x509.X500Name,t.x509.GeneralName);if(u.TSTInfo.superclass.constructor.call(this),this.dVersion=new r({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var e=[this.dVersion];if(null==this.dPolicy)throw new Error("policy shall be specified.");if(e.push(this.dPolicy),null==this.dMessageImprint)throw new Error("messageImprint shall be specified.");if(e.push(this.dMessageImprint),null==this.dSerial)throw new Error("serialNumber shall be specified.");if(e.push(this.dSerial),null==this.dGenTime)throw new Error("genTime shall be specified.");e.push(this.dGenTime),null!=this.dAccuracy&&e.push(this.dAccuracy),null!=this.dOrdering&&e.push(this.dOrdering),null!=this.dNonce&&e.push(this.dNonce),null!=this.dTsa&&e.push(this.dTsa);var t=new n({array:e});return this.hTLV=t.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e){if("string"==typeof e.policy){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new s({oid:e.policy})}void 0!==e.messageImprint&&(this.dMessageImprint=new c(e.messageImprint)),void 0!==e.serial&&(this.dSerial=new r(e.serial)),void 0!==e.genTime&&(this.dGenTime=new o(e.genTime)),void 0!==e.accuracy&&(this.dAccuracy=new l(e.accuracy)),void 0!==e.ordering&&1==e.ordering&&(this.dOrdering=new i),void 0!==e.nonce&&(this.dNonce=new r(e.nonce)),void 0!==e.tsa&&(this.dTsa=new a({tag:"a0",explicit:!0,obj:new d({dn:e.tsa})}))}},$e(ue.asn1.tsp.TSTInfo,ue.asn1.ASN1Object),ue.asn1.tsp.Accuracy=function(e){var t=ue.asn1,n=t.ASN1Util.newObject;t.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];return null!=e.seconds&&"number"==typeof e.seconds&&t.push({int:e.seconds}),null!=e.millis&&"number"==typeof e.millis&&t.push({tag:{tagi:"80",obj:{int:e.millis}}}),null!=e.micros&&"number"==typeof e.micros&&t.push({tag:{tagi:"81",obj:{int:e.micros}}}),n({seq:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.Accuracy,ue.asn1.ASN1Object),ue.asn1.tsp.MessageImprint=function(e){var t=ue.asn1,n=t.DERSequence,r=t.DEROctetString,i=t.x509.AlgorithmIdentifier;t.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=new i({name:e.alg}),o=new r({hex:e.hash});return new n({array:[t,o]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.tsp.MessageImprint,ue.asn1.ASN1Object),ue.asn1.tsp.TimeStampReq=function(e){var t=ue.asn1,n=t.DERSequence,r=t.DERInteger,i=t.DERBoolean,o=(t.ASN1Object,t.DERObjectIdentifier),s=t.tsp,a=s.MessageImprint;s.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];return t.push(new r({int:1})),e.messageImprint instanceof ue.asn1.ASN1Object?t.push(e.messageImprint):t.push(new a(e.messageImprint)),null!=e.policy&&t.push(new o(e.policy)),null!=e.nonce&&t.push(new r(e.nonce)),1==e.certreq&&t.push(new i),new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.TimeStampReq,ue.asn1.ASN1Object),ue.asn1.tsp.TimeStampResp=function(e){var t=ue.asn1,n=t.DERSequence,r=(t.ASN1Object,t.tsp),i=r.PKIStatusInfo;r.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,o=[];if(null!=e.econtent||null!=e.tst)if(null!=e.statusinfo?o.push(new i(e.statusinfo)):o.push(new i("granted")),null!=e.econtent)o.push(new r.TimeStampToken(e).getContentInfo());else{if(!(e.tst instanceof t.ASN1Object))throw new Error("improper member tst value");o.push(e.tst)}else{if(null==e.statusinfo)throw new Error("parameter for token nor statusinfo not specified");o.push(new i(e.statusinfo))}return new n({array:o}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.TimeStampResp,ue.asn1.ASN1Object),ue.asn1.tsp.PKIStatusInfo=function(e){var t=Error,n=ue.asn1,r=n.DERSequence,i=n.tsp,o=i.PKIStatus,s=i.PKIFreeText,a=i.PKIFailureInfo;i.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,n=[];if("string"==typeof e)n.push(new o(e));else{if(null==e.status)throw new t("property 'status' unspecified");n.push(new o(e.status)),null!=e.statusstr&&n.push(new s(e.statusstr)),null!=e.failinfo&&n.push(new a(e.failinfo))}return new r({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.PKIStatusInfo,ue.asn1.ASN1Object),ue.asn1.tsp.PKIStatus=function(e){var t=Error,n=ue.asn1,r=n.DERInteger;n.tsp.PKIStatus.superclass.constructor.call(this);var i={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var e,n=this.params;if("string"==typeof n)try{e=i[n]}catch(e){throw new t("undefined name: "+n)}else{if("number"!=typeof n)throw new t("unsupported params");e=n}return new r({int:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.PKIStatus,ue.asn1.ASN1Object),ue.asn1.tsp.PKIFreeText=function(e){var t=Error,n=ue.asn1,r=n.DERSequence,i=n.DERUTF8String;n.tsp.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(!e instanceof Array)throw new t("wrong params: not array");for(var n=[],o=0;o<e.length;o++)n.push(new i({str:e[o]}));return new r({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.PKIFreeText,ue.asn1.ASN1Object),ue.asn1.tsp.PKIFailureInfo=function(e){var t=Error,n=ue.asn1,r=n.DERBitString,i=n.tsp.PKIFailureInfo,o={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};i.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var e=this.params,n=0;if("number"==typeof e&&0<=e&&e<=25){for(var r=(n|=1<<e).toString(2),i="",s=r.length-1;s>=0;s--)i+=r[s];return i}if("string"==typeof e&&null!=o[e])return qe([e],o);if("object"==typeof e&&null!=e.length)return qe(e,o);throw new t("wrong params")},this.tohex=function(){this.params;var e=this.getBinValue();return new r({bin:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.PKIFailureInfo,ue.asn1.ASN1Object),ue.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(e,t){throw"not implemented yet"}},ue.asn1.tsp.SimpleTSAAdapter=function(e){var t=ue,n=t.asn1.tsp,r=t.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(e,t){var i=r(e,t);this.params.econtent.content.messageImprint={alg:t,hash:i},this.params.econtent.content.serial={int:this.serial++};var o=Math.floor(1e9*Math.random());return this.params.econtent.content.nonce={int:o},new n.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},$e(ue.asn1.tsp.SimpleTSAAdapter,ue.asn1.tsp.AbstractTSAAdapter),ue.asn1.tsp.FixedTSAAdapter=function(e){var t=ue,n=t.asn1.tsp,r=t.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(e,t){var i=r(e,t);return this.params.econtent.content.messageImprint={alg:t,hash:i},new n.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},$e(ue.asn1.tsp.FixedTSAAdapter,ue.asn1.tsp.AbstractTSAAdapter),ue.asn1.tsp.TSPUtil=new function(){},ue.asn1.tsp.TSPUtil.newTimeStampToken=function(e){return new ue.asn1.tsp.TimeStampToken(e)},ue.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){return(new ue.asn1.tsp.TSPParser).getTimeStampReq(e)},ue.asn1.tsp.TSPUtil.parseMessageImprint=function(e){return(new ue.asn1.tsp.TSPParser).getMessageImprint(e)},ue.asn1.tsp.TSPParser=function(){Error;var e=new Qe,t=de,n=t.getV,r=t.getTLV,i=t.getIdxbyList,o=(t.getTLVbyListEx,t.getChildIdx),s=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],a={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(e){var t=o(e,0);if(1==t.length)return this.getPKIStatusInfo(r(e,t[0]));if(t.length>1){var n=this.getPKIStatusInfo(r(e,t[0])),i=r(e,t[1]),s=this.getToken(i);return s.statusinfo=n,s}},this.getToken=function(e){var t=(new ue.asn1.cms.CMSParser).getCMSSignedData(e);return this.setTSTInfo(t),t},this.setTSTInfo=function(e){var t=e.econtent;if("tstinfo"==t.type){var n=t.content.hex,r=this.getTSTInfo(n);t.content=r}},this.getTSTInfo=function(t){var i={},s=o(t,0),a=n(t,s[1]);i.policy=Be(a);var u=r(t,s[2]);i.messageImprint=this.getMessageImprint(u);var c=n(t,s[3]);i.serial={hex:c};var l=n(t,s[4]);i.genTime={str:Se(l)};var d=0;if(s.length>5&&"30"==t.substr(s[5],2)){var h=r(t,s[5]);i.accuracy=this.getAccuracy(h),d++}if(s.length>5+d&&"01"==t.substr(s[5+d],2)&&("ff"==n(t,s[5+d])&&(i.ordering=!0),d++),s.length>5+d&&"02"==t.substr(s[5+d],2)){var p=n(t,s[5+d]);i.nonce={hex:p},d++}if(s.length>5+d&&"a0"==t.substr(s[5+d],2)){var f=r(t,s[5+d]);f="30"+f.substr(2),pGeneralNames=e.getGeneralNames(f);var g=pGeneralNames[0].dn;i.tsa=g,d++}if(s.length>5+d&&"a1"==t.substr(s[5+d],2)){var m=r(t,s[5+d]);m="30"+m.substr(2);var v=e.getExtParamArray(m);i.ext=v,d++}return i},this.getAccuracy=function(e){for(var t={},r=o(e,0),i=0;i<r.length;i++){var s=e.substr(r[i],2),a=n(e,r[i]),u=parseInt(a,16);"02"==s?t.seconds=u:"80"==s?t.millis=u:"81"==s&&(t.micros=u)}return t},this.getMessageImprint=function(e){if("30"!=e.substr(0,2))throw new Error("head of messageImprint hex shall be x30");var r={},s=(o(e,0),i(e,0,[0,0])),a=n(e,s),u=t.hextooidstr(a),c=ue.asn1.x509.OID.oid2name(u);if(""==c)throw new Error("hashAlg name undefined: "+u);var l=c,d=i(e,0,[1]);return r.alg=l,r.hash=n(e,d),r},this.getPKIStatusInfo=function(e){var t={},i=o(e,0),a=0;try{var u=n(e,i[0]),c=parseInt(u,16);t.status=s[c]}catch(e){}if(i.length>1&&"30"==e.substr(i[1],2)){var l=r(e,i[1]);t.statusstr=this.getPKIFreeText(l),a++}if(i.length>a&&"03"==e.substr(i[1+a],2)){var d=r(e,i[1+a]);t.failinfo=this.getPKIFailureInfo(d)}return t},this.getPKIFreeText=function(e){for(var n=[],r=o(e,0),i=0;i<r.length;i++)n.push(t.getString(e,r[i]));return n},this.getPKIFailureInfo=function(e){var n=t.getInt(e,0);return null!=a[n]?a[n]:n},this.getTimeStampReq=function(e){var i={certreq:!1},s=o(e,0);if(s.length<2)throw new Error("TimeStampReq must have at least 2 items");var a=r(e,s[1]);i.messageImprint=ue.asn1.tsp.TSPUtil.parseMessageImprint(a);for(var u=2;u<s.length;u++){var c=s[u],l=e.substr(c,2);if("06"==l){var d=n(e,c);i.policy=t.hextooidstr(d)}"02"==l&&(i.nonce=n(e,c)),"01"==l&&(i.certreq=!0)}return i}},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.cades&&ue.asn1.cades||(ue.asn1.cades={}),ue.asn1.cades.SignaturePolicyIdentifier=function(e){var t=ue.asn1.cades,n=t.SignaturePolicyId;t.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new n(this.params)]},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.SignaturePolicyIdentifier,ue.asn1.cms.Attribute),ue.asn1.cades.SignaturePolicyId=function(e){var t=ue.asn1,n=t.DERSequence,r=t.DERObjectIdentifier,i=(t.x509.AlgorithmIdentifier,t.cades),o=i.SignaturePolicyId,s=i.OtherHashAlgAndValue;o.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];return t.push(new r(e.oid)),t.push(new s(e)),new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.SignaturePolicyId,ue.asn1.ASN1Object),ue.asn1.cades.OtherHashAlgAndValue=function(e){var t=Error,n=ue.asn1,r=n.DERSequence,i=n.DEROctetString,o=n.x509.AlgorithmIdentifier;n.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(null==e.alg)throw new t("property 'alg' not specified");if(null==e.hash&&null==e.cert)throw new t("property 'hash' nor 'cert' not specified");var n=null;if(null!=e.hash)n=e.hash;else if(null!=e.cert){if("string"!=typeof e.cert)throw new t("cert not string");var s=e.cert;-1!=e.cert.indexOf("-----BEGIN")&&(s=_e(e.cert)),n=ue.crypto.Util.hashHex(s,e.alg)}var a=[];return a.push(new o({name:e.alg})),a.push(new i({hex:n})),new r({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.OtherHashAlgAndValue,ue.asn1.ASN1Object),ue.asn1.cades.OtherHashValue=function(e){ue.asn1.cades.OtherHashValue.superclass.constructor.call(this);var t=Error,n=ue,r=(n.lang.String.isHex,n.asn1.DEROctetString);n.crypto.Util.hashHex,this.params=null,this.tohex=function(){var e=this.params;if(null==e.hash&&null==e.cert)throw new t("hash or cert not specified");var n=null;if(null!=e.hash)n=e.hash;else if(null!=e.cert){if("string"!=typeof e.cert)throw new t("cert not string");var i=e.cert;-1!=e.cert.indexOf("-----BEGIN")&&(i=_e(e.cert)),n=ue.crypto.Util.hashHex(i,"sha1")}return new r({hex:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.OtherHashValue,ue.asn1.ASN1Object),ue.asn1.cades.SignatureTimeStamp=function(e){var t=Error,n=ue,r=n.lang.String.isHex,i=n.asn1,o=i.ASN1Object;i.x509,i.cades.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var e=this.params;if(null!=e.tst){if(r(e.tst))return(n=new o).hTLV=e.tst,[n];if(e.tst instanceof o)return[e.tst];throw new t("params.tst has wrong value")}if(null!=e.res){var n,i=e.res;if(i instanceof o&&(i=i.tohex()),"string"!=typeof i||!r(i))throw new t("params.res has wrong value");return de.getTLVbyList(i,0,[1]),(n=new o).hTLV=e.tst,[n]}},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.SignatureTimeStamp,ue.asn1.cms.Attribute),ue.asn1.cades.CompleteCertificateRefs=function(e){var t=Error,n=ue,r=n.asn1,i=r.DERSequence,o=r.cades,s=o.OtherCertID,a=n.lang.String.isHex;o.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var e=this.params,n=[],r=0;r<e.array.length;r++){var o=e.array[r];if("string"==typeof o)if(-1!=o.indexOf("-----BEGIN"))o={cert:o};else{if(!a(o))throw new t("unsupported value: "+o);o={hash:o}}null!=e.alg&&null==o.alg&&(o.alg=e.alg),null!=e.hasis&&null==o.hasis&&(o.hasis=e.hasis);var u=new s(o);n.push(u)}return[new i({array:n})]},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.CompleteCertificateRefs,ue.asn1.cms.Attribute),ue.asn1.cades.OtherCertID=function(e){var t=ue.asn1,n=t.DERSequence,r=t.cms.IssuerSerial,i=t.cades,o=i.OtherHashValue,s=i.OtherHashAlgAndValue;i.OtherCertID.superclass.constructor.call(this),this.params=e,this.tohex=function(){var e=this.params;"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?e={cert:e}:_isHex(e)&&(e={hash:e}));var t,i=[];if(t=null!=e.alg?new s(e):new o(e),i.push(t),null!=e.cert&&1==e.hasis||null!=e.issuer&&null!=e.serial){var a=new r(e);i.push(a)}return new n({array:i}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.OtherCertID,ue.asn1.ASN1Object),ue.asn1.cades.OtherHash=function(e){Error;var t=ue,n=t.asn1,r=(n.cms,n.cades),i=r.OtherHashAlgAndValue,o=r.OtherHashValue,s=(t.crypto.Util.hashHex,t.lang.String.isHex);r.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;return"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?e={cert:e}:s(e)&&(e={hash:e})),(null!=e.alg?new i(e):new o(e)).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.OtherHash,ue.asn1.ASN1Object),ue.asn1.cades.CAdESUtil=new function(){},ue.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){return(new ue.asn1.cms.CMSParser).getCMSSignedData(e)},ue.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,n){var r=de,i=r.getChildIdx,o=r.getTLV,s=r.getV,a=ue.asn1,u=a.ASN1Object,c=a.cms,l=c.AttributeList,d=c.SignerInfo,h={},p=i(e,t);if(6!=p.length)throw"not supported items for SignerInfo (!=6)";var f=p.shift();h.version=o(e,f);var g=p.shift();h.si=o(e,g);var m=p.shift();h.digalg=o(e,m);var v=p.shift();h.sattrs=o(e,v);var y=p.shift();h.sigalg=o(e,y);var S=p.shift();h.sig=o(e,S),h.sigval=s(e,S);var b=null;return h.obj=new d,(b=new u).hTLV=h.version,h.obj.dCMSVersion=b,(b=new u).hTLV=h.si,h.obj.dSignerIdentifier=b,(b=new u).hTLV=h.digalg,h.obj.dDigestAlgorithm=b,(b=new u).hTLV=h.sattrs,h.obj.dSignedAttrs=b,(b=new u).hTLV=h.sigalg,h.obj.dSigAlg=b,(b=new u).hTLV=h.sig,h.obj.dSig=b,h.obj.dUnsignedAttrs=new l,h},void 0!==ue.asn1.csr&&ue.asn1.csr||(ue.asn1.csr={}),ue.asn1.csr.CertificationRequest=function(e){var t=ue.asn1,n=t.DERBitString,r=t.DERSequence,i=t.csr,o=(t.x509,i.CertificationRequestInfo);i.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(e){this.params=e},this.sign=function(){var e=new o(this.params).tohex(),t=new ue.crypto.Signature({alg:this.params.sigalg});t.init(this.params.sbjprvkey),t.updateHex(e);var n=t.sign();this.params.sighex=n},this.getPEM=function(){return Ie(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var e=this.params,t=new ue.asn1.csr.CertificationRequestInfo(this.params),i=new ue.asn1.x509.AlgorithmIdentifier({name:e.sigalg});if(null==e.sighex&&null!=e.sbjprvkey&&this.sign(),null==e.sighex)throw new Error("sighex or sbjprvkey parameter not defined");var o=new n({hex:"00"+e.sighex});return new r({array:[t,i,o]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.csr.CertificationRequest,ue.asn1.ASN1Object),ue.asn1.csr.CertificationRequestInfo=function(e){var t=ue.asn1,n=(t.DERBitString,t.DERSequence),r=t.DERInteger,i=t.DERUTF8String,o=t.DERTaggedObject,s=t.ASN1Util.newObject,a=t.csr,u=t.x509,c=u.X500Name,l=u.Extensions,d=u.SubjectPublicKeyInfo;a.AttributeList,a.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(e){null!=e&&(this.params=e)},this.tohex=function(){var e=this.params,t=[];if(t.push(new r({int:0})),t.push(new c(e.subject)),t.push(new d(We.getKey(e.sbjpubkey))),null!=e.attrs){var a=function(e){for(var t=Error,n=ue.asn1.x509.Extensions,r=[],i=0;i<e.length;i++){var o=e[i],s=o.attr;if("extensionRequest"==s){var a={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[new n(o.ext)]}]};r.push(a)}else if("unstructuredName"==s)a={seq:[{oid:"1.2.840.113549.1.9.2"},{set:o.names}]},r.push(a);else{if("challengePassword"!=s)throw new t("unknown CSR attribute");a={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:o.password}]}]},r.push(a)}}return{set:r}}(e.attrs),u=s({tag:{tage:"a0",obj:a}});t.push(u)}else if(null!=e.extreq){var h=new l(e.extreq);u=s({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[h]}]}}}),t.push(u)}else t.push(new o({tag:"a0",explicit:!1,obj:new i({str:""})}));return new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.csr.CertificationRequestInfo,ue.asn1.ASN1Object),ue.asn1.csr.AttributeList=function(e){},$e(ue.asn1.csr.AttributeList,ue.asn1.ASN1Object),ue.asn1.csr.CSRUtil=new function(){},ue.asn1.csr.CSRUtil.newCSRPEM=function(e){return new ue.asn1.csr.CertificationRequest(e).getPEM()},ue.asn1.csr.CSRUtil.getParam=function(e,t){var n=de,r=n.getV,i=n.getIdxbyList,o=n.getTLVbyList,s=n.getTLVbyListEx,a=n.getVbyListEx,u={};if(-1==e.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw new Error("argument is not PEM file");var c=_e(e,"CERTIFICATE REQUEST");t&&(u.tbs=o(c,0,[0]));try{var l=s(c,0,[0,1]);if("3000"==l)u.subject={};else{var d=new Qe;u.subject=d.getX500Name(l)}}catch(e){}var h=s(c,0,[0,2]),p=We.getKey(h,null,"pkcs8pub");u.sbjpubkey=We.getPEM(p,"PKCS8PUB");var f=function(e){var t=i(e,0,[0,3,0,0],"06");return"2a864886f70d01090e"!=r(e,t)?null:o(e,0,[0,3,0,1,0],"30")}(c);d=new Qe,null!=f&&(u.extreq=d.getExtParamArray(f));try{var g=s(c,0,[1],"30");d=new Qe,u.sigalg=d.getAlgorithmIdentifierName(g)}catch(e){}try{var m=a(c,0,[2]);u.sighex=m}catch(e){}return u},ue.asn1.csr.CSRUtil.verifySignature=function(e){try{var t=null;if("string"==typeof e&&-1!=e.indexOf("-----BEGIN CERTIFICATE REQUEST")?t=ue.asn1.csr.CSRUtil.getParam(e,!0):"object"==typeof e&&null!=e.sbjpubkey&&null!=e.sigalg&&null!=e.sighex&&null!=e.tbs&&(t=e),null==t)return!1;var n=new ue.crypto.Signature({alg:t.sigalg});return n.init(t.sbjpubkey),n.updateHex(t.tbs),n.verify(t.sighex)}catch(e){return alert(e),!1}},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.ocsp&&ue.asn1.ocsp||(ue.asn1.ocsp={}),ue.asn1.ocsp.DEFAULT_HASH="sha1",ue.asn1.ocsp.OCSPResponse=function(e){ue.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),ue.asn1.DEREnumerated;var t=ue.asn1.ASN1Util.newObject,n=ue.asn1.ocsp.ResponseBytes,r=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var e=this.params.resstatus;return"number"==typeof e?e:"string"!=typeof e?-1:r.indexOf(e)},this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params,r=this._getStatusCode();if(-1==r)throw new Error("responseStatus not supported: "+e.resstatus);if(0!=r)return t({seq:[{enum:{int:r}}]}).tohex();var i=new n(e);return t({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:i}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.OCSPResponse,ue.asn1.ASN1Object),ue.asn1.ocsp.ResponseBytes=function(e){ue.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var t=ue.asn1,n=t.DERSequence,r=t.DERObjectIdentifier,i=t.DEROctetString,o=t.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params;if("ocspBasic"!=e.restype)throw new Error("not supported responseType: "+e.restype);var t=new o(e),s=[];return s.push(new r({name:"ocspBasic"})),s.push(new i({hex:t.tohex()})),new n({array:s}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.ResponseBytes,ue.asn1.ASN1Object),ue.asn1.ocsp.BasicOCSPResponse=function(e){ue.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var t=Error,n=ue.asn1,r=n.ASN1Object,i=n.DERSequence,o=(n.DERGeneralizedTime,n.DERTaggedObject),s=n.DERBitString,a=(n.x509.Extensions,n.x509.AlgorithmIdentifier),u=n.ocsp;u.ResponderID,_SingleResponseList=u.SingleResponseList,_ResponseData=u.ResponseData,this.params=null,this.setByParam=function(e){this.params=e},this.sign=function(){var e=this.params,t=e.tbsresp.tohex(),n=new ue.crypto.Signature({alg:e.sigalg});n.init(e.reskey),n.updateHex(t),e.sighex=n.sign()},this.tohex=function(){var e=this.params;null==e.tbsresp&&(e.tbsresp=new _ResponseData(e)),null==e.sighex&&null!=e.reskey&&this.sign();var n=[];if(n.push(e.tbsresp),n.push(new a({name:e.sigalg})),n.push(new s({hex:"00"+e.sighex})),null!=e.certs&&null!=e.certs.length){for(var u=[],c=0;c<e.certs.length;c++){var l=e.certs[c],d=null;if(de.isASN1HEX(l))d=l;else{if(!l.match(/-----BEGIN/))throw new t("certs["+c+"] not hex or PEM");d=_e(l)}u.push(new r({tlv:d}))}var h=new i({array:u});n.push(new o({tag:"a0",explicit:!0,obj:h}))}return new i({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.BasicOCSPResponse,ue.asn1.ASN1Object),ue.asn1.ocsp.ResponseData=function(e){ue.asn1.ocsp.ResponseData.superclass.constructor.call(this);var t=Error,n=ue.asn1,r=n.DERSequence,i=n.DERGeneralizedTime,o=n.DERTaggedObject,s=n.x509.Extensions,a=n.ocsp,u=a.ResponderID;_SingleResponseList=a.SingleResponseList,this.params=null,this.tohex=function(){var e=this.params;null!=e.respid&&new t("respid not specified"),null!=e.prodat&&new t("prodat not specified"),null!=e.array&&new t("array not specified");var n=[];if(n.push(new u(e.respid)),n.push(new i(e.prodat)),n.push(new _SingleResponseList(e.array)),null!=e.ext){var a=new s(e.ext);n.push(new o({tag:"a1",explicit:!0,obj:a}))}return new r({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.ResponseData,ue.asn1.ASN1Object),ue.asn1.ocsp.ResponderID=function(e){ue.asn1.ocsp.ResponderID.superclass.constructor.call(this);var t=ue,n=t.asn1,r=n.ASN1Util.newObject,i=n.x509.X500Name,o=t.lang.String.isHex,s=Error;this.params=null,this.tohex=function(){var e=this.params;if(null!=e.key){var t,n=null;if("string"==typeof e.key?(o(e.key)&&(n=e.key),e.key.match(/-----BEGIN CERTIFICATE/)&&null!=(t=new Qe(e.key).getExtSubjectKeyIdentifier())&&(n=t.kid.hex)):e.key instanceof Qe&&null!=(t=e.key.getExtSubjectKeyIdentifier())&&(n=t.kid.hex),null==n)throw new s("wrong key member value");return r({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:n}}}}).tohex()}if(null!=e.name){var a=null;if("string"==typeof e.name&&e.name.match(/-----BEGIN CERTIFICATE/)?a=new Qe(e.name).getSubject():e.name instanceof Qe?a=e.name.getSubject():"object"!=typeof e.name||null==e.name.array&&null==e.name.str||(a=e.name),null==a)throw new s("wrong name member value");return r({tag:{tag:"a1",explicit:!0,obj:new i(a)}}).tohex()}throw new s("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.ResponderID,ue.asn1.ASN1Object),ue.asn1.ocsp.SingleResponseList=function(e){ue.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var t=ue.asn1,n=t.DERSequence,r=t.ocsp.SingleResponse;this.params=null,this.tohex=function(){var e=this.params;if("object"!=typeof e||null==e.length)throw new Error("params not specified properly");for(var t=[],i=0;i<e.length;i++)t.push(new r(e[i]));return new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.SingleResponseList,ue.asn1.ASN1Object),ue.asn1.ocsp.SingleResponse=function(e){var t=Error,n=ue.asn1,r=n.DERSequence,i=n.DERGeneralizedTime,o=n.DERTaggedObject,s=n.ocsp,a=s.CertID,u=s.CertStatus,c=n.x509.Extensions;s.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,n=[];if(null==e.certid)throw new t("certid unspecified");if(null==e.status)throw new t("status unspecified");if(null==e.thisupdate)throw new t("thisupdate unspecified");if(n.push(new a(e.certid)),n.push(new u(e.status)),n.push(new i(e.thisupdate)),null!=e.nextupdate){var s=new i(e.nextupdate);n.push(new o({tag:"a0",explicit:!0,obj:s}))}if(null!=e.ext){var l=new c(e.ext);n.push(new o({tag:"a1",explicit:!0,obj:l}))}return new r({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.SingleResponse,ue.asn1.ASN1Object),ue.asn1.ocsp.CertID=function(e){var t=ue,n=t.asn1,r=n.DEROctetString,i=n.DERInteger,o=n.DERSequence,s=n.x509.AlgorithmIdentifier,a=n.ocsp,u=(a.DEFAULT_HASH,t.crypto.Util.hashHex),c=Qe,l=de.getVbyList;a.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(e,t,n,r){null==r&&(r=this.DEFAULT_HASH),this.params={alg:r,issname:e,isskey:t,sbjsn:n}},this.setByCert=function(e,t,n){null==n&&(n=this.DEFAULT_HASH),this.params={alg:n,issuerCert:e,subjectCert:t}},this.getParamByCerts=function(e,t,n){null==n&&(n=this.DEFAULT_HASH);var r=new c(e),i=new c(t),o=u(r.getSubjectHex(),n),s=r.getPublicKeyHex();return{alg:n,issname:o,isskey:u(l(s,0,[1],"03",!0),n),sbjsn:i.getSerialNumberHex()}},this.tohex=function(){if("object"!=typeof this.params)throw new Error("params not set");var e,t,n,a,u=this.params;if(a=null==u.alg?this.DEFAULT_HASH:u.alg,null!=u.issuerCert&&null!=u.subjectCert){var c=this.getParamByCerts(u.issuerCert,u.subjectCert,a);e=c.issname,t=c.isskey,n=c.sbjsn}else{if(null==u.issname||null==u.isskey||null==u.sbjsn)throw new Error("required param members not defined");e=u.issname,t=u.isskey,n=u.sbjsn}var l=new s({name:a}),d=new r({hex:e}),h=new r({hex:t}),p=new i({hex:n}),f=new o({array:[l,d,h,p]});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.CertID,ue.asn1.ASN1Object),ue.asn1.ocsp.CertStatus=function(e){ue.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if("good"==e.status)return"8000";if("unknown"==e.status)return"8200";if("revoked"==e.status){var t=[{gentime:{str:e.time}}];null!=e.reason&&t.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:e.reason}}}});var n={tag:"a1",explicit:!1,obj:{seq:t}};return ue.asn1.ASN1Util.newObject({tag:n}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.CertStatus,ue.asn1.ASN1Object),ue.asn1.ocsp.Request=function(e){var t=ue.asn1,n=t.DERSequence,r=t.ocsp;if(r.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var e=[];if(null===this.dReqCert)throw"reqCert not set";e.push(this.dReqCert);var t=new n({array:e});return this.hTLV=t.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e){var i=new r.CertID(e);this.dReqCert=i}},$e(ue.asn1.ocsp.Request,ue.asn1.ASN1Object),ue.asn1.ocsp.TBSRequest=function(e){var t=ue.asn1,n=t.DERSequence,r=t.ocsp;r.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(e){for(var t=[],n=0;n<e.length;n++){var i=new r.Request(e[0]);t.push(i)}this.dRequestList=t},this.tohex=function(){var e=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var t=new n({array:this.dRequestList});if(e.push(t),null!==this.dRequestExt)throw"requestExtensions not supported";var r=new n({array:e});return this.hTLV=r.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&void 0!==e.reqList&&this.setRequestListByParam(e.reqList)},$e(ue.asn1.ocsp.TBSRequest,ue.asn1.ASN1Object),ue.asn1.ocsp.OCSPRequest=function(e){var t=ue.asn1,n=t.DERSequence,r=t.ocsp;if(r.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var e=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(e.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var t=new n({array:e});return this.hTLV=t.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&void 0!==e.reqList){var i=new r.TBSRequest(e);this.dTbsRequest=i}},$e(ue.asn1.ocsp.OCSPRequest,ue.asn1.ASN1Object),ue.asn1.ocsp.OCSPUtil={},ue.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,n){var r=ue.asn1.ocsp;void 0===n&&(n=r.DEFAULT_HASH);var i={alg:n,issuerCert:e,subjectCert:t};return new r.OCSPRequest({reqList:[i]}).tohex()},ue.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=de,n=t.getVbyList,r=t.getVbyListEx,i=t.getIdxbyList,o=(t.getIdxbyListEx,t.getV),s={};try{var a=r(e,0,[0],"0a");s.responseStatus=parseInt(a,16)}catch(e){}if(0!==s.responseStatus)return s;try{var u=i(e,0,[1,0,1,0,0,2,0,1]);"80"===e.substr(u,2)?s.certStatus="good":"a1"===e.substr(u,2)?(s.certStatus="revoked",s.revocationTime=Se(n(e,u,[0]))):"82"===e.substr(u,2)&&(s.certStatus="unknown")}catch(e){}try{var c=i(e,0,[1,0,1,0,0,2,0,2]);s.thisUpdate=Se(o(e,c))}catch(e){}try{var l=i(e,0,[1,0,1,0,0,2,0,3]);"a0"===e.substr(l,2)&&(s.nextUpdate=Se(n(e,l,[0])))}catch(e){}return s},ue.asn1.ocsp.OCSPParser=function(){var e=Error,t=Qe,n=new t,r=de,i=r.getV,o=r.getTLV,s=r.getIdxbyList,a=r.getVbyList,u=r.getTLVbyList,c=r.getVbyListEx,l=r.getTLVbyListEx,d=r.getChildIdx;this.getOCSPRequest=function(t){var n=d(t,0);if(1!=n.length&&2!=n.length)throw new e("wrong number elements: "+n.length);return this.getTBSRequest(o(t,n[0]))},this.getTBSRequest=function(e){var t={},r=l(e,0,[0],"30");t.array=this.getRequestList(r);var i=l(e,0,["[2]",0],"30");return null!=i&&(t.ext=n.getExtParamArray(i)),t},this.getRequestList=function(e){for(var t=[],n=d(e,0),r=0;r<n.length;r++)e=o(e,n[r]),t.push(this.getRequest(e));return t},this.getRequest=function(t){var r=d(t,0);if(1!=r.length&&2!=r.length)throw new e("wrong number elements: "+r.length);var i=this.getCertID(o(t,r[0]));if(2==r.length){var a=s(t,0,[1,0]);i.ext=n.getExtParamArray(o(t,a))}return i},this.getCertID=function(n){var r=d(n,0);if(4!=r.length)throw new e("wrong number elements: "+r.length);var s=new t,a={};return a.alg=s.getAlgorithmIdentifierName(o(n,r[0])),a.issname=i(n,r[1]),a.isskey=i(n,r[2]),a.sbjsn=i(n,r[3]),a},this.getOCSPResponse=function(e){var t,n=d(e,0),r=i(e,n[0]),o=parseInt(r);if(1==n.length)return{resstatus:o};var s=u(e,0,[1,0]);return(t=this.getResponseBytes(s)).resstatus=o,t},this.getResponseBytes=function(e){var t,n=d(e,0),r=u(e,0,[1,0]);t=this.getBasicOCSPResponse(r);var o=i(e,n[0]);return t.restype=ue.asn1.x509.OID.oid2name(Be(o)),t},this.getBasicOCSPResponse=function(e){var t,n=d(e,0);t=this.getResponseData(o(e,n[0]));var r=new Qe;t.alg=r.getAlgorithmIdentifierName(o(e,n[1]));var s=i(e,n[2]);t.sighex=s.substr(2);var a=c(e,0,["[0]"]);if(null!=a){for(var u=d(a,0),l=[],h=0;h<u.length;h++){var p=o(a,u[h]);l.push(p)}t.certs=l}return t},this.getResponseData=function(e){var t=d(e,0),n=t.length,r={},s=0;"a0"==e.substr(t[0],2)&&s++,r.respid=this.getResponderID(o(e,t[s++]));var a=i(e,t[s++]);if(r.prodat=Se(a),r.array=this.getSingleResponseList(o(e,t[s++])),"a1"==e.substr(t[n-1],2)){var c=u(e,t[n-1],[0]),l=new Qe;r.ext=l.getExtParamArray(c)}return r},this.getResponderID=function(e){var t={};if("a2"==e.substr(0,2)){var n=a(e,0,[0]);t.key=n}if("a1"==e.substr(0,2)){var r=u(e,0,[0]),i=new Qe;t.name=i.getX500Name(r)}return t},this.getSingleResponseList=function(e){for(var t=d(e,0),n=[],r=0;r<t.length;r++){var i=this.getSingleResponse(o(e,t[r]));n.push(i)}return n},this.getSingleResponse=function(e){var t=d(e,0),n={},r=this.getCertID(o(e,t[0]));n.certid=r;var s=this.getCertStatus(o(e,t[1]));if(n.status=s,"18"==e.substr(t[2],2)){var c=i(e,t[2]);n.thisupdate=Se(c)}for(var l=3;l<t.length;l++){if("a0"==e.substr(t[l],2)){var h=a(e,t[l],[0],"18");n.nextupdate=Se(h)}if("a1"==e.substr(t[l],2)){var p=new Qe,f=u(e,0,[l,0]);n.ext=p.getExtParamArray(f)}}return n},this.getCertStatus=function(e){var t={};if("8000"==e)return{status:"good"};if("8200"==e)return{status:"unknown"};if("a1"==e.substr(0,2)){t.status="revoked";var n=Se(a(e,0,[0]));t.time=n}return t}},void 0!==ue&&ue||(ue={}),void 0!==ue.lang&&ue.lang||(ue.lang={}),ue.lang.String=function(){},"function"==typeof Buffer?(ce=function(e){return fe(Buffer.from(e,"utf8").toString("base64"))},le=function(e){return Buffer.from(ge(e),"base64").toString("utf8")}):(ce=function(e){return me(Ae(Me(e)))},le=function(e){return decodeURIComponent(Te(ve(e)))}),ue.lang.String.isInteger=function(e){return!!e.match(/^[0-9]+$/)||!!e.match(/^-[0-9]+$/)},ue.lang.String.isHex=function(e){return Fe(e)},ue.lang.String.isBase64=function(e){return!(!(e=e.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||e.length%4!=0)},ue.lang.String.isBase64URL=function(e){return!e.match(/[+/=]/)&&(e=ge(e),ue.lang.String.isBase64(e))},ue.lang.String.isIntegerArray=function(e){return!!(e=e.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},ue.lang.String.isPrintable=function(e){return null!==e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},ue.lang.String.isIA5=function(e){return null!==e.match(/^[\x20-\x21\x23-\x7f]*$/)},ue.lang.String.isMail=function(e){return null!==e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};var He=function(e,t,n){return null==n&&(n="0"),e.length>=t?e:new Array(t-e.length+1).join(n)+e};function qe(e,t){for(var n=0,r=0;r<e.length;r++)n|=1<<t[e[r]];var i=n.toString(2),o="";for(r=i.length-1;r>=0;r--)o+=i[r];return o}function Ke(e,t,n){if("object"==typeof e){t=String(t).split(".");for(var r=0;r<t.length&&e;r++){var i=t[r];i.match(/^[0-9]+$/)&&(i=parseInt(i)),e=e[i]}return e||!1===e?e:n}}function $e(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t)}void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:g.algo.MD5,sha1:g.algo.SHA1,sha224:g.algo.SHA224,sha256:g.algo.SHA256,sha384:g.algo.SHA384,sha512:g.algo.SHA512,ripemd160:g.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(void 0===this.DIGESTINFOHEAD[t])throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,n){var r=this.getDigestInfoHex(e,t),i=n/4;if(r.length+22>i)throw"key is too short for SigAlg: keylen="+n+","+t;for(var o="00"+r,s="",a=i-4-o.length,u=0;u<a;u+=2)s+="ff";return"0001"+s+o},this.hashString=function(e,t){return new ue.crypto.MessageDigest({alg:t}).digestString(e)},this.hashHex=function(e,t){return new ue.crypto.MessageDigest({alg:t}).digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof re||e instanceof ue.crypto.DSA||e instanceof ue.crypto.ECDSA}},ue.crypto.Util.md5=function(e){return new ue.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(e)},ue.crypto.Util.ripemd160=function(e){return new ue.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(e)},ue.crypto.Util.SECURERANDOMGEN=new te,ue.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return ue.crypto.Util.SECURERANDOMGEN.nextBytes(t),he(t)},ue.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new E(ue.crypto.Util.getRandomHexOfNbytes(e),16)},ue.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,n=new Array((e-t)/8+1);return ue.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<t&255^255)&n[0],he(n)},ue.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new E(ue.crypto.Util.getRandomHexOfNbits(e),16)},ue.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var n=ue.crypto.Util.getRandomBigIntegerOfNbits(t);if(-1!=e.compareTo(n))return n}},ue.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var n=e.compareTo(t);if(1==n)throw"biMin is greater than biMax";if(0==n)return e;var r=t.subtract(e);return ue.crypto.Util.getRandomBigIntegerZeroToMax(r).add(e)},ue.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(e,t){if(null!==(e=ue.crypto.MessageDigest.getCanonicalAlgName(e))&&void 0===t&&(t=ue.crypto.Util.DEFAULTPROVIDER[e]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)&&"cryptojs"==t){try{this.md=ue.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=g.enc.Hex.parse(e);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(g.enc.Hex)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}if(-1!=":sha256:".indexOf(e)&&"sjcl"==t){try{this.md=new sjcl.hash.sha256}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=sjcl.codec.hex.toBits(e);this.md.update(t)},this.digest=function(){var e=this.md.finalize();return sjcl.codec.hex.fromBits(e)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==e&&void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ue.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},ue.crypto.MessageDigest.getCanonicalAlgName=function(e){return"string"==typeof e&&(e=(e=e.toLowerCase()).replace(/-/,"")),e},ue.crypto.MessageDigest.getHashLength=function(e){var t=ue.crypto.MessageDigest,n=t.getCanonicalAlgName(e);if(void 0===t.HASHLENGTH[n])throw"not supported algorithm: "+e;return t.HASHLENGTH[n]},ue.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},ue.crypto.Mac=function(e){this.setAlgAndProvider=function(e,t){if(null==(e=e.toLowerCase())&&(e="hmacsha1"),"hmac"!=(e=e.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+e;void 0===t&&(t=ue.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+t;var n=e.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==t){try{var r=ue.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[n];this.mac=g.algo.HMAC.create(r,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+e}this.updateString=function(e){this.mac.update(e)},this.updateHex=function(e){var t=g.enc.Hex.parse(e);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(g.enc.Hex)},this.doFinalString=function(e){return this.updateString(e),this.doFinal()},this.doFinalHex=function(e){return this.updateHex(e),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if("string"==typeof e){var t=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(t=we(e)),void(this.pass=g.enc.Hex.parse(t))}if("object"!=typeof e)throw"KJUR.crypto.Mac unsupported password type: "+e;if(t=null,void 0!==e.hex){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;t=e.hex}if(void 0!==e.utf8&&(t=ye(e.utf8)),void 0!==e.rstr&&(t=we(e.rstr)),void 0!==e.b64&&(t=b(e.b64)),void 0!==e.b64u&&(t=ve(e.b64u)),null==t)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=g.enc.Hex.parse(t)},void 0!==e&&(void 0!==e.pass&&this.setPassword(e.pass),void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ue.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},ue.crypto.Signature=function(e){var t=null;if(this._setAlgNames=function(){var e=this.algName.match(/^(.+)with(.+)$/);e&&(this.mdAlgName=e[1].toLowerCase(),this.pubkeyAlgName=e[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(e,t){for(var n="",r=t/4-e.length,i=0;i<r;i++)n+="0";return n+e},this.setAlgAndProvider=function(e,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw new Error("provider not supported: "+t);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new ue.crypto.MessageDigest({alg:this.mdAlgName})}catch(e){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+e)}this.init=function(e,t){var n=null;try{n=void 0===t?We.getKey(e):We.getKey(e,t)}catch(e){throw"init failed:"+e}if(!0===n.isPrivate)this.prvKey=n,this.state="SIGN";else{if(!0!==n.isPublic)throw"init failed.:"+n;this.pubKey=n,this.state="VERIFY"}},this.updateString=function(e){this.md.updateString(e)},this.updateHex=function(e){this.md.updateHex(e)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==ue.crypto.ECDSA&&(this.prvKey=new ue.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof re&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof re&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof ue.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof ue.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(e){return this.updateString(e),this.sign()},this.signHex=function(e){return this.updateHex(e),this.sign()},this.verify=function(e){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==ue.crypto.ECDSA&&(this.pubKey=new ue.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof re&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,e,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof re&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ue.crypto.ECDSA&&this.pubKey instanceof ue.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ue.crypto.DSA&&this.pubKey instanceof ue.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(e,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(e){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(e){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(e){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(e){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,void 0!==e&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=ue.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{t=We.getKey(e.prvkeypem),this.init(t)}catch(e){throw"fatal error to load pem private key: "+e}}},ue.crypto.Cipher=function(e){},ue.crypto.Cipher.encrypt=function(e,t,n,r){if(null!=Ke(r,"enclag")&&(n=r.encalg),"string"==typeof n&&"-CBC"==n.substr(-4)){var i=t,o=e;null!=Ke(r,"key")&&(i=r.key),null!=Ke(r,"enc")&&(hEnc=r.enc);var s,a=g.enc.Hex.parse(i),u=g.enc.Hex.parse(o),c=g.enc.Hex.parse(r.iv);if("des-EDE3-CBC"==n)s=g.TripleDES.encrypt(u,a,{iv:c});else{if("aes128-CBC"!=n&&"aes256-CBC"!=n)throw new Error("unsupported algorithm: "+n);s=g.AES.encrypt(u,a,{iv:c})}return s+""}throw new Error("Cipher.encrypt: unsupported key or algorithm")},ue.crypto.Cipher.decrypt=function(e,t,n,r){if(null!=Ke(r,"enclag")&&(n=r.encalg),"string"==typeof n&&"-CBC"==n.substr(-4)){var i=t,o=e;null!=Ke(r,"key")&&(i=r.key),null!=Ke(r,"enc")&&(o=r.enc);var s,a=g.enc.Hex.parse(i),u=g.enc.Hex.parse(o),c=g.enc.Hex.parse(r.iv);if("des-EDE3-CBC"==n)s=g.TripleDES.decrypt({ciphertext:u},a,{iv:c});else{if("aes128-CBC"!=n&&"aes256-CBC"!=n)throw new Error("unsupported algorithm: "+n);s=g.AES.decrypt({ciphertext:u},a,{iv:c})}return g.enc.Hex.stringify(s)}throw new Error("Cipher.decrypt: unsupported key or algorithm")},ue.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.ECDSA=function(e){var t=Error,n=E,r=oe,i=ue.crypto.ECDSA,o=ue.crypto.ECParameterDB,s=i.getName,a=de,u=a.getVbyListEx,c=a.isASN1HEX,l=new te;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){return new n(e.bitLength(),l).mod(e.subtract(n.ONE)).add(n.ONE)},this.setNamedCurve=function(e){this.ecparams=o.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keycharlen;if(e.length!==2+2*t)throw"malformed public key hex length";var n={};return n.x=e.substr(2,t),n.y=e.substr(2+t),n},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":"secp521r1"===e||"NIST P-521"===e||"P-521"===e?"P-521":null},this.generateKeyPairHex=function(){var e=this.ecparams.n,t=this.getBigRandom(e),n=this.ecparams.keycharlen,r=("0000000000"+t.toString(16)).slice(-n);return this.setPrivateKeyHex(r),{ecprvhex:r,ecpubhex:this.generatePublicKeyHex()}},this.generatePublicKeyHex=function(){var e=new n(this.prvKeyHex,16),t=this.ecparams.G.multiply(e),r=t.getX().toBigInteger(),i=t.getY().toBigInteger(),o=this.ecparams.keycharlen,s="04"+("0000000000"+r.toString(16)).slice(-o)+("0000000000"+i.toString(16)).slice(-o);return this.setPublicKeyHex(s),s},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var r=new n(t,16),o=this.ecparams.n,s=new n(e.substring(0,this.ecparams.keycharlen),16);do{var a=this.getBigRandom(o),u=this.ecparams.G.multiply(a).getX().toBigInteger().mod(o)}while(u.compareTo(n.ZERO)<=0);var c=a.modInverse(o).multiply(s.add(r.multiply(u))).mod(o);return i.biRSSigToASN1Sig(u,c)},this.sign=function(e,t){var r=t,i=this.ecparams.n,o=n.fromByteArrayUnsigned(e);do{var s=this.getBigRandom(i),a=this.ecparams.G.multiply(s).getX().toBigInteger().mod(i)}while(a.compareTo(E.ZERO)<=0);var u=s.modInverse(i).multiply(o.add(r.multiply(a))).mod(i);return this.serializeSig(a,u)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,o){try{var s,a,u=i.parseSigHex(t);s=u.r,a=u.s;var c=r.decodeFromHex(this.ecparams.curve,o),l=new n(e.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(l,s,a,c)}catch(e){return!1}},this.verify=function(e,t,i){var o,s,a;if(Bitcoin.Util.isArray(t)){var u=this.parseSig(t);o=u.r,s=u.s}else{if("object"!=typeof t||!t.r||!t.s)throw"Invalid value for signature";o=t.r,s=t.s}if(i instanceof oe)a=i;else{if(!Bitcoin.Util.isArray(i))throw"Invalid format for pubkey value, must be byte array or ECPointFp";a=r.decodeFrom(this.ecparams.curve,i)}var c=n.fromByteArrayUnsigned(e);return this.verifyRaw(c,o,s,a)},this.verifyRaw=function(e,t,r,i){var o=this.ecparams.n,s=this.ecparams.G;if(t.compareTo(n.ONE)<0||t.compareTo(o)>=0)return!1;if(r.compareTo(n.ONE)<0||r.compareTo(o)>=0)return!1;var a=r.modInverse(o),u=e.multiply(a).mod(o),c=t.multiply(a).mod(o);return s.multiply(u).add(i.multiply(c)).getX().toBigInteger().mod(o).equals(t)},this.serializeSig=function(e,t){var n=e.toByteArraySigned(),r=t.toByteArraySigned(),i=[];return i.push(2),i.push(n.length),(i=i.concat(n)).push(2),i.push(r.length),(i=i.concat(r)).unshift(i.length),i.unshift(48),i},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(2!=e[t=2])throw new Error("First element in signature must be a DERInteger");var r=e.slice(t+2,t+2+e[t+1]);if(2!=e[t+=2+e[t+1]])throw new Error("Second element in signature must be a DERInteger");var i=e.slice(t+2,t+2+e[t+1]);return t+=2+e[t+1],{r:n.fromByteArrayUnsigned(r),s:n.fromByteArrayUnsigned(i)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||t>7)throw"Invalid signature type";var r=this.ecparams.n;return{r:n.fromByteArrayUnsigned(e.slice(1,33)).mod(r),s:n.fromByteArrayUnsigned(e.slice(33,65)).mod(r),i:t}},this.readPKCS5PrvKeyHex=function(e){if(!1===c(e))throw new Error("not ASN.1 hex string");var t,n,r;try{t=u(e,0,["[0]",0],"06"),n=u(e,0,[1],"04");try{r=u(e,0,["[1]",0],"03")}catch(e){}}catch(e){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=s(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(r),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){if(!1===c(e))throw new t("not ASN.1 hex string");var n,r,i;try{u(e,0,[1,0],"06"),n=u(e,0,[1,1],"06"),r=u(e,0,[2,0,1],"04");try{i=u(e,0,[2,0,"[1]",0],"03")}catch(e){}}catch(e){throw new t("malformed PKCS#8 plain ECC private key")}if(this.curveName=s(n),void 0===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){if(!1===c(e))throw new t("not ASN.1 hex string");var n,r;try{u(e,0,[0,0],"06"),n=u(e,0,[0,1],"06"),r=u(e,0,[1],"03")}catch(e){throw new t("malformed PKCS#8 ECC public key")}if(this.curveName=s(n),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(r)},this.readCertPubKeyHex=function(e,n){if(!1===c(e))throw new t("not ASN.1 hex string");var r,i;try{r=u(e,0,[0,5,0,1],"06"),i=u(e,0,[0,5,1],"03")}catch(e){throw new t("malformed X.509 certificate ECC public key")}if(this.curveName=s(r),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},ue.crypto.ECDSA.parseSigHex=function(e){var t=ue.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new E(t.r,16),s:new E(t.s,16)}},ue.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=de,n=t.getChildIdx,r=t.getV;if(t.checkStrictDER(e,0),"30"!=e.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var i=n(e,0);if(2!=i.length)throw new Error("signature shall have two elements");var o=i[0],s=i[1];if("02"!=e.substr(o,2))throw new Error("1st item not ASN.1 integer");if("02"!=e.substr(s,2))throw new Error("2nd item not ASN.1 integer");return{r:r(e,o),s:r(e,s)}},ue.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=ue.crypto.ECDSA.parseSigHexInHexRS(e),n=t.r,r=t.s;if(n.length>=130&&n.length<=134){if(n.length%2!=0)throw Error("unknown ECDSA sig r length error");if(r.length%2!=0)throw Error("unknown ECDSA sig s length error");"00"==n.substr(0,2)&&(n=n.substr(2)),"00"==r.substr(0,2)&&(r=r.substr(2));var i=Math.max(n.length,r.length);return(n=("000000"+n).slice(-i))+("000000"+r).slice(-i)}if("00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),"00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),n.length%32==30&&(n="00"+n),r.length%32==30&&(r="00"+r),n.length%32!=0)throw Error("unknown ECDSA sig r length error");if(r.length%32!=0)throw Error("unknown ECDSA sig s length error");return n+r},ue.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var t=e.substr(0,e.length/2),n=e.substr(e.length/2);return ue.crypto.ECDSA.hexRSSigToASN1Sig(t,n)},ue.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var n=new E(e,16),r=new E(t,16);return ue.crypto.ECDSA.biRSSigToASN1Sig(n,r)},ue.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var n=ue.asn1,r=new n.DERInteger({bigint:e}),i=new n.DERInteger({bigint:t});return new n.DERSequence({array:[r,i]}).tohex()},ue.crypto.ECDSA.getName=function(e){return"2b8104001f"===e?"secp192k1":"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040021"===e?"secp224r1":"2b81040022"===e?"secp384r1":"2b81040023"===e?"secp521r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)?"secp256r1":-1!=="|secp256k1|".indexOf(e)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(e)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(e)?"secp384r1":-1!=="|secp521r1|NIST P-521|P-521|".indexOf(e)?"secp521r1":null},void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.ECParameterDB=new function(){var e={},t={};function n(e){return new E(e,16)}this.getByName=function(n){var r=n;if(void 0!==t[r]&&(r=t[n]),void 0!==e[r])return e[r];throw"unregistered EC curve name: "+r},this.regist=function(r,i,o,s,a,u,c,l,d,h,p,f){e[r]={};var g=n(o),m=n(s),v=n(a),y=n(u),S=n(c),b=new se(g,m,v),E=b.decodePointHex("04"+l+d);e[r].name=r,e[r].keylen=i,e[r].keycharlen=2*Math.ceil(i/8),e[r].curve=b,e[r].G=E,e[r].n=y,e[r].h=S,e[r].oid=p,e[r].info=f;for(var w=0;w<h.length;w++)t[h[w]]=r}},ue.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),ue.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),ue.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),ue.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),ue.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),ue.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),ue.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),ue.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),ue.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),ue.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.DSA=function(){var e=de,t=(e.getVbyList,e.getVbyListEx),n=e.isASN1HEX,r=E;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(e,t,n,r,i){this.isPrivate=!0,this.p=e,this.q=t,this.g=n,this.y=r,this.x=i},this.setPrivateHex=function(e,t,n,r,i){var o,s,a,u,c;o=new E(e,16),s=new E(t,16),a=new E(n,16),u="string"==typeof r&&r.length>1?new E(r,16):null,c=new E(i,16),this.setPrivate(o,s,a,u,c)},this.setPublic=function(e,t,n,r){this.isPublic=!0,this.p=e,this.q=t,this.g=n,this.y=r,this.x=null},this.setPublicHex=function(e,t,n,r){var i,o,s,a;i=new E(e,16),o=new E(t,16),s=new E(n,16),a=new E(r,16),this.setPublic(i,o,s,a)},this.signWithMessageHash=function(e){var t=this.p,n=this.q,r=this.g,i=(this.y,this.x),o=ue.crypto.Util.getRandomBigIntegerMinToMax(E.ONE.add(E.ONE),n.subtract(E.ONE)),s=new E(e.substr(0,n.bitLength()/4),16),a=r.modPow(o,t).mod(n),u=o.modInverse(n).multiply(s.add(i.multiply(a))).mod(n);return ue.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:a}},{int:{bigint:u}}]})},this.verifyWithMessageHash=function(e,t){var n=this.p,r=this.q,i=this.g,o=this.y,s=this.parseASN1Signature(t),a=s[0],u=s[1],c=new E(e.substr(0,r.bitLength()/4),16);if(E.ZERO.compareTo(a)>0||a.compareTo(r)>0)throw"invalid DSA signature";if(E.ZERO.compareTo(u)>=0||u.compareTo(r)>0)throw"invalid DSA signature";var l=u.modInverse(r),d=c.multiply(l).mod(r),h=a.multiply(l).mod(r);return 0==i.modPow(d,n).multiply(o.modPow(h,n)).mod(n).mod(r).compareTo(a)},this.parseASN1Signature=function(e){try{return[new r(t(e,0,[0],"02"),16),new r(t(e,0,[1],"02"),16)]}catch(e){throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(e){var r,i,o,s,a;if(!1===n(e))throw new Error("not ASN.1 hex string");try{r=t(e,0,[1],"02"),i=t(e,0,[2],"02"),o=t(e,0,[3],"02"),s=t(e,0,[4],"02"),a=t(e,0,[5],"02")}catch(e){throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(r,i,o,s,a)},this.readPKCS8PrvKeyHex=function(e){var r,i,o,s;if(!1===n(e))throw new Error("not ASN.1 hex string");try{r=t(e,0,[1,1,0],"02"),i=t(e,0,[1,1,1],"02"),o=t(e,0,[1,1,2],"02"),s=t(e,0,[2,0],"02")}catch(e){throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(r,i,o,null,s)},this.readPKCS8PubKeyHex=function(e){var r,i,o,s;if(!1===n(e))throw new Error("not ASN.1 hex string");try{r=t(e,0,[0,1,0],"02"),i=t(e,0,[0,1,1],"02"),o=t(e,0,[0,1,2],"02"),s=t(e,0,[1,0],"02")}catch(e){throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(r,i,o,s)},this.readCertPubKeyHex=function(e,r){var i,o,s,a;if(!1===n(e))throw new Error("not ASN.1 hex string");try{i=t(e,0,[0,5,0,1,0],"02"),o=t(e,0,[0,5,0,1,1],"02"),s=t(e,0,[0,5,0,1,2],"02"),a=t(e,0,[0,5,1,0],"02")}catch(e){throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(i,o,s,a)}};var We=function(){var e=function(e,n,r){return t(g.AES,e,n,r)},t=function(e,t,n,r){var i=g.enc.Hex.parse(t),o=g.enc.Hex.parse(n),s=g.enc.Hex.parse(r),a={};a.key=o,a.iv=s,a.ciphertext=i;var u=e.decrypt(a,o,{iv:s});return g.enc.Hex.stringify(u)},n=function(e,t,n){return r(g.AES,e,t,n)},r=function(e,t,n,r){var i=g.enc.Hex.parse(t),o=g.enc.Hex.parse(n),s=g.enc.Hex.parse(r),a=e.encrypt(i,o,{iv:s}),u=g.enc.Hex.parse(a.toString());return g.enc.Base64.stringify(u)},i={"AES-256-CBC":{proc:e,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:n,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(e,n,r){return t(g.TripleDES,e,n,r)},eproc:function(e,t,n){return r(g.TripleDES,e,t,n)},keylen:24,ivlen:8},"DES-CBC":{proc:function(e,n,r){return t(g.DES,e,n,r)},eproc:function(e,t,n){return r(g.DES,e,t,n)},keylen:8,ivlen:8}},o=function(e){var t={},n=e.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));n&&(t.cipher=n[1],t.ivsalt=n[2]);var r=e.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));r&&(t.type=r[1]);var i=-1,o=0;-1!=e.indexOf("\r\n\r\n")&&(i=e.indexOf("\r\n\r\n"),o=2),-1!=e.indexOf("\n\n")&&(i=e.indexOf("\n\n"),o=1);var s=e.indexOf("-----END");if(-1!=i&&-1!=s){var a=e.substring(i+2*o,s-o);a=a.replace(/\s+/g,""),t.data=a}return t},s=function(e,t,n){for(var r=n.substring(0,16),o=g.enc.Hex.parse(r),s=g.enc.Utf8.parse(t),a=i[e].keylen+i[e].ivlen,u="",c=null;;){var l=g.algo.MD5.create();if(null!=c&&l.update(c),l.update(s),l.update(o),c=l.finalize(),(u+=g.enc.Hex.stringify(c)).length>=2*a)break}var d={};return d.keyhex=u.substr(0,2*i[e].keylen),d.ivhex=u.substr(2*i[e].keylen,2*i[e].ivlen),d},a=function(e,t,n,r){var o=g.enc.Base64.parse(e),s=g.enc.Hex.stringify(o);return(0,i[t].proc)(s,n,r)};return{version:"1.0.0",parsePKCS5PEM:function(e){return o(e)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(e,t,n){return s(e,t,n)},decryptKeyB64:function(e,t,n,r){return a(e,t,n,r)},getDecryptedKeyHex:function(e,t){var n=o(e),r=(n.type,n.cipher),i=n.ivsalt,u=n.data,c=s(r,t,i).keyhex;return a(u,r,c,i)},getEncryptedPKCS5PEMFromPrvKeyHex:function(e,t,n,r,o){var a="";if(void 0!==r&&null!=r||(r="AES-256-CBC"),void 0===i[r])throw new Error("KEYUTIL unsupported algorithm: "+r);if(void 0===o||null==o){var u=function(e){var t=g.lib.WordArray.random(e);return g.enc.Hex.stringify(t)}(i[r].ivlen);o=u.toUpperCase()}var c=function(e,t,n,r){return(0,i[t].eproc)(e,n,r)}(t,r,s(r,n,o).keyhex,o);return a="-----BEGIN "+e+" PRIVATE KEY-----\r\n",a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+r+","+o+"\r\n",a+="\r\n",(a+=c.replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+e+" PRIVATE KEY-----\r\n"},getEncryptedPKCS8PEM:function(e,t,n){return Ie(this.getEncryptedPKCS8Hex(e,t,n),"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(e,t,n){var r;(r=null==n||null==n?{}:JSON.parse(JSON.stringify(n))).plain=e,this.initPBES2Param(r),this.encryptPBES2Param(r,t);var i=this.generatePBES2ASN1Param(r);return ue.asn1.ASN1Util.newObject(i).tohex()},initPBES2Param:function(e){var t;null==Ke(e,"encalg")&&(e.encalg="aes256-CBC"),null==Ke(e,"iter")&&(e.iter=2048),null==Ke(e,"prf")&&(e.prf="hmacWithSHA256"),null==Ke(e,"salt")&&(e.salt=g.enc.Hex.stringify(g.lib.WordArray.random(8))),null==Ke(e,"enciv")&&("des-EDE3-CBC"==e.encalg&&(t=8),"aes128-CBC"==e.encalg&&(t=16),"aes256-CBC"==e.encalg&&(t=16),e.enciv=g.enc.Hex.stringify(g.lib.WordArray.random(t)))},encryptPBES2Param:function(e,t){var n=We.getDKFromPBES2Param(e,t);try{var r=ue.crypto.Cipher.encrypt(e.plain,n,e.encalg,{iv:e.enciv})}catch(t){throw new Error("encrypt error: "+e.plain+" "+n+" "+e.encalg+" "+e.enciv)}e.enc=r},generatePBES2ASN1Param:function(e){var t={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:e.salt}},{int:{hex:je(e.iter)}}]}]},{seq:[{oid:e.encalg},{octstr:{hex:e.enciv}}]}]}]},{octstr:{hex:e.enc}}]};return"hmacWithSHA1"!=e.prf&&t.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:e.prf},{null:""}]}),t},parseHexOfEncryptedPKCS8:function(e){var t=de,n=t.getChildIdx,r=t.getV,i={},o=n(e,0);if(2!=o.length)throw new Error("malformed format: SEQUENCE(0).items != 2: "+o.length);i.ciphertext=r(e,o[1]);var s=n(e,o[0]);if(2!=s.length)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+s.length);if("2a864886f70d01050d"!=r(e,s[0]))throw new Error("this only supports pkcs5PBES2");var a=n(e,s[1]);if(2!=s.length)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+a.length);var u=n(e,a[1]);if(2!=u.length)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length);if("2a864886f70d0307"!=r(e,u[0]))throw"this only supports TripleDES";i.encryptionSchemeAlg="TripleDES",i.encryptionSchemeIV=r(e,u[1]);var c=n(e,a[0]);if(2!=c.length)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+c.length);if("2a864886f70d01050c"!=r(e,c[0]))throw new Error("this only supports pkcs5PBKDF2");var l=n(e,c[1]);if(l.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+l.length);i.pbkdf2Salt=r(e,l[0]);var d=r(e,l[1]);try{i.pbkdf2Iter=parseInt(d,16)}catch(e){throw new Error("malformed format pbkdf2Iter: "+d)}return i},getPBKDF2KeyHexFromParam:function(e,t){var n=g.enc.Hex.parse(e.pbkdf2Salt),r=e.pbkdf2Iter,i=g.PBKDF2(t,n,{keySize:6,iterations:r});return g.enc.Hex.stringify(i)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(e,t){var n=_e(e,"ENCRYPTED PRIVATE KEY"),r=this.parseHexOfEncryptedPKCS8(n),i=We.getPBKDF2KeyHexFromParam(r,t),o={};o.ciphertext=g.enc.Hex.parse(r.ciphertext);var s=g.enc.Hex.parse(i),a=g.enc.Hex.parse(r.encryptionSchemeIV),u=g.TripleDES.decrypt(o,s,{iv:a});return g.enc.Hex.stringify(u)},parsePBES2:function(e){var t=de.parse(e);if("pkcs5PBES2"!=Ke(t,"seq.0.seq.0.oid")||"pkcs5PBKDF2"!=Ke(t,"seq.0.seq.1.seq.0.seq.0.oid"))throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var n=Ke(t,"seq.0.seq.1.seq.0.seq.1.seq");if(null==n)throw new Error("PBKDF2 parameter not found");var r=Ke(n,"0.octstr.hex"),i=Ke(n,"1.int.hex"),o=Ke(n,"2.seq.0.oid","hmacWithSHA1"),s=-1;try{s=parseInt(i,16)}catch(e){throw new Error("iter not proper value")}var a=Ke(t,"seq.0.seq.1.seq.1.seq.0.oid"),u=Ke(t,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),c=Ke(t,"seq.1.octstr.hex");if(null==a||null==u||null==c)throw new Error("encalg, enciv or enc is undefined");return{salt:r,iter:s,prf:o,encalg:a,enciv:u,enc:c}},getDKFromPBES2Param:function(e,t){var n={hmacWithSHA1:g.algo.SHA1,hmacWithSHA224:g.algo.SHA224,hmacWithSHA256:g.algo.SHA256,hmacWithSHA384:g.algo.SHA384,hmacWithSHA512:g.algo.SHA512}[e.prf];if(null==n)throw new Error("unsupported prf");var r={"des-EDE3-CBC":6,"aes128-CBC":4,"aes256-CBC":8}[e.encalg];if(null==r)throw new Error("unsupported encalg");var i=g.enc.Hex.parse(e.salt),o=e.iter;try{var s=g.PBKDF2(t,i,{keySize:r,iterations:o,hasher:n});return g.enc.Hex.stringify(s)}catch(n){throw new Error("PBKDF2 error: "+n+" "+JSON.stringify(e)+" "+t)}},getPlainHexFromEncryptedPKCS8PEM:function(e,t){if(-1==e.indexOf("BEGIN ENCRYPTED PRIVATE KEY"))throw new Error("not Encrypted PKCS#8 PEM string");var n,r=_e(e);try{n=We.parsePBES2(r)}catch(e){throw new Error("malformed PBES2 format: "+e.message)}var i=We.getDKFromPBES2Param(n,t);return ue.crypto.Cipher.decrypt(n.enc,i,n.encalg,{iv:n.enciv})},getKeyFromEncryptedPKCS8PEM:function(e,t){var n=this.getPlainHexFromEncryptedPKCS8PEM(e,t);return this.getKeyFromPlainPrivatePKCS8Hex(n)},parsePlainPrivatePKCS8Hex:function(e){var t=de,n=t.getChildIdx,r=t.getV,i={algparam:null};if("30"!=e.substr(0,2))throw new Error("malformed plain PKCS8 private key(code:001)");var o=n(e,0);if(o.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if("30"!=e.substr(o[1],2))throw new Error("malformed PKCS8 private key(code:003)");var s=n(e,o[1]);if(2!=s.length)throw new Error("malformed PKCS8 private key(code:004)");if("06"!=e.substr(s[0],2))throw new Error("malformed PKCS8 private key(code:005)");if(i.algoid=r(e,s[0]),"06"==e.substr(s[1],2)&&(i.algparam=r(e,s[1])),"04"!=e.substr(o[2],2))throw new Error("malformed PKCS8 private key(code:006)");return i.keyidx=t.getVidx(e,o[2]),i},getKeyFromPlainPrivatePKCS8PEM:function(e){var t=_e(e,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(t)},getKeyFromPlainPrivatePKCS8Hex:function(e){var t,n=this.parsePlainPrivatePKCS8Hex(e);if("2a864886f70d010101"==n.algoid)t=new re;else if("2a8648ce380401"==n.algoid)t=new ue.crypto.DSA;else{if("2a8648ce3d0201"!=n.algoid)throw new Error("unsupported private key algorithm");t=new ue.crypto.ECDSA}return t.readPKCS8PrvKeyHex(e),t},_getKeyFromPublicPKCS8Hex:function(e){var t,n=de.getVbyList(e,0,[0,0],"06");if("2a864886f70d010101"===n)t=new re;else if("2a8648ce380401"===n)t=new ue.crypto.DSA;else{if("2a8648ce3d0201"!==n)throw new Error("unsupported PKCS#8 public key hex");t=new ue.crypto.ECDSA}return t.readPKCS8PubKeyHex(e),t},parsePublicRawRSAKeyHex:function(e){var t=de,n=t.getChildIdx,r=t.getV,i={};if("30"!=e.substr(0,2))throw new Error("malformed RSA key(code:001)");var o=n(e,0);if(2!=o.length)throw new Error("malformed RSA key(code:002)");if("02"!=e.substr(o[0],2))throw new Error("malformed RSA key(code:003)");if(i.n=r(e,o[0]),"02"!=e.substr(o[1],2))throw new Error("malformed RSA key(code:004)");return i.e=r(e,o[1]),i},parsePublicPKCS8Hex:function(e){var t=de,n=t.getChildIdx,r=t.getV,i={algparam:null},o=n(e,0);if(2!=o.length)throw new Error("outer DERSequence shall have 2 elements: "+o.length);var s=o[0];if("30"!=e.substr(s,2))throw new Error("malformed PKCS8 public key(code:001)");var a=n(e,s);if(2!=a.length)throw new Error("malformed PKCS8 public key(code:002)");if("06"!=e.substr(a[0],2))throw new Error("malformed PKCS8 public key(code:003)");if(i.algoid=r(e,a[0]),"06"==e.substr(a[1],2)?i.algparam=r(e,a[1]):"30"==e.substr(a[1],2)&&(i.algparam={},i.algparam.p=t.getVbyList(e,a[1],[0],"02"),i.algparam.q=t.getVbyList(e,a[1],[1],"02"),i.algparam.g=t.getVbyList(e,a[1],[2],"02")),"03"!=e.substr(o[1],2))throw new Error("malformed PKCS8 public key(code:004)");return i.key=r(e,o[1]).substr(2),i}}}();function Ge(e,t){for(var n="",r=t/4-e.length,i=0;i<r;i++)n+="0";return n+e}function ze(e,t,n){for(var r="",i=0;r.length<t;)r+=Ee(n(we(e+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])))),i+=1;return r}function Je(e){for(var t in ue.crypto.Util.DIGESTINFOHEAD){var n=ue.crypto.Util.DIGESTINFOHEAD[t],r=n.length;if(e.substring(0,r)==n)return[t,e.substring(r)]}return[]}function Qe(e){var t,n=de,r=n.getChildIdx,i=n.getV,o=(n.dump,n.parse),s=n.getTLV,a=n.getVbyList,u=n.getVbyListEx,c=n.getTLVbyList,l=n.getTLVbyListEx,d=n.getIdxbyList,h=n.getIdxbyListEx,p=n.getVidx,f=n.getInt,g=n.oidname,m=n.hextooidstr,v=_e,y=Error;try{t=ue.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(e){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(null===this.hex||0!==this.version)return this.version;var e=c(this.hex,0,[0,0]);if("a0"==e.substr(0,2)){var t=c(e,0,[0]),n=f(t,0);if(n<0||2<n)throw new Error("malformed version field");return this.version=n+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return u(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var e=l(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(e)},this.getAlgorithmIdentifierName=function(e){for(var n in t)if(e===t[n])return n;return g(u(e,0,[0],"06"))},this.getIssuer=function(e,t){return this.getX500Name(this.getIssuerHex(),e,t)},this.getIssuerHex=function(){return c(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(e,t){return this.getX500Name(this.getSubjectHex(),e,t)},this.getSubjectHex=function(){return c(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var e=a(this.hex,0,[0,4+this.foffset,0]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getNotAfter=function(){var e=a(this.hex,0,[0,4+this.foffset,1]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return c(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var e=this.getSPKI();return null==e?null:a(e,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return d(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var e=this.getPublicKeyIdx();return d(this.hex,e,[1,0],"30")},this.getPublicKey=function(){return We.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var e=c(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(e)},this.getSignatureValueHex=function(){return a(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmField(),n=this.getSignatureValueHex(),r=c(this.hex,0,[0],"30"),i=new ue.crypto.Signature({alg:t});return i.init(e),i.updateHex(r),i.verify(n)},this.parseExt=function(e){var t,o,s;if(void 0===e){if(s=this.hex,3!==this.version)return-1;t=d(s,0,[0,7,0],"30"),o=r(s,t)}else{s=_e(e);var u=d(s,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=i(s,u))return void(this.aExtInfo=new Array);t=d(s,0,[0,3,0,1,0],"30"),o=r(s,t),this.hex=s}this.aExtInfo=new Array;for(var c=0;c<o.length;c++){var l={critical:!1},h=0;3===r(s,o[c]).length&&(l.critical=!0,h=1),l.oid=n.hextooidstr(a(s,o[c],[0],"06"));var f=d(s,o[c],[1+h]);l.vidx=p(s,f),this.aExtInfo.push(l)}},this.getExtInfo=function(e){var t=this.aExtInfo,n=e;if(e.match(/^[0-9.]+$/)||(n=ue.asn1.x509.OID.name2oid(e)),""!==n)for(var r=0;r<t.length;r++)if(t[r].oid===n)return t[r]},this.getCriticalExtV=function(e,t,n){if(null!=t)return[t,n];var r=this.getExtInfo(e);return null==r?[null,null]:[s(this.hex,r.vidx),r.critical]},this.getExtBasicConstraints=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("basicConstraints");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"basicConstraints"};if(t&&(r.critical=!0),"3000"===e)return r;if("30030101ff"===e)return r.cA=!0,r;if("30060101ff02"===e.substr(0,12)){var o=i(e,10),a=parseInt(o,16);return r.cA=!0,r.pathLen=a,r}throw new Error("hExtV parse error: "+e)},this.getExtNameConstraints=function(e,t){var n=this.getCriticalExtV("nameConstraints",e,t);if(e=n[0],t=n[1],null!=e){var i={extname:"nameConstraints"};t&&(i.critical=!0);for(var o=r(e,0),a=0;a<o.length;a++){for(var u=[],c=r(e,o[a]),l=0;l<c.length;l++){var d=s(e,c[l]),h=this.getGeneralSubtree(d);u.push(h)}var p=e.substr(o[a],2);"a0"==p?i.permit=u:"a1"==p&&(i.exclude=u)}return i}},this.getGeneralSubtree=function(e){var t=r(e,0),n=t.length;if(n<1||2<n)throw new Error("wrong num elements");for(var o=this.getGeneralName(s(e,t[0])),a=1;a<n;a++){var u=e.substr(t[a],2),c=i(e,t[a]),l=parseInt(c,16);"80"==u&&(o.min=l),"81"==u&&(o.max=l)}return o},this.getExtKeyUsage=function(e,t){var n=this.getCriticalExtV("keyUsage",e,t);if(e=n[0],t=n[1],null!=e){var r={extname:"keyUsage"};return t&&(r.critical=!0),r.names=this.getExtKeyUsageString(e).split(","),r}},this.getExtKeyUsageBin=function(e){if(void 0===e){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";e=s(this.hex,t.vidx)}if(8!=e.length&&10!=e.length)throw new Error("malformed key usage value: "+e);var n="000000000000000"+parseInt(e.substr(6),16).toString(2);return 8==e.length&&(n=n.slice(-8)),10==e.length&&(n=n.slice(-16)),""==(n=n.replace(/0+$/,""))&&(n="0"),n},this.getExtKeyUsageString=function(e){for(var t=this.getExtKeyUsageBin(e),n=new Array,r=0;r<t.length;r++)"1"==t.substr(r,1)&&n.push(Qe.KEYUSAGE_NAME[r]);return n.join(",")},this.getExtSubjectKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("subjectKeyIdentifier");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"subjectKeyIdentifier"};t&&(r.critical=!0);var o=i(e,0);return r.kid={hex:o},r},this.getExtAuthorityKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("authorityKeyIdentifier");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var o={extname:"authorityKeyIdentifier"};t&&(o.critical=!0);for(var a=r(e,0),u=0;u<a.length;u++){var c=e.substr(a[u],2);if("80"===c&&(o.kid={hex:i(e,a[u])}),"a1"===c){var l=s(e,a[u]),d=this.getGeneralNames(l);o.issuer=d[0].dn}"82"===c&&(o.sn={hex:i(e,a[u])})}return o},this.getExtExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("extKeyUsage");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var o={extname:"extKeyUsage",array:[]};t&&(o.critical=!0);for(var a=r(e,0),u=0;u<a.length;u++)o.array.push(g(i(e,a[u])));return o},this.getExtExtKeyUsageName=function(){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return e;var t=new Array,n=s(this.hex,e.vidx);if(""===n)return t;for(var o=r(n,0),a=0;a<o.length;a++)t.push(g(i(n,o[a])));return t},this.getExtSubjectAltName=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("subjectAltName");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"subjectAltName",array:[]};return t&&(r.critical=!0),r.array=this.getGeneralNames(e),r},this.getExtIssuerAltName=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("issuerAltName");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"issuerAltName",array:[]};return t&&(r.critical=!0),r.array=this.getGeneralNames(e),r},this.getGeneralNames=function(e){for(var t=r(e,0),n=[],i=0;i<t.length;i++){var o=this.getGeneralName(s(e,t[i]));void 0!==o&&n.push(o)}return n},this.getGeneralName=function(e){var t=e.substr(0,2),n=i(e,0),r=Ee(n);return"81"==t?{rfc822:r}:"82"==t?{dns:r}:"86"==t?{uri:r}:"87"==t?{ip:Pe(n)}:"a4"==t?{dn:this.getX500Name(n)}:"a0"==t?{other:this.getOtherName(e)}:void 0},this.getExtSubjectAltName2=function(){var e,t,n,o=this.getExtInfo("subjectAltName");if(void 0===o)return o;for(var a=new Array,u=s(this.hex,o.vidx),c=r(u,0),l=0;l<c.length;l++)n=u.substr(c[l],2),e=i(u,c[l]),"81"===n&&(t=Se(e),a.push(["MAIL",t])),"82"===n&&(t=Se(e),a.push(["DNS",t])),"84"===n&&(t=Qe.hex2dn(e,0),a.push(["DN",t])),"86"===n&&(t=Se(e),a.push(["URI",t])),"87"===n&&(t=Pe(e),a.push(["IP",t]));return a},this.getExtCRLDistributionPoints=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("cRLDistributionPoints");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"cRLDistributionPoints",array:[]};t&&(i.critical=!0);for(var o=r(e,0),a=0;a<o.length;a++){var u=s(e,o[a]);i.array.push(this.getDistributionPoint(u))}return i},this.getDistributionPoint=function(e){for(var t={},n=r(e,0),i=0;i<n.length;i++){var o=e.substr(n[i],2),a=s(e,n[i]);"a0"==o&&(t.dpname=this.getDistributionPointName(a))}return t},this.getDistributionPointName=function(e){for(var t={},n=r(e,0),i=0;i<n.length;i++){var o=e.substr(n[i],2),a=s(e,n[i]);"a0"==o&&(t.full=this.getGeneralNames(a))}return t},this.getExtCRLDistributionPointsURI=function(){var e=this.getExtCRLDistributionPoints();if(null==e)return e;for(var t=e.array,n=[],r=0;r<t.length;r++)try{null!=t[r].dpname.full[0].uri&&n.push(t[r].dpname.full[0].uri)}catch(e){}return n},this.getExtAIAInfo=function(){var e=this.getExtInfo("authorityInfoAccess");if(void 0===e)return e;for(var t={ocsp:[],caissuer:[]},n=r(this.hex,e.vidx),i=0;i<n.length;i++){var o=a(this.hex,n[i],[0],"06"),s=a(this.hex,n[i],[1],"86");"2b06010505073001"===o&&t.ocsp.push(Se(s)),"2b06010505073002"===o&&t.caissuer.push(Se(s))}return t},this.getExtAuthorityInfoAccess=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("authorityInfoAccess");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"authorityInfoAccess",array:[]};t&&(i.critical=!0);for(var o=r(e,0),c=0;c<o.length;c++){var l=u(e,o[c],[0],"06"),d=Se(a(e,o[c],[1],"86"));if("2b06010505073001"==l)i.array.push({ocsp:d});else{if("2b06010505073002"!=l)throw new Error("unknown method: "+l);i.array.push({caissuer:d})}}return i},this.getExtCertificatePolicies=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("certificatePolicies");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"certificatePolicies",array:[]};t&&(i.critical=!0);for(var o=r(e,0),a=0;a<o.length;a++){var u=s(e,o[a]),c=this.getPolicyInformation(u);i.array.push(c)}return i},this.getPolicyInformation=function(e){var t={},n=a(e,0,[0],"06");t.policyoid=g(n);var i=h(e,0,[1],"30");if(-1!=i){t.array=[];for(var o=r(e,i),u=0;u<o.length;u++){var c=s(e,o[u]),l=this.getPolicyQualifierInfo(c);t.array.push(l)}}return t},this.getOtherName=function(e){var t={},n=r(e,0),i=a(e,n[0],[],"06"),s=a(e,n[1],[]);return t.oid=g(i),t.value=o(s),t},this.getPolicyQualifierInfo=function(e){var t={},n=a(e,0,[0],"06");if("2b06010505070201"===n){var r=u(e,0,[1],"16");t.cps=Ee(r)}else if("2b06010505070202"===n){var i=c(e,0,[1],"30");t.unotice=this.getUserNotice(i)}return t},this.getUserNotice=function(e){var t=null;try{return t=n.parse(e),this._asn1ToUnotice(t)}catch(e){return}},this._asn1ToUnotice=function(e){try{for(var t={},n=Ke(e,"seq"),r=0;r<n.length;r++){var i=this._asn1ToNoticeRef(n[r]);null!=i&&(t.noticeref=i);var o=this.asn1ToDisplayText(n[r]);null!=o&&(t.exptext=o)}return Object.keys(t).length>0?t:void 0}catch(e){return}},this._asn1ToNoticeRef=function(e){try{for(var t={},n=Ke(e,"seq"),r=0;r<n.length;r++){var i=this._asn1ToNoticeNum(n[r]);null!=i&&(t.noticenum=i);var o=this.asn1ToDisplayText(n[r]);null!=o&&(t.org=o)}return Object.keys(t).length>0?t:void 0}catch(e){return}},this._asn1ToNoticeNum=function(e){try{for(var t=Ke(e,"seq"),n=[],r=0;r<t.length;r++){var i=t[r];n.push(parseInt(Ke(i,"int.hex"),16))}return n}catch(e){return}},this.getDisplayText=function(e){var t={};return t.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[e.substr(0,2)],t.str=Ee(i(e,0)),t},this.asn1ToDisplayText=function(e){return null!=e.utf8str?{type:"utf8",str:e.utf8str.str}:null!=e.ia5str?{type:"ia5",str:e.ia5str.str}:null!=e.visstr?{type:"vis",str:e.visstr.str}:null!=e.bmpstr?{type:"bmp",str:e.bmpstr.str}:null!=e.prnstr?{type:"prn",str:e.prnstr.str}:void 0},this.getExtPolicyMappings=function(e,t){var n=this.getCriticalExtV("policyMappings",e,t);if(e=n[0],t=n[1],null!=e){var r={extname:"policyMappings"};t&&(r.critical=!0);try{for(var i=o(e).seq,s=[],a=0;a<i.length;a++){var u=i[a].seq;s.push([u[0].oid,u[1].oid])}r.array=s}catch(e){throw new y("malformed policyMappings")}return r}},this.getExtPolicyConstraints=function(e,t){var n=this.getCriticalExtV("policyConstraints",e,t);if(e=n[0],t=n[1],null!=e){var r={extname:"policyConstraints"};t&&(r.critical=!0);var i=o(e);try{for(var s=i.seq,a=0;a<s.length;a++){var u=s[a].tag;0==u.explicit&&("80"==u.tag&&(r.reqexp=parseInt(u.hex,16)),"81"==u.tag&&(r.inhibit=parseInt(u.hex,16)))}}catch(e){return new y("malformed policyConstraints value")}return r}},this.getExtInhibitAnyPolicy=function(e,t){var n=this.getCriticalExtV("inhibitAnyPolicy",e,t);if(e=n[0],t=n[1],null!=e){var r={extname:"inhibitAnyPolicy"};t&&(r.critical=!0);var i=f(e,0);return-1==i?new y("wrong value"):(r.skip=i,r)}},this.getExtCRLNumber=function(e,t){var n={extname:"cRLNumber"};if(t&&(n.critical=!0),"02"==e.substr(0,2))return n.num={hex:i(e,0)},n;throw new y("hExtV parse error: "+e)},this.getExtCRLReason=function(e,t){var n={extname:"cRLReason"};if(t&&(n.critical=!0),"0a"==e.substr(0,2))return n.code=parseInt(i(e,0),16),n;throw new Error("hExtV parse error: "+e)},this.getExtOcspNonce=function(e,t){var n={extname:"ocspNonce"};t&&(n.critical=!0);var r=i(e,0);return n.hex=r,n},this.getExtOcspNoCheck=function(e,t){var n={extname:"ocspNoCheck"};return t&&(n.critical=!0),n},this.getExtAdobeTimeStamp=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("adobeTimeStamp");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"adobeTimeStamp"};t&&(i.critical=!0);var o=r(e,0);if(o.length>1){var a=s(e,o[1]),u=this.getGeneralName(a);null!=u.uri&&(i.uri=u.uri)}if(o.length>2){var c=s(e,o[2]);"0101ff"==c&&(i.reqauth=!0),"010100"==c&&(i.reqauth=!1)}return i},this.getExtSubjectDirectoryAttributes=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("subjectDirectoryAttributes");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"subjectDirectoryAttributes"};t&&(r.critical=!0);try{for(var i=o(e),a=[],u=0;u<i.seq.length;u++){var c=i.seq[u],l=Ke(c,"seq.0.oid"),d=Ke(c,"seq.1.set");if(null==l||null==d)throw"error";a.push({attr:l,array:d})}return r.array=a,r}catch(e){throw new Error("malformed subjectDirectoryAttributes extension value")}};var S=function(e){var t={};try{var n=e.seq[0].oid,r=ue.asn1.x509.OID.name2oid(n);t.type=ue.asn1.x509.OID.oid2atype(r);var i=e.seq[1];if(null!=i.utf8str)t.ds="utf8",t.value=i.utf8str.str;else if(null!=i.numstr)t.ds="num",t.value=i.numstr.str;else if(null!=i.telstr)t.ds="tel",t.value=i.telstr.str;else if(null!=i.prnstr)t.ds="prn",t.value=i.prnstr.str;else if(null!=i.ia5str)t.ds="ia5",t.value=i.ia5str.str;else if(null!=i.visstr)t.ds="vis",t.value=i.visstr.str;else{if(null==i.bmpstr)throw"error";t.ds="bmp",t.value=i.bmpstr.str}return t}catch(e){throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},b=function(e){try{return e.set.map((function(e){return S(e)}))}catch(e){throw new Error("improper ASN.1 parsed RDN: "+e)}};this.getX500NameRule=function(e){for(var t=null,n=[],r=0;r<e.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(i[o]);for(r=0;r<n.length;r++){var s=n[r],a=s.ds,u=s.value,c=s.type;if("prn"!=a&&"utf8"!=a&&"ia5"!=a)return"mixed";if("ia5"==a){if("CN"!=c)return"mixed";if(ue.lang.String.isMail(u))continue;return"mixed"}if("C"==c){if("prn"==a)continue;return"mixed"}if(null==t)t=a;else if(t!==a)return"mixed"}return null==t?"prn":t},this.getAttrTypeAndValue=function(e){var t=o(e);return S(t)},this.getRDN=function(e){var t=o(e);return b(t)},this.getX500NameArray=function(e){return function(e){try{return e.seq.map((function(e){return b(e)}))}catch(e){throw new Error("improper ASN.1 parsed X500Name: "+e)}}(o(e))},this.getX500Name=function(e,t,n){var r=this.getX500NameArray(e),i={str:this.dnarraytostr(r)};return i.array=r,1==n&&(i.hex=e),1==t&&(i.canon=this.c14nRDNArray(r)),i},this.readCertPEM=function(e){this.readCertHex(v(e))},this.readCertHex=function(e){this.hex=e,this.getVersion();try{d(this.hex,0,[0,7],"a3"),this.parseExt()}catch(e){}},this.getParam=function(e){var t={};return null==e&&(e={}),t.version=this.getVersion(),t.serial={hex:this.getSerialNumberHex()},t.sigalg=this.getSignatureAlgorithmField(),t.issuer=this.getIssuer(e.dncanon,e.dnhex),t.notbefore=this.getNotBefore(),t.notafter=this.getNotAfter(),t.subject=this.getSubject(e.dncanon,e.dnhex),t.sbjpubkey=Ie(this.getPublicKeyHex(),"PUBLIC KEY"),null!=this.aExtInfo&&this.aExtInfo.length>0&&(t.ext=this.getExtParamArray()),t.sighex=this.getSignatureValueHex(),1==e.tbshex&&(t.tbshex=c(this.hex,0,[0])),1==e.nodnarray&&(delete t.issuer.array,delete t.subject.array),t},this.getExtParamArray=function(e){null==e&&-1!=h(this.hex,0,[0,"[3]"])&&(e=l(this.hex,0,[0,"[3]",0],"30"));for(var t=[],n=r(e,0),i=0;i<n.length;i++){var o=s(e,n[i]),a=this.getExtParam(o);null!=a&&t.push(a)}return t},this.getExtParam=function(e){var t=r(e,0).length;if(2!=t&&3!=t)throw new Error("wrong number elements in Extension: "+t+" "+e);var n=m(a(e,0,[0],"06")),i=!1;3==t&&"0101ff"==c(e,0,[1])&&(i=!0);var s=c(e,0,[t-1,0]),u=void 0;if("2.5.29.14"==n?u=this.getExtSubjectKeyIdentifier(s,i):"2.5.29.15"==n?u=this.getExtKeyUsage(s,i):"2.5.29.17"==n?u=this.getExtSubjectAltName(s,i):"2.5.29.18"==n?u=this.getExtIssuerAltName(s,i):"2.5.29.19"==n?u=this.getExtBasicConstraints(s,i):"2.5.29.30"==n?u=this.getExtNameConstraints(s,i):"2.5.29.31"==n?u=this.getExtCRLDistributionPoints(s,i):"2.5.29.32"==n?u=this.getExtCertificatePolicies(s,i):"2.5.29.33"==n?u=this.getExtPolicyMappings(s,i):"2.5.29.35"==n?u=this.getExtAuthorityKeyIdentifier(s,i):"2.5.29.36"==n?u=this.getExtPolicyConstraints(s,i):"2.5.29.37"==n?u=this.getExtExtKeyUsage(s,i):"2.5.29.54"==n?u=this.getExtInhibitAnyPolicy(s,i):"1.3.6.1.5.5.7.1.1"==n?u=this.getExtAuthorityInfoAccess(s,i):"2.5.29.20"==n?u=this.getExtCRLNumber(s,i):"2.5.29.21"==n?u=this.getExtCRLReason(s,i):"2.5.29.9"==n?u=this.getExtSubjectDirectoryAttributes(s,i):"1.3.6.1.5.5.7.48.1.2"==n?u=this.getExtOcspNonce(s,i):"1.3.6.1.5.5.7.48.1.5"==n?u=this.getExtOcspNoCheck(s,i):"1.2.840.113583.1.1.9.1"==n?u=this.getExtAdobeTimeStamp(s,i):null!=Qe.EXT_PARSER[n]&&(u=Qe.EXT_PARSER[n](n,i,s)),null!=u)return u;var l={extname:n,extn:s};try{l.extn=o(s)}catch(e){}return i&&(l.critical=!0),l},this.findExt=function(e,t){for(var n=0;n<e.length;n++)if(e[n].extname==t)return e[n];return null},this.updateExtCDPFullURI=function(e,t){var n=this.findExt(e,"cRLDistributionPoints");if(null!=n&&null!=n.array)for(var r=n.array,i=0;i<r.length;i++)if(null!=r[i].dpname&&null!=r[i].dpname.full)for(var o=r[i].dpname.full,s=0;s<o.length;s++){var a=o[i];null!=a.uri&&(a.uri=t)}},this.updateExtAIAOCSP=function(e,t){var n=this.findExt(e,"authorityInfoAccess");if(null!=n&&null!=n.array)for(var r=n.array,i=0;i<r.length;i++)null!=r[i].ocsp&&(r[i].ocsp=t)},this.updateExtAIACAIssuer=function(e,t){var n=this.findExt(e,"authorityInfoAccess");if(null!=n&&null!=n.array)for(var r=n.array,i=0;i<r.length;i++)null!=r[i].caissuer&&(r[i].caissuer=t)},this.dnarraytostr=function(e){return"/"+e.map((function(e){return function(e){return e.map((function(e){return function(e){return e.type+"="+e.value}(e).replace(/\+/,"\\+")})).join("+")}(e).replace(/\//,"\\/")})).join("/")},this.setCanonicalizedDN=function(e){var t;if(null!=e.str&&null==e.array){var n=new ue.asn1.x509.X500Name({str:e.str}).tohex();t=this.getX500NameArray(n)}else t=e.array;null==e.canon&&(e.canon=this.c14nRDNArray(t))},this.c14nRDNArray=function(e){for(var t=[],n=0;n<e.length;n++){for(var r=e[n],i=[],o=0;o<r.length;o++){var s=r[o],a=s.value;a=(a=(a=(a=a.replace(/^\s*/,"")).replace(/\s*$/,"")).replace(/\s+/g," ")).toLowerCase(),i.push(s.type.toLowerCase()+"="+a)}t.push(i.join("+"))}return"/"+t.join("/")},this.getInfo=function(){var e,t,n,r=function(e){for(var t="",n="    ",r="\n",i=e.array,o=0;o<i.length;o++){var s=i[o];null!=s.dn&&(t+=n+"dn: "+s.dn.str+r),null!=s.ip&&(t+=n+"ip: "+s.ip+r),null!=s.rfc822&&(t+=n+"rfc822: "+s.rfc822+r),null!=s.dns&&(t+=n+"dns: "+s.dns+r),null!=s.uri&&(t+=n+"uri: "+s.uri+r),null!=s.other&&(t+=n+"other: "+s.other.oid+"="+JSON.stringify(s.other.value).replace(/\"/g,"")+r)}return t.replace(/\n$/,"")},i=function(e){for(var t="",n=e.array,r=0;r<n.length;r++){var i=n[r];if(t+="    policy oid: "+i.policyoid+"\n",void 0!==i.array)for(var o=0;o<i.array.length;o++){var s=i.array[o];void 0!==s.cps&&(t+="    cps: "+s.cps+"\n")}}return t},o=function(e){for(var t="",n=e.array,r=0;r<n.length;r++){var i=n[r];try{void 0!==i.dpname.full[0].uri&&(t+="    "+i.dpname.full[0].uri+"\n")}catch(e){}try{void 0!==i.dname.full[0].dn.hex&&(t+="    "+Qe.hex2dn(i.dpname.full[0].dn.hex)+"\n")}catch(e){}}return t},s=function(e){for(var t="",n=e.array,r=0;r<n.length;r++){var i=n[r];void 0!==i.caissuer&&(t+="    caissuer: "+i.caissuer+"\n"),void 0!==i.ocsp&&(t+="    ocsp: "+i.ocsp+"\n")}return t};if(e="Basic Fields\n",e+="  serial number: "+this.getSerialNumberHex()+"\n",e+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",e+="  issuer: "+this.getIssuerString()+"\n",e+="  notBefore: "+this.getNotBefore()+"\n",e+="  notAfter: "+this.getNotAfter()+"\n",e+="  subject: "+this.getSubjectString()+"\n",e+="  subject public key info: \n",e+="    key algorithm: "+(t=this.getPublicKey()).type+"\n","RSA"===t.type&&(e+="    n="+Ve(t.n.toString(16)).substr(0,16)+"...\n",e+="    e="+Ve(t.e.toString(16))+"\n"),null!=(n=this.aExtInfo)){e+="X509v3 Extensions:\n";for(var a=0;a<n.length;a++){var u=n[a],c=ue.asn1.x509.OID.oid2name(u.oid);""===c&&(c=u.oid);var l="";if(!0===u.critical&&(l="CRITICAL"),e+="  "+c+" "+l+":\n","basicConstraints"===c){var d=this.getExtBasicConstraints();void 0===d.cA?e+="    {}\n":(e+="    cA=true",void 0!==d.pathLen&&(e+=", pathLen="+d.pathLen),e+="\n")}else{var h;if("policyMappings"==c)e+="    "+this.getExtPolicyMappings().array.map((function(e){var t=e;return t[0]+":"+t[1]})).join(", ")+"\n";else if("policyConstraints"==c)e+="    ",null!=(h=this.getExtPolicyConstraints()).reqexp&&(e+=" reqexp="+h.reqexp),null!=h.inhibit&&(e+=" inhibit="+h.inhibit),e+="\n";else if("inhibitAnyPolicy"==c)e+="    skip="+(h=this.getExtInhibitAnyPolicy()).skip+"\n";else if("keyUsage"==c)e+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"==c)e+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"==c){var p=this.getExtAuthorityKeyIdentifier();void 0!==p.kid&&(e+="    kid="+p.kid.hex+"\n")}else"extKeyUsage"==c?e+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"==c?e+=r(this.getExtSubjectAltName())+"\n":"cRLDistributionPoints"==c?e+=o(this.getExtCRLDistributionPoints()):"authorityInfoAccess"==c?e+=s(this.getExtAuthorityInfoAccess()):"certificatePolicies"==c&&(e+=i(this.getExtCertificatePolicies()))}}}return(e+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n")+"signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?this.readCertPEM(e):ue.lang.String.isHex(e)&&this.readCertHex(e))}We.getKey=function(e,t,n){var r,i=(v=de).getChildIdx,o=(v.getV,v.getVbyList),s=ue.crypto,a=s.ECDSA,u=s.DSA,c=re,l=_e,d=We;if(void 0!==c&&e instanceof c)return e;if(void 0!==a&&e instanceof a)return e;if(void 0!==u&&e instanceof u)return e;if(void 0!==e.curve&&void 0!==e.xy&&void 0===e.d)return new a({pub:e.xy,curve:e.curve});if(void 0!==e.curve&&void 0!==e.d)return new a({prv:e.d,curve:e.curve});if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(O=new c).setPublic(e.n,e.e),O;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.co&&void 0===e.qi)return(O=new c).setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),O;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0===e.p)return(O=new c).setPrivate(e.n,e.e,e.d),O;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0===e.x)return(O=new u).setPublic(e.p,e.q,e.g,e.y),O;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0!==e.x)return(O=new u).setPrivate(e.p,e.q,e.g,e.y,e.x),O;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(O=new c).setPublic(ve(e.n),ve(e.e)),O;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.qi)return(O=new c).setPrivateEx(ve(e.n),ve(e.e),ve(e.d),ve(e.p),ve(e.q),ve(e.dp),ve(e.dq),ve(e.qi)),O;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d)return(O=new c).setPrivate(ve(e.n),ve(e.e),ve(e.d)),O;if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0===e.d){var h=(R=new a({curve:e.crv})).ecparams.keycharlen,p="04"+("0000000000"+ve(e.x)).slice(-h)+("0000000000"+ve(e.y)).slice(-h);return R.setPublicKeyHex(p),R}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0!==e.d){h=(R=new a({curve:e.crv})).ecparams.keycharlen,p="04"+("0000000000"+ve(e.x)).slice(-h)+("0000000000"+ve(e.y)).slice(-h);var f=("0000000000"+ve(e.d)).slice(-h);return R.setPublicKeyHex(p),R.setPrivateKeyHex(f),R}if("pkcs5prv"===n){var g,m=e,v=de;if(9===(g=i(m,0)).length)(O=new c).readPKCS5PrvKeyHex(m);else if(6===g.length)(O=new u).readPKCS5PrvKeyHex(m);else{if(!(g.length>2&&"04"===m.substr(g[1],2)))throw new Error("unsupported PKCS#1/5 hexadecimal key");(O=new a).readPKCS5PrvKeyHex(m)}return O}if("pkcs8prv"===n)return d.getKeyFromPlainPrivatePKCS8Hex(e);if("pkcs8pub"===n)return d._getKeyFromPublicPKCS8Hex(e);if("x509pub"===n)return Qe.getPublicKeyFromCertHex(e);if(-1!=e.indexOf("-END CERTIFICATE-",0)||-1!=e.indexOf("-END X509 CERTIFICATE-",0)||-1!=e.indexOf("-END TRUSTED CERTIFICATE-",0))return Qe.getPublicKeyFromCertPEM(e);if(-1!=e.indexOf("-END PUBLIC KEY-")){var y=_e(e,"PUBLIC KEY");return d._getKeyFromPublicPKCS8Hex(y)}if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var S=l(e,"RSA PRIVATE KEY");return d.getKey(S,null,"pkcs5prv")}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var b=o(r=l(e,"DSA PRIVATE KEY"),0,[1],"02"),w=o(r,0,[2],"02"),I=o(r,0,[3],"02"),_=o(r,0,[4],"02"),C=o(r,0,[5],"02");return(O=new u).setPrivate(new E(b,16),new E(w,16),new E(I,16),new E(_,16),new E(C,16)),O}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED"))return S=l(e,"EC PRIVATE KEY"),d.getKey(S,null,"pkcs5prv");if(-1!=e.indexOf("-END PRIVATE KEY-"))return d.getKeyFromPlainPrivatePKCS8PEM(e);if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var A=d.getDecryptedKeyHex(e,t),T=new re;return T.readPKCS5PrvKeyHex(A),T}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var R,O=o(r=d.getDecryptedKeyHex(e,t),0,[1],"04"),P=o(r,0,[2,0],"06"),D=o(r,0,[3,0],"03").substr(2);if(void 0===ue.crypto.OID.oidhex2name[P])throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+P);return(R=new a({curve:ue.crypto.OID.oidhex2name[P]})).setPublicKeyHex(D),R.setPrivateKeyHex(O),R.isPublic=!1,R}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED"))return b=o(r=d.getDecryptedKeyHex(e,t),0,[1],"02"),w=o(r,0,[2],"02"),I=o(r,0,[3],"02"),_=o(r,0,[4],"02"),C=o(r,0,[5],"02"),(O=new u).setPrivate(new E(b,16),new E(w,16),new E(I,16),new E(_,16),new E(C,16)),O;if(-1!=e.indexOf("-END ENCRYPTED PRIVATE KEY-"))return d.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")},We.generateKeypair=function(e,t){if("RSA"==e){var n=t;(s=new re).generate(n,"10001"),s.isPrivate=!0,s.isPublic=!0;var r=new re,i=s.n.toString(16),o=s.e.toString(16);return r.setPublic(i,o),r.isPrivate=!1,r.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=r,a}if("EC"==e){var s,a,u=t,c=new ue.crypto.ECDSA({curve:u}).generateKeyPairHex();return(s=new ue.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),s.setPrivateKeyHex(c.ecprvhex),s.isPrivate=!0,s.isPublic=!1,(r=new ue.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),r.isPrivate=!1,r.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=r,a}throw new Error("unknown algorithm: "+e)},We.getPEM=function(e,t,n,r,i,o){var s=ue,a=s.asn1,u=a.DERObjectIdentifier,c=a.DERInteger,l=a.ASN1Util.newObject,d=a.x509.SubjectPublicKeyInfo,h=s.crypto,p=h.DSA,f=h.ECDSA,g=re;function m(e){return l({seq:[{int:0},{int:{bigint:e.n}},{int:e.e},{int:{bigint:e.d}},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.dmp1}},{int:{bigint:e.dmq1}},{int:{bigint:e.coeff}}]})}function v(e){return l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a0",!0,{oid:{name:e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]})}function y(e){return l({seq:[{int:0},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}},{int:{bigint:e.y}},{int:{bigint:e.x}}]})}if((void 0!==g&&e instanceof g||void 0!==p&&e instanceof p||void 0!==f&&e instanceof f)&&1==e.isPublic&&(void 0===t||"PKCS8PUB"==t))return Ie(w=new d(e).tohex(),"PUBLIC KEY");if("PKCS1PRV"==t&&void 0!==g&&e instanceof g&&(void 0===n||null==n)&&1==e.isPrivate)return Ie(w=m(e).tohex(),"RSA PRIVATE KEY");if("PKCS1PRV"==t&&void 0!==f&&e instanceof f&&(void 0===n||null==n)&&1==e.isPrivate){var S=new u({name:e.curveName}).tohex(),b=v(e).tohex(),E="";return(E+=Ie(S,"EC PARAMETERS"))+Ie(b,"EC PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==p&&e instanceof p&&(void 0===n||null==n)&&1==e.isPrivate)return Ie(w=y(e).tohex(),"DSA PRIVATE KEY");if("PKCS5PRV"==t&&void 0!==g&&e instanceof g&&void 0!==n&&null!=n&&1==e.isPrivate){var w=m(e).tohex();return void 0===r&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",w,n,r,o)}if("PKCS5PRV"==t&&void 0!==f&&e instanceof f&&void 0!==n&&null!=n&&1==e.isPrivate)return w=v(e).tohex(),void 0===r&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",w,n,r,o);if("PKCS5PRV"==t&&void 0!==p&&e instanceof p&&void 0!==n&&null!=n&&1==e.isPrivate)return w=y(e).tohex(),void 0===r&&(r="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",w,n,r,o);var I=function(e,t){if("string"==typeof t)return We.getEncryptedPKCS8PEM(e,t);if("object"==typeof t&&null!=Ke(t,"passcode")){var n=JSON.parse(JSON.stringify(t)),r=n.passcode;return delete n.passcode,We.getEncryptedPKCS8PEM(e,r,n)}};if("PKCS8PRV"==t&&null!=g&&e instanceof g&&1==e.isPrivate){var _=m(e).tohex();return w=l({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:_}}]}).tohex(),void 0===n||null==n?Ie(w,"PRIVATE KEY"):I(w,n)}if("PKCS8PRV"==t&&void 0!==f&&e instanceof f&&1==e.isPrivate){var C={seq:[{int:1},{octstr:{hex:e.prvKeyHex}}]};return"string"==typeof e.pubKeyHex&&C.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}),_=new l(C).tohex(),w=l({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:_}}]}).tohex(),void 0===n||null==n?Ie(w,"PRIVATE KEY"):I(w,n)}if("PKCS8PRV"==t&&void 0!==p&&e instanceof p&&1==e.isPrivate)return _=new c({bigint:e.x}).tohex(),w=l({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:_}}]}).tohex(),void 0===n||null==n?Ie(w,"PRIVATE KEY"):I(w,n);throw new Error("unsupported object nor format")},We.getKeyFromCSRPEM=function(e){var t=_e(e,"CERTIFICATE REQUEST");return We.getKeyFromCSRHex(t)},We.getKeyFromCSRHex=function(e){var t=We.parseCSRHex(e);return We.getKey(t.p8pubkeyhex,null,"pkcs8pub")},We.parseCSRHex=function(e){var t=de,n=t.getChildIdx,r=t.getTLV,i={},o=e;if("30"!=o.substr(0,2))throw new Error("malformed CSR(code:001)");var s=n(o,0);if(s.length<1)throw new Error("malformed CSR(code:002)");if("30"!=o.substr(s[0],2))throw new Error("malformed CSR(code:003)");var a=n(o,s[0]);if(a.length<3)throw new Error("malformed CSR(code:004)");return i.p8pubkeyhex=r(o,a[2]),i},We.getKeyID=function(e){var t=We,n=de;"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&(e=t.getKey(e));var r=_e(t.getPEM(e)),i=n.getIdxbyList(r,0,[1]),o=n.getV(r,i).substring(2);return ue.crypto.Util.hashHex(o,"sha1")},We.getJWK=function(e,t,n,r,i){var o,s,a={},u=ue.crypto.Util.hashHex;if("string"==typeof e)o=We.getKey(e),-1!=e.indexOf("CERTIFICATE")&&(s=_e(e));else{if("object"!=typeof e)throw new Error("unsupported keyinfo type");e instanceof Qe?(o=e.getPublicKey(),s=e.hex):o=e}if(o instanceof re&&o.isPrivate)a.kty="RSA",a.n=me(o.n.toString(16)),a.e=me(o.e.toString(16)),a.d=me(o.d.toString(16)),a.p=me(o.p.toString(16)),a.q=me(o.q.toString(16)),a.dp=me(o.dmp1.toString(16)),a.dq=me(o.dmq1.toString(16)),a.qi=me(o.coeff.toString(16));else if(o instanceof re&&o.isPublic)a.kty="RSA",a.n=me(o.n.toString(16)),a.e=me(o.e.toString(16));else if(o instanceof ue.crypto.ECDSA&&o.isPrivate){if("P-256"!==(l=o.getShortNISTPCurveName())&&"P-384"!==l&&"P-521"!==l)throw new Error("unsupported curve name for JWT: "+l);var c=o.getPublicKeyXYHex();a.kty="EC",a.crv=l,a.x=me(c.x),a.y=me(c.y),a.d=me(o.prvKeyHex)}else if(o instanceof ue.crypto.ECDSA&&o.isPublic){var l;if("P-256"!==(l=o.getShortNISTPCurveName())&&"P-384"!==l&&"P-521"!==l)throw new Error("unsupported curve name for JWT: "+l);c=o.getPublicKeyXYHex(),a.kty="EC",a.crv=l,a.x=me(c.x),a.y=me(c.y)}if(null==a.kty)throw new Error("unsupported keyinfo");return o.isPrivate||1==t||(a.kid=ue.jws.JWS.getJWKthumbprint(a)),null!=s&&1!=n&&(a.x5c=[S(s)]),null!=s&&1!=r&&(a.x5t=fe(S(u(s,"sha1")))),null!=s&&1!=i&&(a["x5t#S256"]=fe(S(u(s,"sha256")))),a},We.getJWKFromKey=function(e){return We.getJWK(e,!0,!0,!0,!0)},re.getPosArrayOfChildrenFromHex=function(e){return de.getChildIdx(e,0)},re.getHexValueArrayOfChildrenFromHex=function(e){var t,n=de.getV,r=n(e,(t=re.getPosArrayOfChildrenFromHex(e))[0]),i=n(e,t[1]),o=n(e,t[2]),s=n(e,t[3]),a=n(e,t[4]),u=n(e,t[5]),c=n(e,t[6]),l=n(e,t[7]),d=n(e,t[8]);return(t=new Array).push(r,i,o,s,a,u,c,l,d),t},re.prototype.readPrivateKeyFromPEMString=function(e){var t=_e(e),n=re.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},re.prototype.readPKCS5PrvKeyHex=function(e){var t=re.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},re.prototype.readPKCS8PrvKeyHex=function(e){var t,n,r,i,o,s,a,u,c=de,l=c.getVbyListEx;if(!1===c.isASN1HEX(e))throw new Error("not ASN.1 hex string");try{t=l(e,0,[2,0,1],"02"),n=l(e,0,[2,0,2],"02"),r=l(e,0,[2,0,3],"02"),i=l(e,0,[2,0,4],"02"),o=l(e,0,[2,0,5],"02"),s=l(e,0,[2,0,6],"02"),a=l(e,0,[2,0,7],"02"),u=l(e,0,[2,0,8],"02")}catch(e){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,n,r,i,o,s,a,u)},re.prototype.readPKCS5PubKeyHex=function(e){var t=de,n=t.getV;if(!1===t.isASN1HEX(e))throw new Error("keyHex is not ASN.1 hex string");var r=t.getChildIdx(e,0);if(2!==r.length||"02"!==e.substr(r[0],2)||"02"!==e.substr(r[1],2))throw new Error("wrong hex for PKCS#5 public key");var i=n(e,r[0]),o=n(e,r[1]);this.setPublic(i,o)},re.prototype.readPKCS8PubKeyHex=function(e){var t=de;if(!1===t.isASN1HEX(e))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==t.getTLVbyListEx(e,0,[0,0]))throw new Error("not PKCS8 RSA public key");var n=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(n)},re.prototype.readCertPubKeyHex=function(e,t){var n,r;(n=new Qe).readCertHex(e),r=n.getPublicKeyHex(),this.readPKCS8PubKeyHex(r)},re.prototype.sign=function(e,t){var n=function(e){return ue.crypto.Util.hashString(e,t)}(e);return this.signWithMessageHash(n,t)},re.prototype.signWithMessageHash=function(e,t){var n=ne(ue.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),16);return Ge(this.doPrivate(n).toString(16),this.n.bitLength())},re.prototype.signPSS=function(e,t,n){var r,i=(r=we(e),ue.crypto.Util.hashHex(r,t));return void 0===n&&(n=-1),this.signWithMessageHashPSS(i,t,n)},re.prototype.signWithMessageHashPSS=function(e,t,n){var r,i=Ee(e),o=i.length,s=this.n.bitLength()-1,a=Math.ceil(s/8),u=function(e){return ue.crypto.Util.hashHex(e,t)};if(-1===n||void 0===n)n=o;else if(-2===n)n=a-o-2;else if(n<-2)throw new Error("invalid salt length");if(a<o+n+2)throw new Error("data too long");var c="";n>0&&(c=new Array(n),(new te).nextBytes(c),c=String.fromCharCode.apply(String,c));var l=Ee(u(we("\0\0\0\0\0\0\0\0"+i+c))),d=[];for(r=0;r<a-n-o-2;r+=1)d[r]=0;var h=String.fromCharCode.apply(String,d)+""+c,p=ze(l,h.length,u),f=[];for(r=0;r<h.length;r+=1)f[r]=h.charCodeAt(r)^p.charCodeAt(r);var g=65280>>8*a-s&255;for(f[0]&=~g,r=0;r<o;r++)f.push(l.charCodeAt(r));return f.push(188),Ge(this.doPrivate(new E(f)).toString(16),this.n.bitLength())},re.prototype.verify=function(e,t){if(null==(t=t.toLowerCase()).match(/^[0-9a-f]+$/))return!1;var n=ne(t,16),r=this.n.bitLength();if(n.bitLength()>r)return!1;var i=this.doPublic(n).toString(16);if(i.length+3!=r/4)return!1;var o=Je(i.replace(/^1f+00/,""));if(0==o.length)return!1;var s=o[0],a=o[1],u=function(e){return ue.crypto.Util.hashString(e,s)}(e);return a==u},re.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var n=ne(t,16);if(n.bitLength()>this.n.bitLength())return 0;var r=Je(this.doPublic(n).toString(16).replace(/^1f+00/,""));return 0!=r.length&&(r[0],r[1]==e)},re.prototype.verifyPSS=function(e,t,n,r){var i,o=(i=we(e),ue.crypto.Util.hashHex(i,n));return void 0===r&&(r=-1),this.verifyWithMessageHashPSS(o,t,n,r)},re.prototype.verifyWithMessageHashPSS=function(e,t,n,r){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var i,o=new E(t,16),s=function(e){return ue.crypto.Util.hashHex(e,n)},a=Ee(e),u=a.length,c=this.n.bitLength()-1,l=Math.ceil(c/8);if(-1===r||void 0===r)r=u;else if(-2===r)r=l-u-2;else if(r<-2)throw new Error("invalid salt length");if(l<u+r+2)throw new Error("data too long");var d=this.doPublic(o).toByteArray();for(i=0;i<d.length;i+=1)d[i]&=255;for(;d.length<l;)d.unshift(0);if(188!==d[l-1])throw new Error("encoded message does not end in 0xbc");var h=(d=String.fromCharCode.apply(String,d)).substr(0,l-u-1),p=d.substr(h.length,u),f=65280>>8*l-c&255;if(h.charCodeAt(0)&f)throw new Error("bits beyond keysize not zero");var g=ze(p,h.length,s),m=[];for(i=0;i<h.length;i+=1)m[i]=h.charCodeAt(i)^g.charCodeAt(i);m[0]&=~f;var v=l-u-r-2;for(i=0;i<v;i+=1)if(0!==m[i])throw new Error("leftmost octets not zero");if(1!==m[v])throw new Error("0x01 marker not found");return p===Ee(s(we("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,m.slice(-r)))))},re.SALT_LEN_HLEN=-1,re.SALT_LEN_MAX=-2,re.SALT_LEN_RECOVER=-2,Qe.EXT_PARSER={},Qe.registExtParser=function(e,t){Qe.EXT_PARSER[e]=t},Qe.hex2dn=function(e,t){void 0===t&&(t=0);var n=new Qe;return de.getTLV(e,t),n.getX500Name(e).str},Qe.hex2rdn=function(e,t){if(void 0===t&&(t=0),"31"!==e.substr(t,2))throw new Error("malformed RDN");for(var n=new Array,r=de.getChildIdx(e,t),i=0;i<r.length;i++)n.push(Qe.hex2attrTypeValue(e,r[i]));return n=n.map((function(e){return e.replace("+","\\+")})),n.join("+")},Qe.hex2attrTypeValue=function(e,t){var n=de,r=n.getV;if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw new Error("malformed attribute type and value");var i=n.getChildIdx(e,t);2!==i.length||e.substr(i[0],2);var o=r(e,i[0]),s=ue.asn1.ASN1Util.oidHexToInt(o);return ue.asn1.x509.OID.oid2atype(s)+"="+Ee(r(e,i[1]))},Qe.getPublicKeyFromCertHex=function(e){var t=new Qe;return t.readCertHex(e),t.getPublicKey()},Qe.getPublicKeyFromCertPEM=function(e){var t=new Qe;return t.readCertPEM(e),t.getPublicKey()},Qe.getPublicKeyInfoPropOfCertPEM=function(e){var t,n,r=de.getVbyList,i={algparam:null};return(t=new Qe).readCertPEM(e),n=t.getPublicKeyHex(),i.keyhex=r(n,0,[1],"03").substr(2),i.algoid=r(n,0,[0,0],"06"),"2a8648ce3d0201"===i.algoid&&(i.algparam=r(n,0,[0,1],"06")),i},Qe.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==ue&&ue||(ue={}),void 0!==ue.jws&&ue.jws||(ue.jws={}),ue.jws.JWS=function(){var e=ue.jws.JWS.isSafeJSONString;this.parseJWS=function(t,n){if(void 0===this.parsedJWS||!n&&void 0===this.parsedJWS.sigvalH){var r=t.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==r)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=r[1],o=r[2],s=r[3],a=i+"."+o;if(this.parsedJWS={},this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=o,this.parsedJWS.sigvalB64U=s,this.parsedJWS.si=a,!n){var u=ve(s),c=ne(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=c}var l=le(i),d=le(o);if(this.parsedJWS.headS=l,this.parsedJWS.payloadS=d,!e(l,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+l}}},ue.jws.JWS.sign=function(e,t,n,r,i){var o,s,a,u=ue,c=u.jws.JWS,l=c.readSafeJSONString,d=c.isSafeJSONString,h=u.crypto,p=(h.ECDSA,h.Mac),f=h.Signature,g=JSON;if("string"!=typeof t&&"object"!=typeof t)throw"spHeader must be JSON string or object: "+t;if("object"==typeof t&&(s=t,o=g.stringify(s)),"string"==typeof t){if(!d(o=t))throw"JWS Head is not safe JSON string: "+o;s=l(o)}if(a=n,"object"==typeof n&&(a=g.stringify(n)),""!=e&&null!=e||void 0===s.alg||(e=s.alg),""!=e&&null!=e&&void 0===s.alg&&(s.alg=e,o=g.stringify(s)),e!==s.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+s.alg;var m=null;if(void 0===c.jwsalg2sigalg[e])throw"unsupported alg name: "+e;m=c.jwsalg2sigalg[e];var v=ce(o)+"."+ce(a),y="";if("Hmac"==m.substr(0,4)){if(void 0===r)throw"mac key shall be specified for HS* alg";var S=new p({alg:m,prov:"cryptojs",pass:r});S.updateString(v),y=S.doFinal()}else if(-1!=m.indexOf("withECDSA")){(E=new f({alg:m})).init(r,i),E.updateString(v);var b=E.sign();y=ue.crypto.ECDSA.asn1SigToConcatSig(b)}else{var E;"none"!=m&&((E=new f({alg:m})).init(r,i),E.updateString(v),y=E.sign())}return v+"."+me(y)},ue.jws.JWS.verify=function(e,t,n){var r,i=ue,o=i.jws.JWS,s=o.readSafeJSONString,a=i.crypto,u=a.ECDSA,c=a.Mac,l=a.Signature;if(r=re,!Le(e))return!1;var d=e.split(".");if(3!==d.length)return!1;var h,p=d[0]+"."+d[1],f=ve(d[2]),g=s(le(d[0])),m=null;if(void 0===g.alg)throw"algorithm not specified in header";if(h=(m=g.alg).substr(0,2),null!=n&&"[object Array]"===Object.prototype.toString.call(n)&&n.length>0&&-1==(":"+n.join(":")+":").indexOf(":"+m+":"))throw"algorithm '"+m+"' not accepted in the list";if("none"!=m&&null===t)throw"key shall be specified to verify.";if("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&(t=We.getKey(t)),!("RS"!=h&&"PS"!=h||t instanceof r))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==h&&!(t instanceof u))throw"key shall be a ECDSA obj for ES* algs";var v=null;if(void 0===o.jwsalg2sigalg[g.alg])throw"unsupported alg name: "+m;if("none"==(v=o.jwsalg2sigalg[m]))throw"not supported";if("Hmac"==v.substr(0,4)){if(void 0===t)throw"hexadecimal key shall be specified for HMAC";var y=new c({alg:v,pass:t});return y.updateString(p),f==y.doFinal()}if(-1!=v.indexOf("withECDSA")){var S,b=null;try{b=u.concatSigToASN1Sig(f)}catch(e){return!1}return(S=new l({alg:v})).init(t),S.updateString(p),S.verify(b)}return(S=new l({alg:v})).init(t),S.updateString(p),S.verify(f)},ue.jws.JWS.parse=function(e){var t,n,r,i=e.split("."),o={};if(2!=i.length&&3!=i.length)throw"malformed sJWS: wrong number of '.' splitted elements";return t=i[0],n=i[1],3==i.length&&(r=i[2]),o.headerObj=ue.jws.JWS.readSafeJSONString(le(t)),o.payloadObj=ue.jws.JWS.readSafeJSONString(le(n)),o.headerPP=JSON.stringify(o.headerObj,null,"  "),null==o.payloadObj?o.payloadPP=le(n):o.payloadPP=JSON.stringify(o.payloadObj,null,"  "),void 0!==r&&(o.sigHex=ve(r)),o},ue.jws.JWS.verifyJWT=function(e,t,n){var r=ue.jws,i=r.JWS,o=i.readSafeJSONString,s=i.inArray,a=i.includedArray;if(!Le(e))return!1;var u=e.split(".");if(3!=u.length)return!1;var c=u[0],l=u[1],d=(ve(u[2]),o(le(c))),h=o(le(l));if(void 0===d.alg)return!1;if(void 0===n.alg)throw"acceptField.alg shall be specified";if(!s(d.alg,n.alg))return!1;if(void 0!==h.iss&&"object"==typeof n.iss&&!s(h.iss,n.iss))return!1;if(void 0!==h.sub&&"object"==typeof n.sub&&!s(h.sub,n.sub))return!1;if(void 0!==h.aud&&"object"==typeof n.aud)if("string"==typeof h.aud){if(!s(h.aud,n.aud))return!1}else if("object"==typeof h.aud&&!a(h.aud,n.aud))return!1;var p=r.IntDate.getNow();return void 0!==n.verifyAt&&"number"==typeof n.verifyAt&&(p=n.verifyAt),void 0!==n.gracePeriod&&"number"==typeof n.gracePeriod||(n.gracePeriod=0),!(void 0!==h.exp&&"number"==typeof h.exp&&h.exp+n.gracePeriod<p||void 0!==h.nbf&&"number"==typeof h.nbf&&p<h.nbf-n.gracePeriod||void 0!==h.iat&&"number"==typeof h.iat&&p<h.iat-n.gracePeriod||void 0!==h.jti&&void 0!==n.jti&&h.jti!==n.jti||!i.verify(e,t,n.alg))},ue.jws.JWS.includedArray=function(e,t){var n=ue.jws.JWS.inArray;if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var r=0;r<e.length;r++)if(!n(e[r],t))return!1;return!0},ue.jws.JWS.inArray=function(e,t){if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},ue.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},ue.jws.JWS.isSafeJSONString=function(e,t,n){var r=null;try{return"object"!=typeof(r=ae(e))||r.constructor===Array?0:(t&&(t[n]=r),1)}catch(e){return 0}},ue.jws.JWS.readSafeJSONString=function(e){var t=null;try{return"object"!=typeof(t=ae(e))||t.constructor===Array?null:t}catch(e){return null}},ue.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==t)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},ue.jws.JWS.getJWKthumbprint=function(e){if("RSA"!==e.kty&&"EC"!==e.kty&&"oct"!==e.kty)throw"unsupported algorithm for JWK Thumprint";var t="{";if("RSA"===e.kty){if("string"!=typeof e.n||"string"!=typeof e.e)throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if("EC"===e.kty){if("string"!=typeof e.crv||"string"!=typeof e.x||"string"!=typeof e.y)throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if("oct"===e.kty){if("string"!=typeof e.k)throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var n=we(t);return me(ue.crypto.Util.hashHex(n,"sha256"))},ue.jws.IntDate={},ue.jws.IntDate.get=function(e){var t=ue.jws.IntDate,n=t.getNow,r=t.getZulu;if("now"==e)return n();if("now + 1hour"==e)return n()+3600;if("now + 1day"==e)return n()+86400;if("now + 1month"==e)return n()+2592e3;if("now + 1year"==e)return n()+31536e3;if(e.match(/Z$/))return r(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},ue.jws.IntDate.getZulu=function(e){return Ce(e)},ue.jws.IntDate.getNow=function(){return~~(new Date/1e3)},ue.jws.IntDate.intDate2UTCString=function(e){return new Date(1e3*e).toUTCString()},ue.jws.IntDate.intDate2Zulu=function(e){var t=new Date(1e3*e);return("0000"+t.getUTCFullYear()).slice(-4)+("00"+(t.getUTCMonth()+1)).slice(-2)+("00"+t.getUTCDate()).slice(-2)+("00"+t.getUTCHours()).slice(-2)+("00"+t.getUTCMinutes()).slice(-2)+("00"+t.getUTCSeconds()).slice(-2)+"Z"},void 0!==ue&&ue||(ue={}),void 0!==ue.jws&&ue.jws||(ue.jws={}),ue.jws.JWSJS=function(){var e=ue.jws.JWS,t=e.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(e){this.init();var t=e.split(".");if(3!=t.length)throw"malformed input JWS";this.aHeader.push(t[0]),this.sPayload=t[1],this.aSignature.push(t[2])},this.addSignature=function(e,t,n,r){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var i=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var o=ue.jws.JWS.sign(e,t,this.sPayload,n,r).split(".");o[0],o[2],this.aHeader.push(o[0]),this.aSignature.push(o[2])}catch(e){throw this.aHeader.length>i&&this.aHeader.pop(),this.aSignature.length>i&&this.aSignature.pop(),"addSignature failed: "+e}},this.verifyAll=function(e){if(this.aHeader.length!==e.length||this.aSignature.length!==e.length)return!1;for(var t=0;t<e.length;t++){var n=e[t];if(2!==n.length)return!1;if(!1===this.verifyNth(t,n[0],n[1]))return!1}return!0},this.verifyNth=function(t,n,r){if(this.aHeader.length<=t||this.aSignature.length<=t)return!1;var i=this.aHeader[t],o=this.aSignature[t],s=i+"."+this.sPayload+"."+o,a=!1;try{a=e.verify(s,n,r)}catch(e){return!1}return a},this.readJWSJS=function(e){if("string"==typeof e){var n=t(e);if(null==n)throw"argument is not safe JSON object string";this.aHeader=n.headers,this.sPayload=n.payload,this.aSignature=n.signatures}else try{if(!(e.headers.length>0))throw"malformed header";if(this.aHeader=e.headers,"string"!=typeof e.payload)throw"malformed signatures";if(this.sPayload=e.payload,!(e.signatures.length>0))throw"malformed signatures";this.aSignature=e.signatures}catch(e){throw"malformed JWS-JS JSON object: "+e}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}},ue.crypto.ECDSA,ue.crypto.DSA,ue.crypto.Signature,ue.crypto.MessageDigest,ue.crypto.Mac,ue.crypto,ue.asn1,t.hT=ue.jws,ue.lang}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e=n(355),t=n(729),r=n.n(t);const i=function(e,t){if(!e)throw o(t)},o=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},s=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,u=a?e[t+2]:0,c=i>>2,l=(3&i)<<4|s>>4;let d=(15&s)<<2|u>>6,h=63&u;a||(h=64,o||(d=64)),r.push(n[c],n[l],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const s=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==s||null==a)throw new u;const c=i<<2|o>>4;if(r.push(c),64!==s){const e=o<<4&240|s>>2;if(r.push(e),64!==a){const e=s<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class u extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const c=function(e){const t=s(e);return a.encodeByteArray(t,!0)},l=function(e){return c(e).replace(/\./g,"")},d=function(e){try{return a.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function h(e){return p(void 0,e)}function p(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=p(e[n],t[n]));return e}const f=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&d(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}};class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function m(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())}function y(){return"object"==typeof navigator&&"ReactNative"===navigator.product}class S extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,S.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b.prototype.create)}}class b{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?function(e,t){return e.replace(E,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new S(r,s,n)}}const E=/\{\$([^}]+)}/g;function w(e){return JSON.parse(e)}function I(e){return JSON.stringify(e)}const _=function(e){let t={},n={},r={},i="";try{const o=e.split(".");t=w(d(o[0])||""),n=w(d(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function T(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function R(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function O(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(P(n)&&P(o)){if(!O(n,o))return!1}else if(n!==o)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function P(e){return null!==e&&"object"==typeof e}function D(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function k(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function x(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class N{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],u=this.chain_[3],c=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=u^s&(a^u),i=1518500249):(r=s^a^u,i=1859775393):e<60?(r=s&a|u&(s|a),i=2400959708):(r=s^a^u,i=3395469782);const t=(o<<5|o>>>27)+r+c+i+n[e]&4294967295;c=u,u=a,a=4294967295&(s<<30|s>>>2),s=o,o=t}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}class M{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=F),void 0===r.error&&(r.error=F),void 0===r.complete&&(r.complete=F);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function F(){}const L=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function V(e){return e&&e._delegate?e._delegate:e}class B{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const j="[DEFAULT]";class U{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new g;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:j})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=j){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=j){return this.instances.has(e)}getOptions(e=j){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===j?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=j){return this.component?this.component.multipleInstances?e:j:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class H{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new U(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const q=[];var K;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(K||(K={}));const $={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},W=K.INFO,G={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},z=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=G[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class J{constructor(e){this.name=e,this._logLevel=W,this._logHandler=z,this._userLogHandler=null,q.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in K))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...e),this._logHandler(this,K.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...e),this._logHandler(this,K.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,K.INFO,...e),this._logHandler(this,K.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,K.WARN,...e),this._logHandler(this,K.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...e),this._logHandler(this,K.ERROR,...e)}}const Q=(e,t)=>t.some((t=>e instanceof t));let Y,Z;const X=new WeakMap,ee=new WeakMap,te=new WeakMap,ne=new WeakMap,re=new WeakMap;let ie={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ee.get(e);if("objectStoreNames"===t)return e.objectStoreNames||te.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return se(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function oe(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Z||(Z=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(ae(this),e),se(X.get(this))}:function(...e){return se(t.apply(ae(this),e))}:function(e,...n){const r=t.call(ae(this),e,...n);return te.set(r,e.sort?e.sort():[e]),se(r)}:(e instanceof IDBTransaction&&function(e){if(ee.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));ee.set(e,t)}(e),Q(e,Y||(Y=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,ie):e);var t}function se(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(se(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&X.set(t,e)})).catch((()=>{})),re.set(t,e),t}(e);if(ne.has(e))return ne.get(e);const t=oe(e);return t!==e&&(ne.set(e,t),re.set(t,e)),t}const ae=e=>re.get(e),ue=["get","getKey","getAll","getAllKeys","count"],ce=["put","add","delete","clear"],le=new Map;function de(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(le.get(t))return le.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ce.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!ue.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return le.set(t,o),o}var he;he=ie,ie={...he,get:(e,t,n)=>de(e,t)||he.get(e,t,n),has:(e,t)=>!!de(e,t)||he.has(e,t)};class pe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const fe="@firebase/app",ge="0.10.5",me=new J("@firebase/app"),ve="@firebase/app-compat",ye="@firebase/analytics-compat",Se="@firebase/analytics",be="@firebase/app-check-compat",Ee="@firebase/app-check",we="@firebase/auth",Ie="@firebase/auth-compat",_e="@firebase/database",Ce="@firebase/database-compat",Ae="@firebase/functions",Te="@firebase/functions-compat",Re="@firebase/installations",Oe="@firebase/installations-compat",Pe="@firebase/messaging",De="@firebase/messaging-compat",ke="@firebase/performance",xe="@firebase/performance-compat",Ne="@firebase/remote-config",Me="@firebase/remote-config-compat",Fe="@firebase/storage",Le="@firebase/storage-compat",Ve="@firebase/firestore",Be="@firebase/vertexai-preview",je="@firebase/firestore-compat",Ue="firebase",He={[fe]:"fire-core",[ve]:"fire-core-compat",[Se]:"fire-analytics",[ye]:"fire-analytics-compat",[Ee]:"fire-app-check",[be]:"fire-app-check-compat",[we]:"fire-auth",[Ie]:"fire-auth-compat",[_e]:"fire-rtdb",[Ce]:"fire-rtdb-compat",[Ae]:"fire-fn",[Te]:"fire-fn-compat",[Re]:"fire-iid",[Oe]:"fire-iid-compat",[Pe]:"fire-fcm",[De]:"fire-fcm-compat",[ke]:"fire-perf",[xe]:"fire-perf-compat",[Ne]:"fire-rc",[Me]:"fire-rc-compat",[Fe]:"fire-gcs",[Le]:"fire-gcs-compat",[Ve]:"fire-fst",[je]:"fire-fst-compat",[Be]:"fire-vertex","fire-js":"fire-js",[Ue]:"fire-js-all"},qe=new Map,Ke=new Map,$e=new Map;function We(e,t){try{e.container.addComponent(t)}catch(n){me.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ge(e){const t=e.name;if($e.has(t))return me.debug(`There were multiple attempts to register component ${t}.`),!1;$e.set(t,e);for(const t of qe.values())We(t,e);for(const t of Ke.values())We(t,e);return!0}function ze(e){return void 0!==e.settings}const Je=new b("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Qe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new B("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Je.create("app-deleted",{appName:this._name})}}const Ye="10.12.2";function Ze(e,t,n){var r;let i=null!==(r=He[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=[`Unable to register library "${i}" with version "${t}":`];return o&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void me.warn(e.join(" "))}Ge(new B(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const Xe="firebase-heartbeat-database",et=1,tt="firebase-heartbeat-store";let nt=null;function rt(){return nt||(nt=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=se(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(se(s.result),e.oldVersion,e.newVersion,se(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(Xe,et,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(tt)}catch(e){console.warn(e)}}}).catch((e=>{throw Je.create("idb-open",{originalErrorMessage:e.message})}))),nt}async function it(e,t){try{const n=(await rt()).transaction(tt,"readwrite"),r=n.objectStore(tt);await r.put(t,ot(e)),await n.done}catch(e){if(e instanceof S)me.warn(e.message);else{const t=Je.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});me.warn(t.message)}}}function ot(e){return`${e.name}!${e.options.appId}`}class st{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ut(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=at();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=at(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),ct(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ct(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=l(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function at(){return(new Date).toISOString().substring(0,10)}class ut{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await rt()).transaction(tt),n=await t.objectStore(tt).get(ot(e));return await t.done,n}catch(e){if(e instanceof S)me.warn(e.message);else{const t=Je.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});me.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return it(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return it(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ct(e){return l(JSON.stringify({version:2,heartbeats:e})).length}function lt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Ge(new B("platform-logger",(e=>new pe(e)),"PRIVATE")),Ge(new B("heartbeat",(e=>new st(e)),"PRIVATE")),Ze(fe,ge,""),Ze(fe,ge,"esm2017"),Ze("fire-js",""),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const dt=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ht=new b("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),pt=new J("@firebase/auth");function ft(e,...t){pt.logLevel<=K.ERROR&&pt.error(`Auth (${Ye}): ${e}`,...t)}function gt(e,...t){throw St(e,...t)}function mt(e,...t){return St(e,...t)}function vt(e,t,n){const r=Object.assign(Object.assign({},dt()),{[t]:n});return new b("auth","Firebase",r).create(t,{appName:e.name})}function yt(e){return vt(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function St(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return ht.create(e,...t)}function bt(e,t,...n){if(!e)throw St(t,...n)}function Et(e){const t="INTERNAL ASSERTION FAILED: "+e;throw ft(t),new Error(t)}function wt(e,t){e||Et(t)}function It(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function _t(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===It()||"https:"===It()||function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Ct{constructor(e,t){this.shortDelay=e,this.longDelay=t,wt(t>e,"Short delay should be less than long delay!"),this.isMobile=v()||y()}get(){return _t()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}class At{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Et("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Et("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Et("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Tt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Rt=new Ct(3e4,6e4);function Ot(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Pt(e,t,n,r,i={}){return Dt(e,i,(async()=>{let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const s=D(Object.assign({key:e.config.apiKey},o)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),At.fetch()(xt(e,e.config.apiHost,n,s),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function Dt(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Tt),t);try{const t=new Mt(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ft(e,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const t=i.ok?o.errorMessage:o.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Ft(e,"credential-already-in-use",o);if("EMAIL_EXISTS"===n)throw Ft(e,"email-already-in-use",o);if("USER_DISABLED"===n)throw Ft(e,"user-disabled",o);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw vt(e,a,s);gt(e,a)}}catch(t){if(t instanceof S)throw t;gt(e,"network-request-failed",{message:String(t)})}}async function kt(e,t,n,r,i={}){const o=await Pt(e,t,n,r,i);return"mfaPendingCredential"in o&&gt(e,"multi-factor-auth-required",{_serverResponse:o}),o}function xt(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?function(e,t){wt(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}(e.config,i):`${e.config.apiScheme}://${i}`}function Nt(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Mt{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(mt(this.auth,"network-request-failed"))),Rt.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ft(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=mt(e,t,r);return i.customData._tokenResponse=n,i}function Lt(e){return void 0!==e&&void 0!==e.enterprise}class Vt{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Nt(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Bt(e,t){return Pt(e,"POST","/v1/accounts:lookup",t)}function jt(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Ut(e){return 1e3*Number(e)}function Ht(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return ft("JWT malformed, contained fewer than 3 sections"),null;try{const e=d(n);return e?JSON.parse(e):(ft("Failed to decode base64 JWT payload"),null)}catch(e){return ft("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function qt(e){const t=Ht(e);return bt(t,"internal-error"),bt(void 0!==t.exp,"internal-error"),bt(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Kt(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof S&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class $t{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Wt{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=jt(this.lastLoginAt),this.creationTime=jt(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Gt(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Kt(e,Bt(n,{idToken:r}));bt(null==i?void 0:i.users.length,n,"internal-error");const o=i.users[0];e._notifyReloadListener(o);const s=(null===(t=o.providerUserInfo)||void 0===t?void 0:t.length)?zt(o.providerUserInfo):[],a=(u=e.providerData,c=s,[...u.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var u,c;const l=e.isAnonymous,d=!(e.email&&o.passwordHash||(null==a?void 0:a.length)),h=!!l&&d,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Wt(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(e,p)}function zt(e){return e.map((e=>{var{providerId:t}=e,n=lt(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Jt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){bt(e.idToken,"internal-error"),bt(void 0!==e.idToken,"internal-error"),bt(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):qt(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){bt(0!==e.length,"internal-error");const t=qt(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(bt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Dt(e,{},(async()=>{const n=D({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,o=xt(e,r,"/v1/token",`key=${i}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",At.fetch()(o,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,o=new Jt;return n&&(bt("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),r&&(bt("string"==typeof r,"internal-error",{appName:e}),o.accessToken=r),i&&(bt("number"==typeof i,"internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Jt,this.toJSON())}_performRefresh(){return Et("not implemented")}}function Qt(e,t){bt("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Yt{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=lt(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $t(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Wt(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Kt(this,this.stsTokenManager.getToken(this.auth,e));return bt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=V(e),r=await n.getIdToken(t),i=Ht(r);bt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o="object"==typeof i.firebase?i.firebase:void 0,s=null==o?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:jt(Ut(i.auth_time)),issuedAtTime:jt(Ut(i.iat)),expirationTime:jt(Ut(i.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=V(e);await Gt(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(bt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Yt(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){bt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Gt(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ze(this.auth.app))return Promise.reject(yt(this.auth));const e=await this.getIdToken();return await Kt(this,async function(e,t){return Pt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,o,s,a,u,c;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(o=t.photoURL)&&void 0!==o?o:void 0,f=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(u=t.createdAt)&&void 0!==u?u:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:S,isAnonymous:b,providerData:E,stsTokenManager:w}=t;bt(y&&w,e,"internal-error");const I=Jt.fromJSON(this.name,w);bt("string"==typeof y,e,"internal-error"),Qt(l,e.name),Qt(d,e.name),bt("boolean"==typeof S,e,"internal-error"),bt("boolean"==typeof b,e,"internal-error"),Qt(h,e.name),Qt(p,e.name),Qt(f,e.name),Qt(g,e.name),Qt(m,e.name),Qt(v,e.name);const _=new Yt({uid:y,auth:e,email:d,emailVerified:S,displayName:l,isAnonymous:b,photoURL:p,phoneNumber:h,tenantId:f,stsTokenManager:I,createdAt:m,lastLoginAt:v});return E&&Array.isArray(E)&&(_.providerData=E.map((e=>Object.assign({},e)))),g&&(_._redirectEventId=g),_}static async _fromIdTokenResponse(e,t,n=!1){const r=new Jt;r.updateFromServerResponse(t);const i=new Yt({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Gt(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];bt(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?zt(r.providerUserInfo):[],o=!(r.email&&r.passwordHash||(null==i?void 0:i.length)),s=new Jt;s.updateFromIdToken(n);const a=new Yt({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Wt(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||(null==i?void 0:i.length))};return Object.assign(a,u),a}}const Zt=new Map;function Xt(e){wt(e instanceof Function,"Expected a class definition");let t=Zt.get(e);return t?(wt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Zt.set(e,t),t)}class en{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}en.type="NONE";const tn=en;function nn(e,t,n){return`firebase:${e}:${t}:${n}`}class rn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=nn(this.userKey,r.apiKey,i),this.fullPersistenceKey=nn("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Yt._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new rn(Xt(tn),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||Xt(tn);const o=nn(n,e.config.apiKey,e.name);let s=null;for(const n of t)try{const t=await n._get(o);if(t){const r=Yt._fromJSON(e,t);n!==i&&(s=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],s&&await i._set(o,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(o)}catch(e){}}))),new rn(i,e,n)):new rn(i,e,n)}}function on(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(an(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(function(e=m()){return/firefox\//i.test(e)}(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(cn(t))return"Blackberry";if(ln(t))return"Webos";if(sn(t))return"Safari";if((t.includes("chrome/")||function(e=m()){return/crios\//i.test(e)}(t))&&!t.includes("edge/"))return"Chrome";if(un(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function sn(e=m()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function an(e=m()){return/iemobile/i.test(e)}function un(e=m()){return/android/i.test(e)}function cn(e=m()){return/blackberry/i.test(e)}function ln(e=m()){return/webos/i.test(e)}function dn(e=m()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function hn(e,t=[]){let n;switch(e){case"Browser":n=on(m());break;case"Worker":n=`${on(m())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ye}/${r}`}class pn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class fn{constructor(e){var t,n,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=o.minPasswordLength)&&void 0!==t?t:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,o,s;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(o=a.containsNumericCharacter)||void 0===o||o),a.isValid&&(a.isValid=null===(s=a.containsNonAlphanumericCharacter)||void 0===s||s),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class gn{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new vn(this),this.idTokenSubscription=new vn(this),this.beforeStateQueue=new pn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ht,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Xt(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await rn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Bt(this,{idToken:e}),n=await Yt._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ze(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,o=null==r?void 0:r._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==o||!(null==s?void 0:s.user)||(r=s.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return bt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gt(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ze(this.app))return Promise.reject(yt(this));const t=e?V(e):null;return t&&bt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&bt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return ze(this.app)?Promise.reject(yt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ze(this.app)?Promise.reject(yt(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Xt(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return Pt(e,"GET","/v2/passwordPolicy",Ot(e,t))}(this),t=new fn(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new b("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Pt(e,"POST","/v2/accounts:revokeToken",Ot(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Xt(e)||this._popupRedirectResolver;bt(t,this,"argument-error"),this.redirectPersistenceManager=await rn.create(this,[Xt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let o=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(bt(s,this,"internal-error"),s.then((()=>{o||i(this.currentUser)})),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{o=!0,i()}}{const n=e.addObserver(t);return()=>{o=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return bt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){pt.logLevel<=K.WARN&&pt.warn(`Auth (${Ye}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function mn(e){return V(e)}class vn{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new M(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return bt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let yn={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};class Sn{constructor(e){this.type="recaptcha-enterprise",this.auth=mn(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;Lt(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{(async function(e,t){return Pt(e,"GET","/v2/recaptchaConfig",Ot(e,t))})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Vt(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&Lt(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=yn.recaptchaEnterpriseScript;0!==t.length&&(t+=i),function(e){return yn.loadJS(e)}(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function bn(e,t,n,r=!1){const i=new Sn(e);let o;try{o=await i.verify(n)}catch(e){o=await i.verify(n,!0)}const s=Object.assign({},t);return r?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function En(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await bn(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await bn(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}class wn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Et("not implemented")}_getIdTokenResponse(e){return Et("not implemented")}_linkToIdToken(e,t){return Et("not implemented")}_getReauthenticationResolver(e){return Et("not implemented")}}async function In(e,t){return Pt(e,"POST","/v1/accounts:signUp",t)}async function _n(e,t){return kt(e,"POST","/v1/accounts:signInWithPassword",Ot(e,t))}class Cn extends wn{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Cn(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Cn(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return En(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",_n);case"emailLink":return async function(e,t){return kt(e,"POST","/v1/accounts:signInWithEmailLink",Ot(e,t))}(e,{email:this._email,oobCode:this._password});default:gt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return En(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",In);case"emailLink":return async function(e,t){return kt(e,"POST","/v1/accounts:signInWithEmailLink",Ot(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:gt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function An(e,t){return kt(e,"POST","/v1/accounts:signInWithIdp",Ot(e,t))}class Tn extends wn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Tn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=lt(t,["providerId","signInMethod"]);if(!n||!r)return null;const o=new Tn(n,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){return An(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,An(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,An(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=D(t)}return e}}const Rn={USER_NOT_FOUND:"user-not-found"};class On extends wn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new On({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new On({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return kt(e,"POST","/v1/accounts:signInWithPhoneNumber",Ot(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await kt(e,"POST","/v1/accounts:signInWithPhoneNumber",Ot(e,t));if(n.temporaryProof)throw Ft(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return kt(e,"POST","/v1/accounts:signInWithPhoneNumber",Ot(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Rn)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new On({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Pn{constructor(e){var t,n,r,i,o,s;const a=k(x(e)),u=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);bt(u&&c&&l,"argument-error"),this.apiKey=u,this.operation=l,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=a.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=a.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=k(x(e)).link,n=t?k(x(t)).deep_link_id:null,r=k(x(e)).deep_link_id;return(r?k(x(r)).link:null)||r||n||t||e}(e);try{return new Pn(t)}catch(e){return null}}}class Dn{constructor(){this.providerId=Dn.PROVIDER_ID}static credential(e,t){return Cn._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Pn.parseLink(t);return bt(n,"argument-error"),Cn._fromEmailAndCode(e,n.code,n.tenantId)}}Dn.PROVIDER_ID="password",Dn.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Dn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class kn{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class xn extends kn{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Nn extends xn{constructor(){super("facebook.com")}static credential(e){return Tn._fromParams({providerId:Nn.PROVIDER_ID,signInMethod:Nn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Nn.credentialFromTaggedObject(e)}static credentialFromError(e){return Nn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Nn.credential(e.oauthAccessToken)}catch(e){return null}}}Nn.FACEBOOK_SIGN_IN_METHOD="facebook.com",Nn.PROVIDER_ID="facebook.com";class Mn extends xn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Tn._fromParams({providerId:Mn.PROVIDER_ID,signInMethod:Mn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Mn.credentialFromTaggedObject(e)}static credentialFromError(e){return Mn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Mn.credential(t,n)}catch(e){return null}}}Mn.GOOGLE_SIGN_IN_METHOD="google.com",Mn.PROVIDER_ID="google.com";class Fn extends xn{constructor(){super("github.com")}static credential(e){return Tn._fromParams({providerId:Fn.PROVIDER_ID,signInMethod:Fn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fn.credentialFromTaggedObject(e)}static credentialFromError(e){return Fn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Fn.credential(e.oauthAccessToken)}catch(e){return null}}}Fn.GITHUB_SIGN_IN_METHOD="github.com",Fn.PROVIDER_ID="github.com";class Ln extends xn{constructor(){super("twitter.com")}static credential(e,t){return Tn._fromParams({providerId:Ln.PROVIDER_ID,signInMethod:Ln.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ln.credentialFromTaggedObject(e)}static credentialFromError(e){return Ln.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ln.credential(t,n)}catch(e){return null}}}Ln.TWITTER_SIGN_IN_METHOD="twitter.com",Ln.PROVIDER_ID="twitter.com";class Vn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Yt._fromIdTokenResponse(e,n,r),o=Bn(n);return new Vn({user:i,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Bn(n);return new Vn({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Bn(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class jn extends S{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,jn.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new jn(e,t,n,r)}}function Un(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw jn._fromErrorAndOperation(e,n,t,r);throw n}))}new WeakMap;const Hn="__sak";class qn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hn,"1"),this.storage.removeItem(Hn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}(class extends qn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=m();return sn(e)||dn(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=function(e=m()){return dn(e)||un(e)||ln(e)||cn(e)||/windows phone/i.test(e)||an(e)}(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);!function(){const e=m();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||i===e.newValue||e.newValue===e.oldValue?r():setTimeout(r,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}).type="LOCAL";(class extends qn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}).type="SESSION";class Kn{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Kn(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!(null==o?void 0:o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(o).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function $n(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}Kn.receivers=[];Math.floor(1e6*Math.random()),new Ct(3e4,6e4);class Wn{constructor(e){this.providerId=Wn.PROVIDER_ID,this.auth=mn(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var r;const i=await n.verify();try{let o;if(bt("string"==typeof i,e,"argument-error"),bt("recaptcha"===n.type,e,"argument-error"),o="string"==typeof t?{phoneNumber:t}:t,"session"in o){const t=o.session;if("phoneNumber"in o){bt("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Pt(e,"POST","/v2/accounts/mfaEnrollment:start",Ot(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{bt("signin"===t.type,e,"internal-error");const n=(null===(r=o.multiFactorHint)||void 0===r?void 0:r.uid)||o.multiFactorUid;bt(n,e,"missing-multi-factor-info");const s=await function(e,t){return Pt(e,"POST","/v2/accounts/mfaSignIn:start",Ot(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Pt(e,"POST","/v1/accounts:sendVerificationCode",Ot(e,t))}(e,{phoneNumber:o.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}(this.auth,e,V(t))}static credential(e,t){return On._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Wn.credentialFromTaggedObject(t)}static credentialFromError(e){return Wn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?On._fromTokenResponse(t,n):null}}Wn.PROVIDER_ID="phone",Wn.PHONE_SIGN_IN_METHOD="phone";class Gn extends wn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return An(e,this._buildIdpRequest())}_linkToIdToken(e,t){return An(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return An(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function zn(e){return async function(e,t,n=!1){if(ze(e.app))return Promise.reject(yt(e));const r="signIn",i=await Un(e,r,t),o=await Vn._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(o.user),o}(e.auth,new Gn(e),e.bypassAuthState)}function Jn(e){const{auth:t,user:n}=e;return bt(n,t,"internal-error"),async function(e,t,n=!1){const{auth:r}=e;if(ze(r.app))return Promise.reject(yt(r));const i="reauthenticate";try{const o=await Kt(e,Un(r,i,t,e),n);bt(o.idToken,r,"internal-error");const s=Ht(o.idToken);bt(s,r,"internal-error");const{sub:a}=s;return bt(e.uid===a,r,"user-mismatch"),Vn._forOperation(e,i,o)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&gt(r,"user-mismatch"),e}}(n,new Gn(e),e.bypassAuthState)}async function Qn(e){const{auth:t,user:n}=e;return bt(n,t,"internal-error"),async function(e,t,n=!1){const r=await Kt(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Vn._forOperation(e,"link",r)}(n,new Gn(e),e.bypassAuthState)}class Yn{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:o,type:s}=e;if(o)return void this.reject(o);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zn;case"linkViaPopup":case"linkViaRedirect":return Qn;case"reauthViaPopup":case"reauthViaRedirect":return Jn;default:gt(this.auth,"internal-error")}}resolve(e){wt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zn=new Ct(2e3,1e4);class Xn extends Yn{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Xn.currentPopupAction&&Xn.currentPopupAction.cancel(),Xn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return bt(e,this.auth,"internal-error"),e}async onExecution(){wt(1===this.filter.length,"Popup operations only handle one event");const e=$n();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(mt(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(mt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xn.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(mt(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Zn.get())};e()}}Xn.currentPopupAction=null,new Map,new Ct(3e4,6e4),new Ct(5e3,15e3),new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]),encodeURIComponent("fac");var er,tr,nr,rr="@firebase/auth",ir="1.7.4";class or{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){bt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}null===(er=f())||void 0===er||er._authIdTokenMaxAge,tr={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=mt("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},yn=tr,nr="Browser",Ge(new B("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=n.options;bt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:o,authDomain:s,clientPlatform:nr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hn(nr)},u=new gn(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Xt);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(u,t),u}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Ge(new B("auth-internal",(e=>{return t=mn(e.getProvider("auth").getImmediate()),new or(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),Ze(rr,ir,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(nr)),Ze(rr,ir,"esm2017");const sr="@firebase/database",ar="1.0.5";let ur="";class cr{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),I(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:w(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class lr{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return C(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const dr=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new cr(t)}}catch(e){}return new lr},hr=dr("localStorage"),pr=dr("sessionStorage"),fr=new J("@firebase/database"),gr=function(){let e=1;return function(){return e++}}(),mr=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);if(o>=55296&&o<=56319){const t=o-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate."),o=65536+(t<<10)+(e.charCodeAt(r)-56320)}o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):o<65536?(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t}(e),n=new N;n.update(t);const r=n.digest();return a.encodeByteArray(r)},vr=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=vr.apply(null,r):t+="object"==typeof r?I(r):r,t+=" "}return t};let yr=null,Sr=!0;const br=function(...e){if(!0===Sr&&(Sr=!1,null===yr&&!0===pr.get("logging_enabled")&&(t=!0,i(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(fr.logLevel=K.VERBOSE,yr=fr.log.bind(fr),n&&pr.set("logging_enabled",!0)):"function"==typeof t?yr=t:(yr=null,pr.remove("logging_enabled")))),yr){const t=vr.apply(null,e);yr(t)}var t,n},Er=function(e){return function(...t){br(e,...t)}},wr=function(...e){const t="FIREBASE INTERNAL ERROR: "+vr(...e);fr.error(t)},Ir=function(...e){const t=`FIREBASE FATAL ERROR: ${vr(...e)}`;throw fr.error(t),new Error(t)},_r=function(...e){const t="FIREBASE WARNING: "+vr(...e);fr.warn(t)},Cr=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Ar="[MIN_NAME]",Tr="[MAX_NAME]",Rr=function(e,t){if(e===t)return 0;if(e===Ar||t===Tr)return-1;if(t===Ar||e===Tr)return 1;{const n=Fr(e),r=Fr(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},Or=function(e,t){return e===t?0:e<t?-1:1},Pr=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+I(t))},Dr=function(e){if("object"!=typeof e||null===e)return I(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=I(t[r]),n+=":",n+=Dr(e[t[r]]);return n+="}",n},kr=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function xr(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Nr=function(e){i(!Cr(e),"Invalid JSON number");let t,n,r,o,s;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(o=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=o+1023,r=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));const a=[];for(s=52;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse();const u=a.join("");let c="";for(s=0;s<64;s+=8){let e=parseInt(u.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()},Mr=new RegExp("^-?(0*)\\d{1,10}$"),Fr=function(e){if(Mr.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Lr=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw _r("Exception was thrown by user callback.",t),e}),Math.floor(0))}},Vr=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class Br{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){_r(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class jr{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(br("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',_r(e)}}class Ur{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Ur.OWNER="owner";const Hr="5",qr=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Kr="ac",$r="websocket",Wr="long_polling";class Gr{constructor(e,t,n,r,i=!1,o="",s=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=hr.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&hr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function zr(e,t,n){let r;if(i("string"==typeof t,"typeof type must == string"),i("object"==typeof n,"typeof params must == object"),t===$r)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Wr)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const o=[];return xr(n,((e,t)=>{o.push(e+"="+t)})),r+o.join("&")}class Jr{constructor(){this.counters_={}}incrementCounter(e,t=1){C(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return h(this.counters_)}}const Qr={},Yr={};function Zr(e){const t=e.toString();return Qr[t]||(Qr[t]=new Jr),Qr[t]}class Xr{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Lr((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const ei="start";class ti{constructor(e,t,n,r,i,o,s){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Er(e),this.stats_=Zr(t),this.urlFn=e=>(this.appCheckToken&&(e[Kr]=this.appCheckToken),zr(t,Wr,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Xr(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new ni(((...e)=>{const[t,n,r,i,o]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===ei)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[ei]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=Hr,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[Kr]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&qr.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ti.forceAllow_=!0}static forceDisallow(){ti.forceDisallow_=!0}static isAvailable(){return!(!ti.forceAllow_&&(ti.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=I(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=c(t),r=kr(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=I(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ni{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=gr(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=ni.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){br("frame writing exception"),e.stack&&br(e.stack),br(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||br("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{br("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let ri=null;"undefined"!=typeof MozWebSocket?ri=MozWebSocket:"undefined"!=typeof WebSocket&&(ri=WebSocket);class ii{constructor(e,t,n,r,i,o,s){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Er(this.connId),this.stats_=Zr(t),this.connURL=ii.connectionURL_(t,o,s,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const o={};return o.v=Hr,"undefined"!=typeof location&&location.hostname&&qr.test(location.hostname)&&(o.r="f"),t&&(o.s=t),n&&(o.ls=n),r&&(o[Kr]=r),i&&(o.p=i),zr(e,$r,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,hr.set("previous_websocket_failure",!0);try{let e;0,this.mySock=new ri(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){ii.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==ri&&!ii.forceDisallow_}static previouslyFailed(){return hr.isInMemoryStorage||!0===hr.get("previous_websocket_failure")}markConnectionHealthy(){hr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=w(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(i(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=I(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=kr(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ii.responsesRequiredToBeHealthy=2,ii.healthyTimeout=3e4;class oi{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[ti,ii]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=ii&&ii.isAvailable();let n=t&&!ii.previouslyFailed();if(e.webSocketOnly&&(t||_r("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[ii];else{const e=this.transports_=[];for(const t of oi.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);oi.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}oi.globalTransportInitialized_=!1;class si{constructor(e,t,n,r,i,o,s,a,u,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Er("c:"+this.id+":"),this.transportManager_=new oi(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Vr((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Pr("t",e),n=Pr("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Pr("t",e),n=Pr("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Pr("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?wr("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):wr("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Hr!==n&&_r("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Vr((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Vr((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(hr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class ai{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class ui{constructor(e){this.allowedEvents_=e,this.listeners_={},i(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){i(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class ci extends ui{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||v()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new ci}getInitialEvent(e){return i("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class li{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function di(){return new li("")}function hi(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function pi(e){return e.pieces_.length-e.pieceNum_}function fi(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new li(e.pieces_,t)}function gi(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function mi(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function vi(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new li(t,0)}function yi(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof li)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new li(n,0)}function Si(e){return e.pieceNum_>=e.pieces_.length}function bi(e,t){const n=hi(e),r=hi(t);if(null===n)return t;if(n===r)return bi(fi(e),fi(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Ei(e,t){if(pi(e)!==pi(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function wi(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(pi(e)>pi(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Ii{constructor(e,t){this.errorPrefix_=t,this.parts_=mi(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=L(this.parts_[e]);_i(this)}}function _i(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ci(e))}function Ci(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Ai extends ui{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Ai}getInitialEvent(e){return i("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Ti=1e3;class Ri extends ai{constructor(e,t,n,r,i,o,s,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=s,this.authOverride_=a,this.id=Ri.nextPersistentConnectionId_++,this.log_=Er("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ti,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Ai.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&ci.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,o={r,a:e,b:t};this.log_(I(o)),i(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new g,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const o=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+o),this.listens.has(s)||this.listens.set(s,new Map),i(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),i(!this.listens.get(s).has(o),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(o,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const o=i.d,s=i.s;Ri.warnOnListenWarnings_(o,t),(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==s&&this.removeListen_(n,r),e.onComplete&&e.onComplete(s,o))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&C(e,"w")){const n=A(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();_r(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=_(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=_(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),i(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+I(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):wr("Unrecognized action received from server: "+I(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){i(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ti,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ti,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Ti),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Ri.nextConnectionId_++,o=this.lastSessionId;let s=!1,a=null;const u=function(){a?a.close():(s=!0,n())},c=function(e){i(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:u,sendRequest:c};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[i,u]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);s?br("getToken() completed but was canceled"):(br("getToken() completed. Creating connection."),this.authToken_=i&&i.accessToken,this.appCheckToken_=u&&u.token,a=new si(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{_r(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),o))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&_r(e),u())}}}interrupt(e){br("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){br("Resuming connection for reason: "+e),delete this.interruptReasons_[e],T(this.interruptReasons_)&&(this.reconnectDelay_=Ti,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Dr(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new li(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){br("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){br("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+ur.replace(/\./g,"-")]=1,v()?e["framework.cordova"]=1:y()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ci.getInstance().currentlyOnline();return T(this.interruptReasons_)&&e}}Ri.nextPersistentConnectionId_=0,Ri.nextConnectionId_=0;class Oi{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Oi(e,t)}}class Pi{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Oi(Ar,e),r=new Oi(Ar,t);return 0!==this.compare(n,r)}minPost(){return Oi.MIN}}let Di;class ki extends Pi{static get __EMPTY_NODE(){return Di}static set __EMPTY_NODE(e){Di=e}compare(e,t){return Rr(e.name,t.name)}isDefinedOn(e){throw o("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Oi.MIN}maxPost(){return new Oi(Tr,Di)}makePost(e,t){return i("string"==typeof e,"KeyIndex indexValue must always be a string."),new Oi(e,Di)}toString(){return".key"}}const xi=new ki;class Ni{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Mi{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Mi.RED,this.left=null!=r?r:Fi.EMPTY_NODE,this.right=null!=i?i:Fi.EMPTY_NODE}copy(e,t,n,r,i){return new Mi(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Fi.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Fi.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Mi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Mi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Mi.RED=!0,Mi.BLACK=!1;class Fi{constructor(e,t=Fi.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Fi(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Mi.BLACK,null,null))}remove(e){return new Fi(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Mi.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ni(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ni(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ni(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ni(this.root_,null,this.comparator_,!0,e)}}function Li(e,t){return Rr(e.name,t.name)}function Vi(e,t){return Rr(e,t)}let Bi;Fi.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Mi(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const ji=function(e){return"number"==typeof e?"number:"+Nr(e):"string:"+e},Ui=function(e){if(e.isLeafNode()){const t=e.val();i("string"==typeof t||"number"==typeof t||"object"==typeof t&&C(t,".sv"),"Priority must be a string or number.")}else i(e===Bi||e.isEmpty(),"priority of unexpected type.");i(e===Bi||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Hi,qi,Ki;class $i{constructor(e,t=$i.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,i(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Ui(this.priorityNode_)}static set __childrenNodeConstructor(e){Hi=e}static get __childrenNodeConstructor(){return Hi}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new $i(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:$i.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Si(e)?this:".priority"===hi(e)?this.priorityNode_:$i.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:$i.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=hi(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(i(".priority"!==n||1===pi(e),".priority must be the last token in a path"),this.updateImmediateChild(n,$i.__childrenNodeConstructor.EMPTY_NODE.updateChild(fi(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ji(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Nr(this.value_):this.value_,this.lazyHash_=mr(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===$i.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof $i.__childrenNodeConstructor?-1:(i(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=$i.VALUE_TYPE_ORDER.indexOf(t),o=$i.VALUE_TYPE_ORDER.indexOf(n);return i(r>=0,"Unknown leaf type: "+t),i(o>=0,"Unknown leaf type: "+n),r===o?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}$i.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Wi=new class extends Pi{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Rr(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Oi.MIN}maxPost(){return new Oi(Tr,new $i("[PRIORITY-POST]",Ki))}makePost(e,t){const n=qi(e);return new Oi(t,new $i("[PRIORITY-POST]",n))}toString(){return".priority"}},Gi=Math.log(2);class zi{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Gi,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Ji=function(e,t,n,r){e.sort(t);const i=function(t,r){const o=r-t;let s,a;if(0===o)return null;if(1===o)return s=e[t],a=n?n(s):s,new Mi(a,s.node,Mi.BLACK,null,null);{const u=parseInt(o/2,10)+t,c=i(t,u),l=i(u+1,r);return s=e[u],a=n?n(s):s,new Mi(a,s.node,Mi.BLACK,c,l)}},o=function(t){let r=null,o=null,s=e.length;const a=function(t,r){const o=s-t,a=s;s-=t;const c=i(o+1,a),l=e[o],d=n?n(l):l;u(new Mi(d,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(o=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Mi.BLACK):(a(r,Mi.BLACK),a(r,Mi.RED))}return o}(new zi(e.length));return new Fi(r||t,o)};let Qi;const Yi={};class Zi{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return i(Yi&&Wi,"ChildrenNode.ts has not been loaded"),Qi=Qi||new Zi({".priority":Yi},{".priority":Wi}),Qi}get(e){const t=A(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Fi?t:null}hasIndex(e){return C(this.indexSet_,e.toString())}addIndex(e,t){i(e!==xi,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const o=t.getIterator(Oi.Wrap);let s,a=o.getNext();for(;a;)r=r||e.isDefinedOn(a.node),n.push(a),a=o.getNext();s=r?Ji(n,e.getCompare()):Yi;const u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;const l=Object.assign({},this.indexes_);return l[u]=s,new Zi(l,c)}addToIndexes(e,t){const n=R(this.indexes_,((n,r)=>{const o=A(this.indexSet_,r);if(i(o,"Missing index implementation for "+r),n===Yi){if(o.isDefinedOn(e.node)){const n=[],r=t.getIterator(Oi.Wrap);let i=r.getNext();for(;i;)i.name!==e.name&&n.push(i),i=r.getNext();return n.push(e),Ji(n,o.getCompare())}return Yi}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Oi(e.name,r))),i.insert(e,e.node)}}));return new Zi(n,this.indexSet_)}removeFromIndexes(e,t){const n=R(this.indexes_,(n=>{if(n===Yi)return n;{const r=t.get(e.name);return r?n.remove(new Oi(e.name,r)):n}}));return new Zi(n,this.indexSet_)}}let Xi;class eo{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ui(this.priorityNode_),this.children_.isEmpty()&&i(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Xi||(Xi=new eo(new Fi(Vi),null,Zi.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Xi}updatePriority(e){return this.children_.isEmpty()?this:new eo(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?Xi:t}}getChild(e){const t=hi(e);return null===t?this:this.getImmediateChild(t).getChild(fi(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(i(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Oi(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const o=r.isEmpty()?Xi:this.priorityNode_;return new eo(r,o,i)}}updateChild(e,t){const n=hi(e);if(null===n)return t;{i(".priority"!==hi(e)||1===pi(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(fi(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(Wi,((o,s)=>{t[o]=s.val(e),n++,i&&eo.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+ji(this.getPriority().val())+":"),this.forEachChild(Wi,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":mr(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Oi(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Oi(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Oi(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Oi.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Oi.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===to?-1:0}withIndex(e){if(e===xi||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new eo(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===xi||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(Wi),n=t.getIterator(Wi);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===xi?null:this.indexMap_.get(e.toString())}}eo.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const to=new class extends eo{constructor(){super(new Fi(Vi),eo.EMPTY_NODE,Zi.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return eo.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Oi,{MIN:{value:new Oi(Ar,eo.EMPTY_NODE)},MAX:{value:new Oi(Tr,to)}}),ki.__EMPTY_NODE=eo.EMPTY_NODE,$i.__childrenNodeConstructor=eo,Bi=to,Ki=to;const no=!0;function ro(e,t=null){if(null===e)return eo.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),i(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new $i(e,ro(t));if(e instanceof Array||!no){let n=eo.EMPTY_NODE;return xr(e,((t,r)=>{if(C(e,t)&&"."!==t.substring(0,1)){const e=ro(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(ro(t))}{const n=[];let r=!1;if(xr(e,((e,t)=>{if("."!==e.substring(0,1)){const i=ro(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Oi(e,i)))}})),0===n.length)return eo.EMPTY_NODE;const i=Ji(n,Li,(e=>e.name),Vi);if(r){const e=Ji(n,Wi.getCompare());return new eo(i,ro(t),new Zi({".priority":e},{".priority":Wi}))}return new eo(i,ro(t),Zi.Default)}}!function(e){qi=e}(ro);class io extends Pi{constructor(e){super(),this.indexPath_=e,i(!Si(e)&&".priority"!==hi(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Rr(e.name,t.name):i}makePost(e,t){const n=ro(e),r=eo.EMPTY_NODE.updateChild(this.indexPath_,n);return new Oi(t,r)}maxPost(){const e=eo.EMPTY_NODE.updateChild(this.indexPath_,to);return new Oi(Tr,e)}toString(){return mi(this.indexPath_,0).join("/")}}const oo=new class extends Pi{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Rr(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Oi.MIN}maxPost(){return Oi.MAX}makePost(e,t){const n=ro(e);return new Oi(t,n)}toString(){return".value"}};function so(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class ao{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Wi}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return i(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return i(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ar}hasEnd(){return this.endSet_}getIndexEndValue(){return i(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return i(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Tr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return i(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Wi}copy(){const e=new ao;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function uo(e){const t={};if(e.isDefault())return t;let n;if(e.index_===Wi?n="$priority":e.index_===oo?n="$value":e.index_===xi?n="$key":(i(e.index_ instanceof io,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=I(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=I(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+I(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=I(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+I(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function co(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Wi&&(t.i=e.index_.toString()),t}class lo extends ai{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Er("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(i(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=lo.getListenId_(e,n),s={};this.listens_[o]=s;const a=uo(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),A(this.listens_,o)===s){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=lo.getListenId_(e,t);delete this.listens_[n]}get(e){const t=uo(e._queryParams),n=e._path.toString(),r=new g;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+D(t);this.log_("Sending REST request for "+o);const s=new XMLHttpRequest;s.onreadystatechange=()=>{if(n&&4===s.readyState){this.log_("REST Response for "+o+" received. status:",s.status,"response:",s.responseText);let e=null;if(s.status>=200&&s.status<300){try{e=w(s.responseText)}catch(e){_r("Failed to parse JSON response for "+o+": "+s.responseText)}n(null,e)}else 401!==s.status&&404!==s.status&&_r("Got unsuccessful REST response for "+o+" Status: "+s.status),n(s.status);n=null}},s.open("GET",o,!0),s.send()}))}}class ho{constructor(){this.rootNode_=eo.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function po(){return{value:null,children:new Map}}function fo(e,t,n){if(Si(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=hi(t);e.children.has(r)||e.children.set(r,po()),fo(e.children.get(r),t=fi(t),n)}}function go(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{go(r,new li(t.toString()+"/"+e),n)}))}class mo{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&xr(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class vo{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new mo(e);const n=1e4+2e4*Math.random();Vr(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;xr(e,((e,r)=>{r>0&&C(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),Vr(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var yo,So;function bo(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(So=yo||(yo={}))[So.OVERWRITE=0]="OVERWRITE",So[So.MERGE=1]="MERGE",So[So.ACK_USER_WRITE=2]="ACK_USER_WRITE",So[So.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class Eo{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=yo.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Si(this.path)){if(null!=this.affectedTree.value)return i(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new li(e));return new Eo(di(),t,this.revert)}}return i(hi(this.path)===e,"operationForChild called for unrelated child."),new Eo(fi(this.path),this.affectedTree,this.revert)}}class wo{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=yo.OVERWRITE}operationForChild(e){return Si(this.path)?new wo(this.source,di(),this.snap.getImmediateChild(e)):new wo(this.source,fi(this.path),this.snap)}}class Io{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=yo.MERGE}operationForChild(e){if(Si(this.path)){const t=this.children.subtree(new li(e));return t.isEmpty()?null:t.value?new wo(this.source,di(),t.value):new Io(this.source,di(),t)}return i(hi(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Io(this.source,fi(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class _o{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Si(e))return this.isFullyInitialized()&&!this.filtered_;const t=hi(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function Co(e,t,n,r,i,s){const a=r.filter((e=>e.type===n));a.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw o("Should only compare child_ events.");const r=new Oi(t.childName,t.snapshotNode),i=new Oi(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),a.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Ao(e,t){return{eventCache:e,serverCache:t}}function To(e,t,n,r){return Ao(new _o(t,n,r),e.serverCache)}function Ro(e,t,n,r){return Ao(e.eventCache,new _o(t,n,r))}function Oo(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Po(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Do;class ko{constructor(e,t=(()=>(Do||(Do=new Fi(Or)),Do))()){this.value=e,this.children=t}static fromObject(e){let t=new ko(null);return xr(e,((e,n)=>{t=t.set(new li(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:di(),value:this.value};if(Si(e))return null;{const n=hi(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(fi(e),t);return null!=i?{path:yi(new li(n),i.path),value:i.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Si(e))return this;{const t=hi(e),n=this.children.get(t);return null!==n?n.subtree(fi(e)):new ko(null)}}set(e,t){if(Si(e))return new ko(t,this.children);{const n=hi(e),r=(this.children.get(n)||new ko(null)).set(fi(e),t),i=this.children.insert(n,r);return new ko(this.value,i)}}remove(e){if(Si(e))return this.children.isEmpty()?new ko(null):new ko(null,this.children);{const t=hi(e),n=this.children.get(t);if(n){const r=n.remove(fi(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new ko(null):new ko(this.value,i)}return this}}get(e){if(Si(e))return this.value;{const t=hi(e),n=this.children.get(t);return n?n.get(fi(e)):null}}setTree(e,t){if(Si(e))return t;{const n=hi(e),r=(this.children.get(n)||new ko(null)).setTree(fi(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new ko(this.value,i)}}fold(e){return this.fold_(di(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(yi(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,di(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Si(e))return null;{const r=hi(e),i=this.children.get(r);return i?i.findOnPath_(fi(e),yi(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,di(),t)}foreachOnPath_(e,t,n){if(Si(e))return this;{this.value&&n(t,this.value);const r=hi(e),i=this.children.get(r);return i?i.foreachOnPath_(fi(e),yi(t,r),n):new ko(null)}}foreach(e){this.foreach_(di(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(yi(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class xo{constructor(e){this.writeTree_=e}static empty(){return new xo(new ko(null))}}function No(e,t,n){if(Si(t))return new xo(new ko(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let o=r.value;const s=bi(i,t);return o=o.updateChild(s,n),new xo(e.writeTree_.set(i,o))}{const r=new ko(n),i=e.writeTree_.setTree(t,r);return new xo(i)}}}function Mo(e,t,n){let r=e;return xr(n,((e,n)=>{r=No(r,yi(t,e),n)})),r}function Fo(e,t){if(Si(t))return xo.empty();{const n=e.writeTree_.setTree(t,new ko(null));return new xo(n)}}function Lo(e,t){return null!=Vo(e,t)}function Vo(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(bi(n.path,t)):null}function Bo(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Wi,((e,n)=>{t.push(new Oi(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Oi(e,n.value))})),t}function jo(e,t){if(Si(t))return e;{const n=Vo(e,t);return new xo(null!=n?new ko(n):e.writeTree_.subtree(t))}}function Uo(e){return e.writeTree_.isEmpty()}function Ho(e,t){return qo(di(),e.writeTree_,t)}function qo(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,o)=>{".priority"===t?(i(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):n=qo(yi(e,t),o,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(yi(e,".priority"),r)),n}}function Ko(e,t){return ts(t,e)}function $o(e,t){if(e.snap)return wi(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&wi(yi(e.path,n),t))return!0;return!1}function Wo(e){return e.visible}function Go(e,t,n){let r=xo.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)wi(n,e)?(t=bi(n,e),r=No(r,t,s.snap)):wi(e,n)&&(t=bi(e,n),r=No(r,di(),s.snap.getChild(t)));else{if(!s.children)throw o("WriteRecord should have .snap or .children");if(wi(n,e))t=bi(n,e),r=Mo(r,t,s.children);else if(wi(e,n))if(t=bi(e,n),Si(t))r=Mo(r,di(),s.children);else{const e=A(s.children,hi(t));if(e){const n=e.getChild(fi(t));r=No(r,di(),n)}}}}}return r}function zo(e,t,n,r,i){if(r||i){const o=jo(e.visibleWrites,t);if(!i&&Uo(o))return n;if(i||null!=n||Lo(o,di())){const o=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(wi(e.path,t)||wi(t,e.path))};return Ho(Go(e.allWrites,o,t),n||eo.EMPTY_NODE)}return null}{const r=Vo(e.visibleWrites,t);if(null!=r)return r;{const r=jo(e.visibleWrites,t);return Uo(r)?n:null!=n||Lo(r,di())?Ho(r,n||eo.EMPTY_NODE):null}}}function Jo(e,t,n,r){return zo(e.writeTree,e.treePath,t,n,r)}function Qo(e,t){return function(e,t,n){let r=eo.EMPTY_NODE;const i=Vo(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Wi,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=jo(e.visibleWrites,t);return n.forEachChild(Wi,((e,t)=>{const n=Ho(jo(i,new li(e)),t);r=r.updateImmediateChild(e,n)})),Bo(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return Bo(jo(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function Yo(e,t,n,r){return function(e,t,n,r,o){i(r||o,"Either existingEventSnap or existingServerSnap must exist");const s=yi(t,n);if(Lo(e.visibleWrites,s))return null;{const t=jo(e.visibleWrites,s);return Uo(t)?o.getChild(n):Ho(t,o.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function Zo(e,t){return function(e,t){return Vo(e.visibleWrites,t)}(e.writeTree,yi(e.treePath,t))}function Xo(e,t,n){return function(e,t,n,r){const i=yi(t,n),o=Vo(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?Ho(jo(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function es(e,t){return ts(yi(e.treePath,t),e.writeTree)}function ts(e,t){return{treePath:e,writeTree:t}}class ns{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;i("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),i(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,so(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,(s=n,{type:"child_removed",snapshotNode:r.oldSnap,childName:s}));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,function(e,t){return{type:"child_added",snapshotNode:t,childName:e}}(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw o("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,so(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e);var s}getChanges(){return Array.from(this.changeMap.values())}}const rs=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class is{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new _o(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Xo(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Po(this.viewCache_),i=function(e,t,n,r,i,o){return function(e,t,n,r,i,o,s){let a;const u=jo(e.visibleWrites,t),c=Vo(u,di());if(null!=c)a=c;else{if(null==n)return[];a=Ho(u,n)}if(a=a.withIndex(s),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=s.getCompare(),n=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s);let u=n.getNext();for(;u&&e.length<i;)0!==t(u,r)&&e.push(u),u=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,o)}(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function os(e,t,n,r,o,s){const a=t.eventCache;if(null!=Zo(r,n))return t;{let u,c;if(Si(n))if(i(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Po(t),i=Qo(r,n instanceof eo?n:eo.EMPTY_NODE);u=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=Jo(r,Po(t));u=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const l=hi(n);if(".priority"===l){i(1===pi(n),"Can't have a priority with additional path components");const o=a.getNode();c=t.serverCache.getNode();const s=Yo(r,n,o,c);u=null!=s?e.filter.updatePriority(o,s):a.getNode()}else{const i=fi(n);let d;if(a.isCompleteForChild(l)){c=t.serverCache.getNode();const e=Yo(r,n,a.getNode(),c);d=null!=e?a.getNode().getImmediateChild(l).updateChild(i,e):a.getNode().getImmediateChild(l)}else d=Xo(r,l,t.serverCache);u=null!=d?e.filter.updateChild(a.getNode(),l,d,i,o,s):a.getNode()}}return To(t,u,a.isFullyInitialized()||Si(n),e.filter.filtersNodes())}}function ss(e,t,n,r,i,o,s,a){const u=t.serverCache;let c;const l=s?e.filter:e.filter.getIndexedFilter();if(Si(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){const e=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),e,null)}else{const e=hi(n);if(!u.isCompleteForPath(n)&&pi(n)>1)return t;const i=fi(n),o=u.getNode().getImmediateChild(e).updateChild(i,r);c=".priority"===e?l.updatePriority(u.getNode(),o):l.updateChild(u.getNode(),e,o,i,rs,null)}const d=Ro(t,c,u.isFullyInitialized()||Si(n),l.filtersNodes());return os(e,d,n,i,new is(i,d,o),a)}function as(e,t,n,r,i,o,s){const a=t.eventCache;let u,c;const l=new is(i,t,o);if(Si(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,s),u=To(t,c,!0,e.filter.filtersNodes());else{const i=hi(n);if(".priority"===i)c=e.filter.updatePriority(t.eventCache.getNode(),r),u=To(t,c,a.isFullyInitialized(),a.isFiltered());else{const o=fi(n),c=a.getNode().getImmediateChild(i);let d;if(Si(o))d=r;else{const e=l.getCompleteChild(i);d=null!=e?".priority"===gi(o)&&e.getChild(vi(o)).isEmpty()?e:e.updateChild(o,r):eo.EMPTY_NODE}u=c.equals(d)?t:To(t,e.filter.updateChild(a.getNode(),i,d,o,l,s),a.isFullyInitialized(),e.filter.filtersNodes())}}return u}function us(e,t){return e.eventCache.isCompleteForChild(t)}function cs(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function ls(e,t,n,r,i,o,s,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let u,c=t;u=Si(n)?r:new ko(null).setTree(n,r);const l=t.serverCache.getNode();return u.children.inorderTraversal(((n,r)=>{if(l.hasChild(n)){const u=cs(0,t.serverCache.getNode().getImmediateChild(n),r);c=ss(e,c,new li(n),u,i,o,s,a)}})),u.children.inorderTraversal(((n,r)=>{const u=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!u){const u=cs(0,t.serverCache.getNode().getImmediateChild(n),r);c=ss(e,c,new li(n),u,i,o,s,a)}})),c}function ds(e,t){const n=Po(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Si(t)&&!n.getImmediateChild(hi(t)).isEmpty())?n.getChild(t):null}function hs(e,t,n,r){t.type===yo.MERGE&&null!==t.source.queryId&&(i(Po(e.viewCache_),"We should always have a full cache before handling merges"),i(Oo(e.viewCache_),"Missing event cache, even though we have a server cache"));const s=e.viewCache_,a=function(e,t,n,r,s){const a=new ns;let u,c;if(n.type===yo.OVERWRITE){const o=n;o.source.fromUser?u=as(e,t,o.path,o.snap,r,s,a):(i(o.source.fromServer,"Unknown source."),c=o.source.tagged||t.serverCache.isFiltered()&&!Si(o.path),u=ss(e,t,o.path,o.snap,r,s,c,a))}else if(n.type===yo.MERGE){const o=n;o.source.fromUser?u=function(e,t,n,r,i,o,s){let a=t;return r.foreach(((r,u)=>{const c=yi(n,r);us(t,hi(c))&&(a=as(e,a,c,u,i,o,s))})),r.foreach(((r,u)=>{const c=yi(n,r);us(t,hi(c))||(a=as(e,a,c,u,i,o,s))})),a}(e,t,o.path,o.children,r,s,a):(i(o.source.fromServer,"Unknown source."),c=o.source.tagged||t.serverCache.isFiltered(),u=ls(e,t,o.path,o.children,r,s,c,a))}else if(n.type===yo.ACK_USER_WRITE){const o=n;u=o.revert?function(e,t,n,r,o,s){let a;if(null!=Zo(r,n))return t;{const u=new is(r,t,o),c=t.eventCache.getNode();let l;if(Si(n)||".priority"===hi(n)){let n;if(t.serverCache.isFullyInitialized())n=Jo(r,Po(t));else{const e=t.serverCache.getNode();i(e instanceof eo,"serverChildren would be complete if leaf node"),n=Qo(r,e)}l=e.filter.updateFullNode(c,n,s)}else{const i=hi(n);let o=Xo(r,i,t.serverCache);null==o&&t.serverCache.isCompleteForChild(i)&&(o=c.getImmediateChild(i)),l=null!=o?e.filter.updateChild(c,i,o,fi(n),u,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(c,i,eo.EMPTY_NODE,fi(n),u,s):c,l.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=Jo(r,Po(t)),a.isLeafNode()&&(l=e.filter.updateFullNode(l,a,s)))}return a=t.serverCache.isFullyInitialized()||null!=Zo(r,di()),To(t,l,a,e.filter.filtersNodes())}}(e,t,o.path,r,s,a):function(e,t,n,r,i,o,s){if(null!=Zo(i,n))return t;const a=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(Si(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return ss(e,t,n,u.getNode().getChild(n),i,o,a,s);if(Si(n)){let r=new ko(null);return u.getNode().forEachChild(xi,((e,t)=>{r=r.set(new li(e),t)})),ls(e,t,n,r,i,o,a,s)}return t}{let c=new ko(null);return r.foreach(((e,t)=>{const r=yi(n,e);u.isCompleteForPath(r)&&(c=c.set(e,u.getNode().getChild(r)))})),ls(e,t,n,c,i,o,a,s)}}(e,t,o.path,o.affectedTree,r,s,a)}else{if(n.type!==yo.LISTEN_COMPLETE)throw o("Unknown operation type: "+n.type);u=function(e,t,n,r,i){const o=t.serverCache;return os(e,Ro(t,o.getNode(),o.isFullyInitialized()||Si(n),o.isFiltered()),n,r,rs,i)}(e,t,n.path,r,a)}const l=a.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Oo(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push({type:"value",snapshotNode:Oo(t)})}}(t,u,l),{viewCache:u,changes:l}}(e.processor_,s,t,n,r);var u,c;return u=e.processor_,c=a.viewCache,i(c.eventCache.getNode().isIndexed(u.filter.getIndex()),"Event snap not indexed"),i(c.serverCache.getNode().isIndexed(u.filter.getIndex()),"Server snap not indexed"),i(a.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,function(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],o=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Co(e,i,"child_removed",t,r,n),Co(e,i,"child_added",t,r,n),Co(e,i,"child_moved",o,r,n),Co(e,i,"child_changed",t,r,n),Co(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}(e,a.changes,a.viewCache.eventCache.getNode(),null)}let ps,fs;function gs(e,t,n,r){const o=t.source.queryId;if(null!==o){const s=e.views.get(o);return i(null!=s,"SyncTree gave us an op for an invalid query."),hs(s,t,n,r)}{let i=[];for(const o of e.views.values())i=i.concat(hs(o,t,n,r));return i}}function ms(e,t){let n=null;for(const r of e.views.values())n=n||ds(r,t);return n}class vs{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ko(null),this.pendingWriteTree_={visibleWrites:xo.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ys(e,t,n,r,o){return function(e,t,n,r,o){i(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:o}),o&&(e.visibleWrites=No(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,o),o?ws(e,new wo({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Ss(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));i(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let o=r.visible,s=!1,a=e.allWrites.length-1;for(;o&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=n&&$o(t,r.path)?o=!1:wi(r.path,t.path)&&(s=!0)),a--}return!!o&&(s?(function(e){e.visibleWrites=Go(e.allWrites,Wo,di()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(r.snap?e.visibleWrites=Fo(e.visibleWrites,r.path):xr(r.children,(t=>{e.visibleWrites=Fo(e.visibleWrites,yi(r.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new ko(null);return null!=r.snap?t=t.set(di(),!0):xr(r.children,(e=>{t=t.set(new li(e),!0)})),ws(e,new Eo(r.path,t,n))}return[]}function bs(e,t,n){return ws(e,new wo({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Es(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=ms(n,bi(e,t));if(r)return r}));return zo(r,t,i,n,!0)}function ws(e,t){return Is(t,e.syncPointTree_,null,Ko(e.pendingWriteTree_,di()))}function Is(e,t,n,r){if(Si(e.path))return _s(e,t,n,r);{const i=t.get(di());null==n&&null!=i&&(n=ms(i,di()));let o=[];const s=hi(e.path),a=e.operationForChild(s),u=t.children.get(s);if(u&&a){const e=n?n.getImmediateChild(s):null,t=es(r,s);o=o.concat(Is(a,u,e,t))}return i&&(o=o.concat(gs(i,e,r,n))),o}}function _s(e,t,n,r){const i=t.get(di());null==n&&null!=i&&(n=ms(i,di()));let o=[];return t.children.inorderTraversal(((t,i)=>{const s=n?n.getImmediateChild(t):null,a=es(r,t),u=e.operationForChild(t);u&&(o=o.concat(_s(u,i,s,a)))})),i&&(o=o.concat(gs(i,e,r,n))),o}function Cs(e,t){return e.tagToQueryMap.get(t)}function As(e){const t=e.indexOf("$");return i(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new li(e.substr(0,t))}}function Ts(e,t,n){const r=e.syncPointTree_.get(t);return i(r,"Missing sync point for query tag that we're tracking"),gs(r,n,Ko(e.pendingWriteTree_,t),null)}class Rs{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Rs(t)}node(){return this.node_}}class Os{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=yi(this.path_,e);return new Os(this.syncTree_,t)}node(){return Es(this.syncTree_,this.path_)}}const Ps=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Ds=function(e,t,n){return e&&"object"==typeof e?(i(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?ks(e[".sv"],t,n):"object"==typeof e[".sv"]?xs(e[".sv"],t):void i(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},ks=function(e,t,n){if("timestamp"===e)return n.timestamp;i(!1,"Unexpected server value: "+e)},xs=function(e,t,n){e.hasOwnProperty("increment")||i(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&i(!1,"Unexpected increment value: "+r);const o=t.node();if(i(null!=o,"Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;const s=o.getValue();return"number"!=typeof s?r:s+r},Ns=function(e,t,n,r){return Fs(t,new Os(n,e),r)},Ms=function(e,t,n){return Fs(e,new Rs(t),n)};function Fs(e,t,n){const r=e.getPriority().val(),i=Ds(r,t.getImmediateChild(".priority"),n);let o;if(e.isLeafNode()){const r=e,o=Ds(r.getValue(),t,n);return o!==r.getValue()||i!==r.getPriority().val()?new $i(o,ro(i)):e}{const r=e;return o=r,i!==r.getPriority().val()&&(o=o.updatePriority(new $i(i))),r.forEachChild(Wi,((e,r)=>{const i=Fs(r,t.getImmediateChild(e),n);i!==r&&(o=o.updateImmediateChild(e,i))})),o}}class Ls{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Vs(e,t){let n=t instanceof li?t:new li(t),r=e,i=hi(n);for(;null!==i;){const e=A(r.node.children,i)||{children:{},childCount:0};r=new Ls(i,r,e),n=fi(n),i=hi(n)}return r}function Bs(e){return e.node.value}function js(e,t){e.node.value=t,$s(e)}function Us(e){return e.node.childCount>0}function Hs(e,t){xr(e.node.children,((n,r)=>{t(new Ls(n,e,r))}))}function qs(e,t,n,r){n&&!r&&t(e),Hs(e,(e=>{qs(e,t,!0,r)})),n&&r&&t(e)}function Ks(e){return new li(null===e.parent?e.name:Ks(e.parent)+"/"+e.name)}function $s(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===Bs(e)&&!Us(e)}(n),i=C(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,$s(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,$s(e))}(e.parent,e.name,e)}const Ws=/[\[\].#$\/\u0000-\u001F\u007F]/,Gs=/[\[\].#$\u0000-\u001F\u007F]/,zs=10485760,Js=function(e){return"string"==typeof e&&0!==e.length&&!Ws.test(e)},Qs=function(e,t,n){const r=n instanceof li?new Ii(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Ci(r));if("function"==typeof t)throw new Error(e+"contains a function "+Ci(r)+" with contents = "+t.toString());if(Cr(t))throw new Error(e+"contains "+t.toString()+" "+Ci(r));if("string"==typeof t&&t.length>zs/3&&L(t)>zs)throw new Error(e+"contains a string greater than "+zs+" utf8 bytes "+Ci(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(xr(t,((t,o)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Js(t)))throw new Error(e+" contains an invalid key ("+t+") "+Ci(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var s,a;a=t,(s=r).parts_.length>0&&(s.byteLength_+=1),s.parts_.push(a),s.byteLength_+=L(a),_i(s),Qs(e,o,r),function(e){const t=e.parts_.pop();e.byteLength_-=L(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Ci(r)+" in addition to actual children.")}},Ys=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Js(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),function(e){return"string"==typeof e&&0!==e.length&&!Gs.test(e)}(e)}(n))throw new Error(function(e,t){return`${e} failed: ${t} argument `}(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Zs{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Xs(e,t,n){(function(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],o=i.getPath();null===n||Ei(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)})(e,n),function(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];i&&(t(i.path)?(ea(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}(e,(e=>wi(e,t)||wi(t,e)))}function ea(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();yr&&br("event: "+n.toString()),Lr(r)}}}const ta=25;class na{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Zs,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=po(),this.transactionQueueTree_=new Ls,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ra(e,t,n){if(e.stats_=Zr(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new lo(e.repoInfo_,((t,n,r,i)=>{sa(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>aa(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{I(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Ri(e.repoInfo_,t,((t,n,r,i)=>{sa(e,t,n,r,i)}),(t=>{aa(e,t)}),(t=>{!function(e,t){xr(t,((t,n)=>{ua(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,n){const r=t.toString();return Yr[r]||(Yr[r]=new vo(e.stats_,e.server_)),Yr[r]}(e.repoInfo_),e.infoData_=new ho,e.infoSyncTree_=new vs({startListening:(t,n,r,i)=>{let o=[];const s=e.infoData_.getNode(t._path);return s.isEmpty()||(o=bs(e.infoSyncTree_,t._path,s),setTimeout((()=>{i("ok")}),0)),o},stopListening:()=>{}}),ua(e,"connected",!1),e.serverSyncTree_=new vs({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const o=i(n,r);Xs(e.eventQueue_,t._path,o)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function ia(e){const t=e.infoData_.getNode(new li(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function oa(e){return Ps({timestamp:ia(e)})}function sa(e,t,n,r,i){e.dataUpdateCount++;const o=new li(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let s=[];if(i)if(r){const t=R(n,(e=>ro(e)));s=function(e,t,n,r){const i=Cs(e,r);if(i){const r=As(i),o=r.path,s=r.queryId,a=bi(o,t),u=ko.fromObject(n);return Ts(e,o,new Io(bo(s),a,u))}return[]}(e.serverSyncTree_,o,t,i)}else{const t=ro(n);s=function(e,t,n,r){const i=Cs(e,r);if(null!=i){const r=As(i),o=r.path,s=r.queryId,a=bi(o,t);return Ts(e,o,new wo(bo(s),a,n))}return[]}(e.serverSyncTree_,o,t,i)}else if(r){const t=R(n,(e=>ro(e)));s=function(e,t,n){const r=ko.fromObject(n);return ws(e,new Io({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,o,t)}else{const t=ro(n);s=bs(e.serverSyncTree_,o,t)}let a=o;s.length>0&&(a=pa(e,o)),Xs(e.eventQueue_,a,s)}function aa(e,t){ua(e,"connected",t),!1===t&&function(e){la(e,"onDisconnectEvents");const t=oa(e),n=po();go(e.onDisconnect_,di(),((r,i)=>{const o=Ns(r,i,e.serverSyncTree_,t);fo(n,r,o)}));let r=[];go(n,di(),((t,n)=>{r=r.concat(bs(e.serverSyncTree_,t,n));const i=function(e,t){const n=Ks(fa(e,t)),r=Vs(e.transactionQueueTree_,t);return function(e,t,n){let r=void 0?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{ya(e,t)})),ya(e,r),qs(r,(t=>{ya(e,t)})),n}(e,t);pa(e,i)})),e.onDisconnect_=po(),Xs(e.eventQueue_,di(),r)}(e)}function ua(e,t,n){const r=new li("/.info/"+t),i=ro(n);e.infoData_.updateSnapshot(r,i);const o=bs(e.infoSyncTree_,r,i);Xs(e.eventQueue_,r,o)}function ca(e){return e.nextWriteId_++}function la(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),br(n,...t)}function da(e,t,n){return Es(e.serverSyncTree_,t,n)||eo.EMPTY_NODE}function ha(e,t=e.transactionQueueTree_){if(t||va(e,t),Bs(t)){const n=ga(e,t);i(n.length>0,"Sending zero length transaction queue"),n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),o=da(e,t,r);let s=o;const a=o.hash();for(let e=0;e<n.length;e++){const r=n[e];i(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const o=bi(t,r.path);s=s.updateChild(o,r.currentOutputSnapshotRaw)}const u=s.val(!0),c=t;e.server_.put(c.toString(),u,(r=>{la(e,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(Ss(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();va(e,Vs(e.transactionQueueTree_,t)),ha(e,e.transactionQueueTree_),Xs(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)Lr(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{_r("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}pa(e,t)}}),a)}(e,Ks(t),n)}else Us(t)&&Hs(t,(t=>{ha(e,t)}))}function pa(e,t){const n=fa(e,t),r=Ks(n);return function(e,t,n){if(0===t.length)return;const r=[];let o=[];const s=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let u=0;u<t.length;u++){const c=t[u],l=bi(n,c.path);let d,h=!1;if(i(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,d=c.abortReason,o=o.concat(Ss(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=ta)h=!0,d="maxretry",o=o.concat(Ss(e.serverSyncTree_,c.currentWriteId,!0));else{const n=da(e,c.path,s);c.currentInputSnapshot=n;const r=t[u].update(n.val());if(void 0!==r){Qs("transaction failed: Data returned ",r,c.path);let t=ro(r);"object"==typeof r&&null!=r&&C(r,".priority")||(t=t.updatePriority(n.getPriority()));const i=c.currentWriteId,a=oa(e),u=Ms(t,n,a);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=u,c.currentWriteId=ca(e),s.splice(s.indexOf(i),1),o=o.concat(ys(e.serverSyncTree_,c.path,u,c.currentWriteId,c.applyLocally)),o=o.concat(Ss(e.serverSyncTree_,i,!0))}else h=!0,d="nodata",o=o.concat(Ss(e.serverSyncTree_,c.currentWriteId,!0))}Xs(e.eventQueue_,n,o),o=[],h&&(t[u].status=2,a=t[u].unwatcher,setTimeout(a,Math.floor(0)),t[u].onComplete&&("nodata"===d?r.push((()=>t[u].onComplete(null,!1,t[u].currentInputSnapshot))):r.push((()=>t[u].onComplete(new Error(d),!1,null)))))}var a;va(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)Lr(r[e]);ha(e,e.transactionQueueTree_)}(e,ga(e,n),r),r}function fa(e,t){let n,r=e.transactionQueueTree_;for(n=hi(t);null!==n&&void 0===Bs(r);)r=Vs(r,n),n=hi(t=fi(t));return r}function ga(e,t){const n=[];return ma(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function ma(e,t,n){const r=Bs(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);Hs(t,(t=>{ma(e,t,n)}))}function va(e,t){const n=Bs(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,js(t,n.length>0?n:void 0)}Hs(t,(t=>{va(e,t)}))}function ya(e,t){const n=Bs(t);if(n){const r=[];let o=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(i(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(i(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),o=o.concat(Ss(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?js(t,void 0):n.length=s+1,Xs(e.eventQueue_,Ks(t),o);for(let e=0;e<r.length;e++)Lr(r[e])}}const Sa=function(e,t){const n=ba(e),r=n.namespace;"firebase.com"===n.domain&&Ir(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Ir("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&_r("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Gr(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new li(n.pathString)}},ba=function(e){let t="",n="",r="",i="",o="",s=!0,a="https",u=443;if("string"==typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let l=e.indexOf("/");-1===l&&(l=e.length);let d=e.indexOf("?");-1===d&&(d=e.length),t=e.substring(0,Math.min(l,d)),l<d&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(l,d)));const h=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):_r(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,d)));c=t.indexOf(":"),c>=0?(s="https"===a||"wss"===a,u=parseInt(t.substring(c+1),10)):c=t.length;const p=t.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),o=r}"ns"in h&&(o=h.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};class Ea{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Si(this._path)?null:gi(this._path)}get ref(){return new wa(this._repo,this._path)}get _queryIdentifier(){const e=co(this._queryParams),t=Dr(e);return"{}"===t?"default":t}get _queryObject(){return co(this._queryParams)}isEqual(e){if(!((e=V(e))instanceof Ea))return!1;const t=this._repo===e._repo,n=Ei(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class wa extends Ea{constructor(e,t){super(e,t,new ao,!1)}get parent(){const e=vi(this._path);return null===e?null:new wa(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}!function(e){i(!ps,"__referenceConstructor has already been defined"),ps=e}(wa),function(e){i(!fs,"__referenceConstructor has already been defined"),fs=e}(wa);const Ia={};class _a{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ra(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new wa(this._repo,di())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=Ia[t];n&&n[e.key]===e||Ir(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Ir("Cannot call "+e+" on a deleted database.")}}Ri.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Ri.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},ur=Ye,Ge(new B("database",((e,{instanceIdentifier:t})=>function(e,t,n,r,i){let o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||Ir("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),br("Using default host for project ",e.options.projectId),o=`${e.options.projectId}-default-rtdb.firebaseio.com`);let s,a,u=Sa(o,i),c=u.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(s=!0,o=`http://${a}?ns=${c.namespace}`,u=Sa(o,i),c=u.repoInfo):s=!u.repoInfo.secure;const l=i&&s?new Ur(Ur.OWNER):new jr(e.name,e.options,t);Ys("Invalid Firebase Database URL",u),Si(u.path)||Ir("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function(e,t,n,r){let i=Ia[t.name];i||(i={},Ia[t.name]=i);let o=i[e.toURLString()];return o&&Ir("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new na(e,!1,n,r),i[e.toURLString()]=o,o}(c,e,l,new Br(e.name,n));return new _a(d,e)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Ze(sr,ar,void 0),Ze(sr,ar,"esm2017"),Ze("firebase","10.12.2","app"),function(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw Je.create("bad-app-name",{appName:String(i)});if(n||(n=(()=>{var e;return null===(e=f())||void 0===e?void 0:e.config})()),!n)throw Je.create("no-options");const o=qe.get(i);if(o){if(O(n,o.options)&&O(r,o.config))return o;throw Je.create("duplicate-app",{appName:i})}const s=new H(i);for(const e of $e.values())s.addComponent(e);const a=new Qe(n,r,s);qe.set(i,a)}(JSON.parse('{"apiKey":"AIzaSyAGmGHVKLxIHsT9ikcRXniud5pAZb7pU0Y","authDomain":"gates-oh.firebaseapp.com","projectId":"gates-oh","storageBucket":"gates-oh.appspot.com","messagingSenderId":"880940805741","appId":"1:880940805741:web:1631c19f516d966ac49964","measurementId":"G-PHFDH66KC9","databaseURL":"https://gates-oh-default-rtdb.firebaseio.com"}'));const Ca={width:1280,height:720},Aa="RvXUSUKwSHeoelnnEyPFdQ",Ta="OaGp0UeaBUd6o58OJ7wqRoNR4OedQT8nqqa5",Ra=r().createClient();async function Oa(e,t,n=!1){async function r(e){const n=Ra.getMediaStream();try{const r=await n.attachVideo(e.userId,Ca);t.appendChild(r)}catch(e){console.error("Error connecting to video:",e)}}const i=Ra.getAllUser().find((t=>t.displayName===e));i?(t.innerHTML="",console.log("User found:",i.displayName),await r(i)):t.innerHTML=`${e} has not connected`,n||(Ra.on("user-added",(async t=>{const n=t.user;n.displayName===e&&(console.log(`User joined: ${n.displayName}`),await r(n))})),Ra.on("video-active-change",(async t=>{const n=Ra.getAllUser().find((e=>e.userId===t.userId));n&&n.displayName===e&&(console.log(`User started video: ${n.displayName}`),await r(n))})))}async function Pa(t,n,r,i){const o=document.createElement("div");o.className="container glass permissions-form",o.id="permissions-form";const s=document.createElement("p");s.id="label",s.className="monitor-label",s.innerText="Accept permissions to join meeting";const a=document.createElement("div");a.className="video",a.id="permissions-video-container";const u=document.createElement("video-player-container");u.id="permissions-video",a.appendChild(u);const c=document.createElement("button");c.id="accept-permissions-button",c.className="glass-button denied",c.innerText="Join!",c.disabled=!0,o.appendChild(s),o.appendChild(a),o.appendChild(c),t.appendChild(o);const l=new Event("AcceptedPermissions");return n.style.display="none",await async function(t,n,r,i){const o=function(t,n,r,i,o,s){const a=Math.round((new Date).getTime()/1e3)-30,u={app_key:t,tpc:r,role_type:i,session_key:o,user_identity:s,version:1,iat:a,exp:a+7200},c=JSON.stringify({alg:"HS256",typ:"JWT"}),l=JSON.stringify(u);return e.hT.JWS.sign("HS256",c,l,n)}(Aa,Ta,n,i?1:0,r,t);try{await Ra.init("en-US","Global",{patchJsMedia:!0}),console.log("Joining ",n," with JWT token:",o," as ",t),await Ra.join(n,o,t,r)}catch(e){console.error("Error joining meeting:",e)}}(r,i,"",!0),await async function(){const e=Ra.getMediaStream(),t=document.createElement("video");t.autoplay=!0,t.muted=!0,t.setAttribute("playsinline","true");try{const n=Ra.getCurrentUserInfo().userId;await e.startVideo({videoElement:t,userId:n}),console.log("Current user video started without attaching to DOM")}catch(e){console.error("Error starting current user's video:",e)}}(),await Oa(r,document.getElementById("permissions-video"),!0),c.disabled=!1,c.addEventListener("click",(async function(){await async function(e,t){const n=Ra.getAllUser().find((t=>t.displayName===e));if(n){const r=Ra.getMediaStream();await r.detachVideo(n.userId),t.innerHTML=`${e} has disconnected`}else t.innerHTML=`${e} has not connected`}(r,document.getElementById("permissions-video")),document.dispatchEvent(l)})),document.addEventListener("AcceptedPermissions",(async function(){n.style.display="block",o.style.display="none"})),l}function Da(e){const t=document.getElementsByClassName("filter-container");for(let n=0;n<t.length;n++)t[n].classList.add("animate-"+e),t[n].addEventListener("animationend",(function(){this.classList.remove("animate-"+e)}))}document.addEventListener("DOMContentLoaded",(async function(){Pa(document.getElementById("permissions-container"),document.getElementById("main-content"),"test","test-meeting")})),document.addEventListener("AcceptedPermissions",(async function(){await Oa("test",document.getElementById("filter-video"),!0)})),document.getElementById("clear-filter-button").addEventListener("click",(function(){const e=document.getElementsByClassName("filter-container");for(let t=0;t<e.length;t++)e[t].style.filter="",e[t].style.transform=""})),document.getElementById("blur-filter-button").addEventListener("click",(()=>Da("blur"))),document.getElementById("brightness-filter-button").addEventListener("click",(()=>Da("brightness"))),document.getElementById("contrast-filter-button").addEventListener("click",(()=>Da("contrast"))),document.getElementById("grayscale-filter-button").addEventListener("click",(()=>Da("grayscale"))),document.getElementById("hue-rotate-filter-button").addEventListener("click",(()=>Da("hue-rotate"))),document.getElementById("scale-filter-button").addEventListener("click",(()=>Da("scale"))),document.getElementById("translate-filter-button").addEventListener("click",(()=>Da("translate"))),document.getElementById("3d-filter-button").addEventListener("click",(()=>Da("3d")))})()})();