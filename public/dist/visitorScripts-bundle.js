/*! For license information please see visitorScripts-bundle.js.LICENSE.txt */
(()=>{var e={729:function(e,t,n){e=n.nmd(e),function(t){"use strict";function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,d(i.key),i)}}function u(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function d(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}var h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},h(e,t)};function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var f=function(){return f=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},f.apply(this,arguments)};function g(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}function y(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function b(e){return"function"==typeof e}function E(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var w=E((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function _(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var I=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,i,r;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=m(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(b(u))try{u()}catch(e){r=e instanceof w?e.errors:[e]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var c=m(l),d=c.next();!d.done;d=c.next()){var h=d.value;try{T(h)}catch(e){r=null!=r?r:[],e instanceof w?r=y(y([],v(r)),v(e.errors)):r.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}if(r)throw new w(r)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)T(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&_(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&_(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),C=I.EMPTY;function A(e){return e instanceof I||e&&"closed"in e&&b(e.remove)&&b(e.add)&&b(e.unsubscribe)}function T(e){b(e)?e():e.unsubscribe()}var R={setTimeout:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=R.delegate;return(null==r?void 0:r.setTimeout)?r.setTimeout.apply(r,y([e,t],v(n))):setTimeout.apply(void 0,y([e,t],v(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function O(e){R.setTimeout((function(){throw e}))}function P(){}function D(e){e()}var k=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,A(t)&&t.add(n)):n.destination=F,n}return p(t,e),t.create=function(e,t,n){return new N(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(I);Function.prototype.bind;var x=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){M(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){M(e)}else M(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){M(e)}},e}(),N=function(e){function t(t,n,i){var r,o=e.call(this)||this;return r=b(t)||!t?{next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0}:t,o.destination=new x(r),o}return p(t,e),t}(k);function M(e){O(e)}var F={closed:!0,next:P,error:function(e){throw e},complete:P},L="function"==typeof Symbol&&Symbol.observable||"@@observable";function V(e){return e}function j(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return B(e)}function B(e){return 0===e.length?V:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var U=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var i,r=this,o=(i=e)&&i instanceof k||function(e){return e&&b(e.next)&&b(e.error)&&b(e.complete)}(i)&&A(i)?e:new N(e,t,n);return D((function(){var e=r,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?r._subscribe(o):r._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=H(t))((function(t,i){var r=new N({next:function(t){try{e(t)}catch(e){i(e),r.unsubscribe()}},error:i,complete:t});n.subscribe(r)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return B(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=H(e))((function(e,n){var i;t.subscribe((function(e){return i=e}),(function(e){return n(e)}),(function(){return e(i)}))}))},e.create=function(t){return new e(t)},e}();function H(e){var t;return null!==(t=null!=e?e:undefined)&&void 0!==t?t:Promise}function q(e){return function(t){if(function(e){return b(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function K(e,t,n,i,r){return new W(e,t,n,i,r)}var $,W=function(e){function t(t,n,i,r,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=r?function(e){try{r(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=i?function(){try{i()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return p(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(k),G=E((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),z=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return p(t,e),t.prototype.lift=function(e){var t=new J(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new G},t.prototype.next=function(e){var t=this;D((function(){var n,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var r=m(t.currentObservers),o=r.next();!o.done;o=r.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;D((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;D((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,i=n.hasError,r=n.isStopped,o=n.observers;return i||r?C:(this.currentObservers=null,o.push(e),new I((function(){t.currentObservers=null,_(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,i=t.thrownError,r=t.isStopped;n?e.error(i):r&&e.complete()},t.prototype.asObservable=function(){var e=new U;return e.source=this,e},t.create=function(e,t){return new J(e,t)},t}(U),J=function(e){function t(t,n){var i=e.call(this)||this;return i.destination=t,i.source=n,i}return p(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:C},t}(z),Q=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return p(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,i=e._value;if(t)throw n;return this._throwIfClosed(),i},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(z),Y={now:function(){return(Y.delegate||Date).now()},delegate:void 0},Z=function(e){function t(t,n,i){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===i&&(i=Y);var r=e.call(this)||this;return r._bufferSize=t,r._windowTime=n,r._timestampProvider=i,r._buffer=[],r._infiniteTimeWindow=!0,r._infiniteTimeWindow=n===1/0,r._bufferSize=Math.max(1,t),r._windowTime=Math.max(1,n),r}return p(t,e),t.prototype.next=function(t){var n=this,i=n.isStopped,r=n._buffer,o=n._infiniteTimeWindow,s=n._timestampProvider,a=n._windowTime;i||(r.push(t),!o&&r.push(s.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,i=this._buffer.slice(),r=0;r<i.length&&!e.closed;r+=n?1:2)e.next(i[r]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,i=e._buffer,r=e._infiniteTimeWindow,o=(r?1:2)*t;if(t<1/0&&o<i.length&&i.splice(0,i.length-o),!r){for(var s=n.now(),a=0,u=1;u<i.length&&i[u]<=s;u+=2)a=u;a&&i.splice(0,a+1)}},t}(z),X=function(e){function t(t,n){return e.call(this)||this}return p(t,e),t.prototype.schedule=function(e,t){return this},t}(I),ee={setInterval:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=ee.delegate;return(null==r?void 0:r.setInterval)?r.setInterval.apply(r,y([e,t],v(n))):setInterval.apply(void 0,y([e,t],v(n)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},te=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return p(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),ee.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&ee.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,i=!1;try{this.work(e)}catch(e){i=!0,n=e||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,i=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,_(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(X),ne=1,ie={};function re(e){return e in ie&&(delete ie[e],!0)}var oe=function(e){var t=ne++;return ie[t]=!0,$||($=Promise.resolve()),$.then((function(){return re(t)&&e()})),t},se={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=se.delegate;return((null==n?void 0:n.setImmediate)||oe).apply(void 0,y([],v(e)))},clearImmediate:function(e){return function(e){re(e)}(e)},delegate:void 0},ae=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i}return p(t,e),t.prototype.requestAsyncId=function(t,n,i){return void 0===i&&(i=0),null!==i&&i>0?e.prototype.requestAsyncId.call(this,t,n,i):(t.actions.push(this),t._scheduled||(t._scheduled=se.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,n,i){var r;if(void 0===i&&(i=0),null!=i?i>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,i);var o=t.actions;null!=n&&(null===(r=o[o.length-1])||void 0===r?void 0:r.id)!==n&&(se.clearImmediate(n),t._scheduled===n&&(t._scheduled=void 0))},t}(te),ue=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Y.now,e}(),le=function(e){function t(t,n){void 0===n&&(n=ue.now);var i=e.call(this,t,n)||this;return i.actions=[],i._active=!1,i}return p(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(ue),ce=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,i=this.actions;e=e||i.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,n){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw n}},t}(le))(ae),de=new le(te),he=de,pe=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i}return p(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,i){return void 0===i&&(i=0),null!=i&&i>0||null==i&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,i):(t.flush(this),0)},t}(te),fe=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t}(le))(pe),ge=new U((function(e){return e.complete()}));function me(e){return e&&b(e.schedule)}function ve(e){return e[e.length-1]}function ye(e){return b(ve(e))?e.pop():void 0}function Se(e){return me(ve(e))?e.pop():void 0}var be=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Ee(e){return b(null==e?void 0:e.then)}function we(e){return b(e[L])}function _e(e){return Symbol.asyncIterator&&b(null==e?void 0:e[Symbol.asyncIterator])}function Ie(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Ce="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ae(e){return b(null==e?void 0:e[Ce])}function Te(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){o.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{!function(e){e.value instanceof S?Promise.resolve(e.value.v).then(u,l):c(o[0][2],e)}(r[e](t))}catch(e){c(o[0][3],e)}}function u(e){a("next",e)}function l(e){a("throw",e)}function c(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,(function(){var t,n,i;return g(this,(function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,S(t.read())];case 3:return n=r.sent(),i=n.value,n.done?[4,S(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,S(i)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Re(e){return b(null==e?void 0:e.getReader)}function Oe(e){if(e instanceof U)return e;if(null!=e){if(we(e))return r=e,new U((function(e){var t=r[L]();if(b(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(be(e))return i=e,new U((function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()}));if(Ee(e))return n=e,new U((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,O)}));if(_e(e))return Pe(e);if(Ae(e))return t=e,new U((function(e){var n,i;try{for(var r=m(t),o=r.next();!o.done;o=r.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}e.complete()}));if(Re(e))return Pe(Te(e))}var t,n,i,r;throw Ie(e)}function Pe(e){return new U((function(t){(function(e,t){var n,i,r,o;return function(e,t,n,i){return new(n||(n=Promise))((function(t,r){function o(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,s)}a((i=i.apply(e,[])).next())}))}(this,0,void 0,(function(){var s,a;return g(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=m(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,r,(t=e[n](t)).done,t.value)}))}}}(e),u.label=1;case 1:return[4,n.next()];case 2:if((i=u.sent()).done)return[3,4];if(s=i.value,t.next(s),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=u.sent(),r={error:a},[3,11];case 6:return u.trys.push([6,,9,10]),i&&!i.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function De(e,t,n,i,r){void 0===i&&(i=0),void 0===r&&(r=!1);var o=t.schedule((function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()}),i);if(e.add(o),!r)return o}function ke(e,t){return void 0===t&&(t=0),q((function(n,i){n.subscribe(K(i,(function(n){return De(i,e,(function(){return i.next(n)}),t)}),(function(){return De(i,e,(function(){return i.complete()}),t)}),(function(n){return De(i,e,(function(){return i.error(n)}),t)})))}))}function xe(e,t){return void 0===t&&(t=0),q((function(n,i){i.add(e.schedule((function(){return n.subscribe(i)}),t))}))}function Ne(e,t){if(!e)throw new Error("Iterable cannot be null");return new U((function(n){De(n,t,(function(){var i=e[Symbol.asyncIterator]();De(n,t,(function(){i.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function Me(e,t){return t?function(e,t){if(null!=e){if(we(e))return function(e,t){return Oe(e).pipe(xe(t),ke(t))}(e,t);if(be(e))return function(e,t){return new U((function(n){var i=0;return t.schedule((function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())}))}))}(e,t);if(Ee(e))return function(e,t){return Oe(e).pipe(xe(t),ke(t))}(e,t);if(_e(e))return Ne(e,t);if(Ae(e))return function(e,t){return new U((function(n){var i;return De(n,t,(function(){i=e[Ce](),De(n,t,(function(){var e,t,r;try{t=(e=i.next()).value,r=e.done}catch(e){return void n.error(e)}r?n.complete():n.next(t)}),0,!0)})),function(){return b(null==i?void 0:i.return)&&i.return()}}))}(e,t);if(Re(e))return function(e,t){return Ne(Te(e),t)}(e,t)}throw Ie(e)}(e,t):Oe(e)}function Fe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Me(e,Se(e))}function Le(e,t){var n=b(e)?e:function(){return e},i=function(e){return e.error(n())};return new U(t?function(e){return t.schedule(i,0,e)}:i)}var Ve=E((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function je(e,t){var n="object"==typeof t;return new Promise((function(i,r){var o=new N({next:function(e){i(e),o.unsubscribe()},error:r,complete:function(){n?i(t.defaultValue):r(new Ve)}});e.subscribe(o)}))}function Be(e){return e instanceof Date&&!isNaN(e)}var Ue=E((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function He(e,t){var n=Be(e)?{first:e}:"number"==typeof e?{each:e}:e,i=n.first,r=n.each,o=n.with,s=void 0===o?qe:o,a=n.scheduler,u=void 0===a?null!=t?t:de:a,l=n.meta,c=void 0===l?null:l;if(null==i&&null==r)throw new TypeError("No timeout provided.");return q((function(e,t){var n,o,a=null,l=0,d=function(e){o=De(t,u,(function(){try{n.unsubscribe(),Oe(s({meta:c,lastValue:a,seen:l})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe(K(t,(function(e){null==o||o.unsubscribe(),l++,t.next(a=e),r>0&&d(r)}),void 0,void 0,(function(){(null==o?void 0:o.closed)||null==o||o.unsubscribe(),a=null}))),!l&&d(null!=i?"number"==typeof i?i:+i-u.now():r)}))}function qe(e){throw new Ue(e)}function Ke(e,t){return q((function(n,i){var r=0;n.subscribe(K(i,(function(n){i.next(e.call(t,n,r++))})))}))}var $e=Array.isArray;function We(e){return Ke((function(t){return function(e,t){return $e(t)?e.apply(void 0,y([],v(t))):e(t)}(e,t)}))}var Ge=Array.isArray,ze=Object.getPrototypeOf,Je=Object.prototype,Qe=Object.keys;function Ye(e,t,n){return void 0===n&&(n=1/0),b(t)?Ye((function(n,i){return Ke((function(e,r){return t(n,e,i,r)}))(Oe(e(n,i)))}),n):("number"==typeof t&&(n=t),q((function(t,i){return function(e,t,n,i,r,o,s,a){var u=[],l=0,c=0,d=!1,h=function(){!d||u.length||l||t.complete()},p=function(e){l++;var r=!1;Oe(n(e,c++)).subscribe(K(t,(function(e){t.next(e)}),(function(){r=!0}),void 0,(function(){if(r)try{l--;for(var e=function(){var e=u.shift();p(e)};u.length&&l<i;)e();h()}catch(e){t.error(e)}})))};return e.subscribe(K(t,(function(e){return l<i?p(e):u.push(e)}),(function(){d=!0,h()}))),function(){}}(t,i,e,n)})))}function Ze(e){return void 0===e&&(e=1/0),Ye(V,e)}function Xe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ze(1)(Me(e,Se(e)))}function et(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ye(e),i=function(e){if(1===e.length){var t=e[0];if(Ge(t))return{args:t,keys:null};if((i=t)&&"object"==typeof i&&ze(i)===Je){var n=Qe(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var i;return{args:e,keys:null}}(e),r=i.args,o=i.keys,s=new U((function(e){var t=r.length;if(t)for(var n=new Array(t),i=t,s=t,a=function(t){var a=!1;Oe(r[t]).subscribe(K(e,(function(e){a||(a=!0,s--),n[t]=e}),(function(){return i--}),void 0,(function(){i&&a||(s||e.next(o?function(e,t){return e.reduce((function(e,n,i){return e[n]=t[i],e}),{})}(o,n):n),e.complete())})))},u=0;u<t;u++)a(u);else e.complete()}));return n?s.pipe(We(n)):s}var tt=["addListener","removeListener"],nt=["addEventListener","removeEventListener"],it=["on","off"];function rt(e,t,n,i){if(b(n)&&(i=n,n=void 0),i)return rt(e,t,n).pipe(We(i));var r=v(function(e){return b(e.addEventListener)&&b(e.removeEventListener)}(e)?nt.map((function(i){return function(r){return e[i](t,r,n)}})):function(e){return b(e.addListener)&&b(e.removeListener)}(e)?tt.map(ot(e,t)):function(e){return b(e.on)&&b(e.off)}(e)?it.map(ot(e,t)):[],2),o=r[0],s=r[1];if(!o&&be(e))return Ye((function(e){return rt(e,t,n)}))(Oe(e));if(!o)throw new TypeError("Invalid event target");return new U((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return o(t),function(){return s(t)}}))}function ot(e,t){return function(n){return function(i){return e[n](t,i)}}}function st(e,t,n){return n?st(e,t).pipe(We(n)):new U((function(n){var i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.next(1===e.length?e[0]:e)},r=e(i);return b(t)?function(){return t(i,r)}:void 0}))}function at(e,t,n){void 0===e&&(e=0),void 0===n&&(n=he);var i=-1;return null!=t&&(me(t)?n=t:i=t),new U((function(t){var r=Be(e)?+e-n.now():e;r<0&&(r=0);var o=0;return n.schedule((function(){t.closed||(t.next(o++),0<=i?this.schedule(void 0,i):t.complete())}),r)}))}function ut(e,t){return void 0===e&&(e=0),void 0===t&&(t=de),e<0&&(e=0),at(e,e,t)}function lt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Se(e),i=function(e,t){return"number"==typeof ve(e)?e.pop():1/0}(e),r=e;return r.length?1===r.length?Oe(r[0]):Ze(i)(Me(r,n)):ge}var ct=Array.isArray;function dt(e,t){return function(n,i){return!e.call(t,n,i)}}function ht(e,t){return q((function(n,i){var r=0;n.subscribe(K(i,(function(n){return e.call(t,n,r++)&&i.next(n)})))}))}function pt(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 1===(t=1===(e=t).length&&ct(e[0])?e[0]:e).length?Oe(t[0]):new U(function(e){return function(t){for(var n=[],i=function(i){n.push(Oe(e[i]).subscribe(K(t,(function(e){if(n){for(var r=0;r<n.length;r++)r!==i&&n[r].unsubscribe();n=null}t.next(e)}))))},r=0;n&&!t.closed&&r<e.length;r++)i(r)}}(t))}function ft(e){return q((function(t,n){var i,r=null,o=!1;r=t.subscribe(K(n,void 0,void 0,(function(s){i=Oe(e(s,ft(e)(t))),r?(r.unsubscribe(),r=null,i.subscribe(n)):o=!0}))),o&&(r.unsubscribe(),r=null,i.subscribe(n))}))}function gt(e){return e<=0?function(){return ge}:q((function(t,n){var i=0;t.subscribe(K(n,(function(t){++i<=e&&(n.next(t),e<=i&&n.complete())})))}))}function mt(e){return Ke((function(){return e}))}function vt(e,t){return t?function(n){return Xe(t.pipe(gt(1),q((function(e,t){e.subscribe(K(t,P))}))),n.pipe(vt(e)))}:Ye((function(t,n){return Oe(e(t,n)).pipe(gt(1),mt(t))}))}function yt(e,t){void 0===t&&(t=de);var n=at(e,t);return vt((function(){return n}))}function St(e,t,n){return void 0===n&&(n=1/0),b(t)?Ye((function(){return e}),t,n):("number"==typeof t&&(n=t),Ye((function(){return e}),n))}function bt(e,t){return q(function(e,t,n,i,r){return function(i,r){var o=n,s=t,a=0;i.subscribe(K(r,(function(t){var n=a++;s=o?e(s,t,n):(o=!0,t),r.next(s)}),void 0))}}(e,t,arguments.length>=2))}function Et(e){return q((function(t,n){var i=!1,r=0;t.subscribe(K(n,(function(t){return(i||(i=!e(t,r++)))&&n.next(t)})))}))}function wt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Se(e);return q((function(t,i){(n?Xe(e,t,n):Xe(e,t)).subscribe(i)}))}function _t(e,t){return q((function(n,i){var r=null,o=0,s=!1,a=function(){return s&&!r&&i.complete()};n.subscribe(K(i,(function(n){null==r||r.unsubscribe();var s=0,u=o++;Oe(e(n,u)).subscribe(r=K(i,(function(e){return i.next(t?t(n,e,u,s++):e)}),(function(){r=null,a()})))}),(function(){s=!0,a()})))}))}function It(e){return q((function(t,n){Oe(e).subscribe(K(n,(function(){return n.complete()}),P)),!n.closed&&t.subscribe(n)}))}function Ct(e,t){return void 0===t&&(t=!1),q((function(n,i){var r=0;n.subscribe(K(i,(function(n){var o=e(n,r++);(o||t)&&i.next(n),!o&&i.complete()})))}))}function At(e,t,n){var i=b(e)||t||n?{next:e,error:t,complete:n}:e;return i?q((function(e,t){var n;null===(n=i.subscribe)||void 0===n||n.call(i);var r=!0;e.subscribe(K(t,(function(e){var n;null===(n=i.next)||void 0===n||n.call(i,e),t.next(e)}),(function(){var e;r=!1,null===(e=i.complete)||void 0===e||e.call(i),t.complete()}),(function(e){var n;r=!1,null===(n=i.error)||void 0===n||n.call(i,e),t.error(e)}),(function(){var e,t;r&&(null===(e=i.unsubscribe)||void 0===e||e.call(i)),null===(t=i.finalize)||void 0===t||t.call(i)})))})):V}function Tt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ye(e);return q((function(t,i){for(var r=e.length,o=new Array(r),s=e.map((function(){return!1})),a=!1,u=function(t){Oe(e[t]).subscribe(K(i,(function(e){o[t]=e,a||s[t]||(s[t]=!0,(a=s.every(V))&&(s=null))}),P))},l=0;l<r;l++)u(l);t.subscribe(K(i,(function(e){if(a){var t=y([e],v(o));i.next(n?n.apply(void 0,y([],v(t))):t)}})))}))}function Rt(e){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rt(e)}function Ot(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Rt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!==Rt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Rt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function kt(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var xt="function"==typeof Symbol&&Symbol.observable||"@@observable",Nt=function(){return Math.random().toString(36).substring(7).split("").join(".")},Mt={INIT:"@@redux/INIT"+Nt(),REPLACE:"@@redux/REPLACE"+Nt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Nt()}};function Ft(e,t,n){var i;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(kt(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(kt(1));return n(Ft)(e,t)}if("function"!=typeof e)throw new Error(kt(2));var r=e,o=t,s=[],a=s,u=!1;function l(){a===s&&(a=s.slice())}function c(){if(u)throw new Error(kt(3));return o}function d(e){if("function"!=typeof e)throw new Error(kt(4));if(u)throw new Error(kt(5));var t=!0;return l(),a.push(e),function(){if(t){if(u)throw new Error(kt(6));t=!1,l();var n=a.indexOf(e);a.splice(n,1),s=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(kt(7));if(void 0===e.type)throw new Error(kt(8));if(u)throw new Error(kt(9));try{u=!0,o=r(o,e)}finally{u=!1}for(var t=s=a,n=0;n<t.length;n++)(0,t[n])();return e}return h({type:Mt.INIT}),(i={dispatch:h,subscribe:d,getState:c,replaceReducer:function(e){if("function"!=typeof e)throw new Error(kt(10));r=e,h({type:Mt.REPLACE})}})[xt]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(kt(11));function n(){e.next&&e.next(c())}return n(),{unsubscribe:t(n)}}})[xt]=function(){return this},e},i}function Lt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var Vt=function(e,t){return Vt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Vt(e,t)},jt=function(e){function t(t,n){var i=e.call(this,(function(e){var t=i.__notifier.subscribe(e);return t&&!t.closed&&e.next(i.value),t}))||this;return i.__notifier=new z,i.value=n,t.subscribe((function(e){e!==i.value&&(i.value=e,i.__notifier.next(e))})),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Vt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(U),Bt=function(e,t){return e===t||"function"==typeof t&&e===t.toString()};function Ut(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;return ht(1===n?function(t){return Bt(t.type,e[0])}:function(t){for(var i=0;i<n;i++)if(Bt(t.type,e[i]))return!0;return!1})}var Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function qt(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function Kt(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}"object"===(void 0===n.g?"undefined":Ht(n.g))&&n.g?n.g:"undefined"!=typeof window&&window,qt((function e(t,n,i){e.super_.call(this,"E",t),Object.defineProperty(this,"lhs",{value:n,enumerable:!0}),Object.defineProperty(this,"rhs",{value:i,enumerable:!0})}),Kt),qt((function e(t,n){e.super_.call(this,"N",t),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}),Kt),qt((function e(t,n){e.super_.call(this,"D",t),Object.defineProperty(this,"lhs",{value:n,enumerable:!0})}),Kt),qt((function e(t,n,i){e.super_.call(this,"A",t),Object.defineProperty(this,"index",{value:n,enumerable:!0}),Object.defineProperty(this,"item",{value:i,enumerable:!0})}),Kt);const $t=!1;var Wt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function Gt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function zt(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})})),t}var Jt=function(e,t,n,i,r,o,s,a){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,i,r,o,s,a],c=0;(u=new Error(t.replace(/%s/g,(function(){return l[c++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}},Qt=function(e){return"function"==typeof e},Yt=function(e){return e.toString()},Zt=function(e){return"string"==typeof e},Xt="/",en="||",tn=function(e){return e},nn=function(e){return null===e};function rn(e,t,n){void 0===t&&(t=tn),Jt(Qt(t)||nn(t),"Expected payloadCreator to be a function, undefined or null");var i=nn(t)||t===tn?tn:function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return e instanceof Error?e:t.apply(void 0,[e].concat(i))},r=Qt(n),o=e.toString(),s=function(){var t=i.apply(void 0,arguments),o={type:e};return t instanceof Error&&(o.error=!0),void 0!==t&&(o.payload=t),r&&(o.meta=n.apply(void 0,arguments)),o};return s.toString=function(){return o},s}var on=function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},sn=function(e){return Array.isArray(e)},an=function(e){return null==e},un=/\s/,ln=/(_|-|\.|:)/,cn=/([a-z][A-Z]|[A-Z][a-z])/,dn=/[\W_]+(.|$)/g,hn=/(.)([A-Z]+)/g,pn=function(e){return function(e){return function(e){return un.test(e)?e.toLowerCase():ln.test(e)?(function(e){return e.replace(dn,(function(e,t){return t?" "+t:""}))}(e)||e).toLowerCase():cn.test(e)?function(e){return e.replace(hn,(function(e,t,n){return t+" "+n.toLowerCase().split("").join(" ")}))}(e).toLowerCase():e.toLowerCase()}(e).replace(/[\W_]+(.|$)/g,(function(e,t){return t?" "+t:""})).trim()}(e).replace(/\s(\w)/g,(function(e,t){return t.toUpperCase()}))},fn=function(e){return-1===e.indexOf("/")?pn(e):e.split("/").map(pn).join("/")},gn=function(e,t){return e.reduce((function(e,n){return t(e,n)}),{})},mn=function(e){return"undefined"!=typeof Map&&e instanceof Map};function vn(e){if(mn(e))return Array.from(e.keys());if("undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys)return Reflect.ownKeys(e);var t=Object.getOwnPropertyNames(e);return"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t}function yn(e,t){return mn(t)?t.get(e):t[e]}var Sn=function(e){return function t(n,i,r,o){var s=void 0===i?{}:i,a=s.namespace,u=void 0===a?Xt:a,l=s.prefix;return void 0===r&&(r={}),void 0===o&&(o=""),vn(n).forEach((function(i){var s=function(e){return o||!l||l&&new RegExp("^"+l+u).test(e)?e:""+l+u+e}(function(e){var t;if(!o)return e;var n=e.toString().split(en),i=o.split(en);return(t=[]).concat.apply(t,i.map((function(e){return n.map((function(t){return""+e+u+t}))}))).join(en)}(i)),a=yn(i,n);e(a)?t(a,{namespace:u,prefix:l},r,s):r[s]=a})),r}},bn=Sn(on);function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){wn(e,t,n[t])}))}return e}function wn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _n(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o=on((r=n)[r.length-1])?n.pop():{};return Jt(n.every(Zt)&&(Zt(e)||on(e)),"Expected optional object followed by string action types"),Zt(e)?Cn([e].concat(n),o):En({},function(e,t){return function(e,t){var n=void 0===t?{}:t,i=n.namespace,r=void 0===i?Xt:i,o=n.prefix;function s(t,n,i){var r=fn(i.shift());!function(e){return 0===e.length}(i)?(n[r]||(n[r]={}),s(t,n[r],i)):n[r]=e[t]}var a={};return Object.getOwnPropertyNames(e).forEach((function(e){var t=o?e.replace(""+o+r,""):e;return s(e,a,t.split(r))})),a}(In(bn(e,t)),t)}(e,o),Cn(n,o))}function In(e,t){var n=void 0===t?{}:t,i=n.prefix,r=n.namespace,o=void 0===r?Xt:r;return gn(Object.keys(e),(function(t,n){var r,s=e[n];Jt(function(e){if(Qt(e)||an(e))return!0;if(sn(e)){var t=e[0],n=void 0===t?tn:t,i=e[1];return Qt(n)&&Qt(i)}return!1}(s),"Expected function, undefined, null, or array with payload and meta functions for "+n);var a=i?""+i+o+n:n,u=sn(s)?rn.apply(void 0,[a].concat(s)):rn(a,s);return En({},t,((r={})[n]=u,r))}))}function Cn(e,t){var n=In(gn(e,(function(e,t){var n;return En({},e,((n={})[t]=tn,n))})),t);return gn(Object.keys(n),(function(e,t){var i;return En({},e,((i={})[fn(t)]=n[t],i))}))}var An=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i="function"!=typeof t[t.length-1]&&t.pop(),r=t;if(void 0===i)throw new TypeError("The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.");return function(e,t){for(var n=arguments.length,o=Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s];var a=void 0===e,u=void 0===t;return a&&u&&i?i:r.reduce((function(e,n){return n.apply(void 0,[e,t].concat(o))}),a&&!u&&i?i:e)}},Tn=Sn((function(e){return(on(e)||mn(e))&&!function(e){var t=vn(e),n=t.every((function(e){return"next"===e||"throw"===e}));return t.length&&t.length<=2&&n}(e)}));function Rn(e,t,n){void 0===n&&(n={}),Jt(on(e)||mn(e),"Expected handlers to be a plain object.");var i=Tn(e,n),r=vn(i).map((function(e){return function(e,t,n){void 0===t&&(t=tn);var i=Yt(e).split(en);Jt(!function(e){return void 0===e}(n),"defaultState for reducer handling "+i.join(", ")+" should be defined"),Jt(Qt(t)||on(t),"Expected reducer to be a function or object with next and throw reducers");var r=Qt(t)?[t,t]:[t.next,t.throw].map((function(e){return an(e)?tn:e})),o=r[0],s=r[1];return function(e,t){void 0===e&&(e=n);var r=t.type;return r&&-1!==i.indexOf(Yt(r))?(!0===t.error?s:o)(e,t):e}}(e,yn(e,i),t)})),o=An.apply(void 0,r.concat([t]));return function(e,n){return void 0===e&&(e=t),o(e,n)}}const On=rn("CONNECT_ZOOM_SOCKET"),Pn=rn("CONNECT_XMPP_SOCKET"),Dn=rn("CLOSE_ZOOM_SOCKET"),kn=rn("CLOSE_XMPP_SOCKET"),xn=rn("RECEIVE_MESSAGE_FROM_ZOOM_SOCKET"),Nn=rn("RECEIVE_SHARING_PAYLOAD_FROM_ZOOM_SOCKET"),Mn=rn("RECEIVE_MESSAGE_FROM_XMPP_SOCKET"),Fn=rn("CONNECT_MAIN_SESSION_SOCKET"),Ln=rn("CLOSE_MAIN_SESSION_SOCKET"),Vn=rn("RECEIVE_MESSAGE_FROM_MAIN_SESSION_SOCKET"),{setZoomSocketStatus:jn,setRwgServersList:Bn,setRwgRetryCount:Un,setXmppSocketStatus:Hn,setMainSessionSocketStatus:qn,resetSocket:Kn}=_n("SET_ZOOM_SOCKET_STATUS","SET_RWG_SERVERS_LIST","SET_RWG_RETRY_COUNT","SET_XMPP_SOCKET_STATUS","SET_MAIN_SESSION_SOCKET_STATUS","RESET_SOCKET"),$n=rn("CONNECT_TO_MEDIA_STREAM"),Wn=rn("RECEIVE_PAYLOAD_FROM_MEDIA_SDK"),{setAudioEncodeStatus:Gn,setAudioDecodeStatus:zn,setVideoEncodeStatus:Jn,setVideoDecodeStatus:Qn,setSharingEncodeStatus:Yn,setSharingDecodeStatus:Zn,setMediaConstraints:Xn,setMediaEncryptKey:ei,setIsEnableDecoderInWorklet:ti,setPatchedMediaSdkStatus:ni,setMediaAssetsPath:ii,setIsEnableVideoAudioQos:ri,setIsAudioBridgeReceiveReady:oi,setIsAudioBridgeSendReady:si,setIsMediaAgentInitialized:ai,setAdaptedAbOptionForMediaSdk:ui,resetMedia:li}=_n("SET_AUDIO_ENCODE_STATUS","SET_AUDIO_DECODE_STATUS","SET_VIDEO_ENCODE_STATUS","SET_VIDEO_DECODE_STATUS","SET_SHARING_ENCODE_STATUS","SET_SHARING_DECODE_STATUS","SET_MEDIA_CONSTRAINTS","SET_MEDIA_ENCRYPT_KEY","SET_IS_ENABLE_DECODER_IN_WORKLET","SET_PATCHED_MEDIA_SDK_STATUS","SET_MEDIA_ASSETS_PATH","SET_IS_ENABLE_VIDEO_AUDIO_QOS","SET_IS_AUDIO_BRIDGE_RECEIVE_READY","SET_IS_AUDIO_BRIDGE_SEND_READY","SET_IS_MEDIA_AGENT_INITIALIZED","SET_ADAPTED_AB_OPTION_FOR_MEDIA_SDK","RESET_MEDIA");function ci(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return e(Fe(...i||[]),t,null)}function di(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return lt(...t.map((e=>{const t=e(...n);if(!t)throw new TypeError(`combineEpics: one of the provided Epics "${e.name||"<anonymous>"}" does not return a stream. Double check you're not missing a return statement!`);return t.pipe(ft(((e,t)=>(setTimeout((()=>{throw e}),0),t))))})))};try{Object.defineProperty(i,"name",{value:`combineEpics(${t.map((e=>e.name||"<anonymous>")).join(", ")})`})}catch(e){}return i}function hi(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return di(...t.flatMap((e=>Object.values(e))))}function pi(e,t){return e.pipe(Ut(`${xn}`),ht((e=>e.payload.evt===t)))}function fi(e,t){return e.pipe(Ut(`${Vn}`),ht((e=>e.payload.evt===t)))}function gi(e,t){return e.pipe(Ut(`${Mn}`),ht((e=>e.payload.evt===t)))}function mi(e,t){return e.pipe(Ut(`${xn}`,`${Vn}`),ht((e=>e.payload.evt===t)))}function vi(e,t){return e.pipe(Ut(`${Wn}`),ht((e=>Array.isArray(t)?t.indexOf(e.payload.type)>-1:e.payload.type===t)))}function yi(e,t){return e.pipe(Ut(`${$n}`),ht((()=>{const{media:{assetsPath:e,mediaConstraints:n}}=t.value;return void 0!==e&&void 0!==n})),_t((()=>{const{media:{isMediaAgentInitialized:n}}=t.value;return n?Me([0]):e.pipe(Ut(`${ai}`),ht((e=>!!e.payload)),gt(1))})))}const Si="3.7.5",bi=Si,Ei="function"==typeof atob,wi="function"==typeof btoa,_i="function"==typeof Buffer,Ii="function"==typeof TextDecoder?new TextDecoder:void 0,Ci="function"==typeof TextEncoder?new TextEncoder:void 0,Ai=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Ti=(e=>{let t={};return Ai.forEach(((e,n)=>t[e]=n)),t})(),Ri=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Oi=String.fromCharCode.bind(String),Pi="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Di=e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")),ki=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),xi=e=>{let t,n,i,r,o="";const s=e.length%3;for(let s=0;s<e.length;){if((n=e.charCodeAt(s++))>255||(i=e.charCodeAt(s++))>255||(r=e.charCodeAt(s++))>255)throw new TypeError("invalid character found");t=n<<16|i<<8|r,o+=Ai[t>>18&63]+Ai[t>>12&63]+Ai[t>>6&63]+Ai[63&t]}return s?o.slice(0,s-3)+"===".substring(s):o},Ni=wi?e=>btoa(e):_i?e=>Buffer.from(e,"binary").toString("base64"):xi,Mi=_i?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let n=0,i=e.length;n<i;n+=4096)t.push(Oi.apply(null,e.subarray(n,n+4096)));return Ni(t.join(""))},Fi=(e,t=!1)=>t?Di(Mi(e)):Mi(e),Li=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?Oi(192|t>>>6)+Oi(128|63&t):Oi(224|t>>>12&15)+Oi(128|t>>>6&63)+Oi(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return Oi(240|t>>>18&7)+Oi(128|t>>>12&63)+Oi(128|t>>>6&63)+Oi(128|63&t)},Vi=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,ji=e=>e.replace(Vi,Li),Bi=_i?e=>Buffer.from(e,"utf8").toString("base64"):Ci?e=>Mi(Ci.encode(e)):e=>Ni(ji(e)),Ui=(e,t=!1)=>t?Di(Bi(e)):Bi(e),Hi=e=>Ui(e,!0),qi=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Ki=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return Oi(55296+(t>>>10))+Oi(56320+(1023&t));case 3:return Oi((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Oi((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},$i=e=>e.replace(qi,Ki),Wi=e=>{if(e=e.replace(/\s+/g,""),!Ri.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,i,r="";for(let o=0;o<e.length;)t=Ti[e.charAt(o++)]<<18|Ti[e.charAt(o++)]<<12|(n=Ti[e.charAt(o++)])<<6|(i=Ti[e.charAt(o++)]),r+=64===n?Oi(t>>16&255):64===i?Oi(t>>16&255,t>>8&255):Oi(t>>16&255,t>>8&255,255&t);return r},Gi=Ei?e=>atob(ki(e)):_i?e=>Buffer.from(e,"base64").toString("binary"):Wi,zi=_i?e=>Pi(Buffer.from(e,"base64")):e=>Pi(Gi(e).split("").map((e=>e.charCodeAt(0)))),Ji=e=>zi(Yi(e)),Qi=_i?e=>Buffer.from(e,"base64").toString("utf8"):Ii?e=>Ii.decode(zi(e)):e=>$i(Gi(e)),Yi=e=>ki(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),Zi=e=>Qi(Yi(e)),Xi=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),er=function(){const e=(e,t)=>Object.defineProperty(String.prototype,e,Xi(t));e("fromBase64",(function(){return Zi(this)})),e("toBase64",(function(e){return Ui(this,e)})),e("toBase64URI",(function(){return Ui(this,!0)})),e("toBase64URL",(function(){return Ui(this,!0)})),e("toUint8Array",(function(){return Ji(this)}))},tr=function(){const e=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,Xi(t));e("toBase64",(function(e){return Fi(this,e)})),e("toBase64URI",(function(){return Fi(this,!0)})),e("toBase64URL",(function(){return Fi(this,!0)}))},nr={version:Si,VERSION:bi,atob:Gi,atobPolyfill:Wi,btoa:Ni,btoaPolyfill:xi,fromBase64:Zi,toBase64:Ui,encode:Ui,encodeURI:Hi,encodeURL:Hi,utob:ji,btou:$i,decode:Zi,isValid:e=>{if("string"!=typeof e)return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:Fi,toUint8Array:Ji,extendString:er,extendUint8Array:tr,extendBuiltins:()=>{er(),tr()}};function ir(e){return nr.encode(e,!0)}function rr(e){return nr.decode(e)}function or(e){return nr.encode(e,!1)}const sr={"-":"+",_:"/",".":"="};function ar(e){const t=e.replace(/[-_.]/g,(e=>sr[e]));return Uint8Array.from(window.atob(t),(e=>e.charCodeAt(0)))}const ur=e=>{const t=e.charCodeAt(0);return t<=parseInt("0x7F",16)?1:t<=parseInt("0x7FF",16)?2:t<=parseInt("0xFFFF",16)?3:t<=parseInt("0x1FFFFF",16)?4:t<=parseInt("0x3FFFFFF",16)?5:6},lr=(e,t)=>{const n=e.split(".").map((e=>Number(e))).slice(0,3),i=t.split(".").map((e=>Number(e))).slice(0,3);let r=0;for(let e=0;e<3;e++){const t=e<n.length?n[e]:0,o=e<i.length?i[e]:0;if(t<o){r=-1;break}if(t>o){r=1;break}}return r},cr=e=>{var t;let n=(new Date).getTime(),i=1e3*(null===(t=performance)||void 0===t?void 0:t.now())||0;const r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{let t=16*Math.random();return n>0?(t=(n+t)%16|0,n=Math.floor(n/16)):(t=(i+t)%16|0,i=Math.floor(i/16)),("x"===e?t:3&t|8).toString(16)}));return"string"==typeof e||"number"==typeof e?r+":"+e:r+""};function dr(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=Object.keys(e),i=Object.keys(t),r=n.length;if(i.length!==r)return!1;for(let i=0;i<r;i++){const r=n[i];if(e[r]!==t[r]||!Object.prototype.hasOwnProperty.call(t,r))return!1}return!0}const hr=(e,t)=>e>>10==t>>10,pr=(e,t)=>new Promise((n=>{setTimeout((()=>{n(e())}),t)})),fr=e=>{const t=`${Math.floor(1e4*Math.random())}`;return e.indexOf("@")>-1?e.replace("@",t):`${e}${t}`},gr=e=>{try{const t=new URL(e);return!("data:"===t.protocol&&"null"===t.origin)&&t.origin!==location.origin}catch(e){return!0}},mr=e=>{const t=e.split(".")[1];if("string"==typeof t){let n=t.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw new Error("base64 string is not of the correct length")}try{const e=decodeURIComponent(window.atob(n).replace(/(.)/g,(function(e,t){let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})));return JSON.parse(e)}catch(e){console.error("Invalid token specified: invalid base64")}}};function vr(e){return e&&e.endsWith("/")?e.slice(0,e.length-1):e}function yr(e){return[...new Uint8Array(e)].map((e=>e.toString(16).padStart(2,"0"))).join("")}function Sr(e){return`${e.tagName}${e.id?`#${e.id}`:""}${e.className?`${e.className.split(" ").map((e=>`.${e}`)).join("")}`:""}`}function br(e){const t=function(e){const t=e&&e.getRootNode();if(t&&"#document"!==t.nodeName&&t.host)return Sr(t.host)}(e);return`${t?`${t}>`:""}${Sr(e)}`}function Er(e){return"object"==typeof e&&null!==e?e instanceof HTMLElement?br(e):ArrayBuffer.isView(e)?yr(e.buffer):Array.isArray(e)?e.map((e=>Er(e))):Object.keys(e).reduce(((t,n)=>({...t,[`${n}`]:Er(e[n])})),{}):e}let wr=function(e){return e[e.Success=0]="Success",e[e.MeetingIsOver=6]="MeetingIsOver",e[e.UserFull=9]="UserFull",e[e.MeetingLocked=9]="MeetingLocked",e[e.WebinarBlockedEmail=3033]="WebinarBlockedEmail",e[e.MeetingNotStarted=3008]="MeetingNotStarted",e[e.MeetingHasClosed=103003]="MeetingHasClosed",e[e.UserHasBeenRemoved=103039]="UserHasBeenRemoved",e[e.MMRIBReject=103043]="MMRIBReject",e[e.MMRConfParticipantExists=103044]="MMRConfParticipantExists",e}({}),_r=function(e){return e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Userrequest=2]="Userrequest",e[e.SdkConnection=3]="SdkConnection",e[e.Reconnect=5]="Reconnect",e[e.PtRequest=6]="PtRequest",e[e.KickedByHost=7]="KickedByHost",e[e.EndByHost=8]="EndByHost",e[e.EndByHostStartAnotherMeeting=9]="EndByHostStartAnotherMeeting",e[e.FreeMeetingTimeout=10]="FreeMeetingTimeout",e[e.JBHTimeout=11]="JBHTimeout",e[e.EndBySingleStatus=12]="EndBySingleStatus",e[e.WebinarNeedRegister=13]="WebinarNeedRegister",e[e.ArchiveFail=14]="ArchiveFail",e[e.EndByNone=15]="EndByNone",e[e.EndByAdmin=16]="EndByAdmin",e[e.DuplicateSession=17]="DuplicateSession",e[e.MeetingTransfer=18]="MeetingTransfer",e}({}),Ir=function(e){return e[e.WaitingRoomFailover=1]="WaitingRoomFailover",e[e.WebEndAndRejoin=2]="WebEndAndRejoin",e}({}),Cr=function(e){return e[e.Success=0]="Success",e[e.CommonError=200]="CommonError",e[e.WrongPasscode=3004]="WrongPasscode",e[e.RoleTypeMissing=3010]="RoleTypeMissing",e[e.InvalidParameter=4003]="InvalidParameter",e}({}),Ar=function(e){return e[e.Success=0]="Success",e[e.AnotherMeetingInProgress=3e3]="AnotherMeetingInProgress",e[e.MeetingNotExist=3001]="MeetingNotExist",e[e.NotHost=3003]="NotHost",e[e.WrongPasscode=3004]="WrongPasscode",e[e.MissingEmail=3005]="MissingEmail",e[e.MeetingNotStarted=3008]="MeetingNotStarted",e[e.UserHasBeenRemoved=3009]="UserHasBeenRemoved",e[e.RoleTypeMissing=3010]="RoleTypeMissing",e[e.WebinarEnforceLogin=3034]="WebinarEnforceLogin",e[e.RealNameMissing=3082]="RealNameMissing",e[e.RegisterRequired=3099]="RegisterRequired",e[e.SsoLoginWindow=6024]="SsoLoginWindow",e[e.ZoomLoginWindow=3051]="ZoomLoginWindow",e[e.ZoomSpecificLoginWindow=3052]="ZoomSpecificLoginWindow",e[e.LoginRequired=3100]="LoginRequired",e[e.Reconnecting=4e3]="Reconnecting",e[e.Disconnect=4001]="Disconnect",e[e.InvalidParameter=4003]="InvalidParameter",e[e.DeniedRegisterWithPanelist=3032]="DeniedRegisterWithPanelist",e[e.ServiceOffline=403]="ServiceOffline",e[e.RwcEmpty=3621]="RwcEmpty",e[e.RwcError=3622]="RwcError",e[e.FrequentCall=3633]="FrequentCall",e[e.FrequentJoin=3634]="FrequentJoin",e[e.WasmFail=3635]="WasmFail",e[e.CommonError=200]="CommonError",e[e.Upgrade=1e4]="Upgrade",e}({});Ar.Success,Ar.RegisterRequired,Ar.LoginRequired,Ar.SsoLoginWindow,Ar.ZoomLoginWindow,Ar.ZoomSpecificLoginWindow,Ar.MissingEmail,Ar.MeetingNotExist,Ar.NotHost,Ar.WrongPasscode,Ar.RoleTypeMissing,Ar.AnotherMeetingInProgress,Ar.MeetingNotStarted,Ar.InvalidParameter,Ar.Reconnecting,Ar.UserHasBeenRemoved,Ar.WebinarEnforceLogin,Ar.Disconnect,Ar.DeniedRegisterWithPanelist,Ar.RwcEmpty,Ar.RwcError,Ar.FrequentCall,Ar.FrequentJoin,Ar.WasmFail,Ar.Upgrade;const Tr={3004:{"apac.errorcodes_pac_mn_wrong":3714},3005:{"apac.errorcodes_web_has_in_progress":3e3},3008:{"apac.errorcodes_not_start":3008},3027:{"apac.errorcodes_host_email_as_attendee":3627},3033:{"apac.errorcodes_denied_email":3620},1005:{"apac.errorcodes_no_response_from_web":3621},131005:{"apac.errorcodes_no_response_from_web":3621},1001:{"apac.errorcodes_host_inactive":3625},131001:{"apac.errorcodes_host_inactive":3625},131013:{"meeting ended":4004},103039:{"apac.errorcodes_be_removed":3009},6:{"meeting ended":4004},9:{"meeting is at capacity":4005},12:{"meeting locked":4006},103043:{"reject for information barriers":4007},103044:{"participant exist":4008}};function Rr(e,t){let n={code:200,i18nKey:"apac.errorcodes_fail"};if(void 0!==Tr[e]){const t=Tr[e],i=Object.keys(t)[0];return n={code:t[i],i18nKey:i},{reason:i.startsWith("apac")?"":i,errorCode:n.code}}return{code:200,reason:"connection error"}}const Or=["bLock","bHoldUponEntry","viewOnly","listenOnlyPhone","bAllowRaiseHand","bAllowAttendeeRename","bBroadcast","bAllowPlayChimeForEnterOrExit","bIbDisableShare","bIbDisableChat","encryptKey","bNoHostTimeOut","bAllowShowCount","bHasAST","bHasRMC","gatewayKey","encryptKey"],Pr={bChime:"bAllowPlayChimeForEnterOrExit",bHasAST:"hasAst",bHasRMC:"hasRmc",topic:e=>({meetingTopic:rr(e)}),gatewayKey:e=>{const[,t,n]=e.split(".");return t&&n?{gatewayUser:{userId:Number(t),sn:n}}:{}},encryptKey:e=>({gcmSessinKey:ar(e)})},Dr=rn("GET_MEETING_INFO"),kr=rn("GET_INSTANT_MEETING_INFO");rn("LOGON_ZOOM_DOMAIN"),rn("VERIFY_ZOOM_RECAPTCHA"),rn("LOGON_THIRD_PARTY_DOMAIN");const xr=rn("PING_RWC_SERVER"),Nr=rn("MEETING_FAILOVER"),Mr=rn("LEAVE_MEETING"),Fr=rn("LEAVE_WAITING_ROOM"),Lr=rn("END_MEETING");rn("REGISTER_WEBINAR");const Vr=rn("TRIGGER_IDLE_CHECK"),{setMeetingInfo:jr,setMeetingJoinInfo:Br,setWindownOpen:Ur,setAppidSignature:Hr,setZtk:qr,setZsk:Kr,setTkMtkguid:$r,setPingRwcTimestamp:Wr,setInMeetingInfo:Gr,setMeetingAttribute:zr,resetMeeting:Jr,setIsHost:Qr,setIsCohost:Yr,setMeetingIsOnHold:Zr,setIsMeetingReset:Xr,setAudioVideoBeforeOnHold:eo,setCurrentUserAudioBeforeReset:to,setIsCurrentUserMutedBeforeReset:no,setMeetingStatus:io,setMeetingRegion:ro,setIsCurrentUserStartVideoBeforeReset:oo,setJoinMeetingTimeStamp:so,setActiveAppInfo:ao,setMeetingIdleStartTime:uo,setSessionIdleTimeoutMinutes:lo,setIsAudioBridgeEnabled:co,addDiscardedRwcHost:ho,setSharePronounType:po,setIsStayAwakeDuringTheSession:fo,setMeetingJoinSuccessTimestamp:go,resetFailoverRecord:mo,setFailoverReason:vo,setIsQuicklyLeaveMeetingAfterRefresh:yo,setMeetingInfoTimestamp:So,setIsEnableZmkFromRwg:bo}=_n({SET_MEETING_INFO:e=>e,SET_MEETING_JOIN_INFO:e=>e,SET_WINDOWN_OPEN:e=>e,SET_APPID_SIGNATURE:e=>e,SET_ZTK:e=>e,SET_ZSK:e=>e,SET_TK_MTKGUID:e=>e,SET_PING_RWC_TIMESTAMP:e=>e,SET_IN_MEETING_INFO:e=>e,SET_MEETING_ATTRIBUTE:e=>{if(Or.some((t=>e&&void 0!==e[t]))){let t=e;return Object.keys(Pr).some((t=>void 0!==e[t]))&&(t=Object.keys(e).reduce(((t,n)=>{const i=Pr[n];return"function"==typeof i?Object.assign(t,i(e[n])):"string"==typeof i?t[i]=e[n]:(t[n],e[n]),t}),{})),t}return{}},SET_IS_HOST:e=>e&&e.bHost,SET_IS_COHOST:e=>e&&e.bCoHost,RESET_MEETING:e=>e,SET_MEETING_IS_ON_HOLD:e=>e,SET_IS_MEETING_RESET:e=>e,SET_AUDIO_VIDEO_BEFORE_ON_HOLD:e=>e,SET_CURRENT_USER_AUDIO_BEFORE_RESET:e=>e,SET_IS_CURRENT_USER_MUTED_BEFORE_RESET:e=>e,SET_MEETING_STATUS:e=>e,SET_MEETING_REGION:e=>e,SET_IS_CURRENT_USER_START_VIDEO_BEFORE_RESET:e=>e,SET_JOIN_MEETING_TIME_STAMP:e=>e,SET_ACTIVE_APP_INFO:e=>e,SET_MEETING_IDLE_START_TIME:e=>e,SET_SESSION_IDLE_TIMEOUT_MINUTES:e=>e,SET_IS_AUDIO_BRIDGE_ENABLED:e=>e,ADD_DISCARDED_RWC_HOST:e=>e,SET_SHARE_PRONOUN_TYPE:e=>e,SET_IS_STAY_AWAKE_DURING_THE_SESSION:e=>e,SET_MEETING_JOIN_SUCCESS_TIMESTAMP:e=>e,RESET_FAILOVER_RECORD:e=>e,SET_FAILOVER_REASON:e=>e,SET_IS_QUICKLY_LEAVE_MEETING_AFTER_REFRESH:e=>e,SET_MEETING_INFO_TIMESTAMP:e=>e,SET_IS_ENABLE_ZMK_FROM_RWG:e=>e});let Eo=function(e){return e.Failover="failover",e.OnHold="on hold",e.Promote="promote",e.Depromote="depromote",e.JoinBreakoutRoom="join breakout room",e.MoveToBreakoutRoom="move to breakout room",e.BackToMainSession="back to main session",e}({});const wo="js_media.min.js";let _o=function(e){return e.CDN="CDN",e.Global="Global",e.CN="CN",e}({}),Io=function(e){return e.Connected="Connected",e.Reconnecting="Reconnecting",e.Closed="Closed",e.Fail="Fail",e}({}),Co=function(e){return e.Initial="initial",e.Joined="joined",e.Closed="closed",e}({}),Ao=function(e){return e.AudioBridgeEnable="M:1,2;V:1,2",e.AudioDecodeInWorklet="M:6;V:3",e.VideoFullHD="M:8;V:4",e.VideoShareFullHD="M:9;V:5",e.WebGL2Render="M:20;V:8",e.WebGPURender="M:21;V:9",e.ZMKFromRWG="M:19;V:10",e}({}),To=function(e){return e[e.NormalCase=-1]="NormalCase",e[e.NoHeartbeat=0]="NoHeartbeat",e[e.NoHeartbeatMChannel=1]="NoHeartbeatMChannel",e[e.NetworkChange=2]="NetworkChange",e[e.NotifyUiFailover=3]="NotifyUiFailover",e[e.InvalidParameters=4]="InvalidParameters",e[e.OnError=5]="OnError",e[e.OnErrorMChannel=6]="OnErrorMChannel",e[e.Disconnect=7]="Disconnect",e[e.DisconnectMChannel=8]="DisconnectMChannel",e[e.DisconnectXmpp=9]="DisconnectXmpp",e[e.RefreshPage=10]="RefreshPage",e}({});const Ro=["8-29","9-21"];let Oo=function(e){return e.LocalStorage="LocalStorage",e.SessionStorage="SessionStorage",e.Memory="Memory",e}({});const Po=ir("{}");class Do{constructor(e){this.sessionStorageKey=void 0,this.localStorageKey=void 0,this.sessionCache=void 0,this.localCache=void 0,this.memoryCache=void 0,this.sessionStorageKey=ir(`zoom-storage-${e}`),this.localStorageKey=ir("zoom-local-storage"),this.memoryCache={};try{this.sessionCache=JSON.parse(rr(sessionStorage.getItem(this.sessionStorageKey)||Po)),this.localCache=JSON.parse(rr(localStorage.getItem(this.localStorageKey)||Po))}catch(e){console.error(e),this.sessionCache={},this.localCache={}}}static init(e){this.instance=new Do(e)}static get(e){if(void 0===this.instance)throw new Error("read before initial");return this.instance.getValue(e).value}static set(e,t,n){if(void 0===this.instance)throw new Error("set before initial");return this.instance.setValue(e,t,n)}static remove(e){if(void 0===this.instance)throw new Error("remove before initial");return this.instance.removeValue(e)}static clearSession(){if(void 0===this.instance)throw new Error("clear before initial");return this.instance.memoryCache={},this.instance.sessionCache={},this.instance.localCache={},sessionStorage.removeItem(this.instance.sessionStorageKey)}getValue(e){return this.sessionCache.hasOwnProperty(e)?{value:this.sessionCache[e],type:Oo.SessionStorage}:this.localCache.hasOwnProperty(e)?{value:this.localCache[e],type:Oo.LocalStorage}:{value:this.memoryCache[e],type:Oo.Memory}}setValue(e,t,n){if(!e)throw new Error("key is null");switch(n){case Oo.SessionStorage:{const n=this.sessionCache[e];let i=t;return"function"==typeof t&&(i=t(n)),n!==i&&(this.sessionCache[e]=i,this.flushValue(Oo.SessionStorage)),i}case Oo.LocalStorage:{const n=this.localCache[e];let i=t;return"function"==typeof t&&(i=t(n)),n!==i&&(this.localCache[e]=i,this.flushValue(Oo.LocalStorage)),i}case Oo.Memory:{const n=this.memoryCache[e];let i=t;return"function"==typeof t&&(i=t(n)),this.memoryCache[e]=i,i}default:return null}}removeValue(e){const{type:t}=this.getValue(e);switch(t){case Oo.SessionStorage:delete this.sessionCache[e],this.flushValue(Oo.SessionStorage);break;case Oo.LocalStorage:delete this.localCache[e],this.flushValue(Oo.LocalStorage);break;case Oo.Memory:delete this.memoryCache[e]}}flushValue(e){e===Oo.SessionStorage?sessionStorage.setItem(this.sessionStorageKey,ir(JSON.stringify(this.sessionCache))):e===Oo.LocalStorage&&localStorage.setItem(this.localStorageKey,ir(JSON.stringify(this.localCache)))}}Do.instance=void 0;let ko=function(e){return e.WebclientOpt="WEB_CLIENT_OPT",e.WebclientWebinarToken="WEB_CLIENT_WEBINAR_TOKEN",e.WebclientMeetingToken="WEB_CLIENT_MEETING_TOKEN",e.WebclientZtk="WEB_CLIENT_ZTK",e.WebclientZsk="WEB_CLIENT_ZSK",e.WebclientTk="WEB_CLIENT_TK",e.WebclientIVState="WEB_CLIENT_IV_STATE",e.WebclientIsOnHold="WEB_CLIENT_IS_ON_HOLD",e.WebclientParticipantId="WEB_CLIENT_PARTICIPANT_ID",e.WebclientZoomId="WEB_CLIENT_ZOOM_ID",e.WebclientUserName="WEB_CLIENT_USER_NAME",e.WebclientUserEmail="WEB_CLIENT_USER_EMAIL",e.WebclientBreakoutRoomAttendeeStatus="WEB_CLIENT_BO_ATTENDEE_STATUS",e.WebclientBreakoutRoomCommand="WEB_CLIENT_BO_COMMAND",e.WebclientAudioEncryptKey="WEB_CLIENT_AUDIO_ENCRYPT_KEY",e.WebclientVideoEncryptKey="WEB_CLIENT_VIDEO_ENCRYPT_KEY",e.WebclientSharingEncryptKey="WEB_CLIENT_SHARING_ENCRYPT_KEY",e.WebclientFailoverCount="WEB_CLIENT_FAILOVER_COUNT",e.WebclientRecordingToken="WEB_CLIENT_RECORDING_TOKEN",e}({}),xo=function(e){return e.WebclientDeviceId="WEBCLIENT_DEVICE_ID",e.VSDKLogTrackingId="ZM_VSDK_LOG_TRACKING_IDS",e}({}),No=function(e){return e.EnforceWebRTCAudio="ENFORCE_WEB_RTC_AUDIO",e.DisableAutoReportLogs="DISABLE_AUTO_REPORT_LOGS",e}({});function Mo(e,t){const n=t.match(e);return n&&n.length>0&&n[1]||""}function Fo(e,t){const n=t.match(e);return n&&n.length>1&&n[2]||""}const Lo=/version\/(\d+(\.?_?\d+)+)/i,Vo=[{test:[/opera/i],describe:e=>["Opera(Legacy)",Mo(Lo,e)||Mo(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e)]},{test:[/opr\/|opios/i],describe:e=>["Opera",Mo(/(?:opr|opios)[\s/](\S+)/i,e)||Mo(Lo,e)]},{test:[/SamsungBrowser/i],describe:e=>["Samsung Internet for Android",Mo(Lo,e)||Mo(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e)]},{test:[/micromessenger/i],describe:e=>["WeChat",Mo(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||Mo(Lo,e)]},{test:[/qqbrowser/i],describe:e=>[/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser",Mo(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||Mo(Lo,e)]},{test:[/msie|trident/i],describe:e=>["Internet Explorer",Mo(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e)]},{test:[/\sedg\//i],describe:e=>["Microsoft Edge",Mo(/\sedg\/(\d+(\.?_?\d+)+)/i,e)]},{test:[/edg([ea]|ios)/i],describe:e=>["Microsoft Edge(Legacy)",Fo(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e)]},{test:[/firefox|iceweasel|fxios/i],describe:e=>["Firefox",Mo(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e)]},{test:[/electron/i],describe:e=>["Electron",Mo(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e)]},{test:[/chromium/i],describe:e=>["Chromium",Mo(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||Mo(Lo,e)]},{test:[/chrome|crios|crmo/i],describe:e=>["Chrome",Mo(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e)]},{test:e=>!/like android/i.test(e)&&/android/i.test(e),describe:e=>["Android Browser",Mo(Lo,e)]},{test:[/safari|applewebkit/i],describe:e=>["Safari",Mo(Lo,e)]}],jo=[{test:[/windows /i],describe:e=>["Windows",Mo(/Windows ((NT|XP)( \d\d?.\d)?)/i,e)]},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:e=>["iOS",Fo(/(Version\/)(\d[\d.]+)/,e)]},{test:[/macintosh/i],describe:e=>["macOS",Mo(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,".")]},{test:[/(ipod|iphone|ipad)/i],describe:e=>["iOS",Mo(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".")]},{test:e=>!/like android/i.test(e)&&/android/i.test(e),describe:e=>["Android",Mo(/android[\s/-](\d+(\.\d+)*)/i,e)]},{test:[/linux/i],describe:()=>["Linux"]},{test:[/CrOS/],describe:()=>["Chrome OS"]}];class Bo{constructor(){this.value=void 0,this.gpu=void 0}get isSupported(){if(void 0===this.value)if("function"==typeof window.OffscreenCanvas){const e=new OffscreenCanvas(1,1);e.addEventListener("webglcontextlost",(e=>{e.preventDefault()}));const t=e.getContext("webgl");if(this.value=!!t,t){const e=t.getExtension("WEBGL_debug_renderer_info");e&&(this.gpu=t.getParameter(e.UNMASKED_RENDERER_WEBGL))}}else this.value=!1;return this.value}}const Uo=new class{constructor(){this._browser=void 0,this._os=void 0,this._browserVersion=void 0,this._osVersion=void 0,this._offscreenCanvasCapality=void 0,this._clientHintsData=void 0,this._offscreenCanvasCapality=new Bo,"userAgentData"in navigator&&navigator.userAgentData.getHighEntropyValues(["architecture","bitness","formFactor","model","platformVersion","wow64"]).then((e=>{this._clientHintsData=e,this._os&&this._osVersion&&this._clientHintsData.platform&&this._clientHintsData.platformVersion&&(this._os=this._clientHintsData.platform,this._osVersion=this._clientHintsData.platformVersion)})).catch((e=>{console.warn(e)}))}_getBrowserVersion(){var e,t;if(null!==(e=this._clientHintsData)&&void 0!==e&&null!==(t=e.brands)&&void 0!==t&&t.length){const e=this._clientHintsData.brands.filter((e=>!/(Chromium|Not.*Brand)/i.test(e.brand)))[0];e&&(this._browser=e.brand);const t=this._clientHintsData.brands.find((e=>{var t;return"chromium"===(null===(t=e.brand)||void 0===t?void 0:t.toLowerCase())}));t?(this._browserVersion=t.version,this._browser||(this._browser=t.brand)):this._browserVersion=e.version}else{const e=navigator.userAgent,t=Vo.find((t=>"function"==typeof t.test?t.test(e):t.test.some((t=>t.test(e)))));if(t){const n=t.describe(e);this._browser=n[0],this._browserVersion=n[1],this.isIOSMobile&&(this._browser="ios-safari")}else this._browser="unknown",this._browserVersion="0"}}_getOSVersion(){var e,t;if(null!==(e=this._clientHintsData)&&void 0!==e&&e.platform&&null!==(t=this._clientHintsData)&&void 0!==t&&t.platformVersion)this._os=this._clientHintsData.platform,this._osVersion=this._clientHintsData.platformVersion;else{const e=navigator.userAgent,t=jo.find((t=>"function"==typeof t.test?t.test(e):t.test.some((t=>t.test(e)))));if(t){const n=t.describe(e);this._os=n[0],this._osVersion=n[1]}else this._os="unknown",this._osVersion="0"}}get browser(){return this._browser||this._getBrowserVersion(),this._browser}get browserVersion(){return this._browserVersion||this._getBrowserVersion(),this._browserVersion}get os(){return this._os||this._getOSVersion(),this._os}get osVersion(){return this._osVersion||this._getOSVersion(),this._osVersion}get isIE(){return"Internet Explorer"===this.browser}get isLegacyEdge(){return"Microsoft Edge(Legacy)"===this.browser}get isLegacyOpera(){return"Opera(Legacy)"===this.browser}get isFirefox(){return"Firefox"===this.browser}get isSafari(){return"Safari"===this.browser}get isChrome(){var e,t,n;if(null!==(e=this._clientHintsData)&&void 0!==e&&null!==(t=e.brands)&&void 0!==t&&t.length)return null===(n=this._clientHintsData)||void 0===n?void 0:n.brands.some((e=>{var t;return"chromium"===(null===(t=e.brand)||void 0===t?void 0:t.toLocaleLowerCase())}));const{userAgent:i}=navigator;return!this.isLegacyOpera&&!this.isLegacyEdge&&/chrome/i.test(i)&&/webkit/i.test(i)}get isLegacyChrome(){var e;return this.isChrome&&"function"!=typeof(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getDisplayMedia)}get isMacOS(){return"macOS"===this.os}get isIPad(){var e;return/iPad/i.test(navigator.userAgent)||this.isMacOS&&(null===(e=navigator)||void 0===e?void 0:e.maxTouchPoints)>2}get isIOSMobile(){return"iOS"===this.os||this.isIPad}get architecture(){var e,t;return null!==(e=null===(t=this._clientHintsData)||void 0===t?void 0:t.architecture)&&void 0!==e?e:""}get isArm(){return this.architecture?"arm"===this.architecture:/arm/i.test(navigator.userAgent)}get isChromeOS(){return"Chrome OS"===this.os}get isAndroidBrowser(){var e;return"android"===(null===(e=this.os)||void 0===e?void 0:e.toLowerCase())}get isArmChromeOS(){return this.isArm&&this.isChromeOS}get isAndroidOrIOSBrowser(){return this.isAndroidBrowser||this.isIOSMobile}get isSupportEssentialAudioAndVideoAbility(){return"object"==typeof WebAssembly&&"function"==typeof Worker}get isSupportAudioWorklet(){return"function"==typeof AudioWorklet}get isSupportImageCapture(){return"ImageCapture"in window}get isSupportMediaStreamTrackProcessor(){return"MediaStreamTrackProcessor"in window}get isSupportOffscreenCanvas(){return this._offscreenCanvasCapality.isSupported}get gpu(){return this._offscreenCanvasCapality.isSupported?this._offscreenCanvasCapality.gpu:""}get bitness(){var e,t;return null!==(e=null===(t=this._clientHintsData)||void 0===t?void 0:t.bitness)&&void 0!==e?e:""}get model(){var e,t;return null!==(e=null===(t=this._clientHintsData)||void 0===t?void 0:t.model)&&void 0!==e?e:""}get wow64(){var e;if("windows"===this.os.toLowerCase())return null===(e=this._clientHintsData)||void 0===e?void 0:e.wow64}get isSupportSendScreenSharing(){return"getDisplayMedia"in navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getDisplayMedia}};function Ho(){return Uo.isAndroidOrIOSBrowser||!!Do.get(No.EnforceWebRTCAudio)}const qo=()=>Uo.isIE,Ko=()=>{var e;return Uo.isSupportOffscreenCanvas&&(null===(e=navigator)||void 0===e?void 0:e.hardwareConcurrency)>=4&&"function"==typeof requestAnimationFrame&&"function"==typeof SharedArrayBuffer},$o=(e,t)=>{var n;const{isSafari:i,isIOSMobile:r,isSupportMediaStreamTrackProcessor:o,isAndroidOrIOSBrowser:s,isArmChromeOS:a,isChromeOS:u,isArm:l,isSupportOffscreenCanvas:c,isIPad:d}=Uo;if(!Ko()){const n=i||r,s="function"!=typeof window.SharedArrayBuffer&&(!!n||o&&c);return e&&s?t?25:4:1}return s?t?25:d?9:4:a||u&&!l?navigator.hardwareConcurrency>=4?9:4:(null===(n=navigator)||void 0===n?void 0:n.hardwareConcurrency)<4?9:25};function Wo(){var e;return"webkit"in window&&!("chrome"in window)&&!(null===(e=window.webkit.messageHandlers)||void 0===e||!e.jsOCHelper)}function Go(){var e;const{isAndroidBrowser:t,isIOSMobile:n,osVersion:i,browserVersion:r,isChrome:o,isFirefox:s,isSafari:a}=Uo;var u,l;if(n)return Number(null===(u=i.match(/^\d+/))||void 0===u?void 0:u[0])>=15;if(t)return Number(null===(l=i.match(/^\d+/))||void 0===l?void 0:l[0])>=10;const c=Number(null===(e=r.match(/^\d+/))||void 0===e?void 0:e[0]);return!!(o&&c>=69)||!!(a&&c>14)||!!(s&&c>=76)}let zo=function(e){return e.VIDEO_ENCODE="0",e.VIDEO_DECODE="1",e.AUDIO_ENCODE="2",e.AUDIO_DECODE="3",e.SHARING_ENCODE="4",e.SHARING_DECODE="5",e}({}),Jo=function(e){return e[e.NONE=0]="NONE",e[e.AES_256=1]="AES_256",e[e.AES_GCM=2]="AES_GCM",e}({});const Qo=Object.freeze({RWG_CHAT:{gcmType:1,sessionType:"RWG_CHAT"},XMPP_CHAT:{gcmType:1,sessionType:"XMPP_CHAT"},CC_MESSAGE:{gcmType:3,sessionType:"CC_MESSAGE"},BO_BROADCAST:{gcmType:1,sessionType:"BO_BROADCAST"},CHAT_FILE:{gcmType:2,sessionType:"CHAT_FILE"},CHAT_FILE_INFO:{gcmType:1,sessionType:"CHAT_FILE_INFO"}}),Yo=(window.crypto||window.msCrypto).subtle,Zo=ko.WebclientIVState,Xo=Object.keys(Qo).map((e=>Qo[e].sessionType));class es{constructor(e,t,n){this.isGCMEnabled=void 0,this.gcmSessionKey=void 0,this.gcmMainSessionKey=void 0,this.zoomId=void 0,this.resetParameters(e,t,n),Do.set(Zo,{},Oo.SessionStorage)}static init(e,t,n){this.instance?this.instance.resetParameters(e,t,n):this.instance=new es(e,t,n)}static destroy(){this.instance&&(this.instance=void 0)}resetParameters(e,t,n){this.isGCMEnabled=!(Uo.isIE||!Uo.isSupportEssentialAudioAndVideoAbility)&&n===Jo.AES_GCM,this.gcmSessionKey=ar(t),this.gcmMainSessionKey||(this.gcmMainSessionKey=this.gcmSessionKey),this.zoomId=String(e)}beginCrypto(e,t,n){const i=new Uint32Array(1);i[0]=9,i[0]+=Number(n);const r=new Uint8Array(i.buffer);let o=new Uint8Array(132);const s=ar(t);return o.set(s,0),o.set(r,s.length),o=o.subarray(0,s.length+4),Yo.importKey("raw",e,{name:"HMAC",hash:"SHA-256"},!0,["sign"]).then((e=>Yo.sign({name:"HMAC"},e,o))).then((e=>Yo.importKey("raw",e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])))}getNextIV(e){const t=Do.get(Zo);return void 0===t[e]?(t[e]=0,Do.set(Zo,t,Oo.SessionStorage)):Do.set(Zo,(t=>({...t,[e]:t[e]+1})),Oo.SessionStorage)}resetIVState(){const e=Do.get(Zo);if(void 0===e);else{const t=Object.keys(e).filter((e=>Xo.indexOf(e)>-1));t.length>0&&(t.forEach((t=>{e[t]+=1e6})),Do.set(Zo,e,Oo.SessionStorage))}}static resetIV(){if(void 0===this.instance)throw new Error("reset before intialize");this.instance.resetIVState()}static beginEncrypt(e){let{text:t,type:n}=e;const i=new Uint8Array(0);if(this.instance&&this.instance.isGCMEnabled){const e=16,r=12,o=this.instance.getNextIV(n.sessionType),s=new ArrayBuffer(r),a=new Uint8Array(s);new DataView(s).setUint32(0,o,!0);let u=null;return u="BO_BROADCAST"===n.sessionType||"XMPP_CHAT"===n.sessionType?this.instance.gcmMainSessionKey:this.instance.gcmSessionKey,this.instance.beginCrypto(u,this.instance.zoomId,n.gcmType).then((n=>{const r=ArrayBuffer.isView(t)?t:(new TextEncoder).encode(t);return Yo.encrypt({name:"AES-GCM",iv:a,additionalData:i,tagLength:8*e},n,r)})).then((t=>{const r=1+a.byteLength+2+i.byteLength+4+t.byteLength,o=new ArrayBuffer(r);if(new Uint8Array(o)[0]=a.length,new Uint8Array(o,1,a.byteLength).set(a),new DataView(o).setUint16(1+a.byteLength,i.length,!0),new Uint8Array(o,3+a.byteLength).set(i),new DataView(o).setUint32(1+a.byteLength+2+i.byteLength,t.byteLength-e,!0),new Uint8Array(o,1+a.byteLength+2+i.byteLength+4).set(new Uint8Array(t)),n.sessionType===Qo.CHAT_FILE.sessionType)return o;const s=new Uint8Array(o).reduce(((e,t)=>e+String.fromCharCode(t)),"");return window.btoa(s).replace(/_/g,"/").replace(/-/g,"+").replace(/\=/g,"")}))}return Promise.resolve(ArrayBuffer.isView(t)?t:ir(t))}static beginDecrypt(e){let{decryptedText:t,type:n,zoomId:i}=e;if(this.instance&&this.instance.isGCMEnabled){const e=ArrayBuffer.isView(t)||t instanceof ArrayBuffer?new Uint8Array(t):function(e){let t;const n=e.length,i=new Array(n);for(t=0;t<n;++t)i[t]=255&e.charCodeAt(t);return new Uint8Array(i)}(atob(t.replace(/_/g,"/").replace(/-/g,"+"))),r=e[0],o=e.slice(1,r+1),s=e.slice(1+r,3+r),a=new DataView(s.buffer).getUint16(0,!0),u=e.slice(1+r+2,1+r+2+a),l=e.slice(1+r+2+a,1+r+2+a+4),c=new DataView(l.buffer).getUint32(0,!0),d=e.slice(1+r+2+a+4,1+r+2+a+4+c),h=e.slice(1+r+2+a+4+c);let p=null;return p="BO_BROADCAST"===n.sessionType||"XMPP_CHAT"===n.sessionType?this.instance.gcmMainSessionKey:this.instance.gcmSessionKey,this.instance.beginCrypto(p,i,n.gcmType).then((e=>{const t=function(e,t){e=new Uint8Array(e),t=new Uint8Array(t);const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(d,h);return Yo.decrypt({name:"AES-GCM",iv:o,additionalData:u,tagLength:8*h.length},e,t.buffer)})).then((e=>({message:n.sessionType===Qo.CHAT_FILE.sessionType?e:(new TextDecoder).decode(e),iv:o,aad:u}))).catch((e=>({message:"[This is an encrypted message]",iv:o,aad:u})))}{const e=new TextDecoder("utf-8");return Promise.resolve({message:ArrayBuffer.isView(t)||t instanceof ArrayBuffer?t:e.decode(ar(t))})}}}es.instance=void 0;const ts=20225,ns=20234,is=7937,rs=7938,os=12039,ss=16138,as=4098,us=4305,ls=4343,cs=16428;let ds=function(e){return e[e.NoAttendee=0]="NoAttendee",e[e.All=1]="All",e[e.AllPanelist=2]="AllPanelist",e[e.Host=3]="Host",e[e.NoOne=4]="NoOne",e[e.EveryonePublicly=5]="EveryonePublicly",e}({}),hs=function(e){return e[e.AllPanelist=1]="AllPanelist",e[e.Everyone=2]="Everyone",e[e.Invalid=0]="Invalid",e}({}),ps=function(e){return e[e.All=0]="All",e[e.Panelist=1]="Panelist",e[e.IndividualCcPanelist=2]="IndividualCcPanelist",e[e.Individual=3]="Individual",e[e.SilentModeUsers=4]="SilentModeUsers",e}({}),fs=function(e){return e[e.None=0]="None",e[e.Delete=1]="Delete",e[e.Modify=2]="Modify",e}({}),gs=function(e){return e[e.Success=0]="Success",e[e.Delete=1]="Delete",e[e.Block=3]="Block",e}({});const ms=[ds.All,ds.Host,ds.NoOne,ds.EveryonePublicly],vs=[ds.NoOne,ds.All,ds.AllPanelist],ys={AllPanelist:11,Everyone:12},Ss={[ys.AllPanelist]:hs.AllPanelist,[ys.Everyone]:hs.Everyone},bs={userId:ps.All,displayName:"Everyone",isHost:!1,isCoHost:!1},Es={userId:ps.Panelist,displayName:"All panelists"},ws={userId:ps.SilentModeUsers,displayName:"Everyone (in Waiting Room)",isHost:!1,isCoHost:!1};let _s=function(e){return e[e.Local=0]="Local",e[e.ThirdParty=1]="ThirdParty",e}({}),Is=function(e){return e[e.ChunkSize=20971520]="ChunkSize",e[e.EncodeBlockSize=32768]="EncodeBlockSize",e[e.DecodeBlockSize=32803]="DecodeBlockSize",e[e.MaxSize=2147483648]="MaxSize",e[e.ReaderChunkSize=1073741824]="ReaderChunkSize",e}({}),Cs=function(e){return e[e.Init=0]="Init",e[e.InProgress=1]="InProgress",e[e.Success=2]="Success",e[e.Fail=3]="Fail",e[e.Cancel=4]="Cancel",e[e.Complete=5]="Complete",e}({}),As=function(e){return e[e.InProgress=1]="InProgress",e[e.Success=2]="Success",e[e.Fail=3]="Fail",e[e.Cancel=4]="Cancel",e}({});const Ts={"7z":"application/x-7z-compressed",avi:"video/x-msvideo",bin:"application/octet-stream",bmp:"image/bmp",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",gif:"image/gif",gz:"application/gzip",html:"text/html",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",mid:"audio/midi",mov:"video/*",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/*",mpg:"video/*",pdf:"application/pdf",png:"image/png",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/wav",webp:"image/webp",wma:"audio/*",wmv:"video/*",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",zip:"application/zip"};let Rs=function(e){return e.Open="open",e.Message="message",e.Error="error",e.Close="close",e.Inactive="inactive",e}({});class Os{constructor(){this.eventHandlers=void 0,this.websocket=void 0,this.seq=void 0,this.intervalsToBeCleardWhenSocketClose=[],this.isAlive=!1,this.eventHandlers=new Map,this.websocket=null,this.seq=1}on(e,t){let n=this.eventHandlers.get(e);n||(n=[]),n.push(t),this.eventHandlers.set(e,n)}off(e,t){const n=this.eventHandlers.get(e);if(n){const i=n.filter((e=>e!==t));this.eventHandlers.set(e,i)}}emit(e,t){const n=this.eventHandlers.get(e);n&&n instanceof Array&&n.slice(0).forEach((e=>{try{e(t)}catch(e){console.error(e)}}))}sendMessageToRwg(e){this.seq+=1;const t=this.seq;return this.websocket&&this.websocket.readyState===WebSocket.OPEN&&this.websocket.send(JSON.stringify(Object.assign(e,{seq:t}))),t}connect(e){this.websocket=new WebSocket(e),this.websocket.binaryType="arraybuffer",this.addWebSocketEventListeners()}close(){var e;null===(e=this.websocket)||void 0===e||e.close()}addHeartBeat(){const e=Uo.isAndroidOrIOSBrowser?15e3:2e4,t=setInterval((()=>{this.isAlive||this.emit(Rs.Inactive,{}),this.sendMessageToRwg({evt:0}),this.isAlive=!1}),e);this.intervalsToBeCleardWhenSocketClose.push(t)}clearIntervals(){this.intervalsToBeCleardWhenSocketClose.forEach((e=>clearInterval(e))),this.isAlive=!1}addWebSocketEventListeners(){this.websocket&&(this.websocket.addEventListener("open",(e=>{this.addHeartBeat(),this.emit(Rs.Open,e)})),this.websocket.addEventListener("message",(e=>{this.isAlive=!0,this.emit(Rs.Message,e)})),this.websocket.addEventListener("close",(e=>{this.clearIntervals(),this.emit(Rs.Close,e)})),this.websocket.addEventListener("error",(e=>{this.clearIntervals(),this.emit(Rs.Error,e)})))}sendLaunchParams(e){return{seq:this.sendMessageToRwg({evt:4301,body:e})}}joinMeeting(e){return{seq:this.sendMessageToRwg({evt:4097,body:{meetingtoken:e}})}}lockMeeting(e){return{seq:this.sendMessageToRwg({evt:4099,body:{bLock:e}})}}endMeeting(){return{seq:this.sendMessageToRwg({evt:4101,body:{}})}}leaveMeeting(){const e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?4364:4103;return{seq:this.sendMessageToRwg({evt:e,body:{}})}}recordMeeting(e,t){return{seq:this.sendMessageToRwg({evt:4105,body:{bRecord:e,bPause:t}})}}localRecordingGrantPermission(e,t,n){return{seq:this.sendMessageToRwg({evt:ls,body:{cmdType:"permission_request_answer",userId:e,agreed:t,saveAgreed:n}})}}hostGrantPermission(e,t){return{seq:this.sendMessageToRwg({evt:ls,body:{cmdType:"grant_permission",userId:e,grant:t}})}}localRecordingRequestPermission(){return{seq:this.sendMessageToRwg({evt:ls,body:{cmdType:"request_permission"}})}}localRecordingMeeting(e){return{seq:this.sendMessageToRwg({evt:ls,body:{cmdType:"change_recording_status",status:e}})}}summaryMeeting(e){return{seq:this.sendMessageToRwg({evt:8009,body:{type:e?"start":"stop"}})}}startMeetingQuery(e){return{seq:this.sendMessageToRwg({evt:8017,body:{type:e?"start":"stop"}})}}allowSelfRecord(e){return{seq:this.sendMessageToRwg({evt:4325,body:{bAllowISORecord:e}})}}enableZoomIQRecord(e){return{seq:this.sendMessageToRwg({evt:4318,body:{check:e}})}}expel(e){return{seq:this.sendMessageToRwg({evt:4107,body:{id:e}})}}expelAttendee(e){return{seq:this.sendMessageToRwg({evt:4205,body:{jid:e}})}}rename(e,t,n){return{seq:this.sendMessageToRwg({evt:4109,body:{id:e,dn2:t,olddn2:n}})}}assignHost(e,t){return{seq:this.sendMessageToRwg({evt:4111,body:{id:e,bCoHost:t}})}}reclaimHost(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{seq:this.sendMessageToRwg({evt:4133,body:{id:e,bCoHost:t}})}}revokeCoHost(e){return{seq:this.sendMessageToRwg({evt:4195,body:{id:e}})}}putOnHold(e,t){return{seq:this.sendMessageToRwg({evt:4113,body:{id:e,bHold:t}})}}setMuteOnEntry(e){return{seq:this.sendMessageToRwg({evt:4115,body:{bOn:e}})}}setHoldOnEntry(e){return{seq:this.sendMessageToRwg({evt:4117,body:{bOn:e}})}}inviteCRCDevice(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return{seq:this.sendMessageToRwg({evt:4119,body:{ip:e,type:t,encrypt:n}})}}cancelInviteCRCDevice(e){return{seq:this.sendMessageToRwg({evt:4121,body:{transID:e}})}}sendCloseCaption(e){return{seq:this.sendMessageToRwg({evt:4125,body:{...e}})}}allowViewParticipantNumber(e){return{seq:this.sendMessageToRwg({evt:4127,body:{bOn:e}})}}lowerAllHands(){return{seq:this.sendMessageToRwg({evt:4129,body:{}})}}raiseLowerHand(e,t){return{seq:this.sendMessageToRwg({evt:4131,body:{id:e,bOn:t}})}}chat(e,t,n,i){const r={text:e,destNodeID:t};return n&&Object.assign(r,{sn:n}),i&&Object.assign(r,{attendeeNodeID:i}),{seq:this.sendMessageToRwg({evt:4135,body:r})}}assignCC(e,t){return{seq:this.sendMessageToRwg({evt:4137,body:{id:e,bCCEditor:t}})}}enableLT(e){return{seq:this.sendMessageToRwg({evt:4227,body:{op:e?2:4}})}}enableNewLLT(){return{seq:this.sendMessageToRwg({evt:4285})}}disableCaptions(e){return{seq:this.sendMessageToRwg({evt:us,body:{type:4,disableNewLtt:e}})}}enableManualCaption(e){return{seq:this.sendMessageToRwg({evt:4291,body:{op:e?1:0}})}}setTranslationLanguage(e){return void 0!==e?{seq:this.sendMessageToRwg({evt:us,body:{type:1,lang:e}})}:{seq:this.sendMessageToRwg({evt:us,body:{type:3}})}}setSpokenLanguage(e){return{seq:this.sendMessageToRwg({evt:4287,body:{lang:e}})}}allowAskLT(e){return{seq:this.sendMessageToRwg({evt:4263,body:{bAnonymous:e}})}}approveLT(){return{seq:this.sendMessageToRwg({evt:4262,body:{bApproved:!0}})}}askLT(e){return{seq:this.sendMessageToRwg({evt:4261,body:{bAnonymous:e}})}}setChatPriviledge(e){return{seq:this.sendMessageToRwg({evt:4141,body:{chatPriviledge:e}})}}setPanelistChatPrivilege(e){if(!Object.values(ys).includes(e))throw Error("Invalid panelist chat privilege req value");return{seq:this.sendMessageToRwg({evt:4141,body:{chatPriviledge:e}})}}sendFeedback(e){return{seq:this.sendMessageToRwg({evt:4143,body:{feedback:e}})}}clearFeedback(){return{seq:this.sendMessageToRwg({evt:4145,body:{}})}}allowUnmuteVideo(e){return{seq:this.sendMessageToRwg({evt:4147,body:{bOn:e}})}}allowUnmuteAudio(e){return{seq:this.sendMessageToRwg({evt:4149,body:{bOn:e}})}}allowRaiseHand(e){return{seq:this.sendMessageToRwg({evt:4151,body:{bOn:e}})}}boToken(e){return{seq:this.sendMessageToRwg({evt:4173,body:{topic:e}})}}startBO(e){return{seq:this.sendMessageToRwg({evt:4175,body:{proto:e}})}}stopBO(e){return{seq:this.sendMessageToRwg({evt:4177,body:{status:e}})}}assignToBO(e,t){return{seq:this.sendMessageToRwg({evt:4179,body:{targetID:e,targetBID:t}})}}switchBO(e,t){return{seq:this.sendMessageToRwg({evt:4181,body:{targetID:e,targetBID:t}})}}wantJoinBO(e,t){return{seq:this.sendMessageToRwg({evt:4183,body:{targetID:e,targetBID:t}})}}joinBO(e){return{seq:this.sendMessageToRwg({evt:4193,body:{targetBID:e}})}}leaveBO(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{seq:this.sendMessageToRwg({evt:4185,body:{reason:e}})}}broadcastBO(e){return{seq:this.sendMessageToRwg({evt:4187,body:{textContent:e}})}}askForHelpBO(e){return{seq:this.sendMessageToRwg({evt:4189,body:{targetID:e}})}}askForHelpResultBO(e,t){return{seq:this.sendMessageToRwg({evt:4191,body:{targetID:e,helpResult:t}})}}coHostStartBO(e,t){return{seq:this.sendMessageToRwg({evt:4241,body:{proto:e,targetID:t}})}}coHostStopBO(e,t){return{seq:this.sendMessageToRwg({evt:4243,body:{status:e,targetID:t}})}}coHostAssignToBO(e,t,n){return{seq:this.sendMessageToRwg({evt:4245,body:{userGUID:e,targetID:n,targetBID:t}})}}moveToMainSession(e){return{seq:this.sendMessageToRwg({evt:4247,body:{userGUID:e}})}}coHostMoveToMainSession(e,t){return{seq:this.sendMessageToRwg({evt:4249,body:{userGUID:e,targetID:t}})}}allowParticipantRename(e){return{seq:this.sendMessageToRwg({evt:4163,body:{bOn:e}})}}allowMessageFeedbackNotify(e,t){return{seq:this.sendMessageToRwg({evt:4171,body:{bOn:e,id:t}})}}setPlayChime(e,t){return{seq:this.sendMessageToRwg({evt:4197,body:{bOn:e,id:t}})}}admitAllSilentUsers(){return{seq:this.sendMessageToRwg({evt:4199,body:{}})}}bindTeleUser(e,t,n){return{seq:this.sendMessageToRwg({evt:4201,body:{teleUserID:e,targetUserID:t,bBind:n}})}}practiceSession(){return{seq:this.sendMessageToRwg({evt:4207,body:null})}}roleChangeWebinar(e,t,n,i){return{seq:this.sendMessageToRwg({evt:4209,body:{jid:t,userID:n,clientCap:i,bPromote:e}})}}sendPromoteConsent(e,t){return{seq:this.sendMessageToRwg({evt:4254,body:{agreed:e,req_id:t}})}}batchCreateBOToken(e){const t=e.map(((e,t)=>({topic:e,index:t})));return{seq:this.sendMessageToRwg({evt:4211,body:t})}}mute(e,t){return{seq:this.sendMessageToRwg({evt:8193,body:{bMute:t,id:e}})}}audioDrop(e){return{seq:this.sendMessageToRwg({evt:8195,body:{id:e}})}}audioDialout(e,t,n,i,r){return{seq:this.sendMessageToRwg({evt:8197,body:{pn:e,dn2:ir(t),bCallme:n,bPressOne:i,bGreeting:r}})}}audioCancelDialout(e,t){return{seq:this.sendMessageToRwg({evt:8199,body:{pn:e,bCallme:t}})}}audioMuteAll(e){return{seq:this.sendMessageToRwg({evt:8201,body:{bMute:e}})}}allowToTalk(e,t){return{seq:this.sendMessageToRwg({evt:8204,body:{id:e,bAllowTalk:t}})}}subscribeVideo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return{seq:this.sendMessageToRwg({evt:12289,body:{id:e,size:t,bOn:n}})}}unsubscribeVideo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{seq:this.sendMessageToRwg({evt:12291,body:{id:e}})}}muteAttendeeVideo(e,t){return{seq:this.sendMessageToRwg({evt:12297,body:{id:e,bOn:t}})}}notifyRwgIsMuteVideo(e,t){return this.muteAttendeeVideo(e,t)}pauseSharing(){return{seq:this.sendMessageToRwg({evt:16385,body:{}})}}resumeSharing(){return{seq:this.sendMessageToRwg({evt:16387,body:{}})}}allowAnonymousQuestion(e,t){return{seq:this.sendMessageToRwg({evt:4155,body:{userId:e,bOn:t}})}}allowViewAll(e,t){return{seq:this.sendMessageToRwg({evt:4157,body:{userId:e,bOn:t}})}}allowVote(e,t){return{seq:this.sendMessageToRwg({evt:4159,body:{userId:e,bOn:t}})}}allowComment(e,t){return{seq:this.sendMessageToRwg({evt:4161,body:{userId:e,bOn:t}})}}sharingRequestRemoteControl(e,t){return{seq:this.sendMessageToRwg({evt:16389,body:{id:e,bOn:t}})}}subscribeGrabRemoteControl(e,t){return{seq:this.sendMessageToRwg({evt:16393,body:{id:e,bOn:t}})}}subscribeSharing(e,t,n,i){const r={id:e,size:t};return n&&Object.assign(r,{bShareToBO:!0}),void 0!==i&&Object.assign(r,{bVideoShare:i}),{seq:this.sendMessageToRwg({evt:16415,body:r})}}unsubscribeSharing(e,t){const n={id:e};return t&&Object.assign(n,{bShareToBO:!0}),{seq:this.sendMessageToRwg({evt:16417,body:n})}}sendRWGConnectionPerformance(e){return{seq:this.sendMessageToRwg({evt:4167,body:{data:e}})}}sendSdkKeyToMonitor(e,t,n){return{seq:this.sendMessageToRwg({evt:4167,body:{data:`ZoomConferenceClient,videoapp_HTML5_sdk_web_join,${n},2,${t},${e}`}})}}sendDatachannelOffer(e){return{seq:this.sendMessageToRwg({evt:24321,offer:e})}}joinOrLeaveVoip(e){return{seq:this.sendMessageToRwg({evt:8203,body:{bOn:e}})}}startSharing(e,t){return{seq:this.sendMessageToRwg({evt:16409,body:{id:e,boOn:!1,...null!=t?t:{}}})}}stopSharing(e){return{seq:this.sendMessageToRwg({evt:16409,body:{id:e,bOn:!0}})}}lockSharing(e){return{seq:this.sendMessageToRwg({evt:4169,body:{lockShare:e}})}}startShareToBreakoutRoom(e){return{seq:this.sendMessageToRwg({evt:16425,body:{id:e,bShareToBO:!0}})}}stopShareToBreakoutRoom(e){return{seq:this.sendMessageToRwg({evt:16425,body:{id:e,bShareToBO:!1}})}}preAssignBreakoutRoom(){return{seq:this.sendMessageToRwg({evt:4213,body:{}})}}claimHost(e){return{seq:this.sendMessageToRwg({evt:4215,body:{hostKey:e}})}}allowMultiplePin(e,t){return{seq:this.sendMessageToRwg({evt:4217,body:{userID:e,bOn:t}})}}spotlightVideo(e,t){return{seq:this.sendMessageToRwg({evt:4219,body:{id:e,...t}})}}connectCamera(e,t){const n={evt:12307,body:{id:e,bOn:t}};return{seq:this.sendMessageToRwg(n)}}followHostLayout(e){return{seq:this.sendMessageToRwg({evt:4223,body:{bFollowHostVideo:e}})}}setVideoDragLayout(e){return{seq:this.sendMessageToRwg({evt:4218,body:{drag_list:e}})}}chatCmdReq(e,t){return{seq:this.sendMessageToRwg({evt:4237,body:{msgID:e,cmd:t}})}}activeAppLinkReq(e){return{seq:this.sendMessageToRwg({evt:4257,body:{appId:e}})}}activeAppInfoReq(){return{seq:this.sendMessageToRwg({evt:4255,body:{}})}}muteShareAudio(e,t){const n={bOn:!0,bShareAudio:!e};return t&&Object.assign(n,{bShareAudioOnly:!0}),{seq:this.sendMessageToRwg({evt:16423,body:n})}}localMuteAudio(e,t){return{seq:this.sendMessageToRwg({evt:8209,body:{id:e,bMute:t}})}}changeSharePronoun(e,t){return{seq:this.sendMessageToRwg({evt:4264,body:{bPronoun:e,strPronoun:t}})}}sendReceivingSharingReady(e){return{seq:this.sendMessageToRwg({evt:16421,body:{ssrc:e}})}}sendManualCaption(e){return{seq:this.sendMessageToRwg({evt:4289,body:{...e}})}}sendPollingAction(e,t,n){return{seq:this.sendMessageToRwg({evt:4224,body:{action:e,PollingId:t,...n}})}}broadcastUserNetworkQuality(e){const t={type:e.isUplink,level:e.level,bwLevel:e.bwLevel};return{seq:this.sendMessageToRwg({evt:4331,body:t})}}sendFarEndCameraControl(e,t,n){return{seq:this.sendMessageToRwg({evt:4329,body:{cmd:e,userID:t,buttonID:n}})}}sendCameraAblity(e){return{seq:this.sendMessageToRwg({evt:4330,body:{...e,focus:!1}})}}sendReaction(e){return{seq:this.sendMessageToRwg({evt:4259,body:{...e}})}}remoteControlConsent(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{deviceId:o,...s}=i;return{seq:this.sendMessageToRwg({evt:16427,body:{DeviceID:o,op:e,SendUserID:n,AssignUserID:t,...s,bAutoDelete:r}})}}takeBackRemoteControlPermission(e,t){return{seq:this.sendMessageToRwg({evt:16431,body:{SendUserID:e,ReceiverUserID:t}})}}syncSharedContentMetaWithRcApp(e){const{deviceId:t,...n}=e;return{seq:this.sendMessageToRwg({evt:16429,body:{DeviceID:t,...n}})}}startLiveStream(e,t,n){return{seq:this.sendMessageToRwg({evt:7977,body:{action:1,streamingURL:e,streamingKey:t,broadcastURL:n}})}}stopLiveStream(){return{seq:this.sendMessageToRwg({evt:7977,body:{action:0}})}}sendRemoteControlAuth(e){return{seq:this.sendMessageToRwg({evt:16433,body:{auth:e}})}}chatFileTransfer(e){return{seq:this.sendMessageToRwg({evt:4307,body:{...e,fileType:0,receiverType:0}})}}broadcastVoiceReq(e){return{seq:this.sendMessageToRwg({evt:4314,body:{broadcastVoice:e}})}}}class Ps extends Os{static createAgent(){return this.rwgInstance||(this.rwgInstance=new Ps),this.rwgInstance}}Ps.rwgInstance=null;class Ds extends Os{static getInstance(){return this.instance||(this.instance=new Ds),this.instance}}Ds.instance=null;const ks=[{name:"audio_simd.min.js",category:"audio",type:"worker",tag:"simd",alias:"audioSIMDWorkletPath"},{name:"audio.simd.wasm",category:"audio",type:"wasm",tag:"simd",alias:"audioSIMDWasm"},{name:"js_audio_process.min.js",category:"audio",type:"worker",tag:"",alias:"audioWorkerPath"},{name:"audio.encode.wasm",category:"audio",type:"wasm",tag:"",alias:"audioWasm"},{name:"js_audio_worklet.min.js",category:"audio",type:"worklet",tag:"",alias:"audioWorkletPath"},{name:"js_audio_worklet_simd.min.js",category:"audio",type:"worklet",tag:"simd",alias:"audioWorkletSIMDPath"},{name:"js_audio_worklet_process.min.js",category:"audio",type:"worklet",tag:"",alias:"audioWorkletProcessPath"},{name:"js_sharing_audio_worklet.min.js",category:"audio",type:"worklet",tag:"",alias:"sharingAudioWorkletPath"},{name:"js_audio_level_worklet_process.min.js",category:"audio",type:"worklet",tag:"",alias:"audioLevelWorkletPath"},{name:"video_mtsimd.min.js",category:"video",type:"worker",tag:"simd,thread",alias:"videoMSIMDWorkerPath"},{name:"video.mtsimd.wasm",category:"video",type:"wasm",tag:"simd,thread,videoShare",alias:"videoMSIMDWasm"},{name:"video_m.min.js",category:"video",type:"worker",tag:"thread",alias:"videoMtWorkerPath"},{name:"video.mt.wasm",category:"video",type:"wasm",tag:"thread",alias:"videoMtWasm"},{name:"video_simd.min.js",category:"video",type:"worker",tag:"simd",alias:"videoSIMDWorkerPath"},{name:"video.simd.wasm",category:"video",type:"wasm",tag:"simd",alias:"videoSIMDWasm"},{name:"video_s.min.js",category:"video",type:"worker",tag:"",alias:"videoWorkerPath"},{name:"video.decode.wasm",category:"video",type:"wasm",tag:"",alias:"videoWasm"},{name:"video_share_mtsimd.min.js",category:"video",type:"worker",tag:"videoShare",alias:"vsmiworkerpath"},{name:"sharing_mtsimd.min.js",category:"sharing",type:"worker",tag:"simd,thread",alias:"sharingMSIMDWorkerPath"},{name:"sharing_m.min.js",category:"sharing",type:"worker",tag:"thread",alias:"sharingMtWorkerPath"},{name:"sharing_simd.min.js",category:"sharing",type:"worker",tag:"simd",alias:"sharingSIMDWorkerPath"},{name:"sharing_s.min.js",category:"sharing",type:"worker",tag:"",alias:"sharingWorkerPath"}],xs="1506",Ns=(e,t)=>ks.reduce(((n,i)=>{const{name:r,alias:o}=i;return Object.assign(n,{[`${o}`]:`${e}/${t&&xs?`${xs}_`:""}${r}`}),n}),{});let Ms=function(e){return e.VideoEncode="0",e.VideoDecode="1",e.AudioEncode="2",e.AudioDecode="3",e.SharingEncode="4",e.SharingDecode="5",e}({});const Fs=ko.WebclientIVState;class Ls{static getInstance(){return void 0===this.agentInstance&&(this.agentInstance=new Ls),this.agentInstance}constructor(){this.assetsPath=void 0,this.instance=void 0,this.callbackList=void 0,this.mediaWorkersPath=void 0,this.constraints=void 0,this.svcUrl=void 0,this.meetingNumber=void 0,this.confId=void 0,this.mediaSocketAddress=void 0,this.currentUserId=void 0,this.receivedSharingCanvas=void 0,this.sharingCanvas=void 0,this.mediaOptions=void 0,this.inProgress=void 0,this.callbackList=[]}init(e){if(!this.instance&&window.JsMediaSDK_Instance){const t={ivObj:{[zo.AUDIO_ENCODE]:Do.get(Fs)&&Do.get(Fs)[zo.AUDIO_ENCODE],[zo.VIDEO_ENCODE]:Do.get(Fs)&&Do.get(Fs)[zo.VIDEO_ENCODE],[zo.SHARING_ENCODE]:Do.get(Fs)&&Do.get(Fs)[zo.SHARING_ENCODE]},globalTracingLogger:e};this.instance=new window.JsMediaSDK_Instance(t),this.instance.setRWGAgent(Ps.createAgent())}}setAssetsAndConstraint(e,t,n,i){var r;this.assetsPath=e,this.constraints=t,this.mediaWorkersPath=Ns(this.assetsPath,!!n),this.onMediaSDKCallback=this.onMediaSDKCallback.bind(this),this.mediaOptions=i,null===(r=this.instance)||void 0===r||r.JsMediaSDK_PreLoad(this.mediaWorkersPath,this.onMediaSDKCallback,i)}onMediaSDKCallback(e,t){this.callbackList.length>0&&this.callbackList.forEach((n=>n(e,t)))}registerCallback(e){this.callbackList.push(e)}unregisterCallback(e){this.callbackList=this.callbackList.filter((t=>t!==e))}static isSupportVideoEncodeHardwareAcceleration(){return window.JsMediaSDK_Instance.util.IsSupportVideoEncodeHardwareAcceleration()}static isSupportVideoDecodeHardwareAcceleration(){return window.JsMediaSDK_Instance.util.IsSupportVideoDecodeHardwareAcceleration()}static isCompatibleHardwareForEncode(){var e;return Uo.isSupportOffscreenCanvas&&0==(null===(e=window.JsMediaSDK_Instance)||void 0===e?void 0:e.util.AdapterWhiteListCheckForEncoder())}static getPTZCapability(){var e,t,n,i,r,o,s,a,u;return{pan:!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||null===(n=t.isSupportCameraPan)||void 0===n||!n.call(t)),tilt:!(null===(i=window.JsMediaSDK_Instance)||void 0===i||null===(r=i.util)||void 0===r||null===(o=r.isSupportCameraTilt)||void 0===o||!o.call(r)),zoom:!(null===(s=window.JsMediaSDK_Instance)||void 0===s||null===(a=s.util)||void 0===a||null===(u=a.isSupportCameraZoom)||void 0===u||!u.call(a))}}static isSupportVideoShare(){var e,t,n;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||null===(n=t.isSupportVideoShareReceive)||void 0===n||!n.call(t))}static isSupportVideoShareSend(){var e,t,n;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||null===(n=t.isSupportVideoShareSend)||void 0===n||!n.call(t))}static isSupportSending720P(){var e,t;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||!t.get720pcapacity())}static isSupportSubscribing1080P(){var e,t;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util)||void 0===t||!t.getsub1080pcapacity())}static isSupportOpenMicWhenShareAudio(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isSupportOpenMicWhenShareAudio())}static isSupportMediaPlaybackAsVideoInput(){var e,t;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util.videoToMediaStreamManager)||void 0===t||!t.isSupported())}static isSupportMediaPlaybackAsAudioInput(){var e,t;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||null===(t=e.util.audioToMediaStreamMananger)||void 0===t||!t.isSupported())}static isSupportAudioDenoise(e){var t;return!(null===(t=window.JsMediaSDK_Instance)||void 0===t||!t.util.isSupportAudioDenoise(e))}static isSupportAudioBridgeAVSync(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isSupportAudioBridgeAvsync())}static getAudioFeatureFlag(){var e;return null===(e=window.JsMediaSDK_Instance)||void 0===e?void 0:e.util.getAudioFeatureFlags()}static isSupportShareMultiStream(){var e;return null===(e=window.JsMediaSDK_Instance)||void 0===e?void 0:e.util.isSupportShareMultiStream()}static isSupportVideoLTR(){var e;return null===(e=window.JsMediaSDK_Instance)||void 0===e?void 0:e.util.isSupportVideoLTR()}static isSupportStereoAudio(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isBrowserSupportStereo())}static isSupportFullHDVideo(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isSupportSendVideoFullHD())}static isSupportFullHDVideoShare(){var e;return!(null===(e=window.JsMediaSDK_Instance)||void 0===e||!e.util.isSupportSendVideoShareFullHD())}static isSupportShare2ndAudioDevice(e){var t;return!(null===(t=window.JsMediaSDK_Instance)||void 0===t||!t.util.isSupportShare2ndAudioDevice(e))}connect(e){var t,n,i,r,o,s;let{svcUrl:a,meetingNumber:u,conId:l,e2eEncrypt:c,isViewOnly:d,currentUserId:h,isWebinar:p,enableAudioQos:f,enableVideoQos:g=!1,enableWebtransport:m=!1,webtransportPort:v,rendererType:y,adaptedABOptionForMediaSDK:S}=e;const{isSupportEssentialAudioAndVideoAbility:b,isSupportAudioWorklet:E,isSupportSendScreenSharing:w}=Uo;this.svcUrl=a,this.meetingNumber=u,this.confId=l;const _=((e,t,n)=>({videoSocketAddress:`wss://${e}/wc/media/${t}?type=v&cid=${n}`,audioSocketAddress:`wss://${e}/wc/media/${t}?type=a&cid=${n}`,sharingSocketAddress:`wss://${e}/wc/media/${t}?type=${qo()?"j":"s"}&cid=${n}`}))(a,u,l);this.mediaSocketAddress=_,this.currentUserId=h;const I=$o(null===(t=this.mediaOptions)||void 0===t?void 0:t.enableMultiDecodeVideoWithoutSAB);var C,A,T,R,O,P,D,k,x,N;null===(n=this.instance)||void 0===n||n.setPropsBeforeInit({callback:this.onMediaSDKCallback,audioWorkerPath:b?null===(i=this.mediaWorkersPath)||void 0===i?void 0:i.audioWorkletPath:void 0,e2eEncrypt:c,isEnableListenInitEvent:!0,enableWebtransport:m,webtransportPort:v,featureOptions:S,rendererType:y}),!0===(null===(r=this.constraints)||void 0===r?void 0:r.audio)&&b&&!Ho()&&((p||E)&&(null===(C=this.instance)||void 0===C||C.initAudioDecode(this.mediaWorkersPath,_.audioSocketAddress,h,$t,l,u,I,f)),!E||p&&d||null===(A=this.instance)||void 0===A||A.initAudioEncode(this.mediaWorkersPath,_.audioSocketAddress,h,$t,l,u,I,f)),!0===(null===(o=this.constraints)||void 0===o?void 0:o.video)&&b&&(null===(T=this.instance)||void 0===T||T.initVideoDecode(this.mediaWorkersPath,_.videoSocketAddress,h,$t,l,u,I,null===(R=null===(O=window.JsMediaSDK_Instance)||void 0===O||null===(P=O.util)||void 0===P?void 0:P.isGraphicShouldUseHardwareAccelerationDecode())||void 0===R||R,g),p&&d||null===(D=this.instance)||void 0===D||D.initVideoEncode(this.mediaWorkersPath,_.videoSocketAddress,h,$t,l,u,I,!1,g,!0,!0)),!0===(null===(s=this.constraints)||void 0===s?void 0:s.screen)&&(b?(null===(k=this.instance)||void 0===k||k.initSharingDecode(this.mediaWorkersPath,_.sharingSocketAddress,h,$t,l,u,I),!w||p&&d||null===(x=this.instance)||void 0===x||x.initSharingEncode(this.mediaWorkersPath,_.sharingSocketAddress,h,$t,l,u,I)):null===(N=this.instance)||void 0===N||N.initSharingDecode(_.sharingSocketAddress)),this.inProgress=!0}async destroy(){var e;this.callbackList=[],[Ms.AudioDecode,Ms.AudioEncode,Ms.VideoDecode,Ms.VideoEncode].forEach((e=>{var t;null===(t=this.instance)||void 0===t||t.updateQosSubscription(!1,e)}));const t=null===(e=this.instance)||void 0===e?void 0:e.destroy.bind(this.instance);this.instance=null,this.inProgress=!1,await(null==t?void 0:t())}disconnect(){var e,t;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(17,{}),null===(t=this.instance)||void 0===t||t.JsMediaSDK_UnInit()}muteAudio(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(8,{ssrc:0})}unmuteAudio(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(7,{ssrc:0,AudioSelectValue:0})}joinComputerAudio(e,t,n,i,r,o,s){var a;const u=s?{...s,enableHID:!0}:{enableHID:!1};return null===(a=this.instance)||void 0===a?void 0:a.Notify_MeidaSDK(22,{CaptureAudio:i,CaptureAudioInfo:{ssrc:e,AudioSelectValue:"default"===t?null:t,...u,audioProfile:r},speakerInfo:{defaultDeviceId:n},...o?{useAudioBridge:!0,audioBridge:o}:{}})}leaveComputerAudio(){var e;return null===(e=this.instance)||void 0===e?void 0:e.Notify_MeidaSDK(21,null)}joinSharingAudio(e){var t;let{ssrc:n,microphoneDeviceId:i,speakerDeviceId:r,isCaptureAudio:o,audioBridge:s}=e;return null===(t=this.instance)||void 0===t?void 0:t.Notify_MeidaSDK(72,{CaptureAudio:o,CaptureAudioInfo:{ssrc:n,AudioSelectValue:"default"===i?null:i},speakerInfo:{defaultDeviceId:r},checkAutoplay:!1,...s?{useAudioBridge:!0,audioBridge:s}:{}})}leaveSharingAudio(e){var t;return null===(t=this.instance)||void 0===t?void 0:t.Notify_MeidaSDK(73,{isPause:e?1:0})}changeSpeaker(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(11,{ssrc:0,AudioSelectValue:e})}changeMicrophone(e,t,n){var i;null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(18,{ssrc:0,AudioSelectValue:"default"===e?null:e,microphoneLabel:null!=t?t:"default",defaultMuted:n})}restoreWebRTC(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(19,{ssrc:0,AudioSelectValue:"default"===e?null:e})}renderVideo(e,t,n,i,r,o,s,a,u,l,c){var d;const h={userId:t,width:i,height:r,x:o,y:s,quality:a,isMyself:u,canvas:e,enableWaterMark:c,waterMarkText:l,zone:n};e instanceof HTMLVideoElement&&Object.assign(h,{videodom:e}),null===(d=this.instance)||void 0===d||d.Notify_MeidaSDK(1,h)}stopRenderVideo(e,t,n,i){var r;let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(2,{canvas:e,userId:t,RGBA:i,doNotClean:o,zone:n})}startCaptureVideo(e,t,n,i,r,o){var s;let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>8?arguments[8]:void 0;const l=(arguments.length>7?arguments[7]:void 0)?Ls.getPTZCapability():void 0;null===(s=this.instance)||void 0===s||s.Notify_MeidaSDK(3,{ssid:e,width:n,height:i,fps:u,video:r,usingFacingMode:o,VideoSelectValue:"default"===t?null:t,disableOriginalRatio:a,...l})}stopCaptureVideo(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(4,{ssrc:0})}changeCamera(e,t,n){var i;null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(12,{VideoSelectValue:"default"===e?null:e,usingFacingMode:!!t,...n||{}})}switchCanvasForVideoCapture(e){var t;let n=e;"string"==typeof e&&(n=[e]),null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(25,n)}renderSharing(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.receivedSharingCanvas=t,null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(23,{width:0,height:0,ssrc:e,canvas:t,enableWaterMark:i,waterMarkText:r,isFromMainSession:o})}stopRenderSharing(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(24,{})}switchSharingSource(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(36,{ssrc:e,isFromMainSession:Number(n)})}ajustmentReceivedSharingCanvas(e,t){if(this.receivedSharingCanvas)try{this.receivedSharingCanvas.width=e,this.receivedSharingCanvas.height=t}catch(e){}}startRemoteControl(e,t,n){var i;null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(26,{socketURL:`wss://${this.svcUrl}`,meetingID:this.meetingNumber,condID:this.confId,os:t,dom:e,...n})}stopRemoteControl(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(28)}resendRemoteControlPositionPDU(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(41)}updateRemoteControlProperties(e){var t;const{dimension:n,...i}=e;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(27,{...n,...i})}startDesktopSharing(e,t,n,i){var r;let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0;this.sharingCanvas=t;const l={};i&&Object.assign(l,{share2ndCamera:!0,share2ndCameraParams:{VideoSelectValue:"default"===i.cameraId?null:i.cameraId,width:i.width,height:i.height}}),void 0!==s&&Object.assign(l,{videoParams:{displaySurface:s}}),void 0!==u&&Object.assign(l,{otherParams:{...u}}),null===(r=this.instance)||void 0===r||r.Notify_MeidaSDK(30,{ssid:e,canvas:t,video:n,...l,showShareAudioOption:o,sourceId:a})}stopDesktopSharing(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(31,{})}pauseDesktopSharing(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(32,{})}resumeDesktopSharing(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(33,{})}selectLanguageChannelForNewLTT(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(57,{lang:e})}changeSharingSecondCamera(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(49,{VideoSelectValue:e})}ajustmentSharingCanvas(e,t){if(this.sharingCanvas)try{this.sharingCanvas.width=e,this.sharingCanvas.height=t}catch(e){}}checkChromeSharingExtension(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(34,{})}enableAudioEncode(){var e,t;null===(e=this.instance)||void 0===e||e.initAudioEncode(this.mediaWorkersPath,this.mediaSocketAddress.audioSocketAddress,this.currentUserId,$t,this.confId,this.meetingNumber,$o(null===(t=this.mediaOptions)||void 0===t?void 0:t.enableMultiDecodeVideoWithoutSAB))}sendUserNodeList(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(43,{userList:e,encryptKey:t})}updateRenderedSharingDimension(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(44,{width:e,height:t})}pauseOrResumeAudio(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(45,{bPause:e})}updateRenderedVideoCanvasDimension(e,t,n){var i;null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(46,{canvas:e,width:t,height:n})}clearVideoCanvas(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(47,{id:e,RGBA:t})}adjustRenderedVideoPosition(e,t,n,i,r,o,s,a){var u;null===(u=this.instance)||void 0===u||u.Notify_MeidaSDK(48,{userId:t,x:i,y:r,width:o,height:s,canvas:e,zone:n,RGBA:a})}mirrorVideo(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(75,{isMirrorMyVideo:e})}updateUserMediaSN(e){var t,n,i;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(80,{isFromMainSession:Number(e.isFromMainSession),mediaActionType:e.iVType,body:{add:null!==(n=e.added)&&void 0!==n?n:[],remove:null!==(i=e.removed)&&void 0!==i?i:[]}})}updateMediaParams(e){var t;const{iVType:n,isFromMainSession:i,updateParams:r}=e;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(81,{mediaActionType:n,isFromMainSession:Number(i),updateParams:r})}createMainSessionChannel(e,t){var n,i;"sharing"===e?null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(84,t):null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(85,t)}addReceivedSharingChannelType(e){var t;const{isFromMainSession:n,...i}=e;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(82,{isFromMainSession:Number(n),...i})}removeReceivedSharingChannelType(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(83,{isFromMainSession:Number(e.isFromMainSession),ssrc:e.ssrc})}enableHardwareAccelerationForVideoDecode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(70,{enable:e})}enableHardwareAccelerationForVideoEncode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(71,{enable:e})}setSharingAudioVolume(e,t,n){var i;null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(74,{userid:e>>10,shareVolume:t?0:100,isFromMainSession:n})}subscribeToQos(e,t){e.forEach((e=>{var n;null===(n=this.instance)||void 0===n||n.updateQosSubscription(!0,e,t)}))}unsubscribeFromQos(e){e.forEach((e=>{var t;null===(t=this.instance)||void 0===t||t.updateQosSubscription(!1,e)}))}passThroughRWGMessage(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(40,e)}startVirtualBackgroundSetting(e,t,n,i,r,o){var s;let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];null===(s=this.instance)||void 0===s||s.Notify_MeidaSDK(91,{canvas:e,bgdom:t,width:r,height:o,ssid:n,VideoSelectValue:"default"===i?null:i,disableOriginalRatio:a})}updateVirtualBackgroundImage(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(92,{bgdom:e})}stopVirtualBackgroundSetting(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(93,{isSwitch:t})}startMaskSetting(e,t,n,i,r,o,s,a,u){var l;null===(l=this.instance)||void 0===l||l.Notify_MeidaSDK(62,{canvas:e,maskdom:n,bgdom:t,dx:0,dy:0,dWidth:o,dHeight:s,width:a,height:u,ssid:i,VideoSelectValue:"default"===r?null:r})}updateMaskBackgroundImage(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(63,{bgdom:e})}updateMaskClip(e,t,n){var i;null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(64,{maskdom:e,dx:0,dy:0,dWidth:t,dHeight:n})}stopMaskSetting(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(65,{isSwitch:t})}enableVideoObserver(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(99,{enable:e,fpsdisbale:n})}enableShareAudioToBreakoutRoom(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(86,{enable:e})}sendUserAudioStatus(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(51,e)}muteOrUnmuteOtherAudio(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(50,{userId:e,volume:t?0:100})}adjustOtherAudioVolume(e,t){var n;null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(50,{userId:e,volume:t})}notifySDKMeetingReady(){var e;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(113)}movePTZCamera(e){var t,n;return null===(t=window.JsMediaSDK_Instance)||void 0===t||null===(n=t.util)||void 0===n?void 0:n.queryPTZPermisson().then((t=>{var n;return t?(null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(53,e),Promise.resolve("")):Promise.reject("Cannot move camera without permission granted")}))}switchSharingMode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(101,{mode:e})}updateVideoHDValue(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK("update_videohd_value",{videohd:e})}updateVideoFullhdValue(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK("update_videofullhd_value",{videofullhd:e})}changeAudioProfile(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(126,e)}enableSyncButtonsOnHeadset(e,t,n){var i;null===(i=this.instance)||void 0===i||i.Notify_MeidaSDK(100,{enable:e,microphoneLabel:t,defaultMuted:n})}stopAllIncomingAudio(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(123,e)}isSharingEntireScreen(){var e,t;const n=null===(e=this.instance)||void 0===e||null===(t=e.getShareStreamInfo)||void 0===t?void 0:t.call(e);if(n){const{displaySurface:e}=n;return!e||"monitor"===e}return!1}getShareStreamInfo(){var e,t;const n=null===(e=this.instance)||void 0===e||null===(t=e.getShareStreamInfo)||void 0===t?void 0:t.call(e);if(n){const{deviceId:e,width:t,height:i}=n;return{deviceId:e,width:t,height:i}}return{}}preInitAudioBridge(e){var t;null===(t=this.instance)||void 0===t||t.previewInit({audioBridge:{...e}})}prefetchVideoSsrc(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(110,{ssrc:e})}cancelPrefetchVideoSsrc(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(112,{ssrc:e,haddata:!1})}setMobileRotateMode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(124,{isLandScape:e})}changeActiveVideoSsrc(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(13,{ssrc:e})}setAudioCodecMode(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(122,{mode:e})}startRemoteControlQRCheck(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(54,{enable:e})}broadcastVoiceToBreakoutRoom(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(87,{enable:e})}share2ndAudio(e,t){var n;const i={audioOnly:!0,deviceId:"default"===e?null:e};t&&Object.assign(i,t),null===(n=this.instance)||void 0===n||n.Notify_MeidaSDK(129,i)}}Ls.agentInstance=void 0;const Vs="ADD_CURRENT_USER_PARTICIPANT_ATTRIBUTE",js="UPDATE_CURRENT_USER_PARTICIPANT_ATTRIBUTE",Bs="ADD_USER_PARTICIPANT_ATTRIBUTE",Us="UPDATE_USER_PARTICIPANT_ATTRIBUTE",Hs="REMOVE_USER_PARTICIPANT_ATTRIBUTE",qs="UPDATE_WEBINAR_PARTICIPANT_ATTRIBUTE",Ks="REMOVE_WEBINAR_ATTENDEE_ATTRIBUTE",$s="JOIN_MEETING_SUCCESS",Ws="JOIN_MEETING_FAILED",Gs="RECONNECTING_MEETING",zs="LEAVING_MEETING",Js="MEETING_IN_WAITING_ROOM",Qs="UPDATE_MEETING_ATTRIBUTE",Ys="SHARE_PRONOUN_TYPE_UPDATE";var Zs=function(e){return e.ConnectionChange="connection-change",e.OnHoldChange="on-hold-change",e.UserAdd="user-added",e.UserUpdate="user-updated",e.UserRemove="user-removed",e.AttendeeUpdate="attendee-updated",e.MeetingAttributeUpdate="meeting-attribute-updated",e.PromoteAttendeeConsent="promote-attendee-consent",e.ActiveAppsUpdate="active-apps-updated",e.SharePronounTypeUpdate="share-pronoun-type-update",e}(Zs||{});const Xs={JoinMeeting:{success:Vs,fail:[Ws]}},ea={[Zs.ConnectionChange]:[{event:$s,payload:()=>({state:Io.Connected})},{event:Ws,payload:e=>({state:Io.Fail,...e})},{event:Gs,payload:e=>({state:Io.Reconnecting,...e})},{event:zs,payload:e=>({state:Io.Closed,...e})}],[Zs.OnHoldChange]:[{event:Js,payload:e=>({isOnHold:e})}],[Zs.UserAdd]:[{event:Vs,payload:e=>[e]},{event:Bs,payload:e=>e}],[Zs.UserUpdate]:[{event:js,payload:e=>[e]},{event:Us,payload:e=>e}],[Zs.UserRemove]:[{event:Hs,payload:e=>e}],[Zs.AttendeeUpdate]:[{event:qs,payload:e=>e},{event:Ks,payload:e=>e}],[Zs.MeetingAttributeUpdate]:[{event:Qs,payload:e=>"bNoHostTimeOut"in e?{isHostLost:e.bNoHostTimeOut}:null}],[Zs.PromoteAttendeeConsent]:[{event:"MEETING_WEBINAR_PROMOTE_CONSENT_REQ",payload:e=>{let{req_id:t,sender_id:n}=e;return{reqId:t,senderId:n}}}],[Zs.ActiveAppsUpdate]:[{event:"ACTIVE_APPS_UPDATE",payload:()=>{}}],[Zs.SharePronounTypeUpdate]:[{event:Ys,payload:e=>e}]},ta="LIVE_TRANSCRIPTION_RECEIVE_MESSAGE",na="LIVE_TRANSCRIPTION_CAPTION_STATUS_CHANGE_RESPONSE",ia="LIVE_TRANSCRIPTION_STATUS_CHANGE",ra="LIVE_TRANSCRIPTION_HOST_DISABLE_CHANGE",oa={"caption-message":[{event:ta,payload:e=>e}],"caption-status":[{event:na,payload:e=>e}],"caption-enable":[{event:ia,payload:e=>e}],"caption-host-disable":[{event:ra,payload:e=>e}]},sa="CHAT_RECEIVE_MESSAGE_EVENTS",aa="CHAT_PRIVILEGE_CHANGE",ua="CHAT_MESSAGE_RESPONSE",la="CHAT_DELETE_MESSAGE_REPONSE",ca="CHAT_FILE_CHAT_UPLOAD_PROGRESS",da="CHAT_FILE_CHAT_DOWNLOAD_PROGRESS";let ha=function(e){return e.ChatOnMessage="chat-on-message",e.ChatPrivilegeChange="chat-privilege-change",e.ChatDeleteMessage="chat-delete-message",e.ChatFileUploadProgress="chat-file-upload-progress",e.ChatFileDownloadProgress="chat-file-download-progress",e}({});const pa={[ha.ChatOnMessage]:[{event:sa,payload:e=>e}],[ha.ChatPrivilegeChange]:[{event:aa,payload:e=>e}],[ha.ChatDeleteMessage]:[{event:la,payload:e=>e}],[ha.ChatFileUploadProgress]:[{event:ca,payload:e=>e}],[ha.ChatFileDownloadProgress]:[{event:da,payload:e=>e}]},fa="COMMAND_RECEIVE_MESSAGE_EVENTS",ga="COMMAND_STATUS_EVENTS";let ma=function(e){return e.CommandChannelStatus="command-channel-status",e.CommandChannelMessage="command-channel-message",e}({});const va={[ma.CommandChannelStatus]:[{event:ga,payload:e=>e}],[ma.CommandChannelMessage]:[{event:fa,payload:e=>e}]};let ya=function(e){return e.Recording="Recording",e.Paused="Paused",e.Stopped="Stopped",e.Ask="Ask",e.Accept="Accept",e.Decline="Decline",e}({}),Sa=function(e){return e[e.None=0]="None",e[e.Init=1]="Init",e[e.Start=2]="Start",e[e.Pause=3]="Pause",e[e.Stop=4]="Stop",e}({}),ba=function(e){return e[e.Stop=0]="Stop",e[e.Start=1]="Start",e[e.Pause=2]="Pause",e}({}),Ea=function(e){return e[e.None=0]="None",e[e.Deny=1]="Deny",e[e.Allow=2]="Allow",e}({}),wa=function(e){return e[e.None=0]="None",e[e.DenyAllRequest=1]="DenyAllRequest",e[e.AllowAllRequest=2]="AllowAllRequest",e}({});const _a="CLOUD_RECORDING_STATUS_CHANGE",Ia="CLOUD_RECORDING_ISO_STATUS_CHANGE",Ca="LOCAL_RECORDING_CHANGE",Aa="LOCAL_RECORDING_PERMISSION_CHANGE",Ta="RECORDING_FOR_IQ_STATUS_CHANGE",Ra="RECORDING_FOR_IQ_OPERATION_CHANGE";let Oa=function(e){return e.RecordingChange="recording-change",e.IndividualRecordingChange="individual-recording-change",e.LocalRecordingChange="local-recording-change",e.LocalRecordingPermissionChange="local-recording-permission-change",e.MediaCaptureStatusChange="media-capture-status-change",e.MediaCapturePermissionChange="media-capture-permission-change",e.RecordingIqChange="recording-iq-change",e}({});const Pa={[Oa.RecordingChange]:[{event:_a,payload:e=>{const{cmrServerStatus:t}=e;return t===Sa.Start?ya.Recording:t===Sa.Pause?ya.Paused:ya.Stopped}}],[Oa.IndividualRecordingChange]:[{event:Ia,payload:e=>e}],[Oa.LocalRecordingChange]:[{event:Ca,payload:e=>e}],[Oa.LocalRecordingPermissionChange]:[{event:Aa,payload:e=>e}],[Oa.MediaCaptureStatusChange]:[{event:Ca,payload:e=>e}],[Oa.MediaCapturePermissionChange]:[{event:Aa,payload:e=>e}],[Oa.RecordingIqChange]:[{event:Ta,payload:e=>e}]};let Da=function(e){return e[e.InitSuccess=1]="InitSuccess",e[e.InitSuccessVideo=1.1]="InitSuccessVideo",e[e.InitSuccessAudio=1.2]="InitSuccessAudio",e[e.InitSuccessSharing=1.3]="InitSuccessSharing",e[e.UserGrantCaptureAudio=2]="UserGrantCaptureAudio",e[e.CurrentVideoResolution=3]="CurrentVideoResolution",e[e.JpegDecThreadOk=4]="JpegDecThreadOk",e[e.JpegData=5]="JpegData",e[e.SharingPara=6]="SharingPara",e[e.VideoDecodeMaxSize=7]="VideoDecodeMaxSize",e[e.CurrentCaptureVideoWidthHeight=8]="CurrentCaptureVideoWidthHeight",e[e.StartVideoCaptureSuccess=9]="StartVideoCaptureSuccess",e[e.StopVideoCaptureSuccess=10]="StopVideoCaptureSuccess",e[e.StartRemoteControlSuccess=11]="StartRemoteControlSuccess",e[e.CancelRemoteControlSuccess=12]="CancelRemoteControlSuccess",e[e.RemoteControlCopiedTextNotify=13]="RemoteControlCopiedTextNotify",e[e.MonitorLog=14]="MonitorLog",e[e.CurrentDesktopSharingWidthHeight=15]="CurrentDesktopSharingWidthHeight",e[e.DesktopSharingCaptureSuccess=16]="DesktopSharingCaptureSuccess",e[e.CheckChromeSharingExtensionResponse=17]="CheckChromeSharingExtensionResponse",e[e.SharingDecodeMaxSize=18]="SharingDecodeMaxSize",e[e.DataChannelOffer=19]="DataChannelOffer",e[e.AesGcmIvResponse=21]="AesGcmIvResponse",e[e.SharingDesktopStreamHaveAudio=23]="SharingDesktopStreamHaveAudio",e[e.JoinComputerAudioComplete=24]="JoinComputerAudioComplete",e[e.JoinSharingAudioComplete=25]="JoinSharingAudioComplete",e[e.LeaveComputerAudioComplete=26]="LeaveComputerAudioComplete",e[e.LeaveSharingAudioComplete=27]="LeaveSharingAudioComplete",e[e.HidStatusMute=28]="HidStatusMute",e[e.AudioStreamFailed=31]="AudioStreamFailed",e[e.VideoStreamFailed=32]="VideoStreamFailed",e[e.AudioSpeakerSetSuccess=33]="AudioSpeakerSetSuccess",e[e.AudiobridgeSetCcLangSuccess=36]="AudiobridgeSetCcLangSuccess",e[e.AudioLevelIndicator=38]="AudioLevelIndicator",e[e.SyncRendererTypeResponse=39]="SyncRendererTypeResponse",e[e.SendRemoteControlQrCode=55]="SendRemoteControlQrCode",e[e.StartVideoStreamInMaskSettingSuccess=66]="StartVideoStreamInMaskSettingSuccess",e[e.CurrentDecodeVideoQuality=66.5]="CurrentDecodeVideoQuality",e[e.CurrentDecodeVideoFps=66.6]="CurrentDecodeVideoFps",e[e.SharingFirstDecodeFrameReceivedSsrc=70]="SharingFirstDecodeFrameReceivedSsrc",e[e.StartVideoStreamInVbSettingSuccess=94]="StartVideoStreamInVbSettingSuccess",e[e.VbModelPreloading_3S=96]="VbModelPreloading_3S",e[e.VbModelPreloading_10S=97]="VbModelPreloading_10S",e[e.VbModelPreloadingOk=98]="VbModelPreloadingOk",e[e.NewActiveSpeakerFirstFrameCallback=111]="NewActiveSpeakerFirstFrameCallback",e[e.AudioBridgeFirstRecvData=114]="AudioBridgeFirstRecvData",e[e.AudioBridgeCanSendData=115]="AudioBridgeCanSendData",e[e.InitFailed=-1]="InitFailed",e[e.InitFailedVideo=-1.1]="InitFailedVideo",e[e.InitFailedAudio=-1.2]="InitFailedAudio",e[e.InitFailedSharing=-1.3]="InitFailedSharing",e[e.UserForbiddedCaptureAudio=-2]="UserForbiddedCaptureAudio",e[e.AudioWebsocketBroken=-3]="AudioWebsocketBroken",e[e.VideoWebsocketBroken=-4]="VideoWebsocketBroken",e[e.SharingDecThreadFailed=-5]="SharingDecThreadFailed",e[e.AudioZeroData=-6]="AudioZeroData",e[e.AudioCtxSamplerate=-7]="AudioCtxSamplerate",e[e.UserForbiddedCaptureVideo=-8]="UserForbiddedCaptureVideo",e[e.UserCameraIsTakenByOtherPrograms=-9]="UserCameraIsTakenByOtherPrograms",e[e.StopVideoCaptureFailed=-10]="StopVideoCaptureFailed",e[e.StartRemoteControlFailed=-11]="StartRemoteControlFailed",e[e.CancelRemoteControlFailed=-12]="CancelRemoteControlFailed",e[e.RemoteControlPasteTextLengthOverflow=-14]="RemoteControlPasteTextLengthOverflow",e[e.UserStopDesktopSharing=-15]="UserStopDesktopSharing",e[e.UserCancelPermissionRequest=-16]="UserCancelPermissionRequest",e[e.DesktopSharingChromeExtensionUninstalled=-17]="DesktopSharingChromeExtensionUninstalled",e[e.DesktopSharingPermissionDenied=-18]="DesktopSharingPermissionDenied",e[e.DesktopSharingTimeOut=-19]="DesktopSharingTimeOut",e[e.DesktopSharingError=-20]="DesktopSharingError",e[e.AudioSpeakerSetError=-21]="AudioSpeakerSetError",e[e.DesktopSharingSystemError=-22]="DesktopSharingSystemError",e[e.SharingDesktopStreamHaveNoAudio=-27]="SharingDesktopStreamHaveNoAudio",e.AudioQosData="AUDIO_QOS_DATA",e.VideoQosData="VIDEO_QOS_DATA",e.ShareQosData="VIDEOSHARE_QOS_DATA",e.NetworkQualityChange="NETWORK_QUALITY_CHANGE",e[e.AudioBridgeReconnectStart=-29]="AudioBridgeReconnectStart",e[e.AudioBridgeReconnectEnd=-31]="AudioBridgeReconnectEnd",e[e.WebglLostInMultiView=-32]="WebglLostInMultiView",e[e.MaskSettingParaError=-33]="MaskSettingParaError",e[e.VbSettingParaError=-34]="VbSettingParaError",e[e.NotifyUIFailover=-35]="NotifyUIFailover",e[e.RecoverWebrtcAudio=-36]="RecoverWebrtcAudio",e[e.AudiobridgeSetCcLangFailure=-39]="AudiobridgeSetCcLangFailure",e}({}),ka=function(e){return e[e.EncodeSuccess=1]="EncodeSuccess",e[e.DecodeSuccess=2]="DecodeSuccess",e[e.EncodeFailed=-1]="EncodeFailed",e[e.DecodeFailed=-2]="DecodeFailed",e}({}),xa=function(e){return e.Spotlight="Spotlight",e.Unmute="Unmute",e.AllowToTalk="Allow to talk",e}({}),Na=function(e){return e.Inherited="inherited",e.Active="active",e.PassiveByMuteOne="passive(mute one)",e.PassiveByMuteAll="passive(mute all)",e.SharingAudio="sharing audio",e}({}),Ma=function(e){return e.Inherited="inherited",e.Active="active",e.Passive="passive",e.SharingAudio="sharing audio",e}({}),Fa=function(e){return e.Active="active",e.Failover="failover",e.EndedBySystem="audio stream is ended by system",e.Pstn="pstn",e.MicrophoneError="microphone error",e}({}),La=function(e){return e.Join="join",e.Leave="leave",e.Muted="muted",e.Unmuted="unmuted",e}({}),Va=function(e){return e[e.Calling=1]="Calling",e[e.Ringing=2]="Ringing",e[e.Accepted=3]="Accepted",e[e.Busy=4]="Busy",e[e.NotAvailable=5]="NotAvailable",e[e.HangUp=6]="HangUp",e[e.Fail=7]="Fail",e[e.Success=8]="Success",e[e.Timeout=9]="Timeout",e[e.Canceling=10]="Canceling",e[e.Canceled=11]="Canceled",e[e.CancelFailed=12]="CancelFailed",e}({});const ja=(()=>{const e=new ArrayBuffer(684),t=new Uint32Array(e);return t.set([1179011410,676,1163280727,544501094,16,65539,16e3,64e3,2097156,1635017060,640],0),new Blob([t],{type:"audio/wav"})})(),Ba=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]),Ua=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);let Ha=function(e){return e[e.HostGrab=0]="HostGrab",e[e.OnlyHost=1]="OnlyHost",e[e.AnyoneGrab=2]="AnyoneGrab",e[e.MultipleShare=3]="MultipleShare",e}({}),qa=function(e){return e.Sharing="sharing",e.Paused="paused",e.End="ended",e}({}),Ka=function(e){return e[e.Video_90P=0]="Video_90P",e[e.Video_180P=1]="Video_180P",e[e.Video_360P=2]="Video_360P",e[e.Video_720P=3]="Video_720P",e[e.Video_1080P=4]="Video_1080P",e}({}),$a=function(e){return e.Active="Active",e.Inactive="Inactive",e}({}),Wa=function(e){return e.Muted="Muted",e.Unmuted="Unmuted",e}({}),Ga=function(e){return e.Started="Started",e.Stopped="Stopped",e.Failed="Failed",e}({}),za=function(e){return e.Approved="Approved",e.Rejected="Rejected",e}({}),Ja=function(e){return e.PrivilegeChange="PrivilegeChange",e.StopScreenCapture="StopScreenCapture",e.ShareFromMainSession="ShareFromMainSession",e}({}),Qa=function(e){return e[e.ImageNotMatch=2]="ImageNotMatch",e[e.CanvasNotMatch=3]="CanvasNotMatch",e[e.VBModelNotMatch=4]="VBModelNotMatch",e}({});const Ya="blur";let Za=function(e){return e.User="user",e.Environment="environment",e.Left="left",e.Right="right",e}({});const Xa=Object.values(Za),eu=1e3,tu="__ZOOM_SDK_SHARING_VIDEO__",nu="__ZOOM_SDK_VIDEO_ZONE__",iu="__ZOOM_SDK_VIRTUAL_BACKGROUND_CANVAS_@__",ru="__ZOOM_SDK_VIRTUAL_BACKGROUND_IMAGE_@__",ou="__ZOOM_SDK_MASK_CLIP_@__",su="__ZOOM_SDK_MEDIA_PLAYBACK_SOURCE_VIDEO__",au="__ZOOM_SDK_DYMMY_VIDEO_PLAYER_CANVAS_ID__",uu="__ZOOM_SDK_DUMMY_HIDDEN_SELF_VIEW_VIDEO_ID__",lu={data:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,rate:0,bandwidth:0}},cu={data:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,rate:0,bandwidth:0}};let du=function(e){return e[e.Request=11]="Request",e[e.Decline=12]="Decline",e[e.Approve=13]="Approve",e[e.GiveUp=14]="GiveUp",e[e.StartControl=15]="StartControl",e[e.ContinueControl=16]="ContinueControl",e[e.StopControl=17]="StopControl",e[e.SwitchCamera=20]="SwitchCamera",e}({}),hu=function(e){return e[e.Bk=0]="Bk",e[e.Center=1]="Center",e[e.ZoomIn=2]="ZoomIn",e[e.ZoomOut=3]="ZoomOut",e[e.Left=4]="Left",e[e.Right=5]="Right",e[e.Up=6]="Up",e[e.Down=7]="Down",e[e.SwitchCamera=8]="SwitchCamera",e}({}),pu=function(e){return e[e.Pan=192]="Pan",e[e.Tilt=48]="Tilt",e[e.Zoom=12]="Zoom",e[e.Focus=3]="Focus",e}({}),fu=function(e){return e[e.ZoomIn=2]="ZoomIn",e[e.ZoomOut=3]="ZoomOut",e[e.Left=4]="Left",e[e.Right=5]="Right",e[e.Up=6]="Up",e[e.Down=7]="Down",e[e.SwitchCamera=8]="SwitchCamera",e}({}),gu=function(e){return e[e.None=0]="None",e[e.ApproveAnother=3]="ApproveAnother",e[e.Stop=5]="Stop",e}({}),mu=function(e){return e[e.Null=0]="Null",e[e.Normal=1]="Normal",e[e.VideoMode=2]="VideoMode",e}({}),vu=function(e){return e[e.Null=0]="Null",e[e.VirtualBackground=1]="VirtualBackground",e[e.Mask=2]="Mask",e}({}),yu=function(e){return e.Computer="computer",e.Phone="phone",e}({}),Su=function(e){return e[e.Decline=0]="Decline",e[e.Approve=1]="Approve",e[e.CacheClean=2]="CacheClean",e}({}),bu=function(e){return e.Unknown="unknown",e.Uninstalled="uninstalled",e.Installed="installed",e}({}),Eu=function(e){return e.Unlaunched="unlaunched",e.Launched="launched",e}({}),wu=function(e){return e.Started="started",e.Ended="ended",e}({}),_u=function(e){return e[e.Max=30]="Max",e[e.Min=10]="Min",e[e.Default=24]="Default",e}({}),Iu=function(e){return e[e.Loading=1]="Loading",e[e.Done=2]="Done",e}({}),Cu=function(e){return e.Browser="Browser",e.Zoom="Zoom",e}({}),Au=function(e){return e.Denoise="backgroundNoiseSuppression",e.OriginalSound="originalSound",e}({}),Tu=function(e){return e[e.Undefined=0]="Undefined",e[e.WebGL=1]="WebGL",e[e.WebGPU=2]="WebGPU",e[e.WebGL2=3]="WebGL2",e}({}),Ru=function(e){return e[e.H323=1]="H323",e[e.SIP=2]="SIP",e}({}),Ou=function(e){return e[e.Success=0]="Success",e[e.Ringing=1]="Ringing",e[e.Timeout=2]="Timeout",e[e.Busy=101]="Busy",e[e.Fail=104]="Fail",e}({});const Pu="RECEIVE_VIDEO_ACTIVE_INDICATION",Du="RECEIVE_VIDEO_MUTE_INDICATION",ku="ASK_FOR_START_VIDEO_CONSENT",xu="RECEIVE_VIDEO_DIMENSION_CHANGE",Nu="CAPTURED_VIDEO_DIMENSION_CHANGE",Mu="CAN_NOT_DETECT_CAMERA",Fu="CAN_NOT_FIND_CAMERA",Lu="VIDEO_USER_FORBIDDEN_CAPTURE",Vu="VIDEO_CAMERA_IS_TAKEN",ju="VIDEO_BACKGROUND_FAILED",Bu="VIDEO_ESTABLISH_STREAM_ERROR",Uu="VIDEO_CAPTURE_START_SUCCESS",Hu="VIDEO_CAPTURE_STOP_RESULT",qu="VIDEO_SPOTLIGHT_CHANGE",Ku="VIDEO_FOLLOW_HOST_ORDER_CHANGE",$u="VIDEO_HOST_DRAG_LAYOUT_CHANGE",Wu="VIDEO_NEW_USER_START",Gu="VIDEO_OLD_USER_STOP",zu="VIDEO_VIRTUAL_BACKGROUND_PRELOAD_READY",Ju="VIDEO_VIRTUAL_BACKGROUND_SETTING_SUCCESS",Qu="VIDEO_STATISTIC_DATA",Yu="VIDEO_CELL_DETAILED_DATA",Zu="VIDEO_NETWORK_QUALITY_CHANGE",Xu="VIDEO_FAR_END_CAMERA_CONTROL_REQUEST",el="VIDEO_FAR_END_CAMERA_CONTROL_RESPONSE",tl="VIDEO_FAR_END_CAMERA_IN_CONTROL_CHANGE",nl="VIDEO_FAR_END_CAMERA_CAPABILITY_CHANGE",il="VIDEO_MASK_SETTING_SUCCESS",rl="VIDEO_CAPTURE_SDK_SUCCESS",ol="VIDEO_PREFETCH_VIDEO_FRAME_CALLBACK",sl="VIDEO_CURRENT_USER_SSRC",al="VIDEO_RENDER_ASPECT_RATIO_CHANGE",ul={startCaptureVideo:{success:Uu,fail:[Mu,Fu,Lu,Bu,Vu,ju]},switchCameraVideo:{success:rl,fail:[Mu,Fu,Lu,Vu]},stopCaptureVideo:{success:Hu}};let ll=function(e){return e.VideoActiveChange="video-active-change",e.PeerVideoStateChange="peer-video-state-change",e.VideoSpotlightChange="video-spotlight-change",e.VideoMutedChange="video-muted-change",e.VideoCapturingChange="video-capturing-change",e.AskForStartVideoConsent="ask-for-start-video-consent",e.VideoDimensionChange="video-dimension-change",e.VideoFollowHostOrder="video-follow-host-order-change",e.VideoHostLayoutChange="video-host-layout-change",e.VideoVBPreloadChange="video-virtual-background-preload-change",e.VideoStatisticDataChange="video-statistic-data-change",e.VideoDetailedDataChange="video-detailed-data-change",e.VideoAspectRatioChange="video-aspect-ratio-change",e.NetworkQualityChange="network-quality-change",e.FarEndCameraRequestControl="far-end-camera-request-control",e.FarEndCameraResponseControl="far-end-camera-response-control",e.FarEndCameraInControlChange="far-end-camera-in-control-change",e.FarEndCameraCapabilityChange="far-end-camera-capability-change",e}({});const cl={[ll.VideoActiveChange]:[{event:Pu,payload:e=>({state:e.bVideoOn?$a.Active:$a.Inactive,userId:e.userId})}],[ll.VideoCapturingChange]:[{event:Uu,payload:()=>({state:Ga.Started})},{event:Hu,payload:e=>({state:null!=e&&e.failed?Ga.Failed:Ga.Stopped})}],[ll.VideoMutedChange]:[{event:Du,payload:e=>({state:e.isVideoMuted?Wa.Muted:Wa.Unmuted,userId:e.id})}],[ll.AskForStartVideoConsent]:[{event:ku,payload:e=>({state:e.isVideoMuted?Wa.Muted:Wa.Unmuted,userId:e.id})}],[ll.VideoSpotlightChange]:[{event:qu,payload:e=>({spotlightList:e.spotlightList&&e.spotlightList.map((e=>({userId:e})))})}],[ll.VideoDimensionChange]:[{event:xu,payload:e=>({type:"received",width:e.width,height:e.height})},{event:Nu,payload:e=>({type:"captured",width:e.width,height:e.height})}],[ll.VideoFollowHostOrder]:[{event:Ku,payload:e=>({isFollowHostOrder:e.bOn})}],[ll.VideoHostLayoutChange]:[{event:$u,payload:e=>Array.isArray(e.layout)?e.layout.map((e=>({userId:e}))):[]}],[ll.PeerVideoStateChange]:[{event:Wu,payload:e=>({action:"Start",...e})},{event:Gu,payload:e=>({action:"Stop",...e})}],[ll.VideoVBPreloadChange]:[{event:zu,payload:e=>({isReady:e})}],[ll.VideoStatisticDataChange]:[{event:Qu,payload:e=>{const{data:{rate:t,...n},...i}=null!=e?e:{data:{}};return{data:{bitrate:t,...n},...i}}}],[ll.VideoDetailedDataChange]:[{event:Yu,payload:e=>e}],[ll.VideoAspectRatioChange]:[{event:al,payload:e=>e}],[ll.NetworkQualityChange]:[{event:Zu,payload:e=>e}],[ll.FarEndCameraRequestControl]:[{event:Xu,payload:e=>e}],[ll.FarEndCameraResponseControl]:[{event:el,payload:e=>e}],[ll.FarEndCameraInControlChange]:[{event:tl,payload:e=>e}],[ll.FarEndCameraCapabilityChange]:[{event:nl,payload:e=>e}]},dl="AUDIO_ACTIVE_SPEAKER",hl="AUDIO_UNMUTE_CONSENT",pl="AUDIO_CURRENT_USER_JOIN_BY_VOIP",fl="AUDIO_CURRENT_USER_JOIN_BY_PHONE",gl="AUDIO_CURRENT_USER_LEAVE_AUDIO",ml="AUDIO_CURRENT_USER_MUTED",vl="AUDIO_CURRENT_USER_UNMUTED",yl="AUDIO_PARTICIPANT_AUDIO_UPDATE",Sl="AUDIO_DIALOUT_RESULT_CODE",bl="AUDIO_DIALOUT_RESULT_SUCCESS",El="AUDIO_DIALOUT_RESULT_FAIL",wl="AUDIO_DIALOUT_CANCEL_SUCCESS",_l="DIALOUT_CANCEL_FAIL",Il="AUDIO_MERGE_AUDIO_INDICATION",Cl="USER_FORBIDDEN_MICROPHONE",Al="ESTABLISH_AUDIO_STREAM_ERROR",Tl="AUDIO_AUTO_PLAY_FAILED",Rl="INVALID_DEVICE_ID",Ol="AUDIO_ALLOW_TALK_CHANGE",Pl="SHARE_AUDIO_STATE_CHANGE",Dl="AUDIO_STATISTIC_DATA",kl="AUDIO_CURRENT_USER_SSRC",xl="AUDIO_SET_SPEAKER_RESULT",Nl="AUDIO_SHARE_SECONDARY_AUDIO_SUCCESS",Ml="AUDIO_CRC_CALL_OUT_RESULT_CODE",Fl="AUDIO_CRC_CALL_OUT_RESULT_SUCCESS",Ll="AUDIO_CRC_CALL_OUT_RESULT_FAIL",Vl="AUDIO_CURRENT_AUDIO_LEVEL_CHANGE";let jl=function(e){return e.ActiveSpeaker="active-speaker",e.UnmuteAudioConsent="unmute-audio-consent",e.CurrentAudioChange="current-audio-change",e.CurrentAudioLevelChange="current-audio-level-change",e.DialoutStateChange="dialout-state-change",e.MergeAudio="merged-audio",e.AutoPlayFailed="auto-play-audio-failed",e.AllowTalkChange="allow-talk-change",e.ShareAudioChange="share-audio-change",e.AudioStatisticDataChange="audio-statistic-data-change",e.CrcCallOutStateChange="crc-call-out-state-change",e}({});const Bl={JoinComputerAudio:{success:pl,fail:[Cl,Al]},LeaveComputerAudio:{success:gl},JoinAudioByCallMe:{success:bl,fail:[El]},cancelDialOut:{success:wl,fail:[_l]},hangup:{success:gl},crcCallOut:{success:Fl,fail:[Ll]}},Ul={[jl.ActiveSpeaker]:[{event:dl,payload:e=>e}],[jl.UnmuteAudioConsent]:[{event:hl,payload:e=>({reason:e})}],[jl.CurrentAudioChange]:[{event:fl,payload:()=>({action:La.Join,type:yu.Phone})},{event:pl,payload:()=>({action:La.Join,type:yu.Computer})},{event:gl,payload:e=>{let{source:t}=e;return{action:La.Leave,source:t}}},{event:ml,payload:e=>{let{source:t}=e;return{action:La.Muted,source:t}}},{event:vl,payload:e=>{let{source:t}=e;return{action:La.Unmuted,source:t}}}],[jl.DialoutStateChange]:[{event:Sl,payload:e=>e}],[jl.MergeAudio]:[{event:Il,payload:e=>e}],[jl.AutoPlayFailed]:[{event:Tl,payload:()=>{}}],[jl.AllowTalkChange]:[{event:Ol,payload:e=>({enabled:e})}],[jl.ShareAudioChange]:[{event:Pl,payload:e=>e}],[jl.AudioStatisticDataChange]:[{event:Dl,payload:e=>{const{data:{rate:t,...n},...i}=null!=e?e:{data:{}};return{data:{bitrate:t,...n},...i}}}],[jl.CrcCallOutStateChange]:[{event:Ml,payload:e=>e}],[jl.CurrentAudioLevelChange]:[{event:Vl,payload:e=>e}]},Hl="SHARE_ACTIVE_INDICATION",ql="SHARE_CHECK_CHROME_SHARING_EXTENSION",Kl="SHARE_START_DESKTOP_SHARE_FAILED",$l="SHARE_DIMENSION_CHANGE",Wl="SHARE_RECEIVED_DIMENSION_CHANGE",Gl="SHARE_VIDEO_STREAMS_END",zl="SHARE_PASSIVE_STOP_SHARE",Jl="SHARE_PASSIVE_BO_STOP",Ql="SHARE_NEW_USER_ADD",Yl="SHARE_USER_REMOVE",Zl="SHARE_USER_PAUSED",Xl="SHARE_USER_RESUMED",ec="SHARE_AUTO_CHANGE_SOURCE",tc="SHARE_REMOTE_CONTROL_APPROVE",nc="SHARE_GRAB_REMOTE_CONTROL_CHANGE",ic="SHARE_REMOTE_CONTROL_CLIPBOARD_CHANGE",rc="SHARE_REMOTE_CONTROL_SUCCESS",oc="SHARE_REMOTE_CONTROL_FAILED",sc="SHARE_PRIVILEGE_CHANGE",ac="SHARE_READ_RECEIPT",uc="SHARE_STATISTIC_DATA",lc="SHARE_REMOTE_CONTROL_REQUEST",cc="SHARE_REMOTE_CONTROL_APP_STATUS",dc="SHARE_REMOTE_CONTROL_SESSION_STATUS",hc="SHARE_REMOTE_CONTROL_APP_SCHEME";let pc=function(e){return e.ShareActiveChange="active-share-change",e.ShareDimensionChange="share-content-dimension-change",e.SharePassiveStop="passively-stop-share",e.SharePeerStateChange="peer-share-state-change",e.ShareContentChange="share-content-change",e.SharePrivilegeChange="share-privilege-change",e.ShareReadReceipt="share-can-see-screen",e.ShareStatisticDataChange="share-statistic-data-change",e.RemoteControlApprovedChange="remote-control-approved-change",e.RemoteControlInControlChange="remote-control-in-control-change",e.RemoteControlClipboardChange="remote-control-clipboard-change",e.RemoteControlRequestChange="remote-control-request-change",e.RemoteControlAppStatusChange="remote-control-app-status-change",e.RemoteControlControlledStatusChange="remote-control-controlled-status-change",e}({});const fc={[pc.ShareActiveChange]:[{event:Hl,payload:e=>{const{isActive:t,activeUserId:n,...i}=e;return{state:t?"Active":"Inactive",userId:n,...i}}}],[pc.ShareDimensionChange]:[{event:$l,payload:e=>({type:"sended",width:e.width,height:e.height})},{event:Wl,payload:e=>({type:"received",width:e.width,height:e.height})}],[pc.SharePassiveStop]:[{event:Gl,payload:()=>({reason:Ja.StopScreenCapture})},{event:zl,payload:()=>({reason:Ja.PrivilegeChange})},{event:Jl,payload:()=>({reason:Ja.ShareFromMainSession})}],[pc.SharePeerStateChange]:[{event:Ql,payload:e=>({userId:e.id,action:"Start"})},{event:Yl,payload:e=>({userId:e.id,action:"Stop"})},{event:Zl,payload:e=>({userId:e.id,action:"Pause"})},{event:Xl,payload:e=>({userId:e.id,action:"Resume"})}],[pc.ShareContentChange]:[{event:ec,payload:e=>e}],[pc.SharePrivilegeChange]:[{event:sc,payload:e=>({privilege:e})}],[pc.ShareReadReceipt]:[{event:ac,payload:()=>{}}],[pc.ShareStatisticDataChange]:[{event:uc,payload:e=>{const{data:{rate:t,...n},...i}=null!=e?e:{data:{}};return{data:{bitrate:t,...n},...i}}}],[pc.RemoteControlApprovedChange]:[{event:tc,payload:e=>({state:e?za.Approved:za.Rejected})}],[pc.RemoteControlInControlChange]:[{event:nc,payload:e=>({isControlling:e})}],[pc.RemoteControlClipboardChange]:[{event:ic,payload:e=>e}],[pc.RemoteControlRequestChange]:[{event:lc,payload:e=>e}],[pc.RemoteControlAppStatusChange]:[{event:cc,payload:e=>e}],[pc.RemoteControlControlledStatusChange]:[{event:dc,payload:e=>e}]};let gc=function(e){return e.Question="question",e.UpdateQuestion="updateQuestion",e.Answer="answer",e.DeleteComment="deleteComment",e.DeleteQuestion="deleteQuestion",e.Dismiss="dismiss",e.Reopen="reopen",e.Upvote="upvote",e.AnswerLive="answerLive",e}({}),mc=function(e){return e.QaSettingChange="qa-setting-change",e.QaActionChange="qa-action-change",e}({});const vc={[mc.QaSettingChange]:[{event:"QA_SETTING_OPTION_CHANGE",payload:e=>e}],[mc.QaActionChange]:[{event:"QA_NEW_ASK_QUESTION",payload:e=>({action:gc.Question,data:e})},{event:"QA_UPDATE_ANONYMOUS_QUESTION",payload:e=>({action:gc.UpdateQuestion,data:e})},{event:"QA_ANSWER_QUESTION",payload:e=>({action:gc.Answer,data:e})},{event:"QA_ANSWER_REMOVE_COMMENT",payload:e=>({action:gc.DeleteComment,data:e})},{event:"QA_ANSWER_REMOVE_QUESTION",payload:e=>({action:gc.DeleteQuestion,data:e})},{event:"QA_ANSWER_DISMISS_QUESTION",payload:e=>({action:gc.Dismiss,data:e})},{event:"QA_ANSWER_REOPEN_QUESTION",payload:e=>({action:gc.Reopen,data:e})},{event:"QA_ANSWER_VOTE_QUESTION",payload:e=>({action:gc.Upvote,data:e})},{event:"QA_ANSWER_QUESTION_LIVE",payload:e=>({action:gc.AnswerLive,data:e})}]},yc="INVALID_OPERATION",Sc="INTERNAL_ERROR",bc="OPERATION_TIMEOUT",Ec="INSUFFICIENT_PRIVILEGES",wc="IMPROPER_MEETING_STATE",_c="INVALID_PARAMETERS",Ic="AUDIO_ENCODE_SUCCESS",Cc="AUDIO_DECODE_SUCCESS",Ac="VIDEO_ENCODE_SUCCESS",Tc="VIDEO_DECODE_SUCCESS",Rc="SHARING_ENCODE_SUCCESS",Oc="SHARING_DECODE_SUCCESS",Pc="AUDIO_ENCODE_FAIL",Dc="AUDIO_DECODE_FAIL",kc="VIDEO_ENCODE_FAIL",xc="VIDEO_DECODE_FAIL",Nc="SHARING_ENCODE_FAIL",Mc="SHARING_DECODE_FAIL",Fc="MEDIA_DEVICE_CHANGE",Lc="MEDIS_SDK_PATHCH_LOADED",Vc="AUDIO_BRIDGE_PEER_CONNECTION_RECEIVE_READY",jc="AUDIO_BRIDGE_PEER_CONNECTION_SEND_READY",Bc="DEVICE_PERMISSION_CHANGE";let Uc=function(e){return e.DeviceChange="device-change",e.MediaSDKChange="media-sdk-change",e.DevicePermissionChange="device-permission-change",e}({});const Hc={[Uc.DeviceChange]:[{event:Fc,payload:()=>({})}],[Uc.MediaSDKChange]:[{event:Ic,payload:()=>({type:"audio",action:"encode",result:"success"})},{event:Pc,payload:()=>({type:"audio",action:"encode",result:"fail"})},{event:Cc,payload:()=>({type:"audio",action:"decode",result:"success"})},{event:Dc,payload:()=>({type:"audio",action:"decode",result:"fail"})},{event:Ac,payload:()=>({type:"video",action:"encode",result:"success"})},{event:kc,payload:()=>({type:"video",action:"encode",result:"fail"})},{event:Tc,payload:()=>({type:"video",action:"decode",result:"success"})},{event:xc,payload:()=>({type:"video",action:"decode",result:"fail"})},{event:Rc,payload:()=>({type:"share",action:"encode",result:"success"})},{event:Nc,payload:()=>({type:"share",action:"encode",result:"fail"})},{event:Oc,payload:()=>({type:"share",action:"decode",result:"success"})},{event:Mc,payload:()=>({type:"share",action:"decode",result:"fail"})}],[Uc.DevicePermissionChange]:[{event:Bc,payload:e=>e}]},qc="BREAKOUT_ROOM_ADD_TOKEN",Kc="BREAKOUT_ROOM_INVITE_TO_JOIN_NOTIFICATION",$c="BREAKOUT_ROOM_ROOM_CLOSING_COUNTDOWN",Wc="BREAKOUT_ROOM_ROOM_COUTDOWN",Gc="BREAKOUT_ROOM_BROADCAST_MESSAGE",zc="BREAKOUT_ROOM_ASK_HELP_REQUEST",Jc="BREAKOUT_ROOM_ASK_HELP_RESPONSE",Qc="BREAKOUT_ROOM_ATTRIBUTE_INDICATION",Yc="BREAKOUT_ROOM_JOIN_BO_RESPONSE",Zc="BREAKOUT_ROOM_ROOM_COUNTDOWN_TIME_UP",Xc="BREAKOUT_ROOM_CURRENT_USER_PARTICIPANT_ROLE",ed="BREAKOUT_ROOM_LOAD_PRE_ASSIGNED_ROOMS",td="BREAKOUT_ROOM_MAIN_SESSION_USER_UPDATE",nd="BREAKOUT_ROOM_INVITE_TO_BACK_NOTIFICATION",id="BREAKOUT_ROOM_IN_ROOM_USER_STATUS_UPDATE",rd="BREAKOUT_ROOM_BROADCAST_VOICE";let od=function(e){return e.InviteToJoin="invite-to-join",e.RoomCountdown="room-countdown",e.RoomTimeUp="room-time-up",e.ClosingRoomCountdown="closing-room-countdown",e.BroadcastMessage="broadcast-message",e.AskForHelp="ask-for-help",e.AskForHelpResponse="ask-for-help-response",e.RoomStateChange="room-state-change",e.MainSessionUserUpdate="main-session-user-updated",e.InviteToBack="invite-back-to-main-session",e.RoomUserUpdate="room-user-update",e.BroadcastVoice="broadcast-voice",e}({});const sd={[od.InviteToJoin]:[{event:Kc,payload:e=>e}],[od.RoomCountdown]:[{event:Wc,payload:e=>e}],[od.RoomTimeUp]:[{event:Zc,payload:e=>e}],[od.ClosingRoomCountdown]:[{event:$c,payload:e=>e}],[od.BroadcastMessage]:[{event:Gc,payload:e=>e}],[od.AskForHelp]:[{event:zc,payload:e=>e}],[od.AskForHelpResponse]:[{event:Jc,payload:e=>e}],[od.RoomStateChange]:[{event:Qc,payload:e=>({status:e.controlStatus})}],[od.MainSessionUserUpdate]:[{event:td,payload:()=>({})}],[od.InviteToBack]:[{event:nd,payload:e=>e}],[od.RoomUserUpdate]:[{event:id,payload:e=>e}],[od.BroadcastVoice]:[{event:rd,payload:e=>e}]};var ad=function(e){return e.StatusUpdate="archiving-status-update",e.OptionsUpdate="archiving-options-update",e}(ad||{});const ud={[ad.StatusUpdate]:[{event:"ARCHIVING_STATUS_UPDATE",payload:e=>e}],[ad.OptionsUpdate]:[{event:"ARCHIVING_OPTIONS_UPDATE",payload:e=>e}]};let ld=function(e){return e.PollDataChange="poll-data-change",e.PollSizeUpdate="poll-size-update",e.PollStatusUpdate="poll-status-update",e}({});const cd={[ld.PollDataChange]:[{event:"POLL_DATA_CHANGE",payload:e=>e}],[ld.PollSizeUpdate]:[{event:"POLL_SIZE_UPDATE",payload:e=>e}],[ld.PollStatusUpdate]:[{event:"POLL_STATUS_UPDATE",payload:e=>e}]};let dd=function(e){return e.ReactionReceived="reaction-received",e.ReactionRemoved="reaction-removed",e}({});const hd={[dd.ReactionReceived]:[{event:"REACTION_RECEIVED",payload:e=>e}],[dd.ReactionRemoved]:[{event:"REACTION_REMOVED",payload:e=>e}]},pd="SMART_SUMMARY_STATUS_CHANGE",fd="MEETING_QUERY_STATUS_CHANGE";let gd=function(e){return e.SummaryChange="summary-status-change",e.MeetingQueryChang="meeting-query-status-change",e}({});const md={[gd.SummaryChange]:[{event:pd,payload:e=>e}],[gd.MeetingQueryChang]:[{event:fd,payload:e=>e}]},vd="LIVE_STREAM_STATUS_CHANGE",yd={"live-stream-status":[{event:vd,payload:e=>e}]},Sd={...ea,...oa,...pa,...va,...Pa,...Ul,...cl,...vc,...fc,...Hc,...sd,...ud,"closed-caption-message":[{event:"CC_RECEIVE_MESSAGE",payload:e=>e}],"closed-caption-lt-status":[{event:"LT_STATUS_CHANGE",payload:e=>e}],"closed-caption-lt-message":[{event:"LT_RECEIVE_MESSAGE",payload:e=>e}],"closed-caption-status":[{event:"CC_ASSIGN_CC_EDITOR_SUCCESS",payload:e=>e},{event:"CC_STATUS_CHANGE",payload:e=>e}],...cd,...hd,...md,...yd},bd=function(e){return{all:e=e||new Map,on:function(t,n){var i=e.get(t);i?i.push(n):e.set(t,[n])},off:function(t,n){var i=e.get(t);i&&(n?i.splice(i.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var i=e.get(t);i&&i.slice().map((function(e){e(n)})),(i=e.get("*"))&&i.slice().map((function(e){e(t,n)}))}}}(),Ed=new Map,wd=new Array,_d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;bd.emit(e,t)},Id=e=>new Promise(((t,n)=>{e.fail&&e.fail.length>0?pt(rt(bd,e.success).pipe(gt(1)),lt(...e.fail.map((e=>rt(bd,e).pipe(gt(1),Ye((t=>Le({type:e,payload:t})))))))).subscribe((e=>t(e)),(e=>{"object"==typeof e.payload?n({type:e.type,...e.payload}):void 0===e.payload?n({type:e.type}):n(e)})):rt(bd,e.success).pipe(gt(1)).subscribe((e=>t(e)))})),Cd=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;return new Promise(((i,r)=>{let o=ge;"string"==typeof e?o=rt(bd,e).pipe(gt(1)):(o=rt(bd,e.event),e.operations&&(o=e.operations.reduce(((e,t)=>e.pipe(t)),o))),pt(o,at(n).pipe(St(Le("timeout")))).subscribe((e=>{if(t){const n=t(e);"boolean"==typeof n?n?i(""):r({type:Sc}):0===n.ret?i(n.body):r({type:Sc,reason:n.body})}else i(e)}),(()=>{r({type:bc})}))}))},Ad=(e,t)=>void 0!==t?rt(bd,e).pipe(gt(t)):rt(bd,e),Td=()=>{wd.forEach((e=>{e.unsubscribe()})),wd.length=0,Ed.clear()},{setAttendeesList:Rd,setAssistantList:Od,setIsAdmitAllSilentUsers:Pd,resetParticipants:Dd,addFailoverAttendees:kd,removeFailoverAttendees:xd,setClearRaiseHand:Nd,setClearAttendeeFeedback:Md,updateAttendeeDisplayName:Fd,removeXmppAttendeeUser:Ld,updateXmppAttendeeList:Vd,setAttendeeExtraKey:jd}=_n({SET_ATTENDEES_LIST:e=>e,SET_ASSISTANT_LIST:e=>e,UPDATE_XMPP_ATTENDEE_LIST:e=>e,RESET_PARTICIPANTS:()=>({}),SET_IS_ADMIT_ALL_SILENT_USERS:e=>e,REMOVE_FAILOVER_ATTENDEES:e=>e,ADD_FAILOVER_ATTENDEES:e=>e,SET_CLEAR_RAISE_HAND:()=>({}),SET_CLEAR_ATTENDEE_FEEDBACK:()=>({}),UPDATE_ATTENDEE_DISPLAY_NAME:e=>e,REMOVE_XMPP_ATTENDEE_USER:e=>e,SET_ATTENDEE_EXTRA_KEY:e=>e});var Bd="NOT_FOUND",Ud=function(e,t){return e===t};function Hd(e,t){var n,i,r="object"==typeof t?t:{equalityCheck:t},o=r.equalityCheck,s=void 0===o?Ud:o,a=r.maxSize,u=void 0===a?1:a,l=r.resultEqualityCheck,c=function(e){return function(t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var i=t.length,r=0;r<i;r++)if(!e(t[r],n[r]))return!1;return!0}}(s),d=1===u?(n=c,{get:function(e){return i&&n(i.key,e)?i.value:Bd},put:function(e,t){i={key:e,value:t}},getEntries:function(){return i?[i]:[]},clear:function(){i=void 0}}):function(e,t){var n=[];function i(e){var i=n.findIndex((function(n){return t(e,n.key)}));if(i>-1){var r=n[i];return i>0&&(n.splice(i,1),n.unshift(r)),r.value}return Bd}return{get:i,put:function(t,r){i(t)===Bd&&(n.unshift({key:t,value:r}),n.length>e&&n.pop())},getEntries:function(){return n},clear:function(){n=[]}}}(u,c);function h(){var t=d.get(arguments);if(t===Bd){if(t=e.apply(null,arguments),l){var n=d.getEntries().find((function(e){return l(e.value,t)}));n&&(t=n.value)}d.put(arguments,t)}return t}return h.clearCache=function(){return d.clear()},h}function qd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var o,s=0,a={memoizeOptions:void 0},u=i.pop();if("object"==typeof u&&(a=u,u=i.pop()),"function"!=typeof u)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof u+"]");var l=a.memoizeOptions,c=void 0===l?n:l,d=Array.isArray(c)?c:[c],h=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return"function"==typeof e?"function "+(e.name||"unnamed")+"()":typeof e})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return t}(i),p=e.apply(void 0,[function(){return s++,u.apply(null,arguments)}].concat(d)),f=e((function(){for(var e=[],t=h.length,n=0;n<t;n++)e.push(h[n].apply(null,arguments));return o=p.apply(null,e)}));return Object.assign(f,{resultFunc:u,memoizedResultFunc:p,dependencies:h,lastResult:function(){return o},recomputations:function(){return s},resetRecomputations:function(){return s=0}}),f}}var Kd=qd(Hd);const $d=e=>{let{participants:{attendeesList:t}}=e;return t},Wd=e=>{let{meeting:{userId:t}}=e;return t},Gd=e=>{let{participants:{xmppAttendeeList:t}}=e;return t};let zd=function(e){return e[e.Attendee=0]="Attendee",e[e.Host=1]="Host",e[e.Owner=4]="Owner",e[e.ViewOnly=8]="ViewOnly",e[e.HostOwner=5]="HostOwner",e[e.ViewOnlyCanTalk=24]="ViewOnlyCanTalk",e}({}),Jd=function(e){return e[e.Host=10]="Host",e[e.Panelist=20]="Panelist",e[e.Attendee=30]="Attendee",e}({}),Qd=function(e){return e[e.Client=9]="Client",e[e.Phone=5]="Phone",e[e.H323=15]="H323",e[e.Assitant=51]="Assitant",e}({});const Yd=e=>(e&zd.Host)===zd.Host,Zd=e=>(e&Qd.Phone)===Qd.Phone,Xd=e=>e===zd.ViewOnlyCanTalk,eh=e=>(e&zd.ViewOnly)===zd.ViewOnly;let th=function(e){return e[e.Automatically=1]="Automatically",e[e.Manually=2]="Manually",e[e.SelfSelect=3]="SelfSelect",e}({}),nh=function(e){return e[e.NotStarted=1]="NotStarted",e[e.InProgress=2]="InProgress",e[e.Closing=3]="Closing",e[e.Closed=4]="Closed",e}({}),ih=function(e){return e[e.NoToken=1]="NoToken",e[e.GotToken=2]="GotToken",e[e.Started=3]="Started",e[e.Closing=4]="Closing",e[e.Closed=5]="Closed",e}({}),rh=function(e){return e.Initial="initial",e.Invited="invited",e.Joining="joining",e.InRoom="in room",e.Leaving="leaving",e.TimeUp="time up",e.MainSession="main session",e}({}),oh=function(e){return e.Join="joinRequest",e.Switch="switchRequest",e.Leave="leaveRequest",e.Broadcast="messageText",e.HelpReq="helpRequest",e.HelpRes="helpResponse",e.CoHostWantJoinThisBo="wantJoinThisBO",e.BOActivity="BOActivity",e}({});const sh="Subsession";let ah=function(e){return e[e.Received=0]="Received",e[e.Busy=1]="Busy",e[e.Ignore=2]="Ignore",e[e.AlreadyInRoom=3]="AlreadyInRoom",e}({}),uh=function(e){return e[e.AskToLeave=0]="AskToLeave",e[e.ClosingRoom=1]="ClosingRoom",e}({}),lh=function(e){return e[e.Active=0]="Active",e[e.Ask=1]="Ask",e}({}),ch=function(e){return e[e.Connect=1]="Connect",e[e.Muted=2]="Muted",e[e.Voip=4]="Voip",e}({}),dh=function(e){return e[e.Connect=8]="Connect",e[e.On=16]="On",e}({}),hh=function(e){return e[e.Share=32]="Share",e[e.ShareAudio=64]="ShareAudio",e}({});const ph=e=>{let{breakoutRoom:t}=e;return t&&t.controlStatus},fh=e=>{let{breakoutRoom:t}=e;return t&&t.currentRoom.status},gh=Kd([Wd,$d],((e,t)=>t.find((t=>t.userId===e)))),mh=Kd([gh],(e=>(null==e?void 0:e.isHost)||(null==e?void 0:e.bCoHost))),vh=Kd([gh],(e=>null==e?void 0:e.isHost)),yh=Kd([Gd],(e=>e.filter((e=>e.userRole===Jd.Attendee)))),Sh=Kd([$d],(e=>e.filter((e=>e.bHold&&!e.bid)))),bh=Kd([$d,ph,fh],((e,t,n)=>t!==nh.InProgress&&t!==nh.Closing||n!==rh.InRoom?e.filter((e=>!e.bHold&&!e.bid)):e.filter((e=>!e.bHold)))),Eh=Kd([e=>{let{participants:{assistantList:t}}=e;return t}],(e=>e)),wh=Kd([bh],(e=>e.find((e=>e.isHost)))),_h=Kd([bh],(e=>e.filter((e=>e.bCoHost)))),Ih=Kd([gh,bh],((e,t)=>t.filter((t=>t.userId!==(null==e?void 0:e.userId)))));Kd([Gd],(e=>e.reduce(((e,t)=>{const{jid:n}=t;return Object.assign(e,{[n]:t}),e}),{}))),Kd([Gd,e=>{let{meeting:{jid:t}}=e;return t}],((e,t)=>{var n;return null===(n=e.find((e=>e.jid===t)))||void 0===n?void 0:n.userId}));const Ch=Kd([$d],(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).some((e=>(null==e?void 0:e.bLocalRecord)===ba.Start))})),Ah=Kd([ph,e=>{let{meeting:t}=e;return t&&t.meetingOptions},$d,vh],((e,t,n,i)=>{const r=n.filter((e=>e.bCoHost)),{moveToWRIfHostLeave:o}=t,s=e===nh.InProgress;return i&&!!o&&r.length<=0&&!s&&n.length>1}));Kd([$d,fh,e=>{let{breakoutRoom:t}=e;return t&&t.mainSessionAttendeeList}],((e,t,n)=>(t===rh.InRoom?n:e).filter((e=>{return!(e.bHold||e.isHost||e.audio===yu.Phone||Zd(null==e?void 0:e.userType)||(t=null==e?void 0:e.caps,n=null==e?void 0:e.bMultiStreamVideoUser,((e,t)=>(e=>!!(128&e))(e)&&void 0!==t)(t,n)&&n));var t,n}))));let Th=function(e){return e.Closed="closed",e.Connecting="connecting",e.Connected="connected",e}({});function Rh(e){return 1<<e-1}let Oh=function(e){return e[e.SupportASL=Rh(1)]="SupportASL",e[e.SidecarPhase2=Rh(2)]="SidecarPhase2",e[e.SupportBroadcastVoice=Rh(4)]="SupportBroadcastVoice",e[e.SendMeetingTokenSeparately=Rh(5)]="SendMeetingTokenSeparately",e[e.SupportPreview=Rh(6)]="SupportPreview",e[e.WebCameraIndication=Rh(7)]="WebCameraIndication",e[e.SupportFarEndCameraControl=Rh(9)]="SupportFarEndCameraControl",e[e.SupportVideoShare=Rh(10)]="SupportVideoShare",e[e.UnifyErrorType=Rh(11)]="UnifyErrorType",e[e.WhiteBoard=Rh(12)]="WhiteBoard",e[e.RequestRemoteControl=Rh(14)]="RequestRemoteControl",e[e.SmartSummary=Rh(15)]="SmartSummary",e[e.LocalRecording=Rh(16)]="LocalRecording",e[e.LocalRecordingGrantPermission=Rh(17)]="LocalRecordingGrantPermission",e[e.ShareMultiStream=Rh(18)]="ShareMultiStream",e[e.VideoLTR=Rh(19)]="VideoLTR",e[e.WebrtcAudioRtcpTime=Rh(20)]="WebrtcAudioRtcpTime",e[e.SupportSend1080PVideo=Rh(29)]="SupportSend1080PVideo",e[e.SupportSend1080PVideoShare=Rh(30)]="SupportSend1080PVideoShare",e}({});const{setAsnIds:Ph,setIsCanUnmute:Dh,setDialoutSequence:kh,setDialoutResultCode:xh,setIsAllowToTalk:Nh,setAudioSsrc:Mh,setIsMutedUponEntry:Fh,setIsUserGrantCaptureAudio:Lh,setIsMicrophoneForbidden:Vh,setWebrtcRestartCount:jh,setMicrophoneList:Bh,setSpeakerList:Uh,setActiveMicrophone:Hh,setActiveSpeaker:qh,setCanPlayAudio:Kh,resetAudio:$h,setIsComputerAudioLoading:Wh,setIsAllowToTalkAttendeeConnected:Gh,setIsMuteBeforeSharingAudio:zh,addLocalShareAudioUser:Jh,updateLocalShareAudioUser:Qh,setIsJoinComputerAudioBeforeSharingAudio:Yh,setIsShareAudioEnabled:Zh,setIsShareAudioMuted:Xh,setIsSharingAudio:ep,setAudioDataEncoding:tp,setAudioDataDecoding:np,addLocallyMutedAudio:ip,removeLocallyMutedAudio:rp,updateUserAudioVolumeLocally:op,removeLocalUserAudioVolume:sp,setCustomizedAudioOption:ap,setIsBackgroundNoiseSuppression:up,setIsHidEnabled:lp,setAudioMediaPlaybackFile:cp,setIsStopAllIncomingAudio:dp,setIsVerifiedAudioPermissionOnIosMobile:hp,setIsAudioBridgeSignalReconnecting:pp,setAudioMutedSource:fp,setAudioUnmutedSource:gp,setAudioOriginalSound:mp,setLeaveAudioSource:vp,setSecondaryAudioMicrophoneId:yp,setCrcCallOutSequence:Sp,setCrcCallOutReturnCode:bp}=_n("SET_ASN_IDS","SET_IS_CAN_UNMUTE","SET_DIALOUT_SEQUENCE","SET_DIALOUT_RESULT_CODE","SET_IS_ALLOW_TO_TALK","SET_AUDIO_SSRC","SET_IS_MUTED_UPON_ENTRY","SET_IS_USER_GRANT_CAPTURE_AUDIO","SET_IS_MICROPHONE_FORBIDDEN","SET_WEBRTC_RESTART_COUNT","SET_MICROPHONE_LIST","SET_SPEAKER_LIST","SET_ACTIVE_MICROPHONE","SET_ACTIVE_SPEAKER","SET_CAN_PLAY_AUDIO","RESET_AUDIO","SET_IS_COMPUTER_AUDIO_LOADING","SET_IS_ALLOW_TO_TALK_ATTENDEE_CONNECTED","SET_IS_MUTE_BEFORE_SHARING_AUDIO","SET_IS_SHARING_AUDIO","ADD_LOCAL_SHARE_AUDIO_USER","UPDATE_LOCAL_SHARE_AUDIO_USER","SET_IS_JOIN_COMPUTER_AUDIO_BEFORE_SHARING_AUDIO","SET_IS_SHARE_AUDIO_ENABLED","SET_IS_SHARE_AUDIO_MUTED","SET_AUDIO_DATA_ENCODING","SET_AUDIO_DATA_DECODING","ADD_LOCALLY_MUTED_AUDIO","REMOVE_LOCALLY_MUTED_AUDIO","UPDATE_USER_AUDIO_VOLUME_LOCALLY","REMOVE_LOCAL_USER_AUDIO_VOLUME","SET_CUSTOMIZED_AUDIO_OPTION","SET_IS_BACKGROUND_NOISE_SUPPRESSION","SET_IS_HID_ENABLED","SET_AUDIO_MEDIA_PLAYBACK_FILE","SET_IS_STOP_ALL_INCOMING_AUDIO","SET_IS_VERIFIED_AUDIO_PERMISSION_ON_IOS_MOBILE","SET_IS_AUDIO_BRIDGE_SIGNAL_RECONNECTING","SET_AUDIO_MUTED_SOURCE","SET_AUDIO_UNMUTED_SOURCE","SET_AUDIO_ORIGINAL_SOUND","SET_LEAVE_AUDIO_SOURCE","SET_SECONDARY_AUDIO_MICROPHONE_ID","SET_CRC_CALL_OUT_SEQUENCE","SET_CRC_CALL_OUT_RETURN_CODE"),{setSharePrivilege:Ep,setShareActiveNode:wp,setIsReceiveSharing:_p,setIsChromeExtensionInstalled:Ip,setIsScreenShareForbidden:Cp,setShareDimension:Ap,setShareStatus:Tp,setShareSsrc:Rp,setShareQuality:Op,setReceivedShareDimension:Pp,setIsGrabRemoteControl:Dp,setIsSdkGrabControl:kp,setIsReceiveSharingFromMainSession:xp,setIsSharingToBreakoutRoom:Np,setIsSharingWithSecondCamera:Mp,setShringSecondCameraId:Fp,setIsRequireReadReceipt:Lp,setIsOptimizedForSharedVideo:Vp,setShareDataEncoding:jp,setShareDataDecoding:Bp,addShareCapturedEnsuredCanvas:Up,addShareRenderedEnsuredCanvas:Hp,setRemoteControlCurrentSsrc:qp,setRemoteControllingSsrc:Kp,setApprovedRemoteControlSsrc:$p,setRemoteControlAppDownloadUrl:Wp,setRemoteControlAppInstallStatus:Gp,remoteControlAppStatusFallbackCheck:zp,remoteControlAppLaunchedCheck:Jp,setIsEnableAutoDeleteRcApp:Qp,setRemoteControlAppLaunchSheme:Yp,addSharingUserIdSsrcMapping:Zp,addRemoteControlledUser:Xp,removeRemoteControlledUser:ef,setRemoteControlSetting:tf,setRemoteControlViewportDomSelector:nf,setIsFullHdVideoShareEnabled:rf,resetShare:of}=_n("SET_SHARE_PRIVILEGE","SET_SHARE_ACTIVE_NODE","SET_IS_RECEIVE_SHARING","SET_IS_CHROME_EXTENSION_INSTALLED","SET_IS_SCREEN_SHARE_FORBIDDEN","SET_SHARE_DIMENSION","SET_SHARE_STATUS","SET_SHARE_SSRC","SET_SHARE_QUALITY","SET_RECEIVED_SHARE_DIMENSION","SET_IS_GRAB_REMOTE_CONTROL","SET_IS_SDK_GRAB_CONTROL","SET_IS_RECEIVE_SHARING_FROM_MAIN_SESSION","SET_IS_SHARING_TO_BREAKOUT_ROOM","SET_IS_SHARING_WITH_SECOND_CAMERA","SET_SHRING_SECOND_CAMERA_ID","SET_IS_REQUIRE_READ_RECEIPT","SET_IS_OPTIMIZED_FOR_SHARED_VIDEO","SET_SHARE_DATA_ENCODING","SET_SHARE_DATA_DECODING","ADD_SHARE_CAPTURED_ENSURED_CANVAS","ADD_SHARE_RENDERED_ENSURED_CANVAS","SET_REMOTE_CONTROL_CURRENT_SSRC","SET_REMOTE_CONTROLLING_SSRC","SET_APPROVED_REMOTE_CONTROL_SSRC","SET_REMOTE_CONTROL_APP_DOWNLOAD_URL","SET_REMOTE_CONTROL_APP_INSTALL_STATUS","REMOTE_CONTROL_APP_STATUS_FALLBACK_CHECK","REMOTE_CONTROL_APP_LAUNCHED_CHECK","SET_IS_ENABLE_AUTO_DELETE_RC_APP","SET_REMOTE_CONTROL_APP_LAUNCH_SHEME","ADD_SHARING_USER_ID_SSRC_MAPPING","ADD_REMOTE_CONTROLLED_USER","REMOVE_REMOTE_CONTROLLED_USER","SET_REMOTE_CONTROL_SETTING","SET_REMOTE_CONTROL_VIEWPORT_DOM_SELECTOR","SET_IS_FULL_HD_VIDEO_SHARE_ENABLED","RESET_SHARE"),{setVideoSsrc:sf,setActiveVideoId:af,setCameraList:uf,setActiveCamera:lf,setIsCurrentUserStartedVideo:cf,setSpotlightVideo:df,setIsCaptureForbidden:hf,setVideoMaxQuality:pf,setIsVideoMuted:ff,setIsCaptureCameraLoading:gf,setIsCameraTaken:mf,resetVideo:vf,setReceivedVideoDimension:yf,addSubscribedVideoId:Sf,removeSubscribedVideoId:bf,setIsFollowHostVideoLayout:Ef,setHostDragLayout:wf,addRenderedVideoId:_f,removeRenderedVideoId:If,setIsSupportHdVideo:Cf,setMaximumNumbeOfHdSubscriptions:Af,setIsCanUnmuteVideo:Tf,setIsVbPreloadReady:Rf,setIsVbConfiged:Of,setVbImageSrc:Pf,setVideoDataEncoding:Df,setVideoDataDecoding:kf,setHardwareAccelerationState:xf,setVideoCaptureCustomizedOption:Nf,setNetworkQuality:Mf,setVideoCameraPtzCapabilities:Ff,setIsCurrentUserRequestCameraControlled:Lf,setIsCurrentUserCameraInControl:Vf,addVideoFarEndCameraControlUser:jf,removeVideoFarEndCameraControlUser:Bf,setVideoPtzCameraMoving:Uf,setVideoPtzCameraValue:Hf,setIsControllingFarEndCamera:qf,setNetworkQualityBroadcastTime:Kf,setIsMaskConfiged:$f,setVideoBackgroundMode:Wf,setVideoMask:Gf,setVideoCapturedDimension:zf,addVideoRenderedEnsuredCanvas:Jf,setVideoMediaPlaybackFile:Qf,setPrefetchedVideoUser:Yf,setVideoQosSubscriptionStatus:Zf,setIsSupportFullHdVideo:Xf,addVideoPlayerAttachment:eg,removeVideoPlayerAttachment:tg,setIsWebGl2RendererType:ng,setIsWebGpuRendererType:ig,setVideoRendererType:rg,setIsVideoMirrored:og,addSelfPreviewVideoTag:sg,removeSelfPreviewVideoTag:ag}=_n("SET_VIDEO_SSRC","SET_ACTIVE_VIDEO_ID","SET_CAMERA_LIST","SET_ACTIVE_CAMERA","SET_IS_CURRENT_USER_STARTED_VIDEO","SET_SPOTLIGHT_VIDEO","SET_IS_CAPTURE_FORBIDDEN","SET_VIDEO_MAX_QUALITY","SET_IS_VIDEO_MUTED","SET_IS_CAPTURE_CAMERA_LOADING","SET_IS_CAMERA_TAKEN","RESET_VIDEO","SET_RECEIVED_VIDEO_DIMENSION","ADD_SUBSCRIBED_VIDEO_ID","REMOVE_SUBSCRIBED_VIDEO_ID","SET_IS_FOLLOW_HOST_VIDEO_LAYOUT","SET_HOST_DRAG_LAYOUT","ADD_RENDERED_VIDEO_ID","REMOVE_RENDERED_VIDEO_ID","SET_IS_SUPPORT_HD_VIDEO","SET_MAXIMUM_NUMBE_OF_HD_SUBSCRIPTIONS","SET_IS_CAN_UNMUTE_VIDEO","SET_IS_VB_PRELOAD_READY","SET_IS_VB_CONFIGED","SET_VB_IMAGE_SRC","SET_VIDEO_DATA_ENCODING","SET_VIDEO_DATA_DECODING","SET_HARDWARE_ACCELERATION_STATE","SET_VIDEO_CAPTURE_CUSTOMIZED_OPTION","SET_NETWORK_QUALITY","SET_VIDEO_CAMERA_PTZ_CAPABILITIES","SET_IS_CURRENT_USER_REQUEST_CAMERA_CONTROLLED","SET_IS_CURRENT_USER_CAMERA_IN_CONTROL","ADD_VIDEO_FAR_END_CAMERA_CONTROL_USER","REMOVE_VIDEO_FAR_END_CAMERA_CONTROL_USER","SET_VIDEO_PTZ_CAMERA_MOVING","SET_VIDEO_PTZ_CAMERA_VALUE","SET_IS_CONTROLLING_FAR_END_CAMERA","SET_NETWORK_QUALITY_BROADCAST_TIME","SET_IS_MASK_CONFIGED","SET_VIDEO_BACKGROUND_MODE","SET_VIDEO_MASK","SET_VIDEO_CAPTURED_DIMENSION","ADD_VIDEO_RENDERED_ENSURED_CANVAS","SET_VIDEO_MEDIA_PLAYBACK_FILE","SET_PREFETCHED_VIDEO_USER","SET_VIDEO_QOS_SUBSCRIPTION_STATUS","SET_IS_SUPPORT_FULL_HD_VIDEO","ADD_VIDEO_PLAYER_ATTACHMENT","REMOVE_VIDEO_PLAYER_ATTACHMENT","SET_IS_WEB_GL2_RENDERER_TYPE","SET_IS_WEB_GPU_RENDERER_TYPE","SET_VIDEO_RENDERER_TYPE","SET_IS_VIDEO_MIRRORED","ADD_SELF_PREVIEW_VIDEO_TAG","REMOVE_SELF_PREVIEW_VIDEO_TAG"),{setQaSetting:ug,addQaQuestion:lg,addQaAnswer:cg,removeQaComment:dg,removeQaQuestion:hg,dismissQaQuestion:pg,reopenQaQuestion:fg,voteQaQuestion:gg,answerQaQuestionLive:mg,updateAttendeeAnonymousQuestion:vg,setQaEnabled:yg,resetQa:Sg}=_n("SET_QA_SETTING","ADD_QA_QUESTION","ADD_QA_ANSWER","REMOVE_QA_COMMENT","REMOVE_QA_QUESTION","DISMISS_QA_QUESTION","REOPEN_QA_QUESTION","VOTE_QA_QUESTION","ANSWER_QA_QUESTION_LIVE","UPDATE_ATTENDEE_ANONYMOUS_QUESTION","SET_QA_ENABLED","RESET_QA"),{setChatPrivilege:bg,setPanelistChatPrivilege:Eg,addChatMessageHistory:wg,resetChat:_g,setIsAllowAttendeeChat:Ig,setLatestChatMessageId:Cg,removeChatMessage:Ag,setFileChatSetting:Tg,addChatFileRecord:Rg,updateChatFileRecord:Og,cancelSendFileChat:Pg,addFailedChatFileTransfer:Dg,setChatFileMessageId:kg,cancelDownloadFileChat:xg}=_n("SET_CHAT_PRIVILEGE","SET_PANELIST_CHAT_PRIVILEGE","ADD_CHAT_MESSAGE_HISTORY","RESET_CHAT","SET_IS_ALLOW_ATTENDEE_CHAT","SET_LATEST_CHAT_MESSAGE_ID","REMOVE_CHAT_MESSAGE","SET_FILE_CHAT_SETTING","ADD_CHAT_FILE_RECORD","UPDATE_CHAT_FILE_RECORD","CANCEL_SEND_FILE_CHAT","ADD_FAILED_CHAT_FILE_TRANSFER","SET_CHAT_FILE_MESSAGE_ID","CANCEL_DOWNLOAD_FILE_CHAT"),{setCcEditorInfo:Ng,setTempSendCcText:Mg,setCcLtMessage:Fg,setTempReceiveLtText:Lg,setTempReceiveCcText:Vg,setGatewayInfoList:jg,setLtEnable:Bg,setIsListenClosedCaption:Ug,setCcEnable:Hg,allowParticipantAskLt:qg,receiveAskStartLt:Kg,setMeetingEnabledLtFeature:$g,updateLtStatus:Wg,deleteMessage:Gg,updateMessage:zg,resetClosedCaption:Jg}=_n("SET_CC_EDITOR_INFO","SET_CC_LT_MESSAGE","SET_TEMP_SEND_CC_TEXT","SET_TEMP_RECEIVE_LT_TEXT","SET_TEMP_RECEIVE_CC_TEXT","SET_GATEWAY_INFO_LIST","SET_LT_ENABLE","SET_IS_LISTEN_CLOSED_CAPTION","SET_CC_ENABLE","ALLOW_PARTICIPANT_ASK_LT","RECEIVE_ASK_START_LT","SET_MEETING_ENABLED_LT_FEATURE","UPDATE_LT_STATUS","DELETE_MESSAGE","UPDATE_MESSAGE","RESET_CLOSED_CAPTION"),{addBreakoutRooms:Qg,setBreakoutRoomAllocationPattern:Yg,setBreakoutRoomSequenceId:Zg,setMeetingElapsedTime:Xg,setStartRoomElapsedTime:em,setBreakoutRoomOptions:tm,setBreakoutRoomControlStatus:nm,setBreakoutRooms:im,setCurrentBreakoutRoom:rm,setBreakoutRoomAttendeeStatus:om,setBreakoutRoomConfId:sm,setBreakoutRoomToken:am,resetBreakoutRoom:um,setBreakoutRoomClosingRoomTime:lm,setBreakoutRoomBroadcastMessage:cm,setBreakoutRoomHostReplyType:dm,setBreakoutRoomHostReplyRequestId:hm,setMainSessionAttendeeList:pm,setIsHugeBreakoutRoom:fm,setBreakoutRoomPreAssignedRoomList:gm,setBreakoutRoomUserRoleUpdated:mm,setBreakoutRoomMeetingOptions:vm,setBreakoutRoomUserActivityStatus:ym,setBreakoutRoomIsBroadcastVoice:Sm}=_n("ADD_BREAKOUT_ROOMS","SET_BREAKOUT_ROOM_ALLOCATION_PATTERN","SET_BREAKOUT_ROOM_SEQUENCE_ID","SET_MEETING_ELAPSED_TIME","SET_START_ROOM_ELAPSED_TIME","SET_BREAKOUT_ROOM_OPTIONS","SET_BREAKOUT_ROOM_CONTROL_STATUS","SET_BREAKOUT_ROOMS","SET_CURRENT_BREAKOUT_ROOM","SET_BREAKOUT_ROOM_ATTENDEE_STATUS","SET_BREAKOUT_ROOM_CONF_ID","SET_BREAKOUT_ROOM_TOKEN","RESET_BREAKOUT_ROOM","SET_BREAKOUT_ROOM_CLOSING_ROOM_TIME","SET_BREAKOUT_ROOM_BROADCAST_MESSAGE","SET_BREAKOUT_ROOM_HOST_REPLY_TYPE","SET_BREAKOUT_ROOM_HOST_REPLY_REQUEST_ID","SET_MAIN_SESSION_ATTENDEE_LIST","SET_IS_HUGE_BREAKOUT_ROOM","SET_BREAKOUT_ROOM_PRE_ASSIGNED_ROOM_LIST","SET_BREAKOUT_ROOM_USER_ROLE_UPDATED","SET_BREAKOUT_ROOM_MEETING_OPTIONS","SET_BREAKOUT_ROOM_USER_ACTIVITY_STATUS","SET_BREAKOUT_ROOM_IS_BROADCAST_VOICE"),{setCloudRecordingStatus:bm,setCloudRecordingEnable:Em,setCloudIsoRecordingEnable:wm,setAllowStopAutoRecording:_m,setAutomaticCloudRecordingEnable:Im,setIsZoomIQ:Cm,setZoomIQChanging:Am,setLocalRecordStatus:Tm,setSupportLocalRecording:Rm,setLocalGrantPermissionOption:Om,setLocalPermissionUserList:Pm,resetRecording:Dm}=_n("SET_CLOUD_RECORDING_STATUS","SET_CLOUD_RECORDING_ENABLE","SET_CLOUD_ISO_RECORDING_ENABLE","SET_ALLOW_STOP_AUTO_RECORDING","SET_AUTOMATIC_CLOUD_RECORDING_ENABLE","SET_IS_ZOOM_I_Q","SET_ZOOM_I_Q_CHANGING","SET_LOCAL_RECORD_STATUS","SET_SUPPORT_LOCAL_RECORDING","SET_LOCAL_GRANT_PERMISSION_OPTION","SET_LOCAL_PERMISSION_USER_LIST","RESET_RECORDING"),{updateCmdJid:km,removeCmdJid:xm,setCmdChannelConnectionStatus:Nm,resetCmdChannel:Mm}=_n("UPDATE_CMD_JID","REMOVE_CMD_JID","SET_CMD_CHANNEL_CONNECTION_STATUS","RESET_CMD_CHANNEL"),{setArchivingStatus:Fm,setArchivingSessionReady:Lm,setArchivingOptions:Vm,resetArchiving:jm}=_n({SET_ARCHIVING_STATUS:e=>e,SET_ARCHIVING_SESSION_READY:e=>e,SET_ARCHIVING_OPTIONS:e=>e,RESET_ARCHIVING:()=>{}}),{setIsLiveTranscriptionEnabled:Bm,setLiveTranscriptionMeetingOptions:Um,setIsLiveTranscriptionManualCaptionerEnabled:Hm,setLiveTranscriptionGatewayId:qm,setLiveTranscriptionSupportedLanguage:Km,setIsLiveTranscriptionSubscribed:$m,setCurrentTranscriptionLang:Wm,setCurrentTranslationLang:Gm,addLiveTranscriptionMessage:zm,updateLiveTranscriptionMessage:Jm,reduceLiveTranscriptionMessages:Qm,setLiveTranscriptionEngineType:Ym,removeLiveTranscriptionFailoverState:Zm,setLiveTranscriptionLastCaptionMessage:Xm,resetLiveTranscription:ev,setIsHostDisableCaptions:tv}=_n("SET_IS_LIVE_TRANSCRIPTION_ENABLED","SET_LIVE_TRANSCRIPTION_MEETING_OPTIONS","SET_IS_LIVE_TRANSCRIPTION_MANUAL_CAPTIONER_ENABLED","SET_LIVE_TRANSCRIPTION_GATEWAY_ID","SET_LIVE_TRANSCRIPTION_SUPPORTED_LANGUAGE","SET_IS_LIVE_TRANSCRIPTION_SUBSCRIBED","SET_CURRENT_TRANSCRIPTION_LANG","SET_CURRENT_TRANSLATION_LANG","ADD_LIVE_TRANSCRIPTION_MESSAGE","UPDATE_LIVE_TRANSCRIPTION_MESSAGE","REDUCE_LIVE_TRANSCRIPTION_MESSAGES","SET_LIVE_TRANSCRIPTION_ENGINE_TYPE","REMOVE_LIVE_TRANSCRIPTION_FAILOVER_STATE","SET_LIVE_TRANSCRIPTION_LAST_CAPTION_MESSAGE","RESET_LIVE_TRANSCRIPTION"," SET_IS_HOST_DISABLE_CAPTIONS"),{setPollData:nv,setPollingId:iv,setPollingWebLinks:rv,setPollingDocMaxSize:ov,setPollingDocSize:sv,setPollingDocLibraryMaxSize:av,setPollingDocLibrarySize:uv,resetPoll:lv}=_n("SET_POLL_DATA","SET_POLLING_ID","SET_POLLING_WEB_LINKS","SET_POLLING_DOC_MAX_SIZE","SET_POLLING_DOC_SIZE","SET_POLLING_DOC_LIBRARY_MAX_SIZE","SET_POLLING_DOC_LIBRARY_SIZE","RESET_POLL"),{setLoggerInitOptions:cv,setIsLaplaceInitialized:dv,resetLogger:hv}=_n("SET_LOGGER_INIT_OPTIONS","SET_IS_LAPLACE_INITIALIZED","RESET_LOGGER"),{setIsLiveStreamEnable:pv,setLiveStreamStatus:fv,resetLiveStream:gv}=_n("SET_IS_LIVE_STREAM_ENABLE","SET_LIVE_STREAM_STATUS","RESET_LIVE_STREAM");var mv={exports:{}},vv={};!function(e,t){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},n(e,t)};function i(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var r,o=function(){return o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)},s=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n.buffer},a="/";(r=e.TransformDataFormat||(e.TransformDataFormat={})).STRING="string",r.BLOB="blob",r.ARRAY_BUFFER="arraybuffer";var u=function(e){return Blob&&e instanceof Blob?"blob":ArrayBuffer&&e instanceof ArrayBuffer?"arrayBuffer":typeof e},l=[],c=function(){for(var e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t="",n=0;n<32;n++)t+=e[Math.round(61*Math.random())];return-1!==l.indexOf(t)?c():(l.push(t),t)},d=function(e){return e.arrayBuffer?e.arrayBuffer():new Promise((function(t,n){var i=new FileReader;i.readAsArrayBuffer(e),i.onload=function(e){t(e.target&&e.target.result)},i.onerror=function(e){n(e)}}))},h=function(e){return e.text?e.text():new Promise((function(t,n){var i=new FileReader;i.readAsText(e),i.onload=function(e){t(e.target&&e.target.result)},i.onerror=function(e){n(e)}}))},p=function(e,t){return Promise.resolve(new Blob([new Uint8Array(e)],{type:t}))},f=function(e,t){var n=new Blob([e],{type:t||"text/plain"});return h(n)},g=function(e,t){return Promise.resolve(new Blob([e],{type:t||"text/plain"}))},m=function(e,t){return d(new Blob([e],{type:t||"text/plain"}))};function v(e){var t=(e||"").split(".");return t[t.length-1]||""}function y(e){var t=(e||"").lastIndexOf(a);return t<0?"":e.slice(0,t)}function S(e){var t=(e||"").lastIndexOf(a),n=t<0?e:e.slice(t+1),i=(n||"").lastIndexOf(".");return i<0?n:n.slice(0,i)}function b(e){return["png","jpg","jpeg","svg"].includes(v(e))}function E(e){return"json"===v(e)}function w(e){return"version"===v(e)}function _(e,n){return t.loadAsync(e).then((function(e){return Promise.all(e.filter((function(e,t){return!t.dir})).map((function(e){var t=function(e){return E(e.name)?"string":b(e.name)?"base64":w(e.name)?"text":"blob"}(e);return(null==n?void 0:n.setUnZipFormat)&&(t=n.setUnZipFormat(e)||t),e.async(t).then((function(n){var i=n,r=v(e.name),o="svg"===r?"svg+xml":r;return"base64"===t&&b(e.name)&&!n.startsWith("data")&&(i="data:image/"+o+";base64,"+i),{data:i,file:e}}))})))})).then((function(e){return function(e,t){return e.reduce((function(e,n){var i,r=n.data,o=n.file,s=v(o.name),u=y(o.name),l=S(o.name),c=((null==t?void 0:t.combineExtNames)||[]).includes(s)&&"string"==typeof r,d=c?""+(u?""+u+a+s:s):o.name;return c&&e.some((function(e){return e.path===d&&(e.data[l]=r,!0)}))||e.push({path:d,extName:s,data:c?(i={},i[l]=r,i):r,shouldCombine:c}),e}),[]).map((function(e){var t=e.data,n=e.shouldCombine,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["data","shouldCombine"]);return o(o({},i),{data:n?JSON.stringify(t):t})}))}(e,n)}))}function I(t,n){var i=n||{},r=i.encoding,o=i.blobType,s=i.unZipOptions;if(function(e){return"blob"===u(e)&&(e.type.includes("compressed")||e.type.includes("zip"))}(t)&&!(null==s?void 0:s.disableUnZip))return _(t,s);if(!r)return Promise.resolve(t);var a=u(t),l="string"===a,c="blob"===a,v="arrayBuffer"===a;if(r===e.TransformDataFormat.BLOB){var y=t;if(l)return h(y);if(v)return d(y)}else if(r===e.TransformDataFormat.ARRAY_BUFFER){var S=t;if(l)return f(S,o);if(c)return p(S,o)}else if(r===e.TransformDataFormat.STRING){var b=t;if(c)return g(b,o);if(v)return m(b,o)}return Promise.resolve(t)}function C(e){var t=0,n=!1,i=function(){t>90||n||(e(t+=(100-t)/50),requestAnimationFrame(i))};return i(),{finish:function(){100===t||n||(t=100,e(100))},abort:function(){100===t||n||(n=!0)},get curProgress(){return t}}}function A(){}function T(){T.init.call(this)}function R(e){return void 0===e._maxListeners?T.defaultMaxListeners:e._maxListeners}function O(e,t,n,i){var r,o,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=e._events)?(o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]):(o=e._events=new A,e._eventsCount=0),s){if("function"==typeof s?s=o[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),!s.warned&&(r=R(e))&&r>0&&s.length>r){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,function(e){"function"==typeof console.warn?console.warn(e):console.log(e)}(a)}}else s=o[t]=n,++e._eventsCount;return e}function P(e,t,n){var i=!1;function r(){e.removeListener(t,r),i||(i=!0,n.apply(e,arguments))}return r.listener=n,r}function D(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function k(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}A.prototype=Object.create(null),T.EventEmitter=T,T.usingDomains=!1,T.prototype.domain=void 0,T.prototype._events=void 0,T.prototype._maxListeners=void 0,T.defaultMaxListeners=10,T.init=function(){this.domain=null,T.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new A,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},T.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},T.prototype.getMaxListeners=function(){return R(this)},T.prototype.emit=function(e){var t,n,i,r,o,s,a,u="error"===e;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(t=arguments[1],!a){if(t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var c="function"==typeof n;switch(i=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var i=e.length,r=k(e,i),o=0;o<i;++o)r[o].call(n)}(n,c,this);break;case 2:!function(e,t,n,i){if(t)e.call(n,i);else for(var r=e.length,o=k(e,r),s=0;s<r;++s)o[s].call(n,i)}(n,c,this,arguments[1]);break;case 3:!function(e,t,n,i,r){if(t)e.call(n,i,r);else for(var o=e.length,s=k(e,o),a=0;a<o;++a)s[a].call(n,i,r)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,i,r,o){if(t)e.call(n,i,r,o);else for(var s=e.length,a=k(e,s),u=0;u<s;++u)a[u].call(n,i,r,o)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(i-1),o=1;o<i;o++)r[o-1]=arguments[o];!function(e,t,n,i){if(t)e.apply(n,i);else for(var r=e.length,o=k(e,r),s=0;s<r;++s)o[s].apply(n,i)}(n,c,this,r)}return!0},T.prototype.addListener=function(e,t){return O(this,e,t,!1)},T.prototype.on=T.prototype.addListener,T.prototype.prependListener=function(e,t){return O(this,e,t,!0)},T.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,P(this,e,t)),this},T.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,P(this,e,t)),this},T.prototype.removeListener=function(e,t){var n,i,r,o,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new A:(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,o=n.length;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new A,this;delete i[e]}else!function(e,t){for(var n=t,i=n+1,r=e.length;i<r;n+=1,i+=1)e[n]=e[i];e.pop()}(n,r);i.removeListener&&this.emit("removeListener",e,s||t)}return this},T.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new A,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new A:delete n[e]),this;if(0===arguments.length){for(var i,r=Object.keys(n),o=0;o<r.length;++o)"removeListener"!==(i=r[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new A,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},T.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},T.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):D.call(e,t)},T.prototype.listenerCount=D,T.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var x=function(e){function t(t){var n=e.call(this)||this;return n.timeout=(null==t?void 0:t.timeout)||3e4,n}return i(t,e),t.prototype.clearTimeoutCheck=function(){this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)},t.prototype.startTimeoutCheck=function(){var e=this;!this.timeoutTimer&&!this.finished&&this.timeout>0&&(this.timeoutTimer=setTimeout((function(){e.finished||(e.finished=!0,e.data=null,e.emit("timeout")),e.clearTimeoutCheck()}),this.timeout))},t}(T),N=function(e){function t(t){var n=e.call(this,t)||this;return n.uuid=c(),n.domParams=t||{},n}return i(t,e),t.prototype.jsonp=function(){var e=this;if(!this.finished){var t=this.domParams,n=t.url,i=t.jsonpCallbackName,r=void 0===i?"callback":i,o=t.body,s=t.integrity;this.script=document.createElement("script"),s&&(this.script.integrity=s,this.script.crossOrigin="anonymous");var a="";o&&Object.entries(o).forEach((function(e){var t=e[0],n=e[1];a+=(a?"&":"")+t+"="+n})),a+=(a?"&":"")+r+"="+this.uuid,this.script.src=n+(n.includes("?")?"":"?")+a,this.jsonpCallback(),this.progressMonitory=C((function(t){e.finished||e.emit("progressUpdated",t)})),document.body.appendChild(this.script)}},t.prototype.clearSideEffect=function(e){if(void 0===e&&(e=!1),document.body.removeChild(this.script),e){var t=this.uuid;window[this.uuid]=function(){window[t]&&delete window[t]}}else delete window[this.uuid];this.script=null,this.uuid=null,this.finished=!0,this.data=null,this.clearTimeoutCheck()},t.prototype.jsonpCallback=function(){var e=this;this.script.onerror=function(t){var n;e.finished||(e.clearSideEffect(),null===(n=e.progressMonitory)||void 0===n||n.abort(),e.emit("error",new Error("string"==typeof t?t:"load jsonp script failed")))},window[this.uuid]=function(t){var n;if(!e.finished){var i=e.domParams,r=i.encoding,o=i.blobType,s=i.unZipOptions,a=i.beforeTransformData,u=i.afterTransformData;null===(n=e.progressMonitory)||void 0===n||n.finish(),e.clearSideEffect(),(a?a(t||""):Promise.resolve(t||"")).then((function(t){return I(t,{encoding:r,blobType:o,unZipOptions:s}).then((function(t){return(u?u(t):Promise.resolve(t)).then((function(t){return e.emit("finished",t)}))}))})).catch((function(t){return e.emit("error",t)}))}}},t.prototype.abort=function(){this.clearSideEffect(!0)},t}(x),M=function(e){function t(t){var n=e.call(this,t)||this;return n.socketParams=t||{},n}return i(t,e),t.prototype.write=function(e,t){e&&!this.finished&&(e instanceof Error?this.handleError(e):(this.data?this.appendData(e):this.data=e,this.handlePerCentUpdate(t)))},t.prototype.handlePerCentUpdate=function(e){void 0===e||this.finished||this.emit("progressUpdated",e)},t.prototype.handleError=function(e){this.data=null,this.finished=!0,this.clearTimeoutCheck(),this.emit("error",e)},t.prototype.appendData=function(e){u(e)===u(this.data)?"string"==typeof e?this.data+=e:Blob&&e instanceof Blob?this.data=new Blob([this.data,e],{type:e.type}):ArrayBuffer&&e instanceof ArrayBuffer&&(this.data=s(this.data,e)):this.handleError(new Error("every piece of the data format must be the same"))},t.prototype.end=function(e){var t=this;if(!this.finished){this.handlePerCentUpdate(100),e&&this.write(e);var n=this.socketParams,i=n.encoding,r=n.blobType,o=n.unZipOptions,s=n.beforeTransformData,a=n.afterTransformData;(s?s(this.data):Promise.resolve(this.data)).then((function(e){return I(e,{encoding:i,blobType:r,unZipOptions:o}).then((function(e){return(a?a(e):Promise.resolve(e)).then((function(e){return t.emit("finished",e)}))}))})).catch((function(e){return t.emit("error",e)})),this.data=null,this.finished=!0,this.clearTimeoutCheck()}},t.prototype.abort=function(){this.data=null,this.finished=!0,this.clearTimeoutCheck()},t}(x),F=function(t){function n(e){var n=t.call(this,e)||this;return n.xhrParams=e||{},n.xhrParams.headers=o({},n.xhrParams.headers||{}),n}return i(n,t),n.prototype.supportFetch=function(){return!!window.fetch&&window.AbortController&&window.Request},n.prototype.ajax=function(){var t=this;if(!this.finished)if(this.xhrParams.url){var n=this.xhrParams,i=n.headers,r=void 0===i?{}:i,s=n.url,a=n.body,u=void 0===a?{}:a,l=n.method,c=void 0===l?"POST":l,d=n.encoding,h=n.integrity;this.controller=this.supportFetch()?new AbortController:new XMLHttpRequest;var p=this.supportFetch()?C((function(e){t.finished||t.emit("progressUpdated",e)})):null;(this.supportFetch()?fetch(new Request(s,o({method:c,headers:r,body:"GET"===c?void 0:JSON.stringify(u),signal:this.controller.signal},h?{integrity:h,mode:"cors"}:{}))).then((function(t){return t.ok?d===e.TransformDataFormat.STRING?t.text():d===e.TransformDataFormat.ARRAY_BUFFER?t.arrayBuffer():t.blob():Promise.reject(new Error("xhr download "+s+" failed!"))})):new Promise((function(n,i){var o=new XMLHttpRequest;t.controller=o,o.open(c,s),o.responseType=d===e.TransformDataFormat.STRING?"text":d===e.TransformDataFormat.ARRAY_BUFFER?"arraybuffer":"blob",Object.entries(r).forEach((function(e){var t=e[0],n=e[1];o.setRequestHeader(t,n)})),o.onload=function(){var e=o.status,t=o.response,r=o.statusText;e>=200&&e<300||304===e?n(t):i(new Error(e+": "+r))},o.onprogress=function(e){var n=e||{},i=n.total,r=n.loaded;void 0===r||t.finished||(i?t.emit("progressUpdated",r/i*100):r&&!p&&(p=C((function(e){t.finished||t.emit("progressUpdated",e)}))))},o.onerror=function(){i(new Error("xhr download "+s+" failed!"))},o.send(JSON.stringify(u))}))).then((function(e){if(!t.finished){var n=t.xhrParams,i=n.encoding,r=n.blobType,o=n.unZipOptions,s=n.beforeTransformData,a=n.afterTransformData;null==p||p.finish(),t.finished=!0,t.clearTimeoutCheck(),(s?s(e):Promise.resolve(e)).then((function(e){return I(e,{encoding:i,blobType:r,unZipOptions:o}).then((function(e){return(a?a(e):Promise.resolve(e)).then((function(e){return t.emit("finished",e)}))}))})).catch((function(e){return t.emit("error",e)}))}})).catch((function(e){t.finished||(t.finished=!0,t.clearTimeoutCheck(),null==p||p.abort(),t.emit("error",e))}))}else this.emit("error",new Error("xhrDownloader url params invalid!"))},n.prototype.abort=function(){this.data=null,this.finished=!0,this.clearTimeoutCheck(),this.controller.abort()},n}(x),L=0;T.defaultMaxListeners=500;var V,j=new T,B="ThreadPoolReady",U=function(){L-=1,j.emit(B)};(V=e.DownloaderType||(e.DownloaderType={})).XHR="xhr",V.DOM="dom",V.SOCKET="socket";var H=function(t){function n(n){var i=t.call(this)||this;return i.aborted=!1,i.downloadParmas=o({type:e.DownloaderType.XHR},n),i.id=c(),i}return i(n,t),n.prototype.start=function(){var t=this;L+=1,this.progress=0,this.emit("downloadStart"),this.onDownloadStartCallback&&this.onDownloadStartCallback();var n=this.downloadParmas,i=n.type,r=n.xhrParams,o=n.domParams,s=n.socketParams;switch(i){case e.DownloaderType.DOM:this.downloader=new N(o),this.downloader.jsonp();break;case e.DownloaderType.SOCKET:this.downloader=new M(s);break;default:this.downloader=new F(r),this.downloader.ajax()}return this.downloader.startTimeoutCheck(),this.downloader.on("error",(function(e){t.emit("error",e),t.onErrorCallback&&t.onErrorCallback(e),U()})).on("finished",(function(e){t.emit("complete",e),t.onCompleteCallback&&t.onCompleteCallback(e),U()})).on("progressUpdated",(function(e){t.progress=e,t.emit("progressUpdated",e),t.onProgressUpdatedCallback&&t.onProgressUpdatedCallback(e)})).on("timeout",(function(){t.emit("timeout"),t.onTimeoutCallback&&t.onTimeoutCallback(),U()})),this},n.prototype.abort=function(){if(this.aborted)return this;this.aborted=!0,this.downloader&&!this.downloader.finished&&this.downloader.abort();var e=new Error("file download has been aborted");return this.emit("abort",e),this.onAbortCallback&&this.onAbortCallback(e),U(),this},n.prototype.onDownloadStart=function(e){return this.onDownloadStartCallback=e,this},n.prototype.onProgressUpdated=function(e){return this.onProgressUpdatedCallback=e,this},n.prototype.onError=function(e){return this.onErrorCallback=e,this},n.prototype.onComplete=function(e){return this.onCompleteCallback=e,this},n.prototype.onAbort=function(e){return this.onAbortCallback=e,this},n.prototype.onTimeout=function(e){return this.onTimeoutCallback=e,this},n.prototype.isInProgress=function(){return void 0!==this.progress},n.prototype.isFinished=function(){return 100===this.progress},n}(T),q=function(){function e(e){this.taskList=[],this.options=e||{};var t=this.options.threadLimit;if((void 0===t?6:t)>6)throw new Error("threadLimit must be lower than 6");j.on(B,this.startNextTask.bind(this))}return e.prototype.download=function(e){var t=new H(e),n=this.removeTask.bind(this,t);return t.on("abort",n),this.taskList.push(t),this.checkTaskReady(t),t},e.prototype.startNextTask=function(){var e=this.taskList.find((function(e){return!e.isInProgress()}));e&&this.checkTaskReady(e)},e.prototype.checkTaskReady=function(e){var t=this.options.threadLimit,n=void 0===t?6:t;if(!(this.taskList.findIndex((function(e){return!e.isInProgress()}))>=n||L+1>6)){var i=this.removeTask.bind(this,e);e.on("complete",i),e.on("error",i),e.on("timeout",i),setTimeout((function(){return e.start()}),0)}},e.prototype.removeTask=function(e){var t=this;this.taskList.some((function(n,i){return n===e&&(setTimeout((function(){return e.removeAllListeners()}),0),t.taskList.splice(i,1),!0)}))},e}();e.DownloadTask=H,e.IDownloadManager=q,e.appendBuffer=s,e.arrayBufferToBlob=p,e.arrayBufferToString=f,e.blobToArrayBuffer=d,e.blobToText=h,e.genUuid=c,e.getDataFormat=u,e.getExtName=v,e.getFileName=S,e.getFullPathName=y,e.isImgFile=b,e.isJsonFile=E,e.isVersionFile=w,e.monitorProgress=C,e.sep=a,e.stringToArrayBuffer=m,e.stringToBlob=g,e.transformData=I,Object.defineProperty(e,"__esModule",{value:!0})}(vv,zt(Object.freeze({__proto__:null,default:{}}))),Gt(vv),function(e,t){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},n(e,t)};function i(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)};function o(){}function s(){s.init.call(this)}function a(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,n,i){var r,s,u;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),u=s[t]):(s=e._events=new o,e._eventsCount=0),u){if("function"==typeof u?u=s[t]=i?[n,u]:[u,n]:i?u.unshift(n):u.push(n),!u.warned&&(r=a(e))&&r>0&&u.length>r){u.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=u.length,function(e){"function"==typeof console.warn?console.warn(e):console.log(e)}(l)}}else u=s[t]=n,++e._eventsCount;return e}function l(e,t,n){var i=!1;function r(){e.removeListener(t,r),i||(i=!0,n.apply(e,arguments))}return r.listener=n,r}function c(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function d(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}o.prototype=Object.create(null),s.EventEmitter=s,s.usingDomains=!1,s.prototype.domain=void 0,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.init=function(){this.domain=null,s.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new o,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return a(this)},s.prototype.emit=function(e){var t,n,i,r,o,s,a,u="error"===e;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(t=arguments[1],!a){if(t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=s[e]))return!1;var c="function"==typeof n;switch(i=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var i=e.length,r=d(e,i),o=0;o<i;++o)r[o].call(n)}(n,c,this);break;case 2:!function(e,t,n,i){if(t)e.call(n,i);else for(var r=e.length,o=d(e,r),s=0;s<r;++s)o[s].call(n,i)}(n,c,this,arguments[1]);break;case 3:!function(e,t,n,i,r){if(t)e.call(n,i,r);else for(var o=e.length,s=d(e,o),a=0;a<o;++a)s[a].call(n,i,r)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,i,r,o){if(t)e.call(n,i,r,o);else for(var s=e.length,a=d(e,s),u=0;u<s;++u)a[u].call(n,i,r,o)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(i-1),o=1;o<i;o++)r[o-1]=arguments[o];!function(e,t,n,i){if(t)e.apply(n,i);else for(var r=e.length,o=d(e,r),s=0;s<r;++s)o[s].apply(n,i)}(n,c,this,r)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,l(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,l(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,i,r,s,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new o:(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,s=n.length;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){a=n[s].listener,r=s;break}if(r<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new o,this;delete i[e]}else!function(e,t){for(var n=t,i=n+1,r=e.length;i<r;n+=1,i+=1)e[n]=e[i];e.pop()}(n,r);i.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new o,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new o:delete n[e]),this;if(0===arguments.length){for(var i,r=Object.keys(n),s=0;s<r.length;++s)"removeListener"!==(i=r[s])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new o,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},s.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):c.call(e,t)},s.prototype.listenerCount=c,s.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var h="ZipInfo:";function p(e){var t;return null===(t=null==e?void 0:e.path)||void 0===t?void 0:t.startsWith(h)}function f(e){return"string"==typeof e&&e.startsWith(h)}function g(e,t){return(Array.isArray(e)?e:[e]).some((function(e){if("number"!=typeof e.version)throw new Error("file version must be an int number");return e.version<t}))}function m(e,t){return e.reduce((function(e,n){return e.then((function(e){return t(e,n)})).catch((function(){return t(void 0,n)}))}),Promise.resolve(void 0))}var v,y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(s),S="resource",b=function(e){function n(t){var n=e.call(this)||this;if(n.ready=!1,n.openError=!1,n.isEnable()){var i=t||{},r=i.nameSpaceId,o=i.indexDbVersion;n.dbName=function(e){return"resource-manager"+(e?"-"+e:"")}(r);var s=indexedDB.open(n.dbName,o||1);s.addEventListener("error",(function(){n.openError=!0,n.checkReady(),n.emit("error",new Error("failed to open indexedDB"))})),s.addEventListener("success",(function(){n.db=s.result,n.checkReady()})),s.addEventListener("upgradeneeded",(function(){n.db=s.result,n.handleSuccess()})),setTimeout((function(){n.checkReady()}),5e3)}else n.checkReady();return n}return i(n,e),n.prototype.checkReady=function(){this.ready||(this.ready=!0,this.emit("ready"))},n.prototype.handleSuccess=function(){if(!this.db.objectStoreNames||0===this.db.objectStoreNames.length||!this.db.objectStoreNames.contains(S)){var e=this.db.createObjectStore(S,{keyPath:"path",autoIncrement:!1});e.createIndex("path","path"),e.createIndex("sourceURL","sourceURL",{unique:!1})}},n.prototype.createAction=function(e){var t=this.db.transaction([S],e||"readonly");return{trans:t,store:t.objectStore(S)}},n.prototype.handleAction=function(e,t){return new Promise((function(n,i){var r=t();e.addEventListener("complete",(function(){n(r.result)})),e.addEventListener("error",(function(){i(e.error||new Error("transaction error"))})),e.addEventListener("abort",(function(){i(e.error||new Error("transaction aborted"))}))}))},n.prototype.put=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.createAction("readwrite"),i=n.trans,r=n.store;return this.handleAction(i,(function(){return r.put.apply(r,e)}))},n.prototype.getAllKeysFromIndex=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(IDBObjectStore.prototype.getAllKeys){var i=this.createAction(),r=i.trans,o=i.store;return this.handleAction(r,(function(){var n;return(n=o.index(e)).getAllKeys.apply(n,t)}))}return this.openKeyCursor(e)},n.prototype.getAllFromIndex=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=this.createAction(),r=i.trans,o=i.store;return IDBObjectStore.prototype.getAll?this.handleAction(r,(function(){var n;return(n=o.index(e)).getAll.apply(n,t)})):this.openCursor(e)},n.prototype.getFromIndex=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=this.createAction(),r=i.trans,o=i.store;return this.handleAction(r,(function(){var n;return(n=o.index(e)).get.apply(n,t)}))},n.prototype.deleteKey=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.createAction("readwrite"),i=n.trans,r=n.store;return this.handleAction(i,(function(){return r.delete.apply(r,e)}))},n.prototype.handleCursorAction=function(e,t,n,i){return new Promise((function(r,o){t.addEventListener("success",(function(){t.result?(n(i,t.result),t.result.continue()):r(i)})),t.addEventListener("error",(function(){o(e.error||new Error("transaction error"))}))}))},n.prototype.openKeyCursor=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=this.createAction("readwrite"),o=r.trans,s=r.store;return this.handleCursorAction(o,(t=s.index(e)).openKeyCursor.apply(t,n),(function(e,t){return e.push(t.key),e}),[])},n.prototype.openCursor=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=this.createAction("readwrite"),o=r.trans,s=r.store;return this.handleCursorAction(o,(t=s.index(e)).openCursor.apply(t,n),(function(e,t){return e.push(t.value),e}),[])},n.prototype.isEnable=function(){return!!window.indexedDB&&!this.openError},n.prototype.saveFile=function(e){return this.db?this.put(e).then((function(){return!0})):Promise.resolve(!1)},n.prototype.removeFile=function(e){var n=this;return this.db?"string"==typeof e?this.getAllKeysFromIndex("path").then((function(i){var r=(i||[]).filter((function(n){return n===e||n.startsWith(""+e+t.sep)}));return Promise.all(r.map((function(e){return n.deleteKey(e)})))})).then((function(){return!0})):this.deleteKey(e.path).then((function(){return!0})):Promise.resolve(!1)},n.prototype.clear=function(){if(!this.db)return Promise.resolve(!1);var e=this.createAction("readwrite"),t=e.trans,n=e.store;return this.handleAction(t,(function(){return n.clear()})).then((function(){return!0}))},n.prototype.findFileByPath=function(e){return this.db&&e?this.getFromIndex("path",e):Promise.resolve(void 0)},n.prototype.findFileBySourceURL=function(e){return this.db&&e?this.getAllFromIndex("sourceURL",e):Promise.resolve([])},n.prototype.isDirectory=function(e){var n=this;return this.db?new Promise((function(i){f(e)?i(!1):n.getAllKeysFromIndex("path").then((function(n){return(n||[]).some((function(n){return n.startsWith(""+e+t.sep)}))})).then(i).catch((function(){return i(!1)}))})):Promise.resolve(!1)},n.prototype.ls=function(e){var n=this;return this.db?this.getAllKeysFromIndex("path").then((function(i){var r=[];return Promise.all((i||[]).map((function(i){if(f(i))return Promise.resolve(void 0);if(e){if(i.startsWith(""+e+t.sep)){var o=i.split(""+e+t.sep)[1]||"";if(o.includes(t.sep)){var s=""+e+t.sep+o.split(t.sep)[0];return s&&!r.includes(s)?(r.push(s),Promise.resolve(s)):Promise.resolve(void 0)}return n.getFromIndex("path",i)}return Promise.resolve(void 0)}if(i.includes(t.sep)){var a=i.split(t.sep)[0]||"";return a&&!r.includes(a)?(r.push(a),Promise.resolve(a)):Promise.resolve(void 0)}return n.getFromIndex("path",i)}))).then((function(e){return e.filter((function(e){return!!e}))}))})):Promise.resolve([])},n}(y),E=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.memoryFiles=[],t}return i(n,e),n.prototype.isEnable=function(){return!0},n.prototype.saveFile=function(e){var t=this;return new Promise((function(n){t.memoryFiles.some((function(n,i){return n.path===e.path&&(t.memoryFiles.splice(i,1,e),!0)}))||t.memoryFiles.push(e),n(!0)}))},n.prototype.removeFile=function(e){var n=this;return new Promise((function(i){for(var r=n.memoryFiles.length-1;r>=0;r--){var o=n.memoryFiles[r];("string"==typeof e&&(o.path===e||o.path.startsWith(""+e+t.sep))||e.path===o.path)&&n.memoryFiles.splice(r,1)}i(!0)}))},n.prototype.clear=function(){var e=this;return new Promise((function(t){e.memoryFiles=[],t(!0)}))},n.prototype.findFileByPath=function(e){var t=this;return new Promise((function(n){n(t.memoryFiles.filter((function(t){return t.path===e}))[0])}))},n.prototype.findFileBySourceURL=function(e){var t=this;return new Promise((function(n){n(t.memoryFiles.filter((function(t){return t.sourceURL===e})))}))},n.prototype.isDirectory=function(e){var n=this;return new Promise((function(i){f(e)?i(!1):i(n.memoryFiles.some((function(n){return n.path.startsWith(""+e+t.sep)})))}))},n.prototype.ls=function(e){var n=this;return new Promise((function(i){var r=[];n.memoryFiles.forEach((function(n){if(!p(n))if(e){if(n.path.startsWith(""+e+t.sep)){var i=n.path.split(""+e+t.sep)[1]||"";if(i.includes(t.sep)){var o=""+e+t.sep+i.split(t.sep)[0];return void(o&&!r.includes(o)&&r.push(o))}r.push(n)}}else if(n.path.includes(t.sep)){var s=n.path.split(t.sep)[0]||"";s&&!r.includes(s)&&r.push(s)}else r.push(n)})),i(r)}))},n}(y),w=function(e){function n(t){var n=e.call(this)||this;if(n.isLocalAvaliable=void 0,n.isEnable()){var i=(t||{}).nameSpaceId;n.storageName=function(e){return"resource-manager"+(e?"-"+e:"")}(i)}return n}return i(n,e),n.prototype.isEnable=function(){if(void 0!==this.isLocalAvaliable)return this.isLocalAvaliable;try{this.isLocalAvaliable=!0,localStorage.setItem("privateTest","")}catch(e){this.isLocalAvaliable=!1}return this.isLocalAvaliable},n.prototype.saveFile=function(e){var t=this;return this.isEnable()?new Promise((function(n){var i=t.getLocalFile();i.some((function(t,n){return t.path===e.path&&(i.splice(n,1,e),!0)}))||i.push(e),localStorage.setItem(t.storageName,JSON.stringify(i)),n(!0)})):Promise.resolve(!1)},n.prototype.getLocalFile=function(){var e=localStorage.getItem(this.storageName),t=[];if(e)try{t=JSON.parse(e)||"[]"}catch(e){console.log(e)}return t},n.prototype.removeFile=function(e){var n=this;return this.isEnable()?new Promise((function(i){for(var r=n.getLocalFile(),o=r.length-1;o>=0;o--){var s=r[o];("string"==typeof e&&(s.path===e||s.path.startsWith(""+e+t.sep))||e.path===s.path)&&r.splice(o,1)}localStorage.setItem(n.storageName,JSON.stringify(r)),i(!0)})):Promise.resolve(!1)},n.prototype.clear=function(){var e=this;return this.isEnable()?new Promise((function(t){localStorage.removeItem(e.storageName),t(!0)})):Promise.resolve(!1)},n.prototype.findFileByPath=function(e){var t=this;return this.isEnable()?new Promise((function(n){n(t.getLocalFile().filter((function(t){return t.path===e}))[0])})):Promise.resolve(void 0)},n.prototype.findFileBySourceURL=function(e){var t=this;return this.isEnable()?new Promise((function(n){n(t.getLocalFile().filter((function(t){return t.sourceURL===e})))})):Promise.resolve([])},n.prototype.isDirectory=function(e){var n=this;return this.isEnable()?new Promise((function(i){f(e)?i(!1):i(n.getLocalFile().some((function(n){return n.path.startsWith(""+e+t.sep)})))})):Promise.resolve(!1)},n.prototype.ls=function(e){var n=this;return this.isEnable()?new Promise((function(i){var r=[];n.getLocalFile().forEach((function(n){if(!p(n))if(e){if(n.path.startsWith(""+e+t.sep)){var i=n.path.split(""+e+t.sep)[1]||"";if(i.includes(t.sep)){var o=""+e+t.sep+i.split(t.sep)[0];return void(o&&!r.includes(o)&&r.push(o))}r.push(n)}}else if(n.path.includes(t.sep)){var s=n.path.split(t.sep)[0]||"";s&&!r.includes(s)&&r.push(s)}else r.push(n)})),i(r)})):Promise.resolve([])},n}(y);(v=e.FileStoreEnum||(e.FileStoreEnum={})).MEMORY="memoryStore",v.INDEX_DB="indexedDBStore",v.STORAGE="storageStore";var _=function(n){function o(e){var t=n.call(this)||this;return t.indexedDBStore=new b(e),t.memoryStore=new E,t.storageStore=new w(e),t}return i(o,n),o.prototype.saveFile=function(t,n,i){var o=this;void 0===n&&(n=!0);var s=(i||{}).forceSpecifyStore;return(n?this.findFileByPath(t.path,i):Promise.resolve(void 0)).then((function(n){if((null==n?void 0:n.version)&&g(t,n.version))throw new Error("there is an higher version file existed already");var i=r(r({},t),{createTime:n&&n.createTime||Date.now(),updateTime:Date.now()});return s&&o[s]&&o[s].isEnable()&&(s!==e.FileStoreEnum.STORAGE||o.isLocalStorageAvaliable(i))?o[s].saveFile(i):o[o.saveToTargetStoreRule(i)].saveFile(i)}))},o.prototype.isLocalStorageAvaliable=function(e){var n=e.data;return"string"===t.getDataFormat(n)&&n.length<=102400&&this.storageStore.isEnable()},o.prototype.saveToTargetStoreRule=function(t){return this.indexedDBStore.isEnable()?e.FileStoreEnum.INDEX_DB:this.isLocalStorageAvaliable(t)?e.FileStoreEnum.STORAGE:e.FileStoreEnum.MEMORY},o.prototype.removeFile=function(e,t){var n=(t||{}).forceSpecifyStore;return n&&this[n]?this[n].removeFile(e):Promise.all([this.indexedDBStore.removeFile(e),this.storageStore.removeFile(e),this.memoryStore.removeFile(e)]).then((function(){return!0}))},o.prototype.clear=function(e){var t=(e||{}).forceSpecifyStore;return t&&this[t]?this[t].clear():Promise.all([this.indexedDBStore.clear(),this.storageStore.clear(),this.memoryStore.clear()]).then((function(){return!0}))},o.prototype.findFileByPath=function(e,t){var n=this,i=(t||{}).forceSpecifyStore;return i&&this[i]?this[i].findFileByPath(e):m(this.searchInTargetStoreRule(),(function(t,i){return t?Promise.resolve(t):n[i].findFileByPath(e)}))},o.prototype.findFileBySourceURL=function(e,t){var n=this,i=(t||{}).forceSpecifyStore;return i&&this[i]?this[i].findFileBySourceURL(e):m(this.searchInTargetStoreRule(),(function(t,i){return n[i].findFileBySourceURL(e).then((function(e){return t?t.filter((function(t){return!e.some((function(e){return e.path===t.path}))})).concat(e||[]):e||[]}))}))},o.prototype.searchInTargetStoreRule=function(){return[e.FileStoreEnum.INDEX_DB,e.FileStoreEnum.STORAGE,e.FileStoreEnum.MEMORY]},o.prototype.isDirectory=function(e){var t=this;return e?m(this.searchInTargetStoreRule(),(function(n,i){return n?Promise.resolve(!0):t[i].isDirectory(e)})):Promise.resolve(!0)},o.prototype.ls=function(e){var t=this;return this.isDirectory(e).then((function(n){if(!n)throw new Error("path: "+e+" is an invalid directory path");return m(t.searchInTargetStoreRule(),(function(n,i){return t[i].ls(e).then((function(e){return n?(e||[]).concat(n.filter((function(t){return!e.some((function(e){return"string"==typeof t?e===t:"string"!=typeof e&&e.path===t.path}))}))):e}))}))}))},o}(s),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(s),C=function(e){function n(n){var i=e.call(this)||this,r=n||{},o=r.storeOptions,s=r.downloadManagerOptions;return i.downloadManager=new t.IDownloadManager(s),i.store=new _(o),i.store.indexedDBStore.on("ready",(function(){return i.emit("ready")})),i}return i(n,e),n.prototype.getFile=function(e,t,n){var i=this,r=new I,o=Promise.resolve(void 0),s=t||{},a=s.downloadOptions,u=s.forceDownload,l=s.saveRootPath;u?o=Promise.resolve(void 0):"string"==typeof e?o=this.store.findFileByPath(e,n):(null==e?void 0:e.sourceURL)?o=this.store.findFileBySourceURL(e.sourceURL):a&&(a.domParams||a.socketParams||a.xhrParams)&&(o=this.store.findFileBySourceURL(this.genSourceURL(a)));var c=null,d=new Promise((function(e){c=e}));return r.getDownloadTask=function(){return d},o=o.then((function(e){if(e&&(!Array.isArray(e)||e.length)){var t=e;if(Array.isArray(t)){var i=t.find((function(e){return p(e)}));if(!i)return;t=t.filter((function(e){return!p(e)}));var o=i.data;if("string"!=typeof o)return;if(!JSON.parse(o||"[]").every((function(e){return t.some((function(t){return t.path===e}))})))return}if(!(null==n?void 0:n.targetVersion)||!g(t,n.targetVersion))return r.emit("checkExpire",!1),t;r.emit("checkExpire",!0)}})).then((function(t){if(!t&&a){var o=i.downloadManager.download(a);return c(o),new Promise((function(t,s){o.on("complete",(function(o){setTimeout((function(){var s=Array.isArray(o)?o.map((function(e){var t=e.data,r=e.path,o=e.extName;return{path:i.genFilePath(l,r),sourceURL:i.genSourceURL(a),data:t,fileFormat:o||i.getFileFormat(a),version:(null==n?void 0:n.targetVersion)||1}})):{path:i.genFilePath(l,void 0),sourceURL:i.genSourceURL(a),data:o,fileFormat:i.getFileFormat(a),version:(null==n?void 0:n.targetVersion)||1};if(Array.isArray(s)&&"string"==typeof e&&e){var u=s.find((function(t){return t.path===e}));t(u||s)}else t(s);r.emit("beforeSet",s),i.beforeWrite(s,n).then((function(){r.emit("afterSet")})).catch((function(e){return r.emit("afterSet",e)}))}),0)})),o.on("abort",s),o.on("error",s),o.on("timeout",(function(){return s(new Error("download timeout"))}))}))}return c(void 0),t})).catch((function(e){return c(void 0),Promise.reject(e)})),r.getResult=function(){return o},r},n.prototype.genSourceURL=function(e){var n=e.domParams,i=e.type,r=e.xhrParams;if(i===t.DownloaderType.SOCKET)return null;var o=(i===t.DownloaderType.DOM?n:r)||{},s=o.url,a=void 0===s?"":s,u=o.body;return u&&Object.keys(u).length?a+(a.includes("?")?"&":"?")+"downloadBodyParams="+JSON.stringify(u):a},n.prototype.updateFile=function(e,t){return this.saveStore(e,!0,t)},n.prototype.beforeWrite=function(e,t){var n=this;return Array.isArray(e)?Promise.all(e.concat(function(e){var t=e[0].sourceURL||"";return{path:""+h+t,sourceURL:t,data:JSON.stringify(e.map((function(e){return e.path})))}}(e)).map((function(e){return n.saveStore(e,!1,t)}))).then((function(e){return e.filter((function(e){return!p(e)}))})):this.saveStore(e,!0,t)},n.prototype.getFileFormat=function(e){var n=e||{},i=n.xhrParams,r=n.domParams,o=n.socketParams,s=n.type;return s===t.DownloaderType.DOM&&(null==r?void 0:r.fileFormat)?r.fileFormat:s===t.DownloaderType.SOCKET&&(null==o?void 0:o.fileFormat)?o.fileFormat:(null==i?void 0:i.fileFormat)?i.fileFormat:"unknow"},n.prototype.genFilePath=function(e,n){return n?""+(e||"")+(e?t.sep:"")+n:e||""},n.prototype.saveStore=function(e,t,n){return void 0===t&&(t=!0),this.store.saveFile(e,t,n).then((function(t){if(t)return e;throw new Error("fail to save file in local store")}))},n.prototype.remove=function(e,t){return this.store.removeFile(e,t)},n.prototype.clear=function(e){return this.store.clear(e)},n.prototype.list=function(e){return this.store.ls(e)},n.prototype.updateVersion=function(e,t){var n=this;return this.store.findFileByPath(e).then((function(i){if(i)return n.saveStore(r(r({},i),{version:t})).then((function(){}));throw new Error("the target path: "+e+" isn't existed")}))},n.prototype.updateSourceURL=function(e,t){var n=this;return this.store.findFileByPath(e).then((function(i){if(i)return n.saveStore(r(r({},i),{sourceURL:t})).then((function(){}));throw new Error("the target path: "+e+" isn't existed")}))},n}(s);e.IResourceManager=C,Object.defineProperty(e,"__esModule",{value:!0})}(mv.exports,vv),Gt(mv.exports);class yv{constructor(e){this._cancelError=new Error("request for lock canceled"),this._locked=void 0,this._queue=[],this._waiters=[],this._currentReleaser=void 0,e&&(this._cancelError=e),this._locked=!1}acquire(){const e=this.isLocked(),t=new Promise(((e,t)=>this._queue.push({resolve:e,reject:t})));return e||this._dispatch(),t}async runExclusive(e){const t=await this.acquire();try{return await e()}finally{t()}}async waitForUnlock(){return this.isLocked()?new Promise((e=>this._waiters.push({resolve:e}))):Promise.resolve()}isLocked(){return this._locked}release(){if(this._currentReleaser){const e=this._currentReleaser;this._currentReleaser=void 0,e()}}cancel(){this._queue.forEach((e=>e.reject(this._cancelError))),this._queue=[]}_dispatch(){const e=this._queue.shift();if(!e)return;let t=!1;this._currentReleaser=()=>{t||(t=!0,this._locked=!1,this._resolveWaiters(),this._dispatch())},this._locked=!0,e.resolve(this._currentReleaser)}_resolveWaiters(){this._waiters.forEach((e=>e.resolve())),this._waiters=[]}}function Sv(e,t,n){const i=document.createElement("script");i.type="text/javascript",i.readyState?i.onreadystatechange=()=>{"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,t())}:(i.onload=()=>{t()},i.onerror=()=>{n()}),i.src=e,window.crossOriginIsolated&&(i.crossOrigin="anonymous"),"function"==typeof document.body.append?document.getElementsByTagName("head")[0].append(i):document.getElementsByTagName("head")[0].appendChild(i)}function bv(e,t){let n=e;/^https?:\/\//.test(n)||(n=`https://${e}`);try{const e=new URL(n);if(!t)return e.href;if(t.hostname)return e.hostname;if(t.path)return e.pathname}catch(e){return""}return""}function Ev(e){if(e){var t;const n=document.getElementById(e);null==n||null===(t=n.parentNode)||void 0===t||t.removeChild(n)}}let wv="zoom.us";const _v="3.8.0",Iv=`https://dmogdx0jrul3u.cloudfront.net/${_v}/lib/av`,Cv=`https://source.zoom.us/${_v}/lib/av`,Av=`https://jssdk.zoomus.cn/${_v}/lib/av`,Tv=()=>wv,Rv=(e,t,n)=>et([t,n].map(((t,n)=>{if("initial"!==t)return Me(["success"===t]);{const t=0===n?"ENCODE":"DECODE";return pt(Ad(`${e.toUpperCase()}_${t}_SUCCESS`,1).pipe(Ke((()=>!0))),Ad(`${e.toUpperCase()}_${t}_FAIL`,1).pipe(Ke((()=>!1))))}}))),Ov=e=>{const t=gh(e.value);return t?Fe(t):Ad(Vs,1).pipe(ke(ce),Tt(e),Ke((e=>{let[,t]=e;return gh(t)})))};function Pv(e,t){var n,i;const r="audio"===e?null===(n=t.audio)||void 0===n?void 0:n.audioSsrc:null===(i=t.video)||void 0===i?void 0:i.videoSsrc,o="audio"===e?kl:sl;return"audio"===e&&Ho()||r?Promise.resolve():Cd(o)}const Dv=()=>Me(navigator.mediaDevices.enumerateDevices()).pipe(Ke((e=>{const t=[],n=[],i=[];return e.forEach((e=>{const{kind:r,deviceId:o,label:s}=e,a=s.replace(/\([\w,\d]+:[\w,\d]+\)/i,"").trim();switch(r){case"audioinput":"communications"===o||/ZoomAudioDevice/i.test(a)||/Zoom-\S*/.test(a)||/CubebAggregateDevice\S*/.test(a)||/Microsoft Teams Audio/i.test(a)||t.push({deviceId:o,label:a});break;case"audiooutput":"communications"===o||/ZoomAudioDevice/i.test(a)||/Microsoft Teams Audio/i.test(a)||n.push({deviceId:o,label:a});break;case"videoinput":i.push({deviceId:o,label:a})}})),{microphones:t,speakers:n,cameras:i}})));function kv(e){const{x:t,y:n,width:i,height:r}=e.getBoundingClientRect();return{scaleWidth:i,scaleHeight:r,srcOffsetX:t,srcOffsetY:n}}function xv(e){if(e){let n=e;try{const t=e.width;e.width=t}catch(i){var t;n=e.cloneNode(!0),null===(t=e.parentNode)||void 0===t||t.replaceChild(n,e)}return n}return e}function Nv(){try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(Ba)}catch(e){return!1}}function Mv(){var e;return null===(e=WebAssembly)||void 0===e?void 0:e.validate(Ua)}const Fv=(()=>{const e=new yv;return{withAudioAction:t=>function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return new Promise((async(n,r)=>{let o=!1;const s=setTimeout((()=>{o=!0,e.release()}),3e4);try{await e.acquire(),o||clearTimeout(s),n(t(...i))}catch(e){o||(clearTimeout(s),r(e))}}))},processAudioAction:t=>e.acquire().then((()=>t())),completeAudioAction:()=>{e.release()},cancelAllAudioAction:()=>{e.cancel()}}})();function Lv(e){const t=["joinComputerAudio","joinSharingAudio","leaveComputerAudio","leaveSharingAudio"];return new Proxy(e,{get:(e,n)=>"string"==typeof n&&t.includes(n)?function(){return Fv.withAudioAction(e[n].bind(e))(...arguments)}:Reflect.get(e,n)})}function Vv(e){var t;const{browserVersion:n,isChrome:i,isFirefox:r,isSafari:o,isAndroidOrIOSBrowser:s,isSupportMediaStreamTrackProcessor:a,isSupportOffscreenCanvas:u}=Uo,l=Number(null==n||null===(t=n.match(/^\d+/))||void 0===t?void 0:t[0]),c=i&&l>=91,d=r&&l>=89,h=o&&lr(n,"17.4")>=0,p=navigator.hardwareConcurrency>2;let f=Ko();return e&&!f&&(f=u&&a),!s&&f&&(c||d||h)&&p}const jv=(e,t)=>{const n=document.createElement("link");return n.rel="preload",n.href=e,n.as=t,n.crossOrigin="anonymous",n},Bv=(e,t,n)=>{const i=[],r=[],o=Array.isArray(e)?e:[e];return ks.filter((e=>{var n;return o.includes(e.category)&&(e.tag===t||(null===(n=e.tag)||void 0===n?void 0:n.split(",").includes(t)))})).forEach((e=>{"worker"===e.type?i.push(`${n}${e.name}`):"wasm"===e.type&&r.push(`${n}${e.name}`)})),{workers:i,wasms:r}};function Uv(e,t,n){const i={};if("function"!=typeof window.SharedArrayBuffer){const{isIOSMobile:e,isSafari:r,isSupportOffscreenCanvas:o,isSupportMediaStreamTrackProcessor:s}=Uo,a=e||r||o&&s;Object.assign(i,{enableMultiDecodeVideoWithoutSAB:!!t&&a}),o&&s&&Object.assign(i,{enableVirtualBackgroundWithoutSAB:!!n})}return Vv(n)&&Object.assign(i,{resourceManager:mv.exports.IResourceManager,file:[{path:`${e}/vb-resource/dualModel.bin`,type:"bin"},{path:`${e}/vb-resource/tf.min.js`,type:"js"}]}),i}function Hv(e,t){const{media:{isAudioBridgeReceiveReady:n,isAudioBridgeSendReady:i},audio:{customizeAudioOption:r}}=e,o=void 0!==t?t:!(null==r||!r.speakerOnly);return et([n?Me([!0]):Ad(Vc,1).pipe(mt(!0)),i||o?Me([!0]):Ad(jc,1).pipe(mt(!0))])}function qv(e,t,n){if(e.deviceId===t)return!0;if("default"===t){const i=n.find((e=>e.deviceId===t));if(i)return i.label.indexOf(e.label)>-1}return!1}function Kv(e){return e.find((e=>"default"===e.deviceId))}const $v=(()=>{let e,t=!1;return{watch:function(n){t=!0,e=Promise.race([n,pr((()=>!0),1e4)]).then((()=>{e=void 0,t=!1})).finally((()=>{e=void 0,t=!1}))},acquire:function(){return t&&e?e:Promise.resolve()}}})(),Wv=(e,t)=>Cd({event:Qs,operations:[ht((t=>void 0!==t[`${e}`])),gt(1)]},(n=>n[`${e}`]===t));class Gv{constructor(){this.audioPlaybackUrl=void 0,this.videoPlaybackUrl=void 0,this._audioElement=void 0,this._videoElement=void 0,this.videoSrc=void 0,this.isUsingSameFile=void 0}static getInstance(){return void 0===this.instance&&(this.instance=new Gv),this.instance}static destroyInstance(){if(this.instance){this.instance.stopAudioElement(),this.instance.stopVideoElement();const t=document.getElementById(su);var e;t&&(null===(e=t.parentNode)||void 0===e||e.removeChild(t)),this.instance=void 0}}setAudioElement(e){return void 0===this._audioElement&&(this._audioElement=new Audio),new Promise(((t,n)=>{if(this.videoSrc===e.url)this._audioElement.pause(),this.isUsingSameFile=!0,this._videoElement.muted=!1,(r=this._videoElement).currentTime>0&&!r.paused&&!r.ended&&r.readyState>2?t(""):this._videoElement.play().then((()=>{t("")})).catch((()=>{n()}));else{var i;this.isUsingSameFile=!1;const r=Uo.isFirefox?"canplay":"canplaythrough",o=()=>{this._audioElement.play().then((()=>{this._audioElement.removeEventListener(r,o),t("")}))},s=()=>{this._audioElement.removeEventListener(r,o),this._audioElement.removeEventListener("error",s),n()};this._audioElement.addEventListener(r,o),this._audioElement.addEventListener("error",s),this._audioElement.src=e.url,this._audioElement.loop=!!e.loop,gr(e.url)&&this._audioElement.setAttribute("crossorigin",""),this._audioElement.currentTime=Math.max(null!==(i=e.currentTime)&&void 0!==i?i:0,1e-4)}var r}))}setVideoElement(e){return void 0===this._videoElement&&(this._videoElement=document.createElement("video")),new Promise(((t,n)=>{var i;this.videoSrc=e.url;const r=Uo.isFirefox?"canplay":"canplaythrough",o=()=>{this._videoElement.play().then((()=>{this._videoElement.removeEventListener(r,o),t("")}))},s=()=>{this._videoElement.removeEventListener(r,o),this._videoElement.removeEventListener("error",s),n()};this._videoElement.addEventListener(r,o),this._videoElement.addEventListener("error",s),this._videoElement.src=e.url,this.isUsingSameFile||(this._videoElement.muted=!0),this._videoElement.loop=!!e.loop,this._videoElement.currentTime=null!==(i=e.currentTime)&&void 0!==i?i:0,gr(e.url)&&this._videoElement.setAttribute("crossorigin",""),Uo.isSafari&&!document.getElementById(su)&&(this._videoElement.id=su,this._videoElement.setAttribute("style","position:fixed;top:-10000px;left:-10000px"),document.body.appendChild(this._videoElement))}))}get audioElement(){return this.isUsingSameFile?this._videoElement:this._audioElement}get videoElement(){return this._videoElement}stopAudioElement(){this.isUsingSameFile||this._audioElement&&(this._audioElement.currentTime=0,this._audioElement.pause())}stopVideoElement(){this._videoElement&&this._videoElement.pause(),this.videoSrc=void 0}}Gv.instance=void 0;const zv=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{socket:{zoomSocketStatus:n,xmppSocketStatus:i,mainSessionSocketStatus:r},meeting:{meetingStatus:o}}=e,s=[];if(o===Co.Joined){var a;const t=Ls.getInstance(),n=Ps.createAgent();if((null===(a=gh(e))||void 0===a?void 0:a.audio)===yu.Computer&&t.leaveComputerAudio(),t.disconnect(),$v.watch(t.destroy()),e.video&&(e.video.subscribedVideoList.length>0&&e.video.subscribedVideoList.forEach((e=>{n.unsubscribeVideo(e)})),e.video.isCurrentUserStartedVideo&&_d(Hu)),e.share&&e.share.isReceiveSharing){const t=e.share.activeNodeId;e.share.remoteControlledUserList.length>0&&e.share.remoteControlledUserList.forEach((e=>{n.sharingRequestRemoteControl(e,!1)})),n.unsubscribeSharing(t)}Gv.destroyInstance()}if(t||(Do.clearSession(),[ko.WebclientTk,ko.WebclientZsk,ko.WebclientZtk,ko.WebclientRecordingToken].forEach((e=>{sessionStorage.removeItem(e)})),es.destroy()),n!==Th.Closed&&s.push(Dn()),i!==Th.Closed&&s.push(kn()),r!==Th.Closed&&s.push(Ln()),t){const n=gh(e);s.push(Jr({audio:null==n?void 0:n.audio,muted:null==n?void 0:n.muted,video:null==n?void 0:n.bVideoOn,isFailover:t}))}else s.push(Jr({audio:!1,muted:void 0,video:!1,isFailover:t}));return s.push(Kn(),li(),Dd(),$h(t),of(),vf(t),Sg(),_g(),Dm(),Jg(),um(),Mm(),jm(),ev(t),lv(),hv(t),gv(t),io(Co.Closed)),s},Jv=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Cd({event:Us,operations:[Ke((t=>t.find((t=>t.userId===e.userId&&(!e.key||void 0!==t[`${e.key}`]))))),ht((e=>!!e)),gt(1)]},...n)},Qv={[`${Ao.AudioBridgeEnable}`]:{mask:240,action:co},[`${Ao.AudioDecodeInWorklet}`]:{mask:15,action:ti},[`${Ao.VideoFullHD}`]:{mask:15,action:Xf},[`${Ao.VideoShareFullHD}`]:{mask:15,action:rf},[`${Ao.WebGL2Render}`]:{mask:15,action:ng},[`${Ao.WebGPURender}`]:{mask:15,action:ig},[`${Ao.ZMKFromRWG}`]:{mask:15,action:bo}};function Yv(e){if(!e)return"";const t=e.match(/rid=(.*)/);return t?t[1]:""}function Zv(e){return j(Ke(((t,n)=>e(t,n))),ht((e=>null!=e)))}function Xv(e){return j(Ye(((t,n)=>e(t,n)||ge)))}function ey(e){return j(Ye(((t,n)=>e(t,n))),Ye((e=>Array.isArray(e)?Me(e):Fe(e))))}const ty={period:500,rules:[{peak:50,throttle:300},{peak:60,throttle:400}]},ny={[`${is}`]:()=>({payloads:{add:[],update:[],remove:[]},onThrottle(e){e.add&&this.payloads.add.push(...e.add),e.update&&this.payloads.update.push(...e.update),e.remove&&this.payloads.remove.push(...e.remove)}})};function iy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ty;return t=>new U((n=>{const i=new Map;let r=0,o=null;const{period:s,rules:a}=e;let u=null;o||(o=((e,t)=>{const n=performance.now();let i=0,r=!1;return setTimeout((function o(){i+=t,e();const s=performance.now()-n-i,a=setTimeout(o,Math.max(t-s,0));r&&clearTimeout(a)}),t),()=>{r=!0}})((()=>{r=0}),s));const l=Object.keys(ny),c=t.subscribe({next(e){if(e&&e.evt&&null!==o){r+=1;const{evt:t,body:o}=e,s=String(t);if(l.indexOf(s)>=0)if(u){const e=i.get(s);if(e)e.onThrottle(o);else{const e=ny[s]();e.onThrottle(o),i.set(s,e)}}else{let t=0;if(a.forEach((e=>{r>e.peak&&(t=e.throttle)})),t>0){const e=ny[s]();e.onThrottle(o),i.set(s,e),u=setTimeout((()=>{i.forEach(((e,t)=>{const i={evt:Number(t),body:e.payloads};n.next(i)})),i.clear(),u=null}),t)}else n.next(e)}else n.next(e)}else n.next(e)},error(e){n.error(e)},complete(){n.complete()}});return()=>{c.unsubscribe(),o&&(o(),o=null),r=0}}))}let ry=function(e){return e[e.Unknown=0]="Unknown",e[e.Windows=1]="Windows",e[e.Mac=2]="Mac",e[e.Pad=3]="Pad",e[e.Mobile=4]="Mobile",e[e.CallIn=5]="CallIn",e[e.Linux=6]="Linux",e[e.WebClient=7]="WebClient",e[e.ChromeOs=8]="ChromeOs",e}({});const oy=262144,sy=1048576,ay=e=>!(4&~e),uy=e=>(e&sy)===sy,ly=e=>{let{share:{isReceiveSharing:t}}=e;return t},cy=e=>{let{share:{activeNodeId:t}}=e;return t},dy=Kd([bh,ly,cy],(function(){let e=arguments.length>2?arguments[2]:void 0;if(arguments.length>1?arguments[1]:void 0){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((t=>t.userId===e&&!0===t.sharerOn));if(t){let{os:e}=t;const{pwaOS:n}=t;return"mac"===n?e=ry.Mac:"win"===n&&(e=ry.Windows),{...t,os:e}}}return null})),hy=Kd([bh],(e=>e.filter((e=>e.sharerOn)))),py=Kd([hy],(e=>e.some((e=>!!e.bVideoShare)))),fy=Kd([e=>{let{share:{remoteControlledUserList:t}}=e;return t},ly,cy],((e,t,n)=>!!t&&e.some((e=>hr(e,n)))));var gy,my=new Uint8Array(16);function vy(){if(!gy&&!(gy="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gy(my)}for(var yy,Sy,by,Ey,wy=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,_y=[],Iy=0;Iy<256;++Iy)_y.push((Iy+256).toString(16).substr(1));function Cy(e,t,n){var i=(e=e||{}).random||(e.rng||vy)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(_y[e[t+0]]+_y[e[t+1]]+_y[e[t+2]]+_y[e[t+3]]+"-"+_y[e[t+4]]+_y[e[t+5]]+"-"+_y[e[t+6]]+_y[e[t+7]]+"-"+_y[e[t+8]]+_y[e[t+9]]+"-"+_y[e[t+10]]+_y[e[t+11]]+_y[e[t+12]]+_y[e[t+13]]+_y[e[t+14]]+_y[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&wy.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n}(i)}!function(e){e[e.PLAIN=0]="PLAIN",e[e.RSA=1]="RSA",e[e.AESGCM256=2]="AESGCM256"}(yy||(yy={})),function(e){e[e.info=0]="info",e[e.debug=1]="debug",e[e.log=2]="log",e[e.warn=3]="warn",e[e.error=4]="error"}(Sy||(Sy={})),function(e){e[e.PROTECT_LOCAL_KEY=0]="PROTECT_LOCAL_KEY"}(by||(by={})),function(e){e.beforeInit="beforeInit",e.afterInit="afterInit",e.beforeLog="beforeLog",e.hitSizeLimit="hitSizeLimit",e.afterLog="afterLog",e.beforeReport="beforeReport",e.afterReport="afterReport"}(Ey||(Ey={}));class Ay{constructor(){}}var Ty,Ry={exports:{}},Oy={exports:{}},Py=zt(Object.freeze({__proto__:null,default:{}}));Oy.exports=(Ty=Ty||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==Wt&&Wt.crypto&&(n=Wt.crypto),!n)try{n=Py}catch(e){}var i=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},r=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),o={},s=o.lib={},a=s.Base={extend:function(e){var t=r(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=s.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[i+o>>>2]|=s<<24-(i+o)%4*8}else for(var a=0;a<r;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(i());return new u.init(t,e)}}),l=o.enc={},c=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var o=t[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new u.init(n,t/2)}},d=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var o=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new u.init(n,t)}},h=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},p=s.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,i=this._data,r=i.words,o=i.sigBytes,s=this.blockSize,a=o/(4*s),l=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,c=e.min(4*l,o);if(l){for(var d=0;d<l;d+=s)this._doProcessBlock(r,d);n=r.splice(0,l),i.sigBytes-=c}return new u.init(n,c)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=p.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=o.algo={};return o}(Math),Ty),Ry.exports=function(e){return e.enc.Utf8}(Oy.exports);var Dy={exports:{}};Dy.exports=function(e){return function(){var t=e,n=t.lib.WordArray;function i(e,t,i){for(var r=[],o=0,s=0;s<t;s++)if(s%4){var a=i[e.charCodeAt(s-1)]<<s%4*2|i[e.charCodeAt(s)]>>>6-s%4*2;r[o>>>2]|=a<<24-o%4*8,o++}return n.create(r,o)}t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],o=0;o<n;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)r.push(i.charAt(s>>>6*(3-a)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var o=0;o<n.length;o++)r[n.charCodeAt(o)]=o}var s=n.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return i(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(Oy.exports);var ky=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};const xy=e=>{try{const t=Dy.exports.parse(e);return Ry.exports.stringify(t)}catch(t){return e}},Ny=e=>{for(var t=e.length,n=e.length-1;n>=0;n--){var i=e.charCodeAt(n);i>127&&i<=2047?t++:i>2047&&i<=65535&&(t+=2),i>=56320&&i<=57343&&n--}return t},My=()=>ky(void 0,void 0,void 0,(function*(){return yield self.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"])})),Fy=(e,t,n)=>ky(void 0,void 0,void 0,(function*(){try{return yield self.crypto.subtle.encrypt({name:"AES-GCM",iv:n},t,e)}catch(e){throw e}})),Ly=(e,t)=>{const n="string"==typeof e?function(e){const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0,i=e.length;t<i;t++)n[t]=e.charCodeAt(t);return t}(e):e;return self.crypto.subtle.encrypt({name:"RSA-OAEP"},t,n)},Vy={},jy=(e,t)=>{Vy[t]=e},By=Vy,Uy=e=>{try{return JSON.stringify(e)}catch(e){return"json stringify failed"}},Hy=e=>{try{return JSON.parse(e)}catch(t){return e}},qy=e=>{let t=0;return t+=Ny(e.message),e.tags.forEach((e=>{t+=Ny(e)})),t};class Ky{constructor(e){this.uuid="randomUUID"in self.crypto?self.crypto.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)));const{databaseName:t,maxSize:n,publicKey:i,reportUrl:r,plugins:o,idbManager:s,logManager:a,currentSize:u,externalKeys:l,codecWorkerFilePath:c}=e;this.databaseName=t,this.maxSize=n,this.publicKey=null!=i?i:"",this.reportUrl=null!=r?r:"",this.plugins=null!=o?o:[],this.idbManager=s,this.logManager=a,this.currentSize=null!=u?u:0,this.externalKeys=l,this.commonMethods=Object.assign({},By)}getLocalAESGCM256Key(){var e;return function(e,t,n,i){return new(n||(n=Promise))((function(t,r){function o(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,s)}a((i=i.apply(e,[])).next())}))}(this,0,void 0,(function*(){if(this.localAESGCM256Key)return this.localAESGCM256Key;this.localAESGCM256Key=yield My();const t=this.externalKeys?null===(e=this.externalKeys.filter((e=>e.usage===by.PROTECT_LOCAL_KEY))[0])||void 0===e?void 0:e.key:void 0;return yield this.idbManager.saveAESGCM256Key(this.uuid,this.localAESGCM256Key,t),this.localAESGCM256Key}))}updateCurrentSize(e){var t;let n=null!==(t=this.currentSize)&&void 0!==t?t:0;if(e instanceof Map)for(const[t,i]of e)n+=qy(i);else n+=qy(e);return this.currentSize=n,n>=this.maxSize}}const $y=(...e)=>{const t={},n=[];for(const i of e)i.forEach((e=>{t[e.id]||(t[e.id]=!0,n.push(e))}));const i=new Map;return n.sort(((e,t)=>(null==e?void 0:e.id)-(null==t?void 0:t.id))).forEach((e=>{i.set(e.id,e)})),i},Wy=(e,t)=>{const n=new Map;return t.forEach((t=>{e(t)&&n.set(t.id,t)})),n};class Gy{constructor(){this.getStore=()=>({byTag:Object.assign({},this.store.byTag),byTime:new Map(this.store.byTime)}),this.pushByTime=e=>{for(const t of e)this.store.byTime.set(t.id,t)},this.pushByTag=e=>{e.forEach((e=>{const t=e.tags;Array.isArray(t)&&t.forEach((t=>{this.store.byTag[t]||(this.store.byTag[t]=new Map),this.store.byTag[t].set(e.id,e)}))}))},this.addLog=e=>{let t=e;Array.isArray(e)||(t=[e]),this.pushByTime(t),this.pushByTag(t)},this.syncFromIDB=e=>function(e,t,n,i){return new(n||(n=Promise))((function(t,r){function o(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,s)}a((i=i.apply(e,[])).next())}))}(this,0,void 0,(function*(){const t=yield e.getAllLogs();this.addLog(t)})),this.reset=()=>{this.store={byTag:{},byTime:new Map}},this.deleteLogs=e=>{for(const t of e){const e=this.store.byTime.get(t);if(!e)continue;const{tags:n}=e;for(const e of n)this.store.byTag[e].delete(t);this.store.byTime.delete(t)}},this.filterStore=e=>{const t=((e,t)=>{if(!t)return e.byTime;if("string"==typeof t)return e.byTag[t]||new Map;if(Array.isArray(t)){if(t.every((e=>"string"==typeof e)))return $y(...t.map((t=>e.byTag[t])).filter((e=>Boolean(e))))}else{if("function"==typeof t)return Wy(t,e.byTime);if("object"==typeof t)if(t.tags&&t.filter){if("string"==typeof t.tags)return Wy(t.filter,e.byTag[t.tags]);if(Array.isArray(t.tags)&&t.tags.every((e=>"string"==typeof e)))return $y(...t.tags.map((n=>{const i=e.byTag[n];return i?Wy(t.filter,i):new Map})))}else{if(t.filter)return Wy(t.filter,e.byTime);if(t.tags){if("string"==typeof t)return e.byTag[t]||new Map;if(Array.isArray(t)&&t.every((e=>"string"==typeof e)))return $y(...t.map((t=>e.byTag[t])))}}else console.error("Wrong filter type")}return new Map})(this.store,e),n=new Map;for(const[e,i]of t){const t=Object.assign(Object.assign({},i),{message:Hy(xy(i.message))});n.set(e,t)}return n},this.store={byTag:{},byTime:new Map}}}function zy(e,t,n){const i=e.plugins;if(!Array.isArray(i))return n;let r=n;return i.forEach((n=>{const i=n[t];if("function"==typeof i){const t=i(e,r);t&&(r=t)}})),r}const Jy=(e,t,n,i,r,o={})=>function(e,t,n,i){return new(n||(n=Promise))((function(e,t){function r(e){try{s(i.next(e))}catch(e){t(e)}}function o(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(r,o)}s((i=i.apply(undefined,[])).next())}))}(0,0,void 0,(function*(){const{noCache:s,extraProperties:a={}}=o,u=((e,t,n,i,r,o)=>{const s=Array.isArray(t)?t:[t],a=Date.now();return Object.assign({message:e,logLevel:n,tags:s,encryptMode:i,timestamp:a,laplaceSessionId:r},o)})(`${t}`,n,i,r,e.uuid,a),l=zy(e,Ey.beforeLog,u);if(s)zy(e,Ey.afterLog,u);else{const{idbManager:t,logManager:n}=e,i=yield t.makeNextId();l.message=(e=>{try{const t=Ry.exports.parse(e);return Dy.exports.stringify(t)}catch(t){return e}})(l.message);const r=Object.assign(Object.assign({},l),{id:i});e.updateCurrentSize(r)&&zy(e,Ey.hitSizeLimit,r),n.addLog(r),yield t.addLog(r),zy(e,Ey.afterLog,r)}}));jy(Jy,"commonLog");const Qy=e=>new Promise((t=>{const n=new XMLHttpRequest;n.open(e.type||"GET",e.url,!0),n.withCredentials=e.withCredentials,n.onerror=n=>{t({error:n,report:e.reportItem})},n.onreadystatechange=function(){if(4===n.readyState){const i=n.status;t(i>=200&&i<300?{report:e.reportItem}:{error:`Request failed, status: ${i}, responseText: ${n.responseText}`,report:e.reportItem})}},Object.entries(e.headers).forEach((([e,t])=>{t&&e&&n.setRequestHeader(e,t)})),n.send(e.data)})),Yy=(e,t=2)=>{let n=`${e}`;for(;n.length<t;)n=`0${n}`;return n},Zy=e=>{const t=new Date(e);return`${t.getUTCFullYear()}-${Yy(t.getUTCMonth()+1)}-${Yy(t.getUTCDate())} ${Yy(t.getUTCHours())}:${Yy(t.getUTCMinutes())}:${Yy(t.getUTCSeconds())}.${Yy(t.getUTCMilliseconds(),3)}`},Xy={version:"000001",flag:"0"},eS=(e,t,n)=>((e,t,n)=>Promise.all(e.map((e=>Object.assign({url:t||"",type:"POST",withCredentials:!1,headers:{},data:Uy({messages:e.messages,meta:e.meta}),reportItem:e},n))).map(Qy)))(e,t.reportUrl,n).then((e=>{e.forEach((e=>{var n;zy(t,Ey.afterReport,{report:e.report,error:null!==(n=e.error)&&void 0!==n?n:null})}))})),tS=(e,t,n)=>function(e,t,n,i){return new(n||(n=Promise))((function(e,t){function r(e){try{s(i.next(e))}catch(e){t(e)}}function o(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(r,o)}s((i=i.apply(undefined,[])).next())}))}(0,0,void 0,(function*(){const i=e.logManager.filterStore(t);if(!i||0===(null==i?void 0:i.size)||!n)return;const{xhrOptions:r={},additionalContext:o}=n,s=((e,t)=>Array.from(e.values()).reduce(((e,n)=>{const i=((e,t)=>{const{message:n,logLevel:i,tags:r,timestamp:o,encryptMode:s,id:a}=e,u=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["message","logLevel","tags","timestamp","encryptMode","id"]),l=Object.assign(Object.assign({time:Zy(o),logLevel:Sy[i],message:n,tags:r},t),u);return Uy(l)})(n,t),r=Ny(i),o=e[e.length-1];return o.currentSize+r>30720?e.push({messages:[i],ids:[n.id],currentSize:r}):(o.messages.push(i),o.ids.push(n.id),o.currentSize+=r),e}),[{messages:[],ids:[],currentSize:0}]).filter((e=>e.currentSize>0)).map((e=>({messages:e.messages.join("\n"),ids:e.ids,meta:Xy}))))(zy(e,Ey.beforeReport,i),o);eS(s,e,r)}));jy(tS,"commonReport");var nS=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};const iS=(e,t,n)=>nS(void 0,void 0,void 0,(function*(){const{idbManager:i,logManager:r}=e;if(Array.isArray(n)&&(yield i.deleteLogs(n),r.deleteLogs(n),!t))return;const o=e.logManager.filterStore(t),s=[];for(const[e,t]of o)s.push(t.id);let a=s;Array.isArray(s)||(a=[s]),yield i.deleteLogs(a),r.deleteLogs(a)})),rS=e=>nS(void 0,void 0,void 0,(function*(){const{idbManager:t,logManager:n}=e;yield t.reset(),n.reset()}));function oS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function sS(e){return new Promise((function(t,n){e.oncomplete=e.onsuccess=function(){return t(e.result)},e.onabort=e.onerror=function(){return n(e.error)}}))}function aS(e,t){var n=indexedDB.open(e);n.onupgradeneeded=function(){return n.result.createObjectStore(t)};var i=sS(n);return function(e,n){return i.then((function(i){return n(i.transaction(t,e).objectStore(t))}))}}var uS;function lS(){return uS||(uS=aS("keyval-store","keyval")),uS}function cS(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:lS())("readwrite",(function(t){return e.forEach((function(e){return t.delete(e)})),sS(t.transaction)}))}jy(iS,"commonDelete"),jy(rS,"commonReset");var dS=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};const hS={default:{queue:[],isRunning:!1,listeners:[]}},pS=e=>{let t=hS[e];return t||(t={queue:[],isRunning:!1,listeners:[]},hS[e]=t),t};function fS(e){return dS(this,void 0,void 0,(function*(){const t=pS(e),{queue:n,listeners:i}=t;for(;n.length>0&&!t.isRunning;){const i=n.shift();t.isRunning=!0;try{const e=yield i.task();i.resolution(e)}catch(e){i.rejection(e)}t.isRunning=!1,fS(e)}i.length&&i.forEach((e=>{e()}))}))}function gS(e,t){const n=pS(t);try{return new Promise(((i,r)=>{n.queue.push({task:e,resolution:i,rejection:r}),fS(t)}))}catch(e){return Promise.reject(e)}}const mS=(e,t)=>{pS(e).listeners.push(t)};var vS=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};const yS="change_meta",SS="change_log",bS=()=>Promise.resolve();class ES{constructor(e){this.waitingForReset=!1,this.resetting=!1,this.isChangingMeta=!1,this.isChangingLog=!1,this.dbFailCount={read:0,write:0},this.get=e=>function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:lS())("readonly",(function(t){return sS(t.get(e))}))}(e,this.store),this.set=(e,t)=>vS(this,void 0,void 0,(function*(){try{return!(this.dbFailCount.write>3)&&(yield function(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:lS())("readwrite",(function(n){return n.put(t,e),sS(n.transaction)}))}(e,t,this.store))}catch(n){n instanceof DOMException&&(n&&"QuotaExceededError"===n.name?(yield this.deleteOldLogsForSetNewOne(),yield this.set(e,t)):this.dbFailCount.write+=1),console.error(n)}})),this.deleteOldLogsForSetNewOne=()=>vS(this,void 0,void 0,(function*(){var e;const t=yield this.getAllLogs(),n=[];for(let i=0;i<13;i++){const r=null===(e=t[i])||void 0===e?void 0:e.id;(r||0===r)&&n.push(`${r}`)}return cS(n,this.store)})),this.adjustMaxId=()=>vS(this,void 0,void 0,(function*(){return this.resetting?bS():(this.isChangingMeta=!0,yield gS((()=>vS(this,void 0,void 0,(function*(){var e;const t=yield this.getAllLogs(),n=t[t.length-1],i=null!==(e=null==n?void 0:n.id)&&void 0!==e?e:0;return yield this.set("maxId",i),i}))),yS))})),this.makeNextId=()=>vS(this,void 0,void 0,(function*(){return this.resetting?bS():(this.isChangingMeta=!0,yield gS((()=>vS(this,void 0,void 0,(function*(){const e=yield this.get("maxId");if(!e&&0!==e)return yield this.set("maxId",0),0;const t=e+1;return yield this.set("maxId",t),t}))),yS))})),this.addLog=e=>vS(this,void 0,void 0,(function*(){if(this.resetting)return bS();this.isChangingLog=!0,yield gS((()=>vS(this,void 0,void 0,(function*(){const{id:t}=e;return this.set(`${t}`,e)}))),SS)})),this.getAllLogs=()=>vS(this,void 0,void 0,(function*(){return(yield function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lS();return e("readonly",(function(t){if(t.getAll&&t.getAllKeys)return Promise.all([sS(t.getAllKeys()),sS(t.getAll())]).then((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),2!==o.length);s=!0);}catch(e){a=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}}(e)||function(e,t){if(e){if("string"==typeof e)return oS(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oS(e,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e),n=t[0],i=t[1];return n.map((function(e,t){return[e,i[t]]}))}));var n=[];return e("readonly",(function(e){return function(e,t){return e.openCursor().onsuccess=function(){this.result&&(function(e){n.push([e.key,e.value])}(this.result),this.result.continue())},sS(e.transaction)}(e).then((function(){return n}))}))}))}(this.store)).filter((([e])=>"maxId"!==e)).sort(((e,t)=>{var n,i;return(null===(n=e[1])||void 0===n?void 0:n.id)-(null===(i=t[1])||void 0===i?void 0:i.id)})).map((([,e])=>e))})),this.deleteLogs=e=>vS(this,void 0,void 0,(function*(){if(this.resetting)return bS();this.isChangingLog=!0,yield gS((()=>vS(this,void 0,void 0,(function*(){return cS(e.map((e=>`${e}`)),this.store)}))),SS),yield this.adjustMaxId()})),this.saveAESGCM256Key=(e,t,n)=>vS(this,void 0,void 0,(function*(){if(n){const i=yield self.crypto.subtle.exportKey("raw",t),r=yield((e,t,n)=>ky(void 0,void 0,void 0,(function*(){return new Promise(((i,r)=>{requestAnimationFrame((()=>ky(void 0,void 0,void 0,(function*(){var r;const o=null===(r=null==t?void 0:t.algorithm)||void 0===r?void 0:r.name;let s;if("RSA-OAEP"===o?s=Ly:"AES-GCM"===o&&(s=Fy),!s)throw new Error("Unsupported encrypt key type");if("string"==typeof e){const r=new TextEncoder,o=yield s(r.encode(e),t,n);i(o)}else{const r=yield s(e,t,n);i(r)}}))))}))})))(i,n,new Uint8Array(16));yield this.set(`aes-gcm-256-${e}`,r)}else yield this.set(`aes-gcm-256-${e}`,t)})),this.reset=()=>vS(this,void 0,void 0,(function*(){return this.resetting?bS():(this.waitingForReset=!0,this.isChangingLog||this.isChangingMeta?bS():(this.resetting=!0,yield function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:lS())("readwrite",(function(e){return e.clear(),sS(e.transaction)}))}(this.store),this.resetting=!1,void(this.waitingForReset=!1)))})),this.store=aS(e,e+"-store"),mS(yS,(()=>{if(this.isChangingMeta=!1,this.waitingForReset)return this.reset()})),mS(SS,(()=>{if(this.isChangingLog=!1,this.waitingForReset)return this.reset()}))}}var wS=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};const _S={databaseName:"laplace-default-db",maxSize:49283072};class IS{constructor(e){this.commonLogWithContext=(e,t,n,i,r)=>wS(this,void 0,void 0,(function*(){yield Jy(this.runtimeMetaManager,e,t,n,i,r)})),this.commonReportWithContext=(e,t)=>wS(this,void 0,void 0,(function*(){yield tS(this.runtimeMetaManager,e,t)})),this.commonDeleteWithContext=e=>wS(this,void 0,void 0,(function*(){yield iS(this.runtimeMetaManager,e)})),this.resetWithContext=()=>wS(this,void 0,void 0,(function*(){yield rS(this.runtimeMetaManager)})),this.initLocalAESGCM256Key=()=>wS(this,void 0,void 0,(function*(){return yield My()})),this.doNotUseDirtyGetStore=()=>this.runtimeMetaManager.logManager.getStore(),this.log=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.log,yy.PLAIN,{extraProperties:n})})),this.info=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.info,yy.PLAIN,{extraProperties:n})})),this.warn=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.warn,yy.PLAIN,{extraProperties:n})})),this.debug=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.debug,yy.PLAIN,{extraProperties:n})})),this.error=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.error,yy.PLAIN,{extraProperties:n})})),this.logWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.log,yy.AESGCM256,{extraProperties:n})})),this.infoWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.info,yy.AESGCM256,{extraProperties:n})})),this.debugWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.debug,yy.AESGCM256,{extraProperties:n})})),this.warnWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.warn,yy.AESGCM256,{extraProperties:n})})),this.errorWithEncryption=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.error,yy.AESGCM256,{extraProperties:n})})),this.logWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.log,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.infoWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.info,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.warnWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.warn,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.debugWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.debug,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.errorWithoutCache=(e,t,n)=>wS(this,void 0,void 0,(function*(){yield this.commonLogWithContext(e,t,Sy.error,yy.PLAIN,{extraProperties:n,noCache:!0})})),this.getLogs=e=>{const t=this.runtimeMetaManager.logManager;return t?t.filterStore(e):new Map},this.report=(...e)=>((e,t,n={})=>function(e,t,n,i){return new(n||(n=Promise))((function(e,t){function r(e){try{s(i.next(e))}catch(e){t(e)}}function o(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(r,o)}s((i=i.apply(undefined,[])).next())}))}(0,0,void 0,(function*(){var i,r;const o=null!==(i=n.sampleRate)&&void 0!==i?i:1;if(Math.random()>o)return;if(Ny(t)>30720)throw new Error("ERROR: Laplace .report(strMsg) size bigger than 30KB is NOT allowed.");const s=Object.assign({message:Object.assign({strMsg:t},n.extraMsg),time:Zy(Date.now())},n.extraData);return(null===(r=null==n?void 0:n.tags)||void 0===r?void 0:r.length)&&(s.tags=null==n?void 0:n.tags),eS([{messages:JSON.stringify(s),meta:Xy}],e,n.xhrOptions)})))(this.runtimeMetaManager,...e),this.reportByHttps=(e,t)=>wS(this,void 0,void 0,(function*(){yield this.commonReportWithContext(e,t)})),this.deleteLog=e=>wS(this,void 0,void 0,(function*(){yield this.commonDeleteWithContext(e)})),this.deleteAll=()=>wS(this,void 0,void 0,(function*(){yield this.resetWithContext()}));const{runtimeMetaManager:t}=e;this.runtimeMetaManager=t}}IS.init=e=>wS(void 0,void 0,void 0,(function*(){const{databaseName:t="laplace-default-db"}=e,n=new ES(t),i=new Gy,r=new Ky(Object.assign(Object.assign(Object.assign({},_S),e),{idbManager:n,logManager:i}));zy(r,Ey.beforeInit),yield i.syncFromIDB(r.idbManager);const o=new IS({runtimeMetaManager:r});return zy(r,Ey.afterInit),o}));class CS extends Ay{constructor(e){super(),this.config={verbose:!1},this.beforeLog=(e,t)=>{const{verbose:n}=this.config;switch(n&&console.log("beforeLog, ","state: ",t,"meta: ",e),t.logLevel){case Sy.error:console.error(t.message);break;case Sy.warn:console.warn(t.message);break;case Sy.log:console.log(t.message);break;case Sy.debug:console.debug(t.message);break;case Sy.info:console.info(t.message)}},this.afterLog=(e,t)=>{const{verbose:n}=this.config;n&&console.log("afterLog, ","state: ",t,"meta: ",e)},this.beforeReport=(e,t)=>{const{verbose:n}=this.config;n&&console.log("beforeReport, ","pluginParams: ",t,"meta: ",e)},this.afterReport=(e,t)=>{const{verbose:n}=this.config;n&&console.log("afterReport, ","pluginParams: ",t,"runtimeMetaManager: ",e)},e&&(this.config=e)}}const AS=e=>{const t=[];for(const[n,i]of e)t.push(i);return t};class TS extends Ay{constructor(e){super(),this.config={debug:!1},this.debugLog=e=>{const{debug:t}=this.config;t&&console.log(`[AutoCleanLogPlugin]: ${e}`)},this.afterInit=e=>{const{expireBefore:t}=this.config;if(!t)return void this.debugLog("early return on beforeInit because expireBefore is falsy");const{logManager:n,commonMethods:{commonDelete:i}}=e,r=n.getStore().byTime,o=("function"==typeof t?AS(r).filter(t):AS(r).filter((e=>e.timestamp<t))).map((e=>e.id));i(e,void 0,o),this.debugLog(`afterInit, clean log id: ${o}`)},this.afterReport=(e,{report:t,error:n})=>{if(n)return this.debugLog("error"),void console.error(n);const{cleanAfterReport:i}=this.config;if(!i)return void this.debugLog("early return on afterReport because cleanAfterReport is falsy");const{commonMethods:{commonDelete:r}}=e;r(e,void 0,t.ids),this.debugLog(`afterReport, clean log id: ${t.ids}`)},e&&(this.config=e)}}var RS="Expected a function",OS=/^\s+|\s+$/g,PS=/^[-+]0x[0-9a-f]+$/i,DS=/^0b[01]+$/i,kS=/^0o[0-7]+$/i,xS=parseInt,NS="object"==typeof Wt&&Wt&&Wt.Object===Object&&Wt,MS="object"==typeof self&&self&&self.Object===Object&&self,FS=NS||MS||Function("return this")(),LS=Object.prototype.toString,VS=Math.max,jS=Math.min,BS=function(){return FS.Date.now()};function US(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function HS(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==LS.call(e)}(e))return NaN;if(US(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=US(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(OS,"");var n=DS.test(e);return n||kS.test(e)?xS(e.slice(2),n?2:8):PS.test(e)?NaN:+e}const qS=["RESOURCE_ERROR","JS_ERROR","UNHANDLED_PROMISE_REJECTION"];class KS extends Ay{constructor(e){super(),this.config={debug:!1,publicTags:[]},this.errorCount=0,this.hashErrors={},this.runtimeMetaManager=null,this.addPublicTags=e=>{var t;return null===(t=this.config.publicTags)||void 0===t?void 0:t.concat(e).filter((e=>e))},this.debugLog=e=>{const{debug:t}=this.config;t&&console.log("[AutoLogErrorPlugin]:",e)},this.ignore=e=>{var t,n,i,r,o;return void 0!==(null===(t=this.config)||void 0===t?void 0:t.maxErrorCount)&&this.errorCount>=(null===(n=this.config)||void 0===n?void 0:n.maxErrorCount)||!!(null===(i=this.config)||void 0===i?void 0:i.ignoredErrorMsgKeywords)&&e&&(null===(o=null===(r=this.config)||void 0===r?void 0:r.ignoredErrorMsgKeywords)||void 0===o?void 0:o.some((t=>null==e?void 0:e.includes(t))))},this.report=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError(RS);return US(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),function(e,t,n){var i,r,o,s,a,u,l=0,c=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(RS);function p(t){var n=i,o=r;return i=r=void 0,l=t,s=e.apply(o,n)}function f(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-l>=o}function g(){var e=BS();if(f(e))return m(e);a=setTimeout(g,function(e){var n=t-(e-u);return d?jS(n,o-(e-l)):n}(e))}function m(e){return a=void 0,h&&i?p(e):(i=r=void 0,s)}function v(){var e=BS(),n=f(e);if(i=arguments,r=this,u=e,n){if(void 0===a)return function(e){return l=e,a=setTimeout(g,t),c?p(e):s}(u);if(d)return a=setTimeout(g,t),p(u)}return void 0===a&&(a=setTimeout(g,t)),s}return t=HS(t)||0,US(n)&&(c=!!n.leading,o=(d="maxWait"in n)?VS(HS(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h),v.cancel=function(){void 0!==a&&clearTimeout(a),l=0,i=u=r=a=void 0},v.flush=function(){return void 0===a?s:m(BS())},v}(e,t,{leading:i,maxWait:t,trailing:r})}((()=>{if(null===this.runtimeMetaManager)return;const{autoReport:e}=this.config,{commonMethods:{commonReport:t}}=this.runtimeMetaManager;return t(this.runtimeMetaManager,qS,e)}),600,{trailing:!0,leading:!1}),this.afterInit=e=>{if(this.runtimeMetaManager=e,!self.addEventListener)return;const{commonMethods:{commonLog:t}}=e,n=(n,i,r)=>{this.debugLog(r),this.errorCount+=1;try{return function(e){const t=(new TextEncoder).encode(e);return crypto.subtle.digest("SHA-1",t).then((e=>Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")))}(n).then((r=>this.hashErrors[r]?"dismissed":(this.hashErrors[r]=!0,t(e,n,this.addPublicTags([].concat(i)),Sy.error,yy.PLAIN,{extraProperties:{messageHash:r}}).then(this.report)))).catch(console.error)}catch(e){return console.error(e),Promise.resolve(e)}};try{self.addEventListener("error",(e=>{var t,i,r,o,s,a,u;if(!this.ignore(null==e?void 0:e.message)){if((null==e?void 0:e.target)&&((null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.src)||(null===(i=null==e?void 0:e.target)||void 0===i?void 0:i.href))){const t=`Load Resource Error in ${null===(r=null==e?void 0:e.target)||void 0===r?void 0:r.tagName} element: ${(null===(o=null==e?void 0:e.target)||void 0===o?void 0:o.src)||(null===(s=null==e?void 0:e.target)||void 0===s?void 0:s.href)}`;return n(t,"RESOURCE_ERROR",e)}{const t=`Javascript Runtime Error in ${null==e?void 0:e.filename} (${null==e?void 0:e.lineno}:${null==e?void 0:e.colno}): ${null==e?void 0:e.message}\nStack: ${null!==(u=null===(a=null==e?void 0:e.error)||void 0===a?void 0:a.stack)&&void 0!==u?u:null==e?void 0:e.stack}`;return n(t,"JS_ERROR",e)}}})),self.addEventListener("unhandledrejection",(e=>{var t;if(this.ignore(null===(t=null==e?void 0:e.reason)||void 0===t?void 0:t.message))return;let i;const r=null==e?void 0:e.reason;return i="string"==typeof r?`Promise Error: ${r}`:r instanceof Error?`Promise Error: ${r.message} ${r.name} ${r.stack}`:"object"==typeof r?`Promise Error with reason: ${Uy(r)}`:`Promise Error with unrecognized reason: ${r}`,n(i,"UNHANDLED_PROMISE_REJECTION",e)}))}catch(e){console.error(e)}this.debugLog("afterInit, add listener")},e&&(this.config=e),this.config.publicTags=[].concat(null==e?void 0:e.publicTags)}}let $S=function(e){return e.DeviceAudioStreamCaptured="device audio stream captured",e.AudioJoinComplete="audio join complete",e.AudioLeaveComplete="audio leave complete",e.SharingAudioStartComplete="sharing audio start complete",e.SharingAudioStopComplete="sharing audio stop complete",e.AudioBridgeReconnectStart="audio bridge reconnect start",e.AudioBridgeReconnectEnd="audio bridge reconnect end",e}({}),WS=function(e){return e.VBSettingSuccess="video VB setting success",e.VBSettingFailed="init video VB failed",e.VBPreloadSuccess="preload video VB success",e.VBPreloading3S="preload video VB 3s",e.VBPreloading10S="preload video VB 10s",e.StartCaptureVideoSuccess="start capture video success",e.StopCaptureVideoSuccess="stop capture video success",e}({});function GS(e){return`{E}${e}{/E}`}const zS={enable:!1,enableReport:!1,gatewayEndPoint:"",newGatewayEndPoint:"",logLevel:{debug:!1,log:!1,info:!1,print:!1,warn:!1,error:!1},performanceReportRatio:.25,trackingCount:7},JS=["debug","log","info","print","warn","error"],QS=(e,t)=>[...e,...t].filter((e=>!!e));class YS{static getInstance(){return this.agentInstance||(this.agentInstance=new YS),this.agentInstance}constructor(){var e=this;this.laplace=void 0,this.trackingId=void 0,this.logConfig=void 0,this.reportUrl=void 0,this.publicTags=void 0,this.accountId=void 0,this.disableAutoReport=void 0,this.initConfig=async e=>{let t,n=zS;try{e.logConfig&&(n=JSON.parse(e.logConfig),n.gatewayEndPoint&&(this.reportUrl=n.gatewayEndPoint),n.newGatewayEndPoint&&(this.reportUrl=n.newGatewayEndPoint));const{enable:i,enableReport:r,reportUrl:o,logLevel:s,encryptKeys:a,trackingId:u,accountId:l}=e;if(void 0!==i&&(n={...n,enable:!!i}),void 0!==r&&(n={...n,enableReport:!!r}),o&&(this.reportUrl=o),"string"==typeof s){const e=JS.indexOf(s),t=JS.reduce(((t,n,i)=>i<e?{...t,[`${n}`]:!1}:{...t,[`${n}`]:!0}),{});n={...n,logLevel:t}}else void 0!==s&&(n={...n,logLevel:s});if(u&&(this.trackingId=u,n={...n,enable:!0,enableReport:!0}),void 0!==a){const e=Array.isArray(a)?a:[a];t=await Promise.all(e.map((e=>function(e){return window.crypto.subtle.importKey("raw",(new TextEncoder).encode(e.slice(0,32)),"AES-GCM",!1,["encrypt","decrypt"])}(e).then((e=>({usage:by.PROTECT_LOCAL_KEY,key:e}))))))}void 0!==l&&(this.accountId=l)}catch(e){console.error("parse log config error",e)}const i=(new Date).getTime()-6048e5,r=n.enableReport&&this.reportUrl?{gzip:!1,encrypt:!1,additionalContext:{trackingId:this.trackingId}}:void 0;this.publicTags=["VideoSDK",this.trackingId];const o=[e.debugMode&&new CS({verbose:!1}),new TS({debug:!1,cleanAfterReport:!0,expireBefore:i}),new KS({debug:!1,autoReport:r,ignoredErrorMsgKeywords:["table index is out of bounds"],maxErrorCount:223,publicTags:this.accountId?[...this.publicTags,GS(this.accountId)]:this.publicTags})].filter(Boolean);return{laplaceConfig:{databaseName:"ZM-VSDK-LOG-DATABASE",maxSize:49283072,publicKey:e.logEncryptionPubKey,reportUrl:this.reportUrl,externalKeys:t,plugins:o},logConfig:n}},this.handleInitLaplaceSuccess=(e,t)=>{var n;this.laplace=e;const i=Do.get(xo.VSDKLogTrackingId);let r=[];try{r=JSON.parse(i?window.atob(i):"[]")}catch(e){}(null===(n=r.length>=(null==t?void 0:t.trackingCount))||void 0===n||n)&&r.shift();const o=r.reduce(((e,t)=>({...e,[`${t}`]:!0})),{});e.deleteLog((e=>{var t;return!(null!==(t=e.tags)&&void 0!==t&&t.some((e=>o[e])))})),r.push(this.trackingId),Do.set(xo.VSDKLogTrackingId,window.btoa(JSON.stringify(r)),Oo.LocalStorage)},this.init=async e=>{const{laplaceConfig:t,logConfig:n}=await this.initConfig(e);return n.enable?(this.logConfig=n,IS.init(t).then((e=>{this.handleInitLaplaceSuccess(e,n)})).catch((e=>{throw{type:Sc,reason:"Logger init failed.",error:e}}))):Promise.reject({type:yc,reason:"Logger feature is not enabled."})},this.check=e=>{var t,n;return!(!this.checkLaplace()||(null===(t=this.logConfig)||void 0===t||null===(n=t.logLevel)||void 0===n||!n[e])&&(console.warn(`Logger ${e} is not enabled.`),1))},this.log=(e,t,n)=>{if(this.check("log"))try{var i;return null===(i=this.laplace.logWithEncryption(e,QS(t,n)))||void 0===i?void 0:i.catch((()=>{}))}catch(e){return}},this.logWithExtraProperties=(e,t,n)=>{if(this.check("log"))try{var i;return null===(i=this.laplace.log(e,t,n))||void 0===i?void 0:i.catch((()=>{}))}catch(e){return}},this.warn=(e,t,n)=>{if(this.check("warn"))try{var i;return null===(i=this.laplace.warnWithEncryption(e,QS(t,n)))||void 0===i?void 0:i.catch((()=>{}))}catch(e){return}},this.info=(e,t,n)=>{if(this.check("info"))try{var i;return null===(i=this.laplace.infoWithEncryption(e,QS(t,n)))||void 0===i?void 0:i.catch((()=>{}))}catch(e){return}},this.debug=(e,t,n)=>{if(this.check("debug"))try{var i;return null===(i=this.laplace.debugWithEncryption(e,QS(t,n)))||void 0===i?void 0:i.catch((()=>{}))}catch(e){return}},this.error=(e,t,n)=>{if(this.check("error"))try{var i;return null===(i=this.laplace.errorWithEncryption(e,QS(t,n)))||void 0===i?void 0:i.catch((()=>{}))}catch(e){return}},this.checkLaplace=()=>{var e;return!(null===(e=this.laplace)||void 0===e||!e.log)},this.makeLogger=e=>{var t;const n=QS(null!==(t=this.publicTags)&&void 0!==t?t:[],e);return{log:(e,t)=>this.log(e,n,null!=t?t:[]),logWithExtraProperties:(e,t)=>this.logWithExtraProperties(e,n,t),warn:(e,t)=>this.warn(e,n,null!=t?t:[]),info:(e,t)=>this.info(e,n,null!=t?t:[]),debug:(e,t)=>this.debug(e,n,null!=t?t:[]),error:(e,t)=>this.error(e,n,null!=t?t:[])}},this.reportToGlobalTracing=function(t){var n;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.checkLaplace()?null!==(n=e.logConfig)&&void 0!==n&&n.enableReport&&e.reportUrl?function(){try{return!!Do.get(No.DisableAutoReportLogs)}catch(e){return!1}}()&&!i?Promise.resolve():e.laplace.reportByHttps(t,{gzip:!1,encrypt:!1,xhrOptions:{url:e.reportUrl},additionalContext:{trackingId:e.trackingId}}):Promise.reject({type:yc,reason:"Please use getLogs to obtain log data and report by yourself."}):Promise.reject({type:yc,reason:"Logger has not been enabled or initialized."})},this.report=function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"warn";if(e.checkLaplace()&&e.logConfig.enableReport&&e.reportUrl){var r,o;const s=Array.isArray(n)?n:[n],a=e.accountId?[...s,GS(e.accountId)]:s;null===(r=(o=e.makeLogger(a))[`${i}`])||void 0===r||r.call(o,t).then((()=>{e.reportToGlobalTracing(s)}))}},this.getLogs=(e,t)=>{if(!this.checkLaplace())return console.warn("Logger has not been enabled or initialized."),[];const n=e.getState(),{meeting:{meetingNumber:i,userId:r,userEmail:o,userName:s}}=n,a={meetingNumber:i,userId:r,userEmail:o,userName:s},u=this.laplace.getLogs(t),l=[];for(const[,e]of u)l.push({...e,...a});return l},this.doNotUseDirtyGetStore=()=>this.checkLaplace()?this.laplace.doNotUseDirtyGetStore():(console.warn("Logger has not been enabled or initialized."),{byTag:{},byTime:new Map}),this.trackingId=Cy()}}YS.agentInstance=void 0;const ZS=YS.getInstance(),XS=[{type:"MediaMeta",methods:["sendUserNodeList","updateUserMediaSN","updateMediaParams","subscribeToQos","unsubscribeFromQos","sendUserAudioStatus","destroy","createMainSessionChannel","notifySDKMeetingReady"]},{type:"Audio",methods:["joinComputerAudio","leaveComputerAudio","joinSharingAudio","leaveSharingAudio","changeSpeaker","changeMicrophone","enableAudioEncode","pauseOrResumeAudio","setSharingAudioVolume","enableShareAudioToBreakoutRoom","enableAudioDenoise","enableSyncButtonsOnHeadset","stopAllIncomingAudio","preInitAudioBridge","setAudioCodecMode","muteOrUnmuteOtherAudio","adjustOtherAudioVolume","changeAudioProfile","unmuteAudio","muteAudio"]},{type:"Video",methods:["startCaptureVideo","stopCaptureVideo","renderVideo","stopRenderVideo","changeCamera","updateRenderedVideoCanvasDimension","adjustRenderedVideoPosition","mirrorVideo","enableHardwareAccelerationForVideoDecode","enableHardwareAccelerationForVideoEncode","startVirtualBackgroundSetting","updateVirtualBackgroundImage","stopVirtualBackgroundSetting","startMaskSetting","updateMaskBackgroundImage","updateMaskClip","stopMaskSetting","enableVideoObserver","prefetchVideoSsrc","cancelPrefetchVideoSsrc","setMobileRotateMode","changeActiveVideoSsrc","updateVideoHDValue","updateVideoFullhdValue","clearVideoCanvas"]},{type:"Sharing",methods:["stopDesktopSharing","startDesktopSharing","pauseDesktopSharing","resumeDesktopSharing","renderSharing","stopRenderSharing","switchSharingSource","ajustmentReceivedSharingCanvas","changeSharingSecondCamera","updateRenderedSharingDimension","addReceivedSharingChannelType","removeReceivedSharingChannelType","switchSharingMode","ajustmentSharingCanvas"]},{type:"RemoteControl",methods:["startRemoteControl","stopRemoteControl","resendRemoteControlPositionPDU","updateRemoteControlProperties","ajustmentReceivedSharingCanvas","startRemoteControlQRCheck"]},{type:"LiveTranscription",methods:["selectLanguageChannelForNewLTT"]},{type:"RemoteCamera",methods:["movePTZCamera"]}].reduce(((e,t)=>{const{type:n,methods:i}=t;return[...e,...i.map((e=>({name:e,type:n})))]}),[]),eb=XS.map((e=>e.name)),tb=function(e){const t=XS.find((t=>t.name===e));if(t){const{type:o}=t;for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=null==i?void 0:i.map((e=>Er(e)));ZS.makeLogger([o,`${o} Media SDK`]).info(`${e},params:${JSON.stringify(s)}`)}};function nb(e){return new Proxy(e,{get:(e,t)=>"string"==typeof t&&eb.includes(t)?function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];try{Reflect.apply(tb,void 0,[t,...i])}catch(e){}return Reflect.apply(Reflect.get(e,t),e,i)}:Reflect.get(e,t)})}const ib=YS.getInstance().makeLogger(["Remote Control"]),rb=nb(Ls.getInstance());function ob(e,t,n,i){let{share:{activeNodeId:r,shareQuality:o}}=t;const{share:{isReceiveSharingFromMainSession:s}}=t;n&&(r=n),void 0!==i&&(o=i);const a=py(t);e.subscribeSharing(r,o,s,a)}class sb{constructor(){this.checkerSubject=void 0,this.checkerSubscription=void 0}startCheck(e){return this.checkerSubject&&this.stopCheck(),this.checkerSubject=new z,this.checkerSubscription=at(e).subscribe(this.checkerSubject),this.checkerSubject}stopCheck(){var e;this.checkerSubject&&(this.checkerSubject.complete(),null===(e=this.checkerSubscription)||void 0===e||e.unsubscribe(),this.checkerSubject=void 0)}}const ab=new sb,ub=new sb;function lb(){return ab.stopCheck()}function cb(){return ub.stopCheck()}function db(e,t){lb(),cb();const{share:{remoteControllingSsrc:n},meeting:{userId:i}}=e;n&&(pb(),t.takeBackRemoteControlPermission(i,n))}async function hb(e,t,n,i,r){const{share:{isSDKGrabControl:o,isGrabRemoteControl:s}}=n;s||(i.subscribeGrabRemoteControl(e,!0),await je(Ad(nc,1).pipe(ht((e=>!!e)))));const a=dy(n);a&&(o?(r.resendRemoteControlPositionPDU(),r.updateRemoteControlProperties({os:a.os,isControllerNow:!0,dimension:t&&kv(t)})):t&&r.startRemoteControl(t,a.os,kv(t)))}function pb(){ib.log("qr scanning stop"),rb.startRemoteControlQRCheck(!1)}const fb=Ps.createAgent(),gb=nb(Ls.getInstance()),mb=Ps.createAgent(),vb=nb(Ls.getInstance());function yb(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Sb(e){return!!e&&!!e[iE]}function bb(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===rE}(e)||Array.isArray(e)||!!e[nE]||!!(null===(t=e.constructor)||void 0===t?void 0:t[nE])||Cb(e)||Ab(e))}function Eb(e,t,n){void 0===n&&(n=!1),0===wb(e)?(n?Object.keys:oE)(e).forEach((function(i){n&&"symbol"==typeof i||t(i,e[i],e)})):e.forEach((function(n,i){return t(i,n,e)}))}function wb(e){var t=e[iE];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Cb(e)?2:Ab(e)?3:0}function _b(e,t){return 2===wb(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ib(e,t,n){var i=wb(e);2===i?e.set(t,n):3===i?(e.delete(t),e.add(n)):e[t]=n}function Cb(e){return Zb&&e instanceof Map}function Ab(e){return Xb&&e instanceof Set}function Tb(e){return e.o||e.t}function Rb(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=sE(e);delete t[iE];for(var n=oE(t),i=0;i<n.length;i++){var r=n[i],o=t[r];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[r]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[r]})}return Object.create(Object.getPrototypeOf(e),t)}function Ob(e,t){return void 0===t&&(t=!1),Db(e)||Sb(e)||!bb(e)||(wb(e)>1&&(e.set=e.add=e.clear=e.delete=Pb),Object.freeze(e),t&&Eb(e,(function(e,t){return Ob(t,!0)}),!0)),e}function Pb(){yb(2)}function Db(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function kb(e){var t=aE[e];return t||yb(18,e),t}function xb(){return Qb}function Nb(e,t){t&&(kb("Patches"),e.u=[],e.s=[],e.v=t)}function Mb(e){Fb(e),e.p.forEach(Vb),e.p=null}function Fb(e){e===Qb&&(Qb=e.l)}function Lb(e){return Qb={p:[],l:Qb,h:e,m:!0,_:0}}function Vb(e){var t=e[iE];0===t.i||1===t.i?t.j():t.O=!0}function jb(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.g||kb("ES5").S(t,e,i),i?(n[iE].P&&(Mb(t),yb(4)),bb(e)&&(e=Bb(t,e),t.l||Hb(t,e)),t.u&&kb("Patches").M(n[iE].t,e,t.u,t.s)):e=Bb(t,n,[]),Mb(t),t.u&&t.v(t.u,t.s),e!==tE?e:void 0}function Bb(e,t,n){if(Db(t))return t;var i=t[iE];if(!i)return Eb(t,(function(r,o){return Ub(e,i,t,r,o,n)}),!0),t;if(i.A!==e)return t;if(!i.P)return Hb(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var r=4===i.i||5===i.i?i.o=Rb(i.k):i.o;Eb(3===i.i?new Set(r):r,(function(t,o){return Ub(e,i,r,t,o,n)})),Hb(e,r,!1),n&&e.u&&kb("Patches").R(i,n,e.u,e.s)}return i.o}function Ub(e,t,n,i,r,o){if(Sb(r)){var s=Bb(e,r,o&&t&&3!==t.i&&!_b(t.D,i)?o.concat(i):void 0);if(Ib(n,i,s),!Sb(s))return;e.m=!1}if(bb(r)&&!Db(r)){if(!e.h.F&&e._<1)return;Bb(e,r),t&&t.A.l||Hb(e,r)}}function Hb(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&Ob(t,n)}function qb(e,t){var n=e[iE];return(n?Tb(n):e)[t]}function Kb(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=Object.getPrototypeOf(n)}}function $b(e){e.P||(e.P=!0,e.l&&$b(e.l))}function Wb(e){e.o||(e.o=Rb(e.t))}function Gb(e,t,n){var i=Cb(t)?kb("MapSet").N(t,n):Ab(t)?kb("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),i={i:n?1:0,A:t?t.A:xb(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},r=i,o=uE;n&&(r=[i],o=lE);var s=Proxy.revocable(r,o),a=s.revoke,u=s.proxy;return i.k=u,i.j=a,u}(t,n):kb("ES5").J(t,n);return(n?n.A:xb()).p.push(i),i}function zb(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Rb(e)}var Jb,Qb,Yb="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Zb="undefined"!=typeof Map,Xb="undefined"!=typeof Set,eE="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,tE=Yb?Symbol.for("immer-nothing"):((Jb={})["immer-nothing"]=!0,Jb),nE=Yb?Symbol.for("immer-draftable"):"__$immer_draftable",iE=Yb?Symbol.for("immer-state"):"__$immer_state",rE=""+Object.prototype.constructor,oE="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,sE=Object.getOwnPropertyDescriptors||function(e){var t={};return oE(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},aE={},uE={get:function(e,t){if(t===iE)return e;var n=Tb(e);if(!_b(n,t))return function(e,t,n){var i,r=Kb(t,n);return r?"value"in r?r.value:null===(i=r.get)||void 0===i?void 0:i.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!bb(i)?i:i===qb(e.t,t)?(Wb(e),e.o[t]=Gb(e.A.h,i,e)):i},has:function(e,t){return t in Tb(e)},ownKeys:function(e){return Reflect.ownKeys(Tb(e))},set:function(e,t,n){var i=Kb(Tb(e),t);if(null==i?void 0:i.set)return i.set.call(e.k,n),!0;if(!e.P){var r=qb(Tb(e),t),o=null==r?void 0:r[iE];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,r)&&(void 0!==n||_b(e.t,t)))return!0;Wb(e),$b(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==qb(e.t,t)||t in e.t?(e.D[t]=!1,Wb(e),$b(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Tb(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty:function(){yb(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){yb(12)}},lE={};Eb(uE,(function(e,t){lE[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),lE.deleteProperty=function(e,t){return lE.set.call(this,e,t,void 0)},lE.set=function(e,t,n){return uE.set.call(this,e[0],t,n,e[0])};var cE=function(){function e(e){var t=this;this.g=eE,this.F=!0,this.produce=function(e,n,i){if("function"==typeof e&&"function"!=typeof n){var r=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=r);for(var i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return o.produce(e,(function(e){var i;return(i=n).call.apply(i,[t,e].concat(s))}))}}var s;if("function"!=typeof n&&yb(6),void 0!==i&&"function"!=typeof i&&yb(7),bb(e)){var a=Lb(t),u=Gb(t,e,void 0),l=!0;try{s=n(u),l=!1}finally{l?Mb(a):Fb(a)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return Nb(a,i),jb(e,a)}),(function(e){throw Mb(a),e})):(Nb(a,i),jb(s,a))}if(!e||"object"!=typeof e){if(void 0===(s=n(e))&&(s=e),s===tE&&(s=void 0),t.F&&Ob(s,!0),i){var c=[],d=[];kb("Patches").M(e,s,c,d),i(c,d)}return s}yb(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(r))}))};var i,r,o=t.produce(e,n,(function(e,t){i=e,r=t}));return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return[e,i,r]})):[o,i,r]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){bb(e)||yb(8),Sb(e)&&(e=function(e){return Sb(e)||yb(22,e),function e(t){if(!bb(t))return t;var n,i=t[iE],r=wb(t);if(i){if(!i.P&&(i.i<4||!kb("ES5").K(i)))return i.t;i.I=!0,n=zb(t,r),i.I=!1}else n=zb(t,r);return Eb(n,(function(t,r){i&&function(e,t){return 2===wb(e)?e.get(t):e[t]}(i.t,t)===r||Ib(n,t,e(r))})),3===r?new Set(n):n}(e)}(e));var t=Lb(this),n=Gb(this,e,void 0);return n[iE].C=!0,Fb(t),n},t.finishDraft=function(e,t){var n=(e&&e[iE]).A;return Nb(n,t),jb(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!eE&&yb(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));var r=kb("Patches").$;return Sb(e)?r(e,t):this.produce(e,(function(e){return r(e,t)}))},e}(),dE=new cE,hE=dE.produce;dE.produceWithPatches.bind(dE),dE.setAutoFreeze.bind(dE),dE.setUseProxies.bind(dE),dE.applyPatches.bind(dE),dE.createDraft.bind(dE),dE.finishDraft.bind(dE);const pE={ssrc:0,status:qa.End,shareDimension:{width:0,height:0},receivedShareDimension:{width:1920,height:1080,logicWidth:1920,logicHeight:1080},sharePrivilege:Ha.OnlyHost,activeNodeId:0,activeSsrc:0,shareQuality:1,isRemoteSharingActive:!1,isReceiveSharing:!1,isGrabRemoteControl:!1,isSDKGrabControl:!1,isChromeExtensionInstalled:!1,isScreenShareForbidden:!1,isReceiveSharingFromMainSession:!1,isSharingToBreakoutRoom:!1,isSharingWithSecondCamera:!1,secondCameraId:"default",isRequireReadReceipt:!1,capturedEnsuredCanvas:[],renderedEnsuredCanvas:[],remoteControllingSsrc:0,remoteControlApprovedSsrc:0,remoteControlAppDownloadUrl:"",remoteControlAppInstallStatus:bu.Unknown,isEnableAutoDeleteRcApp:!1,remoteControlledUserList:[],isRemoteControlEnabled:!1,isFullHDVideoShareEnabled:!1,userSsrcMapping:{},statistic:{encode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0},decode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0}}},fE=Rn({[`${Ep}`]:hE(((e,t)=>{let{payload:n}=t;e.sharePrivilege=n})),[`${wp}`]:hE(((e,t)=>{let{payload:n}=t;e.isRemoteSharingActive=1===n.bStatus,e.activeNodeId=n.activeNodeID,e.activeSsrc=n.ssrc})),[`${_p}`]:hE(((e,t)=>{let{payload:n}=t;e.isReceiveSharing=n})),[`${Ip}`]:hE(((e,t)=>{let{payload:n}=t;e.isChromeExtensionInstalled=n})),[`${Ap}`]:hE(((e,t)=>{let{payload:n}=t;e.shareDimension={...n}})),[`${Tp}`]:hE(((e,t)=>{let{payload:n}=t;e.status=n})),[`${Rp}`]:hE(((e,t)=>{let{payload:n}=t;e.ssrc=n})),[`${Op}`]:hE(((e,t)=>{let{payload:n}=t;e.shareQuality=n})),[`${Pp}`]:hE(((e,t)=>{let{payload:n}=t;e.receivedShareDimension={...n}})),[`${Xp}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlledUserList.includes(n)||e.remoteControlledUserList.push(n)})),[`${ef}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.remoteControlledUserList.indexOf(n);i>=0&&e.remoteControlledUserList.splice(i,1)})),[`${Dp}`]:hE(((e,t)=>{let{payload:n}=t;e.isGrabRemoteControl=n,!1===n&&(e.remoteControlViewportDomSelector=void 0)})),[`${kp}`]:hE(((e,t)=>{let{payload:n}=t;e.isSDKGrabControl=n})),[`${xp}`]:hE(((e,t)=>{let{payload:n}=t;e.isReceiveSharingFromMainSession=n})),[`${Np}`]:hE(((e,t)=>{let{payload:n}=t;e.isSharingToBreakoutRoom=n})),[`${Mp}`]:hE(((e,t)=>{let{payload:n}=t;e.isSharingWithSecondCamera=n})),[`${Fp}`]:hE(((e,t)=>{let{payload:n}=t;e.secondCameraId=n})),[`${Lp}`]:hE(((e,t)=>{let{payload:n}=t;e.isRequireReadReceipt=n})),[`${Vp}`]:hE(((e,t)=>{let{payload:n}=t;e.isOptimizedForSharedVideo=n})),[`${jp}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:i,rate:r,...o}}=n;e.statistic.encode={bitrate:r,...o}})),[`${Bp}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:i,rate:r,...o}}=n;e.statistic.decode={bitrate:r,...o}})),[`${Up}`]:hE(((e,t)=>{let{payload:n}=t;e.capturedEnsuredCanvas.includes(n)||e.capturedEnsuredCanvas.push(n)})),[`${Hp}`]:hE(((e,t)=>{let{payload:n}=t;e.renderedEnsuredCanvas.includes(n)||e.renderedEnsuredCanvas.push(n)})),[`${Kp}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControllingSsrc=n})),[`${$p}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlApprovedSsrc=n})),[`${Wp}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlAppDownloadUrl=n})),[`${Gp}`]:hE(((e,t)=>{let{payload:n}=t;(e.remoteControlAppInstallStatus!==bu.Installed||bu.Unknown)&&(e.remoteControlAppInstallStatus=n)})),[`${Yp}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlAppLaunchSheme=n})),[`${Zp}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:i,ssrc:r}=n;Object.assign(e.userSsrcMapping,{[`${i}`]:r})})),[`${tf}`]:hE(((e,t)=>{let{payload:n}=t;Object.assign(e,n)})),[`${nf}`]:hE(((e,t)=>{let{payload:n}=t;e.remoteControlViewportDomSelector=n})),[`${rf}`]:hE(((e,t)=>{let{payload:n}=t;e.isFullHDVideoShareEnabled=n})),[`${of}`]:()=>({...pE})},pE),gE={remoteControlEpics0:e=>e.pipe(Ut(`${jr}`),Ke((e=>{const{payload:{meetingOptions:t,rcAutoDelete:n,jwtRc:i,opRc:r}}=e,o=(null==t?void 0:t.isRemoteControlEnbaled)&&r&&1===i;return tf({isRemoteControlEnabled:o,isEnableAutoDeleteRcApp:1===n})}))),remoteControlEpics1:(e,t)=>pi(e,16391).pipe(Ye((e=>{const{payload:{body:{bOn:n,sendID:i,receiveID:r}}}=e,{meeting:{userId:o},share:{status:s,activeNodeId:a,isGrabRemoteControl:u}}=t.value,l=[];if(s===qa.End&&l.push(Kp(0)),s!==qa.End)if(hr(o,i))if(n){lb(),cb(),s===qa.Paused&&(mb.resumeSharing(),vb.resumeDesktopSharing(),l.push(Tp(qa.Sharing))),l.push(Kp(r));const e=bh(t.value).find((e=>hr(e.userId,r)));e&&l.push(Zp({userId:e.userId,ssrc:r}))}else l.push(Kp(0));else{var c;const e=null===(c=bh(t.value))||void 0===c?void 0:c.find((e=>hr(e.userId,i)));e&&(l.push(Zp({userId:e.userId,ssrc:i})),_d(lc,{userId:e.userId,displayName:e.displayName,isSharingEntireScreen:vb.isSharingEntireScreen()}))}else if(!r||hr(r,o)){const e=gh(t.value);if(!eh(e.userRole)&&!Uo.isAndroidOrIOSBrowser){const e=i&&hr(a,i);n?(l.push(Xp(a)),e&&(u||mb.subscribeGrabRemoteControl(a,!0))):(l.push(ef(a)),e&&(u&&(mb.subscribeGrabRemoteControl(a,!1),l.push(Dp(!1)),_d(nc,!1)),vb.updateRemoteControlProperties({isControllerNow:!1}))),_d(tc,n)}}return Me(l)}))),remoteControlEpics2:(e,t)=>pi(e,16395).pipe(Tt(t),ht((e=>{let[t,n]=e;return t.payload.body.id===n.meeting.userId})),Ke((e=>{let[t]=e;const{payload:{body:{bOn:n}}}=t;return vb.updateRemoteControlProperties({isControllerNow:n}),_d(nc,n),Dp(n)}))),remoteControlEpics3:e=>vi(e,[Da.StartRemoteControlSuccess,Da.StartRemoteControlFailed,Da.CancelRemoteControlSuccess]).pipe(Zv((e=>e.payload.type===Da.StartRemoteControlSuccess?(_d(rc),kp(!0)):e.payload.type===Da.CancelRemoteControlSuccess?kp(!1):void(e.payload.type===Da.StartRemoteControlFailed&&_d(oc))))),remoteControlEpics4:e=>vi(e,[Da.RemoteControlCopiedTextNotify,Da.RemoteControlPasteTextLengthOverflow]).pipe(At((e=>{if(e.payload.type===Da.RemoteControlCopiedTextNotify){const{payload:{data:t}}=e;_d(ic,{content:t.data,x:t.x,y:t.y})}else _d(ic,{error:"length of pasted text is too long"})})),St(ge)),remoteControlEpics5:(e,t)=>pi(e,4342).pipe(ht((e=>0===e.payload.body.result)),Ye((e=>{const{payload:{body:{downloadUrl:n,ssrc:i,urlScheme:r}}}=e,{share:{remoteControlApprovedSsrc:o,status:s}}=t.value,a=[],{isMacOS:u}=Uo;if(s!==qa.End){if(!o||o===i){lb();try{const e=JSON.parse(n||"{}"),t=u?e.macDownloadUrl:e.winDownloadUrl;a.push(Wp(t))}catch(e){console.warn("unsupported JSON string",e)}}const s={};u||Object.assign(s,{runAsAdmin:1});const l=bh(t.value).find((e=>hr(e.userId,i)));l&&Object.assign(s,{controllerName:ir(l.displayName)}),Object.assign(s,{ssrc:i});const{deviceId:c}=vb.getShareStreamInfo();c&&Object.assign(s,{DeviceID:c});const d=`${r}&${new URLSearchParams(s).toString()}`;a.push(Yp(d),Gp(bu.Unknown)),_d(hc,d)}return Me(a)}))),remoteControlEpics6:e=>e.pipe(Ut(`${zp}`),Ye((()=>ab.startCheck(1e4).pipe(Ke((()=>(_d(cc,bu.Unknown),Gp(bu.Unknown)))))))),remoteControlEpics7:(e,t)=>e.pipe(Ut(`${Jp}`),ht((()=>{const{share:{remoteControlAppInstallStatus:e}}=t.value;return e===bu.Installed})),Ye((()=>ub.startCheck(6e4).pipe(Ye((()=>{_d(cc,Eu.Unlaunched);const{share:{remoteControlApprovedSsrc:e,isEnableAutoDeleteRcApp:n},meeting:{userId:i}}=t.value,r=[],{isMacOS:o}=Uo;return e&&(mb.remoteControlConsent(Su.CacheClean,e,i,{...vb.getShareStreamInfo(),platform:o?"mac":"win"},n),r.push(Yp(""),$p(0))),Me(r)})))))),remoteControlEpics8:(e,t)=>e.pipe(Ut(`${Yp}`),ht((e=>!!e.payload)),Ye((e=>{const{payload:n}=e,i=[];let r;if(n){!function(e){if(!e.startsWith("zoomprc://"))return;const t=fr("__ZOOM_SDK_RC_APP_SCHEME_@__");let n=document.getElementById(t);n||(n=document.createElement("iframe"),n.id=t,n.style.display="none",document.body.appendChild(n)),n.contentWindow.location.href=e}(n),i.push(Jp());const e=performance.now();document.hasFocus()?r=ut(25).pipe(Ct((()=>{const n=performance.now()-e<500;return n||_d(cc,bu.Uninstalled),n&&t.value.share.remoteControlAppInstallStatus===bu.Unknown})),_t((()=>{const t=performance.now()-e,n=[];return document.hasFocus()||(t>75?n.push(zp()):lb(),_d(cc,bu.Installed),n.push(Gp(bu.Installed),Jp())),Me(n)})),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return Xe(t,Fe.apply(void 0,y([],v(e))))}}(Gp(bu.Uninstalled))):(_d(cc,bu.Unknown),i.push(Gp(bu.Unknown)))}return r?lt(r,Me(i)):Me(i)}))),remoteControlEpics9:(e,t)=>pi(e,cs).pipe(Ye((()=>(_d(dc,wu.Ended),db(t.value,mb),Me([Yp(""),$p(0)]))))),remoteControlEpics10:(e,t)=>e.pipe(Ut(`${Tp}`),ht((e=>{const{share:{remoteControllingSsrc:n,remoteControlApprovedSsrc:i}}=t.value;return!(e.payload!==qa.End||!n&&!i)})),At((()=>{const{share:{remoteControllingSsrc:e,remoteControlApprovedSsrc:n,isEnableAutoDeleteRcApp:i},meeting:{userId:r}}=t.value,{isMacOS:o}=Uo;e&&db(t.value,mb),n!==e&&mb.remoteControlConsent(Su.Decline,n,r,{...vb.getShareStreamInfo(),platform:o?"mac":"win"},i)})),St(ge)),remoteControlEpics11:(e,t)=>pi(e,16430).pipe(Ye((()=>(lb(),cb(),_d(cc,Eu.Launched),t.value.share.status!==qa.End&&function(e,t){(async function(e){const{media:{assetsPath:t}}=e,n=`${t}/qrscanner.min.js`;return"WebQrscanner"in window?Promise.resolve(""):new Promise(((e,t)=>{ib.log(`load qr scanner script start. url:${n}`),Sv(n,(()=>{ib.log("load qr scanner script done."),e("")}),t)}))})(e).then((()=>{ib.log("qr scanning start"),t.startRemoteControlQRCheck(!0)}))}(t.value,vb),Me([Yp(""),$p(0)]))))),remoteControlEpics12:e=>vi(e,Da.CurrentDesktopSharingWidthHeight).pipe(At((()=>{mb.syncSharedContentMetaWithRcApp(vb.getShareStreamInfo())})),St(ge)),remoteControlEpics13:(e,t)=>vi(e,Da.SendRemoteControlQrCode).pipe(At((e=>{const{payload:{data:n}}=e,{share:{status:i}}=t.value;i!==qa.End&&Array.isArray(n)&&n.length>0&&n.forEach((e=>{null!=e&&e.startsWith("zrc_")&&mb.sendRemoteControlAuth(e)}))})),St(ge)),remoteControlEpics14:e=>pi(e,16434).pipe(At((e=>{const{payload:{body:{result:t}}}=e;0===t&&(pb(),_d(dc,wu.Started))})),St(ge)),remoteControlEpics15:(e,t)=>pi(e,is).pipe(ht((e=>{var n,i;const{meeting:{userId:r},share:{remoteControlledUserList:o}}=t.value,{payload:{body:s}}=e;return o.length>0&&((null===(n=s.update)||void 0===n?void 0:n.some((e=>e.id!==r&&!1===e.bShareOn)))||(null===(i=s.remove)||void 0===i?void 0:i.some((e=>e.id!==r))))})),Ye((e=>{var n,i,r,o;const{payload:{body:s}}=e,{share:{remoteControlledUserList:a,activeNodeId:u,isGrabRemoteControl:l},meeting:{userId:c}}=t.value,d=(null!==(n=null===(i=s.update)||void 0===i?void 0:i.filter((e=>e.id!==c&&!1===e.bShareOn)))&&void 0!==n?n:[]).concat(null!==(r=null===(o=s.remove)||void 0===o?void 0:o.filter((e=>e.id!==c)))&&void 0!==r?r:[]),h=[];return a.forEach((e=>{d.find((t=>t.id===e))&&(h.push(ef(e)),e===u&&l&&(h.push(Dp(!1)),_d(nc,!1)))})),Me(h)}))),remoteControlEpics16:(e,t)=>e.pipe(Ut(`${Nr}`),At((()=>{const{share:{remoteControllingSsrc:e,status:n}}=t.value;n===qa.Sharing&&e&&_d(dc,wu.Ended)})),St(ge))},mE={epics0:(e,t)=>pi(e,rs).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.lockShare)})),Tt(t),At((e=>{let[t,n]=e;const{share:{sharePrivilege:i}}=n,{payload:{body:{lockShare:r}}}=t;i!==r&&_d(sc,r)})),Ke((e=>{let[t]=e;return Ep(t.payload.body.lockShare)}))),epics1:e=>pi(e,20227).pipe(Ke((e=>Rp(e.payload.body.ssrc)))),epics2:(e,t)=>pi(e,ts).pipe(Tt(t),ht((e=>{let[t,n]=e;const{payload:{body:i}}=t,{share:{isReceiveSharingFromMainSession:r}}=n;return!r||r&&i.fromMainSession})),Ke((e=>{let[t,n]=e;const{share:{isReceiveSharing:i,activeNodeId:r,isReceiveSharingFromMainSession:o},breakoutRoom:s}=n,{payload:{body:a}}=t;if(i&&1===a.bStatus){let e=!1;(null==s?void 0:s.currentRoom.status)===rh.InRoom&&s.mainSessionAttendeeList.length>0&&(e=s.mainSessionAttendeeList.findIndex((e=>e.userId===r))>-1),fb.unsubscribeSharing(r,e),ob(fb,n,a.activeNodeID),gb.switchSharingSource(a.ssrc,o),_d(ec,{userId:a.activeNodeID})}else if(1===a.bStatus){const e={activeUserId:a.activeNodeID,isActive:!0};o&&Object.assign(e,{isFromMainSession:!0}),_d(Hl,e)}else if(i){const e={activeUserId:a.activeNodeID,isActive:!1};o&&Object.assign(e,{isFromMainSession:!0}),_d(Hl,e)}return wp(a)}))),epics3:e=>vi(e,Da.CheckChromeSharingExtensionResponse).pipe(Ke((e=>(_d(ql,e.payload.data),Ip(e.payload.data))))),epics4:(e,t)=>vi(e,[Da.SharingDesktopStreamHaveAudio,Da.SharingDesktopStreamHaveNoAudio]).pipe(ht((e=>e.payload.type!==Da.SharingDesktopStreamHaveAudio||!t.value.audio.secondaryAudioMicrophoneId)),Tt(t),Ke((e=>{let[t,n]=e;const{meeting:{userId:i},share:{isSharingToBreakoutRoom:r,isOptimizedForSharedVideo:o}}=n,{payload:{type:s}}=t,a=s===Da.SharingDesktopStreamHaveAudio;return fb.startSharing(i,{bShareToBO:r,bShareAudio:a,bShareVideo:!!o}),gb.switchSharingMode(o?mu.VideoMode:mu.Normal),Cp(!1)}))),epics5:e=>vi(e,[Da.DesktopSharingError,Da.DesktopSharingChromeExtensionUninstalled,Da.DesktopSharingPermissionDenied,Da.DesktopSharingSystemError]).pipe(Ye((e=>{const t=[];let n="";return[Da.DesktopSharingPermissionDenied,Da.DesktopSharingSystemError].includes(e.payload.type)&&(t.push(Cp(!0)),e.payload.type===Da.DesktopSharingSystemError?Uo.isMacOS&&(n="To use screen share on Chrome, please allow screen recording access in system setting."):n="To use screen share, please allow the permission request."),_d(Kl,{reason:n}),Me(t)}))),epics6:e=>vi(e,Da.CurrentDesktopSharingWidthHeight).pipe(ht((e=>!!e.payload.data)),Ke((e=>{_d($l,e.payload.data);const{payload:{data:{width:t,height:n}}}=e;return gb.ajustmentSharingCanvas(t,n),Ap(e.payload.data)}))),epics7:(e,t)=>vi(e,Da.SharingDecodeMaxSize).pipe(ht((e=>!!e.payload.data)),Tt(t),Zv((e=>{let[t,n]=e;const{share:{shareQuality:i,activeNodeId:r}}=n,{payload:{data:{fps:o}}}=t,s=Number(o);if(i!==s)return ob(fb,n,r,s),Op(s)}))),epics8:e=>pi(e,20226).pipe(At((e=>{var t,n;if(_d(Wl,null===(t=e.payload)||void 0===t?void 0:t.body),null!==(n=e.payload)&&void 0!==n&&n.body){const{payload:{body:{width:t,height:n}}}=e;gb.ajustmentReceivedSharingCanvas(t,n)}})),Ke((e=>Pp(e.payload.body)))),epics9:e=>vi(e,Da.SharingPara).pipe(At((e=>{var t,n;if(_d(Wl,null===(t=e.payload.data)||void 0===t?void 0:t.body),null!==(n=e.payload.data)&&void 0!==n&&n.body){const{payload:{data:{body:{width:t,height:n}}}}=e;gb.ajustmentReceivedSharingCanvas(t,n)}})),Ke((e=>{var t;return Pp(null===(t=e.payload.data)||void 0===t?void 0:t.body)}))),epics10:(e,t)=>vi(e,Da.UserStopDesktopSharing).pipe(Tt(t),Ke((e=>{let[,t]=e;const{meeting:{userId:n},share:{status:i}}=t;return i!==qa.End&&(fb.stopSharing(n),gb.stopDesktopSharing(),_d(Gl)),Tp(qa.End)}))),epics11:(e,t)=>pi(e,is).pipe(Tt(t),ht((e=>{let[t,n]=e;const{meeting:{userId:i}}=n,r=t.payload.body.update;return r&&r.length>0&&r.findIndex((e=>e.id===i&&void 0!==e.bShareOn))>-1})),Ye((e=>{let[t,n]=e;const{meeting:{userId:i},share:{status:r,isReceiveSharing:o,activeNodeId:s}}=n,{payload:{body:{update:a}}}=t,u=a.find((e=>e.id===i&&!1===e.bShareOn)),l=a.find((e=>e.id===i&&!0===e.bShareOn)),c=[];return u&&r!==qa.End&&(fb.stopSharing(i),gb.stopDesktopSharing(),c.push(Tp(qa.End)),_d(zl)),l&&r===qa.End&&(o&&(gb.stopRenderSharing(),fb.unsubscribeSharing(s),c.push(_p(!1))),c.push(Tp(qa.Sharing))),Me(c)}))),epics12:(e,t)=>pi(e,is).pipe(Tt(t),ht((e=>{let[t,n]=e;const{meeting:{userId:i}}=n,r=t.payload.body.update;return r&&r.length>0&&r.findIndex((e=>e.id!==i&&void 0!==e.bShareOn))>-1})),Ye((n=>{let[i,r]=n;const{payload:{body:{update:o}}}=i,{share:{activeNodeId:s,isReceiveSharing:a}}=r,u=hy(r),l=o.filter((e=>!0===e.bShareOn&&!1===e.bSharePause)),c=o.filter((e=>!0===e.bShareOn&&!0===e.bSharePause)),d=o.filter((e=>!1===e.bShareOn));return l.length>0&&l.forEach((e=>{-1===u.findIndex((t=>t.userId===e.id))?_d(Ql,e):_d(Xl,e)})),c.length>0&&c.forEach((e=>{_d(Zl,e)})),d.length>0&&(d.forEach((e=>{_d(Yl,e)})),a&&d.some((e=>e.id===s)))?pt(pi(e,ts).pipe(gt(1),St(ge)),at(50).pipe(St(Le("timeout")))).pipe(ft((()=>{const{share:{activeNodeId:e,isReceiveSharingFromMainSession:n},audio:i}=t.value,r=u.filter((t=>t.userId!==e));if(r.length>0){const o=r[0],{userId:s}=o;return fb.unsubscribeSharing(e,n),ob(fb,t.value,s),gb.switchSharingSource(s,n),null==i||i.localShareAudioUserMutedList.forEach((e=>{gb.setSharingAudioVolume(s,e.userId!==s||e.muted,e.isFromMainSession)})),_d(ec,{userId:s}),Fe(wp({activeNodeID:s,bStatus:1,ssrc:s}))}return ge}))):ge}))),epics13:(e,t)=>pi(e,ns).pipe(Tt(t),_t((e=>{let[n,i]=e;const{payload:{body:{encryptKey:r,additionalType:o}}}=n,{media:{sharingDecodeStatus:s,sharingEncodeStatus:a},meeting:{confId:u,userId:l,zoomId:c,meetingId:d,meetingNumber:h,isWebinar:p}}=i;return Ov(t).pipe(_t((e=>{let n=a;return(!Uo.isSupportSendScreenSharing||p&&e&&eh(e.userRole))&&(n="failed"),Rv("sharing",n,s).pipe(At((e=>{let[n,i]=e;const s={userId:l,sn:ar(c),confId:u,encryptKey:ar(r),encryptType:o,meetingId:d,meetingNumber:h};if(n&&(null==gb||gb.updateMediaParams({iVType:zo.SHARING_ENCODE,isFromMainSession:!1,updateParams:s})),i){gb.updateMediaParams({iVType:zo.SHARING_DECODE,isFromMainSession:!1,updateParams:s});const{participants:{attendeesList:e}}=t.value;if(e.length>0){const t=e.map((e=>({userid:e.userId,sn:e.zoomID&&ar(e.zoomID)})));gb.updateUserMediaSN({added:t,isFromMainSession:!1,iVType:zo.SHARING_DECODE})}}})),St(ge))})))}))),epics14:(e,t)=>mi(e,20235).pipe(Tt(t),At((e=>{let[t,n]=e;const{media:{sharingDecodeStatus:i}}=n,{type:r,payload:{body:o}}=t,s=r===`${Vn}`;Rv("sharing","success",i).subscribe((e=>{let[,t]=e;t&&gb.addReceivedSharingChannelType({isFromMainSession:s,...o})}))})),St(ge)),epics15:(e,t)=>mi(e,20236).pipe(Tt(t),At((e=>{let[t,n]=e;const{media:{sharingDecodeStatus:i}}=n,{type:r,payload:{body:{ssrc:o}}}=t,s=r===`${Vn}`;Rv("sharing","success",i).subscribe((e=>{let[,t]=e;t&&gb.removeReceivedSharingChannelType({isFromMainSession:s,ssrc:o})}))})),St(ge)),epics16:e=>vi(e,Da.SharingFirstDecodeFrameReceivedSsrc).pipe(ht((e=>!!e.payload.data)),At((e=>{const{payload:{data:{ssrc:t}}}=e;fb.sendReceivingSharingReady(t)})),St(ge)),epics17:(e,t)=>pi(e,20233).pipe(ht((()=>!!t.value.share.isRequireReadReceipt)),At((e=>{const{payload:{body:{bReceiveOk:t}}}=e;t&&_d(ac)})),St(ge)),epics18:(e,t)=>pi(e,rs).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.lockShare)})),Ye((e=>{const{payload:{body:{lockShare:n}}}=e,{share:{isOptimizedForSharedVideo:i,isSharingToBreakoutRoom:r},audio:{isSharingAudio:o},meeting:{userId:s}}=t.value,a=[];return n===Ha.MultipleShare&&i&&(fb.startSharing(s,{bShareAudio:o,bShareToBO:r,bShareVideo:!1}),gb.switchSharingMode(mu.Normal),a.push(Vp(!1))),Me(a)}))),epics19:(e,t)=>vi(e,Da.ShareQosData).pipe(Tt(t),Ke((e=>{var t;let[n,i]=e;const{meeting:{isWebinar:r},media:{sharingEncodeStatus:o,sharingDecodeStatus:s},share:{status:a,isReceiveSharing:u},participants:{xmppAttendeeList:l}}=i;let c=Ih(i).length>0;r&&(c=c||Boolean(l.length));const d=a!==qa.End&&"success"===o&&c,h=u&&"success"===s;return null!==(t=n.payload.data)&&void 0!==t&&t.encoding?d?(_d(uc,n.payload),jp(n.payload)):jp(cu):h?(_d(uc,n.payload),Bp(n.payload)):Bp(cu)})))},vE=hi(mE,gE),yE=Ps.createAgent();let SE=function(e){return e.Add="add",e.List="list",e.Remove="memberremove",e.rename="rename",e.update="UPDATE",e}({}),bE=function(e){return e.Open="open",e.Message="message",e.Error="error",e.Close="close",e}({});class EE{constructor(){this.eventHandlers=void 0,this.websocket=void 0,this.seq=void 0,this.eventHandlers=new Map,this.websocket=null,this.seq=1}static getInstance(){return this.xmppInstance||(this.xmppInstance=new EE),this.xmppInstance}on(e,t){let n=this.eventHandlers.get(e);n||(n=[]),n.push(t),this.eventHandlers.set(e,n)}off(e,t){const n=this.eventHandlers.get(e);if(n){const i=n.filter((e=>e!==t));this.eventHandlers.set(e,i)}}emit(e,t){const n=this.eventHandlers.get(e);n&&n instanceof Array&&n.slice(0).forEach((e=>{try{e(t)}catch(e){console.error(e)}}))}sendMessageToRwg(e){this.seq+=1;const t=this.seq;return this.websocket&&this.websocket.readyState===WebSocket.OPEN&&this.websocket.send(JSON.stringify(Object.assign(e,{seq:t}))),t}connect(e){this.websocket=new WebSocket(e),this.websocket.binaryType="arraybuffer",this.addWebSocketEventListeners()}close(){var e;null===(e=this.websocket)||void 0===e||e.close()}addWebSocketEventListeners(){this.websocket&&(this.websocket.addEventListener("open",(e=>{this.emit(bE.Open,e)})),this.websocket.addEventListener("message",(e=>{const{data:t}=e;var n;if(t instanceof ArrayBuffer)0===new Uint8Array(t)[0]&&(null===(n=this.websocket)||void 0===n||n.send(t));else try{this.emit(bE.Message,JSON.parse(t))}catch(e){console.warn("Unsupported format",t)}})),this.websocket.addEventListener("close",(e=>{this.emit(bE.Close,e)})),this.websocket.addEventListener("error",(e=>{this.emit(bE.Error,e)})))}join(e){return{seq:this.sendMessageToRwg({evt:24576,body:{clientCap:e}})}}raiseHand(){return{seq:this.sendMessageToRwg({evt:24580,body:null})}}lowerHand(e){return{seq:this.sendMessageToRwg({evt:24578,jids:e||[]})}}sendWebinarMseeage(e,t,n){const i={msg:e,jid:t?[t]:[],type:n,bcm:arguments.length>3&&void 0!==arguments[3]&&arguments[3]};return{seq:this.sendMessageToRwg({evt:24582,body:i})}}sendAnswer(e,t,n){return{seq:this.sendMessageToRwg({evt:24584,body:{question_attendeejid:t.jid,question_attendeename:t.displayName,question_text:t.questionText,question_id:t.questionId,question_anonymous:t.isAnonymous,question_time:t.questionTime,text:e,isPrivate:n}})}}answerOnline(e,t){return{seq:this.sendMessageToRwg({evt:24586,body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,isLiveStart:t}})}}dismissQuestion(e){return{seq:this.sendMessageToRwg({evt:24590,body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,bOpen:!1}})}}deleteQuestion(e){return{seq:this.sendMessageToRwg({evt:24614,body:{question_id:e,bDelete:!0}})}}deleteComment(e){return{seq:this.sendMessageToRwg({body:{comment_id:e,bDelete:!0},evt:24616})}}reopenQuestion(e){return{seq:this.sendMessageToRwg({body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,bOpen:!0},evt:24590})}}askQuestion(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;const r=cr();return{seq:this.sendMessageToRwg({body:{id:r,text:e,isAnonymous:n,bAllowAttendeeViewAllQuestion:i,name:t},evt:24592}),questionId:r}}upOrDownVote(e,t){return{seq:this.sendMessageToRwg({body:{question_attendeejid:e.jid,question_attendeename:e.displayName,question_text:e.questionText,question_id:e.questionId,question_anonymous:e.isAnonymous,question_time:e.questionTime,bUpVote:t},evt:24598})}}rename(e,t){return{seq:this.sendMessageToRwg({body:{jid:e,displayName:t},evt:24600})}}setSkinTome(e){return{seq:this.sendMessageToRwg({body:{skinTone:e},evt:24618})}}}EE.xmppInstance=null;const wE=YS.getInstance();let _E,IE;const CE=Ps.createAgent();let AE=null;function TE(e){switch(e.responseType){case"json":if("response"in e)return e.response;var t=e;return JSON.parse(t.responseText);case"document":return e.responseXML;default:return"response"in e?e.response:(t=e).responseText}}var RE,OE=function(e,t,n,i){void 0===i&&(i="download_load"),this.originalEvent=e,this.xhr=t,this.request=n,this.type=i;var r=t.status,o=t.responseType;this.status=null!=r?r:0,this.responseType=null!=o?o:"";var s=t.getAllResponseHeaders();this.responseHeaders=s?s.split("\n").reduce((function(e,t){var n=t.indexOf(": ");return e[t.slice(0,n)]=t.slice(n+2),e}),{}):{},this.response=TE(t);var a=e.loaded,u=e.total;this.loaded=a,this.total=u},PE=E((function(e){return function(e,t,n){var i;this.message=e,this.name="AjaxError",this.xhr=t,this.request=n,this.status=t.status,this.responseType=t.responseType;try{i=TE(t)}catch(e){i=t.responseText}this.response=i}})),DE=function(){function e(e,t){return PE.call(this,"ajax timeout",e,t),this.name="AjaxTimeoutError",this}return e.prototype=Object.create(PE.prototype),e}(),kE=Ke((function(e){return e.response})),xE=(RE=function(e){var t;return t="string"==typeof e?{url:e}:e,new U((function(e){var n,i,r,o=f({async:!0,crossDomain:!1,withCredentials:!1,method:"GET",timeout:0,responseType:"json"},t),s=o.queryParams,a=o.body,u=o.headers,l=o.url;if(!l)throw new TypeError("url is required");if(s)if(l.includes("?")){var c=l.split("?");if(2<c.length)throw new TypeError("invalid url");r=new URLSearchParams(c[1]),new URLSearchParams(s).forEach((function(e,t){return r.set(t,e)})),l=c[0]+"?"+r}else l=l+"?"+(r=new URLSearchParams(s));var d={};if(u)for(var h in u)u.hasOwnProperty(h)&&(d[h.toLowerCase()]=u[h]);var p=o.crossDomain;p||"x-requested-with"in d||(d["x-requested-with"]="XMLHttpRequest");var g=o.withCredentials,m=o.xsrfCookieName,v=o.xsrfHeaderName;if((g||!p)&&m&&v){var y=null!==(i=null===(n=null===document||void 0===document?void 0:document.cookie.match(new RegExp("(^|;\\s*)("+m+")=([^;]*)")))||void 0===n?void 0:n.pop())&&void 0!==i?i:"";y&&(d[v]=y)}var S,b=function(e,t){var n;if(!e||"string"==typeof e||function(e){return"undefined"!=typeof FormData&&e instanceof FormData}(e)||function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}(e)||function(e){return BE(e,"ArrayBuffer")}(e)||function(e){return BE(e,"File")}(e)||function(e){return BE(e,"Blob")}(e)||function(e){return"undefined"!=typeof ReadableStream&&e instanceof ReadableStream}(e))return e;if(function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView(e)}(e))return e.buffer;if("object"==typeof e)return t["content-type"]=null!==(n=t["content-type"])&&void 0!==n?n:"application/json;charset=utf-8",JSON.stringify(e);throw new TypeError("Unknown body type")}(a,d),E=f(f({},o),{url:l,headers:d,body:b});S=t.createXHR?t.createXHR():new XMLHttpRequest;var w=t.progressSubscriber,_=t.includeDownloadProgress,I=void 0!==_&&_,C=t.includeUploadProgress,A=void 0!==C&&C,T=function(t,n){S.addEventListener(t,(function(){var t,i=n();null===(t=null==w?void 0:w.error)||void 0===t||t.call(w,i),e.error(i)}))};T("timeout",(function(){return new DE(S,E)})),T("abort",(function(){return new PE("aborted",S,E)}));var R=function(e,t){return new OE(t,S,E,e+"_"+t.type)},O=function(t,n,i){t.addEventListener(n,(function(t){e.next(R(i,t))}))};A&&[FE,LE,VE].forEach((function(e){return O(S.upload,e,NE)})),w&&[FE,LE].forEach((function(e){return S.upload.addEventListener(e,(function(e){var t;return null===(t=null==w?void 0:w.next)||void 0===t?void 0:t.call(w,e)}))})),I&&[FE,LE].forEach((function(e){return O(S,e,ME)}));var P=function(t){var n="ajax error"+(t?" "+t:"");e.error(new PE(n,S,E))};S.addEventListener("error",(function(e){var t;null===(t=null==w?void 0:w.error)||void 0===t||t.call(w,e),P()})),S.addEventListener(VE,(function(t){var n,i,r=S.status;if(r<400){null===(n=null==w?void 0:w.complete)||void 0===n||n.call(w);var o=void 0;try{o=R(ME,t)}catch(t){return void e.error(t)}e.next(o),e.complete()}else null===(i=null==w?void 0:w.error)||void 0===i||i.call(w,t),P(r)}));var D=E.user,k=E.method,x=E.async;for(var h in D?S.open(k,l,x,D,E.password):S.open(k,l,x),x&&(S.timeout=E.timeout,S.responseType=E.responseType),"withCredentials"in S&&(S.withCredentials=E.withCredentials),d)d.hasOwnProperty(h)&&S.setRequestHeader(h,d[h]);return b?S.send(b):S.send(),function(){S&&4!==S.readyState&&S.abort()}}))},RE.get=function(e,t){return xE({method:"GET",url:e,headers:t})},RE.post=function(e,t,n){return xE({method:"POST",url:e,body:t,headers:n})},RE.delete=function(e,t){return xE({method:"DELETE",url:e,headers:t})},RE.put=function(e,t,n){return xE({method:"PUT",url:e,body:t,headers:n})},RE.patch=function(e,t,n){return xE({method:"PATCH",url:e,body:t,headers:n})},RE.getJSON=function(e,t){return kE(xE({method:"GET",url:e,headers:t}))},RE),NE="upload",ME="download",FE="loadstart",LE="progress",VE="load",jE=Object.prototype.toString;function BE(e,t){return jE.call(e)==="[object "+t+"]"}const UE=YS.getInstance(),HE=e=>{const{meeting:{encryptedRWC:t,encryptedGEORWC:n,discardedRwcList:i,meetingOptions:r}}=e;let o=[];return(null==r?void 0:r.isEnableGeoFenceRWC)&&n&&(null==n?void 0:n.length)>0?o=n.filter((e=>!i.includes(e.rwc))).reduce(((e,t)=>{const{dl:n,rwc:i,rwcToken:r}=t,o=e.find((e=>e.dl===n));if(o)o.items.push({rwc:i,rwcToken:r});else{const t={dl:n,items:[]};t.items.push({rwc:i,rwcToken:r}),e.push(t)}return e}),[]):t&&(o=[{dl:0,items:Object.keys(t).map((e=>({rwc:e,rwcToken:t[e]})))}]),o},qE=e=>lt(...e.map((e=>0===e.dl?Me(e.items):at(e.dl).pipe(Ye((()=>Me(e.items))))))),KE=(e,t)=>e.pipe(Ut(`${xr}`),Tt(t),ht((e=>{let[,t]=e;return void 0!==t.meeting.encryptedRWC||void 0!==t.meeting.encryptedGEORWC&&t.meeting.encryptedGEORWC.length>0})),_t((e=>{let[,n]=e;const{meeting:{ts:i,auth:r,meetingNumber:o,meetingOptions:s,meetingId:a,userName:u},breakoutRoom:l}=n,c=null==s?void 0:s.isEnableGeoFenceRWC,d=HE(n);if(d.length>0){const e={serversLength:d.reduce(((e,t)=>e+t.items.length),0),pingFailedServerList:[],pingRwcServerCounts:0,retryCounts:0};let n;return c&&(n=new Z,qE(d).subscribe((e=>{var t;return null===(t=n)||void 0===t?void 0:t.next(e)}))),(c?n:qE(d)).pipe(Ct((()=>{const{meeting:{meetingStatus:i,meetingId:r}}=t.value,o=i===Co.Initial&&!!r&&e.pingFailedServerList.length<e.serversLength&&e.serversLength>0;return!o&&n&&n.complete(),o})),At((()=>{if(e.pingRwcServerCounts=e.pingRwcServerCounts+1,c&&e.pingRwcServerCounts===e.serversLength){const i=1e3*Math.floor(5*Math.pow(2,e.retryCounts));e.retryCounts=e.retryCounts+1,UE.makeLogger(["Join Meeting Flow"]).info(`ping rwc retry,current rwc list:${JSON.stringify(HE(t.value))},retry counts:${e.retryCounts}, ${JSON.stringify({meetingId:a,meetingNumber:GS(o),userName:GS(u)})}`,["Ping RWC Retry"]),at(i).pipe(Ke((()=>{const n=HE(t.value);return Object.assign(e,{serversLength:n.reduce(((e,t)=>e+t.items.length),0),pingFailedServerList:[],pingRwcServerCounts:0}),n}))).subscribe((e=>{qE(e).subscribe((e=>{n.next(e)}))}))}})),Ye((t=>{const{rwc:s,rwcToken:d}=t,h=((e,t,n,i,r,o)=>{const s={ts:i,auth:r,rwcToken:n,dmz:1};return o&&Object.assign(s,{confID:o}),`https://${e}/wc/ping/${t}?${new URLSearchParams(s).toString()}`})(s,o,d,i,r,null==l?void 0:l.currentRoom.boConfId);return xE({url:h,crossDomain:gr(h)}).pipe(Ye((e=>{let t={};return t=e.response?{...e.response,rwc:s,fromNginx:!1}:{rwc:s,rwg:s,rwcToken:d,fromNginx:!0},Me([Bn(t),On()])})),ft((()=>{const{pingFailedServerList:t,serversLength:i}=e;return t.push(h),t.length===i&&(c&&n&&n.complete(),UE.report(`ping rwc error, ${JSON.stringify({meetingId:a,meetingNumber:GS(o),userName:GS(u)})}`,["Join Meeting Flow","Ping RWC Error"],"error"),_d(Ws,{reason:"connection error",errorCode:Cr.CommonError})),ge})))})),wt(Wr(performance.now())))}return ge})));let $E=0;const WE=YS.getInstance(),GE={meetingStatus:Co.Initial,isWindowOpen:!1,apiKey:"",signature:"",signatureType:"",lang:"en-US",tk:"",customerKey:"",mtkGuid:"",pingRWCTimestamp:0,meetingInfoTimestamp:0,passWord:"",meetingNumber:0,userName:"",userEmail:"",sdkUrl:"",sdkOrigin:"",proxy:1,cv:"",meetingId:"",tid:"",ts:"",auth:"",sign:"",isSupportCallOut:!1,tollNumbers:void 0,recordingEnable:!1,callOutCountry:void 0,inviteEmail:"",xmppConfig:null,isSupportH323:!1,h323GatewayInfo:"",h323Password:"",trackAuth:"",isOriginHost:!1,isWebinar:!1,encryptedRWC:void 0,meetingOptions:{},meetingTopic:"",bLock:!1,bHoldUponEntry:!1,viewOnly:0,listenOnlyPhone:0,bAllowRaiseHand:!1,bAllowAttendeeRename:!1,bBroadcast:void 0,bAllowPlayChimeForEnterOrExit:!1,bIbDisableShare:!1,bIbDisableChat:!1,bAllowShowCount:!1,encryptKey:"",bNoHostTimeOut:!1,confId:"",conId:"",e2eEncrypt:!1,zoomId:"",jid:"",xtoken:"",groups:void 0,svcUrl:"",encType:NaN,userGUID:"",userId:NaN,isHost:!1,isCoHost:!1,participantID:0,isOnHold:!1,isMeetingReset:!1,bRecord:!1,audioVideoBeforeOnHold:void 0,region:void 0,network:void 0,joinMeetingTimeStamp:0,activeAppInfo:void 0,recordingDisclaimerForRecorder:{},recordingDisclaimer:{},ccUrl:"",sessionIdleTimeoutMins:40,reportDomain:"",isAudioBridgeEnabled:!0,discardedRwcList:[],sharePronounType:void 0,stayAwake:!1,wrInfo:{},meetingInfo:{},isNewJoinFlow:!1,gatewayUserList:[],logConfig:"",logEncryptionPubKey:"",failover:{count:0,isCurrentFailoverRecorded:!1,reason:-1,interval:0,joinMeetingSuccessTimestamp:0,sequence:""},enableLongPollingCheckStart:!1,rsPwd:"",chatModerationPolicy:{}},zE=Rn({[`${jr}`]:hE(((e,t)=>{let{payload:n}=t;n.customerKey=e.customerKey||n.customerKey||"",Object.assign(e,n),e.meetingStatus=Co.Initial})),[`${Br}`]:hE(((e,t)=>{let{payload:n}=t;n.customerKey=e.customerKey||n.customerKey||"",Object.assign(e,n)})),[`${Ur}`]:hE(((e,t)=>{let{payload:n}=t;e.isWindowOpen=n})),[`${Hr}`]:hE(((e,t)=>{let{payload:n}=t;n.useSDK?e.signatureType="sdk":e.signatureType="api",e.apiKey=n.apiKey,e.signature=n.signature,e.lang=n.language})),[`${qr}`]:hE(((e,t)=>{let{payload:n}=t;e.ztk=n})),[`${Kr}`]:hE(((e,t)=>{let{payload:n}=t;e.zsk=n})),[`${$r}`]:hE(((e,t)=>{let{payload:n}=t;e.tk=n.tk,e.mtkGuid=n.mtkGuid})),[`${Wr}`]:hE(((e,t)=>{let{payload:n}=t;e.pingRWCTimestamp=n})),[`${So}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingInfoTimestamp=n})),[`${Gr}`]:hE(((e,t)=>{let{payload:n}=t;e.confId=n.confID,e.conId=n.conID,e.e2eEncrypt=n.e2eEncrypt,e.meetingNumber=parseInt(n.mn,10),e.zoomId=n.zoomID,e.meetingStatus=Co.Joined,e.jid=n.jid,e.xtoken=n.xtoken,e.groups=n.groups,e.svcUrl=n.svcUrl,e.encType=n.encType,e.userGUID=n.userGUID,e.userId=n.userID,e.role=n.role,e.participantID=n.participantID,e.reportDomain=n.reportDomain,e.abToken=n.ABtoken,e.supportLocalAB=!!n.supportLocalAB,n.enableWebTransport&&(e.enableWebtransport=n.enableWebTransport,e.webtransportPort=n.WebTransportPort)})),[`${zr}`]:hE(((e,t)=>{let{payload:n}=t;if(n.gatewayUser){var i;const{userId:t,sn:o}=n.gatewayUser,s=null===(i=e.gatewayUserList)||void 0===i?void 0:i.find((e=>e.userId===t));var r;s?s.sn=o:null===(r=e.gatewayUserList)||void 0===r||r.push(n.gatewayUser)}else Object.assign(e,n)})),[`${Qr}`]:hE(((e,t)=>{let{payload:n}=t;e.isHost=n})),[`${Yr}`]:hE(((e,t)=>{let{payload:n}=t;e.isCoHost=n})),[`${Zr}`]:hE(((e,t)=>{let{payload:n}=t;e.isOnHold=n})),[`${Xr}`]:hE(((e,t)=>{let{payload:n}=t;e.isMeetingReset=n})),[`${eo}`]:hE(((e,t)=>{let{payload:n}=t;e.audioVideoBeforeOnHold=n})),[`${to}`]:hE(((e,t)=>{let{payload:n}=t;e.currentUserAudioBeforeReset=n})),[`${no}`]:hE(((e,t)=>{let{payload:n}=t;e.isCurrentUserMutedBeforeReset=n})),[`${io}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingStatus=n})),[`${ro}`]:hE(((e,t)=>{let{payload:n}=t;e.region=n.region,e.network=n.network})),[`${oo}`]:hE(((e,t)=>{let{payload:n}=t;e.isCurrentUserStartVideoBeforeReset=n})),[`${so}`]:hE(((e,t)=>{let{payload:n}=t;e.joinMeetingTimeStamp=n})),[`${ao}`]:hE(((e,t)=>{let{payload:n}=t;e.activeAppInfo=n})),[`${uo}`]:hE(((e,t)=>{let{payload:n}=t;e.idleStartTime=n})),[`${lo}`]:hE(((e,t)=>{let{payload:n}=t;e.sessionIdleTimeoutMins=n})),[`${co}`]:hE(((e,t)=>{let{payload:n}=t;e.isAudioBridgeEnabled=n})),[`${ho}`]:hE(((e,t)=>{var n,i;let{payload:r}=t;const o=null===(n=e.encryptedGEORWC)||void 0===n||null===(i=n.find((e=>e.rwc===r)))||void 0===i?void 0:i.dc;if(o){var s;const t=null===(s=e.encryptedGEORWC)||void 0===s?void 0:s.filter((e=>e.dc===o));t&&e.discardedRwcList.some((e=>(null==t?void 0:t.findIndex((t=>t.rwc===e)))>=0))&&e.discardedRwcList.push(...t.map((e=>e.rwc))),e.discardedRwcList.push(r)}})),[`${po}`]:hE(((e,t)=>{let{payload:n}=t;e.sharePronounType=n})),[`${fo}`]:hE(((e,t)=>{let{payload:n}=t;e.stayAwake=n})),[`${go}`]:hE(((e,t)=>{let{payload:n}=t;e.failover.joinMeetingSuccessTimestamp=n})),[`${mo}`]:hE((e=>{Object.assign(e.failover,{...GE.failover,count:e.failover.count,joinMeetingSuccessTimestamp:e.failover.joinMeetingSuccessTimestamp})})),[`${vo}`]:hE(((e,t)=>{let{payload:n}=t;const{count:i,reason:r,interval:o,sequence:s}=n;e.failover.count=i,e.failover.reason=r,e.failover.interval=o,e.failover.isCurrentFailoverRecorded=!0,e.failover.sequence=s})),[`${yo}`]:hE(((e,t)=>{let{payload:n}=t;e.quicklyLeave=n})),[`${bo}`]:hE(((e,t)=>{let{payload:n}=t;e.isEnableZmkFromRWG=n})),[`${Jr}`]:(e,t)=>{let{payload:n}=t;const{isFailover:i}=n,r={isMeetingReset:!0,apiKey:e.apiKey,signatureType:e.signatureType,signature:e.signature,lang:e.lang,proxy:1,stayAwake:e.stayAwake};return i&&Object.assign(r,{currentUserAudioBeforeReset:e.audioVideoBeforeOnHold?e.audioVideoBeforeOnHold.audio:n.audio,isCurrentUserMutedBeforeReset:e.audioVideoBeforeOnHold?e.audioVideoBeforeOnHold.muted:n.muted,isCurrentUserStartVideoBeforeReset:e.audioVideoBeforeOnHold?e.audioVideoBeforeOnHold.video:n.video,meetingNumber:e.meetingNumber,userName:e.userName,passWord:e.passWord,userEmail:e.userEmail,sdkUrl:e.sdkUrl,sdkOrigin:e.sdkOrigin,cv:e.cv,zsk:e.zsk,ztk:e.ztk,idleStartTime:e.idleStartTime,sessionIdleTimeoutMins:e.sessionIdleTimeoutMins,customerKey:e.customerKey,failover:e.failover,stayAwake:e.stayAwake,quicklyLeave:e.quicklyLeave}),{...GE,...r}}},GE),JE={meetingFailoverReportEpic0:(e,t)=>e.pipe(Ut(`${jr}`),_t((()=>{const n=0===t.value.meeting.failover.joinMeetingSuccessTimestamp&&!!Do.get(ko.WebclientZoomId);return e.pipe(Ut(`${Gr}`),gt(1),Ye((()=>{const e=[],{count:i,sequence:r}=Do.get(ko.WebclientFailoverCount)||{};let{meeting:{failover:{count:o,reason:s,interval:a}}}=t.value;const{meeting:{pingRWCTimestamp:u}}=t.value;if(n){o=i+1,s=To.RefreshPage,a=0;const t=r?`${r}-${s}`:`${s}`;Do.set(ko.WebclientFailoverCount,{count:o,sequence:t},Oo.SessionStorage),e.push(vo({count:o,reason:s,interval:a,sequence:t}))}const l=performance.now();let c=`WCL_M, JMCT(${l-u})`;return o>0&&s!==To.NormalCase&&(c=`${c},FAILOVER(${o},${s},${(a/1e3).toFixed(1)})`),CE.sendRWGConnectionPerformance(c),e.push(mo(),go(l)),Me(e)})))}))),meetingFailoverReportEpic1:(e,t)=>e.pipe(Ut(`${Nr}`),Ye((e=>{const{payload:n}=e,{meeting:{failover:{joinMeetingSuccessTimestamp:i,isCurrentFailoverRecorded:r},userGUID:o,userId:s}}=t.value,a=[];if(!r){let{count:e,sequence:t}=Do.get(ko.WebclientFailoverCount)||{};t=t?`${t}-${n}`:`${n}`,n!==To.NormalCase&&(e+=1,Do.set(ko.WebclientFailoverCount,{count:e,sequence:t},Oo.SessionStorage));const r=performance.now()-i;a.push(vo({reason:n,count:e,interval:r,sequence:t,userGUID:o,userId:s}))}return Me(a)})))},QE={sessionIdleEpic0:(e,t)=>e.pipe(Ut(`${Gr}`),Tt(t),ht((e=>{let[,t]=e;return void 0!==t.meeting.zlkJwtToken})),_t((()=>(_E&&_E.complete(),_E=new z,IE=ut(6e4).pipe(Ke((()=>performance.now()))).subscribe(_E),_E.pipe(Ke((e=>Vr(e)))))))),sessionIdleEpic1:e=>e.pipe(Ut(`${Dn}`)).pipe(At((()=>{_E&&(_E.complete(),IE.unsubscribe())})),St(ge)),sessionIdleEpic2:(e,t)=>e.pipe(Ut(`${Vr}`),Tt(t),Ye((e=>{var t;let[n,i]=e;const{meeting:{idleStartTime:r,sessionIdleTimeoutMins:o,isOriginHost:s,isWebinar:a},participants:{attendeesList:u,xmppAttendeeList:l},recording:c,breakoutRoom:d}=i,h=n.payload,p=[];if(1!==u.length||a&&0!==l.length||(null==d||null===(t=d.currentRoom)||void 0===t?void 0:t.status)===rh.InRoom||(null==c?void 0:c.cmrStatus)===Sa.Start)p.push(uo(void 0));else if(r){const e=s&&Yd(u[0].userRole)?o:40;h-r>60*e*1e3&&(console.warn(`No active for ${e} minutes, will end the session.`),wE.report(`Session idle timeout(${e} minutes), end the session automatically!`,["Join Meeting Flow","Session idle"],"warn"),p.push(Lr()),at(500).subscribe((()=>{Td()})))}else p.push(uo(h));return Me(p)}))),sessionIdleEpic3:(e,t)=>e.pipe(Ut(`${xn}`),ht((e=>[is,rs].includes(e.payload.evt)&&void 0!==t.value.meeting.idleStartTime)),ke(de),Ye((()=>{var e;const{participants:{attendeesList:n,xmppAttendeeList:i},recording:r,breakoutRoom:o}=t.value,s=[];return(n.length>1||i.length>0||(null==r?void 0:r.cmrStatus)===Sa.Start||(null==o||null===(e=o.currentRoom)||void 0===e?void 0:e.status)===rh.InRoom)&&s.push(uo(void 0)),Me(s)}))),sessionIdleEpic4:e=>e.pipe(Ut(`${Mr}`,`${Lr}`),mt(uo(void 0)))},YE={meetingMainEpics0:(e,t)=>pi(e,0).pipe(At((e=>{var n;if("READY"===(null===(n=e.payload.body)||void 0===n?void 0:n.status)){const{meeting:{zlkJwtToken:e,signatureType:n,sign:i,passWord:r,isHost:o,isOriginHost:s,ztk:a,zsk:u,tk:l,userEmail:c},breakoutRoom:d}=t.value,h=e?{zlkJwtToken:e}:{signType:n,sign:i};if(r&&""!==r&&(e?Object.assign(h,{mpwd:ir(r)}):o&&s||Object.assign(h,{mpwd:r})),(null==d?void 0:d.currentRoom.status)===rh.Joining){const{currentRoom:{boId:e,boConfId:t,boToken:n}}=d;e&&t&&n&&Object.assign(h,{botk:n})}if(!e){a&&Object.assign(h,{zak:a}),(sessionStorage.getItem(ko.WebclientZsk)||u)&&Object.assign(h,{zak:u}),l&&Object.assign(h,{tk:l});const e=Do.get(ko.WebclientWebinarToken);void 0!==e&&Object.assign(h,{tk:e});const t=sessionStorage.getItem(ko.WebclientRecordingToken);t&&Object.assign(h,{localRecordToken:t}),c&&Object.assign(h,{email:c})}yE.sendLaunchParams(h);const p=Do.get(ko.WebclientMeetingToken);p&&yE.joinMeeting(p)}})),St(ge)),meetingMainEpics1:(e,t)=>{return pi(e,as).pipe(Tt(t),(n=e=>{let[t,n]=e;const{payload:{body:{res:i,userID:r,zoomID:o,mn:s,participantID:a,meetingtoken:u,role:l}}}=t,{meeting:{userEmail:c,userName:d,isMeetingReset:h,apiKey:p,zsk:f,signatureType:g}}=n;if(wr.Success===i){const{WebclientParticipantId:e,WebclientZoomId:n,WebclientUserEmail:i,WebclientUserName:m,WebclientMeetingToken:v}=ko;Do.set(n,o,Oo.SessionStorage),Do.set(e,a,Oo.SessionStorage),c&&Do.set(i,c,Oo.SessionStorage),Do.set(m,d,Oo.SessionStorage),u&&Do.set(v,u,Oo.SessionStorage),f&&yE.sendSdkKeyToMonitor(g,p,r);const y=[Gr(t.payload.body),so(performance.now())];return h&&y.push(Xr(!1)),(l&zd.Owner)===zd.Owner&&(_d(Ws,{reason:"dont support assisnt join through widget",errorCode:-1}),yE.leaveMeeting()),_d($s,{meetingNumber:s}),Me(y)}if(wr.MeetingLocked===i)_d(Ws,Rr(i));else if(wr.UserFull===i)_d(Ws,Object.assign({},Rr(i),{lmUrl:t.payload.body.lmURL}));else if(wr.MeetingIsOver===i)_d(Ws,Rr(i));else if(wr.MMRIBReject===i)_d(Ws,Rr(i));else if(wr.MMRConfParticipantExists===i)_d(Ws,Rr(i));else if([wr.UserHasBeenRemoved,wr.WebinarBlockedEmail].includes(i))_d(Ws,Rr(i));else if(wr.MeetingNotStarted===i){var m;const e=Rr(i),{meeting:{meetingNumber:t,passWord:r,userName:o,userEmail:s,inviteEmail:a,meetingTopic:u,region:l,network:c,userId:d,lang:h,meetingId:p,participantID:f,wrInfo:g,meetingInfo:v,isNewJoinFlow:y,enableLongPollingCheckStart:S,tid:b,signature:E,rsPwd:w}}=n;Object.assign(e,{meetingInfo:{meetingNumber:t,password:r,userName:o,userEmail:s,inviteEmail:a,meetingTopic:u,region:l,network:c,userId:d,lang:h,webEndpoint:Tv(),meetingId:p,participantId:f,wrInfo:Object.assign({},g,{isNew:y}),scheduleInfo:v,enableLongPollingCheckStart:S,rid:Yv(b),role:Number(null===(m=mr(E))||void 0===m?void 0:m.role),rsPwd:w}}),_d(Ws,e)}else _d(Ws,Rr(i));return Me(zv(n,!1))},j(_t(((e,t)=>n(e)||ge)))));var n},meetingMainEpics2:(e,t)=>pi(e,rs).pipe(Tt(t),Ke((e=>{let[t,n]=e;const{payload:{body:i}}=t,{meeting:{zoomId:r,encType:o,gcmSessinKey:s}}=n;if(void 0!==(null==i?void 0:i.encryptKey)&&es.init(r,i.encryptKey,o),void 0!==(null==i?void 0:i.gatewayKey)){const e=Ls.getInstance(),[,t,n]=i.gatewayKey.split(".");e.sendUserNodeList([{userid:Number(t),sn:n&&ar(n)}],s)}return _d(Qs,i),zr(i)}))),meetingMainEpics3:(e,t)=>pi(e,7939).pipe(Tt(t),Ye((e=>{let[t,n]=e;const{payload:{body:i}}=t;if(void 0!==i.reason){if(_r.Reconnect===i.reason)return Ir.WaitingRoomFailover===i.subReason?_d(Gs,{reason:Eo.OnHold}):_d(Gs,{reason:Eo.Failover}),Fe(Nr(To.NormalCase));_r.KickedByHost===i.reason?_d(zs,{reason:"kicked by host"}):[_r.EndByHost,_r.EndByNone,_r.EndByAdmin,_r.EndByHostStartAnotherMeeting].includes(i.reason)?_d(zs,{reason:"ended by host"}):_r.FreeMeetingTimeout===i.reason?_d(zs,{reason:"free meeting ended"}):[_r.DuplicateSession,_r.MeetingTransfer].includes(i.reason)&&_d(zs,{reason:"duplicated session"})}return n.meeting.isMeetingReset?ge:Me(zv(n,!1))}))),meetingMainEpics4:(e,t)=>e.pipe(Ut(`${Nr}`),Tt(t),Ye((e=>{let[,t]=e;const n=zv(t,!0);let i;if(t.meeting.zlkJwtToken){const e=function(e){if(e){const{meeting:{topic:t,passWord:n,userName:i,zlkJwtToken:r,lang:o,cv:s,customerKey:a}}=e;return{topic:t,passWord:n,userName:i,zlkJwtToken:r,lang:o,cv:s,customerKey:a}}return null}(t),n={topic:null==e?void 0:e.topic,password:null!=e&&e.passWord?encodeURIComponent(null==e?void 0:e.passWord):"",userName:null==e?void 0:e.userName,zlk:null==e?void 0:e.zlkJwtToken,lang:null==e?void 0:e.lang,cv:null==e?void 0:e.cv,customerKey:null==e?void 0:e.customerKey};i=Fe(kr(n)).pipe(yt(1e3))}else{const e=function(e){var t;const{meeting:{apiKey:n,signature:i,signatureType:r,meetingNumber:o,userName:s,lang:a,passWord:u,userEmail:l,sdkUrl:c,sdkOrigin:d,proxy:h,cv:p,ztk:f,zsk:g,tk:m}}=e;let v=f||sessionStorage.getItem(ko.WebclientZtk),y=g||sessionStorage.getItem(ko.WebclientZsk);const S=1===Number(null===(t=mr(i))||void 0===t?void 0:t.role);return S||(v=y,y=""),{apiKey:n,signature:i,signatureType:r,meetingNumber:o,userName:s,lang:a,passWord:u?encodeURIComponent(u):"",userEmail:l,sdkUrl:c,sdkOrigin:d,proxy:h,cv:p,ztk:v,zsk:y,tk:m||sessionStorage.getItem(ko.WebclientTk),ulsm:S&&y?1:0}}(t);i=Fe(Dr(e)).pipe(yt(1e3))}return Xe(Me(n),i)}))),meetingMainEpics5:e=>mi(e,7940).pipe(At((e=>{_d("MEETING_HOST_CHANGE_INDICATION",e.payload.body.bHost)})),Ke((e=>Qr(e.payload.body)))),meetingMainEpics6:e=>mi(e,7941).pipe(At((e=>{_d("MEETING_COHOST_CHANGE_INDICATION",e.payload.body.bCoHost)})),Ke((e=>Yr(e.payload.body)))),meetingMainEpics7:e=>mi(e,7945).pipe(At((e=>{const{payload:{body:{opt:t}}}=e;Do.set(ko.WebclientOpt,t,Oo.SessionStorage)})),St(ge)),meetingMainEpics8:(e,t)=>pi(e,7942).pipe(At((e=>{const{payload:{body:{bHold:t}}}=e;Do.set(ko.WebclientIsOnHold,t?1:0,Oo.SessionStorage),_d(Js,t)})),Tt(t),Ye((e=>{let[t,n]=e;const i=[Zr(t.payload.body.bHold)];if(t.payload.body.bHold){const e=gh(n);if(e){i.push(eo({audio:e.audio,video:e.bVideoOn,muted:e.muted}));const t=nb(Ls.getInstance());if("computer"===e.audio&&(t.leaveComputerAudio(),yE.joinOrLeaveVoip(!1)),e.bVideoOn&&t.stopCaptureVideo(),e.sharerOn&&(yE.stopSharing(e.userId),t.stopDesktopSharing(),i.push(Tp(qa.End))),n.video&&n.video.subscribedVideoList.length>0&&n.video.subscribedVideoList.forEach((e=>{yE.unsubscribeVideo(e)})),n.share&&n.share.isReceiveSharing){const e=n.share.activeNodeId;n.share.remoteControlledUserList.length>0&&(n.share.remoteControlledUserList.forEach((e=>{yE.sharingRequestRemoteControl(e,!1)})),fy(n)&&t.stopRemoteControl()),yE.unsubscribeSharing(e),t.stopRenderSharing()}}}return Me(i)}))),meetingMainEpics9:e=>pi(e,7954).pipe(Ke((e=>ro(e.payload.body)))),meetingMainEpics10:e=>pi(e,4216).pipe(At((e=>{_d("MEETING_CLAIM_HOST_KEY_RESPONSE",e.payload.body.bresult)})),St(ge)),meetingMainEpics11:(e,t)=>e.pipe(Ut(`${Mr}`,`${Lr}`),Tt(t),Ye((e=>{let[t,n]=e;const i=Ah(n);return t.type===`${Mr}`?(yE.leaveMeeting(i),_d(zs,{})):t.type===`${Lr}`&&(yE.endMeeting(),_d(zs,{})),Me(zv(n,!1))}))),meetingMainEpics12:(e,t)=>e.pipe(Ut(`${Fr}`),Tt(t),Ye((e=>{let[t,n]=e;if(t.type===`${Fr}`&&n.meeting.meetingNumber&&!n.meeting.zlkJwtToken){const e={mn:n.meeting.meetingNumber.toString(),name:n.meeting.userName,customerKey:n.meeting.customerKey?ir(n.meeting.customerKey):""},{jbhLeave:t}={jbhLeave:`https://${wv}/wc/jbhLeave`},i=`${t}/?${new URLSearchParams(e).toString()}`;fetch(i,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"}})}return ge}))),meetingMainEpics13:e=>pi(e,2).pipe(At((()=>{console.warn("Upgrade to latest version to optimize meeting experience")})),St(ge)),meetingMainEpics14:e=>pi(e,1).pipe(At((e=>{const{payload:{body:{upgradeVersion:t}}}=e,n=Rr(1e4);if(n&&n.reason){const e=n.reason.replace(/{(\d+)}/g,(()=>t));n.reason=e}_d(Ws,n)})),St(ge)),meetingMainEpics15:e=>pi(e,4265).pipe(Ke((e=>{const{payload:{body:t}}=e,{nShareType:n}=t;return _d(Ys,{userSharePronounType:n}),po(n)}))),meetingMainEpics16:e=>pi(e,4128).pipe(At((e=>{const{payload:{body:{meetingtoken:t}}}=e,{WebclientMeetingToken:n}=ko;t&&Do.set(n,t,Oo.SessionStorage)})),St(ge)),meetingMainEpics17:(e,t)=>e.pipe(Ut(`${Gr}`),ht((()=>!!t.value.meeting.quicklyLeave)),_t((()=>rt(window,"beforeunload").pipe(At((()=>{yE.leaveMeeting()})),St(ge))))),meetingMainEpics18:(e,t)=>pi(e,8025).pipe(ht((e=>!!e.payload.body.Zmk&&!!t.value.meeting.isEnableZmkFromRWG)),Ke((e=>{const{payload:{body:{Zmk:t}}}=e;return zr({zmk:t})})))},ZE=hi(YE,{wakeLockEpic0:(e,t)=>e.pipe(Ut(`${Gr}`),Tt(t),ht((e=>{let[,t]=e;return!!t.meeting.stayAwake})),At((async()=>{try{const{isSafari:e,isIOSMobile:t}=Uo;AE&&AE.release().then((()=>{AE=null})),"wakeLock"in navigator&&((e||t)&&await je(pt(rt(document,"click").pipe(gt(1)),rt(document,"touchend").pipe(gt(1)))),AE=await navigator.wakeLock.request("screen"),AE.addEventListener("release",(()=>{})))}catch(e){}})),_t((()=>rt(document,"visibilitychange").pipe(Ye((async()=>{if("visible"===document.visibilityState){const{isSafari:e,isIOSMobile:t}=Uo;AE&&AE.release().then((()=>{AE=null})),"wakeLock"in navigator&&((e||t)&&await je(pt(rt(document,"click").pipe(gt(1)),rt(document,"touchend").pipe(gt(1)))),AE=await navigator.wakeLock.request("screen"))}else AE&&AE.release().then((()=>{AE=null}))})),St(ge))))),wakeLockEpic1:e=>e.pipe(Ut(`${Dn}`)).pipe(At((()=>{AE&&AE.release().then((()=>{AE=null}))})),St(ge))},JE,QE,{meetingInfoEpic:(e,t)=>e.pipe(Ut(`${kr}`),_t((e=>{const n=Object.assign({},e.payload,{password:ir(e.payload.password),topic:ir(e.payload.topic)}),{videoSDKUrl:i}={meetingSDKUrl:`https://${wv}/api/v1/wc/info`,videoSDKUrl:`https://${wv}/wc/lsdk`};return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"zoomsdkjsonpcallback";return new U((i=>{$E++;const r=`${n}${$E}`,o=document.createElement("script");Object.keys(t).forEach((e=>(void 0===t[e]||null===t[e])&&delete t[e])),o.src=`${e}?${new URLSearchParams(Object.assign(t,{callback:r})).toString()}`,o.async=!0,o.onerror=e=>i.error(e),document.getElementsByTagName("head")[0].appendChild(o),window[r]=e=>{o.parentNode&&o.parentNode.removeChild(o),delete window[r],i.next(e),i.complete()}}))}(i,n).pipe(ft((e=>Fe({status:!1,result:e.toString(),errorCode:-3e3}))),Ye((n=>{const[i,r]=(o=Fe(n),[ht(s=e=>!0===e.status&&void 0!==e.result,a)(Oe(o)),ht(dt(s,a))(Oe(o))]);var o,s,a;return r.subscribe((e=>{WE.report(`get meeting info error, ${JSON.stringify(e)}`,["Join Meeting Flow","Get Meeting Info Error"],"error"),e.state||(3e3===e.errorCode&&"Meeting password is incorrect"===e.errorMessage?_d(Ws,{errorCode:Cr.WrongPasscode,reason:"Incorrect passcode."}):3e3===e.errorCode&&"The role type error"===e.errorMessage?_d(Ws,{errorCode:Cr.RoleTypeMissing,reason:"Role type error"}):-3e3===e.errorCode?_d(Ws,{errorCode:Cr.CommonError,reason:"connection error"}):3e3===e.errorCode?_d(Ws,{reason:e.errorMessage,errorCode:Cr.CommonError}):300===e.errorCode?_d(Ws,{reason:"This account does not exist or does not belong to you",errorCode:Cr.CommonError}):124===e.errorCode&&"Parse lite sdk topic and pwd fail"===e.errorMessage?_d(Ws,{reason:"Topic is invalid",errorCode:Cr.CommonError}):124===e.errorCode&&"The java web token is expired or more than 2 days or ineffective."===e.errorMessage?_d(Ws,{reason:"The token has expired, is over 2 days old, or is ineffective.",errorCode:Cr.CommonError}):124===e.errorCode&&_d(Ws,{reason:"Verify JWT failed",errorCode:Cr.CommonError}))})),i.pipe(Xv((n=>{if(!0===n.status){const{result:{mid:r,websdkClientFeatureOptions:o,showRecommendVersion:s}}=n;Do.init(r);const a=((e,t)=>{if(e.result){const{result:{mn:n,ts:i,auth:r,track_auth:o,mid:s,tid:a,encryptedRWC:u,encryptedGEORWC:l,user_identity:c,meetingOptions:d,can_recording:h,wcXMPPConfig:p,call_out_country_json:f,isOriginalHost:g,support_call_out:m,liveTranscription:v,logConfig:y,logEncryptionPubKey:S,toll_numbers_json:b,h323Password:E,liveStreamInfo:w,rc_auto_delete:_,jwt_rc:I,op_rc:C,mediaSDKVersion:A,mediaSDKPathPrefix:T,zmk:R,fileTransfer:O,fileServerDomain:P,accountId:D}}=e,{lang:k,password:x,topic:N,zlk:M,cv:F,userName:L}=t;return{meetingNumber:n,meetingId:s,tid:a,ts:i,auth:r,passWord:x,trackAuth:o,customerKey:c,encryptedRWC:JSON.parse(u||"{}"),encryptedGEORWC:JSON.parse(l||"{}"),meetingOptions:JSON.parse(d||"{}"),recordingEnable:"1"===h,topic:N,userName:Do.get(ko.WebclientUserName)||L,cv:F,zlkJwtToken:M,xmppConfig:JSON.parse(p||"{}"),callOutCountry:JSON.parse(f||"{}"),lang:k,isOriginHost:g,isSupportCallOut:"1"===m,liveTranscription:JSON.parse(v||"{}"),logConfig:y,logEncryptionPubKey:S,tollNumbers:void 0===b?void 0:JSON.parse(b),h323Password:E,liveStreamInfo:JSON.parse(w||"{}"),rcAutoDelete:_,jwtRc:I,opRc:C,mediaSDKPath:A&&T?`${vr(T)}/${A}`:void 0,zmk:R,fileTransfer:JSON.parse(O||"{}"),fileServerDomain:P,accountId:D}}return e})(n,e.payload);var i;s&&(null==e||null===(i=e.payload)||void 0===i||i.lang,console.log("Update VideoSDK-Web to the latest version to optimize meeting experience","https://developers.zoom.us/docs/video-sdk/web/"));const u=[Fe(jr(a)),ci(KE,t,xr())],l=((e,t)=>{const n=[];if(e){const t=e.split("").reverse();Object.keys(Ao).filter((e=>/M:\d+(,\d+)*;V:\d+(,\d+)*/.test(Ao[e]))).forEach((e=>{const i=Ao[e];let[r,o]=i.split(";");r.startsWith("V:")&&([r,o]=[o,r]);const s=o.slice(2).split(",").map((e=>t[Number(e)-1])).reverse().join(""),a=parseInt(s,16),u=Qv[i];u&&(Array.isArray(u)?u:[u]).forEach((e=>{const t=e.mask?(a&e.mask)>0:a;n.push(Fe(e.action(t)))}))}))}return n})(o);l.length>0&&u.unshift(...l);const c=((e,t)=>{const n=[];if(e){const t=e.split("").reverse(),r=[];Ro.forEach((e=>{var n;const[i,o]=e.split("-"),s=Number(o)-1;r.length<s&&(r.length=s+1),r[s]=null!==(n=t[Number(i)-1])&&void 0!==n?n:"0"}));for(let e=0;e<r.length;e++){var i;r[e]=null!==(i=r[e])&&void 0!==i?i:"0"}n.push(Fe(ui(r.reverse().join(""))))}return n})(o);return c.length>0&&u.unshift(...c),Xe(...u)}})))})),wt(So(performance.now())))}))),pingRWCEpic:KE});var XE={exports:{}};XE.exports=function(){function e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}return function t(n,i){function r(t,r,o){if("undefined"!=typeof document){"number"==typeof(o=e({},i,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in o)o[a]&&(s+="; "+a,!0!==o[a]&&(s+="="+o[a].split(";")[0]));return document.cookie=t+"="+n.write(r,t)+s}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],i={},r=0;r<t.length;r++){var o=t[r].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(i[a]=n.read(s,a),e===a)break}catch(e){}}return e?i[e]:i}},remove:function(t,n){r(t,"",e({},n,{expires:-1}))},withAttributes:function(n){return t(this.converter,e({},this.attributes,n))},withConverter:function(n){return t(e({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(n)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}();var ew=XE.exports;const{WebclientIsOnHold:tw,WebclientOpt:nw,WebclientParticipantId:iw,WebclientZoomId:rw,WebclientMeetingToken:ow}=ko,{WebclientDeviceId:sw}=xo;function aw(e){let{retryCount:t,rwgServerList:n,userName:i,auth:r,trackAuth:o,meetingId:s,customerKey:a,tid:u,lang:l,ts:c,bid:d,botk:h,confID:p,zlkJwtToken:f,isAudioBridgeEnabled:g,isMeetingReset:m,cameraDevicesList:v,isFullHDVideoEnabled:y,isFullHDVideoShareEnabled:S}=e;const b=ew.get("_zm_mtk_guid");let E=Do.get(sw);if(E||(E=Cy(),Do.set(sw,E,Oo.LocalStorage)),n.length>t){var w;const _=n[t],I={dn2:ir(i),auth:r,browser:`${Uo.browser}${Uo.browserVersion} ${null!==(w=window)&&void 0!==w&&w.crossOriginIsolated?"SAB":""}`,trackAuth:o,mid:s,tid:u,lang:l,ts:c,"ZM-CID":E,_ZM_MTG_TRACK_ID:b||"",customer_key:ir(a),cfs:0,islch:1};if(f)try{const{vendor:e}=mr(f);e&&Object.assign(I,{vendor:e})}catch(e){console.log(e)}_.rwcAuth?Object.assign(I,{rwcAuth:_.rwcAuth}):_.rwcToken&&Object.assign(I,{rwcToken:_.rwcToken});const C=qo()?1:Uo.isIE||Uo.isSupportEssentialAudioAndVideoAbility?2:0;Object.assign(I,{as_type:C}),[{key:nw,queryKey:"opt"},{key:iw,queryKey:"participantID"},{key:rw,queryKey:"zoomid"}].forEach((e=>{const t=Do.get(e.key);void 0!==t&&(I[e.queryKey]=t)}));const A=d&&h&&p;A&&Object.assign(I,{bid:ir(d),confID:p}),Do.get(ow)&&Object.assign(I,{isdj:1}),Ho()&&(Object.assign(I,{from:Uo.isAndroidBrowser?"android":"ios"}),g&&Object.assign(I,{useABAudio:1})),Object.assign(I,{clientCaps:uw({isAudioBridgeEnabled:g&&Ho(),isBO:A,isFullHDVideoEnabled:y,isFullHDVideoShareEnabled:S})});const T=m?v.length>0?1:0:1;return Object.assign(I,{isCamera:T}),Object.assign(I,{clientOS:Uo.isAndroidOrIOSBrowser?Uo.isIOSMobile?"ios":"android":Uo.isMacOS?"mac":"win"}),Object.assign(I,{audioFeature:Ls.getAudioFeatureFlag()}),{queryObject:{...I},rwgServer:_}}return null}function uw(e){const{isAudioBridgeEnabled:t,isBO:n,isFullHDVideoEnabled:i,isFullHDVideoShareEnabled:r}=e;let o=Oh.WebCameraIndication|Oh.SendMeetingTokenSeparately|Oh.SmartSummary|Oh.LocalRecording|Oh.LocalRecordingGrantPermission|Oh.UnifyErrorType;const s=Ls.getPTZCapability();return(s.pan||s.tilt||s.zoom)&&(o|=Oh.SupportFarEndCameraControl),Ls.isSupportVideoShare()&&(o|=Oh.SupportVideoShare),t&&Ls.isSupportAudioBridgeAVSync()&&(o|=Oh.WebrtcAudioRtcpTime),Ls.isSupportShareMultiStream()&&(o|=Oh.ShareMultiStream),Ls.isSupportVideoLTR()&&(o|=Oh.VideoLTR),n||(o|=Oh.RequestRemoteControl),i&&Ls.isSupportFullHDVideo()&&(o|=Oh.SupportSend1080PVideo),r&&Ls.isSupportFullHDVideoShare()&&(o|=Oh.SupportSend1080PVideoShare),o}function lw(e,t){return t?j(yt(t),ht((()=>{const{socket:{zoomSocketStatus:t},meeting:{meetingStatus:n,isMeetingReset:i}}=e.value;return t!==Th.Closed&&n===Co.Joined&&!i}))):j(ht((()=>{const{socket:{zoomSocketStatus:t},meeting:{meetingStatus:n,isMeetingReset:i}}=e.value;return t!==Th.Closed&&n===Co.Joined&&!i})))}const cw=Ps.createAgent();let dw;const hw=EE.getInstance();let pw;const fw=Ds.getInstance();let gw;const mw={zoomSocketStatus:Th.Closed,xmppSocketStatus:Th.Closed,mainSessionSocketStatus:Th.Closed,retryCount:0,rwgServerList:[]},vw=Rn({[`${jn}`]:hE(((e,t)=>{let{payload:n}=t;e.zoomSocketStatus=n.status})),[`${Bn}`]:hE(((e,t)=>{let{payload:n}=t;const{rwgServerList:i}=e;i.find((e=>e.rwg===n.rwg))||i.push(n)})),[`${Un}`]:hE(((e,t)=>{let{payload:n}=t;e.retryCount=n})),[`${Hn}`]:hE(((e,t)=>{let{payload:n}=t;e.xmppSocketStatus=n})),[`${qn}`]:hE(((e,t)=>{let{payload:n}=t;e.mainSessionSocketStatus=n})),[`${Kn}`]:()=>mw},mw),yw={epics0:(e,t)=>e.pipe(Ut(`${On}`),Tt(t),ht((e=>{let[,t]=e;return t.socket.zoomSocketStatus===Th.Closed&&!!t.meeting.meetingId})),_t((e=>{let[,n]=e;const{media:{patchedMediaSDKStatus:i}}=n;return(i===Iu.Loading?Ad(Lc,1):Me([0])).pipe(_t((()=>{const{socket:{retryCount:e,rwgServerList:n},meeting:i,breakoutRoom:r,video:o,share:s}=t.value;let a;const u={...i,retryCount:e,rwgServerList:n};if(o){const{cameraDevicesList:e,isFullHDVideoEnabled:t}=o;Object.assign(u,{cameraDevicesList:e,isFullHDVideoEnabled:t})}if(s){const{isFullHDVideoShareEnabled:e}=s;Object.assign(u,{isFullHDVideoShareEnabled:e})}if(r&&r.currentRoom.status===rh.Joining){const{currentRoom:{boId:e,boConfId:t,boToken:n}}=r;Object.assign(u,{bid:e,botk:n,confID:t})}if(a=i.zlkJwtToken?function(e){const t=aw(e);if(t){const{queryObject:n,rwgServer:i}=t,{topic:r,cv:o,meetingNumber:s}=e;return Object.assign(n,{topic:ir(r),iccv:o}),`wss://${i.rwg}/instantsdk/${s}?${new URLSearchParams(n).toString()}`}return null}(u):function(e){const t=aw(e);if(t){const{queryObject:n,rwgServer:i}=t,{cv:r,meetingNumber:o}=e;return Object.assign(n,{jscv:r,browser:n.browser+" ComponentView"}),[{key:tw,queryKey:"cfs"}].forEach((e=>{const t=Do.get(e.key);void 0!==t&&(n[e.queryKey]=t)})),`wss://${i.rwg}/wc/api/${o}?${new URLSearchParams(n).toString()}`}return null}(u),a){const e=(l=a,cw.connect(l),dw=new z,st((e=>cw.on(Rs.Message,e)),(e=>cw.off(Rs.Message,e)),(e=>e.data)).subscribe(dw),dw);return lt(e.pipe(ht((e=>"string"==typeof e)),Ke((e=>{try{return JSON.parse(e)}catch(e){return console.error(e),{evt:0}}})),iy(),Zv((e=>{if(0!==e.evt||!e.body||"invalid parameters!"!==e.body.test)return xn(e);_d(Ws,{errorCode:Cr.InvalidParameter,reason:"Invalid parameter"})})),wt(jn({status:Th.Connecting,rwgUrl:a}))),e.pipe(ht((e=>e instanceof ArrayBuffer)),Ke((e=>Nn(e)))))}var l;return ge})))}))),epics1:(e,t)=>e.pipe(Ut(`${On}`),Tt(t),ht((e=>{let[,t]=e;return t.socket.zoomSocketStatus===Th.Closed&&!!t.meeting.meetingId})),_t((()=>{const[e,n,i,r]=[Rs.Open,Rs.Close,Rs.Error,Rs.Inactive].map((e=>st((t=>cw.on(e,t)),(t=>cw.on(e,t)))));return lt(e.pipe(Ye((()=>lt(Fe(jn({status:Th.Connected})),at(6e4).pipe(Tt(t),ht((e=>{let[,t]=e;return t.meeting.meetingStatus===Co.Initial&&!t.meeting.isMeetingReset})),Ke((()=>(_d(Gs,{reason:Eo.Failover}),Nr(To.NoHeartbeat))))))))),n.pipe(lw(t),Ke((()=>(_d(Gs,{reason:Eo.Failover}),Nr(To.Disconnect))))),r.pipe(lw(t),Ke((()=>(_d(Gs,{reason:Eo.Failover}),Nr(To.NoHeartbeat))))),i.pipe(Tt(t),Ye((e=>{let[,n]=e;const{meeting:{meetingStatus:i,isMeetingReset:r},socket:{rwgServerList:o,retryCount:s}}=n,a=[];if(i===Co.Initial&&null!=o&&o.length){const e=o[s];return at(5e3).pipe(ht((()=>t.value.meeting.meetingStatus===Co.Initial)),Ye((()=>{const{socket:{rwgServerList:e,retryCount:n}}=t.value,i=[];return e.length>n+1?i.push(Un(n+1),Dn({retry:!0})):(_d(Ws,{reason:"connection error",errorCode:Cr.CommonError}),i.push(...zv(t.value))),Me(i)})),wt(ho(null==e?void 0:e.rwc)))}return r||i!==Co.Joined||(_d(Gs,{reason:Eo.Failover}),a.push(Nr(To.OnError))),Me(a)}))))}))),epics2:(e,t)=>e.pipe(Ut(`${Dn}`),_t((e=>e.payload&&e.payload.retry?Fe(On()).pipe(yt(1e3),wt(jn({status:Th.Closed}))):Fe(jn({status:Th.Closed})))),yt(100),At((()=>{var e;t.value.socket.zoomSocketStatus===Th.Closed&&(cw.close(),null===(e=dw)||void 0===e||e.complete())})))},Sw=hi(yw,{xmppEpics0:(e,t)=>e.pipe(Ut(`${Gr}`),Ye((()=>{const{meeting:{meetingOptions:e,zlkJwtToken:n,isWebinar:i}}=t.value,r=[];return(e.isPollingEnabled||n||i)&&r.push(Pn()),Me(r)}))),xmppEpics1:(e,t)=>e.pipe(Ut(`${Pn}`),Tt(t),ht((e=>{let[,t]=e;return"closed"===t.socket.xmppSocketStatus})),_t((e=>{let[,t]=e;const{meeting:{svcUrl:n,meetingNumber:i,conId:r}}=t,o=function(e,t,n){return`wss://${e}/wc/media/${t}?type=x&cid=${n}`}(n,i,r);return(e=>(hw.connect(e),pw=new z,st((e=>hw.on(bE.Message,e)),(e=>hw.off(bE.Message,e))).subscribe(pw),pw))(o).pipe(ht((e=>void 0!==(null==e?void 0:e.evt))),Ke((e=>Mn(e))),wt(Hn(Th.Connecting)))}))),xmppEpics2:(e,t)=>e.pipe(Ut(`${Pn}`),_t((()=>{const[e,n,i]=[bE.Open,bE.Close,bE.Error].map((e=>st((t=>hw.on(e,t)),(t=>hw.on(e,t)))));return lt(e.pipe(At((()=>{const e=function(){const{isSupportEssentialAudioAndVideoAbility:e,isSupportAudioWorklet:t}=Uo;return e&&t?11:10}();hw.join(e)})),mt(Hn(Th.Connected))),n.pipe(lw(t,500),Ke((()=>(_d(Gs,{reason:Eo.Failover}),Nr(To.DisconnectXmpp))))),i.pipe(lw(t,500),Ke((()=>(_d(Gs,{reason:Eo.Failover}),Nr(To.OnError))))))}))),xmppEpics3:e=>e.pipe(Ut(`${kn}`),mt(Hn(Th.Closed)),yt(100),At((()=>{var e;hw.close(),null===(e=pw)||void 0===e||e.complete()})))},{mainSessionEpics0:(e,t)=>e.pipe(Ut(`${Fn}`),Tt(t),ht((e=>{let[,t]=e;return"closed"===t.socket.mainSessionSocketStatus})),_t((e=>{let[,t]=e;const{meeting:{svcUrl:n,meetingNumber:i,conId:r}}=t,o=function(e,t,n){return`wss://${e}/wc/media/${t}?type=m&cid=${n}&mode=2`}(n,i,r);return(e=>(fw.connect(e),gw=new z,st((e=>fw.on(Rs.Message,e)),(e=>fw.off(Rs.Message,e))).pipe(Ke((e=>e.data))).subscribe(gw),gw))(o).pipe(Ke((e=>{try{return JSON.parse(e)}catch(e){return console.error(e),{evt:0}}})),ht((e=>0!==e.evt)),iy(),Ke((e=>Vn(e))),wt(qn(Th.Connecting)))}))),mainSessionEpics1:(e,t)=>e.pipe(Ut(`${Fn}`),_t((()=>{const[e,n,i]=[Rs.Open,Rs.Close,Rs.Error].map((e=>st((t=>fw.on(e,t)),(t=>fw.on(e,t)))));return lt(e.pipe(mt(qn(Th.Connected))),n.pipe(lw(t,500),Ke((()=>(_d(Gs,{reason:Eo.Failover}),Nr(To.DisconnectMChannel))))),i.pipe(lw(t,500),Ke((()=>(_d(Gs,{reason:Eo.Failover}),Nr(To.OnErrorMChannel))))))}))),mainSessionEpics2:e=>e.pipe(Ut(`${Ln}`),mt(qn(Th.Closed)),At((()=>{var e;fw.close(),null===(e=gw)||void 0===e||e.complete()})))}),bw={id:"userId",type:e=>Zd(e)?{userType:e,avatarBackgroundType:Math.floor(8*Math.random())+1}:{userType:e},role:e=>({userRole:e,isHost:Yd(e)}),dn2:e=>({displayName:rr(e)}),bShareOn:"sharerOn",bSharePause:"sharerPause",bLocalRecordStatus:e=>({bLocalRecord:e}),bGuest:"isGuest",bCapsRequestLT:"isRequestLT",customerKey:"userIdentity"},Ew=e=>{const t={};return["add","remove","update"].forEach((n=>{const i=n,r=e[i];null!=r&&(t[i]=r.reduce(((e,t)=>{const n=Object.keys(t).reduce(((e,n)=>{const i=bw[n];return"function"==typeof i?Object.assign(e,i(t[n])):"string"==typeof i?Object.assign(e,{[`${i}`]:t[n]}):Object.assign(e,{[`${n}`]:t[n]}),e}),{}),i=e.find((e=>e.userId===n.userId));return void 0!==i?Object.assign(i,n):e.push(n),e}),[]))})),t},ww={name:"displayName",node:e=>({userId:Number(e)}),role:e=>({userRole:Number(e)})},_w=e=>Object.keys(e).reduce(((t,n)=>{const i=ww[n];return"function"==typeof i?Object.assign(t,i(e[n])):"string"==typeof i?Object.assign(t,{[`${i}`]:e[n]}):Object.assign(t,{[`${n}`]:e[n]}),t}),{}),Iw={attendeesList:[],assistantList:[],xmppAttendeeList:[],allowTalkAttendeesList:[],failoverAttendeesList:[],isAdmitAllSilentUsers:!1},Cw=Rn({[`${Rd}`]:hE(((e,t)=>{let{payload:n}=t;void 0!==n.add&&n.add.length>0&&n.add.forEach((t=>{if(t.userType===Qd.Assitant){const n=e.assistantList.find((e=>e.userId===t.userId));void 0!==n?Object.assign(n,t):e.assistantList.push(t)}else if(Xd(t.userRole)){const n=e.allowTalkAttendeesList.find((e=>e.userId===t.userId));void 0!==n?Object.assign(n,t):e.allowTalkAttendeesList.push(t)}else{const n=e.attendeesList.find((e=>e.userId===t.userId));void 0!==n?Object.assign(n,t):e.attendeesList.push(t)}})),void 0!==n.update&&n.update.length>0&&n.update.forEach((t=>{const n=e.attendeesList.find((e=>e.userId===t.userId));if(void 0!==n)Object.assign(n,t);else{const n=e.allowTalkAttendeesList.find((e=>e.userId===t.userId));if(void 0!==n)Object.assign(n,t);else{const n=e.assistantList.find((e=>e.userId===t.userId));void 0!==n&&Object.assign(n,t)}}})),void 0!==n.remove&&n.remove.length>0&&n.remove.forEach((t=>{const n=e.attendeesList.findIndex((e=>e.userId===t.userId));if(-1!==n)e.attendeesList.splice(n,1);else{const n=e.allowTalkAttendeesList.findIndex((e=>e.userId===t.userId));if(-1!==n)e.allowTalkAttendeesList.splice(n,1);else{const n=e.assistantList.findIndex((e=>e.userId===t.userId));-1!==n&&e.assistantList.splice(n,1)}}}))})),[`${Vd}`]:hE(((e,t)=>{let{payload:n}=t;const{xmppAttendeeList:i}=e,r=i.map((e=>e.jid));n.forEach((e=>{const{jid:t}=e,n=r.indexOf(t);-1!==n?Object.assign(i[n],e):i.push(e)}))})),[`${Pd}`]:hE(((e,t)=>{let{payload:n}=t;e.isAdmitAllSilentUsers=n})),[`${Nd}`]:hE((e=>{e.attendeesList.forEach((e=>{e.bRaiseHand&&(e.bRaiseHand=!1)}))})),[`${Md}`]:hE((e=>{e.attendeesList.forEach((e=>{e.feedback>0&&(e.feedback=0)}))})),[`${kd}`]:hE(((e,t)=>{let{payload:n}=t;e.failoverAttendeesList.push(n)})),[`${xd}`]:hE(((e,t)=>{let{payload:n}=t;n.forEach((t=>{const n=e.failoverAttendeesList.findIndex((e=>e.zoomID===t.zoomID));-1!==n&&e.failoverAttendeesList.splice(n,1)}))})),[`${Fd}`]:hE(((e,t)=>{let{payload:n}=t;const{jid:i,name:r}=n,o=e.xmppAttendeeList.find((e=>e.jid===i));o&&(o.displayName=r)})),[`${Ld}`]:hE(((e,t)=>{let{payload:n}=t;const{jid:i}=n,r=e.xmppAttendeeList.findIndex((e=>e.jid===i));-1!==i&&e.xmppAttendeeList.splice(r,1)})),[`${jd}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:i,key:r,value:o}=n,s=e.attendeesList.find((e=>e.userId===i));s&&(s[`${r}`]=o)})),[`${Dd}`]:()=>Iw},Iw),Aw={epics0:(e,t)=>pi(e,is).pipe(Ke((e=>Ew(e.payload.body))),Tt(t),Ye((e=>{let[t,n]=e,i=[Rd(t)];const{meeting:{userId:r,isWebinar:o,isOnHold:s},participants:{attendeesList:a,failoverAttendeesList:u,allowTalkAttendeesList:l}}=n,c=l.map((e=>e.userId));if(t.add){const e=t.add.filter((e=>e.userId===r));e.length>0&&e.forEach((e=>{void 0!==e.bHold&&i.push(Zr(e.bHold)),_d(Vs,e)}));const s=t.add.filter((e=>e.userId!==r));if(s.length>0){const e=s.filter((e=>!Xd(e.userRole))).map((e=>{const t={...e};if(Zd(e.userType)){var i;const r=null===(i=n.audio)||void 0===i?void 0:i.dialout.find((t=>t.phoneNodeId===e.userId));r&&Object.assign(t,{phoneNumber:r.phoneNumber})}const r=u.find((t=>t.zoomID===e.zoomID));return r&&Object.assign(t,{source:r.isOnHold?"on hold":"failover"}),t})),t=e.filter((e=>!!e.source)).map((e=>({zoomID:e.zoomID})));if(i.push(xd(t)),_d(Bs,e),o){const e=s.filter((e=>Xd(e.userRole)));e.length>0&&_d(qs,e.map((e=>({userId:e.userId,isAllowToTalk:!0}))))}}}if(t.update){const e=t.update.filter((e=>e.userId===r));e.length>0&&e.forEach((e=>{_d(js,e),void 0!==e.bHold&&i.push(Zr(e.bHold))}));const n=t.update.filter((e=>!(e.userId===r||c.includes(e.userId))));if(n.length>0&&_d(Us,n),o){const e=t.update.filter((e=>e.userId!==r&&c.includes(e.userId)));e.length>0&&_d(qs,e)}}if(t.remove){const e=t.remove.map((e=>{const t=a.find((t=>t.userId===e.userId));return t?2===e.action&&1===e.nUserStatus?t.bHold?(i.push(kd({zoomID:t.zoomID,isOnHold:!0})),{...e,...t,reason:"on hold"}):(i.push(kd({zoomID:t.zoomID,isOnHold:!1})),{...e,...t,reason:"failover"}):{...e,...t}:null})).filter((e=>!!e));if(_d(Hs,e),o){const e=t.remove.filter((e=>c.includes(e.userId)));e.length>0&&_d(qs,e.map((e=>({userId:e.userId,isAllowToTalk:!1}))))}}const d=i.filter((e=>e.type===`${Zr}`));if(d.length>0){const e=d[d.length-1];i=i.filter((e=>e.type!==`${Zr}`)),e.payload!==s&&(i.push(e),_d(Js,!s))}return Me(i)}))),epics1:(e,t)=>gi(e,24595).pipe(Ye((e=>{const{payload:{body:{action:n,data:i}}}=e,{meeting:{jid:r},participants:{xmppAttendeeList:o}}=t.value,s=[];if(n===SE.rename){i.forEach((e=>{s.push(Fd(e))}));const e=i.map((e=>_w(e)));_d(qs,e)}if(n===SE.Remove){i.forEach((e=>{s.push(Ld(e))}));const e=i.map((e=>({..._w(e),removed:!0})));_d(Ks,e)}if([SE.Add,SE.List,SE.update].includes(n)){const e=i.map((e=>{const t=_w(e);return Object.keys(t).reduce(((e,n)=>(""!==t[n]&&Object.assign(e,{[n]:t[n]}),e)),{})}));if(_d(qs,e),s.push(Vd(e)),n===SE.update){const e=i.find((e=>e.jid===r));if(e&&void 0!==e.bRaiseHand){const t=o.find((e=>e.jid===r));(null==t?void 0:t.bRaiseHand)!==e.bRaiseHand&&_d("MEETING_WEBINAR_ATTENDEE_RAISE_HAND",{bRaiseHand:e.bRaiseHand})}}}return Me(s)}))),epics2:e=>pi(e,7951).pipe(At((e=>{!1===e.payload.body.bStarted&&_d("ADMIT_ALL_SILENT_USERS_END",e.payload.body.bStarted)})),Ke((e=>Pd(e.payload.body.bStarted)))),epics3:e=>pi(e,7946).pipe(ht((e=>{var t;return["bRaiseHand","feedback"].includes(null===(t=e.payload.body)||void 0===t?void 0:t.key)&&0===e.payload.body.value})),Ke((e=>(_d(Us,{}),"bRaiseHand"===e.payload.body.key?Nd():Md()))))},Tw=hi(Aw),Rw={audioEncodeStatus:"initial",audioDecodeStatus:"initial",videoEncodeStatus:"initial",videoDecodeStatus:"initial",sharingEncodeStatus:"initial",sharingDecodeStatus:"initial",assetsPath:"",mediaConstraints:void 0,fileWithVersion:!1,enforceMultipleVideos:!1,enforceVirtualBackground:!1,enableAudioQos:!0,enableVideoQos:!0,isAudioBridgeReceiveReady:!1,isAudioBridgeSendReady:!1,isMediaAgentInitialized:!1,disableRenderLimits:!1,adaptedABOptionForMediaSDK:""},Ow=Rn({[`${zn}`]:hE(((e,t)=>{let{payload:n}=t;e.audioDecodeStatus=n})),[`${Gn}`]:hE(((e,t)=>{let{payload:n}=t;e.audioEncodeStatus=n})),[`${Zn}`]:hE(((e,t)=>{let{payload:n}=t;e.sharingDecodeStatus=n})),[`${Yn}`]:hE(((e,t)=>{let{payload:n}=t;e.sharingEncodeStatus=n})),[`${Qn}`]:hE(((e,t)=>{let{payload:n}=t;e.videoDecodeStatus=n})),[`${Jn}`]:hE(((e,t)=>{let{payload:n}=t;e.videoEncodeStatus=n})),[`${Xn}`]:hE(((e,t)=>{let{payload:n}=t;e.mediaConstraints=n.mediaConstraints,e.assetsPath=n.assetsPath,e.fileWithVersion=n.fileWithVersion,e.enforceMultipleVideos=!!n.enforceMultipleVideos,e.enforceVirtualBackground=n.enforceVirtualBackground,e.skipJsMedia=n.skipJsMedia,e.patchJsMedia=n.patchJsMedia,e.alternativeNameForVideoPlayer=n.alternativeNameForVideoPlayer,n.enforceMultipleVideos&&"object"==typeof n.enforceMultipleVideos&&(e.disableRenderLimits=!!n.enforceMultipleVideos.disableRenderLimits)})),[`${ei}`]:hE(((e,t)=>{let{payload:n}=t;const{type:i,encrypeKey:r,additionalType:o}=n,s={encrypeKey:r,additionalType:o};"audio"===i?e.audioEncrypt=s:"video"===i?e.videoEncrypt=s:"sharing"===i&&(e.sharingEncrypt=s)})),[`${ti}`]:hE(((e,t)=>{let{payload:n}=t;e.isEnableDecoderInWorklet=n})),[`${ni}`]:hE(((e,t)=>{let{payload:n}=t;e.patchedMediaSDKStatus=n})),[`${ii}`]:hE(((e,t)=>{let{payload:n}=t;e.assetsPath=n})),[`${ri}`]:hE(((e,t)=>{let{payload:n}=t;e.enableAudioQos=n.audioQos,e.enableVideoQos=n.videoQos})),[`${oi}`]:hE(((e,t)=>{let{payload:n}=t;e.isAudioBridgeReceiveReady=n})),[`${si}`]:hE(((e,t)=>{let{payload:n}=t;e.isAudioBridgeSendReady=n})),[`${ai}`]:hE(((e,t)=>{let{payload:n}=t;e.isMediaAgentInitialized=n})),[`${ui}`]:hE(((e,t)=>{let{payload:n}=t;e.adaptedABOptionForMediaSDK=n})),[`${li}`]:e=>({...Rw,mediaConstraints:e.mediaConstraints,assetsPath:e.assetsPath,fileWithVersion:e.fileWithVersion,enforceMultipleVideos:e.enforceMultipleVideos,disableRenderLimits:e.disableRenderLimits,enforceVirtualBackground:e.enforceVirtualBackground,alternativeNameForVideoPlayer:e.alternativeNameForVideoPlayer})},Rw),Pw=new class{constructor(){this.state={mediaSDK:void 0,mediaSDKInstanceMap:new Map,tagName:"video-player"},this.onceMap=new WeakMap,this.subscribers=[]}get(e){return this.state[e]}dispatch(e,t,n){t&&Object.assign(this.state,t),e&&this.notifySubscribers(e,n)}subscribe(e){return this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);-1!==t&&this.subscribers.splice(t,1)}}once(e,t){this.onceMap.set(t,{event:e,unSubscribe:this.subscribe(t)})}notifySubscribers(e,t){const n=[];this.subscribers.forEach((i=>{i(e,this.state,t);const r=this.onceMap.get(i);if(r){const{event:t,unSubscribe:o}=r;t===e&&(n.push(o),this.onceMap.delete(i))}})),n.forEach((e=>e()))}};var Dw,kw;!function(e){e[e.ADD_RENDER_VIDEO=1]="ADD_RENDER_VIDEO",e[e.STOP_RENDER_VIDEO=2]="STOP_RENDER_VIDEO",e[e.START_SHARING=23]="START_SHARING",e[e.STOP_SHARING=24]="STOP_SHARING",e[e.SWITCH_CANVAS_FOR_VIDEO_CAPTURE=25]="SWITCH_CANVAS_FOR_VIDEO_CAPTURE",e[e.UPDATE_SHARING_DECODE_PARAM=44]="UPDATE_SHARING_DECODE_PARAM",e[e.UPDATE_CANVAS_SIZE=46]="UPDATE_CANVAS_SIZE",e[e.ZOOM_RENDER=48]="ZOOM_RENDER",e[e.REMOVE_EXPIRED_CANVAS=76]="REMOVE_EXPIRED_CANVAS",e[e.WEBGL_LOST_REPLACE_CANVAS=77]="WEBGL_LOST_REPLACE_CANVAS",e[e.UPDATE_VIDEO_QUALITY=78]="UPDATE_VIDEO_QUALITY",e[e.SEND_RENDER_LOG=79]="SEND_RENDER_LOG"}(Dw||(Dw={})),function(e){e[e.WEBGL_LOST_IN_MULTI_VIEW=-32]="WEBGL_LOST_IN_MULTI_VIEW"}(kw||(kw={}));const xw="default-sesssion-key";var Nw,Mw,Fw;function Lw(e,t,n,i,r){const o=document.createElement("canvas");o.id=i;const s=Jw(o,e,t);return r(`VPISC:${window.devicePixelRatio},${s}`),o.style.pointerEvents="none",o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.width=e+"px",o.width=e*Qw(o),o.style.height=t+"px",o.height=t*Qw(o),o.ariaHidden="true",o.style.zIndex=n,o}function Vw(e,t,n=!1){const i=()=>{if(e){Jw(e,t.clientWidth,t.clientHeight),[Dw.UPDATE_CANVAS_SIZE,Dw.UPDATE_SHARING_DECODE_PARAM].forEach((n=>{var i;null===(i=Hw(t.getSessionId()))||void 0===i||i.Notify_MeidaSDK(n,{width:t.clientWidth*Qw(e),height:t.clientHeight*Qw(e),canvas:e})})),e.style.width=t.clientWidth+"px",e.style.height=t.clientHeight+"px";try{e.width=t.clientWidth*Qw(e),e.height=t.clientHeight*Qw(e)}catch(e){}Pw.dispatch("resize",void 0,e.id)}};n&&setTimeout((()=>{i(),e.style.visibility=""}),300);const r=Kw(i,300),o=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),s=new ResizeObserver(r);return o.addEventListener("change",r),s.observe(t),()=>{!function(e){zw.delete(e)}(e),null==s||s.disconnect(),o.removeEventListener("change",r)}}function jw(e,t){Object.defineProperties(e,t.reduce(((t,n)=>(t[n]={get:()=>e.getAttribute(n),set:t=>{t?e.setAttribute(n,t):e.removeAttribute(n)}},t)),{}))}function Bw(e,t){Object.entries(t).forEach((([t,n])=>{e.getAttribute(t)||e.setAttribute(t,n)}))}function Uw(e,t){const n=e.getAttribute(t);return!(!n||"true"!==n)}function Hw(e=xw){var t;return null===(t=Pw.get("mediaSDKInstanceMap").get(e))||void 0===t?void 0:t()}function qw(){if("function"==typeof crypto.randomUUID)return crypto.randomUUID();let e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(n=>{let i=16*Math.random();return e>0?(i=(e+i)%16|0,e=Math.floor(e/16)):(i=(t+i)%16|0,t=Math.floor(t/16)),("x"===n?i:3&i|8).toString(16)}))}function Kw(e,t){let n;return function(...i){clearTimeout(n),n=setTimeout((()=>{e(...i)}),t)}}function $w(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const i of n){const n=e[i],r=t[i];if("object"==typeof n&&"object"==typeof r){if(!$w(n,r))return!1}else if(n!==r)return!1}return!0}function Ww(e){return!e||"0"===e}function Gw(e,t){null==e||e.Notify_MeidaSDK(Dw.SEND_RENDER_LOG,{message:t})}!function(e){e.Video="video",e.Share="share"}(Nw||(Nw={})),function(e){e.DEFAULT="",e.MAIN="main"}(Mw||(Mw={})),function(e){e.Video_90P="0",e.Video_180P="1",e.Video_360P="2",e.Video_720P="3",e.Video_1080P="4"}(Fw||(Fw={}));const zw=new Map;function Jw(e,t,n){const i=t>=2*window.screen.width||n>=2*window.screen.height?1:window.devicePixelRatio,r=zw.get(e);return zw.set(e,i),r&&r!==i&&Pw.dispatch("scale",void 0,e.id),i}function Qw(e){return zw.get(e)||window.devicePixelRatio}function Yw(e,t){const{left:n,top:i,bottom:r,right:o,width:s,height:a}=e.getBoundingClientRect(),u=t.getBoundingClientRect();return{left:n-u.left,top:i-u.top,bottom:u.bottom-r,right:u.right-o,width:s,height:a}}const Zw=[];for(let e=0;e<=1;e+=.01)Zw.push(e);class Xw{constructor(e,t){if(this.getRenderParams=t,this.el=document.createElement("div"),this.position=null,this.id="",this.removePositionObserve=null,this.viewId=`${Pw.get("tagName")}-${qw()}`,this.getSDK=()=>Hw(this.container.getSessionId()),!e)throw new Error(`The ${Pw.get("tagName")} must have a ${Pw.get("tagName")}-container as its ancestor element.`);this.container=e,this.el.style.width="100%",this.el.style.height="100%"}getElement(){return this.el}init(){this.removeSubscribe=Pw.subscribe(((e,t,n)=>{n===this.getCanvas().id&&("resize"===e?(this.updateVideoPosition(),setTimeout((()=>{this.updateVideoPosition()}),300)):"scale"===e&&Gw(this.getSDK(),`VPSC:${Qw(this.getCanvas())}`))}))}getCanvas(){return this.container.getCanvas()}initObservePosition(){this.stopObservePosition(),this.removePositionObserve=function(e,t,n){const{wrapper:i=document.documentElement}=n,r=Kw(t,300);let o,s;const a=(n=1,s=!1)=>{o&&(o.disconnect(),o=null);const{top:u,left:l,width:c,height:d,right:h,bottom:p}=Yw(e,i);if(!c||!d)return void t({hide:!0,cross:!1,width:0,height:0,top:0,left:0,bottom:0,right:0});const f=((e,t,n,i)=>e<0||t<0||n<0||i<0)(u,p,l,h),g=((e,t,n,i,r,o)=>e<=0&&e+o<=0||t<=0&&t+o<=0||n<=0&&n+r<=0||i<=0&&i+r<=0)(u,p,l,h,c,d),m={root:i,threshold:f?Zw:n};f||(m.rootMargin=`${-u}px ${-h}px ${-p}px ${-l}px`);let v=!0,y=!0;s&&(y=!1),t({hide:g,cross:f,top:u,left:l,width:c,height:d,bottom:p,right:h}),r({hide:g,cross:f,top:u,left:l,width:c,height:d,bottom:p,right:h},!0),o=new IntersectionObserver((([e])=>{if(0===e.intersectionRatio)return y?a(1,!0):void 0;if(n!==e.intersectionRatio){if(!v)return a();a(0===e.intersectionRatio?1e-7:e.intersectionRatio)}1===e.intersectionRatio&&f&&a(),v=!1}),m),o.observe(e)};return a(),s=new ResizeObserver((()=>a())),s.observe(e),()=>{null==o||o.disconnect(),o=null,null==s||s.disconnect(),s=null}}(this.el,((e,t)=>{t?setTimeout((()=>{this.updateVideoPosition()}),300):this.updateVideoPosition(e)}),{wrapper:this.container})}stopObservePosition(){this.removePositionObserve&&(this.removePositionObserve(),this.removePositionObserve=null)}getCurrentPosition(e){return this.transformRectToPosition(Yw(e,this.container))}transformRectToPosition(e){const{left:t,width:n,height:i,bottom:r,top:o}=e,s=Qw(this.getCanvas());return{x:t*s,y:r*s,width:n*s,height:i*s,left:t*s,bottom:r*s,top:o*s}}playVideo(e){this.initObservePosition(),this.id=e;const t=this.getCurrentPosition(this.el);this.addRender(Object.assign(Object.assign(Object.assign({},t),{canvas:this.getCanvas(),zone:this.viewId,userId:Number(e),ssrc:Number(e)}),this.getRenderParams())),this.position=t}updateVideoPosition(e){if(!this.id)return;const t=this.transformRectToPosition(e||Yw(this.el,this.container));this.position&&$w(t,this.position)||(this.zoomRender(Object.assign(Object.assign(Object.assign({},t),{userId:Number(this.id),canvas:this.getCanvas(),RGBA:this.container.getRGBA(),zone:this.viewId}),this.getRenderParams())),this.position=t)}stopVideo(){this.stopObservePosition(),this.id&&this.position&&(this.id&&this.stopRender(Object.assign(Object.assign(Object.assign({},this.position),{userId:Number(this.id),canvas:this.getCanvas(),RGBA:this.container.getRGBA(),zone:this.viewId}),this.getRenderParams())),this.position=null,this.id="")}updateVideoQuality(e){this.getSDK().Notify_MeidaSDK(Dw.UPDATE_VIDEO_QUALITY,{userId:this.id,videoQuality:e})}destroy(){var e;this.stopVideo(),null===(e=this.removeSubscribe)||void 0===e||e.call(this)}}class e_{constructor(e){this.container=e,this.id="",this.getSDK=()=>{var e;return Hw(null===(e=this.container)||void 0===e?void 0:e.getSessionId())},this.el=document.createElement("video"),this.el.style.width="100%",this.el.style.height="100%",this.el.setAttribute("autoplay","true"),this.el.setAttribute("muted","true"),this.el.setAttribute("playsinline","true")}getElement(){return this.el}init(){}playVideo(e){this.id=e,this.addRender({userId:Number(e),videodom:this.el})}stopVideo(){this.id&&(this.stopRender({userId:Number(this.id),videodom:this.el}),this.id="")}updateVideoQuality(e){}destroy(){this.stopVideo()}}class t_ extends Xw{addRender({width:e,height:t,x:n,y:i,canvas:r,zone:o,userId:s,left:a,bottom:u,top:l,fillMode:c,videoQuality:d}){var h;null===(h=this.getSDK())||void 0===h||h.Notify_MeidaSDK(Dw.ADD_RENDER_VIDEO,{width:e,height:t,x:n,y:i,canvas:r,zone:o,userId:s,left:a,bottom:u,top:l,fillMode:c,videoQuality:d})}zoomRender({width:e,height:t,x:n,y:i,userId:r,canvas:o,RGBA:s,zone:a,left:u,bottom:l,top:c}){var d;null===(d=this.getSDK())||void 0===d||d.Notify_MeidaSDK(Dw.ZOOM_RENDER,{width:e,height:t,x:n,y:i,userId:r,canvas:o,RGBA:s,zone:a,left:u,bottom:l,top:c})}stopRender({width:e,height:t,x:n,y:i,userId:r,canvas:o,doNotClean:s,RGBA:a,zone:u,left:l,bottom:c,top:d,videoQuality:h}){var p;null===(p=this.getSDK())||void 0===p||p.Notify_MeidaSDK(Dw.STOP_RENDER_VIDEO,{width:e,height:t,x:n,y:i,userId:r,canvas:o,doNotClean:s,RGBA:a,zone:u,left:l,bottom:c,top:d,videoQuality:h})}}class n_ extends e_{addRender({userId:e,videodom:t}){var n;null===(n=this.getSDK())||void 0===n||n.Notify_MeidaSDK(Dw.ADD_RENDER_VIDEO,{userId:e,videodom:t})}stopRender({userId:e,videodom:t}){var n;null===(n=this.getSDK())||void 0===n||n.Notify_MeidaSDK(Dw.STOP_RENDER_VIDEO,{userId:e,videodom:t})}}class i_ extends Xw{addRender({width:e,height:t,userId:n,canvas:i,isFromMainSession:r}){var o;null===(o=this.getSDK())||void 0===o||o.Notify_MeidaSDK(Dw.START_SHARING,{width:e,height:t,canvas:i,ssrc:n,isFromMainSession:r})}zoomRender(){}stopRender({canvas:e}){var t;null===(t=this.getSDK())||void 0===t||t.Notify_MeidaSDK(Dw.STOP_SHARING,{canvas:e})}}class r_ extends e_{addRender({userId:e,videodom:t}){var n,i;null===(n=this.getSDK())||void 0===n||n.Notify_MeidaSDK(Dw.SWITCH_CANVAS_FOR_VIDEO_CAPTURE,[t]),null===(i=this.getSDK())||void 0===i||i.Notify_MeidaSDK(Dw.ADD_RENDER_VIDEO,{userId:e,videodom:t})}stopRender({userId:e,videodom:t}){var n;null===(n=this.getSDK())||void 0===n||n.Notify_MeidaSDK(Dw.STOP_RENDER_VIDEO,{userId:e,videodom:t})}}const o_="node-id",s_="media-type",a_="video-quality",u_="share-source",l_="fill-mode",c_="stop-no-clean";class d_ extends HTMLElement{static get observedAttributes(){return[o_,s_,a_]}constructor(){super(),this.container=null,jw(this,d_.customAttributes),this.getRenderParams=this.getParsedParams.bind(this),this.attachShadow({mode:"open"})}initRender(){var e,t,n;this.render&&this.render.destroy();const i=this.getAttribute(o_),r=i&&(null===(e=this.getCurrentMediaSDK())||void 0===e?void 0:e.isPreviewVideotag(i)),o=this.getAttribute(s_);let s=0;r?(this.render=new r_(this.getContainer()),s=1):o===Nw.Share?(this.render=new i_(this.getContainer(),this.getRenderParams),s=2):(null===(t=this.getCurrentMediaSDK())||void 0===t?void 0:t.getWebRTCFlag())?(this.render=new n_(this.getContainer()),s=4):(this.render=new t_(this.getContainer(),this.getRenderParams),s=3),this.getCurrentMediaSDK()&&Gw(this.getCurrentMediaSDK(),`VPREN:${s}`),this.shadowRoot&&(this.shadowRoot.innerHTML="",this.shadowRoot.appendChild(this.render.getElement())),this.render.init();const a=this.getAttribute(o_);Ww(a)||null===(n=this.render)||void 0===n||n.playVideo(a)}getContainer(){return this.container||(this.container=this.closest(`${Pw.get("tagName")}-container`)),this.container}getCurrentMediaSDK(){var e;return Hw(null===(e=this.getContainer())||void 0===e?void 0:e.getSessionId())}getParsedParams(){return{fillMode:Uw(this,l_),doNotClean:Uw(this,c_),isFromMainSession:"main"===this.getAttribute(u_),videoQuality:this.getAttribute(a_)}}connectedCallback(){this.style.display="block",Bw(this,d_.defaultValues),this.initRender(),this.removeSubscribe=Pw.subscribe(((e,t,n)=>{var i,r;"failover"===e&&n===((null===(i=this.getContainer())||void 0===i?void 0:i.getSessionId())||xw)&&(this.initRender(),Ww(this.getAttribute(o_))||null===(r=this.render)||void 0===r||r.playVideo(this.getAttribute(o_)))}))}disconnectedCallback(){var e,t;null===(e=this.removeSubscribe)||void 0===e||e.call(this),null===(t=this.render)||void 0===t||t.destroy()}attributeChangedCallback(e,t,n){var i,r;if(this.render)switch(e){case o_:Boolean(null===(i=this.getCurrentMediaSDK())||void 0===i?void 0:i.isPreviewVideotag(n))!==this.render instanceof r_&&this.initRender(),Ww(t)&&!Ww(n)?this.render.playVideo(n):Ww(t)||Ww(n)?Ww(t)||this.render.stopVideo():(this.render.stopVideo(),this.render.playVideo(n));break;case s_:this.initRender();break;case a_:null===(r=this.render)||void 0===r||r.updateVideoQuality(n)}}}d_.customAttributes=[o_,s_,a_,u_,l_,c_],d_.defaultValues={[o_]:"",[s_]:Nw.Video};const h_="session-id",p_="z-index";class f_ extends HTMLElement{static get observedAttributes(){return[h_,p_]}constructor(){super(),this.canvasId="video-player-canvas-"+qw(),this.needInitCanvas=!1,this.callback=null,jw(this,f_.customAttributes);const e=this.attachShadow({mode:"open"}),t=document.createElement("slot");this.appendCanvas=n=>{e.insertBefore(n,t)},e.appendChild(t)}connectedCallback(){this.style.display="block",this.style.position||(this.style.position="relative"),Bw(this,f_.defaultValues),this.needInitCanvas&&this.initCanvasEvents(),this.removeSubscribe=Pw.subscribe(((e,t,n)=>{"failover"===e&&n===(this.getSessionId()||xw)&&(this.replaceCanvas(),this.initCanvasEvents())}))}disconnectedCallback(){var e,t,n,i;null===(e=this.removeListener)||void 0===e||e.call(this),null===(t=this.removeSubscribe)||void 0===t||t.call(this),this.canvas&&(null===(n=Hw(this.getSessionId()))||void 0===n||n.Notify_MeidaSDK(Dw.REMOVE_EXPIRED_CANVAS,{canvasId:this.canvasId})),this.callback&&(null===(i=Hw(this.getSessionId()))||void 0===i||i.removeCallback(this.callback))}attributeChangedCallback(e,t,n){e===p_&&this.canvas&&n&&(this.canvas.style.zIndex=n)}adoptedCallback(){var e;this.canvas&&(null===(e=this.removeListener)||void 0===e||e.call(this),this.canvas.style.visibility="hidden",Vw(this.canvas,this,!0))}createCanvas(){this.getCurrentMediaSDK()&&Gw(this.getCurrentMediaSDK(),"VPCC"),this.canvas=Lw(this.clientWidth,this.clientHeight,this.getAttribute(p_)||"",this.canvasId,(e=>Gw(this.getCurrentMediaSDK(),e))),this.appendCanvas(this.canvas),this.isConnected?this.initCanvasEvents():this.needInitCanvas=!0}initCanvasEvents(){var e;this.removeListener=Vw(this.canvas,this),this.callback=(e,t)=>{var n,i;e===kw.WEBGL_LOST_IN_MULTI_VIEW&&t.replaceCanvas&&t.canvasId===(null===(n=this.canvas)||void 0===n?void 0:n.id)&&(this.replaceCanvas(),null===(i=Hw(this.getSessionId()))||void 0===i||i.Notify_MeidaSDK(Dw.WEBGL_LOST_REPLACE_CANVAS,{canvasId:this.canvasId,canvas:this.canvas}))},null===(e=this.getCurrentMediaSDK())||void 0===e||e.addCallback(this.callback)}replaceCanvas(){var e;if(this.getCurrentMediaSDK()&&Gw(this.getCurrentMediaSDK(),"VPRC"),this.canvas){null===(e=this.removeListener)||void 0===e||e.call(this);const t=Lw(this.clientWidth,this.clientHeight,this.getAttribute(p_)||"",this.canvasId,(e=>Gw(this.getCurrentMediaSDK(),e)));this.removeListener=Vw(t,this),this.shadowRoot&&this.shadowRoot.replaceChild(t,this.canvas),this.canvas=t}}getCanvas(){return this.canvas||this.createCanvas(),this.canvas}getSessionId(){return this.getAttribute(h_)||void 0}getCurrentMediaSDK(){return Hw(this.getSessionId())}getRGBA(){return function(e){let t=0,n=0,i=0,r=0;if("r"===e[0])if("a"===e[3]){const o=e.slice(5,-1).split(",").map((e=>parseInt(e.trim(),10)));t=o[0],n=o[1],i=o[2],r=o[3]}else{const r=e.slice(4,-1).split(",").map((e=>parseInt(e.trim(),10)));t=r[0],n=r[1],i=r[2]}else if("#"===e[0]){let r=e.slice(1);3===r.length&&(r=r.split("").map((e=>e.repeat(2))).join(""));const o=parseInt(r,16);t=o>>16&255,n=o>>8&255,i=255&o}return{R:t/255,G:n/255,B:i/255,A:r}}(getComputedStyle(this).getPropertyValue("background-color"))}}function g_(e){const{audio:{isBackgroundNoiseSuppression:t,originalSound:n,highBitrate:i}}=e,r={currentSelect:Au.Denoise},o={highfidelity:!1,stereo:!1};if(n){Object.assign(r,{currentSelect:Au.OriginalSound});const e={};"boolean"==typeof n?Object.assign(e,o):Object.assign(e,{highfidelity:!!n.hifi,stereo:!!n.stereo}),Object.assign(r,{originalSound:e})}return Object.assign(r,{backgroundNoiseSuppression:t?Cu.Zoom:Cu.Browser,highBitrate:i}),r}function m_(e,t,n,i){const{meeting:{userId:r},audio:{localShareAudioUserMutedList:o},share:{isReceiveSharingFromMainSession:s}}=i;return o.filter((e=>e.userId!==t)).forEach((t=>{e.setSharingAudioVolume(t.userId,!0,t.isFromMainSession)})),e.setSharingAudioVolume(t,n,!!s),t===r?Xh(n):Qh({userId:t,muted:n})}async function v_(e,t,n){var i,r;const{audio:{audioSsrc:o,activeMicrophone:s,activeSpeaker:a,isAllowToTalk:u,customizeAudioOption:{speakerOnly:l,mute:c,microphoneId:d,speakerId:h},isUsingMediaPlayback:p,mediaPlaybackFile:f,isHIDEnabled:g,microphoneDevicesList:m,isVerifiedAudioPermissionOnIOSMobile:v,speakerDevicesList:y},meeting:{svcUrl:S,conId:b,reportDomain:E,isAudioBridgeEnabled:w,userId:_,supportLocalAB:I,abToken:C}}=t,A=gh(t),T=!!l||eh(A.userRole)&&!u,R=null!=n?n:!T;Ho()&&(w||console.warn("Cannot start audio due to the service is not ready."),await je(Hv(t,!R)).then((e=>{let[t,n]=e;return t&&n?Promise.resolve():Promise.reject()})));let O=s,P=a;if(void 0!==d||void 0!==h){let e=m,t=y;if(0===m.length){const{microphones:n,speakers:i}=await je(Dv());e=n,t=i}d&&e.findIndex((e=>e.deviceId===d))>-1&&(O=d),h&&t.findIndex((e=>e.deviceId===h))>-1&&(P=h)}if(p&&null!=f&&f.url){const e=Gv.getInstance();await e.setAudioElement(f),O=e.audioElement}else Gv.getInstance().stopAudioElement();return T&&!v&&Uo.isIOSMobile&&await async function(){await navigator.mediaDevices.getUserMedia({audio:!0})}(),null===(i=e.joinComputerAudio(o,O,P,R,g_(t),Ho()?{rwgHost:S,cid:b,nginxHost:E,abToken:C,supportLocalAB:I,useWebRTCOnDesktop:!Uo.isAndroidOrIOSBrowser}:void 0,g?{microphoneLabel:null===(r=m.find((e=>e.deviceId===s)))||void 0===r?void 0:r.label,defaultMuted:!(null==A||!A.muted)}:void 0))||void 0===i?void 0:i.then((()=>{c&&(Ps.createAgent().mute(_,!0),e.muteAudio()),null!=A&&A.muted?e.muteAudio():e.unmuteAudio()}))}async function y_(e,t,n){const i=[],{audio:{isJoinComputerAudioBeforeSharingAudio:r,mutedBeforeSharingAudio:o}}=n,s=gh(n);return!0===r&&(await v_(e,n),i.push(Yh(void 0)),!1===o&&(i.push(gp(Ma.SharingAudio)),t.mute(s.userId,!1)),i.push(zh(void 0))),i}async function S_(e,t,n){const{audio:{isSharingAudio:i},meeting:{userId:r}}=n,o=[];if(o.push(m_(e,r,!0,n)),i){await e.leaveSharingAudio(!1),o.push(ep(!1));const i=await y_(e,t,n);o.push(...i),setTimeout((()=>{_d(Pl,{state:"off"})}),0)}return o.push(Zh(!1)),o}async function b_(e,t,n){const{audio:{audioSsrc:i,activeMicrophone:r,activeSpeaker:o},meeting:{svcUrl:s,conId:a,reportDomain:u,supportLocalAB:l,abToken:c}}=n,d=gh(n),h=[];if(!__()){const t=await async function(e,t){const n=[],i=gh(t),{audio:{isMicrophoneForbidden:r}}=t;return(null==i?void 0:i.audio)===yu.Computer&&(n.push(Yh(!0)),n.push(zh(i.muted)),i.muted||e.muteAudio(),await e.leaveComputerAudio(),n.push(jh(0)),r&&n.push(Vh(!1))),n}(e,n);h.push(...t)}return await e.leaveSharingAudio(!0),await e.joinSharingAudio({ssrc:i,microphoneDeviceId:r,speakerDeviceId:o,isCaptureAudio:eh(d.userRole),audioBridge:Ho()?{rwgHost:s,cid:a,nginxHost:u,abToken:c,supportLocalAB:l,useWebRTCOnDesktop:!Uo.isAndroidOrIOSBrowser}:void 0}),h.push(Zh(!0)),h.push(ep(!0)),h.push(m_(e,d.userId,!1,n)),h.findIndex((e=>e.type===`${Yh}`&&!0===e.payload))>-1&&(h.push(fp(Na.SharingAudio)),t.mute(n.meeting.userId,!0)),setTimeout((()=>{_d(Pl,{state:"on"})}),0),h}f_.customAttributes=[],f_.defaultValues={};const E_=()=>{if(Wo())return!0;{var e;let{browser:n}=Uo;if(n=null===(e=n)||void 0===e?void 0:e.toLocaleLowerCase(),n.indexOf("safari")>-1&&-1===n.indexOf("ios-safari")){var t;const e=null===(t=navigator.userAgent.match(/version\/(\d+\.?\d+)/i))||void 0===t?void 0:t[1];return lr(e||"","15.2")>=0&&lr(e||"","17.1")<0}return!1}};function w_(e,t,n){for(let i=0;i<n.length&&0!==t.length;i++){const{userId:r,displayName:o}=n[i];if(t.includes(r)){const n=e.find((e=>e.userId===r));n&&(n.displayName=o,t.splice(t.indexOf(r),1))}}}function __(){return Ls.isSupportOpenMicWhenShareAudio()}function I_(e){return Ls.isSupportAudioDenoise(e)}function C_(){return Ls.isSupportStereoAudio()}function A_(){var e;return"function"==typeof(null===(e=window.navigator.hid)||void 0===e?void 0:e.requestDevice)}function T_(e,t,n){const{audio:{isAllowToTalk:i,customizeAudioOption:r},media:{audioDecodeStatus:o,audioEncodeStatus:s}}=e;return{encodeInitStatus:eh(t.userRole)&&!i||n||null!=r&&r.speakerOnly||Ho()?"success":s,decodeInitStatus:Ho()?"success":o}}function R_(e,t,n){Ho()?Hv(t,n).subscribe((t=>{let[n,i]=t;n&&i&&e.joinOrLeaveVoip(!0)})):e.joinOrLeaveVoip(!0)}const O_=Ps.createAgent(),P_=Lv(nb(Ls.getInstance())),D_=e=>!e.muted,k_=Ps.createAgent(),x_=Lv(nb(Ls.getInstance())),N_=Ps.createAgent(),M_=Lv(nb(Ls.getInstance())),F_={asnIds:{asn1:{userId:0,displayName:null},asn2:{userId:0,displayName:null},asn3:{userId:0,displayName:null}},microphoneDevicesList:[],speakerDevicesList:[],activeMicrophone:"default",activeSpeaker:"default",isMicrophoneForbidden:!1,audioSsrc:0,bCanUnmute:!1,bMutedUponEntry:!1,isAllowToTalk:void 0,dialout:[],crcDevice:[],canPlayAudio:!1,mutedSource:void 0,unmutedSource:void 0,isUserGrantCaptureAudio:!1,webrtcRestartCount:0,isComputerAudioLoading:!1,isUsingMediaPlayback:!1,customizeAudioOption:{},localShareAudioUserMutedList:[],locallyMutedAudioList:[],localUserAudioVolumeList:[],isStopAllImcomingAudio:!1,statistic:{encode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,bandwidth:0,bitrate:0},decode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,bandwidth:0,bitrate:0}}},L_=Rn({[`${Ph}`]:hE(((e,t)=>{let{payload:n}=t;e.asnIds={...n}})),[`${Dh}`]:hE(((e,t)=>{let{payload:n}=t;e.bCanUnmute=n})),[`${kh}`]:hE(((e,t)=>{let{payload:n}=t;const{sequence:i,phoneNumber:r}=n;-1===e.dialout.findIndex((e=>e.sequence===i))&&e.dialout.push({sequence:i,phoneNumber:r,returnCode:-1,uuid:Cy()})})),[`${xh}`]:hE(((e,t)=>{let{payload:n}=t;const{sequence:i,code:r,nodeId:o}=n,s=e.dialout.find((e=>e.sequence===i));s&&(s.returnCode=r,o&&(s.phoneNodeId=o))})),[`${Nh}`]:hE(((e,t)=>{let{payload:n}=t;e.isAllowToTalk=n,e.isAllowToTalkAttendeeConnected=!1})),[`${fp}`]:hE(((e,t)=>{let{payload:n}=t;e.mutedSource=n})),[`${gp}`]:hE(((e,t)=>{let{payload:n}=t;e.unmutedSource=n})),[`${Mh}`]:hE(((e,t)=>{let{payload:n}=t;e.audioSsrc=n})),[`${Fh}`]:hE(((e,t)=>{let{payload:n}=t;e.bMutedUponEntry=n})),[`${Lh}`]:hE(((e,t)=>{let{payload:n}=t;e.isUserGrantCaptureAudio=n})),[`${Vh}`]:hE(((e,t)=>{let{payload:n}=t;e.isMicrophoneForbidden=n})),[`${jh}`]:hE(((e,t)=>{let{payload:n}=t;e.webrtcRestartCount=n})),[`${Bh}`]:hE(((e,t)=>{let{payload:n}=t;e.microphoneDevicesList=n})),[`${Uh}`]:hE(((e,t)=>{let{payload:n}=t;e.speakerDevicesList=n})),[`${Hh}`]:hE(((e,t)=>{let{payload:n}=t;e.activeMicrophone=n})),[`${qh}`]:hE(((e,t)=>{let{payload:n}=t;e.activeSpeaker=n})),[`${Kh}`]:hE(((e,t)=>{let{payload:n}=t;e.canPlayAudio=n})),[`${Wh}`]:hE(((e,t)=>{let{payload:n}=t;e.isComputerAudioLoading=n})),[`${ap}`]:hE(((e,t)=>{let{payload:n}=t;if(n){const{speakerOnly:t,mute:i,backgroundNoiseSuppression:r,originalSound:o,syncButtonsOnHeadset:s,mediaFile:a,microphoneId:u,speakerId:l,highBitrate:c}=n;e.customizeAudioOption.speakerOnly=t,e.customizeAudioOption.mute=i,e.customizeAudioOption.microphoneId=u,e.customizeAudioOption.speakerId=l,e.isBackgroundNoiseSuppression=!!r,e.isHIDEnabled=!!s,e.originalSound=o,e.highBitrate=!!c,dr(e.mediaPlaybackFile,a)||(e.mediaPlaybackFile=a,e.isUsingMediaPlayback=!(null==a||!a.url)),i&&(e.mutedSource=Na.Inherited)}})),[`${Gh}`]:hE(((e,t)=>{let{payload:n}=t;e.isAllowToTalkAttendeeConnected=n})),[`${zh}`]:hE(((e,t)=>{let{payload:n}=t;e.mutedBeforeSharingAudio=n})),[`${ep}`]:hE(((e,t)=>{let{payload:n}=t;e.isSharingAudio=n})),[`${Xh}`]:hE(((e,t)=>{let{payload:n}=t;e.isShareAudioMuted=n})),[`${Jh}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:i,isFromMainSession:r}=n;-1===e.localShareAudioUserMutedList.findIndex((e=>e.userId===i))&&e.localShareAudioUserMutedList.push({userId:i,isFromMainSession:r,muted:!1})})),[`${Qh}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.localShareAudioUserMutedList.find((e=>e.userId===n.userId));i&&(i.muted=n.muted)})),[`${Yh}`]:hE(((e,t)=>{let{payload:n}=t;e.isJoinComputerAudioBeforeSharingAudio=n})),[`${Zh}`]:hE(((e,t)=>{let{payload:n}=t;e.isShareAudioEnabled=n})),[`${tp}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:i,rate:r,...o}}=n;e.statistic.encode={bitrate:r,...o}})),[`${np}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:i,rate:r,...o}}=n;e.statistic.decode={bitrate:r,...o}})),[`${ip}`]:hE(((e,t)=>{let{payload:n}=t;-1===e.locallyMutedAudioList.findIndex((e=>e===n))&&e.locallyMutedAudioList.push(n)})),[`${rp}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.locallyMutedAudioList.findIndex((e=>e===n));-1!==i&&e.locallyMutedAudioList.splice(i,1)})),[`${op}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.localUserAudioVolumeList.find((e=>e.userId===n.userId));i?i.volume=n.volume:e.localUserAudioVolumeList.push(n)})),[`${sp}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.localUserAudioVolumeList.findIndex((e=>e.userId===n.userId));-1!==i&&e.localUserAudioVolumeList.splice(i,1)})),[`${up}`]:hE(((e,t)=>{let{payload:n}=t;e.isBackgroundNoiseSuppression=n})),[`${lp}`]:hE(((e,t)=>{let{payload:n}=t;e.isHIDEnabled=n})),[`${cp}`]:hE(((e,t)=>{let{payload:n}=t;e.mediaPlaybackFile=n,e.isUsingMediaPlayback=!(null==n||!n.url)})),[`${dp}`]:hE(((e,t)=>{let{payload:n}=t;e.isStopAllImcomingAudio=n})),[`${hp}`]:hE(((e,t)=>{let{payload:n}=t;e.isVerifiedAudioPermissionOnIOSMobile=n})),[`${pp}`]:hE(((e,t)=>{let{payload:n}=t;e.isAudioBridgeSignalReconnecting=n})),[`${mp}`]:hE(((e,t)=>{let{payload:n}=t;e.originalSound=n})),[`${vp}`]:hE(((e,t)=>{let{payload:n}=t;e.leaveAudioSource=n})),[`${yp}`]:hE(((e,t)=>{let{payload:n}=t;e.secondaryAudioMicrophoneId=n})),[`${Sp}`]:hE(((e,t)=>{let{payload:n}=t;const{sequence:i,ip:r,protocol:o}=n;-1===e.crcDevice.findIndex((e=>e.sequence===i))&&e.crcDevice.push({sequence:i,ip:r,protocol:o,transId:0,uuid:Cy()})})),[`${bp}`]:hE(((e,t)=>{let{payload:n}=t;const{sequence:i,transID:r,result:o}=n,s=e.crcDevice.find((e=>e.sequence===i));s&&Object.assign(s,{transId:r,returnCode:o})})),[`${$h}`]:(e,t)=>{let{dialout:n,crcDevice:i,locallyMutedAudioList:r,localUserAudioVolumeList:o,customizeAudioOption:s,originalSound:a,highBitrate:u,isHIDEnabled:l,isBackgroundNoiseSuppression:c,isStopAllImcomingAudio:d,mediaPlaybackFile:h,isUsingMediaPlayback:p,isVerifiedAudioPermissionOnIOSMobile:f,activeSpeaker:g,activeMicrophone:m}=e,{payload:v}=t;return v?{...F_,dialout:n,crcDevice:i,locallyMutedAudioList:r,localUserAudioVolumeList:o,customizeAudioOption:{...F_.customizeAudioOption,speakerOnly:s.speakerOnly},originalSound:a,highBitrate:u,isHIDEnabled:l,isBackgroundNoiseSuppression:c,isStopAllImcomingAudio:d,mediaPlaybackFile:h,isUsingMediaPlayback:p,isVerifiedAudioPermissionOnIOSMobile:f,activeSpeaker:g,activeMicrophone:m}:{...F_}}},F_),V_={dialEpics0:(e,t)=>pi(e,8198).pipe(Tt(t),ht((e=>{let[t,n]=e;return n.audio.dialout.map((e=>e.sequence)).includes(t.payload.seq)})),Ye((e=>{let[t,n]=e;const{payload:{seq:i,body:{phoneNodeID:r,result:o}}}=t,s=[xh({code:o,sequence:i,nodeId:r})],{audio:{dialout:a}}=n,u=a.find((e=>e.sequence===i)),l={code:o};if(u&&(Object.assign(l,{phoneNumber:u.phoneNumber,uuid:u.uuid}),r&&Object.assign(l,{userId:r})),_d(Sl,l),o===Va.Success){if(_d(bl),r&&bh(n).findIndex((e=>e.userId===r))>-1){var c;const e=null===(c=n.audio.dialout.find((e=>e.sequence===i)))||void 0===c?void 0:c.phoneNumber;e&&(s.push(jd({userId:r,key:"phoneNumber",value:e})),_d(Us,[{userId:r,phoneNumber:e}]))}}else[Va.Canceling,Va.Canceled,Va.CancelFailed].includes(o)?o===Va.Canceled?_d(wl):o===Va.CancelFailed&&_d(_l):-1===[Va.Calling,Va.Ringing,Va.Accepted,Va.Success].indexOf(o)&&_d(El);return Me(s)}))),dialEpics1:(e,t)=>pi(e,4120).pipe(Tt(t),ht((e=>{let[t,n]=e;return n.audio.crcDevice.map((e=>e.sequence)).includes(t.payload.seq)})),Ye((e=>{let[t,n]=e;const{payload:{seq:i,body:{result:r,transID:o}}}=t,{audio:{crcDevice:s}}=n,a=[],u=s.find((e=>e.sequence===i));return u&&(_d(Ml,{code:r,ip:u.ip,protocol:u.protocol,uuid:u.uuid}),a.push(bp({sequence:i,transID:o,result:r}))),r===Ou.Success?_d(Fl):[Ou.Success,Ou.Ringing].includes(r)||_d(Ll),Me(a)})))},j_={epics0:(e,t)=>pi(e,12033).pipe(Tt(t),Ke((e=>{let[t,n]=e;const{participants:{allowTalkAttendeesList:i}}=n,r=t.payload.body;let o={};if(r){const e=bh(n),t=Object.keys(r).map((e=>({key:e,userId:r[e]}))),s=t.map((e=>e.userId));w_(t,s,e),i.length>0&&s.length>0&&w_(t,s,i),o=t.reduce(((e,t)=>({...e,[`${t.key}`]:{userId:t.userId,displayName:t.displayName}})),{}),_d(dl,Object.values(o))}return Ph(o)}))),epics1:(e,t)=>pi(e,16135).pipe(Tt(t),At((e=>{let[t,n]=e;const{payload:{body:{id:i,bLeadershipOn:r}}}=t,{audio:{bCanUnmute:o}}=n,s=gh(n);if(s){const{isHost:e,bCoHost:t,userId:n,audio:a,muted:u}=s,l=e||t;r&&hr(n,i)&&(null!==a&&""!==a&&!0!==u||!l&&!o||_d(hl,xa.Spotlight))}})),St(ge)),epics2:(e,t)=>pi(e,12037).pipe(Tt(t),At((e=>{let[,t]=e;const n=gh(t);null!==(null==n?void 0:n.audio)&&""!==(null==n?void 0:n.audio)&&1==(null==n?void 0:n.muted)&&_d(hl,xa.Unmute)})),St(ge)),epics3:(e,t)=>pi(e,rs).pipe(ht((e=>e.payload.body&&["bCanUnmute","bMutedAll","bMutedUponEntry"].some((t=>void 0!==e.payload.body[t])))),Ye((e=>{const{payload:{body:{bCanUnmute:n,bMutedAll:i,bMutedUponEntry:r}}}=e,o=[];if(void 0!==n&&o.push(Dh(e.payload.body.bCanUnmute)),void 0!==i){const n=gh(t.value);(null==n?void 0:n.audio)!==yu.Computer&&(null==n?void 0:n.audio)!==yu.Phone||0!=n.muted||e.payload.body.bMutedAll&&o.push(fp(Na.PassiveByMuteAll))}return void 0!==r&&o.push(Fh(e.payload.body.bMutedUponEntry)),Me(o)}))),epics4:(e,t)=>pi(e,is).pipe(Tt(t),ht((e=>{let[,t]=e;return t.socket.zoomSocketStatus===Th.Connected})),Ye((e=>{let[n,i]=e;const{payload:{body:{update:r}}}=n;if(null!=r&&r.some((e=>void 0!==e.audio||void 0!==e.muted))){const{meeting:{userId:e}}=i,n=r.filter((t=>t.id!==e)),o=r.filter((t=>t.id===e));if(n&&n.forEach((e=>{_d(yl,e)})),o.length>0)return Ov(t).pipe(Ye((e=>{const{audio:{mutedSource:n,unmutedSource:i,isAllowToTalk:r,isShareAudioEnabled:s,isSharingAudio:a,isAudioBridgeSignalReconnecting:u,leaveAudioSource:l,customizeAudioOption:{speakerOnly:c}}}=t.value,d=e;return Me(o).pipe(ey((async e=>{const t=[];if(e.audio!==d.audio)if(""===e.audio)_d(gl,{source:l}),t.push(vp(void 0));else if(e.audio===yu.Computer){const e=eh(d.userRole)&&!r||!!c;a&&_d(pl),e&&(_d(pl),Uo.isIOSMobile&&t.push(hp(!0))),u&&(_d(pl),t.push(pp(!1)))}else e.audio===yu.Phone&&(d.audio===yu.Computer&&(await P_.leaveComputerAudio(),t.push(vp(Fa.Pstn)),O_.joinOrLeaveVoip(!1)),_d(fl));if(""!==d.audio&&e.muted!==d.muted){if(e.muted!==d.muted)if(!0===e.muted){if(n!==Na.Inherited){const e=null!=n?n:Na.PassiveByMuteOne;_d(ml,{source:e})}d.audio!==yu.Computer||s&&!__()||P_.muteAudio()}else if(!1===e.muted){if(i!==Ma.Inherited){const e=null!=i?i:Ma.Passive;_d(vl,{source:e})}d.audio===yu.Computer&&P_.unmuteAudio()}void 0!==e.muted&&t.push(fp(void 0),gp(void 0))}return t})))})))}return ge}))),epics5:(e,t)=>pi(e,12036).pipe(Tt(t),Ye((e=>{let[t,n]=e;const i=gh(n),{media:{audioEncodeStatus:r}}=n,{promoterID:o,bAllowTalk:s}=t.payload.body;if((null==i?void 0:i.userId)===o){if(_d(Ol,s),s)return"success"!==r&&P_.enableAudioEncode(),Rv("audio",r,"success").pipe(Ye((e=>(e&&_d(hl,xa.AllowToTalk),ge))),wt(Nh(!0)));if(O_.mute(o,!0),(null==i?void 0:i.audio)===yu.Computer)return P_.leaveComputerAudio(),at(300).pipe(At((async()=>{(E_()?je(pt(rt(document,"click").pipe(gt(1)),rt(document,"touchend").pipe(gt(1)))):Promise.resolve(!0)).then((()=>{v_(P_,n,!1)}))})),St(ge),wt(Nh(!1),fp(Na.Inherited)))}return ge}))),epics6:e=>pi(e,8205).pipe(At((e=>{_d("AUDIO_ALLOW_TO_TALK_RESPONSE",e.payload.body)})),St(ge)),epics7:(e,t)=>gi(e,24597).pipe(Tt(t),At((e=>{let[t,n]=e;const i=gh(n);(null==i?void 0:i.audio)===yu.Phone?O_.audioDrop(i.userId):(null==i?void 0:i.audio)===yu.Computer&&t.payload.body.bPromote})),St(ge)),epics8:(e,t)=>pi(e,12035).pipe(Tt(t),_t((e=>{let[n,i]=e;const{meeting:{currentUserAudioBeforeReset:r}}=i,{payload:{body:{ssrc:o}}}=n,s=Ov(t).pipe(Ye((e=>{if(r===yu.Computer&&(null==e||!e.audio)){const{encodeInitStatus:n,decodeInitStatus:i}=T_(t.value,e);return Rv("audio",n,i).pipe(ht((e=>{let[t,n]=e;return t&&n})),At((()=>{(E_()?je(pt(rt(document,"click").pipe(gt(1)),rt(document,"touchend").pipe(gt(1)))):Promise.resolve(!0)).then((()=>{R_(O_,t.value),v_(P_,t.value)}));const{audio:{locallyMutedAudioList:e,localUserAudioVolumeList:n,isStopAllImcomingAudio:i}}=t.value;e.length>0&&e.forEach((e=>{P_.muteOrUnmuteOtherAudio(e,!0)})),n.length>0&&n.forEach((e=>{P_.adjustOtherAudioVolume(e.userId,e.volume)})),i&&P_.stopAllIncomingAudio(!0)})),mt(to(void 0)))}return ge})));return _d(kl,o),lt(Fe(Mh(o)),s)}))),epics9:(e,t)=>pi(e,7952).pipe(_t((e=>Ad(fl,1).pipe(Tt(t),At((t=>{let[,n]=t;const{BindStatus:i,nOperatorUserId:r}=e.payload.body,o=n.participants.attendeesList.find((e=>e.userId===r));!0===i&&_d(Il,{operatorName:null==o?void 0:o.displayName,operatorUserId:r,operatorRole:null==o?void 0:o.userRole})})),St(ge))))),epics10:(e,t)=>vi(e,Da.UserGrantCaptureAudio).pipe(Tt(t),Ye((e=>{let[t,n]=e;const i=gh(n);var r;(r=i,(null==r?void 0:r.audio)===yu.Computer?Promise.resolve():Cd({event:js,operations:[ht((e=>void 0!==e.audio&&""!==e.audio)),gt(1)]},(e=>{let{audio:t}=e;return t===yu.Phone||t===yu.Computer}))).then((()=>{_d(pl)}));const{meeting:{isCurrentUserMutedBeforeReset:o},audio:{bMutedUponEntry:s,isUserGrantCaptureAudio:a,isAllowToTalk:u,activeMicrophone:l}}=n,{payload:{data:c}}=t,d=[Lh(!0)];if(i){!0===i.muted&&!1===u&&(d.push(fp(Na.Inherited)),O_.mute(i.userId,!0));const e=a||i.isHost||u;(!0===o||!e&&s)&&(d.push(fp(Na.Inherited)),O_.mute(i.userId,!0),o&&d.push(no(void 0))),c&&l!==c&&d.push(Hh(c))}return Me(d)}))),epics11:e=>vi(e,Da.UserForbiddedCaptureAudio).pipe(At((()=>{_d(Cl)})),mt(Vh(!0))),epics12:e=>vi(e,Da.AudioWebsocketBroken).pipe(At((()=>{_d(Al)})),St(ge)),epics13:(e,t)=>vi(e,Da.AudioZeroData).pipe(Tt(t),Zv((e=>{let[,t]=e;const{audio:{webrtcRestartCount:n,activeMicrophone:i}}=t;if(n<3)return P_.restoreWebRTC(i),jh(n+1)}))),epics14:(e,t)=>e.pipe(Ut(`${Kh}`),ht((e=>!1===e.payload)),Ye((()=>(_d(Tl),pt(rt(document,"click").pipe(gt(1)),rt(document,"touchend").pipe(gt(1))).pipe(At((()=>{R_(O_,t.value),v_(P_,t.value)})),mt(Kh(!0))))))),epics15:e=>vi(e,[Da.JoinComputerAudioComplete,Da.JoinSharingAudioComplete,Da.LeaveComputerAudioComplete,Da.LeaveSharingAudioComplete]).pipe(At((()=>{Fv.completeAudioAction()})),St(ge)),epics16:(e,t)=>vi(e,Da.AudioQosData).pipe(Tt(t),Ke((e=>{var t;let[n,i]=e;const{meeting:{isWebinar:r},media:{audioEncodeStatus:o,audioDecodeStatus:s},participants:{xmppAttendeeList:a,allowTalkAttendeesList:u}}=i,l=gh(i),c=Ih(i);let d=c.length>0,h=c.some(D_);const p=Ho();r&&(d=d||Boolean(a.length),h=h||u.some(D_));const f=((null==l?void 0:l.audio)===yu.Computer||(null==l?void 0:l.audio)===yu.Phone)&&("success"===o||p)&&!(null!=l&&l.muted)&&d,g=((null==l?void 0:l.audio)===yu.Computer||(null==l?void 0:l.audio)===yu.Phone)&&("success"===s||p)&&d&&h;return null!==(t=n.payload.data)&&void 0!==t&&t.encoding?f?(_d(Dl,n.payload),tp(n.payload)):tp(lu):g?(_d(Dl,n.payload),np(n.payload)):np(lu)}))),epics17:(e,t)=>pi(e,is).pipe(Tt(t),ht((e=>{let[t,n]=e;const{payload:{body:i}}=t,{audio:{locallyMutedAudioList:r,localUserAudioVolumeList:o}}=n;return(r.length>0||o.length>0)&&(null==i?void 0:i.remove)&&i.remove.length>0})),Ye((e=>{let[t,n]=e;const{payload:{body:{remove:i}}}=t,{audio:{locallyMutedAudioList:r,localUserAudioVolumeList:o}}=n,s=r.concat(o.map((e=>e.userId))).filter((e=>-1!==i.indexOf((t=>t.id===e))));return s.length>0?(s.forEach((e=>{P_.muteOrUnmuteOtherAudio(e,!1)})),Me(s.map((e=>[rp(e),sp({userId:e})])).flat())):ge}))),epics18:(e,t)=>vi(e,Da.HidStatusMute).pipe(Ye((e=>{const{payload:{data:n}}=e,i=t.value,{meeting:{userId:r},audio:{isShareAudioEnabled:o,bCanUnmute:s}}=i,a=[];if(n)o&&!__()&&a.push(zh(!0)),a.push(fp(Na.Active)),O_.mute(r,!0);else if(!o||__()){o&&a.push(zh(!1));const e=gh(i);(s||null!=e&&e.isHost||null!=e&&e.bCoHost)&&(a.push(gp(Ma.Active)),O_.mute(r,!1))}return Me(a)}))),epics19:e=>pi(e,12040).pipe(At((e=>{const{payload:{body:{mode:t}}}=e;P_.setAudioCodecMode(t)})),St(ge)),epics20:(e,t)=>vi(e,[Da.AudioSpeakerSetSuccess,Da.JoinComputerAudioComplete,Da.AudioSpeakerSetError]).pipe(Ye((e=>{const{payload:{data:n,type:i}}=e,{audio:{activeSpeaker:r,activeMicrophone:o}}=t.value,s=[];return i===Da.AudioSpeakerSetSuccess&&r!==n?s.push(qh(n)):i===Da.JoinComputerAudioComplete&&null!==n&&o!==n&&s.push(Hh(n)),i===Da.AudioSpeakerSetSuccess?_d(xl,!0):i===Da.AudioSpeakerSetError&&_d(xl,!1),Me(s)}))),epics21:(e,t)=>vi(e,Da.AudioLevelIndicator).pipe(ht((()=>{const e=gh(t.value);return!!e&&e.audio===yu.Computer&&!e.muted})),At((e=>{const{payload:{data:t}}=e;_d(Vl,{level:t.value})})),Ye((()=>ge)))},B_=hi(j_,{shareAudioEpics0:(e,t)=>mi(e,is).pipe(ht((e=>{const t=e.payload.body.update;return t&&t.length>0&&t.findIndex((e=>void 0!==e.bShareOn))>-1})),Tt(t),Ye((e=>{let[t,n]=e;const{payload:{body:{update:i}}}=t,{audio:{localShareAudioUserMutedList:r}}=n,o=i.filter((e=>!0===e.bShareOn&&!0===e.bShareAudioOn)),s=[];return o.length>0&&o.forEach((e=>{-1===r.findIndex((t=>t.userId===e.id))&&s.push(Jh({userId:e.id,isFromMainSession:!!e.bShareToBORooms}))})),Me(s)}))),shareAudioEpics1:(e,t)=>vi(e,Da.SharingDesktopStreamHaveAudio).pipe(ht((()=>!t.value.audio.secondaryAudioMicrophoneId)),_t((()=>pi(e,is).pipe(ht((e=>{var n;const{payload:{body:i}}=e,{meeting:{userId:r}}=t.value;return(null==i||null===(n=i.update)||void 0===n?void 0:n.findIndex((e=>e.id===r&&!0===e.bShareOn)))>-1})),gt(1),ey((async()=>{const e=t.value;return await b_(x_,k_,e)})),wt(Zh(!0)))))),shareAudioEpics2:(e,t)=>vi(e,Da.SharingDesktopStreamHaveNoAudio).pipe(Tt(t),ht((e=>{var t;let[,n]=e;return!0===(null===(t=n.audio)||void 0===t?void 0:t.isShareAudioEnabled)})),ey((async e=>{let[,t]=e;return await S_(x_,k_,t)}))),shareAudioEpics3:(e,t)=>pi(e,is).pipe(Tt(t),ht((e=>{let[,t]=e;return t.socket.zoomSocketStatus===Th.Connected&&!0===t.audio.isSharingAudio})),Ye((e=>{var n;let[i,r]=e;if(null!==(n=i.payload.body.update)&&void 0!==n&&n.some((e=>void 0!==e.audio||void 0!==e.muted))){const{meeting:{userId:e}}=r,n=i.payload.body.update.filter((t=>t.id===e));return Ov(t).pipe(Ye((e=>{const t=[];return n.findIndex((e=>e.audio===yu.Computer))>-1&&(null==e?void 0:e.audio)!==yu.Computer&&!__()&&(t.push(Yh(!0)),t.push(zh(!0))),Me(t)})))}return ge}))),shareAudioEpics4:(e,t)=>e.pipe(Ut(`${Tp}`),ke(de),Tt(t),ht((e=>{var t;let[,n]=e;return!0===(null===(t=n.audio)||void 0===t?void 0:t.isShareAudioEnabled)})),ey((async e=>{let[t,n]=e;const{payload:i}=t,{audio:{isShareAudioMuted:r,isSharingAudio:o}}=n,s=[];if(i===qa.End){const e=await S_(x_,k_,n);s.push(...e)}else if(i===qa.Paused){if(!1===r&&!0===o){await x_.leaveSharingAudio(!0),s.push(ep(!1));const e=await y_(x_,k_,n);s.push(...e),setTimeout((()=>{_d(Pl,{state:"off"})}),0)}}else if(i===qa.Sharing&&!1===r&&!1===o){const e=await b_(x_,k_,n);s.push(...e)}return s}))),shareAudioEpics5:(e,t)=>vi(e,Da.SharingDesktopStreamHaveAudio).pipe(ht((()=>!!t.value.audio.secondaryAudioMicrophoneId)),At((()=>{const{audio:{audioSsrc:e,secondaryAudioMicrophoneId:n},meeting:{svcUrl:i,conId:r,reportDomain:o,supportLocalAB:s,abToken:a}}=t.value;x_.joinSharingAudio({ssrc:e,microphoneDeviceId:n,speakerDeviceId:null,isCaptureAudio:!0,audioBridge:Ho()?{rwgHost:i,cid:r,nginxHost:o,abToken:a,supportLocalAB:s,useWebRTCOnDesktop:!Uo.isAndroidOrIOSBrowser}:void 0}),_d(Nl)})),Ye((()=>ge)))},{audioBridgEpics0:e=>pi(e,4299).pipe(At((e=>{const{payload:t}=e;M_.passThroughRWGMessage(t)})),St(ge)),audioBridgEpics1:e=>vi(e,Da.AudioBridgeReconnectStart).pipe(Ye((()=>(N_.joinOrLeaveVoip(!1),Me([pp(!0),vp(Fa.Failover)]))))),audioBridgEpics2:(e,t)=>vi(e,Da.AudioBridgeReconnectEnd).pipe(At((()=>{R_(N_,t.value)})),St(ge)),audioBridgEpics3:e=>pi(e,is).pipe(ht((e=>{var t,n;return Ho()&&((null===(t=e.payload.body.update)||void 0===t?void 0:t.some((e=>void 0!==e.muted)))||(null===(n=e.payload.body.remove)||void 0===n?void 0:n.length)>0)})),At((e=>{const{payload:{body:{update:t,remove:n}}}=e;M_.sendUserAudioStatus({update:(t||[]).filter((e=>void 0!==e.muted)).map((e=>({userId:e.id,muted:e.muted}))),remove:(n||[]).map((e=>({userId:e.id})))})})),St(ge)),audioBridgEpics4:(e,t)=>vi(e,Da.NotifyUIFailover).pipe(ht((()=>!t.value.meeting.isMeetingReset&&t.value.meeting.meetingStatus===Co.Joined)),Ke((()=>(_d(Gs,{reason:Eo.Failover}),Nr(To.NotifyUiFailover))))),audioBridgEpics5:(e,t)=>yi(e,t).pipe(ht((()=>{const{meeting:{isAudioBridgeEnabled:e,abToken:n}}=t.value;return e&&Ho()&&!!n})),At((()=>{const{meeting:{abToken:e,svcUrl:n,reportDomain:i,conId:r,supportLocalAB:o}}=t.value;M_.preInitAudioBridge({abToken:e,rwgHost:n,cid:r,nginxHost:i,supportLocalAB:o,useWebRTCOnDesktop:!Uo.isAndroidOrIOSBrowser})})),St(ge)),audioBridgEpics6:(e,t)=>pi(e,16129).pipe(ht((e=>{const{payload:{body:{bVideoOn:n}}}=e,{meeting:{isAudioBridgeEnabled:i}}=t.value;return i&&Ho()&&!!n})),At((e=>{const{payload:{body:{id:t}}}=e;M_.changeActiveVideoSsrc(t)})),St(ge)),audioBridgEpics7:(e,t)=>vi(e,[Da.RecoverWebrtcAudio,Da.AudioStreamFailed]).pipe(Ye((()=>{const e=gh(t.value),n=[];return(null==e?void 0:e.audio)===yu.Computer&&(M_.leaveComputerAudio(),E_()?(N_.joinOrLeaveVoip(!1),n.push(vp(Fa.EndedBySystem)),n.push(jh(0))):v_(M_,t.value)),Me(n)}))),audioBridgEpics8:e=>vi(e,[Da.AudioBridgeFirstRecvData,Da.AudioBridgeCanSendData]).pipe(Ke((e=>{const{payload:{type:t}}=e;return t===Da.AudioBridgeFirstRecvData?(_d(Vc),oi(!0)):(_d(jc),si(!0))}))),audioBridgEpics9:(e,t)=>e.pipe(Ut(`${jr}`),ht((()=>!!t.value.meeting.zlkJwtToken)),At((()=>{const{meeting:{zlkJwtToken:e}}=t.value;if(e){const{enforce_web_rtc_audio:t,audio_compatible_mode:n}=mr(e);void 0===t&&void 0===n||Do.set(No.EnforceWebRTCAudio,1===Number(t)||1===Number(n),Oo.Memory)}})),St(ge))},V_);var U_="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,H_="object"==typeof self&&self&&self.Object===Object&&self,q_=U_||H_||Function("return this")(),K_=q_.Symbol,$_=Object.prototype,W_=$_.hasOwnProperty,G_=$_.toString,z_=K_?K_.toStringTag:void 0,J_=Object.prototype.toString,Q_="[object Null]",Y_="[object Undefined]",Z_=K_?K_.toStringTag:void 0;function X_(e){return null==e?void 0===e?Y_:Q_:Z_&&Z_ in Object(e)?function(e){var t=W_.call(e,z_),n=e[z_];try{e[z_]=void 0;var i=!0}catch(e){}var r=G_.call(e);return i&&(t?e[z_]=n:delete e[z_]),r}(e):function(e){return J_.call(e)}(e)}function eI(e){return null!=e&&"object"==typeof e}var tI=Array.isArray;function nI(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var iI="[object AsyncFunction]",rI="[object Function]",oI="[object GeneratorFunction]",sI="[object Proxy]";function aI(e){if(!nI(e))return!1;var t=X_(e);return t==rI||t==oI||t==iI||t==sI}var uI,lI=q_["__core-js_shared__"],cI=(uI=/[^.]+$/.exec(lI&&lI.keys&&lI.keys.IE_PROTO||""))?"Symbol(src)_1."+uI:"",dI=Function.prototype.toString;function hI(e){if(null!=e){try{return dI.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var pI=/^\[object .+?Constructor\]$/,fI=Function.prototype,gI=Object.prototype,mI=fI.toString,vI=gI.hasOwnProperty,yI=RegExp("^"+mI.call(vI).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function SI(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!nI(e)||(t=e,cI&&cI in t))&&(aI(e)?yI:pI).test(hI(e));var t}(n)?n:void 0}var bI=SI(q_,"WeakMap"),EI=9007199254740991,wI=/^(?:0|[1-9]\d*)$/;function _I(e,t){var n=typeof e;return!!(t=null==t?EI:t)&&("number"==n||"symbol"!=n&&wI.test(e))&&e>-1&&e%1==0&&e<t}function II(e,t){return e===t||e!=e&&t!=t}var CI=9007199254740991;function AI(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=CI}function TI(e){return null!=e&&AI(e.length)&&!aI(e)}var RI=Object.prototype;function OI(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||RI)}function PI(e){return eI(e)&&"[object Arguments]"==X_(e)}var DI=Object.prototype,kI=DI.hasOwnProperty,xI=DI.propertyIsEnumerable,NI=PI(function(){return arguments}())?PI:function(e){return eI(e)&&kI.call(e,"callee")&&!xI.call(e,"callee")},MI="object"==typeof t&&t&&!t.nodeType&&t,FI=MI&&e&&!e.nodeType&&e,LI=FI&&FI.exports===MI?q_.Buffer:void 0,VI=(LI?LI.isBuffer:void 0)||function(){return!1},jI={};jI["[object Float32Array]"]=jI["[object Float64Array]"]=jI["[object Int8Array]"]=jI["[object Int16Array]"]=jI["[object Int32Array]"]=jI["[object Uint8Array]"]=jI["[object Uint8ClampedArray]"]=jI["[object Uint16Array]"]=jI["[object Uint32Array]"]=!0,jI["[object Arguments]"]=jI["[object Array]"]=jI["[object ArrayBuffer]"]=jI["[object Boolean]"]=jI["[object DataView]"]=jI["[object Date]"]=jI["[object Error]"]=jI["[object Function]"]=jI["[object Map]"]=jI["[object Number]"]=jI["[object Object]"]=jI["[object RegExp]"]=jI["[object Set]"]=jI["[object String]"]=jI["[object WeakMap]"]=!1;var BI,UI="object"==typeof t&&t&&!t.nodeType&&t,HI=UI&&e&&!e.nodeType&&e,qI=HI&&HI.exports===UI&&U_.process,KI=function(){try{return HI&&HI.require&&HI.require("util").types||qI&&qI.binding&&qI.binding("util")}catch(e){}}(),$I=KI&&KI.isTypedArray,WI=$I?(BI=$I,function(e){return BI(e)}):function(e){return eI(e)&&AI(e.length)&&!!jI[X_(e)]},GI=Object.prototype.hasOwnProperty,zI=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),JI=Object.prototype.hasOwnProperty;function QI(e){if(!OI(e))return zI(e);var t=[];for(var n in Object(e))JI.call(e,n)&&"constructor"!=n&&t.push(n);return t}function YI(e){return TI(e)?function(e,t){var n=tI(e),i=!n&&NI(e),r=!n&&!i&&VI(e),o=!n&&!i&&!r&&WI(e),s=n||i||r||o,a=s?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],u=a.length;for(var l in e)!GI.call(e,l)||s&&("length"==l||r&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||_I(l,u))||a.push(l);return a}(e):QI(e)}var ZI=SI(Object,"create"),XI=Object.prototype.hasOwnProperty,eC=Object.prototype.hasOwnProperty;function tC(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function nC(e,t){for(var n=e.length;n--;)if(II(e[n][0],t))return n;return-1}tC.prototype.clear=function(){this.__data__=ZI?ZI(null):{},this.size=0},tC.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},tC.prototype.get=function(e){var t=this.__data__;if(ZI){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return XI.call(t,e)?t[e]:void 0},tC.prototype.has=function(e){var t=this.__data__;return ZI?void 0!==t[e]:eC.call(t,e)},tC.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ZI&&void 0===t?"__lodash_hash_undefined__":t,this};var iC=Array.prototype.splice;function rC(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}rC.prototype.clear=function(){this.__data__=[],this.size=0},rC.prototype.delete=function(e){var t=this.__data__,n=nC(t,e);return!(n<0||(n==t.length-1?t.pop():iC.call(t,n,1),--this.size,0))},rC.prototype.get=function(e){var t=this.__data__,n=nC(t,e);return n<0?void 0:t[n][1]},rC.prototype.has=function(e){return nC(this.__data__,e)>-1},rC.prototype.set=function(e,t){var n=this.__data__,i=nC(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};var oC=SI(q_,"Map");function sC(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function aC(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function uC(e){var t=this.__data__=new rC(e);this.size=t.size}aC.prototype.clear=function(){this.size=0,this.__data__={hash:new tC,map:new(oC||rC),string:new tC}},aC.prototype.delete=function(e){var t=sC(this,e).delete(e);return this.size-=t?1:0,t},aC.prototype.get=function(e){return sC(this,e).get(e)},aC.prototype.has=function(e){return sC(this,e).has(e)},aC.prototype.set=function(e,t){var n=sC(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},uC.prototype.clear=function(){this.__data__=new rC,this.size=0},uC.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},uC.prototype.get=function(e){return this.__data__.get(e)},uC.prototype.has=function(e){return this.__data__.has(e)},uC.prototype.set=function(e,t){var n=this.__data__;if(n instanceof rC){var i=n.__data__;if(!oC||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new aC(i)}return n.set(e,t),this.size=n.size,this};var lC=Object.prototype.propertyIsEnumerable,cC=Object.getOwnPropertySymbols,dC=cC?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var s=e[n];t(s)&&(o[r++]=s)}return o}(cC(e),(function(t){return lC.call(e,t)})))}:function(){return[]};function hC(e){return function(e,t,n){var i=t(e);return tI(e)?i:function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}(i,n(e))}(e,YI,dC)}var pC=SI(q_,"DataView"),fC=SI(q_,"Promise"),gC=SI(q_,"Set"),mC="[object Map]",vC="[object Promise]",yC="[object Set]",SC="[object WeakMap]",bC="[object DataView]",EC=hI(pC),wC=hI(oC),_C=hI(fC),IC=hI(gC),CC=hI(bI),AC=X_;(pC&&AC(new pC(new ArrayBuffer(1)))!=bC||oC&&AC(new oC)!=mC||fC&&AC(fC.resolve())!=vC||gC&&AC(new gC)!=yC||bI&&AC(new bI)!=SC)&&(AC=function(e){var t=X_(e),n="[object Object]"==t?e.constructor:void 0,i=n?hI(n):"";if(i)switch(i){case EC:return bC;case wC:return mC;case _C:return vC;case IC:return yC;case CC:return SC}return t});var TC=AC,RC=q_.Uint8Array;function OC(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new aC;++t<n;)this.add(e[t])}function PC(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}OC.prototype.add=OC.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},OC.prototype.has=function(e){return this.__data__.has(e)};var DC=1,kC=2;function xC(e,t,n,i,r,o){var s=n&DC,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var l=o.get(e),c=o.get(t);if(l&&c)return l==t&&c==e;var d=-1,h=!0,p=n&kC?new OC:void 0;for(o.set(e,t),o.set(t,e);++d<a;){var f=e[d],g=t[d];if(i)var m=s?i(g,f,d,t,e,o):i(f,g,d,e,t,o);if(void 0!==m){if(m)continue;h=!1;break}if(p){if(!PC(t,(function(e,t){if(s=t,!p.has(s)&&(f===e||r(f,e,n,i,o)))return p.push(t);var s}))){h=!1;break}}else if(f!==g&&!r(f,g,n,i,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function NC(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function MC(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var FC=K_?K_.prototype:void 0,LC=FC?FC.valueOf:void 0,VC=Object.prototype.hasOwnProperty,jC="[object Arguments]",BC="[object Array]",UC="[object Object]",HC=Object.prototype.hasOwnProperty;function qC(e,t,n,i,r){return e===t||(null==e||null==t||!eI(e)&&!eI(t)?e!=e&&t!=t:function(e,t,n,i,r,o){var s=tI(e),a=tI(t),u=s?BC:TC(e),l=a?BC:TC(t),c=(u=u==jC?UC:u)==UC,d=(l=l==jC?UC:l)==UC,h=u==l;if(h&&VI(e)){if(!VI(t))return!1;s=!0,c=!1}if(h&&!c)return o||(o=new uC),s||WI(e)?xC(e,t,n,i,r,o):function(e,t,n,i,r,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new RC(e),new RC(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return II(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=NC;case"[object Set]":var u=1&i;if(a||(a=MC),e.size!=t.size&&!u)return!1;var l=s.get(e);if(l)return l==t;i|=2,s.set(e,t);var c=xC(a(e),a(t),i,r,o,s);return s.delete(e),c;case"[object Symbol]":if(LC)return LC.call(e)==LC.call(t)}return!1}(e,t,u,n,i,r,o);if(!(1&n)){var p=c&&HC.call(e,"__wrapped__"),f=d&&HC.call(t,"__wrapped__");if(p||f){var g=p?e.value():e,m=f?t.value():t;return o||(o=new uC),r(g,m,n,i,o)}}return!!h&&(o||(o=new uC),function(e,t,n,i,r,o){var s=1&n,a=hC(e),u=a.length;if(u!=hC(t).length&&!s)return!1;for(var l=u;l--;){var c=a[l];if(!(s?c in t:VC.call(t,c)))return!1}var d=o.get(e),h=o.get(t);if(d&&h)return d==t&&h==e;var p=!0;o.set(e,t),o.set(t,e);for(var f=s;++l<u;){var g=e[c=a[l]],m=t[c];if(i)var v=s?i(m,g,c,t,e,o):i(g,m,c,e,t,o);if(!(void 0===v?g===m||r(g,m,n,i,o):v)){p=!1;break}f||(f="constructor"==c)}if(p&&!f){var y=e.constructor,S=t.constructor;y==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof S&&S instanceof S||(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,i,r,o))}(e,t,n,i,qC,r))}var KC=Object.prototype.hasOwnProperty;const $C=e=>4294966272&e,WC=e=>{let t={R:0,G:0,B:0,A:0};if("string"==typeof e&&e.startsWith("#")){const a=e.slice(1);try{if(3===a.length){const e=Array.from(a).map((e=>e.repeat(2))).map((e=>parseInt(e,16)));t={R:e[0]/255,G:e[1]/255,B:e[2]/255,A:1}}else if(6===a.length||8===a.length){var n,i,r,o,s;const e=null===(n=a.match(/\S{2}/g))||void 0===n?void 0:n.map((e=>parseInt(e,16)));t={R:(null!==(i=null==e?void 0:e[0])&&void 0!==i?i:0)/255,G:(null!==(r=null==e?void 0:e[1])&&void 0!==r?r:0)/255,B:(null!==(o=null==e?void 0:e[2])&&void 0!==o?o:0)/255,A:null!=e&&e[3]?(null!==(s=null==e?void 0:e[3])&&void 0!==s?s:0)/255:1}}}catch(t){console.warn("error color representation:",e)}}else"object"==typeof e&&(t={R:e.R/255,G:e.G/255,B:e.B/255,A:e.A||1});return t};function GC(e){let{captureWidth:t=0,captureHeight:n=0}=e||{};const{hd:i}=e||{};var r,o;return 0!==t&&0!==n||(i&&Ls.isSupportSending720P()?(t=1280,n=720):(t=640,n=360)),{captureWidth:t,captureHeight:n,isCustomizedResolution:!(null==e||!e.captureWidth||!e.captureHeight||(r=t,o=n,Math.abs(Math.floor(r/o*10)-Math.floor(16/9*10))<=1))}}function zC(e,t){return"default"===e||t.some((t=>t.deviceId===e))||[Za.Environment,Za.User,Za.Left,Za.Right].includes(e)}function JC(e,t){if("function"==typeof DOMMatrixReadOnly){const n=new DOMMatrixReadOnly(getComputedStyle(e).transform).scale(-1,1).toString();e.style.transform=n,e.dataset.mirrored=t?"1":"0"}}function QC(e,t,n){const i=[],{video:{videoSsrc:r,activeCamera:o}}=t,{cameraId:s=o,videoElement:a,originalRatio:u,ptz:l,hd:c,fullHd:d,mediaFile:h,fps:p,mirrored:f}=n||{};let g;if(void 0!==a){let e=a instanceof HTMLVideoElement?a:null;if("string"==typeof a){let[t,n]=[document.body,a];if(a.indexOf(">")>-1){const[e,i]=a.split(">");t=document.querySelector(e),n=i}t&&(e=t.querySelector(n))}if(!e)return[];g=e,e.id||(e.id=fr("__ZOOM_SDK_SELF_VIDEO_@__")),f&&"1"!==e.dataset.mirrored&&JC(e,f)}let m=null!=p?p:_u.Default;m=Math.max(_u.Min,m),m=Math.min(_u.Max,m);const{captureWidth:v,captureHeight:y,isCustomizedResolution:S}=GC(n);if(S)e.updateVideoHDValue(!1);else{e.updateVideoHDValue(!!c||!!d);const t=!!d&&Ls.isSupportFullHDVideo();e.updateVideoFullhdValue(t)}let b=Promise.resolve(s);if(h&&h.url){const e=Gv.getInstance();b=e.setVideoElement(h).then((()=>e.videoElement))}else Gv.getInstance().stopVideoElement();return b.then((t=>{e.startCaptureVideo(r,t,v,y,g,Uo.isAndroidOrIOSBrowser&&Xa.includes(t),!u&&function(){var e,t;const{isAndroidOrIOSBrowser:n,isFirefox:i,isSafari:r}=Uo;return n||!(null!==(e=navigator.mediaDevices)&&void 0!==e&&null!==(t=e.getSupportedConstraints)&&void 0!==t&&t.call(e).aspectRatio)||i||r||Wo()}(),l,m)})),i.push(Nf({cameraId:s,captureWidth:v,captureHeight:y,videoElement:"string"==typeof a?a:a instanceof HTMLVideoElement?br(a):void 0,originalRatio:u,ptz:l,hd:c,fullHd:d,mediaFile:h,fps:m,mirrored:f})),i}function YC(e,t,n){const{max:i,min:r,step:o}=e;let s=n/100*(i-r);o&&(s=Math.min(Math.floor(s/o)*o,Math.floor(s)));let a=t+s;return a=Math.min(i,a),a=Math.max(r,a),a}function ZC(e,t){let n="",i=t;switch(e){case hu.Down:i=-t,n="tilt";break;case hu.Up:n="tilt";break;case hu.Left:i=-t,n="pan";break;case hu.Right:n="pan";break;case hu.ZoomIn:n="zoom";break;case hu.ZoomOut:i=-t,n="zoom"}return{key:n,range:i}}function XC(e){const t=["pan","tilt","zoom"].reduce(((t,n)=>e[n]&&0!==e[n].value?{...t,[n]:e[n].value}:t),{});return function(e){if(null==e)return!0;if(TI(e)&&(tI(e)||"string"==typeof e||"function"==typeof e.splice||VI(e)||WI(e)||NI(e)))return!e.length;var t=TC(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(OI(e))return!QI(e).length;for(var n in e)if(KC.call(e,n))return!1;return!0}(t)?null:t}function eA(e){return{pan:(e&pu.Pan)===pu.Pan,tilt:(e&pu.Tilt)===pu.Tilt,zoom:(e&pu.Zoom)===pu.Zoom}}function tA(e){const{isAndroidBrowser:t,isIOSMobile:n,isFirefox:i,isSupportImageCapture:r,isSupportMediaStreamTrackProcessor:o,isSupportOffscreenCanvas:s}=Uo,a=t&&!i,u="function"!=typeof window.SharedArrayBuffer&&a;return n&&"function"==typeof VideoFrame||u||!Ko()&&!e&&!Nv()&&(r||o)&&s}function nA(){var e,t;return"orientation"in window.screen?null===(e=screen.orientation.type)||void 0===e?void 0:e.startsWith("landscape"):"orientation"in window?90===Math.abs(window.orientation):"matchMedia"in window?!(null===(t=window.matchMedia("(orientation: landscape)"))||void 0===t||!t.matches):screen.availWidth>screen.availHeight}function iA(e,t,n){const{meeting:{userId:i},video:{isSupportHDVideo:r,renderedVideoList:o,maximumNumbeOfHDSubscriptions:s,receivedVideoMaxQuality:a}}=n,u=e===i;let l=t;if(t>=Ka.Video_720P)if(r){const t=o.filter((e=>e.videoQuality===Ka.Video_720P)).map((e=>e.userId)),n=null!=s?s:1;t.length>=n&&(t.includes(e)||u||(console.warn(`Warning: Web Video SDK currently only supports subscribing to ${n} 720p video stream, so quality has been downgraded to 360p`),l=Ka.Video_360P))}else console.warn("Can not subscribe 720P video stream,will downgrade to 360P stream"),l=Ka.Video_360P;const c=Math.max(a,Ka.Video_360P);return[l,Math.min(l,c)]}const rA=Ps.createAgent(),oA=nb(Ls.getInstance());let sA,aA;async function uA(e,t,n){const i=fr(e),r=document.createElement("img");return r.src=t,r.id=i,r.style.display="none",gr(t)&&r.setAttribute("crossorigin",""),await new Promise(((e,i)=>{r.onload=()=>{n&&URL.revokeObjectURL(t),e("")},r.onerror=()=>{n&&URL.revokeObjectURL(t),i("Cannot load  image.")}})),{imageId:i,imgElement:r}}async function lA(e,t,n){if(e===Ya)return Ya;{let i=e;if(t){const t=await function(e){return new Promise(((t,n)=>{try{sA&&aA||(sA=document.createElement("canvas"),aA=sA.getContext("2d"));const i=sA,r=aA;if(r){r.clearRect(0,0,sA.width,sA.height);const o=new Image;o.src=e,gr(e)&&(o.crossOrigin="");const s=16/9,a=1280,u=Math.floor(a/s);i.width=a,i.height=u,o.onload=()=>{const{width:e,height:l}=o,c=l*s;if(c>e){const t=e,n=Math.floor(e/s),i=0,c=(l-n)/2;null==r||r.drawImage(o,i,c,t,n,0,0,a,u)}else{const t=c,n=l,i=(e-t)/2,s=0;r.drawImage(o,i,s,t,n,0,0,a,u)}try{i.toBlob((e=>{t(e)}))}catch(e){e instanceof DOMException&&e.code===DOMException.SECURITY_ERR&&console.error("Image is not from the same origin, add CORS header to solve this issue"),n(e)}},o.onerror=e=>{n("Cannot load  image.")}}}catch(e){n(e)}}))}(e);i=URL.createObjectURL(t)}if(i){const{imageId:e,imgElement:r}=await uA(ru,i,!!t);return(null!=n?n:document.body).appendChild(r),e}}return null}async function cA(e,t,n){var i;const r=null!==(i=n&&n.parentNode)&&void 0!==i?i:document.body,{imageUrl:o,cropped:s,rootWidth:a,rootHeight:u}=e;let l=e;!t.video.customizedVideoOption||e.captureWidth&&e.captureHeight||(l=t.video.customizedVideoOption);const{captureWidth:c,captureHeight:d}=GC(l),h=document.createElement("div");let p;h.style.display="none",p=o?await lA(o,s,h):null;let f,g=fr(iu);if(n){const t=xv(n);t.id?g=t.id:t.id=g,f=t;try{a&&n.width!==a&&(n.width=a),u&&n.height!==u&&(n.height=u)}catch(e){console.warn("Cannot set the canvas width/height, and pay attention the canvas dimension is different from the setting")}}else{const e=document.createElement("canvas");e.width=null!=a?a:380,e.height=null!=u?u:214,e.id=g,f=e,h.appendChild(e)}return null==r||r.appendChild(h),{captureWidth:c,captureHeight:d,imageId:p,canvas:f,divElement:h}}async function dA(e,t,n,i){const r=Array.isArray(e)?e:e&&[e];if((null==r?void 0:r.length)>0){sA&&aA||(sA=document.createElement("canvas"),aA=sA.getContext("2d"));const o=sA,s=aA;if(o.width=t,o.height=n,s)try{s.fillStyle="#fff",s.clearRect(0,0,t,n);for(let e=0;e<r.length;e++){const t=r[e],{type:n,x:i,y:o}=t;if("rectangle"===n){const{width:e,height:n}=t;s.fillRect(i,o,e,n)}else if("square"===n){const{length:e}=t;s.fillRect(i,o,e,e)}else if("circle"===n){const{radius:e}=t;s.beginPath(),s.arc(i,o,e,0,2*Math.PI),s.fill()}else if("svg"===n){const{svg:e,width:n,height:r}=t,a=new Image;a.src=e,gr(e)&&(a.crossOrigin=""),await new Promise(((e,t)=>{a.onload=()=>{e("")},a.onerror=()=>{t()}}));const{width:u,height:l}=a;s.drawImage(a,0,0,u,l,i,o,n,r)}}const e=await new Promise((e=>{null==o||o.toBlob((t=>{e(t)}))}));if(e){const t=URL.createObjectURL(e),{imageId:n,imgElement:r}=await uA(ou,t,!0);return(null!=i?i:document.body).appendChild(r),n}}catch(e){e instanceof DOMException&&e.code===DOMException.SECURITY_ERR&&console.error("Image is not from the same origin, add CORS header to solve this issue")}}return null}function hA(e,t){if(e===t)return!0;if(null==e&&null==t)return!0;const n=Array.isArray(e)?[...e]:[e],i=Array.isArray(t)?[...t]:[t];if(n.length!==i.length)return!1;const r=(e,t)=>e.type<t.type?-1:e.type===t.type?0:1;n.sort(r),i.sort(r);for(let e=0;e<n.length;e++)if(!dr(n[e],i[e]))return!1;return!0}function pA(e,t,n,i){const{video:{isCurrentUserStartedVideo:r,virtualBackground:{isVBPreloadReady:o,isVBConfigured:s,imageSrc:a},backgroundMode:u},meeting:{isCurrentUserStartVideoBeforeReset:l}}=n;return je(function(e){return void 0!==e?Me([e]):Ad(zu,1).pipe(Ke((e=>e)))}(o)).then((o=>o?i||!s&&e.imageUrl!==Ya&&e.imageUrl?async function(e,t,n,i){const{canvas:r,imageId:o,captureHeight:s,captureWidth:a,divElement:u}=await cA(e,n,i),{cameraId:l}=e,{video:{videoSsrc:c,activeCamera:d}}=n;return t.startVirtualBackgroundSetting(r,o,c,null!=l?l:d,a,s),u}(e,t,n,i).then((e=>r?Of(!0):je(Ad(Ju,1)).then((n=>{var r;return i||t.stopVirtualBackgroundSetting(),n?(null==e||null===(r=e.parentNode)||void 0===r||r.removeChild(e),!0):Promise.reject("Cannot access the virtual background image.")})))):a===e.imageUrl&&u===vu.VirtualBackground&&!l||async function(e,t,n){const{imageUrl:i,cropped:r}=e;if(i){const e=await lA(i,r);e&&(n.video.backgroundMode===vu.Mask&&(t.stopMaskSetting(!0),await pr((()=>{t.stopVirtualBackgroundSetting()}),0)),t.updateVirtualBackgroundImage(e),e!==Ya&&setTimeout((()=>{Ev(e)}),0))}else t.updateVirtualBackgroundImage(null)}(e,t,n):Promise.reject("Cannot load virtual background model.")))}function fA(e,t,n,i){const{video:{mask:{isMaskConfigured:r,imageSrc:o,clip:s},backgroundMode:a,isCurrentUserStartedVideo:u},meeting:{isCurrentUserStartVideoBeforeReset:l}}=n;return i||!r&&e.imageUrl?async function(e,t,n,i){const{canvas:r,imageId:o,captureHeight:s,captureWidth:a,divElement:u}=await cA(e,n,i),{cameraId:l,clip:c,rootWidth:d=1280,rootHeight:h=720}=e,p=c?await dA(c,d,h,u):null,{video:{videoSsrc:f,activeCamera:g}}=n;return p?(t.startMaskSetting(r,o,p,f,null!=l?l:g,d,h,a,s),u):Promise.reject("Clip is empty")}(e,t,n,i).then((e=>u?$f(!0):je(Ad(il,1)).then((n=>{var r;return i||t.stopMaskSetting(),n?(null==e||null===(r=e.parentNode)||void 0===r||r.removeChild(e),!0):Promise.reject("Cannot set video mask")})))):a===vu.Mask&&e.imageUrl===o&&hA(e.clip,s)&&!l?Promise.resolve(!0):async function(e,t,n){const{imageUrl:i,cropped:r,clip:o,rootWidth:s,rootHeight:a}=e,{video:{mask:{imageSrc:u,cropped:l,clip:c},backgroundMode:d}}=n;if(i){if(d===vu.VirtualBackground&&(t.stopVirtualBackgroundSetting(!0),await pr((()=>{t.stopMaskSetting()}),0)),i!==u||r!==l){const e=await lA(i,r);e&&(t.updateMaskBackgroundImage(e),setTimeout((()=>{Ev(e)}),0))}if((!hA(o,c)||!u)&&o&&s&&a){const e=await dA(o,s,a);e&&(t.updateMaskClip(e,s,a),setTimeout((()=>{Ev(e)}),0))}}else t.updateMaskBackgroundImage(null),t.updateMaskClip(null,s,a)}(e,t,n)}const gA=Ps.createAgent(),mA=nb(Ls.getInstance()),vA=Ps.createAgent(),yA=nb(Ls.getInstance()),SA={videoSsrc:0,cameraDevicesList:[],activeCamera:Uo.isAndroidOrIOSBrowser?Za.User:"default",activeVideoId:0,isCurrentUserStartedVideo:!1,spotlightUserList:[],isCaptureForbidden:!1,isMirrored:!1,receivedVideoMaxQuality:navigator.hardwareConcurrency>=8?Ka.Video_1080P:Ka.Video_360P,subscribedVideoList:[],renderedVideoList:[],ensuredCanvas:[],isVideoMuted:!1,isCaptureCameraLoading:!1,isCameraTaken:!1,isUsingMediaPlayback:!1,receivedVideoDimension:{width:0,height:0},capturedVideoDimension:{width:0,height:0},isFollowHostVideoLayout:!1,hostDragLayout:[],isSupportHDVideo:!1,isFullHDVideoEnabled:!1,bCanUnmuteVideo:!1,virtualBackground:{isVBConfigured:!1,isVBPreloadReady:void 0,imageSrc:void 0,cropped:void 0},mask:{imageSrc:void 0,cropped:void 0,clip:void 0},backgroundMode:vu.Null,statistic:{encode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0},decode:{sample_rate:0,rtt:0,jitter:0,avg_loss:0,max_loss:0,width:0,height:0,fps:0,bandwidth:0,bitrate:0}},hardwareAcceleration:{encode:!1,decode:!1},networkQuality:{},ptz:{},currentCameraControlStatus:{isRequested:!1,isInControl:!1,isCameraMoving:!1},farEndCameraControlStatus:{controlledUserList:[],isControlling:!1},subscriptionStatus:{encode:!1,decode:!1,detailed:!1},videoAttachments:{},rendererType:Tu.WebGL,selfPreviewVideoList:[]},bA=Rn({[`${sf}`]:hE(((e,t)=>{let{payload:n}=t;e.videoSsrc=n})),[`${uf}`]:hE(((e,t)=>{let{payload:n}=t;e.cameraDevicesList=n})),[`${lf}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.activeCamera;if(i in e.ptz){const t=e.ptz[i];["pan","tilt","zoom"].forEach((e=>{t[e]&&(t[e].value=0)}))}e.activeCamera=n})),[`${af}`]:hE(((e,t)=>{let{payload:n}=t;e.activeVideoId=n.userId})),[`${cf}`]:hE(((e,t)=>{let{payload:n}=t;e.isCurrentUserStartedVideo=n})),[`${df}`]:hE(((e,t)=>{let{payload:n}=t;e.spotlightUserList=n})),[`${hf}`]:hE(((e,t)=>{let{payload:n}=t;e.isCaptureForbidden=n})),[`${pf}`]:hE(((e,t)=>{let{payload:n}=t;e.receivedVideoMaxQuality=n})),[`${ff}`]:hE(((e,t)=>{let{payload:n}=t;e.isVideoMuted=n})),[`${gf}`]:hE(((e,t)=>{let{payload:n}=t;e.isCaptureCameraLoading=n})),[`${mf}`]:hE(((e,t)=>{let{payload:n}=t;e.isCameraTaken=n})),[`${yf}`]:hE(((e,t)=>{let{payload:n}=t;e.receivedVideoDimension=n})),[`${Sf}`]:hE(((e,t)=>{let{payload:n}=t;e.subscribedVideoList.includes(n)||e.subscribedVideoList.push(n)})),[`${bf}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.subscribedVideoList.indexOf(n);i>=0&&e.subscribedVideoList.splice(i,1)})),[`${_f}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.renderedVideoList.find((e=>e.userId===n.userId&&e.key===n.key&&e.canvasId===n.canvasId));i?(void 0!==n.videoQuality&&(i.videoQuality=n.videoQuality),void 0!==n.aspectRatio&&(i.aspectRatio=n.aspectRatio)):e.renderedVideoList.push({...n})})),[`${If}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.renderedVideoList.findIndex((e=>e.userId===n.userId&&e.key===n.key&&e.canvasId===n.canvasId));i>=0&&e.renderedVideoList.splice(i,1)})),[`${Ef}`]:hE(((e,t)=>{let{payload:n}=t;e.isFollowHostVideoLayout=n})),[`${wf}`]:hE(((e,t)=>{let{payload:n}=t;e.hostDragLayout=n})),[`${Cf}`]:hE(((e,t)=>{let{payload:n}=t;e.isSupportHDVideo=n})),[`${Af}`]:hE(((e,t)=>{let{payload:n}=t;e.maximumNumbeOfHDSubscriptions=n})),[`${Tf}`]:hE(((e,t)=>{let{payload:n}=t;e.bCanUnmuteVideo=n})),[`${Rf}`]:hE(((e,t)=>{let{payload:n}=t;e.virtualBackground.isVBPreloadReady=n})),[`${Of}`]:hE(((e,t)=>{let{payload:n}=t;e.virtualBackground.isVBConfigured=n})),[`${Pf}`]:hE(((e,t)=>{let{payload:n}=t;e.virtualBackground.imageSrc=n.imageUrl,e.virtualBackground.cropped=n.cropped,e.backgroundMode=vu.VirtualBackground})),[`${xf}`]:hE(((e,t)=>{let{payload:n}=t;const{encode:i,decode:r}=n;void 0!==i&&(e.hardwareAcceleration.encode=i),void 0!==r&&(e.hardwareAcceleration.decode=r)})),[`${Df}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:i,rate:r,...o}}=n;e.statistic.encode={bitrate:r,...o}})),[`${kf}`]:hE(((e,t)=>{let{payload:n}=t;const{data:{encoding:i,rate:r,...o}}=n;e.statistic.decode={bitrate:r,...o}})),[`${Nf}`]:hE(((e,t)=>{let{payload:n}=t;const{cameraId:i,captureWidth:r,captureHeight:o,videoElement:s,originalRatio:a,ptz:u,hd:l,fullHd:c,mediaFile:d,fps:h,mirrored:p}=n;e.activeCamera=i,e.customizedVideoOption={captureWidth:r,captureHeight:o,videoElement:s,originalRatio:a,ptz:u,hd:l,fullHd:c,fps:h},dr(e.mediaPlaybackFile,d)||(e.mediaPlaybackFile=d,e.isUsingMediaPlayback=!(null==d||!d.url)),void 0!==p&&(e.isMirrored=!!p)})),[`${Mf}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:i,level:r,bwLevel:o,type:s}=n;if(Object.prototype.hasOwnProperty.call(e.networkQuality,`${i}`))e.networkQuality[`${i}`][`${s}`]={level:r,bwLevel:o};else{const t={[s]:{level:r,bwLevel:o}};Object.assign(e.networkQuality,{[`${i}`]:t})}})),[`${Ff}`]:hE(((e,t)=>{let{payload:n}=t;const{deviceId:i,ptzRange:r}=n;if(Object.prototype.hasOwnProperty.call(e.ptz,i)){const t=e.ptz[i];t&&["pan","tilt","zoom"].forEach((e=>{const n=r[e];if(n){var i;const r=null===(i=t[e])||void 0===i?void 0:i.capability;r?Object.assign(r,{...n}):t[e]={capability:{...n},value:0}}}))}else Object.assign(e.ptz,{[i]:{pan:r.pan?{capability:{...r.pan},value:0}:null,tilt:r.tilt?{capability:{...r.tilt},value:0}:null,zoom:r.zoom?{capability:{...r.zoom},value:0}:null}})})),[`${Lf}`]:hE(((e,t)=>{let{payload:n}=t;e.currentCameraControlStatus.isRequested=n})),[`${Vf}`]:hE(((e,t)=>{let{payload:n}=t;const{isInControl:i,userId:r}=n;e.currentCameraControlStatus.isInControl=i,e.currentCameraControlStatus.controllingUserId=r})),[`${jf}`]:hE(((e,t)=>{let{payload:n}=t;e.farEndCameraControlStatus.controlledUserList.includes(n)||e.farEndCameraControlStatus.controlledUserList.push(n)})),[`${Bf}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.farEndCameraControlStatus.controlledUserList.indexOf(n);-1!==i&&e.farEndCameraControlStatus.controlledUserList.splice(i,1)})),[`${Uf}`]:hE(((e,t)=>{let{payload:n}=t;e.currentCameraControlStatus.isCameraMoving="start"===n.cmd})),[`${Hf}`]:hE(((e,t)=>{let{payload:n}=t;const{constraints:i,deviceId:r}=n,o=e.ptz[r];["pan","tilt","zoom"].forEach((e=>{void 0!==i[e]&&(o[e].value=i[e])}))})),[`${qf}`]:hE(((e,t)=>{let{payload:n}=t;e.farEndCameraControlStatus.isControlling=n})),[`${Kf}`]:hE(((e,t)=>{let{payload:n}=t;e.networkQualityBroadcastTime=n})),[`${$f}`]:hE(((e,t)=>{let{payload:n}=t;e.mask.isMaskConfigured=n})),[`${Gf}`]:hE(((e,t)=>{let{payload:n}=t;const{imageUrl:i,cropped:r,rootHeight:o,rootWidth:s,clip:a}=n;e.mask.imageSrc=i,e.mask.cropped=r,e.mask.clip=a,e.mask.rootWidth=s,e.mask.rootHeight=o,e.backgroundMode=vu.Mask})),[`${Wf}`]:hE(((e,t)=>{let{payload:n}=t;e.backgroundMode=n})),[`${zf}`]:hE(((e,t)=>{let{payload:n}=t;e.capturedVideoDimension=n})),[`${Jf}`]:hE(((e,t)=>{let{payload:n}=t;e.ensuredCanvas.includes(n)||e.ensuredCanvas.push(n)})),[`${Qf}`]:hE(((e,t)=>{let{payload:n}=t;e.mediaPlaybackFile=n,e.isUsingMediaPlayback=!(null==n||!n.url)})),[`${Yf}`]:hE(((e,t)=>{let{payload:n}=t;if(n){const{lastCopy:t,...i}=n;e.prefetchedVideo=i}else e.prefetchedVideo=n})),[`${Zf}`]:hE(((e,t)=>{let{payload:n}=t;Object.assign(e.subscriptionStatus,n)})),[`${Xf}`]:hE(((e,t)=>{let{payload:n}=t;e.isFullHDVideoEnabled=n})),[`${eg}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:i,element:r}=n,o=e.videoAttachments[`${i}`];if(o)-1===o.indexOf(r)&&o.push(r);else{const t=[];t.push(r),Object.assign(e.videoAttachments,{[`${i}`]:t})}})),[`${tg}`]:hE(((e,t)=>{let{payload:n}=t;const{userId:i,element:r}=n,o=e.videoAttachments[`${i}`];let s=r;Array.isArray(r)||(s=[r]),s.forEach((e=>{if(o){const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}))})),[`${ng}`]:hE(((e,t)=>{let{payload:n}=t;n&&(e.rendererType=Tu.WebGL2)})),[`${ig}`]:hE(((e,t)=>{let{payload:n}=t;n&&(e.rendererType=Tu.WebGPU)})),[`${rg}`]:hE(((e,t)=>{let{payload:n}=t;e.rendererType=n})),[`${og}`]:hE(((e,t)=>{let{payload:n}=t;e.isMirrored=n})),[`${sg}`]:hE(((e,t)=>{let{payload:n}=t;e.selfPreviewVideoList.includes(n)||e.selfPreviewVideoList.push(n)})),[`${ag}`]:hE(((e,t)=>{let{payload:n}=t;if(n){const t=e.selfPreviewVideoList.indexOf(n);t>=0&&e.selfPreviewVideoList.splice(t,1)}else e.selfPreviewVideoList=[]})),[`${vf}`]:(e,t)=>{let{payload:n}=t;const i={cameraDevicesList:e.cameraDevicesList};return n&&Object.assign(i,{activeCamera:e.activeCamera,customizedVideoOption:e.customizedVideoOption,virtualBackground:{imageSrc:e.virtualBackground.imageSrc,cropped:e.virtualBackground.cropped},mask:{imageSrc:e.mask.imageSrc,cropped:e.mask.cropped,rootWidth:e.mask.rootWidth,rootHeight:e.mask.rootHeight,clip:e.mask.clip},backgroundMode:e.backgroundMode,ptz:e.ptz,subscriptionStatus:e.subscriptionStatus}),{...SA,...i}}},SA),EA={cameraPtzEpics0:(e,t)=>pi(e,8004).pipe(Ye((e=>{const{payload:{body:{nCmd:n,nUserID:i,nReason:r,nButtonID:o}}}=e,s=t.value,a=bh(s),{video:{currentCameraControlStatus:{isInControl:u,controllingUserId:l},cameraDevicesList:c,activeCamera:d}}=s,h=a.find((e=>hr(e.userId,i))),p=[];if(p.push(Lf(!0)),n===du.Request){const e={userId:null==h?void 0:h.userId,displayName:null==h?void 0:h.displayName};if(u){const t=a.find((e=>e.userId===l));Object.assign(e,{currentControllingUserId:null==t?void 0:t.userId,currentControllingDisplayName:null==t?void 0:t.displayName})}_d(Xu,e)}else if(n===du.Approve)p.push(jf(null==h?void 0:h.userId)),_d(el,{isApproved:!0,userId:null==h?void 0:h.userId,displayName:null==h?void 0:h.displayName});else if(n===du.Decline)p.push(Bf(null==h?void 0:h.userId)),_d(el,{isApproved:!1,userId:null==h?void 0:h.userId,displayName:null==h?void 0:h.displayName,reason:r});else if(n===du.GiveUp)p.push(Vf({isInControl:!1,userId:0})),_d(tl,{isControlled:!1});else if(n===du.StartControl||n===du.StopControl)p.push(Uf({cmd:n===du.StartControl?"start":"stop",type:o}));else if(n===du.SwitchCamera){const e=c.findIndex((e=>e.deviceId===d)),t=e+1===c.length?0:e+1;if(t!==e){const e=c[t].deviceId;yA.changeCamera(e,Xa.includes(e))}}return Me(p)}))),cameraPtzEpics1:(e,t)=>pi(e,is).pipe(ht((e=>{var t;const{payload:{body:n}}=e;return null==n||null===(t=n.update)||void 0===t?void 0:t.some((e=>void 0!==e.nFECC||void 0!==e.nFECCExecutive))})),At((e=>{const{payload:{body:{update:n}}}=e,i=n.find((e=>void 0!==e.nFECC||void 0!==e.nFECCExecutive));if(i){const{meeting:{userId:e}}=t.value;hr(i.nFECCExecutive,e)&&_d(nl,{userId:i.id,ptz:eA(i.nFECC)})}})),St(ge)),cameraPtzEpics2:(e,t)=>pi(e,is).pipe(ht((e=>{var n;const{payload:{body:i}}=e,{video:{farEndCameraControlStatus:{controlledUserList:r}}}=t.value;return null==i||null===(n=i.remove)||void 0===n?void 0:n.some((e=>r.includes(e.id)))})),Ye((e=>{var n;const{payload:{body:i}}=e,r=[],{video:{farEndCameraControlStatus:{controlledUserList:o}}}=t.value,s=null==i||null===(n=i.remove)||void 0===n?void 0:n.find((e=>o.includes(e.id)));return s&&r.push(Bf(s.id)),Me(r)}))),cameraPtzEpics3:(e,t)=>e.pipe(Ut(`${Uf}`),_t((e=>{const{payload:{cmd:n,type:i}}=e;return"start"===n?at(0,200).pipe(Ct((()=>!!t.value.video.currentCameraControlStatus.isCameraMoving)),Ye((()=>{const{video:{ptz:e,activeCamera:n}}=t.value,r=e[n],o=XC(r)||{},{key:s,range:a}=ZC(i,2);return r[s]?(Object.assign(o,{[s]:YC(r[s].capability,r[s].value,a)}),yA.movePTZCamera(o).then((()=>Hf({deviceId:n,constraints:o})))):Promise.resolve(void 0)})),Ye((e=>"object"==typeof e&&void 0!==e.type?Fe(e):ge))):ge}))),cameraPtzEpics4:(e,t)=>e.pipe(Ut(`${lf}`),Ye((e=>{const{payload:n}=e,{video:{customizedVideoOption:i,ptz:r}}=t.value;if(null!=i&&i.ptz){const e=null==r?void 0:r[n];void 0!==e&&vA.sendCameraAblity({pan:!!e.pan,tilt:!!e.tilt,zoom:!!e.zoom})}return ge})))},wA={videoCaptureEpics0:(e,t)=>vi(e,Da.StartVideoCaptureSuccess).pipe(Ye((e=>{const{video:{cameraDevicesList:n,activeCamera:i,ptz:r,isCurrentUserStartedVideo:o,isUsingMediaPlayback:s},meeting:{userId:a}}=t.value,{payload:{data:{currentDeviceID:u,PTZRange:l}}}=e,c=[];if(n.length<1&&!s&&(_d(Mu,{reason:"Cannot detect camera devices"}),mA.stopCaptureVideo()),zC(i,n)||s){if(o||gA.muteAttendeeVideo(a,!1),_d(rl),s)c.push(lf("default"));else if(u&&l&&c.push(Ff({deviceId:u,ptzRange:l})),i!==u&&c.push(lf(u)),Object.prototype.hasOwnProperty.call(r,u)){const e=r[u];if(e){const t=XC(e);t&&mA.movePTZCamera(t)}}}else _d(Fu,{reason:"cannot find target camera"}),mA.stopCaptureVideo();return Me(c)}))),videoCaptureEpics1:(e,t)=>pi(e,is).pipe(ht((e=>{const{payload:{body:{update:n}}}=e,{meeting:{userId:i}}=t.value;return null==n?void 0:n.some((e=>e.id===i&&void 0!==e.bVideoOn))})),Ke((e=>{const{payload:{body:{update:n}}}=e,{meeting:{userId:i}}=t.value,r=n.find((e=>e.id===i));return!0===r.bVideoOn?_d(Uu):_d(Hu),cf(!!r.bVideoOn)}))),videoCaptureEpics2:e=>vi(e,[Da.UserForbiddedCaptureVideo,Da.UserCameraIsTakenByOtherPrograms,Da.VideoWebsocketBroken,Da.StopVideoCaptureFailed]).pipe(Ye((e=>{const{payload:{type:t}}=e,n=[];switch(t){case Da.UserForbiddedCaptureVideo:_d(Lu),n.push(hf(!0));break;case Da.UserCameraIsTakenByOtherPrograms:_d(Vu,{reason:"User camera is taken by other programs."}),n.push(mf(!0));break;case Da.VideoWebsocketBroken:_d(Bu,{reason:"Video websocket broken."});break;case Da.StopVideoCaptureFailed:_d(Hu,{failed:!0,reason:"Unknown."})}return Me(n)}))),videoCaptureEpics3:(e,t)=>vi(e,Da.StopVideoCaptureSuccess).pipe(Tt(t),Zv((e=>{let[,t]=e;const{meeting:{userId:n},video:{isCurrentUserStartedVideo:i}}=t;i||_d(Hu),gA.muteAttendeeVideo(n,!0)}))),videoCaptureEpics4:(e,t)=>pi(e,16133).pipe(Tt(t),ht((e=>{var t,n;let[i,r]=e;return(null==i||null===(t=i.payload)||void 0===t||null===(n=t.body)||void 0===n?void 0:n.id)===r.meeting.userId})),Zv((e=>{let[t]=e;const{id:n,bVideoMute:i}=t.payload.body;return _d(Du,{id:n,isVideoMuted:i}),!0===i&&mA.stopCaptureVideo(),!1===i&&_d(ku,{id:n,isVideoMuted:i}),ff(i)}))),videoCaptureEpics5:(e,t)=>pi(e,16131).pipe(ht((e=>void 0!==e.payload.body.ssrc)),_t((e=>{const{payload:{body:{ssrc:n}}}=e;return _d(sl,n),lt(Fe(sf(n)),Ov(t).pipe(Ye((e=>{const{meeting:{isCurrentUserStartVideoBeforeReset:n},media:{videoEncodeStatus:i}}=t.value;return!0!==(null==e?void 0:e.bVideoOn)&&!0===n?Rv("video",i,"success").pipe(ht((e=>{let[t,n]=e;return t&&n})),Ke((()=>{const e=t.value,{video:{backgroundMode:n,mask:i,virtualBackground:r,activeCamera:o,customizedVideoOption:s}}=e;let a=Promise.resolve(!0);return n===vu.VirtualBackground&&r.imageSrc?a=pA({imageUrl:r.imageSrc,cropped:r.cropped},mA,e):n===vu.Mask&&i.imageSrc&&i.clip&&(a=fA({imageUrl:i.imageSrc,cropped:i.cropped,clip:i.clip,rootHeight:i.rootHeight,rootWidth:i.rootWidth},mA,e)),a.then((()=>{QC(mA,e,{cameraId:o,...s})})),oo(void 0)}))):ge}))))}))),videoCaptureEpics6:(e,t)=>e.pipe(Ut(`${uf}`),At((e=>{const{payload:n}=e,i=t.value,{meeting:{userId:r}}=i,o=gh(i);0===n.length?o&&!o.bVideoConnect||gA.connectCamera(r,!1):null!=o&&o.bVideoConnect||gA.connectCamera(r,!0)})),St(ge)),videoCaptureEpics7:e=>vi(e,Da.InitSuccessVideo).pipe(ht((e=>!Uo.isIPad&&Uo.isAndroidOrIOSBrowser&&e.payload.data===ka.EncodeSuccess)),_t((()=>"orientation"in window.screen?rt(screen.orientation,"change").pipe(Ye((()=>(mA.setMobileRotateMode(nA()),ge)))):rt(window,"orientationchange").pipe(Ye((e=>{var t,n,i;const r=null===(t=e.target)||void 0===t||null===(n=t.screen)||void 0===n||null===(i=n.orientation)||void 0===i?void 0:i.angle,o=90===Math.abs(r);return mA.setMobileRotateMode(o),ge})))))),videoCaptureEpics8:e=>vi(e,Da.StartVideoCaptureSuccess).pipe(ht((()=>!Uo.isIPad&&Uo.isAndroidOrIOSBrowser)),At((()=>{mA.setMobileRotateMode(nA())})),St(ge)),videoCaptureEpics9:(e,t)=>vi(e,Da.VideoStreamFailed).pipe(ht((()=>!!t.value.video.isCurrentUserStartedVideo&&Uo.isIOSMobile)),At((()=>{mA.stopCaptureVideo()})),St(ge))},_A={videoRenderEpics0:e=>pi(e,16129).pipe(Ke((e=>{const{payload:{body:{id:t,bVideoOn:n}}}=e,i=$C(t);return _d(Pu,{bVideoOn:n,userId:i}),af({bVideoOn:n,userId:i})}))),videoRenderEpics1:(e,t)=>vi(e,Da.VideoDecodeMaxSize).pipe(ht((e=>{var t;return null==e||null===(t=e.payload)||void 0===t?void 0:t.data})),Ke((e=>{const{size:n}=e.payload.data,{video:{renderedVideoList:i,receivedVideoMaxQuality:r},meeting:{userId:o}}=t.value,s=i.filter((e=>e.videoQuality>=Ka.Video_720P&&e.userId!==o));return r!==n&&s.length>0&&(n>=Ka.Video_720P||r>=Ka.Video_720P)&&s.forEach((e=>{rA.subscribeVideo(e.userId,e.videoQuality,!1)})),pf(n)}))),videoRenderEpics2:e=>pi(e,16135).pipe(Ke((e=>{const{payload:{body:{bLeadershipOn:t,id:n}}}=e,i=[];return t&&i.push($C(n)),_d(qu,{spotlightList:i}),df(i)}))),videoRenderEpics3:(e,t)=>pi(e,7958).pipe(Tt(t),Ke((e=>{let[t,n]=e;const{payload:{body:i}}=t;let r=[];i&&i.group_list&&i.group_list[0]&&(r=i.group_list[0].map((e=>e.id)));const o=bh(n);return r=r.filter((e=>o.findIndex((t=>t.userId===e))>=0)),_d(qu,{spotlightList:r}),df(r)}))),videoRenderEpics4:e=>vi(e,Da.CurrentVideoResolution).pipe(Zv((e=>(_d(xu,e.payload.data),yf(e.payload.data))))),videoRenderEpics5:e=>vi(e,[Da.CurrentVideoResolution,Da.CurrentCaptureVideoWidthHeight]).pipe(ht((e=>!!e.payload.data)),Ke((e=>{const{payload:{data:t,type:n}}=e;return n===Da.CurrentVideoResolution?(_d(xu,t),yf(t)):(_d(Nu,t),zf(t))}))),videoRenderEpics6:e=>pi(e,rs).pipe(ht((e=>{const{payload:{body:t}}=e;return["bFollowHostVideo","VideoHd","bCanUnmuteVideo"].some((e=>void 0!==t[e]))})),Ke((e=>{const{payload:{body:{bFollowHostVideo:t,VideoHd:n,bCanUnmuteVideo:i}}}=e;if(void 0!==t)return _d(Ku,{bOn:t}),Ef(t);if(void 0!==i)return Tf(i);{const e=1===n;return oA.updateVideoHDValue(e),oA.enableHardwareAccelerationForVideoEncode(!1),Cf(e)}}))),videoRenderEpics7:(e,t)=>pi(e,7957).pipe(Tt(t),Ke((e=>{let[t,n]=e;const{video:{isFollowHostVideoLayout:i}}=n,{payload:{body:r}}=t,o=r&&r.drag_list&&r.drag_list.map((e=>e.id));return i&&_d($u,{layout:o}),wf(o)}))),videoRenderEpics8:(e,t)=>pi(e,is).pipe(Tt(t),ht((e=>{let[t,n]=e;const{meeting:{userId:i},video:{subscribedVideoList:r}}=n,o=t.payload.body.update,s=t.payload.body.remove;return o&&o.length>0&&o.findIndex((e=>e.id!==i&&(void 0!==e.bVideoOn||e.bHold)))>-1||s&&s.some((e=>r.includes(e.id)))})),At((e=>{let[t,n]=e;const{payload:{body:{remove:i,update:r}}}=t,{video:{subscribedVideoList:o}}=n,s=Sh(n);if(i&&i.length>0&&i.filter((e=>o.includes(e.id))).forEach((e=>{_d(Gu,{userId:e.id})})),r&&r.length>0){const e=r.filter((e=>void 0!==e.bVideoOn)).filter((e=>-1===s.findIndex((t=>t.userId===e.id)))),t=r.filter((e=>!0===e.bHold));t.length>0&&t.filter((e=>o.includes(e.id))).forEach((e=>{_d(Gu,{userId:e.id})})),e.forEach((e=>{e.bVideoOn?_d(Wu,{userId:e.id}):o.includes(e.id)&&_d(Gu,{userId:e.id})}))}})),St(ge)),videoRenderEpics9:(e,t)=>vi(e,Da.VideoQosData).pipe(Tt(t),Ke((e=>{var t;let[n,i]=e;const{video:{isCaptureForbidden:r,isCameraTaken:o},media:{videoEncodeStatus:s,videoDecodeStatus:a}}=i,u=gh(i),l=Ih(i),c=l.length>0,d=(null==u?void 0:u.bVideoOn)&&!r&&!o,h=l.some((e=>e.bVideoOn)),p="success"===s&&d&&c,f="success"===a&&c&&h;return null!==(t=n.payload.data)&&void 0!==t&&t.encoding?p?(_d(Qu,n.payload),Df(n.payload)):Df(cu):f?(_d(Qu,n.payload),kf(n.payload)):kf(cu)}))),videoRenderEpics10:(e,t)=>vi(e,[Da.CurrentDecodeVideoQuality,Da.CurrentDecodeVideoFps]).pipe(At((e=>{const{payload:{type:n,data:i}}=e,{video:{subscriptionStatus:r}}=t.value;if(r.detailed)if(n===Da.CurrentDecodeVideoQuality){const{ssrc:e,width:t,height:n,quality:r}=i;_d(Yu,{userId:e,width:t,height:n,quality:r})}else if(n===Da.CurrentDecodeVideoFps){const{ssrc:e,fps:t}=i;_d(Yu,{userId:e,fps:t})}})),St(ge)),videoRenderEpics11:(e,t)=>yi(e,t).pipe(Ye((async()=>Uo.isAndroidOrIOSBrowser?1:await Ls.isSupportVideoDecodeHardwareAcceleration()?4:1)),Ke((e=>Af(e)))),videoRenderEpics12:(e,t)=>vi(e,Da.NetworkQualityChange).pipe(ht((e=>!!e.payload.data)),Ye((e=>{var n;const{payload:{data:{bwLevel:i,isUplink:r,networkLevel:o}}}=e,s=[],{meeting:{userId:a},video:{networkQuality:u,subscribedVideoList:l,networkQualityBroadcastTime:c}}=t.value,d=r?"uplink":"downlink";s.push(Mf({userId:a,level:o,bwLevel:i,type:d}));const h=dr(null===(n=u[`${a}`])||void 0===n?void 0:n[d],{level:o,bwLevel:i});if(h||-1===o||(!r&&l.filter((e=>e!==a)).length>0||r)&&_d(Zu,{userId:a,type:d,level:o}),r){const e=performance.now();(!h||e-(null!=c?c:0)>3e4)&&(rA.broadcastUserNetworkQuality({isUplink:r,level:o,bwLevel:i}),s.push(Kf(e)))}return Me(s)}))),videoRenderEpics13:(e,t)=>mi(e,8005).pipe(ht((e=>{var t;return!(null===(t=e.payload.body)||void 0===t||!t.nUserID)})),Ye((e=>{const{payload:{body:{nLevel:n,nUserID:i}}}=e,{video:{networkQuality:r}}=t.value,o=r[`${i}`],s=[];return o&&o.uplink.level===n||(_d(Zu,{userId:i,level:n,type:"uplink"}),s.push(Mf({userId:i,level:n,type:"uplink"}))),Me(s)}))),videoRenderEpics14:(e,t)=>pi(e,is).pipe(ht((e=>{const{payload:{body:n}}=e,{video:{prefetchedVideo:i}}=t.value;return(null==i?void 0:i.userId)&&(n.update||n.remove)})),Ye((e=>{const{payload:{body:n}}=e,i=[],{video:{prefetchedVideo:r}}=t.value;let o=!1;return n.remove&&(o=-1!==n.remove.findIndex((e=>e.id===(null==r?void 0:r.userId)))),n.update&&(o=-1!==n.update.findIndex((e=>e.id===(null==r?void 0:r.userId)&&!1===e.bVideoOn))),o&&r&&(r.loaded||oA.cancelPrefetchVideoSsrc(r.userId),rA.unsubscribeVideo(r.userId),i.push(Yf(void 0))),Me(i)}))),videoRenderEpics15:(e,t)=>e.pipe(Ut(`${Yf}`),ht((e=>!!e.payload)),At((e=>{const{payload:{lastCopy:n}}=e,{video:{prefetchedVideo:i}}=t.value;!i||n&&n.userId===i.userId||(null!=n&&n.userId&&(n.loaded&&oA.cancelPrefetchVideoSsrc(n.userId),rA.unsubscribeVideo(n.userId)),rA.subscribeVideo(i.userId,Ka.Video_360P,!1),oA.prefetchVideoSsrc(i.userId))})),St(ge)),videoRenderEpics16:(e,t)=>vi(e,Da.NewActiveSpeakerFirstFrameCallback).pipe(ht((()=>!!t.value.video.prefetchedVideo)),Ye((e=>{const{payload:{data:{ssrc:n}}}=e,{video:{prefetchedVideo:i}}=t.value,r=[];return i&&(hr(i.userId,n)?(r.push(Yf({userId:i.userId,loaded:!0,lastCopy:i})),_d(ol,{userId:i.userId})):rA.unsubscribeVideo(i.userId)),Me(r)}))),videoRenderEpics17:(e,t)=>pi(e,16131).pipe(ht((e=>void 0!==e.payload.body.ssrc)),At((()=>{const{media:{videoDecodeStatus:e,videoEncodeStatus:n}}=t.value;Rv("video",n,e).subscribe((e=>{let[n,i]=e;const{video:{subscriptionStatus:r}}=t.value;n&&r.encode&&oA.subscribeToQos([Ms.VideoEncode],eu),i&&(r.decode&&oA.subscribeToQos([Ms.VideoDecode],eu),r.detailed&&oA.enableVideoObserver(!0))}))})),St(ge)),videoRenderEpics18:(e,t)=>e.pipe(Ut(`${_f}`,`${If}`),ht((()=>{const e=t.value.video.renderedVideoList.length;return[0,1].includes(e)})),At((()=>{const e=t.value.video.renderedVideoList.length;1===e?oA.enableVideoObserver(!0,!0):0===e&&oA.enableVideoObserver(!1)})),St(ge)),videoRenderEpics19:(e,t)=>vi(e,Da.CurrentDecodeVideoQuality).pipe(Ye((e=>{const{payload:{data:n}}=e,{video:{renderedVideoList:i,videoAttachments:r}}=t.value,o=[],{ssrc:s,width:a,height:u}=n,l=u?a/u:0,c=i.filter((e=>hr(e.userId,s)));if(c.some((e=>e.aspectRatio&&Math.abs(e.aspectRatio-l)>.2))){const e=c.filter((e=>e.canvasId===au));if(e.length>0){const e=r[`${s}`];e&&e.every((e=>{if(e){const{clientWidth:t,clientHeight:n}=e,i=n?t/n:0;return Math.abs(i-l)<=.2}return!0}))&&o.push(_f({userId:s,key:nu,canvasId:au,aspectRatio:l}))}e.length===c.length&&0!==o.length||_d(al,{userId:s,aspectRatio:l})}return Me(o)}))),videoRenderEpics20:(e,t)=>vi(e,Da.SyncRendererTypeResponse).pipe(Ye((e=>{const{payload:{data:{rendererType:n}}}=e,{video:{rendererType:i}}=t.value,r=[];return i!==n&&r.push(rg(n)),Me(r)})))},IA=hi(_A,wA,{vbEpics0:e=>vi(e,[Da.VbModelPreloadingOk,Da.VbModelPreloading_3S,Da.VbModelPreloading_10S,Da.VbSettingParaError]).pipe(Ye((e=>{const{payload:{type:t,data:n}}=e,i=[];return[Da.VbModelPreloadingOk,Da.VbModelPreloading_3S,Da.VbModelPreloading_10S].includes(t)?(i.push(Rf(!0)),_d(zu,!0),t===Da.VbModelPreloading_10S&&console.warn("Virtual Background is taking longer than expected to load.")):t===Da.VbSettingParaError&&(n===Qa.VBModelNotMatch?(_d(zu,!1),i.push(Rf(!1))):(_d(Ju,!1),i.push(Of(!1)))),Me(i)}))),vbEpics1:e=>vi(e,Da.StartVideoStreamInVbSettingSuccess).pipe(Ke((()=>(_d(Ju,!0),Of(!0))))),vbEpics2:e=>vi(e,Da.StartVideoStreamInMaskSettingSuccess).pipe(Ke((()=>(_d(il,!0),$f(!0))))),vbEpics3:e=>vi(e,Da.MaskSettingParaError).pipe(Ke((()=>(_d(il,!1),$f(!1)))))},EA);class CA{constructor(){this.assetsPath=void 0,this.instance=void 0,this.callbackList=void 0,this.mediaWorkersPath=void 0,this.mediaOptions=void 0,this.inProgress=void 0,this.callbackList=[]}static getInstance(){return void 0===this.agentInstance&&(this.agentInstance=new CA),this.agentInstance}init(e,t){var n,i,r,o,s;if(!this.instance&&window.JsMediaSDK_Instance){const e={ivObj:{[zo.AUDIO_ENCODE]:void 0,[zo.VIDEO_ENCODE]:void 0,[zo.SHARING_ENCODE]:void 0}};this.instance=new window.JsMediaSDK_Instance(e)}this.mediaWorkersPath=Ns(e,!1),this.onMediaSDKCallback=this.onMediaSDKCallback.bind(this),this.mediaOptions=t,null===(n=this.instance)||void 0===n||n.JsMediaSDK_PreLoad(this.mediaWorkersPath,this.onMediaSDKCallback,t);const a=$o(null===(i=this.mediaOptions)||void 0===i?void 0:i.enableMultiDecodeVideoWithoutSAB);null===(r=this.instance)||void 0===r||r.setPropsBeforeInit({callback:this.onMediaSDKCallback,audioWorkerPath:null===(o=this.mediaWorkersPath)||void 0===o?void 0:o.audioWorkletPath,isEnableListenInitEvent:!0}),null===(s=this.instance)||void 0===s||s.initVideoEncode(this.mediaWorkersPath,"",0,!1,"",0,a,!1,!1,!0,!0,!1,!0),this.inProgress=!0}onMediaSDKCallback(e,t){this.callbackList.length>0&&this.callbackList.forEach((n=>n(e,t)))}registerCallback(e){this.callbackList.push(e)}unregisterCallback(e){this.callbackList=this.callbackList.filter((t=>t!==e))}async destroy(){var e;this.callbackList=[],await(null===(e=this.instance)||void 0===e?void 0:e.destroy()),this.instance=null,this.inProgress=!1}disconnect(){var e,t;null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(17,{}),null===(t=this.instance)||void 0===t||t.JsMediaSDK_UnInit()}startVirtualBackgroundSetting(e,t,n,i,r,o){var s;let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];null===(s=this.instance)||void 0===s||s.Notify_MeidaSDK(91,{canvas:e,bgdom:t,width:r,height:o,ssid:0,VideoSelectValue:"default"===i?null:i,disableOriginalRatio:a,usingFacingMode:["user","environment"].includes(i)})}updateVirtualBackgroundImage(e){var t;null===(t=this.instance)||void 0===t||t.Notify_MeidaSDK(92,{bgdom:e})}stopVirtualBackgroundSetting(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(93,{isSwitch:t})}startMaskSetting(e,t,n,i,r,o,s,a,u){var l;null===(l=this.instance)||void 0===l||l.Notify_MeidaSDK(62,{canvas:e,maskdom:null,bgdom:null,dx:0,dy:0,dWidth:170,dHeight:170,width:1280,height:720,ssid:0,originWidth:379,originHeight:213,VideoSelectValue:"default"===r?null:r,usingFacingMode:["user","environment"].includes(r)})}stopMaskSetting(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=this.instance)||void 0===e||e.Notify_MeidaSDK(65,{isSwitch:t})}}CA.agentInstance=void 0;const AA="PREVIEW_VIDEO_ENCODE_SUCCESS",TA="PREVIEW_VIDEO_VB_MODEL_READY";async function RA(e,t,n,i){const{imageUrl:r,cropped:o,deviceId:s}=n,a=fr("__ZOOM_SDK_PREVIEW_VIRTUAL_BACKGROUND_CANVAS_@__");t.id||(t.id=a);let[u,l]=[640,360];if(Ls.isSupportSending720P()&&(u=1280,l=720),r&&Vv(i)){const n=await lA(r,o);return e.startVirtualBackgroundSetting(t,n,0,null!=s?s:"default",u,l),n&&n!==Ya&&setTimeout((()=>{Ev(n)}),0),"vb"}return e.startMaskSetting(t,null,null,0,null!=s?s:"default",0,0,0,0),"mask"}class OA{constructor(){this.previewMediaAgent=CA.getInstance(),this.isInit=void 0,this.isVideoEncoded=void 0,this.isVBModelReady=void 0,this.state=void 0,this.eventHandler=(e,t)=>{switch(e){case Da.InitSuccessVideo:t===ka.EncodeSuccess&&(this.isVideoEncoded=!0,_d(AA));break;case Da.VbModelPreloadingOk:case Da.VbModelPreloading_3S:case Da.VbModelPreloading_10S:this.isVBModelReady=!0,_d(TA,!0);break;case Da.VbSettingParaError:t===Qa.VBModelNotMatch&&(this.isVBModelReady=!1,_d(TA,!1))}}}static setMediaOption(e){OA.mediaOption=e}setup(){if(OA.mediaOption){if(Ls.getInstance().inProgress)return Promise.resolve("");if(!CA.getInstance().inProgress){this.isVideoEncoded=void 0,this.isVBModelReady=void 0,this.previewMediaAgent.unregisterCallback(this.eventHandler);const{assetsPath:e,enforceMultipleVideos:t,enforceVirtualBackground:n}=OA.mediaOption,i={...Uv(e,t,n)};this.previewMediaAgent.init(e,i),this.previewMediaAgent.registerCallback(this.eventHandler)}return Promise.resolve("")}return Promise.reject({type:yc,reason:"Cannot preview video with virtual background before `client.init` method."})}async startPreview(e,t){var n;Ls.getInstance().inProgress?RA(Ls.getInstance(),e,t,null===(n=OA.mediaOption)||void 0===n?void 0:n.enforceVirtualBackground):(void 0!==this.isVBModelReady?Me([this.isVBModelReady]):Ad(TA,1)).subscribe((n=>{n&&(this.isVideoEncoded?Me([!0]):Ad(AA,1)).subscribe((()=>{var n;RA(CA.getInstance(),e,t,null===(n=OA.mediaOption)||void 0===n?void 0:n.enforceVirtualBackground).then((n=>{this.state={mode:n,canvas:e,vb:t}}))}))}))}async stopPreview(){var e;Ls.getInstance().inProgress?Ls.getInstance().stopVirtualBackgroundSetting():"vb"===(null===(e=this.state)||void 0===e?void 0:e.mode)?CA.getInstance().stopVirtualBackgroundSetting():CA.getInstance().stopMaskSetting()}async updatePreview(e,t){const n=Ls.getInstance().inProgress?Ls.getInstance():CA.getInstance();var i;if(e)if("mask"===(null===(i=this.state)||void 0===i?void 0:i.mode)){var r;Uo.isChrome?(await this.stopPreview(),await this.startPreview(this.state.canvas,{imageUrl:e,cropped:t,deviceId:null===(r=this.state.vb)||void 0===r?void 0:r.deviceId})):console.warn('use the `start` method with the virtual background image parameter instead of using `updateVirtualBackground` to preview the video." ')}else{const i=await lA(e,t);i&&(n.updateVirtualBackgroundImage(i),i!==Ya&&setTimeout((()=>{Ev(i)}),0))}else n.updateVirtualBackgroundImage(null)}}OA.mediaOption=void 0;const{InitSuccessVideo:PA,InitSuccessAudio:DA,InitSuccessSharing:kA,InitFailedVideo:xA,InitFailedAudio:NA,InitFailedSharing:MA}=Da,FA=nb(Ls.getInstance()),LA=YS.getInstance().makeLogger(["Media Agent"]),VA=[Iv,Av,Cv].map((e=>bv(e,{hostname:!0}))),jA=[],BA={epics0:(e,t)=>e.pipe(Ut(`${jr}`),_t((()=>{const{meeting:{isMeetingReset:n}}=t.value;return e.pipe(Ut(`${Gr}`),gt(1),ey((e=>{var i;const{logger:r,media:{mediaConstraints:o,assetsPath:s},meeting:{zlkJwtToken:a,cv:u}}=t.value,{payload:{disableAqos:l,disableVqos:c}}=e,d=null!=r&&null!==(i=r.options)&&void 0!==i&&i.enable?YS.getInstance().makeLogger(["MEDIA SDK"]):void 0;return function(e){const{media:{patchedMediaSDKStatus:t}}=e;return t===Iu.Loading?je(Ad(Lc,1)):Promise.resolve()}(t.value).then((()=>{const e=[];let t=!c;const i=!l;return a&&lr(u,"1.3.0")<0&&(t=!1),e.push(ri({audioQos:i,videoQos:t})),FA.init(function(e){return e?new Proxy(e,{get:(e,t)=>"string"==typeof t&&"error"===t?function(){try{var e;ZS.report(arguments.length<=0?void 0:arguments[0],["MEDIA SDK",...null!==(e=arguments.length<=1?void 0:arguments[1])&&void 0!==e?e:[]],"error")}catch(e){}}:Reflect.get(e,t)}):e}(d)),e.push(ai(!0)),n&&void 0!==o&&void 0!==s&&e.push($n()),e}))})))}))),epics1:(e,t)=>e.pipe(Ut(`${jr}`),ht((e=>{const{payload:{mediaSDKPath:n}}=e,{media:{skipJsMedia:i,patchJsMedia:r,assetsPath:o},meeting:{isMeetingReset:s}}=t.value;return!i&&VA.some((e=>new RegExp(`^https://${e}`).test(null!=o?o:"")))&&!!r&&!!n&&!s})),_t((e=>{const{payload:{mediaSDKPath:t}}=e,n=vr(t);return Me(new Promise(((e,t)=>{const i=`${n}/${wo}`;"JsMediaSDK_Instance"in window&&(window.JsMediaSDK_Instance_backup=window.JsMediaSDK_Instance,delete window.JsMediaSDK_Instance),Sv(i,(()=>{"JsMediaSDK_Instance_backup"in window&&delete window.JsMediaSDK_Instance_backup,LA.info(`patched media sdk url:${i}`),e("")}),(()=>{"JsMediaSDK_Instance_backup"in window&&(window.JsMediaSDK_Instance=window.JsMediaSDK_Instance_backup,delete window.JsMediaSDK_Instance_backup),LA.error(`cannot load patched media sdk :${i}`),t()}))}))).pipe(Ye((()=>(_d(Lc),Me([ni(Iu.Done),ii(n)])))),ft((()=>(_d(Lc),Me([ni(Iu.Done)])))),wt(ni(Iu.Loading)))}))),epics2:(e,t)=>yi(e,t).pipe(At((()=>{const{media:{assetsPath:e,mediaConstraints:n,fileWithVersion:i,enforceMultipleVideos:r,enforceVirtualBackground:o,isEnableDecoderInWorklet:s},meeting:{isAudioBridgeEnabled:a}}=t.value;if(FA.notifySDKMeetingReady(),e&&n){const t={enableDecoderInWorklet:s,enableAudioBridge:a&&Ho()};Object.assign(t,Uv(e,r,o)),FA.setAssetsAndConstraint(e,n,i,t)}Ov(t).pipe(_t((e=>Me($v.acquire().then((()=>e)))))).subscribe((e=>{const{meeting:{svcUrl:n,meetingNumber:i,conId:r,e2eEncrypt:o,userId:s,isWebinar:a,enableWebtransport:u,webtransportPort:l},media:{enableAudioQos:c,enableVideoQos:d,alternativeNameForVideoPlayer:h,adaptedABOptionForMediaSDK:p},video:{rendererType:f}}=t.value;e&&(FA.connect({svcUrl:n,meetingNumber:i,conId:r,e2eEncrypt:o,isViewOnly:eh(e.userRole),currentUserId:s,isWebinar:a,enableAudioQos:c,enableVideoQos:d,enableWebtransport:u,webtransportPort:l,rendererType:f,adaptedABOptionForMediaSDK:p}),function(e){var t;let n="video-player";e.tagName&&(n=e.tagName,Pw.dispatch("",{tagName:e.tagName}),Gw(null===(t=e.mediaSDK)||void 0===t?void 0:t.call(e),`VPTN:${n}`));const i=`${n}-container`,r=e.sessionId||qw();Pw.get("mediaSDKInstanceMap").set(xw,e.mediaSDK),Pw.get("mediaSDKInstanceMap").set(r,e.mediaSDK),e.failover&&Pw.dispatch("failover",void 0,e.sessionId||xw),customElements.get(i)||customElements.define(i,f_),customElements.get(n)||customElements.define(n,d_)}({mediaSDK:()=>FA.instance,tagName:h,failover:"1"}))}))})),_t((()=>st((e=>FA.registerCallback(e)),(e=>FA.unregisterCallback(e)),((e,t)=>({type:e,data:t}))).pipe(Ke((e=>Wn(e))))))),epics3:e=>vi(e,[PA,DA,kA,xA,NA,MA]).pipe(Xv((e=>{const{payload:{type:t,data:n}}=e;if(t===DA||t===NA){if(n===ka.EncodeSuccess)return _d(Ic),Fe(Gn("success"));if(n===ka.DecodeSuccess)return _d(Cc),Fe(zn("success"));if(n===ka.EncodeFailed)return _d(Pc),Fe(Gn("failed"));if(n===ka.DecodeFailed)return _d(Dc),Fe(zn("failed"))}else if(t===PA||t===xA){if(n===ka.EncodeSuccess)return _d(Ac),Fe(Jn("success"));if(n===ka.DecodeSuccess)return _d(Tc),Fe(Qn("success"));if(n===ka.EncodeFailed)return _d(kc),Fe(Jn("failed"));if(n===ka.DecodeFailed)return _d(xc),Fe(Qn("failed"))}else if(t===kA||t===MA){if(n===ka.EncodeSuccess)return _d(Rc),Fe(Yn("success"));if(n===ka.DecodeSuccess)return _d(Oc),Fe(Zn("success"));if(n===ka.EncodeFailed)return _d(Nc),Fe(Yn("failed"));if(n===ka.DecodeFailed)return _d(Mc),Fe(Zn("failed"));if(t===kA&&void 0===n)return _d(Oc),Fe(Zn("success"))}}))),epics4:(e,t)=>vi(e,[PA,DA]).pipe(_t((()=>"object"==typeof navigator.mediaDevices?lt(Dv(),lt(vi(e,Da.StartVideoCaptureSuccess),rt(navigator.mediaDevices,"devicechange"),vi(e,Da.UserGrantCaptureAudio).pipe(ht((()=>!t.value.audio.isUserGrantCaptureAudio)))).pipe(Ye((()=>Dv().pipe(At((()=>{setTimeout((()=>{_d(Fc)}),50)}))))))).pipe(Tt(t),Ye((e=>{let[t,n]=e;const i=[Bh(t.microphones),Uh(t.speakers),uf(t.cameras)];if(n.audio){const{audio:{activeMicrophone:e,activeSpeaker:s,microphoneDevicesList:a,speakerDevicesList:u}}=n,l=gh(n),{microphones:c,speakers:d}=t,h=a.filter((e=>-1===c.findIndex((t=>t.deviceId===e.deviceId)))),p=u.filter((e=>-1===d.findIndex((t=>t.deviceId===e.deviceId))));if(h.length>0){if(qv(h[0],e,a)){const e=Kv(c);FA.changeMicrophone("default",null==e?void 0:e.label,!(null==l||!l.muted)),i.push(Hh("default"))}}else if("default"===e){const e=Kv(a),t=Kv(c);a.length>0&&(null==e?void 0:e.label)!==(null==t?void 0:t.label)&&FA.changeMicrophone("default",null==t?void 0:t.label,!(null==l||!l.muted))}var r,o;p.length>0?qv(p[0],s,u)&&(FA.changeSpeaker("default"),i.push(qh("default"))):"default"===s&&u.length>0&&(null===(r=Kv(u))||void 0===r?void 0:r.label)!==(null===(o=Kv(d))||void 0===o?void 0:o.label)&&FA.changeSpeaker("default")}return Me(i)}))):ge))),epics5:(e,t)=>mi(e,is).pipe(At((e=>{const{type:n,payload:{body:i}}=e,r=n===`${Vn}`;if(i.add){const e=i.add.map((e=>({userid:e.id,sn:e.zoomID&&ar(e.zoomID)})));if(!r){const{meeting:{gcmSessinKey:n}}=t.value;FA.sendUserNodeList(e,n)}FA.updateUserMediaSN({added:e,isFromMainSession:r,iVType:zo.SHARING_DECODE}),r&&FA.updateUserMediaSN({added:e,isFromMainSession:r,iVType:zo.AUDIO_DECODE})}if(i.remove&&i.remove.length>0){if(!r){const{meeting:{gcmSessinKey:e}}=t.value;FA.sendUserNodeList(i.remove.map((e=>({userid:e.id,bremove:!0}))),e)}FA.updateUserMediaSN({removed:i.remove.map((e=>e.id)),isFromMainSession:r,iVType:zo.SHARING_DECODE}),r&&FA.updateUserMediaSN({removed:i.remove.map((e=>e.id)),isFromMainSession:r,iVType:zo.AUDIO_DECODE})}})),St(ge)),epics6:e=>vi(e,Da.AesGcmIvResponse).pipe(At((e=>{const{payload:{data:{workerType:t,iv:n}}}=e,i=Do.get(ko.WebclientIVState);if(i){const e={...i,[t]:n};Do.set(ko.WebclientIVState,e,Oo.SessionStorage)}})),St(ge)),epics7:e=>e.pipe(Ut(`${xn}`),ht((e=>[os,ss,ns].includes(e.payload.evt))),Ke((e=>{const{payload:{evt:t,body:{encryptKey:n,additionalType:i}}}=e;return ei({type:t===os?"audio":t===ss?"video":"sharing",encryptKey:n,additionalType:i})}))),epics8:e=>e.pipe(Ut(`${Xn}`),At((e=>{const{payload:t}=e;OA.setMediaOption({assetsPath:t.assetsPath,enforceMultipleVideos:t.enforceMultipleVideos,enforceVirtualBackground:t.enforceVirtualBackground})})),St(ge)),epics9:e=>e.pipe(Ut(`${kr}`,`${Dr}`),At((()=>{CA.getInstance().inProgress&&(CA.getInstance().disconnect(),$v.watch(CA.getInstance().destroy()))})),St(ge)),epics10:e=>e.pipe(Ut(`${kr}`,`${Dr}`),_t((()=>"permissions"in navigator?["microphone","camera"].map((e=>{navigator.permissions.query({name:e}).then((t=>{const n=()=>{_d(Bc,{name:e,state:t.state})};n(),t.addEventListener("change",n),jA.push((()=>{t.removeEventListener("change",n)}))})).catch((()=>{}))})):ge)),St(ge)),epics11:e=>e.pipe(Ut(`${io}`),ht((e=>e.payload===Co.Closed)),At((()=>{jA.length>0&&(jA.forEach((e=>e())),jA.length=0)})),St(ge))},UA=hi(BA),HA={meeting:zE,socket:vw,participants:Cw,media:Ow},qA=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Lt;function KA(e){return function(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++){var r=t[i];"function"==typeof e[r]&&(n[r]=e[r])}var o,s=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:Mt.INIT}))throw new Error(kt(12));if(void 0===n(void 0,{type:Mt.PROBE_UNKNOWN_ACTION()}))throw new Error(kt(13))}))}(n)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var i=!1,r={},a=0;a<s.length;a++){var u=s[a],l=n[u],c=e[u],d=l(c,t);if(void 0===d)throw t&&t.type,new Error(kt(14));r[u]=d,i=i||d!==c}return(i=i||s.length!==Object.keys(e).length)?r:e}}({...HA,...e})}function $A(e,t,n,i,r){var o={};return Object.keys(i).forEach((function(e){o[e]=i[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,i){return i(e,t,n)||n}),o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}const WA=Symbol("store"),GA=Symbol("getState"),zA=Symbol("dispatch"),JA=Symbol("additionFeatures"),QA=Symbol("mediaContext");function YA(e,t,n){const i=n.value;n.value=function(){const e=this[WA];if(e){const{meeting:{isOnHold:t,isMeetingReset:n,meetingStatus:i}}=e.getState();if(i!==Co.Joined)return Promise.reject({type:wc,reason:"closed"});if(n)return Promise.reject({type:wc,reason:"reconnecting"});if(t)return Promise.reject({type:wc,reason:"on hold"})}for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.apply(this,n)}}function ZA(e,t,n){const i=n.value;n.value=function(){const e=this[WA];if(e){const t=e.getState();if(!mh(t))return Promise.reject({type:Ec,reason:"only host or co-host can do the operation"})}for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.apply(this,n)}}function XA(e,t,n){const i=n.value;n.value=function(){const e=this[WA];if(e){const t=e.getState();if(!vh(t))return Promise.reject({type:Ec,reason:"only host can do the operation"})}for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.apply(this,n)}}function eT(e){return function(t,n,i){const r=i.value;i.value=function(){const t=this[WA];if(t&&void 0===t.getState()[e])return Promise.reject({type:yc,reason:`Module:${e} is not enabled`});for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r.apply(this,i)}}}function tT(e){return function(t,n,i){const r=i.value;i.value=function(){const t=this[WA];if(t){const{meeting:{meetingOptions:n}}=t.getState();if(!0===n[e])return Promise.reject({type:"OPERATION_LOCKED",reason:`${e} is locked`})}for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r.apply(this,i)}}}let nT=function(e){return e.Self="Self",e.Other="Other",e.Client="Client",e.Phone="Phone",e.Attendee="Attendee",e}({});function iT(e){return function(t,n,i){const r=i.value;i.value=function(t){const n=this[WA];if(n){const i=n.getState(),r=Array.isArray(e)?e:[e];let o=bh(i).find((e=>e.userId===t));if(r.findIndex((e=>e===nT.Attendee))>-1&&(o=yh(i).find((e=>e.userId===t))),!o)return Promise.reject({type:_c,reason:"no matching user"});{const{meeting:{userId:e}}=n.getState();for(let n=0;n<r.length;n++){const i=r[n];if(i===nT.Other&&t===e)return Promise.reject({type:yc,reason:"operation is not applicable to self"});if(i===nT.Self&&t!==e)return Promise.reject({type:yc,reason:"operation is only applicable to self "});if(i===nT.Client&&Zd(o.userType)||i===nT.Phone&&!Zd(o.userType))return Promise.reject({types:yc,reason:"improper target client"})}}}for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];const a=[t,...o];return r.apply(this,a)}}}const rT=YS.getInstance();function oT(e,t){return function(n,i,r){const o=r.value;r.value=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];if(rT.checkLaplace())try{var a;const n=rT.makeLogger([e]),s=null===(a=t?r.map(((e,n)=>t.includes(n+1)?GS(e):e)):r)||void 0===a?void 0:a.map((e=>Er(e)));return n.info(`${i},params:${JSON.stringify(s)}`),o.apply(this,r).then((e=>(n.info(`${i} success`),e))).catch((t=>{let n=`${i},params:${JSON.stringify(s)},return failed,`;return"object"==typeof t&&(n=`${n},${t.type?`type:${t.type},`:""}${t.reason?`reason:${t.reason}`:""}`),rT.report(n,`${e} exception flow`,"error"),Promise.reject(t)}))}catch(e){}return o.apply(this,r)}}}function sT(e,t,n){return function(i,r,o){const s=o.value;o.value=function(){for(var i,r,o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];const l=a[t];let c=e;return Array.isArray(c)||(c=[c]),!c.some((e=>l instanceof e))||n&&!n.every((e=>!!l[e]))?Promise.reject({type:_c,reason:`Expected to accept ${null===(i=c)||void 0===i?void 0:i.map((e=>e.name)).join(" or ")}, but actual it is ${"object"==typeof l&&null!==l?null===(r=Object.getPrototypeOf(l))||void 0===r?void 0:r.constructor.name:l}`}):s.apply(this,a)}}}class aT{constructor(e){this[WA]=void 0,this[zA]=void 0,this[GA]=void 0,this[JA]=void 0,this[WA]=e,this[zA]=e.dispatch,this[GA]=e.getState}}const uT=["userId","displayName","audio","isHost","avatar","bRaiseHand","bHold","bVideoOn","sharerOn","sharerPause","feedback","bLocalRecord","strPronoun","sdkKey","audioConnectionStatus","caps","bAllowISORecord","bVideoConnect","userIdentity","isSpeakerOnly","bVideoShare","bShareAudioOn","bShareToBORooms","bid",{from:"bInFailover",to:"isInFailover"},{from:"userGUID",to:"userGuid"},{from:"bGuest",to:"isGuest"},{from:"sharerPause",to:"sharePause"},{from:"bCoHost",to:e=>({isCoHost:!!e})},{from:"muted",to:(e,t)=>({muted:null!=t&&t.isSpeakerOnly||""===(null==t?void 0:t.audio)?void 0:e})},{from:"userType",to:(e,t)=>{const n=Zd(e),i={isPhoneUser:n};return n&&null!=t&&t.phoneNumber&&Object.assign(i,{phoneNumber:t.phoneNumber}),i}}];function lT(e){return uT.reduce(((t,n)=>{const i="string"==typeof n?n:n.from,r=function(e,t,n){if("string"==typeof e)return{[`${e}`]:t};if("object"==typeof e&&void 0!==e.from){const{to:i}=e;return"string"==typeof i?{[`${i}`]:t}:i(t,n)}}(n,e[i],e);return{...t,...r}}),{})}function cT(){const{isSupportAudioWorklet:e,isSupportEssentialAudioAndVideoAbility:t,isAndroidOrIOSBrowser:n,isSupportSendScreenSharing:i}=Uo;return{audio:t&&e||n,video:t&&void 0!==navigator.mediaDevices&&void 0!==navigator.mediaCapabilities,screen:t&&i}}const dT=e=>{let{breakoutRoom:{mainSessionAttendeeList:t}}=e;return t},hT=e=>{let{meeting:{zoomId:t}}=e;return t},pT=e=>{let{breakoutRoom:{isHugeBO:t}}=e;return t},fT=Kd([e=>{let{breakoutRoom:{controlStatus:t}}=e;return t},e=>{let{breakoutRoom:{currentRoom:{status:t}}}=e;return t},e=>{let{breakoutRoom:{currentRoom:{boId:t}}}=e;return t}],((e,t,n)=>!(e!==nh.InProgress&&e!==nh.Closing||t!==rh.InRoom&&t!==rh.TimeUp||!n))),gT=Kd([e=>{let{breakoutRoom:{rooms:t}}=e;return t},$d,hT,dT,fT,pT],((e,t,n,i,r,o)=>{const s=e.reduce(((e,t)=>{const{attendeeGuidList:n}=t;return e.concat(n)}),[]);return(r?i:t).filter((e=>!e.bHold&&!e.isHost&&e.zoomID!==n&&!e.bid&&!s.includes(e.userGUID)&&(!o||ay(e.caps))))})),mT=Kd([fT,dT,$d,hT,pT],((e,t,n,i,r)=>(e?t:n).filter((e=>!e.bHold&&!e.isHost&&e.zoomID!==i&&!e.bid&&(!r||ay(e.caps)))))),vT=Kd([fT,dT,bh],((e,t,n)=>e?t.find((e=>e.isHost)):n.find((e=>e.isHost))));var yT,ST,bT,ET;const wT=Ps.createAgent();let _T=(yT=iT(nT.Other),ST=iT(nT.Other),bT=iT(nT.Other),ET=class extends aT{constructor(e){super(e),this.modules=void 0,this.useSDK=void 0,this.useSDK=!1,this.modules=new Map}initWithSDK(e,t,n){return this.useSDK=!0,this.init(e,t,n)}init(e,t,n){const{audio:i,video:r}=cT();if(!i||!r)return console.error("https://developers.zoom.us/docs/video-sdk/web/browser-support"),Promise.reject({type:yc,reason:"Please update to the latest Chrome, Edge, Safari, or Firefox, as your current browser doesn't support audio/video. Retry after the upgrade."});const{[zA]:o,[WA]:s}=this;let a=Cv;const u=(null==n?void 0:n.fileWithVersion)||!1;let l="en-US",c=`${Cv}/${wo}`;if(n){const{dependentAssets:e,additionalFeatures:t,constraints:i,language:r,webEndpoint:o}=n;r&&(l=r),o&&function(e){wv=bv(e,{hostname:!0})}(o),e===_o.CDN||e===Iv?(a=Iv,c=`${Iv}/${wo}`):e===_o.Global||e===Cv?(a=Cv,c=`${Cv}/${wo}`):e===_o.CN||e===Av?(a=Av,c=`${Av}/${wo}`):e&&/^https?:\/\//.test(e)&&(a=vr(e),c=u?`${a}/1506_js_media.min.js`:`${a}/${wo}`),t&&Array.isArray(t)&&t.forEach((e=>{if(this[JA][e]&&void 0===s.getState()[e]){const{epic:t,reducer:n,Client:i}=this[JA][e];s.injectReducer(e,n),s.injectEpic(t);const r=new i(s);this.modules.set(e,r)}})),null!=i&&i.audio&&void 0===s.getState().audio&&(s.injectReducer("audio",L_),s.injectEpic(B_)),null!=i&&i.video&&void 0===s.getState().video&&(s.injectReducer("video",bA),s.injectEpic(IA)),null!=i&&i.screen&&void 0===s.getState().share&&(s.injectReducer("share",fE),s.injectEpic(vE))}return o(Hr({apiKey:e,signature:t,language:l,useSDK:this.useSDK})),o(Xn({mediaConstraints:n&&n.constraints||{},assetsPath:a,fileWithVersion:u,enforceMultipleVideos:null==n?void 0:n.enforceMultipleVideos,enforceVirtualBackground:null==n?void 0:n.enforceVirtualBackground,skipJsMedia:null==n?void 0:n.skipJsMedia,patchJsMedia:null==n?void 0:n.patchJsMedia,alternativeNameForVideoPlayer:null==n?void 0:n.alternativeNameForVideoPlayer})),void 0!==(null==n?void 0:n.stayAwake)&&o(fo(n.stayAwake)),void 0!==(null==n?void 0:n.quicklyLeaveMeeting)&&o(yo(n.quicklyLeaveMeeting)),new Promise(((e,t)=>{null!=n&&n.skipJsMedia?e(""):Sv(c,(()=>{e("")}),(()=>{t({type:_c,reason:"dependent assets are not accessible"})}))}))}on(e,t){((e,t)=>{const n=Sd[e];if(n){const i=Ed.get(e);if(i)i.push(t),Ed.set(e,i);else{const i=[t];Ed.set(e,i);const r=lt(...n.map((e=>{const{event:t,payload:n}=e;return rt(bd,t).pipe(Ke((e=>n(e))),ke(ce))}))).subscribe((t=>{const n=Ed.get(e);n&&n.forEach((e=>{e(t)}))}));wd.push(r)}}})(e,t)}off(e,t){((e,t)=>{if(Sd[e]){const n=Ed.get(e);if(Array.isArray(n)){const i=n.filter((e=>e!==t));Ed.set(e,i)}}})(e,t)}getFeatureModule(e){return this.modules.get(e)}leave(){const{[GA]:e,[zA]:t}=this;return"connected"===e().socket.zoomSocketStatus?t(Mr()):t(Fr()),je(at(500).pipe(mt("")))}end(){const{[GA]:e,[zA]:t}=this;return"connected"===e().socket.zoomSocketStatus?(t(Lr()),je(at(500).pipe(At((()=>{Td()})),mt("")))):Promise.resolve("")}changeName(e,t){const n=this[WA].getState(),{meeting:{bAllowAttendeeRename:i}}=n,r=gh(n),o=eh(r.userRole),s=mh(n);if(o)return Promise.reject({type:Ec});if(t&&t!==(null==r?void 0:r.userId)){if(s){const{participants:{attendeesList:i}}=n,r=i.find((e=>e.userId===t));if(r)return wT.rename(t,ir(e),ir(r.displayName)),Jv({userId:t,key:"displayName"},(t=>t.displayName===e));{const i=yh(n).find((e=>e.userId===t));if(i){const t=EE.getInstance();return wT.rename(i.userId,ir(e),ir(i.displayName)),t.rename(i.jid,e),Cd(qs,(t=>{const n=t.find((e=>e.jid===i.jid));return n&&n.displayName===e}))}return Promise.reject({type:_c,reason:"no matching user"})}}return Promise.reject({type:Ec})}return e===r.displayName?Promise.resolve():s||i?(wT.rename(r.userId,ir(e),ir(r.displayName)),Cd(js,(t=>t.displayName===e))):Promise.reject({type:Ec,reason:"host disallow rename themselves"})}makeHost(e){return wT.assignHost(e,!1),Jv({userId:e,key:"isHost"},(e=>!0===e.isHost))}makeCoHost(e){const t=this[WA].getState(),n=bh(t).find((t=>t.userId===e));return!0===(null==n?void 0:n.bCoHost)?Promise.reject({type:_c,reason:`user:[${e}] is already co-host `}):(wT.assignHost(e,!0),Jv({userId:e,key:"bCoHost"},(e=>!0===e.bCoHost)))}revokeCoHost(e){const t=this[WA].getState(),n=bh(t).find((t=>t.userId===e));return!1===(null==n?void 0:n.bCoHost)?Promise.reject({type:_c,reason:`user:[${e}] is not a co-host`}):(wT.revokeCoHost(e),Jv({userId:e,key:"bCoHost"},(e=>!1===e.bCoHost)))}reclaimHost(){const e=this[GA](),{meeting:{isOriginHost:t}}=e,n=gh(e);return null!=n&&n.isHost?Promise.resolve(""):t?(wT.reclaimHost(n.userId,!1),Cd(js,(e=>!0===e.isHost))):Promise.reject({type:Ec,reason:"You are not the origin host"})}isHost(){const e=this[WA].getState(),t=gh(e);return!!t&&t.isHost}isCoHost(){const e=this[WA].getState(),t=gh(e);return!!t&&!!t.bCoHost}isOriginHost(){const{meeting:{isOriginHost:e}}=this[GA]();return e}getCurrentUserInfo(){const e=this[WA].getState(),t=gh(e);if(t){const n=lT(t);if(e.meeting.isWebinar&&eh(t.userRole)){const{audio:t}=e,i=null==t?void 0:t.isAllowToTalk;Object.assign(n,{isAllowToTalk:i})}if(e.breakoutRoom&&fT(e)){const{breakoutRoom:{currentRoom:{boId:t}}}=e;Object.assign(n,{bid:t})}return n}return null}getParticipantsList(){const e=this[WA].getState(),{meeting:{meetingStatus:t}}=e,n=gh(e);if(t===Co.Joined&&n&&!n.bHold){var i,r;const t=e.breakoutRoom&&fT(e)?null===(i=e.breakoutRoom)||void 0===i||null===(r=i.currentRoom)||void 0===r?void 0:r.boId:"";return bh(e).map((e=>{const n=lT(e);return t&&Object.assign(n,{bid:t}),n}))}return[]}getAssistantsList(){const e=this[WA].getState(),{meeting:{meetingStatus:t}}=e,n=gh(e);return t===Co.Joined&&n?Eh(e).map((e=>({userId:e.userId,displayName:e.displayName,isNewAst:!0}))):[]}getMeetingHost(){var e;const t=this[GA]();let n=wh(t);return n||(null===(e=t.breakoutRoom)||void 0===e?void 0:e.currentRoom.status)!==rh.InRoom||(n=t.breakoutRoom.mainSessionAttendeeList.find((e=>e.isHost))),void 0!==n?lT(n):null}getMeetingInfo(){const{meeting:{meetingStatus:e,isOnHold:t,meetingNumber:n,passWord:i,userName:r,userEmail:o,meetingTopic:s,meetingOptions:a,encType:u,region:l,network:c,topic:d,zlkJwtToken:h,userId:p,lang:f,inviteEmail:g,meetingId:m,participantID:v,h323Password:y,recordingDisclaimer:S,recordingDisclaimerForRecorder:b,wrInfo:E,meetingInfo:w,isNewJoinFlow:_,chatModerationPolicy:I}}=this[GA](),C=e===Co.Joined&&!t;if(h)return{topic:d,password:i,userName:r,isInMeeting:C,userId:p,meetingId:m};{let e="";return 0===u?e="None":1===u?e="AES ECB":2===u&&(e="AES GCM"),{meetingNumber:n,password:i,userName:r,userEmail:o,inviteEmail:g,meetingTopic:s,encryptionType:e,region:l,network:c,isInMeeting:C,userId:p,lang:f,webEndpoint:Tv(),meetingId:m,participantId:v,telPwd:y,recordingInfo:{recordingDisclaimer:S,recordingDisclaimerForRecorder:b,isUserEnableRecordingReminder:null==a?void 0:a.isUserEnableRecordingReminder},wrInfo:Object.assign({},E,{isNew:_}),scheduleInfo:w,chatModerationPolicy:I}}}},$A(ET.prototype,"end",[XA,YA],Object.getOwnPropertyDescriptor(ET.prototype,"end"),ET.prototype),$A(ET.prototype,"changeName",[YA],Object.getOwnPropertyDescriptor(ET.prototype,"changeName"),ET.prototype),$A(ET.prototype,"makeHost",[yT,XA,YA],Object.getOwnPropertyDescriptor(ET.prototype,"makeHost"),ET.prototype),$A(ET.prototype,"makeCoHost",[ST,XA,YA],Object.getOwnPropertyDescriptor(ET.prototype,"makeCoHost"),ET.prototype),$A(ET.prototype,"revokeCoHost",[bT,XA,YA],Object.getOwnPropertyDescriptor(ET.prototype,"revokeCoHost"),ET.prototype),$A(ET.prototype,"reclaimHost",[YA],Object.getOwnPropertyDescriptor(ET.prototype,"reclaimHost"),ET.prototype),ET);const IT=Ps.createAgent(),CT=EE.getInstance(),AT=(e,t,n)=>{const i=null==t?void 0:t.userId;if(null==e||!e.zoomID||null==t||!t.displayName||i===e.userId)return{type:_c,reason:"invalid target user"};const{chat:{chatPrivilege:r,panelistChatPrivilege:o},meeting:{isWebinar:s}}=n,a=mh(n),u=t.isHost||t.bCoHost;let l=!1;if(!a){if(s)if(eh(e.userRole))(r===ds.NoAttendee||r===ds.AllPanelist&&i!==ps.Panelist||r===ds.All&&i!==ps.All&&i!==ps.Panelist)&&(l=!0);else{const e=eh(null==t?void 0:t.userRole);(o===hs.Invalid||o===hs.AllPanelist&&(e||i===ps.All))&&(l=!0)}else(r===ds.NoAttendee||r===ds.Host&&!u||i===ps.SilentModeUsers||r===ds.EveryonePublicly&&i!==ps.All&&!u)&&(l=!0);if(l)return{type:Ec,reason:"Insufficient chat privilege"}}return null};function TT(e,t){if(t===ps.All)return bs;if(t===ps.Panelist)return Es;if(t===ps.SilentModeUsers)return ws;{const{meeting:{isWebinar:n},participants:{xmppAttendeeList:i,attendeesList:r}}=e;return n?r.find((e=>e.userId===t))||i.find((e=>e.userId===t)):r.find((e=>e.userId===t))}}function RT(e,t,n){if(null!=n&&n.host)return[wh(e),..._h(e)].filter((e=>(null==e?void 0:e.userId)!==t)).map((e=>({userId:null==e?void 0:e.userId,displayName:null==e?void 0:e.displayName,isHost:null==e?void 0:e.isHost,isCoHost:null==e?void 0:e.bCoHost})));{let i=[wh(e),..._h(e),...e.participants.attendeesList.filter((e=>!(e.bCoHost||e.isHost||e.bHold)))];if(null!=n&&n.includeAttendee){const t=yh(e).filter((e=>!Zd(e.userType)));i=[...i,...t]}return i.filter((e=>void 0!==e&&e.userId!==t)).map((e=>({userId:null==e?void 0:e.userId,displayName:null==e?void 0:e.displayName,isHost:null==e?void 0:e.isHost,isCoHost:null==e?void 0:e.bCoHost})))}}function OT(e){const{text:t,destId:n,sn:i,attendeeId:r}=e;return es.beginEncrypt({text:t,type:Qo.RWG_CHAT}).then((e=>{IT.chat(e,n,i,r)}))}function PT(e,t){const{chat:{chatHistory:n}}=t;return n.find((t=>{var n,i;return(null===(n=t.file)||void 0===n||null===(i=n.upload)||void 0===i?void 0:i.uniqueId)===e}))}function DT(e,t){const{meeting:{isWebinar:n},participants:{attendeesList:i}}=t,{destNodeID:r,senderName:o,attendeeNodeID:s}=e,a=i.find((e=>e.userId===r)),u=e.sn?e.sn:null==a?void 0:a.zoomID,l=o?rr(o):null==a?void 0:a.displayName;let c,d="";if(s===ps.SilentModeUsers)return{sender:{name:"Host",userId:r},receiver:{name:"Everyone (in Waiting Room)",userId:s},timestamp:(new Date).getTime()};if(s===ps.All)d=n?"All panelists and attendees":"Everyone";else if(s===ps.Panelist)d="All panelists";else{if(n){const e=yh(t).find((e=>e.userId===s));e&&(d=e.displayName)}if(!d){const e=i.find((e=>e.userId===s));e&&(d=e.displayName,c=e.userGUID)}}return{sn:u,sender:{name:l,userId:r,userGuid:null==a?void 0:a.userGUID,avatar:null==a?void 0:a.avatar},receiver:{name:d,userId:s,userGuid:c},timestamp:(new Date).getTime()}}function kT(e){var t;const[n]=e.split(".").reverse();return null!==(t=Ts[n])&&void 0!==t?t:""}function xT(e,t){const n=[];for(let i=e.length-1;i>=0;i--){const r=e[i];if(!r.file&&(!r.id&&r.sender.userId===t.userId&&[ps.All,ps.Panelist,ps.IndividualCcPanelist,t.destNodeID].includes(r.receiver.userId)&&n.unshift(r),r.id))break}return n.length>0?n[0]:null}const NT=YS.getInstance(),MT=NT.makeLogger(["File Transfer"]);function FT(e,t,n){const{name:i,size:r}=e,{meeting:{reportDomain:o,svcUrl:s,conId:a}}=n;return`https://${o}${t}?${new URLSearchParams({filename:i,filesize:r,rwg:s,cid:a}).toString()}`}function LT(e,t){return t.fileObj?`${e}/zoomfile/download?objkey=${t.fileObj}`:`${e}/file/${t.fileID}`}function VT(e,t){return{fileName:e.name,fileSize:e.size,receiverId:null==t?void 0:t.userId,receiverGuid:null==t?void 0:t.userGuid}}function jT(e,t,n){NT.report(`${e}. file name:${GS(t.name)},file size:${t.size}, ${"type"in t?`file type:${t.type}`:""}, error:${n.name};${n.message}`,["File Transfer"])}function BT(e){var t,n,i;return{id:e.id,fileName:null===(t=e.file)||void 0===t?void 0:t.name,fileSize:null===(n=e.file)||void 0===n?void 0:n.size,fileUrl:null===(i=e.file)||void 0===i?void 0:i.fileUrl,senderId:e.sender.userId,senderGuid:e.sender.userGuid}}function UT(e,t,n){return new Promise(((i,r)=>{const o=new FileReader;o.readAsArrayBuffer(e.slice(t,n)),o.onload=e=>{var t;return i(null===(t=e.target)||void 0===t?void 0:t.result)},o.onerror=e=>r(e)}))}async function HT(e,t){let[n,i]=[e.size,0];null!=t&&(n=Math.min(Is.ChunkSize,e.size-t),i=t);const r=e.size-i<=Is.ChunkSize,o=Math.ceil(n/Is.EncodeBlockSize);try{return function(e){const t=e.reduce(((e,t)=>e+t.byteLength),0),n=new Uint8Array(t);let i=0;for(const t of e)n.set(new Uint8Array(t),i),i+=t.byteLength;return n}(await Promise.all(Array.from({length:r?Math.max(o-1,1):o},((e,t)=>({start:t*Is.EncodeBlockSize+i,end:(r&&t===o-2?t+2:t+1)*Is.EncodeBlockSize+i}))).map((async n=>{let{start:i,end:r}=n;try{const t=await UT(e,i,r);return t?await es.beginEncrypt({text:new Uint8Array(t),type:Qo.CHAT_FILE}):Promise.reject(null)}catch(n){return jT(`encrypt file buffer error. offset:${t},`,e,n),Promise.reject(n)}}))))}catch(e){console.warn(e)}return null}function qT(e,t,n,i){return i.pipe(Ut(`${Pg}`,`${Dn}`),ht((i=>{if(i.type===`${Dn}`)return!0;const{payload:{uniqueId:r,fileName:o,userId:s}}=i;return t===r&&e.name===o&&n.userId===s})),At((i=>{MT.info(`Cancel file upload. file name:${GS(e.name)},file size:${e.size},receiver id:${n.userId}`),_d(ca,{...VT(e,n),progress:0,status:Cs.Cancel,retryToken:i.type===`${Pg}`?t:void 0})})))}function KT(e,t){if(null!=e&&e.file){const{file:n,receiver:i}=e,{upload:{chunkIndex:r,totalChunks:o,uniqueId:s}}=n;return _d(ca,{...VT(t,i),progress:Math.floor((null!=r?r:0)/(null!=o?o:1)*100),status:Cs.Fail,retryToken:s}),Me([Og({upload:{status:Cs.Fail,progress:0,uniqueId:s}}),Dg({uniqueId:s,file:t})])}return ge}function $T(e,t){return _d(ca,{...VT(e),progress:0,status:Cs.Fail}),Fe(Og({upload:{status:Cs.Fail,progress:0,uniqueId:t}}))}async function WT(e,t,n,i){const r=FT(e,"/wc/fileupload",i.value),o=new FormData;try{const s=await HT(e),a=PT(t,i.value);if(s&&a){o.append("file",new File([s],e.name));const{meeting:{zmk:u}}=i.value,{receiver:l}=a;return xE({url:r,method:"POST",headers:{"Zoom-File-Origin":"redirect=support_auth",zmk:u},crossDomain:gr(r),body:o,includeUploadProgress:!0}).pipe(It(qT(e,t,l,n)),Ye((n=>{const{type:r,loaded:o,responseHeaders:s,total:a}=n;let u=0,c=Cs.InProgress;const d={upload:{uniqueId:t}},h=[];if("upload_loadstart"===r)u=0;else if("upload_progress"===r)u=Math.floor(o/a*100*.9);else if("upload_load"===r)u=90;else if("download_load"===r){var p,f;u=100,c=Cs.Success;const{chat:{fileServerDomain:e}}=i.value,t=null===(p=s["zoom-file-id"])||void 0===p?void 0:p.trim(),n=null===(f=s["zoom-file-obj"])||void 0===f?void 0:f.trim(),r=LT(e,{fileObj:n});Object.assign(d,{fileID:t,fileObj:n,fileUrl:r})}return Object.assign(d.upload,{progress:u,status:c}),(u>0||"upload_loadstart"===r)&&(_d(ca,{...VT(e,l),progress:u,status:c}),h.push(Og(d))),Me(h)})),ft((t=>(console.warn(t),jT("Upload small file error.",e,t),KT(a,e)))))}}catch(e){console.warn(e)}return $T(e,t)}const GT=(()=>{const e=new yv;return t=>async function(){await e.acquire(),t(...arguments),setTimeout((()=>{e.release()}),3e3)}})(),zT=function(e){const t=["chatFileTransfer"];return new Proxy(e,{get:(e,n)=>"string"==typeof n&&t.includes(n)?function(){return GT(e[n].bind(e))(...arguments)}:Reflect.get(e,n)})}(Ps.createAgent()),JT={chatHistory:[],chatPrivilege:ds.All,panelistChatPrivilege:hs.AllPanelist,isAllowAttendeeChat:!0,isFileTransferEnable:!0,isEnableFileTransferEncrypted:!0,fileTransferFileType:[],fileDownloadPromptIgnoreList:[],fileTransferSizeLimit:0,fileServerDomain:"",failedFileTransfer:{}},QT=Rn({[`${wg}`]:hE(((e,t)=>{let{payload:n}=t;e.chatHistory.push(n)})),[`${bg}`]:hE(((e,t)=>{let{payload:n}=t;e.chatPrivilege=n})),[`${Eg}`]:hE(((e,t)=>{let{payload:n}=t;e.panelistChatPrivilege=n})),[`${Ig}`]:hE(((e,t)=>{let{payload:n}=t;e.isAllowAttendeeChat=n})),[`${Cg}`]:hE(((e,t)=>{let{payload:n}=t;const{destNodeID:i,msgID:r,userId:o}=n,s=xT(e.chatHistory,{userId:o,destNodeID:i});s&&Object.assign(s,{id:r})})),[`${Ag}`]:hE(((e,t)=>{let{payload:n}=t;const{msgId:i}=n,r=e.chatHistory.findIndex((e=>e.id===i));r>=0&&e.chatHistory.splice(r,1)})),[`${Tg}`]:hE(((e,t)=>{let{payload:n}=t;Object.assign(e,n)})),[`${Rg}`]:hE(((e,t)=>{let{payload:n}=t;const{originFile:i,...r}=n;e.chatHistory.push(r)})),[`${Og}`]:hE(((e,t)=>{let{payload:n}=t;const{upload:i,download:r,originFile:o,...s}=n;if(i){var a;const{uniqueId:t,...n}=i,r=e.chatHistory.find((e=>{var n;return e.file&&(null===(n=e.file.upload)||void 0===n?void 0:n.uniqueId)===t}));null!=r&&null!==(a=r.file)&&void 0!==a&&a.upload&&(Object.assign(r.file.upload,{...n}),Object.assign(r.file,{...s}),r.file.upload.status===Cs.Success&&e.failedFileTransfer[r.file.upload.uniqueId]&&delete e.failedFileTransfer[r.file.upload.uniqueId])}else if(r){const{id:t,fileUrl:n}=s,i=e.chatHistory.find((e=>{var i;return e.id===t&&(null===(i=e.file)||void 0===i?void 0:i.fileUrl)===n}));null!=i&&i.file&&(i.file.download?Object.assign(i.file.download,{...r}):Object.assign(i.file,{download:r}))}})),[`${Pg}`]:hE(((e,t)=>{let{payload:n}=t;const{uniqueId:i,fileName:r,userId:o}=n,s=e.chatHistory.find((e=>e.file&&e.file.name==r&&e.file.upload.uniqueId===i&&e.file.upload.status===Cs.InProgress&&e.receiver.userId===o));var a;null!=s&&s.file&&Object.assign(null===(a=s.file)||void 0===a?void 0:a.upload,{status:Cs.Cancel,progress:0})})),[`${Dg}`]:hE(((e,t)=>{let{payload:n}=t;const{uniqueId:i,file:r}=n;e.failedFileTransfer[`${i}`]||Object.assign(e.failedFileTransfer,{[`${i}`]:r})})),[`${kg}`]:hE(((e,t)=>{let{payload:n}=t;const{fileID:i,msgID:r,senderId:o}=n,s=e.chatHistory.find((e=>{var t;return(null===(t=e.file)||void 0===t?void 0:t.fileID)===i&&e.sender.userId===o}));s&&Object.assign(s,{id:r})})),[`${xg}`]:hE(((e,t)=>{let{payload:n}=t;const{id:i,fileUrl:r}=n,o=e.chatHistory.find((e=>{var t,n;return e.id===i&&(null===(t=e.file)||void 0===t?void 0:t.fileUrl)===r&&(null===(n=e.file)||void 0===n?void 0:n.download.status)===As.InProgress}));var s;null!=o&&o.file&&Object.assign(null===(s=o.file)||void 0===s?void 0:s.download,{status:As.Cancel,progress:0})})),[`${_g}`]:()=>({...JT})},JT);var YT;const ZT=Ps.createAgent();let XT=(YT=class extends aT{send(e,t){if(!e)return Promise.reject({type:_c,reason:"Text is empty"});const{[GA]:n,[zA]:i}=this,r=n(),o=gh(r),s=TT(r,t),a=AT(o,s,r);if(a)return Promise.reject(a);const{meeting:{isWebinar:u,encType:l}}=r,c=l===Jo.AES_GCM;let d=Promise.resolve(),h=!1;const p=u&&eh(s.userRole);return t===ps.SilentModeUsers?ZT.chat(ir(e),t):u?p?8&~s.clientCap?(d=OT({text:e,destId:ps.Panelist,sn:null==o?void 0:o.zoomID,attendeeId:t}).then((()=>function(e){const{text:t,jid:n,isGCMEnabled:i}=e;return es.beginEncrypt({text:t,type:Qo.XMPP_CHAT}).then((e=>{CT.sendWebinarMseeage(e,n,ps.IndividualCcPanelist,i)}))}({text:e,jid:s.jid,isGCMEnabled:c}))),h=!0):d=OT({text:e,destId:ps.IndividualCcPanelist,sn:null==o?void 0:o.zoomID,attendeeId:t}):s&&(d=OT({text:e,destId:s.userId,sn:null==o?void 0:o.zoomID})):d=OT({text:e,destId:s.userId,sn:null==o?void 0:o.zoomID}),d.then((()=>{const n=function(e,t,n,i){const r=(new Date).getTime(),o=performance.now();return{message:e,sender:{name:t.displayName,userId:t.userId,userGuid:t.userGUID,avatar:t.avatar},receiver:{name:null==n?void 0:n.displayName,userId:i?ps.IndividualCcPanelist:null==n?void 0:n.userId,userGuid:null==n?void 0:n.userGUID},timestamp:r,highResTimeStampForIdentification:o}}(e,o,s,p);return i(wg(n)),h?(_d(sa,n),n):new Promise(((e,i)=>{Ad(ua).pipe(He(5e3),Et((e=>n.highResTimeStampForIdentification!==e.identification||!([e.receiverId,ps.All,ps.Panelist].includes(t)||e.receiverId===ps.IndividualCcPanelist))),gt(1)).subscribe((t=>{const{msgId:i}=t,{highResTimeStampForIdentification:r,...o}=n,a={id:i,...o,...p&&{receiver:{name:null==s?void 0:s.displayName,userId:null==s?void 0:s.userId}}};_d(sa,a),e(a)}),(()=>{i({type:bc})}))}))}))}setPrivilege(e){const t=this[GA](),{meeting:{isWebinar:n},chat:{chatPrivilege:i},breakoutRoom:r}=t;return i===e?Promise.resolve(""):(null==r?void 0:r.controlStatus)===nh.InProgress&&fT(t)?Promise.reject({type:yc,reason:"Cannot update chat privilege in a subsession"}):!n&&!ms.includes(e)||n&&!vs.includes(e)?Promise.reject({type:_c,reason:"invalid privilege value of parameter"}):(ZT.setChatPriviledge(e),Cd(aa,(t=>t.chatPrivilege===e)))}setPanelistPrivilege(e){const t=this[GA](),{chat:{panelistChatPrivilege:n}}=t,i=Ss[e];return n===i?Promise.resolve(""):Object.values(ys).includes(e)?(ZT.setPanelistChatPrivilege(e),Cd(aa,(e=>e.panelistChatPrivilege===i))):Promise.reject({type:_c,reason:"Panelist privilege value is invalid"})}deleteMessage(e){const t=this[GA](),{chat:{chatHistory:n},meeting:{meetingOptions:i,userId:r}}=t;if(null!=i&&i.isEnableDeleteChatMsg){const i=mh(t),o=n.find((t=>t.id===e));if(o){const{sender:t}=o;if(i)ZT.chatCmdReq(e,fs.Delete);else{if(t.userId!==r)return Promise.reject({type:Ec,reason:"can not delete message"});ZT.chatCmdReq(e,fs.Delete)}return Cd(la,(t=>t.id===e)).then((()=>({id:e})))}return Promise.reject({type:_c,reason:"msgId is wrong"})}return Promise.reject({type:yc,reason:"can not delete messages"})}lockChat(e){const t=this[GA](),{meeting:{meetingOptions:n}}=t,i=null!=n&&n.isPrivateChatEnabled?ds.All:ds.EveryonePublicly;return this.setPrivilege(e?ds.NoOne:i)}sendFile(e,t){if(!e)return Promise.reject({type:_c,reason:"File is empty"});const{[GA]:n,[zA]:i}=this,r=n(),{chat:{isFileTransferEnable:o,fileTransferFileType:s,fileTransferSizeLimit:a,failedFileTransfer:u}}=r;if(!o)return Promise.reject({type:yc,reason:"Send files via in-session chat is not enabled"});if("string"==typeof e){const t=PT(e,r);if(null!=t&&t.file&&u[e]){const{file:{upload:n,...r}}=t,{file:{name:o,upload:{uniqueId:s}},receiver:{userId:a}}=t;return i(Og({originFile:u[e],...r,upload:{...n,status:Cs.InProgress}})),Promise.resolve((()=>{i(Pg({uniqueId:s,fileName:o,userId:a}))}))}return Promise.reject({type:_c,reason:"Retry token is not correct."})}{const{name:n}=e;if(s.length>0){const[e]=n.split(".").reverse();if(!s.some((t=>t===e)))return Promise.reject({type:yc,reason:"File is not in the allow list"})}if(e.size>a)return Promise.reject({type:yc,reason:"File size exceeds the maximum limit."});const o=gh(r),u=TT(r,t),l=AT(o,u,r);if(l)return Promise.reject(l);const c=cr();return i(Rg(function(e,t,n,i,r){const o=(new Date).getTime();return{file:{name:e.name,size:e.size,type:e.type,upload:{progress:0,uniqueId:t,totalChunks:0,chunkIndex:0}},originFile:e,sender:{name:n.displayName,userId:n.userId,userGuid:n.userGUID,avatar:n.avatar},receiver:{name:null==i?void 0:i.displayName,userId:null==i?void 0:i.userId,attendeeId:void 0,userGuid:null==i?void 0:i.userGUID},timestamp:o}}(e,c,o,u))),Promise.resolve((()=>{i(Dg({uniqueId:c,file:e})),i(Pg({uniqueId:c,fileName:n,userId:null==u?void 0:u.userId}))}))}}downloadFile(e,t,n){const{[GA]:i,[zA]:r}=this,{chat:{chatHistory:o}}=i();if(!e||!t)return Promise.reject({type:_c,reason:"Invalid message id or file url!"});const s=o.find((n=>{var i;return n.id===e&&(null===(i=n.file)||void 0===i?void 0:i.fileUrl)===t}));return s?(r(Og({id:e,fileUrl:t,download:{status:As.InProgress,progress:0,blob:n}})),Promise.resolve((()=>r(xg({id:e,fileUrl:t}))))):Promise.reject({type:_c,reason:"Invalid message id or file url!"})}getPrivilege(){const{chat:{chatPrivilege:e,isAllowAttendeeChat:t}}=this[GA]();return t?e:ds.NoAttendee}getReceivers(){const e=this[GA](),{chat:{chatPrivilege:t,panelistChatPrivilege:n,isAllowAttendeeChat:i},meeting:{isWebinar:r}}=e;if(!r&&!i)return[];const o=gh(e),s=mh(e);if(o)if(r)if(eh(o.userRole)){if(!i)return[];if(t===ds.All)return[Es,bs];if(t===ds.AllPanelist)return[Es];if(t===ds.NoOne)return[]}else{if(s||n===hs.Everyone){const t=RT(e,o.userId,{includeAttendee:!0});return[Es,bs,...t]}if(n===hs.AllPanelist){const t=RT(e,o.userId);return[Es,...t]}}else{const n=mh(e);if(t===ds.All||n){const t=RT(e,o.userId);return[bs,...t]}if(t===ds.Host)return RT(e,o.userId,{host:!0});if(t===ds.EveryonePublicly){const t=RT(e,o.userId,{host:!0});return[bs,...t]}if(t===ds.NoOne)return[]}return[]}getHistory(){return this[GA]().chat.chatHistory.map((e=>{const{highResTimeStampForIdentification:t,...n}=e;if(n.file){const{name:e,size:t,type:i,fileUrl:r,upload:o,download:s}=n.file,a={name:e,size:t,type:i,fileUrl:r};return o&&Object.assign(a,{upload:{status:o.status,progress:o.progress}}),s&&Object.assign(a,{download:{status:s.status,progress:s.progress}}),{...n,file:a}}return n}))}isAllowToDeleteMessages(){const e=this[GA](),{meeting:{meetingOptions:t}}=e;return null==t?void 0:t.isEnableDeleteChatMsg}isFileTransferEnabled(){return this[GA]().chat.isFileTransferEnable}getFileTransferSetting(){const e=this[GA](),{chat:{fileTransferFileType:t,fileTransferSizeLimit:n}}=e;return{typeLimit:(null!=t?t:[]).map((e=>`.${e}`)).join(","),sizeLimit:n}}},$A(YT.prototype,"send",[YA],Object.getOwnPropertyDescriptor(YT.prototype,"send"),YT.prototype),$A(YT.prototype,"setPrivilege",[ZA,YA],Object.getOwnPropertyDescriptor(YT.prototype,"setPrivilege"),YT.prototype),$A(YT.prototype,"setPanelistPrivilege",[ZA,YA,function(e,t,n){const i=n.value;n.value=function(){const e=this[WA];if(e){const{meeting:{isWebinar:t}}=e.getState();if(!t)return Promise.reject({type:wc,reason:"non-webinar"})}for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i.apply(this,n)}}],Object.getOwnPropertyDescriptor(YT.prototype,"setPanelistPrivilege"),YT.prototype),$A(YT.prototype,"deleteMessage",[YA],Object.getOwnPropertyDescriptor(YT.prototype,"deleteMessage"),YT.prototype),$A(YT.prototype,"lockChat",[ZA,YA],Object.getOwnPropertyDescriptor(YT.prototype,"lockChat"),YT.prototype),$A(YT.prototype,"sendFile",[YA],Object.getOwnPropertyDescriptor(YT.prototype,"sendFile"),YT.prototype),$A(YT.prototype,"downloadFile",[YA],Object.getOwnPropertyDescriptor(YT.prototype,"downloadFile"),YT.prototype),YT);const eR={epics0:(e,t)=>gi(e,24583).pipe(Tt(t),Ye((e=>{let[t,n]=e;if(n.meeting.zlkJwtToken)return ge;const{payload:{body:{sn:i,senderName:r,senderJid:o,receiver:s,text:a,type:u}}}=t,l=gh(n),c=yh(n),{meeting:{jid:d,userId:h},participants:{xmppAttendeeList:p}}=n;return es.beginDecrypt({decryptedText:a,type:Qo.XMPP_CHAT,zoomId:i}).then((e=>{var t;let{message:n}=e,i=null,a=0,f="";l&&eh(l.userRole)&&d===s?(i=p.find((e=>e.jid===o)),a=h,f=l.displayName):u===ps.Panelist&&(i=c.find((e=>e.jid===o)),a=ps.Panelist,f=Es.displayName);const g={message:n,sender:{name:r,userId:(null===(t=i)||void 0===t?void 0:t.userId)||0,avatar:""},receiver:{name:f,userId:a},timestamp:(new Date).getTime()};return _d(sa,g),wg(g)}))}))),epics1:(e,t)=>pi(e,7944).pipe(Tt(t),Ye((e=>{let[t,n]=e;const{meeting:{bIbDisableChat:i}}=n,{payload:{body:{attendeeNodeID:r,sn:o,destNodeID:s,text:a,senderName:u,msgID:l}}}=t,c=gh(n);if(c){const e=eh(null==c?void 0:c.userRole)&&r===c.userId&&!l;if(!i&&!e){const{sn:e,...t}=DT({destNodeID:s,attendeeNodeID:r,senderName:u,sn:o},n);return(r===ps.SilentModeUsers?Promise.resolve({id:l,message:rr(a),...t}):es.beginDecrypt({decryptedText:a,zoomId:e,type:Qo.RWG_CHAT}).then((e=>{let{message:n}=e;return{id:l,message:n,...t}}))).then((e=>(_d(sa,e),wg(e))))}}return ge}))),epics2:(e,t)=>pi(e,rs).pipe(ht((e=>{var t,n;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.chatPriviledge)||void 0!==(null===(n=e.payload.body)||void 0===n?void 0:n.bAllowAttendeeChat)})),Tt(t),Ke((e=>{let[t,n]=e;const{payload:{body:{chatPriviledge:i,bAllowAttendeeChat:r}}}=t,{chat:{chatPrivilege:o}}=n;return void 0!==r?(_d(aa,!0===r?{chatPrivilege:o}:{chatPrivilege:ds.NoAttendee}),Ig(r)):(_d(aa,{chatPrivilege:i}),bg(i))}))),epics3:e=>pi(e,rs).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.panelistChatPriviledge)})),Ke((e=>{const{payload:{body:{panelistChatPriviledge:t}}}=e;return _d(aa,{panelistChatPrivilege:t}),Eg(t)}))),epics4:(e,t)=>pi(e,4136).pipe(Tt(t),Ye((e=>{let[t,n]=e;const{payload:{body:{result:i,destNodeID:r,msgID:o,fileID:s}}}=t,{meeting:{userId:a},chat:{chatHistory:u}}=n,l=[];if(i===gs.Success)if(s){const e=u.find((e=>{var t;return(null===(t=e.file)||void 0===t?void 0:t.fileID)===s}));if(e){const{file:t,receiver:n,...i}=e,{name:r,size:u,type:c,fileUrl:d}=null!=t?t:{},{attendeeId:h,...p}=n;_d(sa,{id:o,file:{name:r,size:u,type:c,fileUrl:d,upload:{status:Cs.Complete,progress:100}},receiver:{...p},...i}),l.push(kg({fileID:s,msgID:o,senderId:a}))}}else{const e=xT(u,{userId:a,destNodeID:r});var c;e&&(_d(ua,{msgId:o,receiverId:r,identification:null!==(c=e.highResTimeStampForIdentification)&&void 0!==c?c:0}),l.push(Cg({destNodeID:r,msgID:o,userId:a})))}else i!==gs.Delete&&i!==gs.Block||l.push(Ag({msgId:o}));return Me(l)}))),epics5:e=>pi(e,4238).pipe(Ye((e=>{const{payload:{body:{bSuccess:t,cmd:n,msgID:i}}}=e,r=[];return t&&n===fs.Delete&&(r.push(Ag({msgId:i})),_d(la,{id:i})),Me(r)}))),epics6:e=>pi(e,7960).pipe(Ye((e=>{const{payload:{body:{cmd:t,msgID:n}}}=e,i=[];return t===fs.Delete&&(i.push(Ag({msgId:n})),_d(la,{id:n})),Me(i)})))},tR=hi(eR,{chatFileEpics0:e=>e.pipe(Ut(`${jr}`),Ke((e=>{var t,n,i;const{payload:{fileTransfer:r,fileServerDomain:o}}=e;return Tg({isFileTransferEnable:null==r?void 0:r.isEnable,isEnableFileTransferEncrypted:null==r?void 0:r.isEnableFileTransferEncrypted,fileTransferFileType:(null!==(t=null==r?void 0:r.fileType)&&void 0!==t?t:"").replace(/\./g,"").split(",").filter(Boolean),fileTransferSizeLimit:1024*(null!==(n=null==r?void 0:r.sizeLimit)&&void 0!==n?n:0)*1024||Is.MaxSize,fileDownloadPromptIgnoreList:(null!==(i=null==r?void 0:r.fileDownloadPromptIgnoreList)&&void 0!==i?i:"").replace(/\./g,"").split(","),fileServerDomain:`https://${o}`})}))),chatFileEpics1:(e,t)=>e.pipe(Ut(`${Rg}`),Ye((async n=>{const{payload:{originFile:i,file:{upload:{uniqueId:r}}}}=n;return i.size>Is.ChunkSize?await async function(e,t,n,i){const r=FT(e,"/wc/multiupload/init",i.value),o=await async function(e){const t=Math.ceil(e.size/Is.ReaderChunkSize);return(await Promise.all(Array.from({length:t},((e,t)=>({start:t*Is.ReaderChunkSize,end:(t+1)*Is.ReaderChunkSize}))).map((async t=>{let{start:n,end:i}=t;try{const t=await UT(e,n,i);return yr(await window.crypto.subtle.digest("SHA-256",t))}catch(t){return jT("calculate file hash error.",e,t),Promise.reject(t)}})))).join("")}(e),{meeting:{zmk:s,meetingId:a}}=i.value,u=PT(t,i.value);if(o&&u){const{receiver:i}=u,l={fileName:e.name,length:e.size,channelType:4,digest:o,shareJid:a};return xE({url:r,method:"POST",headers:{"Zoom-File-Origin":"redirect=support_auth",zmk:s},crossDomain:gr(r),body:l}).pipe(It(qT(e,t,i,n)),Ke((n=>{var i;const{responseHeaders:r,response:o}=n,s=null===(i=r["x-zm-trackingid"])||void 0===i?void 0:i.trim(),{uploadid:a,path:u,metadata:l}=o,c=Math.ceil(e.size/Is.ChunkSize);return Og({originFile:e,upload:{uniqueId:t,status:Cs.InProgress,progress:0,chunkIndex:0,totalChunks:c,uploadid:a,trackingId:s,path:u,metadata:l}})})),ft((t=>(console.warn(t),jT("Upload file meta error.",e,t),KT(u,e)))),wt(Og({upload:{uniqueId:t,status:Cs.Init}})))}return $T(e,t)}(i,r,e,t):await WT(i,r,e,t)})),Ye((e=>e))),chatFileEpics2:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{var t;return(null===(t=e.payload.upload)||void 0===t?void 0:t.status)===Cs.Success})),ey((async e=>{const{payload:{upload:{uniqueId:n}}}=e,{chat:{isEnableFileTransferEncrypted:i,chatHistory:r}}=t.value,o=r.find((e=>{var t,i;return(null===(t=e.file)||void 0===t||null===(i=t.upload)||void 0===i?void 0:i.uniqueId)===n})),s=[];if(o&&o.file){const{file:{name:e,size:t,fileObj:r,fileID:a,type:u},receiver:{userId:l,attendeeId:c}}=o;let[d,h]=["",""];if(i){const[n,i]=await Promise.all([e,`${t}`].map((e=>es.beginEncrypt({text:e,type:Qo.RWG_CHAT}))));[d,h]=[n,i]}else[d,h]=[e,`${t}`].map((e=>ir(e)));await zT.chatFileTransfer({fileID:a,fileSize:h,fileName:d,fileObj:r,type:u,destNodeID:l,attendeeNodeID:c}),s.push(Og({upload:{uniqueId:n,status:Cs.Complete}}))}return s}))),chatFileEpics3:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{const{payload:{upload:t,originFile:n}}=e;return!!t&&!!t.uniqueId&&t.status===Cs.InProgress&&(null==n?void 0:n.size)<=Is.ChunkSize&&0===t.totalChunks})),Ye((async n=>{const{payload:{originFile:i,upload:{uniqueId:r}}}=n;return await WT(i,r,e,t)})),Ye((e=>e))),chatFileEpics4:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{const{payload:{upload:t}}=e;return!!t&&!!t.uniqueId&&t.totalChunks>0&&t.chunkIndex!==t.totalChunks})),Ye((async n=>{const{payload:{originFile:i,upload:{uniqueId:r}}}=n;return await async function(e,t,n,i){const r=PT(t,i.value);if(null!=r&&r.file){const{file:{upload:{chunkIndex:o,totalChunks:s,uploadid:a,path:u,trackingId:l,etags:c},size:d},receiver:h}=r,p=o*Is.ChunkSize,f=await HT(e,p);if(f){const{chat:{fileServerDomain:p},meeting:{zmk:g}}=i.value,m=`${p}/upload/parts?${new URLSearchParams({uploadid:a,partNumber:o+1}).toString()}`,v=new FormData,y=new File([f],e.name);return v.append("file",y),xE({url:m,method:"POST",headers:{"Zoom-File-Size":y.size,"Zoom-File-Path":u,"x-zm-trackingid":l,"Zoom-File-Origin":"redirect=support_auth",zmk:g},crossDomain:gr(m),body:v,includeUploadProgress:!0}).pipe(It(qT(e,t,h,n)),Ye((n=>{var r;const{type:a,loaded:u,total:l,responseHeaders:p}=n;let f=0;const g={upload:{uniqueId:t,status:Cs.InProgress}},m=[],v=PT(t,i.value),y=null==v||null===(r=v.file)||void 0===r?void 0:r.upload.progress;if("upload_loadstart"===a)f=y||Math.floor(o/s*100);else if("upload_progress"===a)f=Math.floor((o*Is.ChunkSize+.9*u)/d*100);else if("upload_load"===a)f=Math.floor((o*Is.ChunkSize+.9*l)/d*100);else if("download_load"===a){f=y||Math.floor((o+1)/s*100);const t=p["x-zm-etag"].trim(),n=c?{...c,[`${o+1}`]:t}:{[`${o+1}`]:t};Object.assign(g.upload,{etags:n,chunkIndex:o+1,totalChunks:s}),Object.assign(g,{originFile:e})}return(f>0||"upload_loadstart"===a)&&(Object.assign(g.upload,{progress:f}),_d(ca,{...VT(e,h),progress:f,status:Cs.InProgress}),m.push(Og(g))),Me(m)})),ft((t=>(console.warn(t),jT(`Upload file chunk error. chunk:${o},total chunks:${s},uploadid:${a},trackingId:${l}`,e,t),KT(r,e)))))}}return $T(e,t)}(i,r,e,t)})),Ye((e=>e))),chatFileEpics5:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{const{payload:{upload:t}}=e;return!!t&&!!t.uniqueId&&t.totalChunks>0&&t.chunkIndex==t.totalChunks})),Ye((n=>{const{payload:{originFile:i,upload:{uniqueId:r}}}=n;return function(e,t,n,i){const{chat:{fileServerDomain:r},meeting:{zmk:o}}=i.value,s=PT(t,i.value);if(null!=s&&s.file){const{file:{upload:{uploadid:a,metadata:u,etags:l,trackingId:c}},receiver:d}=s,h=`${r}/upload/complete?uploadid=${a}`;return xE({url:h,method:"POST",headers:{"x-zm-trackingid":c,"Zoom-File-Origin":"redirect=support_auth",zmk:o},crossDomain:gr(h),body:{metadata:u,etags:l}}).pipe(It(qT(e,t,d,n)),Ke((n=>{var r,o;const{chat:{fileServerDomain:s}}=i.value,{responseHeaders:a}=n,u=null===(r=a["zoom-file-id"])||void 0===r?void 0:r.trim(),l=null===(o=a["zoom-file-obj"])||void 0===o?void 0:o.trim(),c=`${s}/zoomfile/download?objkey=${l}`;return _d(ca,{...VT(e,d),progress:100,status:Cs.Success}),Og({fileID:u,fileObj:l,fileUrl:c,upload:{uniqueId:t,progress:100,status:Cs.Success}})})),ft((t=>(console.warn(t),jT(`Upload chunks checksum error.uploadid${a},trackingId${c}`,e,t),KT(s,e)))))}return $T(e,t)}(i,r,e,t)}))),chatFileEpics6:(e,t)=>pi(e,4308).pipe(ey((async e=>{const{payload:{body:{attendeeNodeID:n,destNodeID:i,fileID:r,fileName:o,fileObj:s,fileSize:a,fileType:u,msgID:l,senderName:c}}}=e,{meeting:{bIbDisableChat:d},chat:{fileServerDomain:h,isEnableFileTransferEncrypted:p}}=t.value,f=[];if(!d){const e=LT(h,{fileObj:s,fileID:r});if(u===_s.Local){const{sn:u,...d}=DT({destNodeID:i,attendeeNodeID:n,senderName:c},t.value);let[h,g]=["",0];if(p){const[e,t]=await Promise.all([o,a].map((e=>es.beginDecrypt({decryptedText:e,zoomId:u,type:Qo.RWG_CHAT}))));h=e.message,g=Number(t.message)}else h=rr(o),g=Number(rr(a));const m={id:l,file:{name:h,size:g,fileUrl:e},...d};f.push(wg({...m,file:{...m.file,fileID:r,fileObj:s}})),setTimeout((()=>{_d(sa,m)}),0)}}return f}))),chatFileEpics7:(e,t)=>e.pipe(Ut(`${Og}`),ht((e=>{var t,n;const{payload:i}=e;return i.id&&i.fileUrl&&(null===(t=i.download)||void 0===t?void 0:t.status)===As.InProgress&&0===(null===(n=i.download)||void 0===n?void 0:n.progress)})),Ye((n=>function(e,t,n){var i;const{chat:{chatHistory:r},meeting:{zmk:o},participants:{attendeesList:s}}=n.value,a=r.find((t=>t.id===e));if(null!=a&&null!==(i=a.file)&&void 0!==i&&i.fileUrl){const{file:{fileUrl:n}}=a;return xE({url:n,method:"GET",headers:{"Zoom-File-Origin":"redirect=support_auth",zmk:o},crossDomain:gr(n),responseType:"arraybuffer",includeDownloadProgress:!0}).pipe(It(function(e,t){return t.pipe(Ut(`${xg}`,`${Dn}`),ht((t=>{if(t.type===`${Dn}`)return!0;const{payload:{id:n}}=t;return e.id===n})),At((()=>{var t,n,i;MT.info(`Cancel file download. file name:${GS(null===(t=e.file)||void 0===t?void 0:t.name)},file size:${null===(n=e.file)||void 0===n?void 0:n.size},sender id:${null===(i=e.sender)||void 0===i?void 0:i.userId}`),_d(da,{...BT(e),progress:0,status:As.Cancel})})))}(a,t)),ey((async t=>{const{type:n,loaded:i,total:r}=t,o=[],u={...BT(a),progress:0,status:As.InProgress};if("download_loadstart"===n&&Object.assign(u,{progress:0}),"download_progress"===n){var l;const t=Math.floor(i/r*100);o.push(Og({id:e,fileUrl:null===(l=a.file)||void 0===l?void 0:l.fileUrl,download:{progress:t}})),Object.assign(u,{progress:t})}else if("download_load"===n){var c,d,h;const n=100,i=As.Success;Object.assign(u,{progress:n,status:i}),o.push(Og({id:e,fileUrl:null===(c=a.file)||void 0===c?void 0:c.fileUrl,download:{progress:n,status:i}}));const r=null===(d=s.find((e=>e.userId===a.sender.userId)))||void 0===d?void 0:d.zoomID,l=await async function(e,t,n){const i=Math.ceil(e.byteLength/Is.DecodeBlockSize);try{const r=await Promise.all(Array.from({length:Math.max(i-1,1)},((e,t)=>({start:t*Is.DecodeBlockSize,end:(t===i-2?t+2:t+1)*Is.DecodeBlockSize}))).map((async i=>{let{start:r,end:o}=i;try{const t=e.slice(r,o),{message:i}=await es.beginDecrypt({decryptedText:t,zoomId:n,type:Qo.CHAT_FILE});return i}catch(n){return jT("decrypt file buffer error.",{name:t,size:e.byteLength},n),Promise.reject(n)}})));return new Blob(r,{type:kT(t)})}catch(e){return null}}(t.response,null===(h=a.file)||void 0===h?void 0:h.name,r);var p,f;l&&(null!==(p=a.file)&&void 0!==p&&p.download.blob?Object.assign(u,{fileBlob:l}):function(e,t){const n=document.createElement("a"),i=window.URL.createObjectURL(e);n.href=i,n.download=t,n.click(),window.URL.revokeObjectURL(i)}(l,null===(f=a.file)||void 0===f?void 0:f.name))}return(u.progress>0||"download_loadstart"===n)&&_d(da,u),o})),ft((t=>(console.warn(t),jT(`download file error. file url:${n}`,{name:void 0,size:void 0},t),_d(da,{...BT(a),progress:0,status:As.Fail}),Fe(Og({id:e,fileUrl:n,download:{status:As.Fail,progress:0}}))))))}return ge}(n.payload.id,e,t))))});function nR(e,t){const{meeting:{isMeetingReset:n,meetingId:i,meetingNumber:r,userName:o,userEmail:s,tid:a,userId:u,userGUID:l},breakoutRoom:c}=e;let d="";var h;return d=n?null!=c&&null!==(h=c.currentRoom)&&void 0!==h&&h.boConfId?"join breakout room":"meeting failover":"join meeting",{label:d,payload:{meetingId:i,tid:a,userId:u||(null==t?void 0:t.userId),userGUID:l||(null==t?void 0:t.userGUID),meetingNumber:GS(r),userName:GS(o),userEmail:GS(s)}}}function iR(e,t,n){return j(_t((i=>{let r=!1;try{var o,s;const{logger:{options:e},meeting:{logConfig:n}}=t.value;r=null!==(o=null==e?void 0:e.enable)&&void 0!==o?o:null===(s=JSON.parse(n||"{}"))||void 0===s?void 0:s.enable}catch(e){}try{if(r){const{logger:{isLaplaceInitialized:r}}=t.value;if(!r)return e.pipe(Ut(`${dv}`),gt(1),Ye((e=>(e.payload&&n(i),ge))));n(i)}}catch(e){console.warn(e)}return ge})))}function rR(e,t,n,i){return vi(e,n).pipe(iR(e,t,i))}function oR(e,t,n,i){return pi(e,n).pipe(iR(e,t,i))}function sR(e){var t,n;const{audio:{activeMicrophone:i,activeSpeaker:r,microphoneDevicesList:o,speakerDevicesList:s}}=e;return`microphone: [${i} - ${null==o||null===(t=o.find((e=>e.deviceId===i)))||void 0===t?void 0:t.label}]; speaker: [${r} - ${null==s||null===(n=s.find((e=>e.deviceId===r)))||void 0===n?void 0:n.label}]`}function aR(e){var t;const{video:{activeCamera:n,cameraDevicesList:i}}=e;return`camera: [${n} - ${null==i||null===(t=i.find((e=>e.deviceId===n)))||void 0===t?void 0:t.label}]`}function uR(e,t){return t?` ,${e}:${t}`:""}const{InitSuccessAudio:lR,InitFailedAudio:cR,InitSuccessVideo:dR,InitFailedVideo:hR,InitSuccessSharing:pR,InitFailedSharing:fR}=Da,{DecodeSuccess:gR,DecodeFailed:mR,EncodeSuccess:vR,EncodeFailed:yR}=ka,SR={[`${lR}`]:{name:"Audio",isException:!1},[`${cR}`]:{name:"Audio",isException:!0},[`${dR}`]:{name:"Video",isException:!1},[`${hR}`]:{name:"Video",isException:!0},[`${pR}`]:{name:"Sharing",isException:!1},[`${fR}`]:{name:"Sharing",isException:!0}};function bR(e){const t=(null!=e?e:"").split("-");return[...new Set(t)].map((e=>({reason:e,count:t.filter((t=>e===t)).length})))}const ER=YS.getInstance(),wR=()=>{if("connection"in navigator){const{effectiveType:e,rtt:t,downlink:n}=navigator.connection;ER.makeLogger(["Network Connection Type"]).info(`Network connection. ect:${e},rtt:${t},downlink:${n}`)}},_R=YS.getInstance().makeLogger(["Remote Control"]),IR=nb(Ls.getInstance()),CR=[{event:Da.AudioBridgeReconnectStart,message:$S.AudioBridgeReconnectStart,logType:"info",additionalTags:["Audio Join Flow"]},{event:Da.AudioBridgeReconnectEnd,message:$S.AudioBridgeReconnectEnd,logType:"info",additionalTags:["Audio Join Flow"]},{event:Da.UserGrantCaptureAudio,message:e=>`${$S.DeviceAudioStreamCaptured},${sR(e)}`,logType:"info",additionalTags:["Audio Capture Flow"]},{event:Da.JoinComputerAudioComplete,message:$S.AudioJoinComplete,logType:"info",additionalTags:["Audio Join Flow"]},{event:Da.LeaveComputerAudioComplete,message:$S.AudioLeaveComplete,logType:"info",additionalTags:["Audio Join Flow"]},{event:Da.JoinSharingAudioComplete,message:$S.SharingAudioStartComplete,logType:"info",additionalTags:["Audio Sharing Flow"]},{event:Da.LeaveSharingAudioComplete,message:$S.SharingAudioStopComplete,logType:"info",additionalTags:["Audio Sharing Flow"]}],AR=[{event:Da.StartVideoCaptureSuccess,message:e=>`${WS.StartCaptureVideoSuccess}, ${aR(e)}`,logType:"info",additionalTags:["Video Join Flow"]},{event:Da.StopVideoCaptureSuccess,message:WS.StopCaptureVideoSuccess,logType:"info",additionalTags:["Video Join Flow"]},{event:Da.StartVideoStreamInVbSettingSuccess,message:WS.VBSettingSuccess,logType:"info",additionalTags:["Video VB Flow"]},{event:Da.VbModelPreloadingOk,message:WS.VBPreloadSuccess,logType:"info",additionalTags:["Video VB Flow"]},{event:Da.VbModelPreloading_3S,message:WS.VBPreloading3S,logType:"warn",additionalTags:["Video VB Flow"]},{event:Da.VbModelPreloading_10S,message:WS.VBPreloading10S,logType:"warn",additionalTags:["Video VB Flow"]},{event:Da.VbSettingParaError,message:WS.VBSettingFailed,logType:"error",additionalTags:["Video VB Flow"]}],TR=CR.map((e=>({...e,tag:"Audio"}))).concat(AR.map((e=>({...e,tag:"Video"})))),RR=YS.getInstance(),{InitSuccessVideo:OR,InitSuccessAudio:PR,InitSuccessSharing:DR,InitFailedVideo:kR,InitFailedAudio:xR,InitFailedSharing:NR,RecoverWebrtcAudio:MR,AudioBridgeFirstRecvData:FR,AudioBridgeCanSendData:LR,UserForbiddedCaptureAudio:VR,AudioWebsocketBroken:jR,AudioZeroData:BR,UserForbiddedCaptureVideo:UR,UserCameraIsTakenByOtherPrograms:HR,VideoWebsocketBroken:qR,StopVideoCaptureFailed:KR,DesktopSharingPermissionDenied:$R,DesktopSharingSystemError:WR,AudioSpeakerSetError:GR,VbSettingParaError:zR,MaskSettingParaError:JR,WebglLostInMultiView:QR,VideoStreamFailed:YR,AudioStreamFailed:ZR,NotifyUIFailover:XR}=Da,eO=YS.getInstance(),tO={options:void 0,isLaplaceInitialized:!1},nO=Rn({[`${cv}`]:hE(((e,t)=>{let{payload:n}=t;e.options=n})),[`${dv}`]:hE(((e,t)=>{let{payload:n}=t;e.isLaplaceInitialized=n})),[`${hv}`]:(e,t)=>{let{options:n}=e,{payload:i}=t;return i?{...tO,options:n}:{...tO}}},tO),iO={mlEpics0:(e,t)=>vi(e,[OR,PR,DR,kR,xR,NR]).pipe(iR(e,t,(e=>{const{payload:{type:n,data:i}}=e,{meeting:{userId:r}}=t.value,o=function(e,t){const n=SR[`${e}`];if(n){const{name:e,isException:i}=n,r=[e,`${e} Init Flow`];i&&r.push(`${e} exception flow`);let o="";return[gR,mR].includes(t)&&(o=`${o} decode`.trim()),[vR,yR].includes(t)&&(o=`${o} encode`.trim()),[vR,gR].includes(t)&&(o=`${o} success`.trim()),[mR,yR].includes(t)&&(o=`${o} failed`.trim()),{message:`init ${e.toLowerCase()} ${o}`,tags:r,isException:i}}return null}(n,i);if(o){const{message:e,tags:t,isException:n}=o;n?RR.report(`${e}. userId:${r}`,t):RR.makeLogger(t).info(e)}}))),mlEpics1:(e,t)=>rR(e,t,TR.map((e=>e.event)),(e=>{const{payload:{type:n}}=e,i=TR.find((e=>e.event===n));if(i){const{message:e,logType:n,additionalTags:r,tag:o}=i;let s=e;"function"==typeof e&&(s=e(t.value)),s&&RR.makeLogger([o])[n](s,r)}})),mlEpics2:(e,t)=>e.pipe(Ut(`${Kh}`),ht((e=>!e.payload)),iR(e,t,(()=>{RR.makeLogger(["Audio"]).warn(`Auto play audio failed,${sR(t.value)}`)}))),mlEpics3:(e,t)=>rR(e,t,MR,(()=>{RR.report("Audio bridge, recover audio failed, need to rejoin the audio",["Audio exception flow"])})),mlEpics4:(e,t)=>rR(e,t,[FR,LR],(e=>{const{payload:{type:t}}=e;RR.makeLogger(["Audio"]).log("Audio bridge connection: "+(t===FR?"first receive data":"can send data"))})),mlEpics5:(e,t)=>rR(e,t,XR,(e=>{RR.report(`Audio bridge, notify ui failover, subreason:${e.payload.data}`,["Audio exception flow"])})),mlEpics6:(e,t)=>rR(e,t,[VR,jR,BR,GR,ZR],(e=>{const{payload:{type:n}}=e;let i=`Audio error case:${n}`;n===VR?i="Audio capture is forbidden by the user":n===BR?t.value.audio.webrtcRestartCount<3&&(i="audio capture zero data, auto failover"):n===GR?i="audio change speaker error":n===ZR&&(i="audio stream ended or muted, stop capture audio"),RR.report(`${i},${sR(t.value)}`,["Audio exception flow"])})),mlEpics7:(e,t)=>rR(e,t,[UR,HR,qR,KR,YR],(e=>{const{payload:{type:n,data:i}}=e;let r=`Video error case:${n}`;if(n===UR)r="Video capture is forbidden by the user"+(i?` (error name:${null==i?void 0:i.name};error message:${null==i?void 0:i.message})`:"");else if(n===HR)r="Camera is taken by other programs"+(i?` (error name:${null==i?void 0:i.name};error message:${null==i?void 0:i.message})`:"");else if(n===zR){var o;r=`VB setting error, param:${JSON.stringify(null!==(o=t.value.video.virtualBackground)&&void 0!==o?o:{})}`}else if(n===JR){var s;r=`Mask setting error, param:${JSON.stringify(null!==(s=t.value.video.mask)&&void 0!==s?s:{})}`}else n===YR&&(r=`Video stream ended or muted, if it is on iOS platform, will stop capture video.platform:${Uo.browser}`);RR.report(`${r},${aR(t.value)}`,["Video exception flow"])})),mlEpics8:(e,t)=>rR(e,t,[$R,WR],(e=>{const{payload:{type:t}}=e;let n="";t===WR?Uo.isMacOS&&(n="Need to allow screen recording access in system setting on MacOS"):n="Need to allow the permission request",RR.report(`${n}`,["Sharing exception flow"])})),mlEpics9:(e,t)=>rR(e,t,QR,(e=>{const{payload:{data:n}}=e,{video:{renderedVideoList:i}}=t.value;if(null!=n&&n.canvasId){const e=i.filter((e=>e.canvasId===n.canvasId));RR.report(`WebGl Context lost, canvas ID:${n.canvasId}, affected video node Ids:${e.map((e=>e.userId)).join(",")}`,["Video exception flow"])}})),mlEpics10:(e,t)=>rt(document,"visibilitychange").pipe(iR(e,t,(()=>{RR.makeLogger(["Video"]).log(`Page visibility ${document.visibilityState} `),setTimeout((()=>{const e="visible"!==document.visibilityState,{video:{subscribedVideoList:n},meeting:{userId:i}}=t.value,r=n.filter((e=>e!==i)).length>0;e&&r&&(Ps.createAgent().sendRWGConnectionPerformance("VCSV"),RR.makeLogger(["Video"]).warn("Still subscribing videos after switching to background"))}),1e3)})))},rO={rmclEpics0:(e,t)=>e.pipe(Ut(`${tf}`),iR(e,t,(e=>{const{payload:{isRemoteControlEnabled:t,isEnableAutoDeleteRcApp:n}}=e;_R.log(`isRemoteControlEnabled:${t},auto delete:${n}`)}))),rmclEpics1:(e,t)=>e.pipe(Ut(`${Yp}`),ht((e=>!!e.payload)),iR(e,t,(e=>{_R.log(`Launch Remote control app, scheme:${e.payload}`)}))),rmclEpics2:(e,t)=>e.pipe(Ut(`${Kp}`),ht((e=>!!e.payload)),iR(e,t,(e=>{_R.log(`Remote control session starts, controlling ssrc:${e.payload}`)}))),rmclEpics3:(e,t)=>oR(e,t,16430,(()=>{_R.log("Remote control app connected to rwg.")})),rmclEpics4:(e,t)=>oR(e,t,cs,(()=>{_R.log("Remote control app disconnected to rwg.")})),rmclEpics5:(e,t)=>oR(e,t,cs,(e=>{const{share:{status:n,isRemoteControlEnabled:i}}=t.value;i&&n!==qa.End&&e.payload.body.bOn&&_R.log(`Remote control sharing device info.${JSON.stringify(IR.getShareStreamInfo())}`)})),rmclEpics6:(e,t)=>rR(e,t,Da.CurrentDesktopSharingWidthHeight,(()=>{const{share:{isRemoteControlEnabled:e}}=t.value;e&&_R.log(`Remote control sharing device info changes.${JSON.stringify(IR.getShareStreamInfo())}`)})),rmclEpics7:(e,t)=>rR(e,t,Da.SendRemoteControlQrCode,(e=>{const{share:{status:n}}=t.value,{payload:{data:i}}=e;_R.log(`Remote control QR code result. sharing status:${n}, result${JSON.stringify(i)}`)}))},oO={epics0:(e,t)=>e.pipe(Ut(`${jr}`),Ye((async e=>{const{meeting:{logConfig:n,logEncryptionPubKey:i,zlkJwtToken:r,accountId:o,enableAutoLog:s,collectionToggleEnable:a,zsk:u},logger:{options:l}}=t.value;let c=l||{};if(n)try{const{enable:e,enableReport:t}=JSON.parse(n);c={...c,enable:e,enableReport:t}}catch(e){}if(r){const{telemetry_tracking_id:t}=mr(r),{payload:{meetingId:n}}=e,i=null!=t?t:n;c={...c,enable:!0,enableReport:!0,trackingId:i}}else{let e=!1;e=u&&void 0!==a?!(s&&a):!s,Do.set(No.DisableAutoReportLogs,e,Oo.Memory)}return ER.init({...c,logConfig:n,logEncryptionPubKey:i,accountId:o}).then((()=>[dv(!0),cv(c)])).catch((()=>[dv(!1)]))})),Ye((e=>Me(e)))),epics1:(e,t)=>oR(e,t,as,(e=>{var n,i,r,o;const{payload:{body:s}}=e;if(s&&s.res===wr.Success){ER.makeLogger(["A/V Performance Info"]).info(`CPU cores:${navigator.hardwareConcurrency}, SharedArrayBuffer:${!!window.crossOriginIsolated}, browser:${Uo.browser} ${Uo.browserVersion}, OS:${Uo.os} ${Uo.osVersion}${uR("wow64",Uo.wow64)}${uR("GPU",Uo.gpu)}${uR("architecture",Uo.architecture)}${uR("bitness",Uo.bitness)}${uR("model",Uo.model)}${Do.get(No.EnforceWebRTCAudio)?"; Enforce WebTRC audio":""}`,["CPU_CORES"]);const{media:{enforceMultipleVideos:e,enforceVirtualBackground:n,assetsPath:i,disableRenderLimits:r},meeting:{stayAwake:o,quicklyLeave:s}}=t.value;ER.makeLogger(["Init Option"]).info(`Init option:${JSON.stringify({enforceMultipleVideos:e,disableRenderLimits:r,enforceVirtualBackground:n,assetsPath:i,stayAwake:o,leaveOnPageUnload:s})}`),"connection"in navigator&&(wR(),navigator.connection.addEventListener("change",wR))}else ER.report(`join meeting failed, error:${JSON.stringify(Rr(null==s?void 0:s.res))}, rwg error code:${null==s?void 0:s.res}, rwg conID:${null==s?void 0:s.conID}, error message:${null==s?void 0:s.error_desc}, rwg url:${null==s?void 0:s.svcUrl},mid:${t.value.meeting.meetingId}`,"JOIN_MEETING_FAILED","error");const{meeting:{meetingInfoTimestamp:a,pingRWCTimestamp:u,tid:l,meetingId:c,topic:d,accountId:h,cv:p},socket:{rwgServerList:f,retryCount:g},video:{rendererType:m},media:{patchJsMedia:v,assetsPath:y}}=t.value;let S=["conID","confID","mmrFeature","mmrFeatureEx","reportDomain","res","role","svcUrl","userID"].reduce(((e,t)=>void 0!==s[t]?{...e,[`${t}`]:s[t]}:e),{});S=["jid","mn","participantID","zoomID"].reduce(((e,t)=>void 0!==s[t]?{...e,[`${t}`]:GS(s[t])}:e),S),S.response=S.res,delete S.res;const b=["connection_info_map"];let E;if(s.res===wr.Success&&b.push("Command Socket Event","User Info Map"),l){const e=l.match(/clid=(\S+);/);e&&e.length>1&&(E=e[1])}const w=Math.floor(performance.now()-a),_=Math.floor(performance.now()-u);ER.report(JSON.stringify({...S,tid:l,mid:c,userRegion:E,rwgUrl:f.length>0?null===(n=f[g])||void 0===n?void 0:n.rwg:void 0,hardwareConcurrency:navigator.hardwareConcurrency,sharedArrayBuffer:!!window.crossOriginIsolated,browserVersion:`${Uo.browser} ${Uo.browserVersion}`,osVersion:`${Uo.os} ${Uo.osVersion}`,gpu:Uo.gpu,architecture:Uo.architecture,model:Uo.model,bitness:Uo.bitness,totalDurationOfJoining:w,durationOfRWG:_,rendererType:m,sdkVersion:p,mediaSdkVersion:null===(i=window.JsMediaSDK_Instance)||void 0===i?void 0:i.version,topic:d?GS(d):void 0,accountId:h?GS(h):void 0,patchJSMediaSDK:v,dependentAssets:y}),b,"info"),Ps.createAgent().sendRWGConnectionPerformance(`WCL_M, conId: ${null==s?void 0:s.conID}, trackingId: ${null===(r=t.value.logger)||void 0===r||null===(o=r.options)||void 0===o?void 0:o.trackingId}, JOINFS(${w}), JOINFRWC(${_})`)})),epics2:(e,t)=>e.pipe(Ut(`${xr}`),Tt(t),ht((e=>{let[,t]=e;return void 0===t.meeting.encryptedRWC&&(void 0===t.meeting.encryptedGEORWC||0===t.meeting.encryptedGEORWC.length)})),iR(e,t,(()=>{const{label:e,payload:n}=nR(t.value);ER.report(`${e} ${JSON.stringify(n)}`,["Join Meeting Flow","Ping RWC Domain Empty"],"error")}))),epics3:(e,t)=>e.pipe(Ut(`${Nr}`),ht((e=>e.payload===To.OnError||e.payload===To.Disconnect||e.payload===To.NoHeartbeat)),iR(e,t,(e=>{const{payload:n}=e,{socket:{rwgServerList:i,retryCount:r}}=t.value,{payload:o}=nR(t.value);ER.report(`websocket unexpected disconnected,${JSON.stringify({code:n,rwgHost:i[r],...o})}`,["Join Meeting Flow","RWG Disconnect"])}))),epics4:(e,t)=>e.pipe(Ut(`${vo}`),iR(e,t,(e=>{const{payload:{reason:n,count:i,interval:r,sequence:o,userId:s,userGUID:a}}=e,{payload:u}=nR(t.value,{userId:s,userGUID:a});ER.report(`meeting failover,${JSON.stringify({reason:n,count:i,interval:r,sequence:o,detailed:bR(o),...u})}`,["Join Meeting Flow","Failover"]),"connection"in navigator&&navigator.connection.removeEventListener("change",wR)}))),epics5:(e,t)=>e.pipe(Ut(`${jn}`),ht((e=>e.payload.status===Th.Connecting)),iR(e,t,(e=>{const{payload:{rwgUrl:n}}=e;let i=n.replace(/(\d+)\?/,`${GS("$1")}?`);i=["email","zoomid","participantID","dn2","customer_key","mpwd","topic"].reduce(((e,t)=>e.indexOf(t)>-1?e.replace(new RegExp(`${t}=([^&]+)`,"g"),`${t}=${GS("$1")}`):e),i);const{payload:r}=nR(t.value);ER.makeLogger(["Join Meeting Flow"]).info(`RWG URL,${JSON.stringify({rwgUrl:i,...r})}`,["RWG Url"])}))),epics6:(e,t)=>e.pipe(Ut(`${Dn}`),ht((e=>{const{payload:n}=e;return n?n.retry:t.value.meeting.meetingStatus===Co.Initial})),iR(e,t,(()=>{const{meeting:{meetingStatus:e},socket:{rwgServerList:n,retryCount:i}}=t.value;if(e!==Co.Joined){const{payload:e}=nR(t.value),r=(null==n?void 0:n.length)>0?n[i]:void 0;ER.report(JSON.stringify({...e,rwc:null==r?void 0:r.rwc,rwg:null==r?void 0:r.rwg}),["UNAVAILABLE_RWG"])}}))),epics7:(e,t)=>oR(e,t,1,(e=>{const{payload:{body:n}}=e;ER.report(`join meeting failed, version blocked. Current version:${t.value.meeting.cv},upgrade version:${null==n?void 0:n.upgradeVersion}`,"JOIN_MEETING_FAILED","error")})),epics8:(e,t)=>oR(e,t,2,(()=>{ER.report(`join meeting with low version of SDK. Current version:${t.value.meeting.cv}.`,"Join Meeting Flow","warn")})),epics9:(e,t)=>e.pipe(Ut(`${Dr}`,`${kr}`),_t((()=>Ad(Ws,1).pipe(At((e=>{try{const{payload:n}=nR(t.value);ER.report(`Connection change with join meeting failed. payload:${JSON.stringify(e)}. meeting info:${JSON.stringify(n)}`,"JOIN_MEETING_FAILED","error")}catch(e){}})),Ye((()=>ge))))))},sO=hi(oO,rO,iO),aO=Ps.createAgent(),uO={cmrStatus:Sa.Stop,recordingEnable:!1,recordingIsoEnable:!1,allowStopAutoRecording:!1,automaticCloudRecordingEnable:!1,isZoomIQ:!1,zoomIQChanging:!1,localStatus:ba.Stop,supportLocalRecording:Ea.None,localGrantPermissionOption:wa.None,localPermissionUserList:[]},lO=Rn({[`${bm}`]:hE(((e,t)=>{let{payload:n}=t;e.cmrStatus=n})),[`${Em}`]:hE(((e,t)=>{let{payload:n}=t;e.recordingEnable=n})),[`${wm}`]:hE(((e,t)=>{let{payload:n}=t;e.recordingIsoEnable=n})),[`${_m}`]:hE(((e,t)=>{let{payload:n}=t;e.allowStopAutoRecording=n})),[`${Im}`]:hE(((e,t)=>{let{payload:n}=t;e.automaticCloudRecordingEnable=n})),[`${Cm}`]:hE(((e,t)=>{let{payload:n}=t;e.isZoomIQ=n})),[`${Am}`]:hE(((e,t)=>{let{payload:n}=t;e.zoomIQChanging=n})),[`${Tm}`]:hE(((e,t)=>{let{payload:n}=t;e.localStatus=n})),[`${Rm}`]:hE(((e,t)=>{let{payload:n}=t;e.supportLocalRecording=n})),[`${Om}`]:hE(((e,t)=>{let{payload:n}=t;e.localGrantPermissionOption=n})),[`${Pm}`]:hE(((e,t)=>{let{payload:n}=t;e.localPermissionUserList=n})),[`${Dm}`]:()=>({...uO})},uO);var cO,dO,hO,pO,fO,gO,mO,vO,yO;const SO=Ps.createAgent(),bO=oT("Recording");let EO=(cO=eT("recording"),dO=eT("recording"),hO=eT("recording"),pO=eT("recording"),fO=eT("recording"),gO=eT("recording"),mO=eT("recording"),vO=eT("recording"),yO=class extends aT{startRecording(){const e=this[GA](),{meeting:{bIbDisableRecording:t,recordingEnable:n},recording:{cmrStatus:i}}=e;return t?Promise.reject({type:yc,reason:"Rejected by Information Barrier"}):n?i===Sa.Start?Promise.resolve(""):(SO.recordMeeting(!0,!1),Cd(_a,(e=>e.cmrServerStatus===Sa.Start))):Promise.reject({type:yc,reason:"The account of the meeting disabled the cloud recording"})}pauseRecording(){const e=this[GA](),{recording:{cmrStatus:t,allowStopAutoRecording:n}}=e;return t===Sa.Pause?Promise.resolve(""):t!==Sa.Start?Promise.reject({type:yc,reason:"Recording is not started"}):n?(SO.recordMeeting(!1,!0),Cd(_a,(e=>e.cmrServerStatus===Sa.Pause))):Promise.reject({type:yc,reason:"Cannot pause cloud recording due to web setting config"})}stopRecording(){const e=this[GA](),{recording:{cmrStatus:t,allowStopAutoRecording:n}}=e;return t===Sa.Stop?Promise.resolve(""):n?(SO.recordMeeting(!1,!1),Cd(_a,(e=>e.cmrServerStatus===Sa.Stop))):Promise.reject({type:yc,reason:"Cannot stop cloud recording due to web setting config"})}accept(){const e=this[GA](),{recording:{cmrStatus:t,recordingIsoEnable:n}}=e,i=gh(e);return n?t!==Sa.Start&&t!==Sa.Pause?Promise.reject({type:yc,reason:"Recording is not started"}):null!=i&&i.bAllowISORecord?Promise.resolve("You accepted ISO recording"):(SO.allowSelfRecord(!0),Cd(Ia,(e=>(null==e?void 0:e.userId)===(null==i?void 0:i.userId)&&(null==e?void 0:e.status)===ya.Accept))):Promise.reject({type:yc,reason:"ISO Recording is not enabled"})}decline(){const e=this[GA](),{recording:{cmrStatus:t,recordingIsoEnable:n}}=e,i=gh(e);return n?t!==Sa.Start&&t!==Sa.Pause?Promise.reject({type:yc,reason:"Recording is not started"}):!0===(null==i?void 0:i.bAllowISORecord)?Promise.reject({type:yc,reason:"You had accept ISO recording, cant change it"}):(SO.allowSelfRecord(!1),Promise.resolve("")):Promise.reject({type:yc,reason:"ISO Recording is not enabled"})}getRecordingStatus(){const e=this[GA](),{recording:{cmrStatus:t}}=e,n=Ch(e);return t===Sa.Start?ya.Recording:t===Sa.Pause?ya.Paused:n?ya.Recording:ya.Stopped}isRecordingEnabled(){const e=this[GA](),{recording:{recordingEnable:t}}=e;return t}isAllowedToStopAutoRecording(){const e=this[GA](),{recording:{allowStopAutoRecording:t}}=e;return t}isAutomaticCloudRecordingEnabled(){const e=this[GA](),{recording:{automaticCloudRecordingEnable:t}}=e;return t}enableRecordingWithIQ(e){const{[GA]:t,[zA]:n}=this,i=t(),{recording:{isZoomIQ:r,zoomIQChanging:o},meeting:{meetingOptions:s}}=t();return s.isEnableKiwiRecording?mh(i)?o?Promise.reject({type:yc,reason:"We are changing, please wait"}):e===r?Promise.reject({type:yc,reason:`You have ${e?"enable":"disable"} Zoom IQ, don't need change`}):(n(Am(!o)),n(Cm(!r)),SO.enableZoomIQRecord(e),Cd(Ra,(e=>null==e?void 0:e.success))):Promise.reject({type:yc,reason:"Only Host or co-host can enable/disable Zoom IQ"}):Promise.reject({type:yc,reason:"You not have zoom IQ license or not enable zoom IQ, please check and retry"})}isSupportLocalRecording(){const e=this[GA](),{meeting:{meetingOptions:t,isWebinar:n},breakoutRoom:i}=e;if((null==i?void 0:i.currentRoom.status)===rh.InRoom)return!1;const r=gh(e);return(!n||!eh(r.userRole))&&(null==t?void 0:t.isLocalRecordingEnabled)}isSupportLocalRecordingPermission(){const e=this[GA](),{recording:{supportLocalRecording:t}}=e;if(!this.isSupportLocalRecording())return!1;const n=gh(e);return!(null==n||!n.isHost)||t===Ea.Allow}askLocalRecordingPermission(){const{[GA]:e}=this,{recording:{supportLocalRecording:t}}=e();return this.isSupportLocalRecording()?t===Ea.None?(SO.localRecordingRequestPermission(),Promise.resolve("")):t===Ea.Allow?Promise.resolve(""):Promise.reject("permission is denied"):Promise.reject("not support")}startLocalRecording(e){const{[GA]:t,[zA]:n}=this,i=t(),{recording:{localStatus:r,supportLocalRecording:o},meeting:{userId:s}}=i;if(!(e in ba))return Promise.reject({type:yc,reason:"not support you parameter, only support type are 0(stop)/1(start)/2(pause)."});if(!this.isSupportLocalRecording())return Promise.reject({type:yc,reason:"not support local recording"});if(e===r)return Promise.resolve(`you currently status is ${r}, do nothing`);const a=gh(i);return o===Ea.Allow||null!=a&&a.isHost?(SO.localRecordingMeeting(e),Cd(Ca,(t=>(null==t?void 0:t.userId)===s&&(n(Tm(t.bLocalRecord)),t.bLocalRecord===e)),1e3)):Promise.reject({type:yc,reason:"you not have local recording permission, please use askLocalRecordingPermission request it first"})}isSupportLocalRecordingGrantPermission(){const e=this[GA]();if(!this.isSupportLocalRecording())return!1;const t=gh(e);return!(null==t||!t.isHost||!uy(t.caps))}grantLocalRecordingPermission(e,t,n){const{[GA]:i,[zA]:r}=this,o=i(),{recording:{localPermissionUserList:s}}=o;if(!this.isSupportLocalRecording())return Promise.resolve(!1);const a=gh(o);if(!uy(a.caps))return Promise.reject({type:yc,reason:"you can not grant permission"});let u=!1;if(n&&(u=!0),s.filter((t=>t===e)).length>0){if(t===Ea.Allow)SO.localRecordingGrantPermission(e,!0,u);else{if(t!==Ea.Deny)return Promise.reject({type:yc,reason:"only support DENY(1)/ALLOW(2)"});SO.localRecordingGrantPermission(e,!1,u)}return r(Pm(s.filter((t=>t!==e)))),_d(Aa,{type:"answer",value:t===Ea.Allow}),Promise.resolve(!1)}return t!==Ea.Deny?Promise.reject({type:yc,reason:"Direct grant only support DENY(1)"}):(SO.hostGrantPermission(e,!1),Cd(Aa,(n=>(null==n?void 0:n.value)===e&&(t===Ea.Allow?(r(Pm([...s,e])),!0===(null==n?void 0:n.canRecord)):(r(Pm(s.filter((t=>t!==e)))),!1===(null==n?void 0:n.canRecord)))),1e3))}getLocalRecordingPermissionUserList(){const e=this[GA](),{recording:{localPermissionUserList:t}}=e;if(!this.isSupportLocalRecording())return[];const n=gh(e);return uy(n.caps)?t:Promise.reject({type:yc,reason:"you can not grant permission"})}getLocalRecordingPermissionOperation(){const e=this[GA](),{recording:{localGrantPermissionOption:t}}=e;if(!this.isSupportLocalRecording())return null;const n=gh(e);return uy(n.caps)?t:null}},$A(yO.prototype,"startRecording",[ZA,YA,cO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"startRecording"),yO.prototype),$A(yO.prototype,"pauseRecording",[ZA,YA,dO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"pauseRecording"),yO.prototype),$A(yO.prototype,"stopRecording",[ZA,YA,hO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"stopRecording"),yO.prototype),$A(yO.prototype,"accept",[YA,pO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"accept"),yO.prototype),$A(yO.prototype,"decline",[YA,fO,bO],Object.getOwnPropertyDescriptor(yO.prototype,"decline"),yO.prototype),$A(yO.prototype,"askLocalRecordingPermission",[YA,gO],Object.getOwnPropertyDescriptor(yO.prototype,"askLocalRecordingPermission"),yO.prototype),$A(yO.prototype,"startLocalRecording",[YA,mO],Object.getOwnPropertyDescriptor(yO.prototype,"startLocalRecording"),yO.prototype),$A(yO.prototype,"grantLocalRecordingPermission",[YA,XA,vO],Object.getOwnPropertyDescriptor(yO.prototype,"grantLocalRecordingPermission"),yO.prototype),yO);const wO={moduleEpics0:e=>e.pipe(Ut(`${jr}`),Ke((e=>{const{payload:{recordingEnable:t}}=e;return Em(t)}))),moduleEpics1:(e,t)=>pi(e,rs).pipe(ht((e=>{var t,n,i;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.cmrServerStatus)||void 0!==(null===(n=e.payload.body)||void 0===n?void 0:n.disAllowClientStopAutoCmr)||void 0!==(null===(i=e.payload.body)||void 0===i?void 0:i.enableAutomicRecordingCloud)})),Tt(t),Ye((e=>{let[t,n]=e;const{cmrServerStatus:i,disAllowClientStopAutoCmr:r,enableAutomicRecordingCloud:o}=t.payload.body,s=[];return void 0!==i&&(i!==Sa.Init&&(_d(_a,{cmrServerStatus:i}),n.recording.recordingIsoEnable&&i===Sa.Start&&_d(Ia,{status:ya.Ask})),s.push(bm(i))),void 0!==r&&s.push(_m(!r)),void 0!==o&&s.push(Im(o)),Me(s)}))),moduleEpics2:e=>pi(e,rs).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.bCmrIsoEnble)})),Ke((e=>{const{bCmrIsoEnble:t}=e.payload.body;return wm(t)}))),moduleEpics3:(e,t)=>pi(e,is).pipe(Tt(t),ht((e=>{let[t]=e;const{payload:{body:{update:n,add:i}}}=t;return(null==n?void 0:n.some((e=>void 0!==e.bLocalRecordStatus||void 0!==e.canRecord)))||(null==i?void 0:i.some((e=>void 0!==e.bLocalRecordStatus||void 0!==e.canRecord)))})),Ye((e=>{let[t,n]=e;const{payload:{body:{update:i,add:r}}}=t,{meeting:{userId:o,isHost:s},recording:{supportLocalRecording:a},participants:{attendeesList:u}}=n,l=[];return null==i||i.concat(r||[]).filter((e=>void 0!==e.bLocalRecordStatus||void 0!==e.canRecord)).forEach((e=>{if(void 0!==e.canRecord){const t=Boolean(e.canRecord);if(o===e.id||s){const n=u.find((e=>e.userId===o));!t&&null!=n&&n.bLocalRecord&&(_d(Aa,{type:"revoke",value:e.id,canRecord:t}),aO.localRecordingMeeting(ba.Stop)),!t||null!=n&&n.bLocalRecord||_d(Aa,{type:"grant",value:e.id,canRecord:t})}o===e.id&&((a!==Ea.None||t)&&l.push(Rm(t?Ea.Allow:Ea.Deny)),t||l.push(Tm(ba.Stop)))}else _d(Ca,{userId:e.id,bLocalRecord:e.bLocalRecordStatus})})),Me(l)}))),moduleEpics4:(e,t)=>pi(e,is).pipe(Ke((e=>Ew(e.payload.body))),Tt(t),Ye((e=>{let[t,n]=e;const i=[],{recording:{localPermissionUserList:r}}=n;return t.remove&&t.remove.forEach((e=>{r.filter((t=>t===(null==e?void 0:e.userId)))&&(i.push(Pm(r.filter((t=>t!==(null==e?void 0:e.userId))))),_d(Aa,{type:"remove",value:null==e?void 0:e.userId}))})),Me(i)}))),moduleEpics5:e=>pi(e,is).pipe(ht((e=>{const{payload:{body:{update:t}}}=e;return null==t?void 0:t.some((e=>void 0!==e.bAllowISORecord))})),At((e=>{const{payload:{body:{update:t}}}=e;t.filter((e=>void 0!==e.bAllowISORecord)).forEach((e=>{_d(Ia,{userId:e.id,status:e.bAllowISORecord?ya.Accept:ya.Decline})}))})),St(ge)),moduleEpics6:e=>pi(e,rs).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.SalesRecordingAnalytics)})),Ke((e=>{const{SalesRecordingAnalytics:t}=e.payload.body;return _d(Ta,{isZoomIQ:t}),Cm(t)}))),moduleEpics7:(e,t)=>pi(e,4319).pipe(Tt(t),ht((e=>{var t;let[n]=e;return void 0!==(null===(t=n.payload.body)||void 0===t?void 0:t.success)})),Ye((e=>{let[t,n]=e;const i=[],{success:r}=t.payload.body,{recording:{zoomIQChanging:o}}=n;return _d(Ra,{success:r}),r&&i.push(Am(!o)),Me(i)}))),moduleEpics8:(e,t)=>pi(e,4344).pipe(Tt(t),ht((e=>{var t;let[n]=e;return void 0!==(null===(t=n.payload.body)||void 0===t?void 0:t.cmdType)})),Ye((e=>{var t;let[n,i]=e;const r=[],{cmdType:o}=n.payload.body,{recording:{localPermissionUserList:s},meeting:{isHost:a}}=i;var u,l,c,d;return"permission_req_option"===o&&(_d(Aa,{type:"option",value:null===(u=n.payload.body)||void 0===u?void 0:u.option}),r.push(Om(null===(l=n.payload.body)||void 0===l?void 0:l.option))),"request_permission"===o&&null!==(t=n.payload.body)&&void 0!==t&&t.userId&&(a&&_d(Aa,{type:"request",value:null===(d=n.payload.body)||void 0===d?void 0:d.userId}),r.push(Pm([...s,null===(c=n.payload.body)||void 0===c?void 0:c.userId]))),"permission_request_answer"===o&&(_d(Aa,{type:"answer",value:n.payload.body.agreed}),r.push(Rm(n.payload.body.agreed?Ea.Allow:Ea.Deny))),Me(r)})))},_O=hi(wO);let IO=function(e){return e[e.All=1]="All",e[e.Private=2]="Private",e}({}),CO=function(e){return e.SUCCESS="success",e}({}),AO=function(e){return e.CustomizedKey="__zoom_internal_message_customized_key__@@",e.SpeakerOnly="__zoom_internal_message_speaker_only__@@",e}({});const TO=EE.getInstance(),RO=(e,t,n)=>{const{meeting:{encType:i}}=n,r=t,o=or(e),s=r?IO.Private:IO.All;return i===Jo.AES_GCM?es.beginEncrypt({text:o,type:Qo.XMPP_CHAT}).then((e=>{TO.sendWebinarMseeage(e,r,s,!0)})):TO.sendWebinarMseeage(o,r,s,!1)};function OO(e,t){const{cmd:{jids:n}}=t;return Object.prototype.hasOwnProperty.call(n,e)?Promise.resolve():je(Ad(qs).pipe(Et((t=>-1===t.findIndex((t=>Number(t.userId)===e)))),gt(1),ke(de)))}function PO(e){const{cmd:{connectionStatus:t}}=e;return t===CO.SUCCESS?Promise.resolve(!0):je(Ad(ga,1)).then((e=>e===Io.Connected||Promise.reject({type:yc,reason:"Cannot establish the command channel"})))}function DO(e,t){for(const[n,i]of Object.entries(e))if(i.jid===t)return n}const kO={connectionStatus:"initial",jids:{}},xO=Rn({[`${Mm}`]:()=>({...kO}),[`${km}`]:hE(((e,t)=>{let{payload:n}=t;const{data:i,attendees:r}=n;i.forEach((t=>{const{jid:n,node:i}=t;if(!e.jids[i]||e.jids[i].jid!==n){const t=r.find((e=>e.userId===Number(i)));e.jids[i]={jid:n,userGuid:null==t?void 0:t.userGUID}}}))})),[`${xm}`]:hE(((e,t)=>{let{payload:n}=t;n.forEach((t=>{const{jid:n}=t,i=DO(e.jids,n);i&&delete e.jids[i]}))})),[`${Nm}`]:hE(((e,t)=>{let{payload:n}=t;e.connectionStatus=n}))},kO);var NO;let MO=(NO=class extends aT{send(e,t){if(!e)return Promise.reject({type:_c,reason:"Text is empty"});if("string"!=typeof e)return Promise.reject({type:_c,reason:"Text is not a string"});if(e.length>512)return Promise.reject({type:_c,reason:"Text exceeds the max length(512)."});const{[GA]:n}=this,i=n(),{socket:{xmppSocketStatus:r},meeting:{userId:o}}=i;return r!==Th.Connected?Promise.reject({type:wc,reason:"Command channel is not ready"}):PO(i).then((()=>t?-1!==bh(n()).findIndex((e=>e.userId===t))?OO(t,i).then((()=>{const{cmd:{jids:i}}=n();return i[t]?(RO(e,i[t].jid,n()),{timestamp:(new Date).getTime(),text:e,receiverId:t,senderId:o}):Promise.reject({type:Sc})})):Promise.reject({type:_c,reason:"Cannot find the user"}):(RO(e,"",i),{timestamp:(new Date).getTime(),text:e,receiverId:0,senderId:o})))}getJids(){const{[GA]:e}=this,t=e(),{cmd:{jids:n}}=t;return n}},$A(NO.prototype,"send",[YA],Object.getOwnPropertyDescriptor(NO.prototype,"send"),NO.prototype),NO);const FO={extraEpics0:(e,t)=>e.pipe(Ut(`${ap}`),_t((e=>{const{payload:{speakerOnly:n}}=e,i=gh(t.value);return(void 0!==(null==i?void 0:i.audio)?Me([i.audio]):Ad(js).pipe(ht((e=>void 0!==e.audio)),gt(1))).pipe(At((()=>{PO(t.value).then((()=>{RO(`${AO.SpeakerOnly}${n?1:0}`,"",t.value)}))})),St(ge))}))),extraEpics1:(e,t)=>pi(e,is).pipe(ht((e=>{var n,i;const{payload:{body:r}}=e;return!!r.add&&!(null===(n=t.value.audio)||void 0===n||null===(i=n.customizeAudioOption)||void 0===i||!i.speakerOnly)})),ke(de),At((async e=>{const{payload:{body:{add:n}}}=e,i=t.value,{meeting:{userId:r}}=i;for(let e=0;e<n.length;e++){const{id:i}=n[e];if(i!==r){await OO(i,t.value);const{cmd:{jids:e},participants:{attendeesList:n}}=t.value;e[i]&&setTimeout((()=>{RO(`${AO.SpeakerOnly}1`,e[i].jid,t.value)}),Math.floor(Math.random()*Math.log10(n.length)*1e3))}}})),St(ge))},LO={epics0:(e,t)=>gi(e,24577).pipe(Tt(t),Ke((e=>{let[t]=e;const{payload:{body:{status:n}}}=t;return n===CO.SUCCESS&&_d(ga,Io.Connected),Nm(n)}))),epics1:(e,t)=>gi(e,24583).pipe(Tt(t),Ye((e=>{let[t,n]=e;const{meeting:{userId:i,encType:r},cmd:{jids:o}}=n,{payload:{body:{senderName:s,senderJid:a,text:u,type:l,receiver:c,msgid:d,sn:h}}}=t,p=DO(o,c),f=r===Jo.AES_GCM,g=DO(o,a),m=(new Date).getTime();let v=Promise.resolve({message:u});return f&&(v=es.beginDecrypt({decryptedText:u,type:Qo.XMPP_CHAT,zoomId:h})),v.then((e=>{let{message:t}=e;if(l===IO.Private&&Number(p)===i||l===IO.All){const e=rr(t);if(null!=e&&e.startsWith(AO.SpeakerOnly)){const t=e.substring(AO.SpeakerOnly.length),n=1===Number(t);return jd({userId:Number(g),key:"isSpeakerOnly",value:n})}{var n;const t=g&&(null===(n=o[g])||void 0===n?void 0:n.userGuid);_d(fa,{senderId:g,senderName:s,senderGuid:t,text:e,timestamp:m,msgid:d})}}return""}))})),ht((e=>"object"==typeof e&&null!==e&&void 0!==e.type)),At((e=>{const{payload:{userId:t,key:n,value:i}}=e;_d(Us,[{userId:t,[`${n}`]:i}])}))),epics2:(e,t)=>gi(e,24595).pipe(Ye((e=>{const{payload:{body:{action:n,data:i}}}=e,r=[];if([SE.List,SE.Add,SE.update].includes(n)&&i){const{breakoutRoom:e,participants:{attendeesList:n}}=t.value,o=(null==e?void 0:e.currentRoom.status)===rh.InRoom?n.concat(e.mainSessionAttendeeList):n;r.push(km({data:i,attendees:o}))}return n===SE.Remove&&i&&r.push(xm(i)),Me(r)})))},VO=hi(LO,FO),jO=(e,t,n,i)=>{const{getState:r,dispatch:o}=n,s=r(),{participants:{attendeesList:a},audio:{localShareAudioUserMutedList:u},share:{isReceiveSharingFromMainSession:l},breakoutRoom:c}=s,d=(l?null==c?void 0:c.mainSessionAttendeeList:a).find((t=>t.userId==e));if(d){if(d.bShareAudioOn){const n=u.find((t=>t.userId===e));return n&&n.muted===!t&&o(m_(i,e,t,s)),Promise.resolve("")}return Promise.reject({type:yc,reason:`Cannot ${t?"mute":"unmute"} share audio when the user's share audio is not enable.`})}return Promise.reject({type:_c,reason:"Cannot find the user"})},BO=(e,t)=>{const{store:{getState:n},rwgAgent:i}=e,{share:{sharePrivilege:r}}=n();return r===t?Promise.resolve(""):Object.values(Ha).includes(t)?(i.lockSharing(t),Wv("lockShare",t)):Promise.reject({type:_c})},UO=Kd([bh],(e=>e.filter((e=>e.bVideoOn)))),HO=Kd([UO],(e=>e.filter((e=>(e.caps&oy)===oy)))),qO=(e,t)=>{const n=e.store.getState(),i=hy(n).find((e=>e.userId===t));if(i){const{caps:e}=i;return(e=>!(512&~e))(e)}return!1};var KO,$O,WO,GO,zO,JO,QO,YO,ZO,XO,eP,tP,nP,iP,rP,oP,sP,aP,uP,lP,cP,dP,hP,pP,fP,gP,mP,vP,yP,SP,bP,EP,wP,_P,IP,CP,AP,TP,RP,OP,PP,DP,kP,xP,NP,MP,FP,LP,VP,jP,BP,UP,HP,qP,KP,$P,WP,GP,zP,JP,QP,YP,ZP,XP,eD,tD,nD,iD,rD,oD,sD,aD,uD,lD,cD,dD,hD,pD,fD;const gD=oT("Audio"),mD=oT("Video"),vD=oT("Sharing"),yD=oT("CameraControl"),SD=oT("Remote Control"),bD=sT(HTMLCanvasElement,0),ED=sT([HTMLCanvasElement,HTMLVideoElement],0),wD=sT(HTMLCanvasElement,0,["id"]),_D=sT([HTMLCanvasElement,HTMLVideoElement],0,["id"]);let ID=(KO=eT("audio"),$O=eT("audio"),WO=eT("audio"),GO=eT("audio"),zO=eT("audio"),JO=oT("Audio",[1,2,3]),QO=eT("audio"),YO=oT("Audio",[1,2]),ZO=eT("audio"),XO=eT("audio"),eP=eT("audio"),tP=eT("audio"),nP=eT("share"),iP=eT("audio"),rP=eT("share"),oP=eT("audio"),sP=eT("audio"),aP=eT("audio"),uP=eT("audio"),lP=eT("audio"),cP=eT("audio"),dP=oT("Audio",[1,2]),hP=eT("audio"),pP=oT("Audio",[1,2]),fP=eT("audio"),gP=eT("audio"),mP=eT("video"),vP=eT("video"),yP=eT("video"),SP=eT("video"),bP=eT("video"),EP=eT("video"),wP=eT("video"),_P=eT("video"),IP=eT("video"),CP=eT("video"),AP=eT("video"),TP=eT("video"),RP=eT("video"),OP=eT("video"),PP=eT("video"),DP=eT("video"),kP=eT("video"),xP=eT("video"),NP=eT("video"),MP=eT("video"),FP=eT("video"),LP=eT("video"),VP=eT("video"),jP=eT("video"),BP=eT("video"),UP=eT("video"),HP=eT("share"),qP=eT("share"),KP=eT("share"),$P=eT("share"),WP=eT("share"),GP=eT("share"),zP=eT("share"),JP=eT("share"),QP=tT("isShareOptionLocked"),YP=tT("isShareOptionLocked"),ZP=eT("share"),XP=eT("share"),eD=eT("share"),tD=eT("share"),nD=eT("share"),iD=eT("share"),rD=eT("share"),oD=eT("share"),sD=eT("share"),aD=eT("share"),uD=eT("share"),lD=eT("share"),cD=eT("share"),dD=eT("share"),hD=eT("share"),pD=eT("share"),fD=class extends aT{constructor(e){super(e),this[WA].dispatch($n()),this[QA]={store:e,mediaAgent:Lv(nb(Ls.getInstance())),rwgAgent:Ps.createAgent()}}startAudio(e){return((e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r,mediaAgent:o}=e,s=n(),a=gh(s);if((null==a?void 0:a.audio)===yu.Computer)return Promise.resolve("");if((null==a?void 0:a.audio)===yu.Phone)return Promise.reject({type:yc,reason:"joined by phone"});{const{audio:{isAllowToTalk:e,isComputerAudioLoading:u,canPlayAudio:l,customizeAudioOption:{speakerOnly:c}},media:{audioDecodeStatus:d,audioEncodeStatus:h}}=s;if(u)return Promise.reject({type:yc,reason:"Computer audio has been loading, please wait."});const p=function(e){const t=e?{...e}:void 0;if(I_(Ho())||!0!==(null==t?void 0:t.backgroundNoiseSuppression)||(console.warn("Background noise suppression requires SharedArrayBuffer and is only supported on desktop browser"),Object.assign(t,{backgroundNoiseSuppression:void 0})),void 0!==(null==t?void 0:t.originalSound)){t.backgroundNoiseSuppression&&t.originalSound&&(console.warn("Enabling original sound will disable background noise suppression."),Object.assign(t,{backgroundNoiseSuppression:!1}));const{originalSound:e}=t;"object"==typeof e&&e.stereo&&!C_()&&(console.warn("Cannot enable stereo audio on current platform due to the browser limitation"),Object.assign(e,{stereo:!1}))}return A_()||!0!==(null==t?void 0:t.syncButtonsOnHeadset)||(console.warn("Sync buttons on headset is not supported on the current platform"),Object.assign(t,{syncButtonsOnHeadset:void 0})),null!=t&&t.mediaFile&&!Ls.isSupportMediaPlaybackAsVideoInput()&&(console.warn("Cannot use media file as audio input due to the browser limitation"),Object.assign(t,{mediaFile:void 0})),t}(t);i(ap(null!=p?p:{}));const{speakerOnly:f,autoStartAudioInSafari:g}=p||{};if(!!c!=!!f&&i(jd({userId:s.meeting.userId,key:"isSpeakerOnly",value:!!f})),!a)return Promise.reject({type:yc,reason:"Please call `startAudio` method after the `join` has been resolved"});{const t=eh(a.userRole)&&!e||f,{encodeInitStatus:u,decodeInitStatus:c}=T_(s,a,f);if(E_()&&("success"!==c||"success"!==u))return Promise.reject({type:yc,reason:"It is required to wait for the audio encoding and decoding to be ready before calling `startAudio` method"});i(Wh(!0)),Rv("audio",u,c).subscribe((s=>{let[u,c]=s;if(u&&c){let s=l||(E_()||Uo.isIOSMobile)&&!g?Promise.resolve():function(){const e=URL.createObjectURL(ja),t=new Audio(e);t.muted=!1;const n=pr((()=>Promise.reject()),3e3),i=Uo.isIOSMobile?new Promise(((e,n)=>{var i;t.addEventListener("canplaythrough",(()=>{t.play().then((()=>{e(!0)})).catch((e=>{n(e)}))})),null===(i=t.load)||void 0===i||i.call(t)})):t.play();return Promise.race([i,n]).finally((()=>{URL.revokeObjectURL(e)}))}();void 0===s&&(s=Promise.resolve()),s.then((()=>Pv("audio",n()))).then((()=>{const s=n(),{audio:{isSharingAudio:u}}=s;R_(r,s,t),u&&!__()||v_(o,s,!t),eh(a.userRole)&&e&&i(Gh(!0)),i(Kh(!0))})).catch((()=>{i(Kh(!1)),i(Wh(!1))}))}else i(Wh(!1))}))}return"failed"===h||"failed"===d?(i(Wh(!1)),Promise.reject({type:Sc,reason:"audio encode or decode error"})):new Promise(((e,t)=>{pt(Ad(Bl.JoinComputerAudio.success,1),lt(...Bl.JoinComputerAudio.fail.map((e=>Ad(e,1).pipe(Ye((()=>Le({type:Ec,reason:e}))))))),at(45e3).pipe(Ye((()=>Le({type:bc}))))).subscribe({next:()=>{i(Wh(!1)),e("")},error:e=>{Ls.getInstance().leaveComputerAudio();const o=gh(n());(null==o?void 0:o.audio)!==yu.Phone&&(i(vp(Fa.MicrophoneError)),r.joinOrLeaveVoip(!1)),i(Wh(!1)),t(e)}})}))}})(this[QA],e)}stopAudio(){return(async e=>{const{store:{getState:t,dispatch:n},mediaAgent:i,rwgAgent:r}=e,o=t(),{audio:{isComputerAudioLoading:s,isShareAudioEnabled:a,isSharingAudio:u,isUsingMediaPlayback:l,customizeAudioOption:{speakerOnly:c}}}=o,d=gh(o);if(s)return Promise.reject({type:yc,reason:"Computer audio has not finished joining, please wait."});if(a){if(u&&!__())return Promise.reject({type:yc,reason:"Cannot stop audio during sharing with audio"});n(Yh(void 0)),n(zh(void 0))}return(null==d?void 0:d.audio)===yu.Computer?(n(vp(Fa.Active)),await i.leaveComputerAudio(),r.joinOrLeaveVoip(!1),c&&n(jd({userId:o.meeting.userId,key:"isSpeakerOnly",value:void 0})),l&&Gv.getInstance().stopAudioElement(),n(jh(0)),Cd(gl)):Promise.resolve("")})(this[QA])}muteAudio(e){return((e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r,mediaAgent:o}=e,s=n(),a=gh(s);if(null==t||t===(null==a?void 0:a.userId))return""===(null==a?void 0:a.audio)||null===(null==a?void 0:a.audio)?Promise.reject({type:yc,reason:"no audio joined"}):!0===(null==a?void 0:a.muted)?Promise.resolve(""):(i(fp(Na.Active)),r.mute(a.userId,!0),o.muteAudio(),s.audio.isShareAudioEnabled&&!__()&&i(zh(!0)),Cd(ml).then((()=>"")));if(mh(s)){const{participants:{allowTalkAttendeesList:e,attendeesList:n}}=s,i=e.concat(n).find((e=>e.userId===t));return i?""===i.audio||null===i?Promise.reject({type:yc,reason:"no audio joined"}):!1===i.muted?(r.mute(t,!0),Cd(yl,(e=>e.id===t&&1==e.muted))):Promise.resolve(""):Promise.reject({type:_c,reason:"no matching user"})}return Promise.reject({type:Ec})})(this[QA],e)}unmuteAudio(e){return(async(e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r,mediaAgent:o}=e,s=n(),a=gh(s);if(void 0===t||t===(null==a?void 0:a.userId)){if(""===(null==a?void 0:a.audio)||null===(null==a?void 0:a.audio))return Promise.reject({type:yc,reason:"no audio joined"});if(!1===(null==a?void 0:a.muted))return Promise.resolve("");if(s.audio.isShareAudioEnabled&&!__()){if(s.audio.isSharingAudio)return Promise.reject({type:yc,reason:"Cannot unmute audio during sharing with audio"});i(zh(!1))}if(s.audio.bCanUnmute||null!=a&&a.isHost||null!=a&&a.bCoHost){if(eh(a.userRole)){const{audio:{isAllowToTalk:e,isAllowToTalkAttendeeConnected:t}}=s;e?t||(await o.leaveComputerAudio(),await v_(o,s,!0),i(Gh(!0))):Promise.reject({type:yc,reason:"Webinar attendee cannot unmute self audio."})}return i(gp(Ma.Active)),r.mute(a.userId,!1),o.unmuteAudio(),Cd(vl).then((()=>""))}return Promise.reject({type:Ec,reason:"host not allow unmute themselves"})}if(mh(s)){const{participants:{allowTalkAttendeesList:e,attendeesList:n}}=s,i=e.concat(n).find((e=>e.userId===t));return i?""===i.audio||null===i?Promise.reject({type:yc,reason:"no audio joined"}):(!0===i.muted&&r.mute(t,!1),Promise.resolve("")):Promise.reject({type:_c,reason:"no matching user"})}return Promise.reject({type:Ec})})(this[QA],e)}dialOut(e,t,n,i){return((e,t,n,i,r)=>{const{store:{getState:o,dispatch:s},rwgAgent:a}=e,u=o(),{meeting:{callOutCountry:l,isSupportCallOut:c}}=u;if(c&&Array.isArray(l)&&l.findIndex((e=>e.code===t))>-1){const{seq:e}=a.audioDialout(t+n,i,!(null==r||!r.callMe),!(null==r||!r.pressingOne),!(null==r||!r.greeting));return s(kh({sequence:e,phoneNumber:t+n})),Id(Bl.JoinAudioByCallMe)}return Promise.reject({type:_c,reason:"no matching country code"})})(this[QA],e,t,n,i)}cancelDialOut(e,t,n){return((e,t,n,i)=>{const{rwgAgent:r}=e;return r.audioCancelDialout(t+n,!(null==i||!i.callMe)),Id(Bl.cancelDialOut)})(this[QA],e,t,n)}hangup(){return(e=>{const{store:{getState:t},rwgAgent:n}=e,i=t(),r=gh(i);return(null==r?void 0:r.audio)===yu.Phone&&null!==r.userId?(n.audioDrop(r.userId),Id(Bl.hangup)):Promise.reject({type:yc,reason:"not joined audio by phone"})})(this[QA])}switchMicrophone(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r}=e,o=n(),{audio:{microphoneDevicesList:s,activeMicrophone:a,mediaPlaybackFile:u,isUsingMediaPlayback:l}}=o,c=s.find((e=>e.deviceId===t));if("default"===t||"string"!=typeof t||c){const e=gh(o);if((null==e?void 0:e.audio)===yu.Computer){let n=!1;if("string"==typeof t)t!==a&&(r.changeMicrophone(t,null==c?void 0:c.label,!(null==e||!e.muted)),i(cp(void 0)),Gv.getInstance().stopAudioElement(),n=!0);else if(t&&(!l||(null==u?void 0:u.url)!==t.url)){const o=Gv.getInstance();o.setAudioElement(t).then((()=>{r.changeMicrophone(o.audioElement,void 0,!(null==e||!e.muted)),i(cp(t))})),n=!0}if(n)return Id(Bl.JoinComputerAudio)}else"string"==typeof t&&i(Hh(t));return Promise.resolve("")}return Promise.reject({type:Rl})})(this[QA],e)}switchSpeaker(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r}=e,{audio:{speakerDevicesList:o,activeSpeaker:s}}=n();if("default"!==t&&-1==o.findIndex((e=>e.deviceId===t)))return Promise.reject({type:Rl});var a;if((null===(a=gh(n()))||void 0===a?void 0:a.audio)===yu.Computer){if(t!==s)return r.changeSpeaker(t),Cd(xl,(e=>e))}else i(qh(t));return Promise.resolve("")})(this[QA],e)}muteShareAudio(e){return((e,t)=>{const{mediaAgent:n,rwgAgent:i,store:{getState:r,dispatch:o}}=e,s=r(),{meeting:{userId:a}}=s;if(t&&t!==a)return jO(t,!0,e.store,n);{const{audio:{isSharingAudio:e,isShareAudioEnabled:t,isShareAudioMuted:r}}=s;if(!t)return Promise.reject({type:yc,reason:"Cannot mute sharing audio when sharing audio is not enable"});if(r)return Promise.resolve("");{i.muteShareAudio(!0);let t=Promise.resolve();var u;return e&&(t=null===(u=n.leaveSharingAudio(!0))||void 0===u?void 0:u.then((()=>y_(n,i,s).then((e=>{e.forEach((e=>o(e)))}))))),m_(n,a,!0,s),Promise.all([Cd({event:js,operations:[ht((e=>void 0!==e.bShareAudioOn)),gt(1)]},(e=>!1===e.bShareAudioOn)),t]).then((()=>(o(Xh(!0)),e&&(o(ep(!1)),_d(Pl,{state:"off"})),"")))}}})(this[QA],e)}unmuteShareAudio(e){return((e,t)=>{const{mediaAgent:n,rwgAgent:i,store:{getState:r,dispatch:o}}=e,s=r(),{meeting:{userId:a}}=s;if(t&&t!==a)return jO(t,!1,e.store,n);{const{audio:{isSharingAudio:e,isShareAudioEnabled:t,isShareAudioMuted:r},share:{status:u}}=s;if(!t)return Promise.reject({type:yc,reason:"Cannot unmute sharing audio when sharing audio is not enable"});if(!1===r)return Promise.resolve("");{i.muteShareAudio(!1);let t=Promise.resolve();return!1===e&&u===qa.Sharing&&(t=b_(n,i,s).then((e=>{e.forEach((e=>o(e)))}))),m_(n,a,!1,s),Promise.all([Cd({event:js,operations:[ht((e=>void 0!==e.bShareAudioOn)),gt(1)]},(e=>!0===e.bShareAudioOn)),t]).then((()=>(o(Xh(!1)),!1===e&&u===qa.Sharing&&(o(ep(!0)),_d(Pl,{state:"on"})),"")))}}})(this[QA],e)}subscribeAudioStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{getState:i}}=e,r=i(),o=gh(r),s=!t||t.decode,a=!t||t.encode;if(!o)return Promise.reject({type:yc,reason:"Call this function after the 'join' method resolved."});{const{encodeInitStatus:e,decodeInitStatus:t}=T_(r,o);Rv("audio",e,t).subscribe((e=>{let[t,i]=e;t&&i&&(s&&n.subscribeToQos([Ms.AudioDecode],eu),a&&n.subscribeToQos([Ms.AudioEncode],eu))}))}return""})(this[QA],e)}unsubscribeAudioStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{dispatch:i}}=e,r=!t||t.decode,o=!t||t.encode;return r&&(n.unsubscribeFromQos([Ms.AudioDecode]),i(tp(lu))),o&&(n.unsubscribeFromQos([Ms.AudioEncode]),i(np(lu))),null})(this[QA],e)}enableBackgroundNoiseSuppression(e){return((e,t)=>{const{mediaAgent:n,store:{getState:i,dispatch:r}}=e,{audio:{isBackgroundNoiseSuppression:o,originalSound:s}}=i();let a=t;return a===!!o||(a&&!I_(Ho())?(console.warn("Background noise suppression requires SharedArrayBuffer and is only supported on desktop browser"),a=!1):(a&&s&&(console.warn("Enabling noise suppression will disable original sound."),r(mp(!1))),r(up(a)),n.changeAudioProfile(g_(i())))),Promise.resolve("")})(this[QA],e)}enableSyncButtonsOnHeadset(e){return((e,t)=>{const{mediaAgent:n,store:{getState:i,dispatch:r}}=e,o=i(),{audio:{isHIDEnabled:s,microphoneDevicesList:a,activeMicrophone:u}}=o;if(t===!!s)return Promise.resolve("");{const e=gh(o);var l;return e?(t&&!A_()?console.warn("Sync buttons on headset is not supported on the current platform"):(n.enableSyncButtonsOnHeadset(t,null===(l=a.find((e=>e.deviceId===u)))||void 0===l?void 0:l.label,e.muted),r(lp(t))),Promise.resolve("")):Promise.reject({type:yc,reason:"Please call `enableSyncButtonsOnHeadset` method after the `join` has been resolved"})}})(this[QA],e)}enableOriginalSound(e){return((e,t)=>{const{mediaAgent:n,store:{getState:i,dispatch:r}}=e,{audio:{isBackgroundNoiseSuppression:o,originalSound:s}}=i(),a=t;return a===s||"object"==typeof t&&dr(t,s)||("object"!=typeof a||!0!==(null==a?void 0:a.stereo)||C_()||(console.warn("Cannot enable stereo audio on current platform due to the browser limitation"),a.stereo=!1),o&&a&&(console.warn("Enabling original sound will disable background noise suppression."),r(up(!1))),r(mp(a)),n.changeAudioProfile(g_(i()))),Promise.resolve("")})(this[QA],e)}callCRCDevice(e,t){return((e,t,n)=>{const{rwgAgent:i,store:{dispatch:r,getState:o}}=e,{seq:s}=i.inviteCRCDevice(t,n);return r(Sp({sequence:s,ip:t,protocol:n})),Id(Bl.crcCallOut).then((()=>{var e;const{audio:{crcDevice:i}}=o();return null===(e=i.find((e=>e.ip===t&&e.protocol===n&&e.sequence===s)))||void 0===e?void 0:e.uuid}))})(this[QA],e,t)}cancelCallCRCDevice(e,t){return((e,t,n)=>{const{rwgAgent:i,store:{getState:r}}=e,{audio:{crcDevice:o}}=r(),s=o.find((e=>e.ip===t&&e.protocol===n));return s&&s.returnCode===Ou.Ringing?(i.cancelInviteCRCDevice(s.transId),Promise.resolve("")):Promise.reject({type:yc,reason:"Cannot cancel call out "})})(this[QA],e,t)}muteAllAudio(){return(e=>{const{rwgAgent:t}=e;return t.audioMuteAll(!0),Wv("bMutedAll",!0)})(this[QA])}unmuteAllAudio(){return(e=>{const{rwgAgent:t}=e;return t.audioMuteAll(!1),Wv("bMutedAll",!1)})(this[QA])}getMicList(){return(e=>{let{store:{getState:t}}=e;const n=t();return n.audio?[...n.audio.microphoneDevicesList]:[]})(this[QA])}getSpeakerList(){return(e=>{let{store:{getState:t}}=e;const n=t();return n.audio?[...n.audio.speakerDevicesList]:[]})(this[QA])}getAudioState(e){return((e,t)=>{let{store:{getState:n}}=e;const i=n(),{meeting:{isWebinar:r}}=i;let o=null;return null==t?o=gh(i):(o=i.participants.attendeesList.find((e=>e.userId===t)),r&&!o&&(o=i.participants.xmppAttendeeList.find((e=>e.userId===t)))),o?o.audio:null})(this[QA],e)}isAudioMuted(e){return((e,t)=>{let{store:{getState:n}}=e;const i=n(),{meeting:{isWebinar:r}}=i;let o=null;return void 0===t?o=gh(i):(o=i.participants.attendeesList.find((e=>e.userId===t)),r&&!o&&(o=i.participants.xmppAttendeeList.find((e=>e.userId===t)))),!!o&&!!o.muted})(this[QA],e)}getActiveMicrophone(){return(e=>{let{store:{getState:t}}=e;const n=t();return n.audio?n.audio.activeMicrophone:null})(this[QA])}getActiveSpeaker(){return(e=>{let{store:{getState:t}}=e;const n=t();return n.audio?n.audio.activeSpeaker:null})(this[QA])}isSupportCallOut(){return(e=>{let{store:{getState:t}}=e;const{meeting:{isSupportCallOut:n,callOutCountry:i}}=t();return n&&Array.isArray(i)&&(null==i?void 0:i.length)>0})(this[QA])}getDialOutStatus(){return(e=>{let{store:{getState:t}}=e;const{audio:n}=t();return null==n?void 0:n.dialout[n.dialout.length-1].returnCode})(this[QA])}getDialOutCountries(){return(e=>{let{store:{getState:t}}=e;const{meeting:{callOutCountry:n}}=t();return Array.isArray(n)?n:[]})(this[QA])}getShareAudioStatus(){return(e=>{let{store:{getState:t}}=e;const{audio:{isShareAudioEnabled:n,isShareAudioMuted:i,isSharingAudio:r}}=t();return{isShareAudioEnabled:n,isShareAudioMuted:i,isSharingAudio:r}})(this[QA])}isOthersShareAudioMutedLocally(e){return((e,t)=>{var n;let{store:{getState:i}}=e;const{audio:{localShareAudioUserMutedList:r}}=i();return null===(n=r.find((e=>e.userId===t)))||void 0===n?void 0:n.muted})(this[QA],e)}getAudioStatisticData(){return(e=>{let{store:{getState:t}}=e;const{audio:{statistic:n}}=t();return{...n}})(this[QA])}getDialInInfo(){return(e=>{let{store:{getState:t}}=e;const{meeting:{meetingNumber:n,tollNumbers:i,participantID:r,h323Password:o}}=t();return void 0===i?null:{meetingId:n,participantId:r,password:o||"",tollNumbers:i.map((e=>({...e})))}})(this[QA])}isSupportMicrophoneAndShareAudioSimultaneously(){return __()}startVideo(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r}=e,o=n(),{media:{videoDecodeStatus:s,videoEncodeStatus:a,enforceVirtualBackground:u},video:{isCaptureCameraLoading:l,isCurrentUserStartedVideo:c,isVideoMuted:d}}=o,h=t?{...t}:void 0;if(c)return Promise.reject({type:yc,reason:"Video is started"});if(l)return Promise.reject({type:yc,reason:"Camera is starting,please wait."});if(d&&!mh(o))return Promise.reject({type:yc,reason:"Video is muted by the host"});if(tA(u)&&!((null==h?void 0:h.videoElement)instanceof HTMLVideoElement)){console.warn('Rendering self-view on Chromium browser, Android browser without SharedArrayBuffer or iOS browser requires video tag, Please pass a video element instead of a canvas element in the "renderVideo" method');let e=document.body.querySelector(`#${uu}`);if(!e){e=document.createElement("video");const t=Uo.isSafari||Uo.isIOSMobile?"position:fixed;top:-10000px;left:-10000px":"display:none";e.setAttribute("style",t),e.muted=!0,e.playsInline=!0,e.autoplay=!0,e.id=uu,document.body.appendChild(e)}h&&Object.assign(h,{videoElement:e})}return!Vv(u)&&null!=h&&h.virtualBackground?Promise.reject({type:_c,reason:"Virtual background only compatible with Chrome and Edge with SharedArrayBuffer enabled."}):(i(gf(!0)),Rv("video",a,s).subscribe((e=>{let[t]=e;if(t){const e=n(),{video:{activeCamera:t,isSupportHDVideo:o,virtualBackground:{imageSrc:s},mask:{imageSrc:a}}}=e,{cameraId:u=t,captureWidth:l=0,captureHeight:c=0,mirrored:d,hd:p,fullHd:f,virtualBackground:g,mask:m}=h||{};d&&r.mirrorVideo(d),(p||f)&&(console.log("HD support is currently limited, and comes with a number of restrictions and limitations. Please visit https://developers.zoom.us/docs/video-sdk/web/video/#720p-video for more details"),o&&Ls.isCompatibleHardwareForEncode()&&Ls.isSupportVideoEncodeHardwareAcceleration().then((e=>{e&&(r.enableHardwareAccelerationForVideoEncode(!0),i(xf({encode:e})))})),o||console.warn("Cannot capture HD video due to either account restriction and/or hardware limitation"));const v=g||void 0===g&&!!s&&void 0===m,y=m||void 0===m&&!!a;let S=Promise.resolve({});if(v){const t=g||{imageUrl:void 0,cropped:void 0};S=pA({...t,captureWidth:l,captureHeight:c,cameraId:u,hd:p},r,e).then((()=>t))}else if(y){const t=m||{imageUrl:void 0,cropped:void 0,clip:void 0,rootWidth:void 0,rootHeight:void 0};t.rootWidth||Object.assign(t,{rootWidth:1280}),t.rootHeight||Object.assign(t,{rootHeight:720}),S=fA({...t,captureWidth:l,captureHeight:c,cameraId:u,hd:p},r,e).then((()=>t))}null!=h&&h.mediaFile&&!Ls.isSupportMediaPlaybackAsVideoInput()&&(console.warn("Cannot use media file as video input due to the browser limitation."),Object.assign(h,{mediaFile:void 0})),S.then((e=>Pv("video",n()).then((()=>e)))).then((t=>{QC(r,e,h).forEach((e=>{i(e)})),v?i(Pf(t)):y&&i(Gf(t))})).catch((e=>{i(gf(!1)),_d(ju,{reason:e})}))}else i(gf(!1))})),Id(ul.startCaptureVideo).then((()=>{i(mf(!1)),i(hf(!1))})).finally((()=>{i(gf(!1))})))})(this[QA],e)}stopVideo(){return(e=>{const{store:{getState:t},mediaAgent:n}=e,{video:{isCaptureCameraLoading:i,isCurrentUserStartedVideo:r,isUsingMediaPlayback:o}}=t();return i?Promise.reject({type:yc,reason:"Camera is starting,please wait."}):r?(n.stopCaptureVideo(),o&&Gv.getInstance().stopVideoElement(),Cd(Hu,(e=>!0!==(null==e?void 0:e.failed)))):Promise.reject({type:yc,reason:"camera is closed"})})(this[QA])}switchCamera(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r}=e,o=n(),{video:{cameraDevicesList:s,isCurrentUserStartedVideo:a,virtualBackground:u,mask:l,mediaPlaybackFile:c,isUsingMediaPlayback:d,customizedVideoOption:h}}=o;if("string"==typeof t&&!zC(t,s))return Promise.reject({type:_c,reason:"Cannot find cameraDeviceId in camera devices list."});if(a||null!=u&&u.isVBConfigured||l.isMaskConfigured){if("string"==typeof t){const{captureWidth:e,captureHeight:n}=GC(h);r.changeCamera(t,Xa.includes(t),{width:e,height:n}),i(Qf(void 0)),Gv.getInstance().stopVideoElement()}else if(t&&(!d||(null==c?void 0:c.url)!==t.url)){const e=Gv.getInstance();e.setVideoElement(t).then((()=>{r.changeCamera(e.videoElement),i(Qf(t))}))}return Id(ul.switchCameraVideo).then((()=>{i(mf(!1)),i(hf(!1))}))}return Promise.resolve()})(this[QA],e)}renderVideo(e,t,n,i,r,o,s,a,u){return((e,t,n,i,r,o,s,a,u,l)=>{const{store:{getState:c,dispatch:d},mediaAgent:h,rwgAgent:p}=e,f=c(),{meeting:{userId:g},media:{enforceMultipleVideos:m,enforceVirtualBackground:v,disableRenderLimits:y},video:{subscribedVideoList:S,renderedVideoList:b}}=f,E=$o(!!m,y),w=tA(v)&&n===g;if(t instanceof HTMLCanvasElement&&!S.includes(n)&&S.length>=E&&new Set(b.map((e=>e.canvasId))).has(t.id))return Promise.reject({type:yc,reason:`subscribe video counts greater than maximum size (${E})`});if(-1===UO(f).findIndex((e=>e.userId===n)))return Promise.reject({type:_c,reason:"user is not send video"});if(t.id||(t.id=fr("__ZOOM_SDK_VIDEO_CANVAS_@__")),w){if(t instanceof HTMLVideoElement){t.playsInline=!0,t.muted=!0,t.autoplay=!0,Uo.isIOSMobile&&(h.switchCanvasForVideoCapture(t),d(ag())),h.renderVideo(t,n,u||nu,i,r,o,s,a,!0,l||"",!1),d(Sf(n)),d(sg(t.id));const e=document.querySelector(`#${uu}`);return e&&e.remove(),Promise.resolve("")}return Promise.reject({type:_c,reason:"You must use a <video> element to render self video for Chromium browser, Android browser without SharedArrayBuffer or iOS browser "})}const _=!!l,{media:{videoDecodeStatus:I}}=f;return Rv("video","success",I).subscribe((async e=>{let[f,m]=e;if(m){const{video:{ensuredCanvas:e,renderedVideoList:f}}=c();let m=t;e.includes(t.id)||(m=xv(t),d(Jf(t.id)));const v=n===g,[y,b]=iA(n,a,c()),E=u||nu,w=await async function(e,t){const{video:{prefetchedVideo:n}}=t;return(null==n?void 0:n.userId)!==e||n.loaded?"":je(pt(Ad(ol,1),at(1e3).pipe(mt(""))))}(n,c());f.some((e=>e.userId===n&&e.key===E&&e.canvasId===m.id))||h.renderVideo(m,n,E,i,r,o,s,b,v,l||"",_),n!==g&&p.subscribeVideo(n,b,!1),S.includes(n)||d(Sf(n)),w&&d(Yf(void 0)),d(_f({userId:n,key:E,canvasId:m.id,videoQuality:y,aspectRatio:r?i/r:0}))}})),"failed"===I?Promise.reject({type:Sc,reason:"Video  decode status is failed"}):Promise.resolve("")})(this[QA],e,t,n,i,r,o,s,a,u)}stopRenderVideo(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;return function(e,t,n,i,r){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6?arguments[6]:void 0;const{store:{getState:a,dispatch:u},mediaAgent:l,rwgAgent:c}=e,d=a(),{video:{subscribedVideoList:h,renderedVideoList:p},meeting:{userId:f},media:{enforceVirtualBackground:g}}=d;if(h.includes(n)){const e=i||nu;if(tA(g)&&n===f&&t instanceof HTMLVideoElement)return t.pause(),u(bf(n)),u(ag(t.id)),Promise.resolve("");if(p.find((i=>i.userId===n&&i.key===e&&i.canvasId===t.id))&&(l.stopRenderVideo(t.id,n,e,WC(r),o),1==p.filter((e=>e.userId===n)).length&&(n!==f&&c.unsubscribeVideo(n),u(bf(n))),u(If({userId:n,key:e,canvasId:t.id}))),s&&f!==s){const{video:{subscribedVideoList:e,prefetchedVideo:t}}=a();UO(d).find((e=>e.userId===s))&&!e.includes(s)&&(null==t?void 0:t.userId)!==s&&u(Yf({userId:s,lastCopy:t}))}}return Promise.resolve("")}(this[QA],e,t,n,i,r,o)}updateVideoCanvasDimension(e,t,n){return((e,t,n,i)=>{const{mediaAgent:r}=e;return n>=0&&i>=0&&r.updateRenderedVideoCanvasDimension(t,n,i),Promise.resolve("")})(this[QA],e,t,n)}adjustRenderedVideoPosition(e,t,n,i,r,o,s){return((e,t,n,i,r,o,s,a)=>{const{store:{getState:u,dispatch:l},mediaAgent:c}=e,{video:{subscribedVideoList:d}}=u();if(d.includes(n)){if(t instanceof HTMLVideoElement)return Promise.resolve("");const e=a||nu;c.adjustRenderedVideoPosition(t.id,n,e,o,s,i,r,WC("#000")),l(_f({userId:n,key:e,canvasId:t.id,aspectRatio:r?i/r:0}))}else console.warn("Cannot adjust the size or position of the video as the video has not been rendered yet.");return Promise.resolve("")})(this[QA],e,t,n,i,r,o,s)}clearVideoCanvas(e,t){return((e,t,n)=>{const{mediaAgent:i}=e;return i.clearVideoCanvas(t.id,WC(n)),Promise.resolve("")})(this[QA],e,t)}mirrorVideo(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r}=e,{media:{enforceVirtualBackground:o},video:{isCurrentUserStartedVideo:s,virtualBackground:a,selfPreviewVideoList:u,customizedVideoOption:l,videoAttachments:c,isMirrored:d},meeting:{userId:h}}=n();if(d===t)return Promise.resolve("");if(s||null!=a&&a.isVBConfigured){if(tA(o)){const e=[];u.length>0&&u.forEach((t=>{e.push(document.getElementById(t))})),null!=l&&l.videoElement&&e.push(document.querySelector(null==l?void 0:l.videoElement)),c&&c[`${h}`]&&c[`${h}`].forEach((t=>{e.push(t.render.el)})),e.filter((e=>!!e)).forEach((e=>{e&&JC(e,t)}))}else r.mirrorVideo(t);i(og(t))}return Promise.resolve("")})(this[QA],e)}enableHardwareAcceleration(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r}=e,{video:{isSupportHDVideo:o}}=n();if("boolean"==typeof t||void 0!==t.decode){const e="boolean"==typeof t?t:!!t.decode;return e?Ls.isSupportVideoDecodeHardwareAcceleration().then((e=>(e&&r.enableHardwareAccelerationForVideoDecode(e),i(xf({decode:e})),e))):(r.enableHardwareAccelerationForVideoDecode(e),i(xf({decode:e})),Promise.resolve(!0))}if("boolean"==typeof t||void 0!==t.encode){const e="boolean"==typeof t?t:!!t.encode;if(o){if(!e)return r.enableHardwareAccelerationForVideoEncode(!1),i(xf({encode:!1})),Promise.resolve(!0);if(Ls.isCompatibleHardwareForEncode())return Ls.isSupportVideoEncodeHardwareAcceleration().then((e=>(e&&r.enableHardwareAccelerationForVideoEncode(e),i(xf({encode:e})),e)));console.warn("Can not turn on hardware acceleration with your graphic card due to the technical limitation")}else"boolean"!=typeof t&&null!=t&&t.encode&&console.warn("Can not use the hardware acceleration for video encoding due to the account restriction")}return Promise.resolve(!1)})(this[QA],e)}subscribeVideoStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{getState:i,dispatch:r}}=e,{media:{videoDecodeStatus:o,videoEncodeStatus:s},video:{subscriptionStatus:a}}=i(),u=!t||t.decode,l=!t||t.encode;return Rv("video",s,o).subscribe((e=>{let[i,o]=e;const s={};u&&o&&!a.decode&&(n.subscribeToQos([Ms.VideoDecode],eu),Object.assign(s,{decode:!0})),l&&i&&!a.encode&&(n.subscribeToQos([Ms.VideoEncode],eu),Object.assign(s,{encode:!0})),null!=t&&t.detailed&&o&&!a.detailed&&(n.enableVideoObserver(!0),Object.assign(s,{detailed:!0})),r(Zf(s))})),null})(this[QA],e)}unsubscribeVideoStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{dispatch:i}}=e,r=!t||t.decode,o=!t||t.encode,s={};return r&&(n.unsubscribeFromQos([Ms.VideoDecode]),i(Df(cu)),Object.assign(s,{decode:!1})),o&&(n.unsubscribeFromQos([Ms.VideoEncode]),i(kf(cu)),Object.assign(s,{encode:!1})),null!=t&&t.detailed&&(n.enableVideoObserver(!1),Object.assign(s,{detailed:!1})),i(Zf(s)),null})(this[QA],e)}previewVirtualBackground(e,t,n,i){return((e,t,n,i,r)=>{const{store:{getState:o,dispatch:s},mediaAgent:a}=e,u=o();return pA({imageUrl:n,cropped:i,cameraId:r},a,u,t).then((e=>("object"==typeof e&&null!=e&&e.type&&s(e),s(Pf({imageUrl:n,cropped:i})),!0))).catch((e=>Promise.reject({type:yc,reason:e})))})(this[QA],e,t,n,i)}updateVirtualBackgroundImage(e,t){return((e,t,n)=>{const{store:{getState:i,dispatch:r},mediaAgent:o}=e,s=i(),{video:{virtualBackground:{imageSrc:a,cropped:u},backgroundMode:l}}=s;return t===a&&n===u?Promise.resolve(!0):l===vu.Mask?Promise.reject({type:yc,reason:"Cannot update virtual background in the mask mode"}):pA({imageUrl:t,cropped:n},o,s).then((e=>("object"==typeof e&&null!=e&&e.type&&r(e),r(Pf({imageUrl:t,cropped:n})),!0))).catch((e=>Promise.reject({type:yc,reason:e})))})(this[QA],e,t)}stopPreviewVirtualBackground(){return(e=>{const{store:{getState:t},mediaAgent:n}=e,{video:{virtualBackground:{isVBConfigured:i}}}=t();return i?(n.stopVirtualBackgroundSetting(),Promise.resolve(!0)):Promise.reject({type:yc,reason:"Cannot stop preview virtual background before start"})})(this[QA])}previewVideoMask(e,t){return((e,t,n)=>{const{store:{getState:i,dispatch:r},mediaAgent:o}=e,s=i();return n.rootWidth&&n.rootHeight||Object.assign(n,{rootWidth:t.width,rootHeight:t.height}),fA(n,o,s,t).then((e=>("object"==typeof e&&null!=e&&e.type&&r(e),r(Gf(n)),!0))).catch((e=>Promise.reject({type:yc,reason:e})))})(this[QA],e,t)}updateVideoMask(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r}=e,o=n(),{video:{mask:s,backgroundMode:a}}=o,{isMaskConfigured:u}=s;if(a===vu.VirtualBackground)return Promise.reject({type:yc,reason:"Cannot update mask in the virtual background mode"});if(u){const e={...t};return["imageUrl","cropped","clip","rootHeight","rootWidth"].forEach((n=>{void 0===(null==t?void 0:t[n])&&("imageUrl"===n?Object.assign(e,{imageUrl:s.imageSrc}):Object.assign(e,{[`${n}`]:s[n]}))})),fA(e,r,o).then((t=>("object"==typeof t&&null!=t&&t.type&&i(t),i(Gf(e)),!0))).catch((e=>Promise.reject({type:yc,reason:e})))}return Promise.reject({type:yc,reason:"Cannot update mask"})})(this[QA],e)}stopPreviewVideoMask(){return(e=>{const{store:{getState:t},mediaAgent:n}=e,{video:{mask:{isMaskConfigured:i}}}=t();return i?(n.stopMaskSetting(),Promise.resolve(!0)):Promise.reject({type:yc,reason:"Cannot stop preview mask before start"})})(this[QA])}requestFarEndCameraControl(e){return((e,t)=>{const{store:{getState:n},rwgAgent:i}=e,r=n(),{meeting:{userId:o},video:{farEndCameraControlStatus:{controlledUserList:s}}}=r;return o===t?Promise.reject({type:yc,reason:'Using "stream.controlCamera" method to control self camera'}):-1!==HO(r).findIndex((e=>e.userId===t))?(s.includes(t)||i.sendFarEndCameraControl(du.Request,t),Promise.resolve("")):Promise.reject({type:_c,reason:"Cannot request control camera with video off"})})(this[QA],e)}approveFarEndCameraControl(e){return((e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r}=e,{video:{currentCameraControlStatus:{isRequested:o,isInControl:s,controllingUserId:a},ptz:u,activeCamera:l}}=n();if(o){if(s&&(!a||t===a))return Promise.resolve("");r.sendFarEndCameraControl(du.Approve,t);const e=null==u?void 0:u[l];return void 0!==e&&r.sendCameraAblity({pan:!!e.pan,tilt:!!e.tilt,zoom:!!e.zoom}),i(Lf(!1)),i(Vf({isInControl:!0,userId:t})),_d(tl,{isControlled:!0,userId:t}),Promise.resolve("")}return Promise.reject({type:yc,reason:"Cannot approve before request"})})(this[QA],e)}declineFarEndCameraControl(e){return((e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r}=e,{video:{currentCameraControlStatus:{isInControl:o,isRequested:s}}}=n();return s||o?(r.sendFarEndCameraControl(du.Decline,t),i(Lf(!1)),i(Vf({isInControl:!1,userId:0})),_d(tl,{isControlled:!1}),Promise.resolve("")):Promise.reject({type:yc,reason:"Cannot decline before request"})})(this[QA],e)}giveUpFarEndCameraControl(e){return((e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r}=e,{video:{farEndCameraControlStatus:{controlledUserList:o}}}=n();return o.includes(t)?(r.sendFarEndCameraControl(du.GiveUp,t),i(Bf(t)),Promise.resolve("")):Promise.reject({type:yc,reason:"Cannot give up control befire aquired"})})(this[QA],e)}controlCamera(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r}=e,{video:{isCurrentUserStartedVideo:o,ptz:s,activeCamera:a}}=n();if(o){const{cmd:e,range:n,reset:o}=t,u=s[a];if(u){const t=XC(u)||{},{key:s,range:l}=ZC(e,n);if(u[s])return Object.assign(t,{[s]:o?0:YC(u[s].capability,u[s].value,l)}),r.movePTZCamera(t).then((()=>{i(Hf({constraints:t,deviceId:a}))})).catch((e=>Promise.reject({type:yc,reason:e})))}return Promise.resolve("")}return Promise.reject({type:yc,reason:"Cannot control the camera before it's started"})})(this[QA],e)}controlFarEndCamera(e){return((e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r}=e,o=n(),{video:{farEndCameraControlStatus:{controlledUserList:s,isControlling:a}}}=o,{userId:u,cmd:l,range:c}=t;if(a)return Promise.reject({type:yc,reason:"Cannot send new command while the previous control is not done"});if(s.includes(u)){if(l===hu.SwitchCamera)return r.sendFarEndCameraControl(du.SwitchCamera,u,hu.SwitchCamera),Promise.resolve("");{const e=HO(o).find((e=>e.userId===u));if(null==e||!e.nFECC)return Promise.reject({type:yc,reason:"The far end camera does not support PTZ"});if(c&&c>0){const e=c/100*1e4;return r.sendFarEndCameraControl(du.StartControl,u,l),i(qf(!0)),ut(200).pipe(It(at(e-100))).subscribe((()=>{r.sendFarEndCameraControl(du.ContinueControl,u,l)})),je(at(e).pipe(At((()=>{r.sendFarEndCameraControl(du.StopControl,u,l),i(qf(!1))})))).then((()=>""))}return Promise.reject({type:_c,reason:"Range cannot be negative or 0"})}}return Promise.reject({type:yc,reason:"Cannot control before request granted"})})(this[QA],e)}attachVideo(e,t,n){return((e,t,n,i)=>{const{store:{getState:r,dispatch:o},rwgAgent:s}=e,a=r(),{meeting:{userId:u},media:{enforceMultipleVideos:l,alternativeNameForVideoPlayer:c,enforceVirtualBackground:d,disableRenderLimits:h},video:{videoAttachments:p,subscribedVideoList:f}}=a,g=$o(!!l,h);if(g>1&&f.length>g)throw Promise.reject({type:yc,reason:`subscribe video counts greater than maximum size (${g})`});if(-1===UO(a).findIndex((e=>e.userId===t)))return Promise.reject({type:_c,reason:"user is not send video"});const{media:{videoDecodeStatus:m}}=a;let v;const y=null!=c?c:"video-player";if(i){var S,b,E;if("string"==typeof i){if(v=document.querySelector(i),!v)return Promise.reject({type:"INVALID_PARAMETERS",reason:"Cannot find the element"})}else v=i;if((null===(S=v)||void 0===S||null===(b=S.tagName)||void 0===b?void 0:b.toUpperCase())!==y.toUpperCase())return Promise.reject({type:"INVALID_PARAMETERS",reason:"Invalid element type"});const e=Number(null!==(E=v.getAttribute("node-id"))&&void 0!==E?E:"0");if(e!==t&&tA(d)&&[e,t].includes(u)){var w;const t=document.createElement(y);for(const e of v.attributes)t.setAttribute(e.name,e.value);e&&(v.setAttribute("node-id","0"),o(tg({userId:e,element:v}))),null===(w=v.parentElement)||void 0===w||w.replaceChild(t,v),v=t}}else v=document.createElement(y);return Rv("video","success",m).subscribe((async e=>{let[i,a]=e;if(a){const[e,i]=iA(t,n,r()),a=p[`${t}`];var l;v&&a&&-1!==a.findIndex((e=>e===v))?v.setAttribute("video-quality",`${i}`):null===(l=v)||void 0===l||l.setAttribute("node-id",`${t}`),o(eg({userId:t,element:v})),t!==u&&s.subscribeVideo(t,i,!1),f.includes(t)||o(Sf(t)),o(_f({userId:t,key:nu,canvasId:au,videoQuality:e,aspectRatio:16/9}))}})),Promise.resolve(v)})(this[QA],e,t,n)}detachVideo(e,t){return((e,t,n)=>{const{store:{getState:i,dispatch:r},rwgAgent:o}=e,s=i(),{video:{subscribedVideoList:a,videoAttachments:u},meeting:{userId:l},media:{alternativeNameForVideoPlayer:c}}=s;if(a.includes(t)){let e;const s=null!=c?c:"video-player";var d,h;n&&(e="string"==typeof n?document.querySelector(n):n,(null===(d=e)||void 0===d||null===(h=d.tagName)||void 0===h?void 0:h.toUpperCase())!==s.toUpperCase()&&(e=void 0));const a=u[`${t}`];let f;if(a&&0!==a.length){var p;e?-1!==a.findIndex((t=>t===e))?(f=e,f.setAttribute("node-id","0"),r(tg({userId:t,element:f}))):console.warn(`${n} has not been attached with userID:${t}`):(f=[...a],f.forEach((e=>{e.setAttribute("node-id","0")})),r(tg({userId:t,element:f})));const{video:{videoAttachments:s,renderedVideoList:u}}=i();0===(null===(p=s[`${t}`])||void 0===p?void 0:p.length)&&(0===u.filter((e=>e.userId===t&&e.canvasId!==au)).length&&(t!==l&&o.unsubscribeVideo(t),r(bf(t))),r(If({userId:t,key:nu,canvasId:au})))}else console.warn(`UserId:${t} has not been attached.`);return Promise.resolve(f)}return Promise.resolve(void 0)})(this[QA],e,t)}isCapturingVideo(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.video&&n.video.isCurrentUserStartedVideo})(this[QA])}isCameraTaken(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.video&&n.video.isCameraTaken})(this[QA])}isCaptureForbidden(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.video&&n.video.isCaptureForbidden})(this[QA])}getCameraList(){return(e=>{const{store:{getState:t}}=e,n=t();if(!n.video)return[];const{video:{cameraDevicesList:i}}=n;return i.map((e=>Object.assign({},e)))})(this[QA])}getActiveCamera(){return(e=>{const{store:{getState:t}}=e,n=t();return n.video?n.video.activeCamera:""})(this[QA])}getActiveVideoId(){return(e=>{const{store:{getState:t}}=e,n=t();return n.video?n.video.activeVideoId:0})(this[QA])}getVideoMaxQuality(){return(e=>{const{store:{getState:t}}=e,n=t();return n.video?n.video.receivedVideoMaxQuality:Ka.Video_90P})(this[QA])}getReceivedVideoDimension(){return(e=>{const{store:{getState:t}}=e,n=t();return n.video?n.video.receivedVideoDimension:null})(this[QA])}getCapturedVideoResolution(){return(e=>{const{store:{getState:t}}=e;return{...t().video.capturedVideoDimension}})(this[QA])}isSupportMultipleVideos(){return(e=>{const{store:{getState:t}}=e,{media:{enforceMultipleVideos:n}}=t();return Ko()||!!n&&!window.crossOriginIsolated&&$o(n)>1})(this[QA])}isSupportHDVideo(){return(e=>{var t;const{store:{getState:n}}=e;return null===(t=n().video)||void 0===t?void 0:t.isSupportHDVideo})(this[QA])}getHardwareAccelerationStatus(){return(e=>{var t;const{store:{getState:n}}=e;return null===(t=n().video)||void 0===t?void 0:t.hardwareAcceleration})(this[QA])}getVideoStatisticData(){return(e=>{let{store:{getState:t}}=e;const{video:{statistic:n}}=t();return{...n}})(this[QA])}isSupportVirtualBackground(){return(e=>{const{store:{getState:t}}=e;return Vv(t().media.enforceVirtualBackground)})(this[QA])}getVirtualbackgroundStatus(){return(e=>{const{store:{getState:t}}=e;return{...t().video.virtualBackground}})(this[QA])}isRenderSelfViewWithVideoElement(){return tA(this[WA].getState().media.enforceVirtualBackground)}getNetworkQuality(e){return((e,t)=>{var n;const{store:{getState:i}}=e,r=i(),{video:o,meeting:{userId:s}}=r,a=null!=t?t:s,u=null==o||null===(n=o.networkQuality)||void 0===n?void 0:n[`${a}`];if(u){const e={};return u.uplink&&Object.assign(e,{uplink:u.uplink.level}),u.downlink&&Object.assign(e,{downlink:u.downlink.level}),e}return null})(this[QA],e)}getFarEndCameraPTZCapability(e){return((e,t)=>{const{store:{getState:n}}=e,i=HO(n()).find((e=>e.userId===t));return void 0!==(null==i?void 0:i.nFECC)?eA(null==i?void 0:i.nFECC):{pan:!1,tilt:!1,zoom:!1}})(this[QA],e)}getCameraPTZCapability(e){return((e,t)=>{const{store:{getState:n}}=e,{video:{ptz:i,activeCamera:r}}=n(),o=i[null!=t?t:r];return{pan:!(null==o||!o.pan),tilt:!(null==o||!o.tilt),zoom:!(null==o||!o.zoom)}})(this[QA],e)}isBrowserSupportPTZ(){const{pan:e,tilt:t,zoom:n}=Ls.getPTZCapability();return e||t||n}getVideoMaskStatus(){return(e=>{var t;const{store:{getState:n}}=e,i=n(),{isMaskConfigured:r,imageSrc:o,...s}=(null===(t=i.video)||void 0===t?void 0:t.mask)||{};return{...s,imageUrl:o}})(this[QA])}isVideoMirrored(){return(e=>{const{store:{getState:t}}=e,{video:{isMirrored:n}}=t();return n})(this[QA])}startShareView(e,t,n){return((e,t,n,i)=>{const{store:{getState:r,dispatch:o},mediaAgent:s,rwgAgent:a}=e,{share:{isReceiveSharing:u,isRemoteSharingActive:l,activeNodeId:c,activeSsrc:d,status:h,renderedEnsuredCanvas:p,isReceiveSharingFromMainSession:f},media:{sharingDecodeStatus:g}}=r();if(!t||n!==c)return Promise.reject({type:_c,reason:""});if(!l||u||h!==qa.End)return Promise.reject({type:yc,reason:""});t.id||(t.id=fr("__ZOOM_SDK_SHARE_CANVAS_@__"));const m=!!i;return Rv("sharing","success",g).subscribe((e=>{let[,u]=e;if(u){let e=t;p.includes(t.id)||(e=xv(t),o(Hp(t.id))),o(_p(!0)),ob(a,r(),n),s.renderSharing(d,e,m,i,f);const{audio:u}=r();if(null!=u&&u.localShareAudioUserMutedList){const e=u.localShareAudioUserMutedList.find((e=>e.userId===n));e&&s.setSharingAudioVolume(n,e.muted,e.isFromMainSession)}}})),"failed"===g?Promise.reject({type:Sc,reason:""}):Cd(Wl,(e=>!!e),6e4)})(this[QA],e,t,n)}stopShareView(){return(e=>{const{store:{dispatch:t,getState:n},rwgAgent:i,mediaAgent:r}=e,{share:{isReceiveSharing:o,activeNodeId:s},breakoutRoom:a}=n();if(!o)return Promise.resolve("");let u=!1;return(null==a?void 0:a.currentRoom.status)===rh.InRoom&&a.mainSessionAttendeeList.length>0&&(u=a.mainSessionAttendeeList.findIndex((e=>e.userId===s))>-1),r.stopRenderSharing(),i.unsubscribeSharing(s,u),t(_p(!1)),Promise.resolve("")})(this[QA])}switchShareView(e){return((e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r,mediaAgent:o}=e,s=n(),{share:{isReceiveSharing:a,activeNodeId:u,isReceiveSharingFromMainSession:l,remoteControlledUserList:c,isGrabRemoteControl:d},audio:h,breakoutRoom:p}=s;if(!a)return Promise.reject({type:yc});if(t===u)return Promise.resolve("");let f=[];return f=l?p.mainSessionAttendeeList.filter((e=>e.bShareToBORooms&&e.sharerOn)):hy(s),f.findIndex((e=>e.userId===u))>-1?(c.includes(u)&&(d&&r.subscribeGrabRemoteControl(u,!1),o.updateRemoteControlProperties({isControllerNow:!1})),r.unsubscribeSharing(u,l),ob(r,n(),t),o.switchSharingSource(t,l),c.includes(t)&&hb(t,void 0,s,r,o),null==h||h.localShareAudioUserMutedList.forEach((e=>{o.setSharingAudioVolume(t,e.userId!==t||e.muted,e.isFromMainSession)})),i(wp({bStatus:1,activeNodeID:t,ssrc:t})),_d(ec,{userId:t}),Promise.resolve("")):Promise.reject({type:_c,reason:"no matching user id"})})(this[QA],e)}updateSharingCanvasDimension(e,t){return((e,t,n)=>{const{store:{getState:i},mediaAgent:r}=e,o=i(),{share:{isReceiveSharing:s,isGrabRemoteControl:a,remoteControlViewportDomSelector:u}}=o;if(s&&(r.updateRenderedSharingDimension(t,n),a&&u)){const e=document.querySelector(u);r.updateRemoteControlProperties({dimension:e&&kv(e)})}return Promise.resolve("")})(this[QA],e,t)}startShareScreen(e,t){return((e,t,n)=>{var i;const{store:{getState:r,dispatch:o},mediaAgent:s}=e,a=r(),{meeting:{bIbDisableShare:u,meetingOptions:l},share:{sharePrivilege:c,ssrc:d,isChromeExtensionInstalled:h,capturedEnsuredCanvas:p,isReceiveSharingFromMainSession:f},media:{sharingEncodeStatus:g},breakoutRoom:m}=a,{isSupportMediaStreamTrackProcessor:v,isLegacyChrome:y}=Uo;if(u)return Promise.reject({type:yc,reason:"information barrier"});if("function"!=typeof(null===(i=navigator.mediaDevices)||void 0===i?void 0:i.getDisplayMedia))return Promise.reject({type:yc,reason:"Unable to share your screen due to the technical limitation"});if(f)return Promise.reject({type:yc,reason:"Unable to share your screen while someone is sharing from the main session"});var S;if(v){if(!(t instanceof HTMLVideoElement))return Promise.reject({type:_c,reason:"Use Video element instead of Canvas element when WebCodecs enabled"})}else if(!(t instanceof HTMLCanvasElement))return Promise.reject({type:_c,reason:`Expected to accept HTMLCanvasElement, but actual it is ${"object"==typeof t&&null!==t?null===(S=Object.getPrototypeOf(t))||void 0===S?void 0:S.constructor.name:t}`});const b=mh(a);if(null!=n&&n.broadcastToBreakoutRoom){if(!b||(null==m?void 0:m.currentRoom.status)===rh.InRoom)return b?Promise.reject({type:yc,reason:"Unable to share screen to breakout room when in the room"}):Promise.reject({type:Ec});o(Np(!0))}else o(Np(!1));void 0!==(null==n?void 0:n.requestReadReceipt)&&o(Lp(null==n?void 0:n.requestReadReceipt)),void 0!==(null==n?void 0:n.optimizedForSharedVideo)&&c!==Ha.MultipleShare&&o(Vp((null==n?void 0:n.optimizedForSharedVideo)&&Ls.isSupportVideoShareSend()));const E=hy(a);if(c===Ha.OnlyHost&&!b)return Promise.reject({type:Ec,reason:"only host can start screen share"});if(c===Ha.HostGrab&&!b&&E.length>0)return Promise.reject({type:Ec,reason:"only host can grab screen share"});const w=gh(a);if(!0===(null==w?void 0:w.sharerOn))return Promise.reject({type:yc,reason:"you have already started screen share."});let _=Fe(!0);return y&&!h&&(s.checkChromeSharingExtension(),_=Ad(ql,1)),t.id||(t.id=fr("__ZOOM_SDK_SELF_SHARE_CANVAS_@__")),et([Rv("sharing",g,"success"),_]).subscribe((e=>{let[i,r]=e;const[a]=i;if(a&&r){p.includes(t.id)||(xv(t),o(Up(t.id)));let e=document.querySelector(`#${tu}`);e&&"VIDEO"===e.tagName||(e=document.createElement("video"),e.id=tu,e.style.display="none",document.body.appendChild(e));const i=null!=n&&n.secondaryCameraId?{cameraId:n.secondaryCameraId,width:n.captureWidth,height:n.captureHeight}:void 0,r=!(null!=n&&n.hideShareAudioOption);s.startDesktopSharing(d,t,e,i,null!=l&&l.isDisableShareAudioIntoBo?r&&!(null!=n&&n.broadcastToBreakoutRoom):r,null==n?void 0:n.displaySurface,null==n?void 0:n.sourceId,null==n?void 0:n.controls),o(yp(void 0)),o(Mp(!!i))}})),new Promise(((e,t)=>{pt(Ad(js).pipe(ht((e=>void 0!==e.sharerOn)),gt(1)),Ad(ql).pipe(ht((e=>!e)),gt(1),St(Le({reason:"required extension",extensionUrl:"https://chrome.google.com/webstore/detail/zoom-scheduler/kgjfgplpablkjnlkjmjdecgdpfankdle"}))),Ad(Kl,1).pipe(Ye((e=>Le({reason:e.reason||"user deny screen share"}))))).subscribe((n=>{if(!0===n.sharerOn){const{share:{isSharingToBreakoutRoom:t},meeting:{meetingOptions:n}}=r(),i=!(null!=n&&n.isDisableShareAudioIntoBo||!t);s.enableShareAudioToBreakoutRoom(i),e("")}else t({type:Sc})}),(e=>{t({type:yc,...e})}))}))})(this[QA],e,t)}stopShareScreen(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:i,mediaAgent:r}=e,{share:{status:o},meeting:{userId:s}}=t();return o===qa.End?Promise.resolve(""):(n(Tp(qa.End)),i.stopSharing(s),r.stopDesktopSharing(),Cd(js,(e=>!1===e.sharerOn)))})(this[QA])}pauseShareScreen(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:i,mediaAgent:r}=e,{share:{status:o}}=t();return o===qa.Sharing?(i.pauseSharing(),r.pauseDesktopSharing(),Cd(js,(e=>!0===e.sharerPause)).then((()=>(n(Tp(qa.Paused)),"")))):Promise.reject({type:yc})})(this[QA])}resumeShareScreen(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:i,mediaAgent:r}=e,{share:{status:o}}=t();return o===qa.Paused?(i.resumeSharing(),r.resumeDesktopSharing(),Cd(js,(e=>!0===e.sharerOn&&!1===e.sharerPause)).then((()=>(n(Tp(qa.Sharing)),"")))):Promise.reject({type:yc})})(this[QA])}setSharePrivilege(e){return BO(this[QA],e)}lockShare(e){return((e,t)=>BO(e,t?Ha.OnlyHost:Ha.HostGrab))(this[QA],e)}shareToBreakoutRoom(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:i,mediaAgent:r}=e,{meeting:{userId:o},breakoutRoom:s,share:{isSharingToBreakoutRoom:a,status:u}}=t();return u===qa.End?Promise.reject({type:yc,reason:"Invalid sharing status"}):a?Promise.resolve(""):s.currentRoom.status===rh.InRoom?Promise.reject({type:yc,reason:"Unable to share screen to breakout room when in the room"}):(i.startShareToBreakoutRoom(o),n(Np(!0)),r.enableShareAudioToBreakoutRoom(!0),Promise.resolve(""))})(this[QA])}stopShareToBreakoutRoom(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:i,mediaAgent:r}=e,{meeting:{userId:o},share:{isSharingToBreakoutRoom:s}}=t();return s&&(i.stopShareToBreakoutRoom(o),n(Np(!1)),r.enableShareAudioToBreakoutRoom(!1)),Promise.resolve("")})(this[QA])}muteOthersScreenShare(e){return((e,t)=>{const{store:{getState:n},rwgAgent:i}=e,r=n(),{meeting:{userId:o}}=r,s=hy(r);return t===o?Promise.reject({type:yc,reason:"Cannot mute self share, use 'stopScreenShare' instead"}):-1===s.findIndex((e=>e.userId===t))?Promise.reject({type:_c,reason:"Target user is not sharing"}):(i.stopSharing(t),Cd(Us,(e=>e.some((e=>e.userId===t&&!1===e.sharerOn)))))})(this[QA],e)}enableOptimizeForSharedVideo(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r,rwgAgent:o}=e,{share:{status:s,isOptimizedForSharedVideo:a,isSharingToBreakoutRoom:u,sharePrivilege:l},audio:{isSharingAudio:c},meeting:{userId:d}}=n();return s!==qa.End?a===t?Promise.resolve(""):l!==Ha.MultipleShare?t&&!Ls.isSupportVideoShareSend()?Promise.reject({type:yc,reason:"Cannot enable optimize for shared video due to the platform is not supported "}):(o.startSharing(d,{bShareAudio:c,bShareToBO:u,bShareVideo:t}),r.switchSharingMode(t?mu.VideoMode:mu.Normal),Cd({event:js,operations:[ht((e=>void 0!==e.bVideoShare)),gt(1)]},(e=>e.bVideoShare===t)).then((()=>(i(Vp(t)),"")))):Promise.reject({type:yc,reason:"Cannot enable optimize for shared video when enabling multiple screen shares"}):Promise.reject({type:yc,reason:"Cannot enable optimize for shared video when screen share is not started"})})(this[QA],e)}updateSharedVideoQuality(e){return((e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r}=e,o=n(),{share:{shareQuality:s,activeNodeId:a,isReceiveSharing:u}}=o,l=py(o);return u&&0!==a?(l&&s!==t&&(ob(r,o,a,t),i(Op(t))),Promise.resolve("")):Promise.reject({type:yc,reason:"Cannot update shared video quality when screen share is not started"})})(this[QA],e)}subscribeShareStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{getState:i}}=e,r=i(),{media:{sharingEncodeStatus:o,sharingDecodeStatus:s}}=i(),a=gh(r),u=!t||t.decode,l=!t||t.encode;if(!a)return Promise.reject({type:yc,reason:"Call this function after the 'join' method resolved."});{const e=eh(a.userRole)||!Uo.isSupportSendScreenSharing?"failed":o;Rv("sharing",e,s).subscribe((e=>{let[t,i]=e;t&&i&&(u&&n.subscribeToQos([Ms.SharingDecode],eu),l&&n.subscribeToQos([Ms.SharingEncode],eu))}))}return""})(this[QA],e)}unsubscribeShareStatisticData(e){return(async(e,t)=>{const{mediaAgent:n,store:{dispatch:i}}=e,r=!t||t.decode,o=!t||t.encode;return r&&(n.unsubscribeFromQos([Ms.SharingDecode]),i(Bp(cu))),o&&(n.unsubscribeFromQos([Ms.SharingEncode]),i(Bp(cu))),null})(this[QA],e)}getShareUserList(){return(e=>{const{store:{getState:t}}=e,n=t();if(!n.share)return[];const{share:{isReceiveSharingFromMainSession:i}}=n;if(i){const{breakoutRoom:{mainSessionAttendeeList:e}}=n;return e.filter((e=>e.bShareToBORooms&&(e.sharerOn||e.sharerPause))).map((e=>lT(e)))}return hy(n).map((e=>lT(e)))})(this[QA])}getActiveShareUserId(){return(e=>{const{store:{getState:t}}=e,n=t();return n.share&&n.share.isRemoteSharingActive?n.share.activeNodeId:0})(this[QA])}isReceiveSharing(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.isReceiveSharing})(this[QA])}getShareViewDimension(){return(e=>{const{store:{getState:t}}=e,n=t();if(n.share){if(n.share.status!==qa.End)return{...n.share.shareDimension};{const{share:{receivedShareDimension:e}}=n;return{width:e.width,height:e.height}}}return null})(this[QA])}getShareStatus(){return(e=>{const{store:{getState:t}}=e,n=t();return n.share?n.share.status:null})(this[QA])}isShareLocked(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.sharePrivilege===Ha.OnlyHost})(this[QA])}isReceiveSharingFromMainSession(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.isReceiveSharingFromMainSession})(this[QA])}getSharePrivilege(){return(e=>{const{store:{getState:t}}=e,n=t();return n.share?n.share.sharePrivilege:null})(this[QA])}isStartShareScreenWithVideoElement(){return Uo.isSupportMediaStreamTrackProcessor}isOptimizeForSharedVideoEnabled(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.isOptimizedForSharedVideo})(this[QA])}isSupportOptimizedForSharedVideo(){return Ls.isSupportVideoShareSend()}getShareStatisticData(){return(e=>{let{store:{getState:t}}=e;const{share:{statistic:n}}=t();return{...n}})(this[QA])}requestRemoteControl(){return(e=>{const{store:{getState:t},rwgAgent:n}=e,{share:{isReceiveSharing:i,activeNodeId:r,isRemoteControlEnabled:o}}=t();return o?qO(e,r)?i?fy(t())?Promise.reject({type:yc,reason:"Already get the approval"}):(n.sharingRequestRemoteControl(r,!0),new Promise((e=>{Ad(tc,1).subscribe((t=>{e(t)}))}))):Promise.reject({type:yc,reason:"Cannot request control due to no sharing available"}):Promise.reject({type:_c}):Promise.reject({type:yc,reason:"Cannot request control due to the feature is not enabled."})})(this[QA])}giveUpRemoteControl(){return(e=>{const{store:{getState:t},rwgAgent:n}=e,{share:{isGrabRemoteControl:i,activeNodeId:r}}=t();return fy(t())?(i&&n.subscribeGrabRemoteControl(r,!1),n.sharingRequestRemoteControl(r,!1),Cd(tc,(e=>!1===e))):Promise.reject({type:yc})})(this[QA])}startRemoteControl(e){return(async(e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r,rwgAgent:o}=e,{share:{isSDKGrabControl:s,activeNodeId:a}}=n();return fy(n())?(await hb(a,t,n(),o,r),t.dataset.zmrvId||t.setAttribute("data-zmrv-id",fr("__ZOOM_SDK_RC_VIEWPORT_DATA_ID_@__")),i(nf(`${t.tagName}[data-zmrv-id="${t.dataset.zmrvId}"]`)),s?Cd(nc,(e=>!!e)):Id({success:rc,fail:[oc]})):Promise.reject({type:yc,reason:"required to be approved"})})(this[QA],e)}grabRemotoControl(){return(e=>{const{store:{getState:t},rwgAgent:n}=e,{share:{isGrabRemoteControl:i,activeNodeId:r}}=t();return fy(t())?i?Promise.resolve(""):(n.subscribeGrabRemoteControl(r,!0),Cd(nc,(e=>!!e))):Promise.reject({type:yc,reason:"should be approved before grab"})})(this[QA])}updateRemoteControlViewportDimension(e){return((e,t)=>{const{store:{getState:n},mediaAgent:i}=e;return fy(n())&&i.updateRemoteControlProperties({dimension:{scaleWidth:t.width,scaleHeight:t.height,srcOffsetX:t.left,srcOffsetY:t.top}}),Promise.resolve("")})(this[QA],e)}approveRemoteControl(e){return((e,t)=>{const{store:{getState:n,dispatch:i},rwgAgent:r,mediaAgent:o}=e,s=n(),{share:{status:a,isEnableAutoDeleteRcApp:u,remoteControllingSsrc:l,userSsrcMapping:c},meeting:{userId:d}}=s;if(a===qa.End)return Promise.reject({type:yc,reason:"Cannot approve remote control when sharing is not ongoing."});if(a===qa.Paused&&(r.resumeSharing(),o.resumeDesktopSharing(),i(Tp(qa.Sharing))),o.isSharingEntireScreen()){var h;l&&!hr(l,t)&&(db(s,r),i(Yp("")));const e=null!==(h=c[`${t}`])&&void 0!==h?h:t;return r.remoteControlConsent(Su.Approve,e,d,{...o.getShareStreamInfo(),platform:Uo.isMacOS?"mac":"win"},u),i($p(e)),Cd(hc)}return Promise.reject({type:yc,reason:"Cannot approve remote control when not sharing entire screen."})})(this[QA],e)}declineRemoteControl(e){return((e,t)=>{var n;const{store:{getState:i},rwgAgent:r,mediaAgent:o}=e,s=i(),{meeting:{userId:a},share:{isEnableAutoDeleteRcApp:u,userSsrcMapping:l}}=s,c=null!==(n=l[`${t}`])&&void 0!==n?n:t;return r.remoteControlConsent(Su.Decline,c,a,{...o.getShareStreamInfo(),platform:Uo.isMacOS?"mac":"win"},u),Promise.resolve("")})(this[QA],e)}stopRemoteControl(){return(e=>{const{store:{getState:t,dispatch:n},rwgAgent:i}=e;return db(t(),i),n(Yp("")),n($p(0)),Promise.resolve("")})(this[QA])}launchRemoteControlApp(e){return((e,t)=>{const{store:{getState:n,dispatch:i}}=e,r=n(),{share:{remoteControlAppLaunchSheme:o}}=r;return o?(i(Yp(t?`${o}&bAutoDelete=1`:o)),i(Gp(bu.Unknown)),Promise.resolve("")):Promise.reject({type:yc,reason:"Cannot launch app due to no permission"})})(this[QA],e)}isRemoteControlEnabled(){return(e=>{var t;const{store:{getState:n}}=e;return!(null===(t=n().share)||void 0===t||!t.isRemoteControlEnabled)})(this[QA])}getRemoteControlAppDownloadUrl(){return(e=>{const{store:{getState:t}}=e,n=t();return n.share?n.share.remoteControlAppDownloadUrl:null})(this[QA])}isTargetShareSupportRemoteControl(e){return qO(this[QA],e)}isRemotelyControlApproved(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&fy(n)})(this[QA])}isControllingUserRemotely(){return(e=>{const{store:{getState:t}}=e,n=t();return!!n.share&&n.share.isGrabRemoteControl})(this[QA])}getRemotelyControllingUser(){return(e=>{const{store:{getState:t}}=e,n=t();if(n.share){const{remoteControllingSsrc:e}=n.share;if(e)return bh(n).find((t=>hr(t.userId,e)))}return null})(this[QA])}},$A(fD.prototype,"startAudio",[YA,KO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"startAudio"),fD.prototype),$A(fD.prototype,"stopAudio",[YA,$O,gD],Object.getOwnPropertyDescriptor(fD.prototype,"stopAudio"),fD.prototype),$A(fD.prototype,"muteAudio",[YA,WO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"muteAudio"),fD.prototype),$A(fD.prototype,"unmuteAudio",[YA,GO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"unmuteAudio"),fD.prototype),$A(fD.prototype,"dialOut",[YA,zO,JO],Object.getOwnPropertyDescriptor(fD.prototype,"dialOut"),fD.prototype),$A(fD.prototype,"cancelDialOut",[YA,QO,YO],Object.getOwnPropertyDescriptor(fD.prototype,"cancelDialOut"),fD.prototype),$A(fD.prototype,"hangup",[YA,ZO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"hangup"),fD.prototype),$A(fD.prototype,"switchMicrophone",[YA,XO,gD],Object.getOwnPropertyDescriptor(fD.prototype,"switchMicrophone"),fD.prototype),$A(fD.prototype,"switchSpeaker",[YA,eP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"switchSpeaker"),fD.prototype),$A(fD.prototype,"muteShareAudio",[YA,tP,nP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"muteShareAudio"),fD.prototype),$A(fD.prototype,"unmuteShareAudio",[YA,iP,rP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"unmuteShareAudio"),fD.prototype),$A(fD.prototype,"subscribeAudioStatisticData",[YA,oP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"subscribeAudioStatisticData"),fD.prototype),$A(fD.prototype,"unsubscribeAudioStatisticData",[YA,sP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"unsubscribeAudioStatisticData"),fD.prototype),$A(fD.prototype,"enableBackgroundNoiseSuppression",[YA,aP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"enableBackgroundNoiseSuppression"),fD.prototype),$A(fD.prototype,"enableSyncButtonsOnHeadset",[YA,uP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"enableSyncButtonsOnHeadset"),fD.prototype),$A(fD.prototype,"enableOriginalSound",[YA,lP,gD],Object.getOwnPropertyDescriptor(fD.prototype,"enableOriginalSound"),fD.prototype),$A(fD.prototype,"callCRCDevice",[YA,cP,dP],Object.getOwnPropertyDescriptor(fD.prototype,"callCRCDevice"),fD.prototype),$A(fD.prototype,"cancelCallCRCDevice",[YA,hP,pP],Object.getOwnPropertyDescriptor(fD.prototype,"cancelCallCRCDevice"),fD.prototype),$A(fD.prototype,"muteAllAudio",[ZA,YA,fP],Object.getOwnPropertyDescriptor(fD.prototype,"muteAllAudio"),fD.prototype),$A(fD.prototype,"unmuteAllAudio",[ZA,YA,gP],Object.getOwnPropertyDescriptor(fD.prototype,"unmuteAllAudio"),fD.prototype),$A(fD.prototype,"startVideo",[YA,mP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"startVideo"),fD.prototype),$A(fD.prototype,"stopVideo",[YA,vP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"stopVideo"),fD.prototype),$A(fD.prototype,"switchCamera",[YA,yP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"switchCamera"),fD.prototype),$A(fD.prototype,"renderVideo",[ED,YA,SP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"renderVideo"),fD.prototype),$A(fD.prototype,"stopRenderVideo",[_D,YA,bP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"stopRenderVideo"),fD.prototype),$A(fD.prototype,"updateVideoCanvasDimension",[wD,YA,EP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"updateVideoCanvasDimension"),fD.prototype),$A(fD.prototype,"adjustRenderedVideoPosition",[_D,YA,wP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"adjustRenderedVideoPosition"),fD.prototype),$A(fD.prototype,"clearVideoCanvas",[wD,YA,_P,mD],Object.getOwnPropertyDescriptor(fD.prototype,"clearVideoCanvas"),fD.prototype),$A(fD.prototype,"mirrorVideo",[YA,IP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"mirrorVideo"),fD.prototype),$A(fD.prototype,"enableHardwareAcceleration",[YA,CP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"enableHardwareAcceleration"),fD.prototype),$A(fD.prototype,"subscribeVideoStatisticData",[YA,AP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"subscribeVideoStatisticData"),fD.prototype),$A(fD.prototype,"unsubscribeVideoStatisticData",[YA,TP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"unsubscribeVideoStatisticData"),fD.prototype),$A(fD.prototype,"previewVirtualBackground",[bD,YA,RP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"previewVirtualBackground"),fD.prototype),$A(fD.prototype,"updateVirtualBackgroundImage",[YA,OP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"updateVirtualBackgroundImage"),fD.prototype),$A(fD.prototype,"stopPreviewVirtualBackground",[YA,PP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"stopPreviewVirtualBackground"),fD.prototype),$A(fD.prototype,"previewVideoMask",[bD,YA,DP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"previewVideoMask"),fD.prototype),$A(fD.prototype,"updateVideoMask",[YA,kP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"updateVideoMask"),fD.prototype),$A(fD.prototype,"stopPreviewVideoMask",[YA,xP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"stopPreviewVideoMask"),fD.prototype),$A(fD.prototype,"requestFarEndCameraControl",[YA,NP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"requestFarEndCameraControl"),fD.prototype),$A(fD.prototype,"approveFarEndCameraControl",[YA,MP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"approveFarEndCameraControl"),fD.prototype),$A(fD.prototype,"declineFarEndCameraControl",[YA,FP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"declineFarEndCameraControl"),fD.prototype),$A(fD.prototype,"giveUpFarEndCameraControl",[YA,LP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"giveUpFarEndCameraControl"),fD.prototype),$A(fD.prototype,"controlCamera",[YA,VP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"controlCamera"),fD.prototype),$A(fD.prototype,"controlFarEndCamera",[YA,jP,yD],Object.getOwnPropertyDescriptor(fD.prototype,"controlFarEndCamera"),fD.prototype),$A(fD.prototype,"attachVideo",[YA,BP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"attachVideo"),fD.prototype),$A(fD.prototype,"detachVideo",[YA,UP,mD],Object.getOwnPropertyDescriptor(fD.prototype,"detachVideo"),fD.prototype),$A(fD.prototype,"startShareView",[bD,YA,HP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"startShareView"),fD.prototype),$A(fD.prototype,"stopShareView",[YA,qP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"stopShareView"),fD.prototype),$A(fD.prototype,"switchShareView",[YA,KP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"switchShareView"),fD.prototype),$A(fD.prototype,"updateSharingCanvasDimension",[YA,$P,vD],Object.getOwnPropertyDescriptor(fD.prototype,"updateSharingCanvasDimension"),fD.prototype),$A(fD.prototype,"startShareScreen",[YA,WP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"startShareScreen"),fD.prototype),$A(fD.prototype,"stopShareScreen",[YA,GP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"stopShareScreen"),fD.prototype),$A(fD.prototype,"pauseShareScreen",[YA,zP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"pauseShareScreen"),fD.prototype),$A(fD.prototype,"resumeShareScreen",[YA,JP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"resumeShareScreen"),fD.prototype),$A(fD.prototype,"setSharePrivilege",[ZA,QP,YA,vD],Object.getOwnPropertyDescriptor(fD.prototype,"setSharePrivilege"),fD.prototype),$A(fD.prototype,"lockShare",[ZA,YP,YA,vD],Object.getOwnPropertyDescriptor(fD.prototype,"lockShare"),fD.prototype),$A(fD.prototype,"shareToBreakoutRoom",[YA,ZA,ZP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"shareToBreakoutRoom"),fD.prototype),$A(fD.prototype,"stopShareToBreakoutRoom",[YA,ZA,XP,vD],Object.getOwnPropertyDescriptor(fD.prototype,"stopShareToBreakoutRoom"),fD.prototype),$A(fD.prototype,"muteOthersScreenShare",[YA,ZA,eD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"muteOthersScreenShare"),fD.prototype),$A(fD.prototype,"enableOptimizeForSharedVideo",[YA,tD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"enableOptimizeForSharedVideo"),fD.prototype),$A(fD.prototype,"updateSharedVideoQuality",[YA,nD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"updateSharedVideoQuality"),fD.prototype),$A(fD.prototype,"subscribeShareStatisticData",[YA,iD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"subscribeShareStatisticData"),fD.prototype),$A(fD.prototype,"unsubscribeShareStatisticData",[YA,rD,vD],Object.getOwnPropertyDescriptor(fD.prototype,"unsubscribeShareStatisticData"),fD.prototype),$A(fD.prototype,"requestRemoteControl",[YA,oD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"requestRemoteControl"),fD.prototype),$A(fD.prototype,"giveUpRemoteControl",[YA,sD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"giveUpRemoteControl"),fD.prototype),$A(fD.prototype,"startRemoteControl",[YA,aD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"startRemoteControl"),fD.prototype),$A(fD.prototype,"grabRemotoControl",[YA,uD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"grabRemotoControl"),fD.prototype),$A(fD.prototype,"updateRemoteControlViewportDimension",[YA,lD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"updateRemoteControlViewportDimension"),fD.prototype),$A(fD.prototype,"approveRemoteControl",[YA,cD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"approveRemoteControl"),fD.prototype),$A(fD.prototype,"declineRemoteControl",[YA,dD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"declineRemoteControl"),fD.prototype),$A(fD.prototype,"stopRemoteControl",[YA,hD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"stopRemoteControl"),fD.prototype),$A(fD.prototype,"launchRemoteControlApp",[YA,pD,SD],Object.getOwnPropertyDescriptor(fD.prototype,"launchRemoteControlApp"),fD.prototype),fD);var CD,AD,TD,RD,OD,PD,DD,kD,xD;const ND=oT("Audio"),MD=oT("Sharing");let FD=(CD=eT("share"),AD=eT("audio"),TD=eT("audio"),RD=eT("audio"),OD=eT("audio"),PD=eT("audio"),DD=eT("audio"),kD=eT("audio"),xD=class extends ID{switchSharingSecondaryCamera(e){return((e,t)=>{const{store:{getState:n,dispatch:i},mediaAgent:r}=e,o=n(),{video:{cameraDevicesList:s},share:{status:a,isSharingWithSecondCamera:u}}=o;return"default"!==t&&-1===s.map((e=>e.deviceId)).indexOf(t)?Promise.reject({type:_c,reason:"Cannot find cameraDeviceId in camera devices list."}):(a===qa.Sharing&&u&&r.changeSharingSecondCamera(t),i(Fp(t)),Promise.resolve())})(this[QA],e)}muteUserAudioLocally(e){return((e,t)=>{const{mediaAgent:n,store:{getState:i,dispatch:r}}=e,o=i(),{audio:{locallyMutedAudioList:s}}=o,a=bh(o).filter((e=>e.audio===yu.Computer));return s.includes(t)||-1===a.findIndex((e=>e.userId===t))||(n.muteOrUnmuteOtherAudio(t,!0),r(ip(t))),Promise.resolve("")})(this[QA],e)}unmuteUserAudioLocally(e){return((e,t)=>{const{mediaAgent:n,store:{getState:i,dispatch:r}}=e,{audio:{locallyMutedAudioList:o}}=i();return o.includes(t)?(n.muteOrUnmuteOtherAudio(t,!1),r(rp(t)),Promise.resolve("")):Promise.resolve("")})(this[QA],e)}adjustUserAudioVolumeLocally(e,t){return((e,t,n)=>{const{mediaAgent:i,store:{getState:r,dispatch:o}}=e,s=r();return-1!==bh(s).findIndex((e=>e.userId===t))&&(i.adjustOtherAudioVolume(t,n),o(op({userId:t,volume:n}))),Promise.resolve("")})(this[QA],e,t)}muteAllUserAudioLocally(){return(e=>{const{mediaAgent:t,store:{getState:n,dispatch:i}}=e,{audio:{isStopAllImcomingAudio:r}}=n();return r||(t.stopAllIncomingAudio(!0),i(dp(!0))),Promise.resolve("")})(this[QA])}unmuteAllUserAudioLocally(){return(e=>{const{mediaAgent:t,store:{getState:n,dispatch:i}}=e,{audio:{isStopAllImcomingAudio:r,locallyMutedAudioList:o}}=n();return r&&(t.stopAllIncomingAudio(!1),i(dp(!1)),o.length>0&&o.forEach((e=>{t.muteOrUnmuteOtherAudio(e,!1),i(rp(e))}))),Promise.resolve("")})(this[QA])}startSecondaryAudio(e,t){return(async(e,t,n)=>{const{mediaAgent:i,rwgAgent:r,store:{getState:o,dispatch:s}}=e,a=o(),{audio:{microphoneDevicesList:u,activeMicrophone:l},share:{status:c}}=a,d=gh(a);if(!Ls.isSupportShare2ndAudioDevice(Ho()))return Promise.reject({type:yc,reason:"Cannot start secondary audio due to platform is not supported"});if((null==d?void 0:d.audio)===yu.Computer&&l===t)return Promise.reject({type:yc,reason:"Cannot start secondary audio with the same microphone"});if(c!==qa.End)return Promise.reject({type:yc,reason:"Cannot start secondary audio while screen sharing is in progress"});let h=u;if(0===u.length){const{microphones:e}=await je(Dv());h=e}return t&&-1===h.findIndex((e=>e.deviceId===t))?Promise.reject({type:_c,reason:"Cannot find the microphone"}):(r.muteShareAudio(!1,!0),i.share2ndAudio(t,n),s(yp(t)),Cd(Nl))})(this[QA],e,t)}stopSecondaryAudio(){return(async e=>{const{mediaAgent:t,rwgAgent:n,store:{getState:i,dispatch:r}}=e,o=i(),{audio:{secondaryAudioMicrophoneId:s}}=o;if(!s)return Promise.reject({type:yc,reason:"Cannot stop secondary audio due to not started "});n.muteShareAudio(!0,!0),t.leaveSharingAudio(!1),r(yp(void 0))})(this[QA])}isUserAudioMutedLocally(e){return((e,t)=>{let{store:{getState:n}}=e;const{audio:{locallyMutedAudioList:i}}=n();return i.includes(t)})(this[QA],e)}getUserVolumeLocally(e){return((e,t)=>{var n,i;let{store:{getState:r}}=e;const{audio:{localUserAudioVolumeList:o,locallyMutedAudioList:s}}=r();return null!==(n=null===(i=o.find((e=>e.userId===t)))||void 0===i?void 0:i.volume)&&void 0!==n?n:s.includes(t)?0:100})(this[QA],e)}},$A(xD.prototype,"switchSharingSecondaryCamera",[YA,CD,MD],Object.getOwnPropertyDescriptor(xD.prototype,"switchSharingSecondaryCamera"),xD.prototype),$A(xD.prototype,"muteUserAudioLocally",[YA,AD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"muteUserAudioLocally"),xD.prototype),$A(xD.prototype,"unmuteUserAudioLocally",[YA,TD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"unmuteUserAudioLocally"),xD.prototype),$A(xD.prototype,"adjustUserAudioVolumeLocally",[YA,RD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"adjustUserAudioVolumeLocally"),xD.prototype),$A(xD.prototype,"muteAllUserAudioLocally",[YA,OD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"muteAllUserAudioLocally"),xD.prototype),$A(xD.prototype,"unmuteAllUserAudioLocally",[YA,PD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"unmuteAllUserAudioLocally"),xD.prototype),$A(xD.prototype,"startSecondaryAudio",[YA,DD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"startSecondaryAudio"),xD.prototype),$A(xD.prototype,"stopSecondaryAudio",[YA,kD,ND],Object.getOwnPropertyDescriptor(xD.prototype,"stopSecondaryAudio"),xD.prototype),xD);const LD={controlStatus:nh.NotStarted,sequenceId:1,rooms:[],isHugeBO:!1,allocationPattern:th.Automatically,currentRoom:{status:rh.Initial,boStatus:ih.NoToken,boConfId:"",boId:"",name:"",boToken:""},options:{isAutoJoinRoom:!1,isBackToMainSessionEnabled:!0,isTimerEnabled:!1,timerDuration:1800,isTimerAutoEnabled:!1,waitSeconds:60,isAutoMovetoMainSession:!1,isRoomSelectionEnabled:!1},mainSessionAttendeeList:[],preAssignedRooms:[],meetingElapsedTime:0,startRoomElapsedTime:0,closingRoomTime:0,broadcastMessage:"",hostReplyToQuestionerType:void 0,hostReplyToRequestId:void 0,isUserRoleUpdated:!1,mainSessionConfId:"",isEnableBOBroadcast:!1,isEnableBreakoutRoom:!1,isEnableBOViewActivityStatus:!1,inRoomUserActivityStatusMap:{},isEnableBOBroadcastVoice:!1,isBroadcastVoice:!1},VD=Rn({[`${Qg}`]:hE(((e,t)=>{let{payload:n}=t;Array.isArray(n)?e.rooms.push(...n):e.rooms.push(n)})),[`${Yg}`]:hE(((e,t)=>{let{payload:n}=t;e.allocationPattern=n})),[`${Zg}`]:hE(((e,t)=>{let{payload:n}=t;e.sequenceId=n})),[`${Xg}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingElapsedTime=n})),[`${em}`]:hE(((e,t)=>{let{payload:n}=t;e.startRoomElapsedTime=n})),[`${tm}`]:hE(((e,t)=>{let{payload:n}=t;const{options:i}=e;Object.assign(i,n)})),[`${nm}`]:hE(((e,t)=>{let{payload:n}=t;e.controlStatus=n})),[`${im}`]:hE(((e,t)=>{let{payload:n}=t;e.rooms=n})),[`${rm}`]:hE(((e,t)=>{let{payload:n}=t;const{currentRoom:i}=e;Object.assign(i,n)})),[`${om}`]:hE(((e,t)=>{let{payload:n}=t;const{currentRoom:i}=e;i.status=n})),[`${sm}`]:hE(((e,t)=>{let{payload:n}=t;const{currentRoom:i}=e;i.boConfId=n})),[`${am}`]:hE(((e,t)=>{let{payload:n}=t;const{currentRoom:i}=e;i.boToken=n})),[`${lm}`]:hE(((e,t)=>{let{payload:n}=t;e.closingRoomTime=n})),[`${cm}`]:hE(((e,t)=>{let{payload:n}=t;e.broadcastMessage=n})),[`${dm}`]:hE(((e,t)=>{let{payload:n}=t;e.hostReplyToQuestionerType=n})),[`${hm}`]:hE(((e,t)=>{let{payload:n}=t;e.hostReplyToRequestId=n})),[`${pm}`]:hE(((e,t)=>{let{payload:n}=t;void 0!==n.add&&n.add.length>0&&n.add.forEach((t=>{const n=e.mainSessionAttendeeList.find((e=>e.userId===t.userId));void 0!==n?Object.assign(n,t):Xd(t.userRole)||e.mainSessionAttendeeList.push(t)})),void 0!==n.update&&n.update.length>0&&n.update.forEach((t=>{const n=e.mainSessionAttendeeList.find((e=>e.userId===t.userId));void 0!==n&&Object.assign(n,t)})),void 0!==n.remove&&n.remove.length>0&&n.remove.forEach((t=>{const n=e.mainSessionAttendeeList.findIndex((e=>e.userId===t.userId));-1!==n&&e.mainSessionAttendeeList.splice(n,1)}))})),[`${fm}`]:hE(((e,t)=>{let{payload:n}=t;e.isHugeBO=n})),[`${mm}`]:hE(((e,t)=>{let{payload:n}=t;e.isUserRoleUpdated=n})),[`${gm}`]:hE(((e,t)=>{let{payload:n}=t;e.preAssignedRooms=n})),[`${vm}`]:hE(((e,t)=>{let{payload:n}=t;e.isEnableBreakoutRoom=n.isEnableBreakoutRoom,e.isEnableBOBroadcast=n.isEnableBOBroadcast,e.isEnableBOViewActivityStatus=n.isEnableBOViewActivityStatus,e.isEnableBOBroadcastVoice=n.isEnableBOBroadcastVoice})),[`${ym}`]:hE(((e,t)=>{let{payload:n}=t;const{userGuid:i,status:r}=n,{inRoomUserActivityStatusMap:o}=e;o[`${i}`]=r})),[`${Sm}`]:hE(((e,t)=>{let{payload:n}=t;e.isBroadcastVoice=n})),[`${um}`]:e=>{const{currentRoom:{status:t}}=e;return t===rh.Joining?{...LD,preAssignedRooms:e.preAssignedRooms,currentRoom:e.currentRoom,closingRoomTime:e.closingRoomTime}:t===rh.Leaving?{...LD,preAssignedRooms:e.preAssignedRooms,closingRoomTime:e.closingRoomTime}:{...LD,preAssignedRooms:e.preAssignedRooms}}},LD);var jD=Uint8Array,BD=Uint16Array,UD=Uint32Array,HD=new jD([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),qD=new jD([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),KD=new jD([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$D=function(e,t){for(var n=new BD(31),i=0;i<31;++i)n[i]=t+=1<<e[i-1];var r=new UD(n[30]);for(i=1;i<30;++i)for(var o=n[i];o<n[i+1];++o)r[o]=o-n[i]<<5|i;return[n,r]},WD=$D(HD,2),GD=WD[0],zD=WD[1];GD[28]=258,zD[258]=28;for(var JD=$D(qD,0),QD=JD[0],YD=JD[1],ZD=new BD(32768),XD=0;XD<32768;++XD){var ek=(43690&XD)>>>1|(21845&XD)<<1;ek=(61680&(ek=(52428&ek)>>>2|(13107&ek)<<2))>>>4|(3855&ek)<<4,ZD[XD]=((65280&ek)>>>8|(255&ek)<<8)>>>1}var tk=function(e,t,n){for(var i=e.length,r=0,o=new BD(t);r<i;++r)e[r]&&++o[e[r]-1];var s,a=new BD(t);for(r=0;r<t;++r)a[r]=a[r-1]+o[r-1]<<1;if(n){s=new BD(1<<t);var u=15-t;for(r=0;r<i;++r)if(e[r])for(var l=r<<4|e[r],c=t-e[r],d=a[e[r]-1]++<<c,h=d|(1<<c)-1;d<=h;++d)s[ZD[d]>>>u]=l}else for(s=new BD(i),r=0;r<i;++r)e[r]&&(s[r]=ZD[a[e[r]-1]++]>>>15-e[r]);return s},nk=new jD(288);for(XD=0;XD<144;++XD)nk[XD]=8;for(XD=144;XD<256;++XD)nk[XD]=9;for(XD=256;XD<280;++XD)nk[XD]=7;for(XD=280;XD<288;++XD)nk[XD]=8;var ik=new jD(32);for(XD=0;XD<32;++XD)ik[XD]=5;var rk=tk(nk,9,0),ok=tk(nk,9,1),sk=tk(ik,5,0),ak=tk(ik,5,1),uk=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},lk=function(e,t,n){var i=t/8|0;return(e[i]|e[i+1]<<8)>>(7&t)&n},ck=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},dk=function(e){return(e+7)/8|0},hk=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var i=new(2==e.BYTES_PER_ELEMENT?BD:4==e.BYTES_PER_ELEMENT?UD:jD)(n-t);return i.set(e.subarray(t,n)),i},pk=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],fk=function(e,t,n){var i=new Error(t||pk[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,fk),!n)throw i;return i},gk=function(e,t,n){n<<=7&t;var i=t/8|0;e[i]|=n,e[i+1]|=n>>>8},mk=function(e,t,n){n<<=7&t;var i=t/8|0;e[i]|=n,e[i+1]|=n>>>8,e[i+2]|=n>>>16},vk=function(e,t){for(var n=[],i=0;i<e.length;++i)e[i]&&n.push({s:i,f:e[i]});var r=n.length,o=n.slice();if(!r)return[Ik,0];if(1==r){var s=new jD(n[0].s+1);return s[n[0].s]=1,[s,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var a=n[0],u=n[1],l=0,c=1,d=2;for(n[0]={s:-1,f:a.f+u.f,l:a,r:u};c!=r-1;)a=n[n[l].f<n[d].f?l++:d++],u=n[l!=c&&n[l].f<n[d].f?l++:d++],n[c++]={s:-1,f:a.f+u.f,l:a,r:u};var h=o[0].s;for(i=1;i<r;++i)o[i].s>h&&(h=o[i].s);var p=new BD(h+1),f=yk(n[c-1],p,0);if(f>t){i=0;var g=0,m=f-t,v=1<<m;for(o.sort((function(e,t){return p[t.s]-p[e.s]||e.f-t.f}));i<r;++i){var y=o[i].s;if(!(p[y]>t))break;g+=v-(1<<f-p[y]),p[y]=t}for(g>>>=m;g>0;){var S=o[i].s;p[S]<t?g-=1<<t-p[S]++-1:++i}for(;i>=0&&g;--i){var b=o[i].s;p[b]==t&&(--p[b],++g)}f=t}return[new jD(p),f]},yk=function(e,t,n){return-1==e.s?Math.max(yk(e.l,t,n+1),yk(e.r,t,n+1)):t[e.s]=n},Sk=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new BD(++t),i=0,r=e[0],o=1,s=function(e){n[i++]=e},a=1;a<=t;++a)if(e[a]==r&&a!=t)++o;else{if(!r&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(r),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(r);o=1,r=e[a]}return[n.subarray(0,i),t]},bk=function(e,t){for(var n=0,i=0;i<t.length;++i)n+=e[i]*t[i];return n},Ek=function(e,t,n){var i=n.length,r=dk(t+2);e[r]=255&i,e[r+1]=i>>>8,e[r+2]=255^e[r],e[r+3]=255^e[r+1];for(var o=0;o<i;++o)e[r+o+4]=n[o];return 8*(r+4+i)},wk=function(e,t,n,i,r,o,s,a,u,l,c){gk(t,c++,n),++r[256];for(var d=vk(r,15),h=d[0],p=d[1],f=vk(o,15),g=f[0],m=f[1],v=Sk(h),y=v[0],S=v[1],b=Sk(g),E=b[0],w=b[1],_=new BD(19),I=0;I<y.length;++I)_[31&y[I]]++;for(I=0;I<E.length;++I)_[31&E[I]]++;for(var C=vk(_,7),A=C[0],T=C[1],R=19;R>4&&!A[KD[R-1]];--R);var O,P,D,k,x=l+5<<3,N=bk(r,nk)+bk(o,ik)+s,M=bk(r,h)+bk(o,g)+s+14+3*R+bk(_,A)+(2*_[16]+3*_[17]+7*_[18]);if(x<=N&&x<=M)return Ek(t,c,e.subarray(u,u+l));if(gk(t,c,1+(M<N)),c+=2,M<N){O=tk(h,p,0),P=h,D=tk(g,m,0),k=g;var F=tk(A,T,0);for(gk(t,c,S-257),gk(t,c+5,w-1),gk(t,c+10,R-4),c+=14,I=0;I<R;++I)gk(t,c+3*I,A[KD[I]]);c+=3*R;for(var L=[y,E],V=0;V<2;++V){var j=L[V];for(I=0;I<j.length;++I){var B=31&j[I];gk(t,c,F[B]),c+=A[B],B>15&&(gk(t,c,j[I]>>>5&127),c+=j[I]>>>12)}}}else O=rk,P=nk,D=sk,k=ik;for(I=0;I<a;++I)if(i[I]>255){B=i[I]>>>18&31,mk(t,c,O[B+257]),c+=P[B+257],B>7&&(gk(t,c,i[I]>>>23&31),c+=HD[B]);var U=31&i[I];mk(t,c,D[U]),c+=k[U],U>3&&(mk(t,c,i[I]>>>5&8191),c+=qD[U])}else mk(t,c,O[i[I]]),c+=P[i[I]];return mk(t,c,O[256]),c+P[256]},_k=new UD([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ik=new jD(0),Ck=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,i=9;--i;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),Ak=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8};var Tk="undefined"!=typeof TextEncoder&&new TextEncoder,Rk="undefined"!=typeof TextDecoder&&new TextDecoder;try{Rk.decode(Ik,{stream:!0})}catch(h){}const{WebclientBreakoutRoomAttendeeStatus:Ok,WebclientBreakoutRoomCommand:Pk}=ko,Dk=nb(Ls.getInstance());function kk(e,t){let n=0;for(;n<e.length;n++){const i=e[n],{attendeeGuidList:r}=i;if(null!=r&&r.includes(t))break}return n<e.length?e[n]:void 0}function xk(){Do.remove(Ok),Do.remove(Pk)}function Nk(){return Ps.createAgent().leaveBO(1),_d(Gs,{reason:Eo.BackToMainSession}),xk(),[om(rh.Leaving),Nr(To.NormalCase)]}function Mk(e,t){return _d(Gs,{reason:Eo.JoinBreakoutRoom,roomName:e}),t===rh.InRoom&&Ps.createAgent().leaveBO(1),[om(rh.Joining),Nr(To.NormalCase)]}function Fk(e){return _d(Gs,{reason:Eo.MoveToBreakoutRoom,roomName:e}),Ps.createAgent().leaveBO(1),[om(rh.Joining),Nr(To.NormalCase)]}function Lk(e){return e!==rh.InRoom&&e!==rh.Joining&&e!==rh.Leaving}function Vk(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?rh.InRoom:rh.Invited;return Do.set(Ok,JSON.stringify({status:t,boId:e.boId}),Oo.SessionStorage),rm({status:t,boId:e.boId,name:e.name,boStatus:e.boStatus})}function jk(e){const{breakoutRoom:{isUserRoleUpdated:t,currentRoom:{boConfId:n}}}=e.value,i=gh(e.value);if(i&&(!n||n&&t))return Fe(i.isHost);{const t=n?Ad(Xc,1):Ad(Vs,2).pipe(q((function(e,t){var n=[];e.subscribe(K(t,(function(e){n.push(e),1<n.length&&n.shift()}),(function(){var e,i;try{for(var r=m(n),o=r.next();!o.done;o=r.next()){var s=o.value;t.next(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}t.complete()}),void 0,(function(){n=null})))})));return t.pipe(ke(ce),Tt(e),Ke((e=>{let[,t]=e;return gh(t).isHost})))}}function Bk(e){return et({boIdList:Ad(qc).pipe(bt(((e,t)=>[...e,t]),[]),gt(e))}).pipe(He(1e4))}const Uk=[{mask:ch.Connect,key:"audio",value:""},{mask:ch.Voip,key:"audio",value:"computer"},{mask:ch.Muted,key:"muted",value:!0},{mask:dh.Connect,key:"bVideoOn",value:!1},{mask:dh.On,key:"bVideoOn",value:!0},{mask:hh.Share,key:"sharerOn",value:!0},{mask:hh.ShareAudio,key:"bShareAudioOn",value:!0}];function Hk(e,t){const n=(fT(t)?t.breakoutRoom.mainSessionAttendeeList:t.participants.attendeesList).find((t=>t.userId===Number(e)));return n?{inviterId:n.userId,inviterGuid:n.userGUID,inviterName:n.displayName}:{}}const qk=Ps.createAgent(),Kk=["userRole","bCoHost","bCCEditor","bHold"],$k=Ps.createAgent(),Wk=nb(Ls.getInstance());var Gk;const zk=Ps.createAgent(),Jk=nb(Ls.getInstance()),Qk=oT("Breakout Room");let Yk=(Gk=class extends aT{createRooms(e,t){const n=this[GA](),i=this[zA],{breakoutRoom:{isHugeBO:r,sequenceId:o,rooms:s,controlStatus:a,isEnableBreakoutRoom:u}}=n;if(!u)return Promise.reject({type:yc,reason:"Breakout room feature is not enabled."});if(a===nh.InProgress||a===nh.Closing)return Promise.resolve({type:yc,reason:"breakout room has started!"});let l;l="string"==typeof e?[e]:"number"==typeof e?Array.from({length:e}).map(((e,t)=>`${sh} ${t+o}`)):e;const c=r?100:50;return l.length<1||s.length+l.length>c?Promise.reject({type:_c,reason:"exceed maximum size"}):(zk.batchCreateBOToken(l),new Promise(((e,r)=>{Bk(l.length).subscribe((r=>{let{boIdList:s}=r,a=s.map(((e,t)=>({boId:e,name:l[t]})));if(t===th.Automatically){const e=gT(n),t=a.length,i=e.length;a=a.map(((n,r)=>{const o=[];let s=r;for(;s<i;)o.push(e[s]),s+=t;return{...n,attendeeList:o}}))}const u=a.map((e=>{let{boId:t,name:n,attendeeList:i}=e;return{boId:t,name:n,attendeeGuidList:i&&i.map((e=>e.userGUID))}}));if(i(Qg(u)),i(Yg(t)),i(Zg(o+a.length)),t===th.Automatically){const t=a.map((e=>({roomId:e.boId,name:e.name,attendeeList:e.attendeeList.map((e=>({userId:e.userId,avatar:e.avatar,displayName:e.displayName})))})));e(t)}else e(a.map((e=>({roomId:e.boId,name:e.name,attendeeList:[]}))))}),(()=>{r({type:Sc})}))})))}recreateRooms(e,t){const n=this[GA](),i=this[zA],{breakoutRoom:{isHugeBO:r,sequenceId:o,rooms:s,controlStatus:a,isEnableBreakoutRoom:u}}=n;if(!u)return Promise.reject({type:yc,reason:"Breakout room feature is not enabled."});if(a===nh.InProgress||a===nh.Closing)return Promise.resolve({type:yc,reason:"breakout room has started!"});let l;l="string"==typeof e?[e]:"number"==typeof e?Array.from({length:e}).map(((e,t)=>`${sh} ${t+o}`)):e;const c=r?100:50;return l.length<1||s.length+l.length>c?Promise.reject({type:_c,reason:"exceed maximum size"}):(zk.batchCreateBOToken(l),new Promise(((e,r)=>{Bk(l.length).subscribe((r=>{let{boIdList:s}=r,a=s.map(((e,t)=>({boId:e,name:l[t]})));if(t===th.Automatically){const e=a.length,t=mT(n),i=t.length;a=a.map(((n,r)=>{const o=[];let s=r;for(;s<i;)o.push(t[s]),s+=e;return{...n,attendeeList:o}}))}const u=a.map((e=>{let{boId:t,name:n,attendeeList:i}=e;return{boId:t,name:n,attendeeGuidList:i&&i.map((e=>e.userGUID))}}));if(i(im(u)),i(Yg(t)),i(Zg(o+a.length)),t===th.Automatically){const t=a.map((e=>({roomId:e.boId,name:e.name,attendeeList:e.attendeeList.map((e=>({userId:e.userId,avatar:e.avatar,displayName:e.displayName})))})));e(t)}else e(a.map((e=>({roomId:e.boId,name:e.name,attendeeList:[]}))))}),(()=>{r({type:Sc})}))})))}openRooms(e,t){var n;const i=this[GA](),r={isAutoJoinRoom:!1,isBackToMainSessionEnabled:!0,isTimerEnabled:!1,timerDuration:1800,isTimerAutoEnabled:!1,waitSeconds:60,isAutoMoveBackToMainSession:!1,isRoomSelectionEnabled:!1},{breakoutRoom:{controlStatus:o,rooms:s,sequenceId:a,isHugeBO:u}}=i;if(o===nh.InProgress||o===nh.Closing)return Promise.resolve({type:yc,reason:"breakout room has started!"});if(e.some((e=>-1===s.findIndex((t=>t.boId===e.roomId)))))return Promise.reject({type:_c,reason:"roomId is wrong"});const l=bh(i);if(e.reduce(((e,t)=>e.concat(t.attendeeList)),[]).some((e=>-1===l.findIndex((t=>t.userId===e.userId)))))return Promise.reject({type:_c,reason:"bad user"});const c=e.map((e=>{const{attendeeList:t}=e,n=t.map((e=>{const t=l.find((t=>t.userId===e.userId));return null==t?void 0:t.userGUID}));return{BID:e.roomId,MeetingTitle:e.name,MeetingToken:void 0,Status:ih.Started,HostID:"",ParticipantList:n}})),d=t?{...r,...t}:r,h={ControlStatus:nh.InProgress,NameIndex:a,IsAutoJoinEnabled:+d.isAutoJoinRoom,IsBackToMainSessionEnabled:+d.isBackToMainSessionEnabled,IsTimerEnabled:+d.isTimerEnabled,TimerDuration:d.timerDuration,IsTimerAutoEndEnabled:+d.isTimerAutoEnabled,WaitSeconds:d.waitSeconds<0?0:d.waitSeconds,StartTimeOnMMR:void 0,ItemList:c,IsAutoMovetoMainSessionEnabled:d.isAutoMoveBackToMainSession,IsParticipantsChooseRoomEnabled:+d.isRoomSelectionEnabled};let p=or(JSON.stringify(h));if(u&&(p=(e=>nr.fromUint8Array(function(e,t){t||(t={});var n=function(){var e=-1;return{p:function(t){for(var n=e,i=0;i<t.length;++i)n=Ck[255&n^t[i]]^n>>>8;e=n},d:function(){return~e}}}(),i=e.length;n.p(e);var r=function(e,t,n,i,r){return function(e,t,n,i,r,o){var s=e.length,a=new jD(i+s+5*(1+Math.ceil(s/7e3))+8),u=a.subarray(i,a.length-8),l=0;if(!t||s<8)for(var c=0;c<=s;c+=65535){var d=c+65535;d>=s&&(u[l>>3]=o),l=Ek(u,l+1,e.subarray(c,d))}else{for(var h=_k[t-1],p=h>>>13,f=8191&h,g=(1<<n)-1,m=new BD(32768),v=new BD(g+1),y=Math.ceil(n/3),S=2*y,b=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<S)&g},E=new UD(25e3),w=new BD(288),_=new BD(32),I=0,C=0,A=(c=0,0),T=0,R=0;c<s;++c){var O=b(c),P=32767&c,D=v[O];if(m[P]=D,v[O]=P,T<=c){var k=s-c;if((I>7e3||A>24576)&&k>423){l=wk(e,u,0,E,w,_,C,A,R,c-R,l),A=I=C=0,R=c;for(var x=0;x<286;++x)w[x]=0;for(x=0;x<30;++x)_[x]=0}var N=2,M=0,F=f,L=P-D&32767;if(k>2&&O==b(c-L))for(var V=Math.min(p,k)-1,j=Math.min(32767,c),B=Math.min(258,k);L<=j&&--F&&P!=D;){if(e[c+N]==e[c+N-L]){for(var U=0;U<B&&e[c+U]==e[c+U-L];++U);if(U>N){if(N=U,M=L,U>V)break;var H=Math.min(L,U-2),q=0;for(x=0;x<H;++x){var K=c-L+x+32768&32767,$=K-m[K]+32768&32767;$>q&&(q=$,D=K)}}}L+=(P=D)-(D=m[P])+32768&32767}if(M){E[A++]=268435456|zD[N]<<18|YD[M];var W=31&zD[N],G=31&YD[M];C+=HD[W]+qD[G],++w[257+W],++_[G],T=c+N,++I}else E[A++]=e[c],++w[e[c]]}}l=wk(e,u,o,E,w,_,C,A,R,c-R,l)}return hk(a,0,i+dk(l)+8)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,0,!0)}(e,t,function(e){return 10+(e.filename&&e.filename.length+1||0)}(t)),o=r.length;return function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&Ak(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var i=0;i<=n.length;++i)e[i+10]=n.charCodeAt(i)}}(r,t),Ak(r,o-8,n.d()),Ak(r,o-4,i),r}(function(e,t){var n;if(Tk)return Tk.encode(e);var i=e.length,r=new jD(e.length+(e.length>>1)),o=0,s=function(e){r[o++]=e};for(n=0;n<i;++n){if(o+5>r.length){var a=new jD(o+8+(i-n<<1));a.set(r),r=a}var u=e.charCodeAt(n);u<128?s(u):u<2048?(s(192|u>>6),s(128|63&u)):u>55295&&u<57344?(s(240|(u=65536+(1047552&u)|1023&e.charCodeAt(++n))>>18),s(128|u>>12&63),s(128|u>>6&63),s(128|63&u)):(s(224|u>>12),s(128|u>>6&63),s(128|63&u))}return hk(r,0,o)}(e))))(p)),null!==(n=gh(i))&&void 0!==n&&n.isHost)zk.startBO(p);else{const e=vT(i);e&&zk.coHostStartBO(p,e.userId)}return Cd(Qc,(e=>e.controlStatus===nh.InProgress))}joinRoom(e){const t=this[GA](),n=gh(t),{breakoutRoom:{controlStatus:i,rooms:r,mainSessionAttendeeList:o,options:{isRoomSelectionEnabled:s},currentRoom:{status:a,boId:u}},meeting:{userGUID:l}}=t;if(i!==nh.InProgress)return Promise.reject({type:wc,reason:"Breakout room is not started"});if(null!=n&&n.isHost){const t=r.find((t=>t.boId===e));if(!t)return Promise.reject({type:_c,reason:"Room ID is not correct"});zk.joinBO(t.boId)}else if(null!=n&&n.bCoHost&&a===rh.InRoom){if(!r.find((t=>t.boId===e)))return Promise.reject({type:_c,reason:"Room ID is not correct"});{const t=o.find((e=>e.isHost));t&&zk.wantJoinBO(null==t?void 0:t.userId,e)}}else{if(a===rh.InRoom&&u===e)return Promise.resolve("");{let n=!1;const i=kk(r,l);if(i&&i.boId===e)zk.joinBO(i.boId);else if(s)if(-1!==r.findIndex((t=>t.boId===e))){const n=vT(t);n&&zk.wantJoinBO(n.userId,e)}else n=!0;else n=!0;if(n)return Promise.reject({type:_c,reason:"Room ID is not correct"})}}return Cd(Yc,(t=>t.boId===e))}leaveRoom(){const e=this[GA](),t=this[zA],{breakoutRoom:{controlStatus:n,options:i,currentRoom:{status:r}}}=e;if(n!==nh.InProgress&&n!==nh.Closing||r!==rh.InRoom)return Promise.reject({type:yc});{const n=mh(e);if(!i.isBackToMainSessionEnabled&&!n)return Promise.reject({type:Ec,reason:"Can not return main session during the breakout room"});Nk().forEach((e=>t(e)))}return Promise.resolve("")}askForHelp(){const e=this[GA](),{breakoutRoom:{controlStatus:t,mainSessionAttendeeList:n,currentRoom:{status:i}},participants:{attendeesList:r}}=e,o=mh(e);if(t!==nh.InProgress||i!==rh.InRoom)return Promise.reject({type:yc,reason:"you are not in breakout room"});if(o)return Promise.reject({type:yc,reason:"host or co-host can not ask for help"});{const e=n.find((e=>e.isHost));if(e){if(r.findIndex((t=>t.zoomID===e.zoomID))>-1)return Promise.reject({type:yc,reason:"host is in room"});zk.askForHelpBO(e.userId)}}return Cd(Jc,(e=>e.result===ah.Received))}postponeHelping(e){const t=this[GA](),n=this[zA],{breakoutRoom:{mainSessionAttendeeList:i,currentRoom:{status:r}},participants:{attendeesList:o}}=t;let s=o;return r===rh.InRoom&&(s=i),s.findIndex((t=>t.userId===e))>-1?(zk.askForHelpResultBO(e,ah.Ignore),n(dm(ah.Ignore)),Promise.resolve("")):Promise.reject({type:_c,reason:"user id is not correct"})}broadcast(e){const{breakoutRoom:{isEnableBOBroadcast:t}}=this[GA]();return t?e?es.beginEncrypt({text:e,type:Qo.BO_BROADCAST}).then((e=>(zk.broadcastBO(e),Promise.resolve("")))):Promise.reject({type:_c,reason:"content empty"}):Promise.reject({type:yc,reason:"Cannot broadcast message due to the feature is not enable"})}startBroadcastVoice(){const e=this[GA](),t=this[zA],{breakoutRoom:{isEnableBOBroadcast:n,isEnableBOBroadcastVoice:i,isBroadcastVoice:r}}=e;if(n&&i){if(fT(e))return Promise.reject({type:yc,reason:"Cannot broadcast voice in the room"});{if(r)return Promise.resolve("");const n=gh(e);return(null==n?void 0:n.audio)===yu.Computer&&!1===n.muted?(zk.broadcastVoiceReq(!0),Jk.broadcastVoiceToBreakoutRoom(!0),t(Sm(!0)),Promise.resolve("")):Promise.reject({type:yc,reason:"Start audio and unmute to broadcast"})}}return Promise.reject({type:yc,reason:"Cannot broadcast voice due to the feature is not enable"})}stopBroadcastVoice(){const e=this[GA](),t=this[zA],{breakoutRoom:{isBroadcastVoice:n}}=e;return n?(zk.broadcastVoiceReq(!1),Jk.broadcastVoiceToBreakoutRoom(!1),t(Sm(!1)),Promise.resolve("")):Promise.reject({type:yc,reason:"Cannot stop broadcast voice due to it is not started"})}assignUserToRoom(e,t){const n=this[GA](),{breakoutRoom:{rooms:i}}=n,r=gT(n).find((t=>t.userId===e));if(!(r&&i.findIndex((e=>e.boId===t))>-1))return Promise.reject({type:_c,reason:""});var o;if(null!==(o=gh(n))&&void 0!==o&&o.isHost)zk.assignToBO(e,t);else{const e=vT(n);e&&zk.coHostAssignToBO(r.userGUID,t,e.userId)}return Cd(Qc,(e=>{const{controlStatus:n,roomList:i}=e,o=i.find((e=>e.boId===t));return n===nh.InProgress&&o&&o.attendeeGuidList.includes(r.userGUID)}))}moveUserToRoom(e,t){const n=this[GA](),{breakoutRoom:{rooms:i,mainSessionAttendeeList:r},participants:{attendeesList:o}}=n,s=(fT(n)?r:o).find((t=>t.userId===e));if(!s)return Promise.reject({type:_c,reason:"user id not correct"});{const r=kk(i,s.userGUID);if(!r)return Promise.reject({type:yc,reason:"user not in a room"});if(r.boId===t)return Promise.reject({type:yc,reason:"user already in the target room"});{const r=i.find((e=>e.boId===t));if(!r)return Promise.reject({type:_c,reason:"invalid room id"});var a;if(null!==(a=gh(n))&&void 0!==a&&a.isHost)zk.switchBO(e,r.boId);else{const e=vT(n);e&&zk.coHostAssignToBO(s.userGUID,r.boId,e.userId)}}}return Cd(Qc,(e=>{const{controlStatus:n,roomList:i}=e,r=i.find((e=>e.boId===t));return n===nh.InProgress&&r&&r.attendeeGuidList.includes(s.userGUID)}))}moveBackToMainSession(e){const t=this[GA](),{breakoutRoom:{rooms:n,mainSessionAttendeeList:i},participants:{attendeesList:r}}=t,o=(fT(t)?i:r).find((t=>t.userId===e));if(!o)return Promise.reject({type:_c,reason:"user id not correct"});if(!kk(n,o.userGUID))return Promise.reject({type:yc,reason:"user not in a room"});var s;if(null!==(s=gh(t))&&void 0!==s&&s.isHost)zk.moveToMainSession(o.userGUID);else{const e=vT(t);e&&zk.coHostMoveToMainSession(o.userGUID,e.userId)}return Cd(Qc,(e=>{const{controlStatus:t,roomList:n}=e;return t===nh.InProgress&&n.some((e=>{const{attendeeGuidList:t}=e;return t.includes(o.userGUID)}))}))}closeRoom(){const e=this[GA](),{breakoutRoom:{controlStatus:t}}=e;if(t!==nh.InProgress)return Promise.reject({type:yc,reason:"room is not started"});var n;if(null!==(n=gh(e))&&void 0!==n&&n.isHost)zk.stopBO(nh.Closing);else{const t=vT(e);t&&zk.coHostStopBO(nh.Closing,t.userId)}return Cd(Qc,(e=>e.controlStatus===nh.Closing))}loadPreAssignedRooms(){const e=this[GA](),{meeting:{meetingOptions:t},breakoutRoom:{controlStatus:n}}=e;return!t.isAllowBreakoutRoomPreAssign||n!==nh.NotStarted&&n!==nh.Closed?Promise.reject({type:yc}):(zk.preAssignBreakoutRoom(),Cd(ed))}getUnassignedAttendeeList(){const e=this[GA](),t=gh(e);return null!=t&&t.isHost||null!=t&&t.bCoHost?gT(e).map((e=>lT(e))):[]}getRoomList(){const e=this[GA](),{breakoutRoom:{rooms:t,currentRoom:{status:n,boId:i},mainSessionAttendeeList:r,inRoomUserActivityStatusMap:o,options:{isRoomSelectionEnabled:s}},participants:{attendeesList:a}}=e,u=gh(e);if(u&&(u.isHost||u.bCoHost||s)){const e=n===rh.InRoom,s=e?r:a;return t.map((t=>{const{attendeeGuidList:n,boId:r,name:a}=t,l=(n||[]).map((e=>s.find((t=>t.userGUID===e)))).filter((e=>!(null!=e&&e.isHost))).filter(Boolean);return e&&u.isHost&&r===i&&l.unshift(u),{roomId:r,name:a,attendeeList:l.filter((e=>!!e)).map((e=>{var t;const n=null!==(t=o[e.userGUID])&&void 0!==t?t:{};return{userId:e.userId,displayName:e.displayName,avatar:e.avatar,isInRoom:e.bid===r,userGuid:e.userGUID,...n}}))}}))}return e.breakoutRoom.rooms.map((e=>{const{boId:t,name:n}=e;return{roomId:t,name:n,attendeeList:[]}}))}getAttendeeStatus(){return this[GA]().breakoutRoom.currentRoom.status}getRoomStatus(){return this[GA]().breakoutRoom.controlStatus}getCurrentRoom(){const e=this[GA](),{breakoutRoom:{currentRoom:{status:t,name:n,boId:i}}}=e;return{attendeeStatus:t,name:n,roomId:i}}getRoomOptions(){const e=this[GA](),{breakoutRoom:{options:t}}=e,{whoStart:n,whoStop:i,...r}=t;return{...r}}},$A(Gk.prototype,"createRooms",[YA,ZA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"createRooms"),Gk.prototype),$A(Gk.prototype,"recreateRooms",[YA,ZA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"recreateRooms"),Gk.prototype),$A(Gk.prototype,"openRooms",[YA,ZA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"openRooms"),Gk.prototype),$A(Gk.prototype,"joinRoom",[YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"joinRoom"),Gk.prototype),$A(Gk.prototype,"leaveRoom",[YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"leaveRoom"),Gk.prototype),$A(Gk.prototype,"askForHelp",[YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"askForHelp"),Gk.prototype),$A(Gk.prototype,"postponeHelping",[XA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"postponeHelping"),Gk.prototype),$A(Gk.prototype,"broadcast",[ZA,YA],Object.getOwnPropertyDescriptor(Gk.prototype,"broadcast"),Gk.prototype),$A(Gk.prototype,"startBroadcastVoice",[XA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"startBroadcastVoice"),Gk.prototype),$A(Gk.prototype,"stopBroadcastVoice",[XA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"stopBroadcastVoice"),Gk.prototype),$A(Gk.prototype,"assignUserToRoom",[ZA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"assignUserToRoom"),Gk.prototype),$A(Gk.prototype,"moveUserToRoom",[ZA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"moveUserToRoom"),Gk.prototype),$A(Gk.prototype,"moveBackToMainSession",[ZA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"moveBackToMainSession"),Gk.prototype),$A(Gk.prototype,"closeRoom",[ZA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"closeRoom"),Gk.prototype),$A(Gk.prototype,"loadPreAssignedRooms",[XA,YA,Qk],Object.getOwnPropertyDescriptor(Gk.prototype,"loadPreAssignedRooms"),Gk.prototype),Gk);const Zk={breakoutRoomSharingEpics0:(e,t)=>fi(e,is).pipe(ht((e=>{var t;const{payload:{body:n}}=e;return null==n||null===(t=n.update)||void 0===t?void 0:t.some((e=>void 0!==e.bShareToBORooms||void 0!==e.bShareOn))})),Tt(t),Ke((e=>{let[t,n]=e;const{payload:{body:{update:i}}}=t,{breakoutRoom:{mainSessionAttendeeList:r}}=n,o=i.filter((e=>e.bShareOn&&e.bShareToBORooms)),s=i.filter((e=>!e.bShareOn||!e.bShareToBORooms)),a=r.filter((e=>e.sharerOn&&e.bShareToBORooms));return o.length>0&&o.forEach((e=>{-1===a.findIndex((t=>t.userId===e.id))&&_d(Ql,{...e,isFromMainSession:!0})})),s.length>0&&s.forEach((e=>{_d(Yl,{...e,isFromMainSession:!0})})),i.map((e=>{if(e.bShareOn&&e.bShareToBORooms){if(0===r.filter((t=>t.sharerOn&&t.bShareToBORooms&&t.userId!==e.id)).length)return{activeNodeID:e.id,bStatus:1,ssrc:e.shareSsrc};{const t=r.find((t=>t.userId===e.id));if(null!=t&&t.isHost)return{activeNodeID:e.id,bStatus:1,ssrc:e.shareSsrc}}}else if(!e.bShareOn||!e.bShareToBORooms){const t=r.filter((e=>e.bShareToBORooms&&e.sharerOn));if(1===t.length&&t[0].userId===e.id)return{activeNodeID:e.id,bStatus:0,ssrc:0};{const n=t.filter((t=>t.userId!==e.id)),i=n.find((e=>e.isHost));if(i)return{activeNodeID:i.userId,bStatus:1,ssrc:i.shareSsrc};{const e=n[0];if(e)return{activeNodeID:e.userId,bStatus:1,ssrc:e.shareSsrc}}}}})).filter(Boolean)})),Ye((e=>{const{share:{status:n},meeting:{userId:i}}=t.value,r=[];return e.map((e=>{const{activeNodeID:o,bStatus:s,ssrc:a}=e,u=1===s;r.push(xp(u)),u&&n!==qa.End&&($k.stopSharing(i),Wk.stopDesktopSharing(),r.push(Tp(qa.End)),_d(Jl));let l={activeNodeID:o,bStatus:s,ssrc:a,fromMainSession:!0};if(!u){const{participants:{attendeesList:e}}=t.value,n=e.filter((e=>e.sharerOn));if(n.length>0){const e=n[0];l={activeNodeID:e.userId,bStatus:1,ssrc:e.shareSsrc||0}}}r.push(xn({evt:ts,body:l}))})),Me(r)}))),breakoutRoomSharingEpics1:(e,t)=>fi(e,as).pipe(_t((n=>{const{payload:{body:{userID:i,confID:r}}}=n;return lt(...["sharing","audio"].map((n=>function(e,t,n,i,r){return fi(t,"audio"===e?os:ns).pipe(gt(1),At((t=>{const{payload:{body:{encryptKey:o,additionalType:s}}}=t,{media:{sharingDecodeStatus:a,audioDecodeStatus:u},meeting:{svcUrl:l,meetingNumber:c,conId:d,zoomId:h,meetingId:p}}=n.value;Rv(e,"success","audio"===e?u:a).subscribe((t=>{let[,a]=t;if(a){const t=`wss://${l}/wc/media/${c}?type=${"audio"===e?"ma":"ms"}&cid=${d}&mode=1`;Dk.createMainSessionChannel(e,t),Dk.updateMediaParams({iVType:"audio"===e?zo.AUDIO_DECODE:zo.SHARING_DECODE,isFromMainSession:!0,updateParams:{userId:i,sn:ar(h),confId:r,encryptType:s,encryptKey:ar(o),meetingId:p,meetingNumber:c}});const{breakoutRoom:{mainSessionAttendeeList:a}}=n.value;if((null==a?void 0:a.length)>0){const t=a.map((e=>({userid:e.userId,sn:e.zoomID&&ar(e.zoomID)})));Dk.updateUserMediaSN({added:t,isFromMainSession:!0,iVType:"audio"===e?zo.AUDIO_DECODE:zo.SHARING_DECODE})}}}))})),St(ge))}(n,e,t,i,r))))})))},Xk={epics0:(e,t)=>e.pipe(Ut(`${Gr}`),_t((e=>{const{breakoutRoom:n,meeting:{meetingOptions:i}}=t.value,{payload:{hugeBO:r,elapsed:o}}=e,s=[];return n&&(i&&(s.push(fm(r&&!0===i.isBO100Enabled)),s.push(vm({isEnableBreakoutRoom:i.isEnableBreakoutRoom,isEnableBOBroadcast:i.isEnableBOBroadcast,isEnableBOViewActivityStatus:i.isEnableBOViewActivityStatus,isEnableBOBroadcastVoice:i.isEnableBOBroadcastVoice}))),n.currentRoom.boConfId&&s.push(Fn()),void 0!==o&&s.push(Xg(o))),Me(s)}))),epics1:e=>pi(e,4174).pipe(At((e=>{_d(qc,e.payload.body.bid)})),St(ge)),epics2:(e,t)=>mi(e,7950).pipe(Tt(t),_t((e=>{let[n,i]=e;const{payload:{body:{proto:r}}}=n,{breakoutRoom:{isHugeBO:o,currentRoom:{status:s,boId:a}},meeting:{userGUID:u}}=i;let l=r;o&&(l=function(e,t){if(Rk)return Rk.decode(e);var n=function(e){for(var t="",n=0;;){var i=e[n++],r=(i>127)+(i>223)+(i>239);if(n+r>e.length)return[t,hk(e,n-1)];r?3==r?(i=((15&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,t+=String.fromCharCode(55296|i>>10,56320|1023&i)):t+=1&r?String.fromCharCode((31&i)<<6|63&e[n++]):String.fromCharCode((15&i)<<12|(63&e[n++])<<6|63&e[n++]):t+=String.fromCharCode(i)}}(e),i=n[0];return n[1].length&&fk(8),i}(function(e,t){return function(e,t,n){var i=e.length;if(!i||n&&n.f&&!n.l)return t||new jD(0);var r=!t||n,o=!n||n.i;n||(n={}),t||(t=new jD(3*i));var s=function(e){var n=t.length;if(e>n){var i=new jD(Math.max(2*n,e));i.set(t),t=i}},a=n.f||0,u=n.p||0,l=n.b||0,c=n.l,d=n.d,h=n.m,p=n.n,f=8*i;do{if(!c){a=lk(e,u,1);var g=lk(e,u+1,3);if(u+=3,!g){var m=e[(T=dk(u)+4)-4]|e[T-3]<<8,v=T+m;if(v>i){o&&fk(0);break}r&&s(l+m),t.set(e.subarray(T,v),l),n.b=l+=m,n.p=u=8*v,n.f=a;continue}if(1==g)c=ok,d=ak,h=9,p=5;else if(2==g){var y=lk(e,u,31)+257,S=lk(e,u+10,15)+4,b=y+lk(e,u+5,31)+1;u+=14;for(var E=new jD(b),w=new jD(19),_=0;_<S;++_)w[KD[_]]=lk(e,u+3*_,7);u+=3*S;var I=uk(w),C=(1<<I)-1,A=tk(w,I,1);for(_=0;_<b;){var T,R=A[lk(e,u,C)];if(u+=15&R,(T=R>>>4)<16)E[_++]=T;else{var O=0,P=0;for(16==T?(P=3+lk(e,u,3),u+=2,O=E[_-1]):17==T?(P=3+lk(e,u,7),u+=3):18==T&&(P=11+lk(e,u,127),u+=7);P--;)E[_++]=O}}var D=E.subarray(0,y),k=E.subarray(y);h=uk(D),p=uk(k),c=tk(D,h,1),d=tk(k,p,1)}else fk(1);if(u>f){o&&fk(0);break}}r&&s(l+131072);for(var x=(1<<h)-1,N=(1<<p)-1,M=u;;M=u){var F=(O=c[ck(e,u)&x])>>>4;if((u+=15&O)>f){o&&fk(0);break}if(O||fk(2),F<256)t[l++]=F;else{if(256==F){M=u,c=null;break}var L=F-254;if(F>264){var V=HD[_=F-257];L=lk(e,u,(1<<V)-1)+GD[_],u+=V}var j=d[ck(e,u)&N],B=j>>>4;if(j||fk(3),u+=15&j,k=QD[B],B>3&&(V=qD[B],k+=ck(e,u)&(1<<V)-1,u+=V),u>f){o&&fk(0);break}r&&s(l+131072);for(var U=l+L;l<U;l+=4)t[l]=t[l-k],t[l+1]=t[l+1-k],t[l+2]=t[l+2-k],t[l+3]=t[l+3-k];l=U}}n.l=c,n.p=M,n.b=l,n.f=a,c&&(a=1,n.m=h,n.d=d,n.n=p)}while(!a);return l==t.length?t:hk(t,0,l)}(e.subarray(function(e){31==e[0]&&139==e[1]&&8==e[2]||fk(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=e[10]|2+(e[11]<<8));for(var i=(t>>3&1)+(t>>4&1);i>0;i-=!e[n++]);return n+(2&t)}(e),-8),new jD(function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}(e)))}(ar(r))));const c=[];let d;try{const e=JSON.parse(rr(l)),{ControlStatus:r,NameIndex:o,IsAutoJoinEnabled:h,IsBackToMainSessionEnabled:p,IsParticipantsChooseRoomEnabled:f,IsTimerEnabled:g,TimerDuration:m,IsTimerAutoEndEnabled:v,WaitSeconds:y,StartTimeOnMMR:S,ItemList:b,WhoStart:E,WhoStop:w,IsAutoMovetoMainSessionEnabled:_}=e,I={isAutoJoinRoom:h,isBackToMainSessionEnabled:p,isTimerEnabled:g,timerDuration:m,isTimerAutoEnabled:v,waitSeconds:y,isAutoMoveBackToMainSession:_,isRoomSelectionEnabled:f,whoStart:E,whoStop:w};c.push(tm(I)),c.push(em(S)),c.push(Zg(o)),c.push(nm(r));const C=b&&b.map((e=>({boId:e.BID,name:e.MeetingTitle,boStatus:e.Status,hostId:e.HostID,attendeeGuidList:e.ParticipantList||[]})))||[];switch(c.push(im(C)),_d(Qc,{controlStatus:r,roomList:C}),r){case nh.InProgress:if(s!==rh.InRoom&&s!==rh.Joining){const e=function(e,t){const{meeting:{isHost:n,userGUID:i},breakoutRoom:{currentRoom:{status:r,boId:o}}}=t.value,s=Do.get(Ok),a=[];if(s)try{const{status:u,boId:l}=JSON.parse(s);if(u===rh.Invited)if(n)xk();else{const t=kk(e,i);t&&(a.push(Vk(t)),r!==rh.Initial&&o===t.boId||_d(Kc,{roomId:t.boId,name:t.name}))}else if(u===rh.InRoom){let r;if(r=n?e.find((e=>e.boId===l)):kk(e,i),r){a.push(Vk(r));const e=r.boId;Ov(t).subscribe((()=>{Ps.createAgent().joinBO(e)}))}xk()}}catch(e){console.error(e)}return a}(C,t);if(0===e.length){const e=kk(C,u);e&&c.push(Vk(e))}else c.push(...e)}else if(s===rh.InRoom&&n.type===`${Vn}`){const e=kk(C,u);e&&jk(t).subscribe((t=>{a===e.boId||t||qk.joinBO(e.boId)}))}I.isTimerEnabled&&I.timerDuration>0&&(d=function(e,t,n){return jk(e).pipe(Tt(e),_t((i=>{let[r,o]=i;const{breakoutRoom:{currentRoom:{status:s},meetingElapsedTime:a},meeting:{joinMeetingTimeStamp:u}}=o,l=u-1e3*a+1e3*n+1e3*t;if(performance.now()<l){if(r)return ut(1e3).pipe(Ke((()=>Math.floor((l-performance.now())/1e3))),Tt(e),Ct((e=>{let[t,n]=e;const{breakoutRoom:{controlStatus:i,currentRoom:{status:r}},socket:{zoomSocketStatus:o},meeting:{isHost:s}}=n;return t>=0&&s&&i===nh.InProgress&&(r===rh.InRoom||r===rh.MainSession||r===rh.Initial)&&o===Th.Connected})),At((e=>{let[t]=e;_d(Wc,{countdown:t})})),ht((e=>{let[t]=e;return 0===t})),At((e=>{let[,t]=e;const{breakoutRoom:{options:n}}=t;n.isTimerAutoEnabled?Ps.createAgent().stopBO(nh.Closing):_d(Zc)})),St(ge));if(s===rh.InRoom)return ut(1e3).pipe(Ke((()=>Math.floor((l-performance.now())/1e3))),Tt(e),Ct((e=>{let[t,n]=e;const{breakoutRoom:{currentRoom:{status:i}},meeting:{isHost:r},socket:{zoomSocketStatus:o}}=n;return t>=0&&i===rh.InRoom&&!r&&o===Th.Connected})),At((e=>{let[t]=e;_d(Wc,{countdown:t})})),St(ge))}return ge})))}(t,I.timerDuration,S));break;case nh.Closing:d=jk(t).pipe(ht((e=>e)),Ye((()=>{const e=[],{breakoutRoom:{closingRoomTime:n,currentRoom:{status:r}},participants:{attendeesList:o}}=i;let s=I.waitSeconds;if(0!==n&&I.waitSeconds>0){const e=Math.floor((performance.now()-n)/1e3);s=Math.max(I.waitSeconds-e,0)}if(0===s)return qk.stopBO(nh.Closed),ge;{if(r!==rh.InRoom&&o.length>1&&o.every((e=>!e.bid)))return qk.stopBO(nh.Closed),ge;n||e.push(lm(performance.now()));const i=performance.now()+1e3*s;return lt(Me(e),ut(1e3).pipe(Ke((()=>Math.floor((i-performance.now())/1e3))),Tt(t),Ct((e=>{let[t,n]=e;const{breakoutRoom:{controlStatus:i},meeting:{isHost:r},socket:{zoomSocketStatus:o}}=n;return t>=0&&i===nh.Closing&&o===Th.Connected&&r})),At((e=>{let[t]=e;t>=0&&_d($c,{countdown:t})})),ht((e=>{let[t]=e;return 0===t})),At((()=>{qk.stopBO(nh.Closed)})),St(ge)))}})));break;case nh.Closed:c.push(lm(0)),s===rh.Leaving?c.push(om(rh.MainSession)):s===rh.Invited?c.push(om(rh.Initial)):s!==rh.InRoom&&s!==rh.Joining||c.push(...Nk()),xk()}}catch(e){console.error(e)}return d?lt(Me(c),d):Me(c)}))),epics3:(e,t)=>mi(e,4194).pipe(Tt(t),_t((e=>{let[t,n]=e;const{payload:{body:{bid:i,botoken:r,confID:o}}}=t,{meeting:{isHost:s},breakoutRoom:{rooms:a,currentRoom:{status:u}}}=n,l=[],c=a.find((e=>e.boId===i));return c&&(l.push(Vk(c,s)),l.push(sm(o)),l.push(am(r)),s||u!==rh.InRoom?l.push(...Mk(c.name,u)):l.push(...Fk(c.name))),_d(Yc,{boId:i}),Me(l)}))),epics4:(e,t)=>e.pipe(Ut(`${xn}`,`${Vn}`),ht((e=>7949===e.payload.evt)),Tt(t),Ye((e=>{var n;let[i,r]=e;const{payload:{body:o}}=i,{meeting:{userGUID:s},breakoutRoom:{rooms:a,options:{isAutoJoinRoom:u,isAutoMovetoMainSession:l},currentRoom:{status:c},mainSessionAttendeeList:d},participants:{attendeesList:h}}=r,{commandType:p}=o,f=[];let g;const m=null===(n=(Lk(c)?h:d).find((e=>e.userGUID===s)))||void 0===n?void 0:n.userId;switch(p){case oh.Join:{const{targetBID:e,botoken:t,confID:n,joinReason:i,requestSourceID:l}=o,c=kk(a,s);if(c&&c.boId===e){f.push(sm(n)),f.push(am(t));const o=Number(i)===lh.Active&&m===Number(l);u||o?(o&&_d(Yc,{boId:e}),f.push(...Mk(c.name))):(Do.set(ko.WebclientBreakoutRoomCommand,p,Oo.SessionStorage),_d(Kc,{roomId:e,name:c.name,...Hk(l,r)}))}break}case oh.Switch:{const{targetBID:e,botoken:t,confID:n,joinMethod:i,requestSourceID:l}=o,d=kk(a,s);if(d&&d.boId===e){f.push(rm({boId:d.boId,boToken:t,boConfId:n,name:d.name}));const o=m===Number(l)&&Number(i)===uh.AskToLeave;c===rh.Invited?(Do.set(ko.WebclientBreakoutRoomCommand,p,Oo.SessionStorage),u||m===Number(l)?f.push(...Mk(d.name)):_d(Kc,{roomId:e,name:d.name,...Hk(l,r)})):f.push(...Fk(d.name)),o&&_d(Yc,{boId:e})}break}case oh.Leave:{const{waitTime:e,joinMethod:n}=o;if(Lk(c))f.push(rm({boId:"",boToken:"",boConfId:"",status:rh.Initial}));else{const i=Number(e);if(i>0){const e=performance.now()+1e3*i;g=ut(1e3).pipe(Ke((()=>Math.floor((e-performance.now())/1e3))),Tt(t),Ct((e=>{let[t,n]=e;const{breakoutRoom:{controlStatus:i,currentRoom:{status:r}},meeting:{isHost:o},socket:{zoomSocketStatus:s}}=n;return t>=0&&s===Th.Connected&&i===nh.Closing&&r===rh.InRoom&&!o})),At((e=>{let[t]=e;t>=0&&_d($c,{countdown:t})})),St(ge))}else if(Number(n)!==uh.AskToLeave||l)f.push(...Nk());else{var v,y,S;const{requestSourceID:e}=o,t=Number(e),{participants:{attendeesList:n}}=r;let i=n.find((e=>e.userId===t));if(!i){const{breakoutRoom:{mainSessionAttendeeList:e}}=r;i=e.find((e=>e.userId===t))}_d(nd,{inviterId:null===(v=i)||void 0===v?void 0:v.userId,inviterGuid:null===(y=i)||void 0===y?void 0:y.userGUID,inviterName:null===(S=i)||void 0===S?void 0:S.displayName})}xk()}break}case oh.Broadcast:{const{textContent:e,requestID:t}=o;if(e){const{meeting:{encType:n},participants:{attendeesList:i},breakoutRoom:{mainSessionAttendeeList:o}}=r;let s="";if(n===Jo.AES_GCM){const e=(Lk(c)?i:o).find((e=>e.userId===Number(t)));e&&(s=e.zoomID)}g=Me(es.beginDecrypt({decryptedText:e,type:Qo.BO_BROADCAST,zoomId:s}).then((e=>{let{message:t}=e;return _d(Gc,{message:t}),cm(t)})))}break}case oh.HelpReq:{const{requestID:e}=o,{breakoutRoom:{mainSessionAttendeeList:t,rooms:n,currentRoom:{boId:i},hostReplyToQuestionerType:s,hostReplyToRequestId:a},participants:{attendeesList:u}}=r;if(e){if(c===rh.InRoom){const n=t.find((t=>t.userId===e));if(n&&n.bid===i){qk.askForHelpResultBO(e,ah.AlreadyInRoom);break}}if(s===ah.Received&&a!==e)qk.askForHelpResultBO(e,ah.Busy);else{qk.askForHelpResultBO(e,ah.Received),f.push(dm(ah.Received),hm(e));const i=(c===rh.InRoom?t:u).find((t=>t.userId===e));if(i){const t=i.bid,r=n.find((e=>e.boId===t));r&&_d(zc,{userId:e,userGuid:i.userGUID,displayName:i.displayName,roomName:r.name,roomId:r.boId})}}}break}case oh.HelpRes:{const{helpResult:e}=o;_d(Jc,{result:Number(e)});break}case oh.BOActivity:{var b;const{activityRoster:e,activityTalking:t,requestID:n}=o,i=null===(b=(fT(r)?r.breakoutRoom.mainSessionAttendeeList:r.participants.attendeesList).find((e=>e.userId===n)))||void 0===b?void 0:b.userGUID;if(i){const{breakoutRoom:{rooms:o}}=r,s=kk(o,i),a=function(e,t){const n={isTalking:1===t};return Uk.forEach((t=>{const{mask:i,key:r,value:o}=t;return(i&e)===i&&Object.assign(n,{[`${r}`]:o}),n})),n}(Number(e),Number(t));f.push(ym({userGuid:i,status:a})),_d(id,{...a,userId:n,userGuid:i,roomId:null==s?void 0:s.boId,roomName:null==s?void 0:s.name})}break}}return g?lt(Me(f),g):Me(f)}))),epics5:(e,t)=>fi(e,as).pipe(Tt(t),_t((e=>{let[t,n]=e;const{payload:{body:{res:i,elapsed:r}}}=t,o=[];return i===wr.MeetingHasClosed||i===wr.UserHasBeenRemoved?(xk(),o.push(...zv(n,!1))):i===wr.Success&&(o.push(Xg(r)),o.push(om(rh.InRoom)),Do.set(ko.WebclientBreakoutRoomAttendeeStatus,JSON.stringify({status:rh.InRoom,boId:n.breakoutRoom.currentRoom.boId}),Oo.SessionStorage)),Me(o)}))),epics6:(e,t)=>fi(e,is).pipe(Ke((e=>Ew(e.payload.body))),Tt(t),Ye((e=>{let[t,n]=e;const i=[pm(t)],{participants:{attendeesList:r},breakoutRoom:{mainSessionAttendeeList:o,isUserRoleUpdated:s},meeting:{userId:a}}=n;let u=[];return["add","update"].forEach((e=>t[e]&&u.push(...t[e]))),u=u.filter((e=>Kk.some((t=>void 0!==e[t])))).map((e=>{const t=o.find((t=>t.userId===e.userId));if(t){const n=r.find((e=>e.zoomID===t.zoomID));if(n)return void 0===e.userRole||s||n.userId!==a||(i.push(mm(!0)),_d(Xc,e)),void 0!==e.bCCEditor&&i.push(Ng({editorId:e.bCCEditor?n.userId:"",isEditor:!!e.bCCEditor,editorZoomId:e.bCCEditor?n.zoomID:""})),delete e.bRaiseHand,delete e.bCapsPinMultiVideo,{...e,userId:n.userId}}return null})).filter((e=>!!e)),u.length>0&&(_d(Us,u),i.push(Rd({update:u}))),_d(td),Me(i)}))),epics7:e=>fi(e,rs).pipe(ht((e=>{const{payload:{body:t}}=e;return void 0!==(null==t?void 0:t.bAllowAttendeeRename)||void 0!==(null==t?void 0:t.chatPriviledge)||void 0!==(null==t?void 0:t.lockShare)})),Ke((e=>{const{payload:{body:t}}=e;return void 0!==t.bAllowAttendeeRename?zr(e.payload.body):void 0!==t.chatPriviledge?bg(t.chatPriviledge):void 0!==t.lockShare?Ep(t.lockShare):void 0}))),epics8:(e,t)=>pi(e,is).pipe(Tt(t),ht((e=>{let[,t]=e;const{meeting:{isHost:n},breakoutRoom:{controlStatus:i,currentRoom:{status:r}}}=t;return n&&i===nh.Closing&&r!==rh.InRoom})),ke(ce),At((()=>{const{participants:{attendeesList:e}}=t.value;e.every((e=>!e.bid))&&e.length>1&&qk.stopBO(nh.Closed)})),St(ge)),epics9:(e,t)=>pi(e,4214).pipe(Tt(t),_t((e=>{let[n,i]=e;const{payload:{body:{proto:r}}}=n,{breakoutRoom:{rooms:o,isHugeBO:s}}=i;try{const e=JSON.parse(rr(r)),n=[];if(e&&e.PreAssignBoList&&Array.isArray(e.PreAssignBoList)){const i=e.PreAssignBoList.map((e=>({name:e.BoName,emails:e.email})));n.push(gm(i));const r=s?100:50;if(o.length+i.length<r){const e=i.map((e=>e.name));return qk.batchCreateBOToken(e),lt(Me(n),Bk(e.length).pipe(Tt(t),Ye((e=>{let[{boIdList:t},n]=e;const r=bh(n),o=i.map(((e,n)=>{const{emails:i,name:o}=e;let s=[];return i&&Array.isArray(i)&&(s=i.map((e=>r.filter((t=>t.userEmail===e)).map((e=>e.userGUID)))).reduce(((e,t)=>[...e,...t]),[])),{boId:t[n],name:o,attendeeGuidList:s}})),s=o.map(((e,t)=>({roomId:e.boId,name:e.name,emails:i[t].emails})));return _d(ed,{rooms:s}),Me([im(o),gm(s)])}))))}return Me(n)}}catch(e){console.error("pre assign proto is not valid")}return ge}))),epics10:(e,t)=>mi(e,is).pipe(Tt(t),ht((e=>{let[t,n]=e;const{meeting:{isHost:i,meetingStatus:r,meetingOptions:o},breakoutRoom:{controlStatus:s}}=n,{payload:{body:a}}=t;return r===Co.Joined&&(null==o?void 0:o.isAllowBreakoutRoomPreAssign)&&i&&(s===nh.NotStarted||s===nh.InProgress)&&Array.isArray(a.add)})),Ye((e=>{let[t,n]=e;const{breakoutRoom:{controlStatus:i,rooms:r,preAssignedRooms:o,currentRoom:{status:s}},participants:{failoverAttendeesList:a}}=n,u=null==o?void 0:o.filter((e=>r.findIndex((t=>t.boId===e.roomId))>-1)),{payload:{body:{add:l}}}=t,c=[];return u.length>0&&l.filter((e=>e.userEmail&&e.userGUID)).filter((e=>-1===a.findIndex((t=>t.zoomID===e.zoomID)))).forEach((e=>{if(!kk(r,e.userGUID))for(let n=0;n<(null==u?void 0:u.length);n++){const o=u[n];if(o.emails.includes(e.userEmail)){if(i===nh.NotStarted){const t=hE(r,(t=>{const n=t.find((e=>e.boId===o.roomId));null==n||n.attendeeGuidList.push(e.userGUID)}));c.push(im(t))}else i===nh.InProgress&&(s===rh.InRoom&&t.type===`${Vn}`?qk.assignToBO(e.id,String(o.roomId)):s!==rh.Initial&&s!==rh.MainSession||qk.assignToBO(e.id,String(o.roomId)));break}}})),Me(c)}))),epics11:(e,t)=>pi(e,is).pipe(ht((e=>{const{breakoutRoom:{mainSessionAttendeeList:n}}=t.value,{payload:{body:i}}=e;return n.length>0&&(void 0!==i.add||void 0!==i.update)})),ke(de),Ke((e=>Ew(e.payload.body))),Ye((e=>{const{breakoutRoom:{mainSessionAttendeeList:n,isUserRoleUpdated:i},participants:{attendeesList:r}}=t.value;let o=[];const s=[];["add","update"].forEach((t=>e[t]&&o.push(...e[t])));const a=[...Kk,"isHost"];o=o.filter((e=>a.some((t=>void 0!==e[t]))));const u=o.filter((e=>void 0!==e.zoomID));return o=o.map((e=>{var t,o,l,c;const d=null!==(t=null!==(o=e.zoomID)&&void 0!==o?o:null===(l=u.find((t=>t.userId===e.userId)))||void 0===l?void 0:l.zoomID)&&void 0!==t?t:null===(c=r.find((t=>t.userId===e.userId)))||void 0===c?void 0:c.zoomID;if(d){const t=n.find((e=>e.zoomID===d));if(t)return i||(s.push(mm(!0)),_d(Xc,t)),Object.keys(e).filter((t=>Object.prototype.hasOwnProperty.call(e,t))).filter((e=>a.includes(e))).reduce(((n,i)=>{const r=t[i];if(void 0!==r||"bCoHost"===i){const t="boolean"==typeof e[i]?!!r:r;Object.assign(n,{[i]:t})}return n}),{userId:e.userId})}})).filter(Boolean),o.length>0&&(_d(Us,o),s.push(Rd({update:o}))),Me(s)}))),epics12:e=>fi(e,7999).pipe(At((e=>{const{payload:{body:{bStatus:t}}}=e;_d(rd,{status:!!t})})),Ye((()=>ge))),epics13:(e,t)=>pi(e,7940).pipe(Ye((e=>{const{payload:{body:{bHost:n}}}=e,{breakoutRoom:{isBroadcastVoice:i}}=t.value,r=[];return!n&&i&&(Ls.getInstance().broadcastVoiceToBreakoutRoom(!1),r.push(Sm(!1))),Me(r)})))},ex=hi(Xk,Zk);let tx=function(e){return e[e.Ready=0]="Ready",e[e.UserSub=1]="UserSub",e[e.ManualCaptionerEnabled=2]="ManualCaptionerEnabled",e[e.ManualCaptionerDisabled=3]="ManualCaptionerDisabled",e}({}),nx=function(e){return e[e.Unspecified=-1]="Unspecified",e[e.English=0]="English",e[e["Chinese (Simplified)"]=1]="Chinese (Simplified)",e[e.Japanese=2]="Japanese",e[e.German=3]="German",e[e.French=4]="French",e[e.Russian=5]="Russian",e[e.Portuguese=6]="Portuguese",e[e.Spanish=7]="Spanish",e[e.Korean=8]="Korean",e[e.Italian=9]="Italian",e[e.Reserved=10]="Reserved",e[e.Vietnamese=11]="Vietnamese",e[e.Dutch=12]="Dutch",e[e.Ukrainian=13]="Ukrainian",e[e.Arabic=14]="Arabic",e[e.Bengali=15]="Bengali",e[e["Chinese (Traditional)"]=16]="Chinese (Traditional)",e[e.Czech=17]="Czech",e[e.Estonian=18]="Estonian",e[e.Finnish=19]="Finnish",e[e.Greek=20]="Greek",e[e.Hebrew=21]="Hebrew",e[e.Hindi=22]="Hindi",e[e.Hungarian=23]="Hungarian",e[e.Indonesian=24]="Indonesian",e[e.Malay=25]="Malay",e[e.Persian=26]="Persian",e[e.Polish=27]="Polish",e[e.Romanian=28]="Romanian",e[e.Swedish=29]="Swedish",e[e.Tamil=30]="Tamil",e[e.Telugu=31]="Telugu",e[e.Tagalog=32]="Tagalog",e[e.Turkish=33]="Turkish",e[e.NoTranslation=400]="NoTranslation",e[e.DefaultManualInput=401]="DefaultManualInput",e[e.Customized=500]="Customized",e}({}),ix=function(e){return e[e.Unknown=0]="Unknown",e[e.Close=1]="Close",e[e.New=2]="New",e[e.Insert=3]="Insert",e[e.Delete=4]="Delete",e[e.Reset=5]="Reset",e[e.Audiodesc=6]="Audiodesc",e[e.Speaker=7]="Speaker",e[e.Error=8]="Error",e}({}),rx=function(e){return e[e.TranslateNotSupport=1]="TranslateNotSupport",e}({}),ox=function(e){return e[e.Unspecified=0]="Unspecified",e[e.InMeetingManual=1]="InMeetingManual",e[e.ExternalCaptioner=2]="ExternalCaptioner",e[e.ASR=4]="ASR",e}({});const sx={en:0,zh:1,ja:2,de:3,fr:4,ru:5,pt:6,es:7,ko:8,it:9,en1:10,vi:11,nl:12,uk:13,ar:14,bn:15,"zh-hant":16,cs:17,et:18,fi:19,el:20,he:21,hi:22,hu:23,id:24,ms:25,fa:26,pl:27,ro:28,sv:29,ta:30,te:31,tl:32,tr:33},ax=Object.keys(nx).filter((e=>/\d+/.test(nx[e]))).reduce(((e,t)=>({...e,[`${nx[t]}`]:t})),{}),ux=Object.keys(sx).reduce(((e,t)=>(Object.assign(e,{[`${sx[`${t}`]}`]:t}),e)),{}),lx="zoom-sdk-live-trasncription",cx="live-trasncription";let dx=function(e){return e[e.English=0]="English",e[e.Chinese=1]="Chinese",e[e.Japanese=2]="Japanese",e[e.German=3]="German",e[e.French=4]="French",e[e.Russian=5]="Russian",e[e.Portuguese=6]="Portuguese",e[e.Spanish=7]="Spanish",e[e.Korean=8]="Korean",e[e.Italian=9]="Italian",e[e.Reserved=10]="Reserved",e[e.Vietnamese=11]="Vietnamese",e[e.Dutch=12]="Dutch",e[e.Ukrainian=13]="Ukrainian",e[e.Arabic=14]="Arabic",e[e.Bengali=15]="Bengali",e[e["Chinese (Traditional)"]=16]="Chinese (Traditional)",e[e.Czech=17]="Czech",e[e.Estonian=18]="Estonian",e[e.Finnish=19]="Finnish",e[e.Greek=20]="Greek",e[e.Hebrew=21]="Hebrew",e[e.Hindi=22]="Hindi",e[e.Hungarian=23]="Hungarian",e[e.Indonesian=24]="Indonesian",e[e.Malay=25]="Malay",e[e.Persian=26]="Persian",e[e.Polish=27]="Polish",e[e.Romanian=28]="Romanian",e[e.Swedish=29]="Swedish",e[e.Tamil=30]="Tamil",e[e.Telugu=31]="Telugu",e[e.Tagalog=32]="Tagalog",e[e.Turkish=33]="Turkish",e[e.NoTranslation=400]="NoTranslation",e[e.DefaultManualInput=401]="DefaultManualInput",e}({}),hx=function(e){return e.English="en",e["Chinese (Simplified)"]="zh",e.Japanese="ja",e.German="de",e.French="fr",e.Russian="ru",e.Portuguese="pt",e.Spanish="es",e.Korean="ko",e.Italian="it",e.Reserved="en1",e.Vietnamese="vi",e.Dutch="nl",e.Ukrainian="uk",e.Arabic="ar",e.Bengali="bn",e["Chinese (Traditional)"]="zh-hant",e.Czech="cs",e.Estonian="et",e.Finnish="fi",e.Greek="el",e.Hebrew="he",e.Hindi="hi",e.Hungarian="hu",e.Indonesian="id",e.Malay="ms",e.Persian="fa",e.Polish="pl",e.Romanian="ro",e.Swedish="sv",e.Tamil="ta",e.Telugu="te",e.Tagalog="tl",e.Turkish="tr",e}({});function px(e){const t=e===nx.Unspecified?nx.Reserved:e;Ls.getInstance().selectLanguageChannelForNewLTT(t)}const fx=qd(Hd,(function(e,t){return qC(e,t)}))([bh,e=>{let{meeting:{gatewayUserList:t}}=e;return t}],((e,t)=>{const n={};return e.forEach((e=>{Object.assign(n,{[`${e.userId}`]:e.zoomID})})),null==t||t.forEach((e=>{Object.assign(n,{[`${e.userId}`]:e.sn})})),n})),gx=Kd([bh],(e=>e.find((e=>!0===e.bCCEditor)))),mx=Kd([bh,Wd],((e,t)=>e.some((e=>!0===e.bCCEditor&&e.userId===t)))),vx=Ps.createAgent(),yx={isEnableTranslatedCaptions:!1,isHostLockSpeakingLanguage:!1,transcriptionLang:[],isEnableAutomatedCaptions:!1,supportedTranscriptionLanguage:[],isLiveTranscriptionEnabled:!1,isHostDisableCaptions:!1,isManualCaptionerEnabled:!1,gatewayId:void 0,isLiveTranscriptionSubscribed:!1,messageRecords:[],isRecordsReduced:!1,reducedRecordsCount:0},Sx=Rn({[`${Bm}`]:hE(((e,t)=>{let{payload:n}=t;e.isLiveTranscriptionEnabled=n})),[`${Um}`]:hE(((e,t)=>{let{payload:n}=t;const{transcriptionLang:i,translatedSetting:r,...o}=n;i&&(e.transcriptionLang=i.split(";").map((e=>{const t=e&&sx[e];return void 0!==t?{lang:e,code:t}:null})).filter(Boolean)),r&&(e.translatedSetting=Object.keys(r).map((e=>{const t=r[e];if(t){const n=t.split(";").map((e=>{const t=e&&sx[e];return void 0!==t?{lang:e,code:t}:null})).filter(Boolean);return{lang:e,code:sx[e],translatedToLanguage:n}}return null})).filter(Boolean)),Object.assign(e,o)})),[`${Hm}`]:hE(((e,t)=>{let{payload:n}=t;e.isManualCaptionerEnabled=n})),[`${qm}`]:hE(((e,t)=>{let{payload:n}=t;e.gatewayId=n})),[`${tv}`]:hE(((e,t)=>{let{payload:n}=t;e.isHostDisableCaptions=n})),[`${Km}`]:hE(((e,t)=>{let{payload:n}=t;e.supportedTranscriptionLanguage=n})),[`${Wm}`]:hE(((e,t)=>{let{payload:n}=t;e.currentTranscriptionLang=n})),[`${Gm}`]:hE(((e,t)=>{let{payload:n}=t;e.currentTranslationLang=n})),[`${zm}`]:hE(((e,t)=>{let{payload:n}=t;e.messageRecords.push(n)})),[`${Jm}`]:hE(((e,t)=>{let{payload:n}=t;const i=e.messageRecords.find((e=>e.msgId===n.msgId));i&&Object.assign(i,n)})),[`${Qm}`]:hE(((e,t)=>{let{payload:n}=t;const{remains:i,reducedRecordsCount:r}=n,o=e.messageRecords.length-i;e.isRecordsReduced=!0,e.reducedRecordsCount=r,e.messageRecords.splice(0,o)})),[`${$m}`]:hE(((e,t)=>{let{payload:n}=t;e.isLiveTranscriptionSubscribed=n})),[`${Ym}`]:hE(((e,t)=>{let{payload:n}=t;e.liveTransEngineType=n})),[`${Zm}`]:hE((e=>{e.stateBeforeFailover=void 0})),[`${Xm}`]:hE(((e,t)=>{let{payload:n}=t;e.lastManualCaption=n})),[`${ev}`]:(e,t)=>{let{payload:n}=t;return n?{...yx,stateBeforeFailover:{currentTranscriptionLang:e.currentTranscriptionLang,currentTranslationLang:e.currentTranslationLang,isLiveTranscriptionSubscribed:e.isLiveTranscriptionSubscribed},messageRecords:e.messageRecords,isRecordsReduced:e.isRecordsReduced,reducedRecordsCount:e.reducedRecordsCount}:{...yx}}},yx);var bx;const Ex=Ps.createAgent(),wx=oT("Live transcription");let _x=(bx=class extends aT{startLiveTranscription(){const{[GA]:e,[zA]:t}=this,{liveTranscription:{isLiveTranscriptionEnabled:n,isEnableTranslatedCaptions:i,isLiveTranscriptionSubscribed:r,isHostLockSpeakingLanguage:o,isHostDisableCaptions:s}}=e();return r?Promise.resolve(""):s?Promise.reject({type:yc,reason:"Captions has been disabled by host."}):n?(Ex.enableNewLLT(),Cd(na).then((()=>(o?Ex.setSpokenLanguage(nx.English):px(nx.Unspecified),t(Wm(nx.English)),i&&Ex.setTranslationLanguage(),Cd({event:na,operations:[ht((e=>!0===e.autoCaption&&void 0!==e.lang))]}))))):Promise.reject({type:yc,reason:"Live transcription is not enabled."})}disableCaptions(e){const{[GA]:t}=this,{liveTranscription:{isHostDisableCaptions:n}}=t();return e?n?Promise.resolve():(Ex.disableCaptions(!0),Cd(ra)):n?(Ex.disableCaptions(!1),Cd(ra)):Promise.resolve()}setSpeakingLanguage(e){const{[GA]:t,[zA]:n}=this,{liveTranscription:{isLiveTranscriptionSubscribed:i,isHostLockSpeakingLanguage:r,transcriptionLang:o}}=t(),s=o.find((t=>t.lang===e));if(s){const{code:e}=s;return i?(r?Ex.setSpokenLanguage(e):px(e),n(Wm(e)),Promise.resolve("")):Promise.reject({type:yc,reason:"Cannot set speaking language before starting live transcription"})}return Promise.reject({type:_c,reason:"Unsupported transcription language"})}setTranslationLanguage(e){const{[GA]:t,[zA]:n}=this,i=t(),{liveTranscription:{isEnableTranslatedCaptions:r,isLiveTranscriptionSubscribed:o,translatedSetting:s,currentTranscriptionLang:a}}=i;if(!r)return Promise.reject({type:yc,reason:"Live translation is not enabled."});if(!o)return Promise.reject({type:yc,reason:"Cannot set translation language before starting live transcription"});if(e){const t=null==s?void 0:s.find((e=>e.code===a));if(t){const{translatedToLanguage:n}=t,i=n.find((t=>t.lang===e));if(i)return Ex.setTranslationLanguage(i.code),Cd({event:na,operations:[ht((e=>!0===e.autoCaption&&e.lang===i.code)),gt(1)]},(e=>{let{lang:t}=e;return t===i.code}))}return Promise.reject({type:yc,reason:`Cannot support translating ${ax[a||0]} to ${e}`})}return Ex.setTranslationLanguage(),n(Gm(void 0)),Promise.resolve("")}enableManualCaptioner(){const{[GA]:e}=this,{meeting:{meetingOptions:t},liveTranscription:{isManualCaptionerEnabled:n,isHostDisableCaptions:i}}=e();if(i)return Promise.reject({type:yc,reason:"Captions has been disabled by host."});const{isEnableManualCaptions:r,isEnableClosedCaption:o}=t;return(null!=r?r:o)?n?Promise.resolve():(Ex.enableManualCaption(!0),Cd(na,(e=>{let{autoCaption:t}=e;return!1===t}))):Promise.reject({type:yc,reason:"Manual caption is not enabled."})}disableManualCaptioner(){const{[GA]:e}=this,{liveTranscription:{isManualCaptionerEnabled:t}}=e();return t?(Ex.enableManualCaption(!1),Cd(na,(e=>{let{autoCaption:t}=e;return!0===t}))):Promise.resolve()}assignManualCaption(e){var t;const{[GA]:n}=this,i=n(),{liveTranscription:{isManualCaptionerEnabled:r},participants:{attendeesList:o},meeting:{userId:s}}=i;if(!r)return Promise.reject({type:yc,reason:"Cannot assign caption editor due to the manual captioner is not enabled."});if((null===(t=gx(i))||void 0===t?void 0:t.userId)===e)return Promise.resolve("");const a=o.find((t=>t.userId===e));return a?(Ex.assignCC(e,!0),Cd({event:s===e?js:Us,operations:[ht((t=>t.userId===e)),gt(1)]},(e=>!0===e.bCCEditor))):Promise.reject({type:_c,reason:"Cannot find the user"})}sendCaptionTextManually(e,t){var n;const{[GA]:i,[zA]:r}=this,o=i(),{liveTranscription:{lastManualCaption:s},meeting:{userId:a}}=o,u=gh(o);let l=Promise.resolve();const c=null===(n=gx(o))||void 0===n?void 0:n.userId;return null!=u&&u.isHost&&c!==a&&(l=this.assignManualCaption(a)),l.then((()=>mx(i())?function(e,t,n){const i=e.length,r=[];var o;if(n)r.push({op:"close",text:e,msgId:null!==(o=null==t?void 0:t.msgId)&&void 0!==o?o:cr()});else if(t&&null!=t&&t.text){const n=t.text.length;let o=0,s=0;for(;e[o]===t.text[o]&&o<i;)s+=ur(e[o]),o+=1;o===n&&o===i?r.push({op:"same"}):o===n&&o<i?r.push({op:"insert",text:e.slice(o),size:0,pos:s,msgId:t.msgId}):o<n&&o===i?r.push({op:"delete",size:0,pos:s,msgId:t.msgId}):(r.push({op:"delete",size:0,pos:s,msgId:t.msgId}),r.push({op:"insert",text:e.slice(o),pos:s,msgId:t.msgId}))}else i>0&&r.push({op:"start",text:e,pos:0,size:0,msgId:cr()});return r.filter((e=>"same"!==e.op))}(e,s,t):Promise.reject({type:Ec,reason:"Cannot type caption "}))).then((e=>Array.isArray(e)?(e.forEach((e=>{const{text:n,...i}=e;es.beginEncrypt({text:null!=n?n:"",type:Qo.CC_MESSAGE}).then((o=>{Ex.sendManualCaption({text:o,...i});const s=t?void 0:{text:n,msgId:e.msgId};r(Xm(s))}))})),Cd(ta,(e=>e.source===ox.InMeetingManual))):""))}getLiveTranscriptionStatus(){const{[GA]:e}=this,{liveTranscription:{isLiveTranscriptionEnabled:t,isEnableTranslatedCaptions:n,isManualCaptionerEnabled:i,transcriptionLang:r,translatedSetting:o,isHostDisableCaptions:s}}=e();return{isLiveTranscriptionEnabled:t,isLiveTranslationEnabled:n,isHostDisableCaptions:s,isManualCaptionerEnabled:i,transcriptionLanguage:r.map((e=>e.lang)).join(";"),translationLanguage:null==o?void 0:o.map((e=>({speakingLanguage:e.lang,translatedToLanguage:e.translatedToLanguage.map((e=>e.lang)).join(";")})))}}getLiveTranscriptionSetting(){const{[GA]:e}=this,{meeting:{meetingOptions:t}}=e(),{isEnableManualCaptions:n,isEnableLiveTranscription:i,isEnableClosedCaption:r,isEnableAllowThirdPartyCCToken:o,isEnableViewFullTranscript:s,isEnableSaveCaptions:a}=t||{};return{isEnableManualCaptions:n,isEnableLiveTranscription:i,isEnableClosedCaption:r,isEnableAllowThirdPartyCCToken:o,isEnableViewFullTranscript:s,isEnableSaveCaptions:a}}getCurrentTranscriptionLanguage(){const{[GA]:e}=this,{liveTranscription:{currentTranscriptionLang:t}}=e();return void 0!==t?{code:ux[t],name:ax[t]}:null}getCurrentTranslationLanguage(){const{[GA]:e}=this,{liveTranscription:{currentTranslationLang:t}}=e();return void 0!==t?{code:ux[t],name:ax[t]}:null}getLatestTranscription(){const{[GA]:e}=this,{liveTranscription:{messageRecords:t,isManualCaptionerEnabled:n}}=e(),i=n?nx.DefaultManualInput:nx.NoTranslation,r=t.filter((e=>e.language===i));return r.length?r[r.length-1].text:""}getLatestTranslation(){const{[GA]:e}=this,{liveTranscription:{messageRecords:t,currentTranslationLang:n,isEnableTranslatedCaptions:i}}=e();if(i||void 0!==n){const e=t.filter((e=>e.language===n));return e.length?e[e.length-1].text:""}return""}getFullTranscriptionHistory(){const{[GA]:e}=this,t=e(),{liveTranscription:{messageRecords:n,isRecordsReduced:i}}=t;return i?function(e){return void 0!==window.indexedDB?new Promise((t=>{const n=window.indexedDB.open(lx,1);n.addEventListener("success",(()=>{const i=n.result;if(i.objectStoreNames.contains(cx)){const n=i.transaction([cx],"readonly").objectStore(cx),r=[],o=e.meeting.meetingId,s=n.openCursor();s.onsuccess=()=>{const e=s.result;e?(e.value.mid===o&&r.push(...e.value.records),e.continue()):(t(r),i.close())}}else t("")}))})):Promise.resolve("")}(t).then((e=>Array.isArray(e)?e.concat(n):[...n])):[...n]}getManualCaptionEditor(){const{[GA]:e}=this,t=e(),{closedCaption:{editorId:n}}=t;let i;if(!n)return{};if(i=bh(t).find((e=>e.userId===n)),!i)return{};const{userId:r,isHost:o,displayName:s,avatar:a,bCoHost:u,zoomID:l}=i;return{userId:r,isHost:o,displayName:s,avatar:a,bCoHost:u,zoomID:l}}getManualCaptionUrl(){const{[GA]:e}=this,{meeting:{meetingOptions:t,ccUrl:n}}=e(),{isEnableManualCaptions:i}=t||{};return i?n:(console.warn("you not enable manual caption"),"")}},$A(bx.prototype,"startLiveTranscription",[YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"startLiveTranscription"),bx.prototype),$A(bx.prototype,"disableCaptions",[XA,YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"disableCaptions"),bx.prototype),$A(bx.prototype,"setSpeakingLanguage",[YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"setSpeakingLanguage"),bx.prototype),$A(bx.prototype,"setTranslationLanguage",[YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"setTranslationLanguage"),bx.prototype),$A(bx.prototype,"enableManualCaptioner",[XA,YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"enableManualCaptioner"),bx.prototype),$A(bx.prototype,"disableManualCaptioner",[XA,YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"disableManualCaptioner"),bx.prototype),$A(bx.prototype,"assignManualCaption",[YA,XA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"assignManualCaption"),bx.prototype),$A(bx.prototype,"sendCaptionTextManually",[YA,wx],Object.getOwnPropertyDescriptor(bx.prototype,"sendCaptionTextManually"),bx.prototype),bx);const Ix={epics0:e=>e.pipe(Ut(`${jr}`),Ke((e=>{const{payload:{liveTranscription:t}}=e;return Um(t)}))),epics1:(e,t)=>pi(e,rs).pipe(ht((e=>{var t,n;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.NewLttAvaliable)||void 0!==(null===(n=e.payload.body)||void 0===n?void 0:n.LiveTransEngineType)})),Ke((e=>{const{payload:{body:{NewLttAvaliable:n,LiveTransEngineType:i}}}=e,{liveTranscription:{isEnableAutomatedCaptions:r}}=t.value;return void 0!==n?(_d(ia,!!n),Bm(r&&!!n)):Ym(i)}))),epics2:(e,t)=>pi(e,7982).pipe(Ye((e=>{const{payload:{body:{status:n,gwId:i}}}=e,r=[];switch(n){case tx.Ready:r.push(qm(i));break;case tx.ManualCaptionerEnabled:_d(na,{autoCaption:!1}),r.push(Hm(!0));break;case tx.ManualCaptionerDisabled:_d(na,{autoCaption:!0}),r.push(Ng({editorId:"",isEditor:!1,editorZoomId:""})),r.push(Hm(!1));break;case tx.UserSub:{_d(na,{autoCaption:t.value.liveTranscription.isLiveTranscriptionEnabled});const{liveTranscription:{stateBeforeFailover:e}}=t.value;if(null!=e&&e.isLiveTranscriptionSubscribed){var o;vx.enableNewLLT();const t=null!==(o=e.currentTranscriptionLang)&&void 0!==o?o:nx.Unspecified;px(t),r.push(Wm(t)),void 0!==e.currentTranslationLang&&vx.setTranslationLanguage(e.currentTranslationLang),r.push(Zm())}break}}return Me(r)}))),epics3:e=>pi(e,7984).pipe(Ke((e=>{const{payload:{body:{langs:t}}}=e;return Km(t)}))),epics4:e=>pi(e,8011).pipe(Ye((e=>{const{payload:{body:{disabled:t}}}=e,n=[];return _d(ra,t),n.push(tv(t)),t&&n.push($m(!1)),Me(n)}))),epics5:e=>pi(e,7985).pipe(ht((e=>{var t;return!0===(null===(t=e.payload.body)||void 0===t?void 0:t.success)})),Ye((e=>{const{payload:{body:{src:t,lang:n,success:i}}}=e,r=[];return i&&r.push($m(!0)),t===ox.ASR?(n===nx.NoTranslation?r.push(Gm(void 0)):r.push(Gm(n)),_d(na,{autoCaption:!0,lang:n})):[ox.InMeetingManual,ox.ExternalCaptioner].includes(t)&&_d(na,{autoCaption:!1}),Me(r)}))),epics6:(e,t)=>pi(e,7986).pipe(Tt(t),Ye((e=>{let[t,n]=e;const i=gh(n),{liveTranscription:{currentTranscriptionLang:r}}=n,{payload:{body:o}}=t,s=[];if(void 0!==(null==o?void 0:o.lang)){const{lang:e}=o;"computer"===(null==i?void 0:i.audio)&&r!==e&&px(e),s.push(Wm(e))}return Me(s)}))),epics7:(e,t)=>vi(e,Da.JoinComputerAudioComplete).pipe(ht((()=>t.value.liveTranscription.isLiveTranscriptionSubscribed)),At((()=>{const{liveTranscription:{currentTranscriptionLang:e}}=t.value;e&&px(e)})),St(ge)),epics8:(e,t)=>pi(e,7983).pipe(ht((e=>void 0!==e.payload.body)),Ye((e=>{const{payload:{body:{msgType:n,errorCode:i,language:r,source:o,content:s,keyNodeId:a,msgId:u,nodeId:l,pos:c,size:d,audioLanguage:h}}}=e;if(n===ix.Error){if(i===rx.TranslateNotSupport){const{liveTranscription:{currentTranslationLang:e}}=t.value;e&&_d(ta,{error:rx.TranslateNotSupport,errorMessage:`${ax[h]} to ${ax[e]} translation is not supported!`,audioLanguage:h,translationLang:e})}}else{const e=t.value,i=bh(e),{liveTranscription:{isManualCaptionerEnabled:h}}=e;if(h&&o===ox.ASR)return Promise.resolve();if(function(e,t){const{liveTranscription:{isEnableTranslatedCaptions:n,isLiveTranscriptionEnabled:i},meeting:{meetingOptions:r}}=t,{isEnableManualCaptions:o,isEnableAllowHostAssignTypeCC:s,isEnableClosedCaption:a,isEnableAllowThirdPartyCCToken:u}=r;return e===ox.ASR?n||i:e===ox.InMeetingManual?o&&s||void 0===o&&a:e===ox.ExternalCaptioner?u:void 0}(o,e)&&s&&a){const p=fx(e)[a];if(p)return es.beginDecrypt({decryptedText:s,type:Qo.CC_MESSAGE,zoomId:p}).then((e=>{let{message:s}=e;const{liveTranscription:{messageRecords:a}}=t.value,p=[],f=a.find((e=>e.msgId===u));if(f){const{text:e}=f,t=((e,t)=>{if(!e||0===t)return"";let n=0;for(let i=0;i<e.length;i++)if(n+=ur(e[i]),n===t)return e.slice(0,i+1);return e})(e,c);let i;n===ix.Insert&&0===d||n===ix.Delete&&0===d?i={...f,text:t+s,msgType:n}:n===ix.Close&&(i={...f,text:s,msgType:n,done:!0}),i&&(p.push(Jm(i)),_d(ta,i))}else if([ix.New,ix.Close].includes(n)||h&&n===ix.Insert){const e=i.find((e=>e.userId===l)),t={msgId:u,userId:l,displayName:null==e?void 0:e.displayName,avatar:null==e?void 0:e.avatar,text:s,source:o,language:r,timestamp:(new Date).getTime(),done:n===ix.Close};p.push(zm({...t,msgType:n})),_d(ta,t)}return p}))}}return Promise.resolve()})),Ye((e=>Array.isArray(e)?Me(e):ge))),epics9:(e,t)=>e.pipe(Ut(`${zm}`),ke(ce),Ye((()=>{const{liveTranscription:{messageRecords:e}}=t.value;return e.length>=1e5?function(e){const{meeting:{meetingId:t},liveTranscription:{messageRecords:n,reducedRecordsCount:i}}=e;return void 0!==window.indexedDB?new Promise((e=>{const r=window.indexedDB.open(lx,1);r.addEventListener("upgradeneeded",(()=>{const e=r.result;if(!e.objectStoreNames.contains(cx)){const t=e.createObjectStore(cx,{keyPath:["startIndex","mid"],autoIncrement:!1});t.createIndex("mid","mid",{unique:!1}),t.transaction.oncomplete=()=>{console.log(`Create objectStore [${cx}] complete`)}}})),r.addEventListener("success",(()=>{const o=r.result,s=n.length,a=.9*s,u=s-a,l=n.slice(0,a),c=i+l.length,d=o.transaction([cx],"readwrite");d.objectStore(cx).put({startIndex:i,mid:t,records:l}),d.oncomplete=()=>{e(Qm({remains:u,reducedRecordsCount:c})),o.close()},d.onerror=()=>{e(""),o.close()}}))})):Promise.resolve("")}(t.value):Promise.resolve("")})),ht((e=>"object"==typeof e))),epics10:(e,t)=>e.pipe(Ut(`${Mr}`,`${Lr}`),ht((()=>t.value.liveTranscription.isRecordsReduced)),At((()=>{!function(){if(void 0!==window.indexedDB){const e=window.indexedDB.open(lx,1);e.addEventListener("success",(()=>{const t=e.result;t.objectStoreNames.contains(cx)&&(window.indexedDB.deleteDatabase(lx),t.close())}))}}()})),St(ge)),epics11:(e,t)=>vi(e,[Da.AudiobridgeSetCcLangSuccess,Da.AudiobridgeSetCcLangFailure]).pipe(Ye((e=>{const{payload:{type:n,data:i}}=e,{liveTranscription:{currentTranscriptionLang:r}}=t.value,o=[];return n===Da.AudiobridgeSetCcLangSuccess&&i!==r?o.push(Wm(i)):n===Da.AudiobridgeSetCcLangFailure&&o.push(Wm(void 0)),Me(o)})))},Cx=hi(Ix),Ax={isLiveStreamEnable:!1,status:0},Tx=Rn({[`${pv}`]:hE(((e,t)=>{let{payload:n}=t;e.isLiveStreamEnable=n})),[`${fv}`]:hE(((e,t)=>{let{payload:n}=t;e.status=n})),[`${gv}`]:(e,t)=>{let{payload:n}=t;return n?{...e}:{...Ax}}},Ax);let Rx=function(e){return e[e.Ended=0]="Ended",e[e.InProgress=1]="InProgress",e[e.Connecting=2]="Connecting",e[e.Timeout=3]="Timeout",e}({});var Ox;const Px=Ps.createAgent();let Dx=($A((Ox=class extends aT{startLiveStream(e,t,n){const{[GA]:i,[zA]:r}=this,{liveStream:{isLiveStreamEnable:o,status:s}}=i();return s===Rx.InProgress?Promise.reject({type:yc,reason:"Live stream is already on"}):o?e&&t&&n?(Px.startLiveStream(e,t,n),Cd({event:vd,operations:[ht((e=>e===Rx.InProgress)),gt(1)]},void 0,3e4).then((()=>"")).catch((()=>{const{liveStream:{status:e}}=i();return e===Rx.Connecting?(_d(vd,Rx.Timeout),r(fv(Rx.Timeout)),Promise.reject({type:Sc})):Promise.resolve("")}))):Promise.reject({type:_c,reason:"parameter cannot be empty"}):Promise.reject({type:yc,reason:"Live stream is not enabled"})}stopLiveStream(){const{[GA]:e,[zA]:t}=this,{liveStream:{status:n}}=e();return n===Rx.InProgress&&(Px.stopLiveStream(),_d(vd,Rx.Ended),t(fv(Rx.Ended))),Promise.resolve("")}isLiveStreamEnabled(){var e;const{[GA]:t}=this;return!(null===(e=t().liveStream)||void 0===e||!e.isLiveStreamEnable)}getLiveStreamStatus(){var e;const{[GA]:t}=this;return null===(e=t().liveStream)||void 0===e?void 0:e.status}}).prototype,"startLiveStream",[XA],Object.getOwnPropertyDescriptor(Ox.prototype,"startLiveStream"),Ox.prototype),$A(Ox.prototype,"stopLiveStream",[XA],Object.getOwnPropertyDescriptor(Ox.prototype,"stopLiveStream"),Ox.prototype),Ox);const kx=hi({epics0:e=>e.pipe(Ut(`${jr}`),Ke((e=>{const{payload:{liveStreamInfo:t}}=e;return pv(!(null==t||!t.isEnabledLiveStream))}))),epics1:e=>pi(e,7970).pipe(Ke((e=>{const{payload:{body:{channelName:t,liveStreamOn:n,isApiCall:i,status:r,viewerUrl:o}}}=e;return _d(vd,r),fv(r)})))}),{setSummaryEnable:xx,setSmartSummaryStatus:Nx,resetSummary:Mx}=_n("SET_SUMMARY_ENABLE","SET_SMART_SUMMARY_STATUS","RESET_SUMMARY"),{setMeetingQueryEnable:Fx,setMeetingQueryStatus:Lx}=_n("SET_MEETING_QUERY_ENABLE","SET_MEETING_QUERY_STATUS");let Vx=function(e){return e.Default="",e.Start="Start",e.Paused="Paused",e.Stopped="Stopped",e}({}),jx=function(e){return e[e.GW_IND_NONE=0]="GW_IND_NONE",e[e.GW_IND_START=1]="GW_IND_START",e[e.GW_IND_PAUSE=2]="GW_IND_PAUSE",e[e.GW_IND_STOP=3]="GW_IND_STOP",e}({}),Bx=function(e){return e.Default="",e.Start="Start",e.Paused="Paused",e.Stopped="Stopped",e}({}),Ux=function(e){return e[e.GW_IND_NONE=0]="GW_IND_NONE",e[e.GW_IND_START=1]="GW_IND_START",e[e.GW_IND_PAUSE=2]="GW_IND_PAUSE",e[e.GW_IND_STOP=3]="GW_IND_STOP",e}({});const Hx={summaryStatus:jx.GW_IND_STOP,summaryEnable:!1,meetingQueryStatus:Ux.GW_IND_STOP,meetingQueryEnable:!1},qx=Rn({[`${xx}`]:hE(((e,t)=>{let{payload:n}=t;e.summaryEnable=n})),[`${Nx}`]:hE(((e,t)=>{let{payload:n}=t;e.summaryStatus=n})),[`${Fx}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingQueryEnable=n})),[`${Lx}`]:hE(((e,t)=>{let{payload:n}=t;e.meetingQueryStatus=n})),[`${Mx}`]:()=>({...Hx})},Hx);var Kx,$x,Wx,Gx,zx;const Jx=Ps.createAgent();let Qx=(Kx=eT("summary"),$x=eT("summary"),Wx=eT("summary"),Gx=eT("summary"),$A((zx=class extends aT{startSummary(){const e=this[GA](),{summary:{summaryEnable:t,summaryStatus:n}}=e;return t?n===jx.GW_IND_START?Promise.resolve(""):(Jx.summaryMeeting(!0),Cd(pd,(e=>e.status===Vx.Start))):Promise.reject({type:yc,reason:"The account of the meeting disabled the smart summary"})}stopSummary(){const e=this[GA](),{summary:{summaryStatus:t}}=e;return t!==jx.GW_IND_START?Promise.resolve("not start summary, do nothing"):(Jx.summaryMeeting(!1),Cd(pd,(e=>e.status===Vx.Stopped)))}getSummaryStatus(){const e=this[GA](),{summary:{summaryStatus:t}}=e;return t===jx.GW_IND_START?Vx.Start:t===jx.GW_IND_STOP?Vx.Stopped:Vx.Default}isSummaryEnabled(){const e=this[GA](),{summary:{summaryEnable:t}}=e;return t}startMeetingQuery(){const e=this[GA](),{summary:{meetingQueryEnable:t,meetingQueryStatus:n}}=e;return t?n===Ux.GW_IND_START?Promise.resolve(""):(Jx.startMeetingQuery(!0),Cd(fd,(e=>e.status===Bx.Start))):Promise.reject({type:yc,reason:"The account of the meeting disabled the smart summary"})}stopMeetingQuery(){const e=this[GA](),{summary:{meetingQueryStatus:t}}=e;return t!==Ux.GW_IND_START?Promise.resolve("not start meeting query, do nothing"):(Jx.startMeetingQuery(!1),Cd(fd,(e=>e.status===Bx.Stopped)))}getMeetingQueryStatus(){const e=this[GA](),{summary:{meetingQueryStatus:t}}=e;return t===Ux.GW_IND_START?Bx.Start:t===Ux.GW_IND_STOP?Bx.Stopped:Bx.Default}isMeetingQueryEnabled(){const e=this[GA](),{summary:{meetingQueryEnable:t}}=e;return t}}).prototype,"startSummary",[XA,YA,Kx],Object.getOwnPropertyDescriptor(zx.prototype,"startSummary"),zx.prototype),$A(zx.prototype,"stopSummary",[XA,YA,$x],Object.getOwnPropertyDescriptor(zx.prototype,"stopSummary"),zx.prototype),$A(zx.prototype,"startMeetingQuery",[XA,YA,Wx],Object.getOwnPropertyDescriptor(zx.prototype,"startMeetingQuery"),zx.prototype),$A(zx.prototype,"stopMeetingQuery",[XA,YA,Gx],Object.getOwnPropertyDescriptor(zx.prototype,"stopMeetingQuery"),zx.prototype),zx);const Yx=hi({moduleEpics0:e=>pi(e,8007).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.supported)})),Ke((e=>{const{supported:t}=e.payload.body;return _d(pd,{supported:t}),xx(t)}))),moduleEpics1:(e,t)=>pi(e,8008).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.status)})),Tt(t),Ye((e=>{let[t,n]=e;const{status:i}=t.payload.body,{summary:{summaryStatus:r}}=n,o=[];if(i!==r)switch(i){case jx.GW_IND_START:_d(pd,{status:Vx.Start});break;case jx.GW_IND_PAUSE:_d(pd,{status:Vx.Paused});break;case jx.GW_IND_STOP:_d(pd,{status:Vx.Stopped});break;default:_d(pd,{status:""})}return o.push(Nx(i)),Me(o)}))),moduleEpics2:(e,t)=>pi(e,8015).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.supported)})),Tt(t),Ke((e=>{let[t,n]=e;const{supported:i}=t.payload.body;_d(fd,{supported:i});const{meeting:{zlkJwtToken:r}}=n;if(r){const{auto_transcription:e}=mr(r);e&&(i?Ps.createAgent().startMeetingQuery(!0):console.warn("You account don't support auto transcription"))}return Fx(i)}))),moduleEpics3:(e,t)=>pi(e,8016).pipe(ht((e=>{var t;return void 0!==(null===(t=e.payload.body)||void 0===t?void 0:t.status)})),Tt(t),Ye((e=>{let[t,n]=e;const{status:i}=t.payload.body,{summary:{meetingQueryStatus:r}}=n,o=[];if(i!==r)switch(i){case Ux.GW_IND_START:_d(fd,{status:Bx.Start});break;case Ux.GW_IND_PAUSE:_d(fd,{status:Bx.Paused});break;case Ux.GW_IND_STOP:_d(fd,{status:Bx.Stopped});break;default:_d(fd,{status:""})}return o.push(Lx(i)),Me(o)})))});var Zx;const Xx={chat:{epic:tR,reducer:QT,Client:XT},logger:{epic:sO,reducer:nO,Client:class extends aT{getLogs(e){return eO.getLogs(this[WA],e)}getStore(){return eO.doNotUseDirtyGetStore()}setLogOptions(e){e&&this[WA].dispatch(cv(e))}isAutoReportInAccountSettingEnabled(){const{meeting:{zlkJwtToken:e,enableAutoLog:t,collectionToggleEnable:n,zsk:i}}=this[WA].getState();return!!e||(i?t&&n:t)}reportMeetingProblem(e){var t;const{product:n,problem:i,timeOfOccurrence:r,description:o,ticket:s,isLogIncluded:a}=e,{meeting:{userId:u,confId:l,conId:c,svcUrl:d}}=this[WA].getState(),h=`'product':${n}\n'problem':${i}\n'timeOfOccurrence':${r}\n'description':${o}\n'ticketID':${s}\n'isLogIncluded':${a?"Logs included":""}\n'nodeId':${u}\n'confId':${l}\n'conId':${c}\n'svcUrl':${d}`,p=["REPORT_NOTIFICATION"];return null===(t=eO.makeLogger(p).logWithExtraProperties("",{IM_NOTIFICATION:`${h}\nTrackingId:${eO.trackingId}`}))||void 0===t?void 0:t.then((()=>{eO.reportToGlobalTracing(a?void 0:p,!0)}))}reportToGlobalTracing(e){return eO.reportToGlobalTracing(e)}reportRating(e,t){const{meeting:n,media:i,socket:r}=this[WA].getState();if(n){var o,s,a,u,l;const{zlkJwtToken:c,meetingStatus:d}=n,{assetsPath:h,enforceMultipleVideos:p,enforceVirtualBackground:f,disableRenderLimits:g}=i;eO.report(`rating:${e}, feedback:${t}, appKey:${c?null===(o=mr(c))||void 0===o?void 0:o.app_key:""}, CPU:${navigator.hardwareConcurrency}, GPU:${null!==(s=Uo.gpu)&&void 0!==s?s:""}, browser:${Uo.browser} ${Uo.browserVersion}, OS:${Uo.os} ${Uo.osVersion}, SharedArrayBuffer:${!!window.crossOriginIsolated}, assetPath:${h}, enforceMultipleVideos:${p},disableRenderLimits:${g} enforceVirtualBackground:${f}, ${d===Co.Joined?`session duration:${Math.floor((null!==(a=performance.now()-(null==n?void 0:n.pingRWCTimestamp))&&void 0!==a?a:0)/1e3)}, rwg:${null==r||null===(u=r.rwgServerList)||void 0===u||null===(l=u[r.retryCount])||void 0===l?void 0:l.rwg}, failover count:${null==n?void 0:n.failover.count}`:""}`,"User Rating","info"),Number(e)<=2&&this.reportToGlobalTracing()}return Promise.resolve()}}},recording:{epic:_O,reducer:lO,Client:EO},cmd:{epic:VO,reducer:xO,Client:MO},breakoutRoom:{epic:ex,reducer:VD,Client:Yk},liveTranscription:{epic:Cx,reducer:Sx,Client:_x},liveStream:{epic:kx,reducer:Tx,Client:Dx},summary:{epic:Yx,reducer:qx,Client:Qx}},eN=Ps.createAgent();let tN=(Zx=class extends _T{constructor(e){super(e),this.mediaStream=void 0,this[JA]=Xx}getMediaStream(){return void 0===this.mediaStream&&(this.mediaStream=new FD(this[WA])),this.mediaStream}joinInstant(e,t,n,i,r,o){const{[GA]:s,[zA]:a}=this,{meeting:{lang:u,meetingStatus:l},socket:{zoomSocketStatus:c}}=s();return t?l!==Co.Joined&&c===Th.Closed?(a(kr({topic:e,password:r?encodeURIComponent(r):"",userName:n,zlk:t,lang:u,cv:i})),o&&a(lo(o)),Id(Xs.JoinMeeting)):Promise.reject({type:yc,reason:"duplicated operation"}):Promise.reject({type:yc,reason:"invalid  signature"})}removeUser(e){const t=this[WA].getState(),{participants:{attendeesList:n}}=t,i=n.find((t=>t.userId===e));return i?(eN.expel(e),Cd(Hs,(t=>t.some((t=>t.userId===e))))):Promise.reject({type:_c,reason:"no matched user"})}},$A(Zx.prototype,"removeUser",[ZA,YA],Object.getOwnPropertyDescriptor(Zx.prototype,"removeUser"),Zx.prototype),Zx);class nN{constructor(e){this.instant=void 0,this.context=void 0,this.script=void 0,this.mic=void 0,this.instant=0,this.context=e,this.mic=null,this.script=e.createScriptProcessor(2048,1,1),this.script.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let n,i=0;for(n=0;n<t.length;++n)i+=t[n]*t[n];this.instant=Math.sqrt(i/t.length)}}connectToSource(e){console.log("InputMicDetector is listening");try{var t;this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),null===(t=this.script)||void 0===t||t.connect(this.context.destination)}catch(e){console.error(e)}}stop(){var e,t;console.log("Audio Previewer stopped"),null===(e=this.mic)||void 0===e||e.disconnect(),this.mic=null,null===(t=this.script)||void 0===t||t.disconnect(),this.script=null}getMicVolume(){return this.instant}}const iN="https://st1.zoom.us/web_client/4qu8baa/audio/ring.mp3";class rN{constructor(){this.sampleAudio=void 0,this.audioCtx=void 0,this.destinationNode=void 0,this.audioPlayer=void 0,this.analyzserInterval=void 0,this.analyserNode=void 0,this.analyserNodeBufferDataArray=void 0,this.analyserCallback=void 0,this.sourceNode=void 0,this.mAudioStream=void 0,this.mSourceNode=void 0,this.mediaRecorder=void 0,this.isRecording=void 0,this.recorderChunks=[],this.recorderObjUrl=void 0,this.recorderPlayer=void 0,this.maximumRecordingTimer=void 0,this.shouldPlayAfterRecording=!0,this.isRunning=!1}testSpeaker(e){var t;if("function"!=typeof AudioContext||"function"!=typeof MediaStreamAudioDestinationNode||!AudioContext.prototype.decodeAudioData)return void console.warn("Cannot test the speaker due to the browser capability");const{speakerId:n,sampleAudioUrl:i=iN,onAnalyseFrequency:r}=e||{};if(this.isRunning)return void console.warn("A tester is running,please stop it first");this.isRunning=!0,this.initAudioContext(),((null===(t=this.sampleAudio)||void 0===t?void 0:t.url)===i&&this.sampleAudio.data?Promise.resolve(this.sampleAudio.data):window.fetch(i).then((e=>e.arrayBuffer())).then((e=>this.audioCtx.decodeAudioData(e))).then((e=>(this.sampleAudio={url:i,data:e},e)))).then((e=>{var t,i,o;this.sourceNode=this.audioCtx.createBufferSource(),this.sourceNode.buffer=e,this.sourceNode.loop=!0,n&&null!==(t=this.audioPlayer)&&void 0!==t&&t.setSinkId&&this.audioPlayer.setSinkId(n),r?"function"==typeof AudioContext.prototype.createAnalyser?(this.analyzserInterval&&window.clearInterval(this.analyzserInterval),this.analyserCallback=r,this.initAnalyserNode(),this.analyserNode&&this.sourceNode.connect(this.analyserNode)):(this.sourceNode.connect(this.destinationNode),console.warn("Cannot analyze the stream due to the browser capability")):(this.analyserCallback=void 0,this.sourceNode.connect(this.destinationNode)),this.sourceNode.start(0),"running"!==(null===(i=this.audioCtx)||void 0===i?void 0:i.state)&&(null===(o=this.audioCtx)||void 0===o||o.resume()),this.audioPlayer&&(this.audioPlayer.muted=!1,this.audioPlayer.currentTime=0,this.audioPlayer.play())}));const o=()=>{this.isRunning=!1,this.audioPlayer&&(this.audioPlayer.currentTime=0,this.audioPlayer.pause()),this.analyserNode&&this.analyzserInterval&&(window.clearInterval(this.analyzserInterval),this.analyzserInterval=void 0,this.analyserNodeBufferDataArray=void 0),this.sourceNode&&(this.sourceNode.stop(0),this.sourceNode.disconnect(),this.sourceNode.buffer=null,this.sourceNode=void 0)};return{stop:o,destroy:()=>{var e;o(),this.analyserNode&&this.destinationNode&&(this.analyserNode.disconnect(this.destinationNode),this.analyserNode=void 0),null===(e=this.audioCtx)||void 0===e||e.close(),this.audioCtx=void 0}}}testMicrophone(e){var t;if("function"!=typeof AudioContext||"function"!=typeof MediaStreamAudioDestinationNode||"function"!=typeof AudioContext.prototype.createMediaStreamSource||"function"!=typeof(null===(t=navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia))return void console.warn("Cannot test the microphone due to the browser capability");const{microphoneId:n,speakerId:i,recordAndPlay:r,maxRecordDuration:o,onAnalyseFrequency:s,onStartRecording:a,onStopRecording:u,onStartPlayRecording:l,onStopPlayRecording:c}=e||{};if(this.isRunning)return void console.warn("A tester is running,please stop it first");this.isRunning=!0,this.initAudioContext();const d=()=>{r&&this.mediaRecorder&&this.isRecording&&(this.shouldPlayAfterRecording=!0,"inactive"!==this.mediaRecorder.state&&this.mediaRecorder.stop())};window.navigator.mediaDevices.getUserMedia({audio:!n||{deviceId:{exact:n}}}).then((e=>{var t,n,h,p;this.mAudioStream=e,this.mSourceNode=null===(t=this.audioCtx)||void 0===t?void 0:t.createMediaStreamSource(e),this.audioPlayer.muted=!0,s?(this.analyzserInterval&&window.clearInterval(this.analyzserInterval),this.analyserCallback=s,this.initAnalyserNode(),this.analyserNode&&(null===(h=this.mSourceNode)||void 0===h||h.connect(this.analyserNode))):this.analyserCallback=void 0,r&&("function"==typeof MediaRecorder?(this.recorderObjUrl&&window.URL.revokeObjectURL(this.recorderObjUrl),this.mediaRecorder=new MediaRecorder(this.mAudioStream),this.mediaRecorder.ondataavailable=e=>{e.data&&this.recorderChunks.push(e.data)},this.mediaRecorder.onstop=()=>{if(this.isRecording=!1,this.maximumRecordingTimer&&(window.clearTimeout(this.maximumRecordingTimer),this.maximumRecordingTimer=void 0),null==u||u(),this.recorderChunks.length>0){var e;const t=new Blob(this.recorderChunks,{type:(null===(e=this.recorderChunks[0])||void 0===e?void 0:e.type)||"audio/ogg; codecs=opus"});this.recorderObjUrl=window.URL.createObjectURL(t),this.shouldPlayAfterRecording&&this.playRecording(this.recorderObjUrl,i,l,c).catch((e=>{this.analyzserInterval&&(window.clearInterval(this.analyzserInterval),this.analyzserInterval=void 0,this.analyserNodeBufferDataArray=void 0),console.warn(e)})),this.recorderChunks=[],this.mediaRecorder&&(this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,this.mediaRecorder=void 0)}},this.mediaRecorder.start(),this.isRecording=!0,null==a||a(),this.maximumRecordingTimer=window.setTimeout((()=>{d()}),o||1e4)):console.warn("Cannot record the sound due to the browser capability")),"running"!==(null===(n=this.audioCtx)||void 0===n?void 0:n.state)&&(null===(p=this.audioCtx)||void 0===p||p.resume()),this.audioPlayer&&(this.audioPlayer.currentTime=0,this.audioPlayer.play())}));const h=()=>{this.isRunning=!1,this.maximumRecordingTimer&&(window.clearTimeout(this.maximumRecordingTimer),this.maximumRecordingTimer=void 0),this.audioPlayer&&(this.audioPlayer.currentTime=0,this.audioPlayer.pause()),this.analyserNode&&this.analyzserInterval&&(window.clearInterval(this.analyzserInterval),this.analyzserInterval=void 0,this.analyserNodeBufferDataArray=void 0),this.mSourceNode&&(s&&this.analyserNode&&this.mSourceNode.disconnect(this.analyserNode),this.mSourceNode=void 0),this.mAudioStream&&(this.mAudioStream.getAudioTracks().forEach((e=>{e.stop()})),this.mAudioStream=void 0),this.mediaRecorder&&(this.shouldPlayAfterRecording=!1,this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,"inactive"!==this.mediaRecorder.state&&this.mediaRecorder.stop(),this.isRecording=!1,this.mediaRecorder=void 0,this.recorderChunks=[]),this.recorderPlayer&&(this.recorderPlayer.currentTime=0,this.recorderPlayer.pause())};return{stop:h,stopRecording:d,destroy:()=>{var e;h(),this.analyserNode&&this.destinationNode&&(this.analyserNode.disconnect(this.destinationNode),this.analyserNode=void 0),null===(e=this.audioCtx)||void 0===e||e.close(),this.audioCtx=void 0}}}initAudioContext(){this.audioCtx&&this.audioPlayer||(this.audioCtx=new AudioContext,this.destinationNode=new MediaStreamAudioDestinationNode(this.audioCtx),this.audioPlayer=new Audio,this.audioPlayer.loop=!0,this.audioPlayer.srcObject=this.destinationNode.stream)}initAnalyserNode(){this.analyserNode||(this.analyserNode=this.audioCtx.createAnalyser(),this.analyserNode.connect(this.destinationNode),this.analyserNode.fftSize=1024);const e=this.analyserNode.frequencyBinCount;this.analyserNodeBufferDataArray=new Uint8Array(e),this.analyzserInterval=window.setInterval(this.audioAnalyserCallback.bind(this),20)}audioAnalyserCallback(){if(this.analyserNodeBufferDataArray&&this.analyserNode&&this.analyserCallback){this.analyserNode.getByteFrequencyData(this.analyserNodeBufferDataArray);let e=0;for(const t of this.analyserNodeBufferDataArray)e+=t;const t=e/this.analyserNodeBufferDataArray.length;this.analyserCallback(t)}}playRecording(e,t,n,i){this.recorderPlayer=new Audio,this.recorderPlayer.src=e,this.recorderPlayer.currentTime=0,this.recorderPlayer.setSinkId&&t&&this.recorderPlayer.setSinkId(t);const r=()=>{null==i||i(),this.recorderPlayer&&(this.recorderPlayer.onpause=null,this.recorderPlayer.onended=null,this.recorderPlayer=void 0,this.isRunning=!1)};return new Promise(((e,t)=>{this.recorderPlayer&&(this.recorderPlayer.onpause=()=>{e(!0)},this.recorderPlayer.onended=()=>{e(!0)},this.recorderPlayer.onerror=t,null==n||n(),this.recorderPlayer.play().catch(t))})).finally((()=>{window.URL.revokeObjectURL(e),r()}))}}const oN="AudioNotStartedError";class sN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.audioContext=void 0,this.inputMicDetector=void 0,this.isMicUnmuted=void 0,this.isAudioStarted=void 0,this.audioStream=void 0,this.deviceId=void 0,this.tester=void 0,this.audioContext=null,this.inputMicDetector=null,this.isMicUnmuted=!1,this.isAudioStarted=!1,this.audioStream=null,this.deviceId=e,this.tester=new rN}async start(){if(this.audioStream||this.isAudioStarted)throw new Error("AudioAlreadyStartedError");try{const e=await navigator.mediaDevices.getUserMedia(this.getAudioConstraints());this.audioStream=e,this.isAudioStarted=!0}catch(e){throw e}}async unmute(){if(!this.audioStream||!this.isAudioStarted)throw new Error(oN);if(this.isMicUnmuted)throw new Error("AudioAlreadyUnmutedError");return this.toggleMicIsMuted(!0)}async mute(){if(!this.audioStream||!this.isAudioStarted)throw new Error(oN);if(!this.isMicUnmuted)throw new Error("AudioAlreadyMutedError");return this.toggleMicIsMuted(!1)}getCurrentVolume(){return this.inputMicDetector?this.inputMicDetector.getMicVolume():0}async stop(){if(!this.audioStream||!this.isAudioStarted)throw new Error(oN);this.audioStream.getAudioTracks().forEach((e=>e.stop())),this.audioStream=null,this.isAudioStarted=!1}async toggleMicIsMuted(e){if(e){if(!this.audioContext){const e=window.AudioContext||window.webkitAudioContext;this.audioContext=new e}this.inputMicDetector=new nN(this.audioContext),this.inputMicDetector.connectToSource(this.audioStream)}else this.inputMicDetector&&this.inputMicDetector.stop(),this.inputMicDetector=null;this.isMicUnmuted=e}getAudioConstraints(){return{audio:""===this.deviceId||{deviceId:{exact:this.deviceId}},video:!1}}testSpeaker(e){return this.tester.testSpeaker(e)}testMicrophone(e){return this.tester.testMicrophone(e)}}const aN={width:{min:1024,ideal:1280,max:1920},height:{min:576,ideal:720,max:1080},aspectRatio:{ideal:1.777777778}};class uN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.isVideoStarted=void 0,this.videoStream=void 0,this.deviceId=void 0,this.localPreview=void 0,this.vbPreviewInProgress=void 0,this.videoParams=void 0,this.isVideoStarted=!1,this.videoStream=null,this.vbPreviewInProgress=!1,this.deviceId=e,this.localPreview=new OA}async start(e,t){if(!e)throw new Error("Video DOM element is falsy");if(this.isVideoStarted||this.videoStream)throw new Error("VideoAlreadyStartedError");this.videoParams={videoDOMElement:e,virtualBackground:t};const n=async t=>{if(!t||"OverconstrainedError"!==t.name&&"ConstraintNotSatisfiedError"!==t.name)throw t;console.log(`Warning: detected ${t.name} -- trying to fall back to lower aspect ratio`);try{const t=await navigator.mediaDevices.getUserMedia(this.getVideoConstraints(!0));return this.tryPlayVideo(e,t)}catch(e){throw e}};if(e instanceof HTMLVideoElement)try{const t=await navigator.mediaDevices.getUserMedia(this.getVideoConstraints());return this.tryPlayVideo(e,t)}catch(e){return n(e)}else{if(!(e instanceof HTMLCanvasElement))throw new Error("Cannot start video with virtual background");this.localPreview.setup().then((()=>this.localPreview.startPreview(e,{...t,deviceId:this.deviceId}))).then((()=>{this.vbPreviewInProgress=!0}))}}async stop(){if(this.vbPreviewInProgress)await this.localPreview.stopPreview(),this.vbPreviewInProgress=!1;else{if(!this.videoStream||!this.isVideoStarted)throw new Error("VideoNotStartedError");this.videoStream.getVideoTracks().forEach((e=>e.stop())),this.videoStream=null,this.isVideoStarted=!1}}async switchCamera(e){e!==this.deviceId&&(this.deviceId=e,await this.stop(),this.videoParams&&await this.start(this.videoParams.videoDOMElement,this.videoParams.virtualBackground))}async updateVirtualBackground(e,t){this.vbPreviewInProgress&&await this.localPreview.updatePreview(e,t)}getVideoConstraints(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=aN;return Xa.includes(this.deviceId)?{audio:!1,video:{facingMode:this.deviceId}}:(e?t=""===this.deviceId||{deviceId:{exact:this.deviceId}}:""!==this.deviceId&&(t.deviceId={exact:this.deviceId}),{audio:!1,video:t})}async tryPlayVideo(e,t){if(!e)throw new Error("Video DOM element is falsy");try{this.videoStream=t,e.srcObject=this.videoStream,await e.play(),this.isVideoStarted=!0}catch(e){throw e}}}class lN{static createClient(){if(!this.meetingClient){const e=function(){const e=function(e){void 0===e&&(e={});var t,n=new fe.constructor(fe.schedulerActionCtor),i=new z,r=function(r){t=r;var o=new z,s=new z,a=o.asObservable().pipe(ke(n)),u=new jt(s.pipe(ke(n)),t.getState());return i.pipe(Ke((function(t){var n=t(a,u,e.dependencies);if(!n)throw new TypeError('Your root Epic "'+(t.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return n})),Ye((function(e){return Me(e).pipe(xe(n),ke(n))}))).subscribe(t.dispatch),function(e){return function(n){var i=e(n);return s.next(t.getState()),o.next(n),i}}};return r.run=function(e){i.next(e)},r}(),{epicSubject:t,rootEpic:n}=function(){const e=new Q(di(ZE,Sw,Tw,UA));return{epicSubject:e,rootEpic:(t,n,i)=>e.pipe(Ye((e=>e(t,n,i))))}}(),i=[e],r=Ft(KA(),qA(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),i=function(){throw new Error(kt(15))},r={getState:n.getState,dispatch:function(){return i.apply(void 0,arguments)}},o=t.map((function(e){return e(r)}));return i=Lt.apply(void 0,o)(n.dispatch),Dt(Dt({},n),{},{dispatch:i})}}}(...i)));return r.asyncReducers={},r.injectReducer=(e,t)=>{void 0===r.asyncReducers[e]&&(r.asyncReducers[e]=t,r.replaceReducer(KA(r.asyncReducers)))},r.injectEpic=e=>{t.next(e)},e.run(n),r}();this.meetingClient=new tN(e)}return this.meetingClient}static destroyClient(){this.meetingClient&&(this.meetingClient.leave().then((()=>{at(500).subscribe((()=>{Td()}))})),this.meetingClient=null)}static checkFeatureRequirements(){return function(){const e=[],t=[],{isAndroidOrIOSBrowser:n,browser:i,browserVersion:r,os:o,osVersion:s,isChrome:a,isFirefox:u,isSafari:l}=Uo;!n&&(a||u||l)&&Go()?e.push("Virtual Background"):t.push("Virtual Background"),(n||a)&&Go()?e.push("Share Chrome Tab Audio"):t.push("Share Chrome Tab Audio"),!n&&Go()?(e.push("Screen Share (send)"),e.push("720p Video (receive)"),e.push("Share 2nd Camera")):(t.push("Screen Share (send)"),t.push("720p Video (receive)"),t.push("Share 2nd Camera")),Go()?(e.push("Audio"),e.push("Video"),e.push("Screen Share (receive)"),e.push("Chat"),e.push("Closed Captioning"),e.push("Live Transcription"),e.push("Live Translation"),e.push("Cloud Recording"),e.push("Call Out (PSTN)"),e.push("Command Channel"),e.push("RTMP Live Streaming"),e.push("Encryption"),e.push("720p Video (send)"),e.push("Render Multiple Videos")):(t.push("Audio"),t.push("Video"),t.push("Screen Share (receive)"),t.push("Chat"),t.push("Closed Captioning"),t.push("Live Transcription"),t.push("Live Translation"),t.push("Cloud Recording"),t.push("Call Out (PSTN)"),t.push("Command Channel"),t.push("RTMP Live Streaming"),t.push("Encryption"),e.push("720p Video (send)"),e.push("Render Multiple Videos"));const c=n?`${o}${s}`:`${i}${r}`;return t.length>0&&console.log("Some features are not supported on your platform, please refer to https://developers.zoom.us/docs/video-sdk/web/browser-support/"),{platform:c,supportFeatures:e,unSupportFeatures:t}}()}static checkSystemRequirements(){return cT()}static getDevices(e){return e?navigator.mediaDevices.enumerateDevices():navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((e=>(e.getTracks().forEach((e=>e.stop())),navigator.mediaDevices.enumerateDevices()))).catch((e=>(console.warn(e),navigator.mediaDevices.enumerateDevices())))}static createLocalAudioTrack(){return new sN(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}static createLocalVideoTrack(){return new uN(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}static preloadDependentAssets(e){(async e=>{const t=e||Cv,n=`${t}/${wo}`,i=[],r=[],o=`${t}/`;if(Mv()){const{workers:e,wasms:t}=Bv("audio","simd",o);i.push(...e),r.push(...t)}else{const{workers:e,wasms:t}=Bv("audio","",o);i.push(...e),r.push(...t)}if(Mv()&&function(){const{browser:e,browserVersion:t,isAndroidBrowser:n}=Uo;return!n&&"chrome"===e.toLowerCase()&&lr(t,"100")>0&&window.crossOriginIsolated}()){const{workers:e,wasms:t}=Bv(["video","sharing"],"videoShare",o);i.push(...e),r.push(...t)}else if(Mv()&&Nv()){const{workers:e,wasms:t}=Bv(["video","sharing"],"simd,thread",o);i.push(...e),r.push(...t)}else if(Nv()){const{workers:e,wasms:t}=Bv(["video","sharing"],"thread",o);i.push(...e),r.push(...t)}else if(Mv()){const{workers:e,wasms:t}=Bv(["video","sharing"],"simd",o);i.push(...e),r.push(...t)}else{const{workers:e,wasms:t}=Bv(["video","sharing"],"",o);i.push(...e),r.push(...t)}const s=[jv(n,"script")];i.forEach((e=>{s.push(jv(e,"fetch"))})),r.forEach((e=>{s.push(jv(e,"fetch"))}));try{document.head.append(...s)}catch(e){}})(e)}}lN.meetingClient=void 0,lN.VERSION=_v;var cN="1.11.10",dN="INVALID_PARAMETERS",hN="https://dmogdx0jrul3u.cloudfront.net/videosdk/".concat(cN,"/lib"),pN="https://source.zoom.us/videosdk/".concat(cN,"/lib"),fN="https://jssdk.zoomus.cn/videosdk/".concat(cN,"/lib"),gN=function(e){return"string"==typeof e&&e.length>0},mN=function(e){var t="";switch(e){case"Global":t=pN;break;case"CN":t=fN;break;case"CDN":t=hN;break;default:t=e}return t},vN=["userId","avatar","displayName","isHost","audio","muted","bVideoOn","sharerOn","sharerPause","userIdentity","isSpeakerOnly","bVideoShare","bShareAudioOn","userGuid","isPhoneUser","isInFailover",{from:"isCoHost",to:"isManager"},{from:"bAllowISORecord",to:"isAllowIndividualRecording"},{from:"bVideoConnect",to:"isVideoConnect"},{from:"bShareToBORooms",to:"bShareToSubsession"},{from:"bid",to:"subsessionId"},{from:"phoneNumber",to:function(e){return void 0===e?{}:{phoneNumber:e}}}],yN=[].concat(vN,[{from:"userGUID",to:"userGuid"},{from:"bCoHost",to:function(e){return{isManager:!!e}}},{from:"userType",to:function(e){return{isPhoneUser:!(5&~e)}}},{from:"bid",to:function(e){return e?{subsessionId:e}:{}}}]),SN=yN.map((function(e){return"string"==typeof e?e:e.from}));function bN(e,t){return"string"==typeof e?l({},"".concat(e),t):"string"==typeof e.to?l({},"".concat(e.to),t):e.to(t)}function EN(e){if(e)return vN.reduce((function(t,n){var i="string"==typeof n?n:n.from,o=bN(n,e[i]);return r(r({},t),o)}),{})}function wN(e){if(e)return Object.keys(e).reduce((function(t,n){var i=SN.indexOf(n);if(i>-1){var o=yN[i],s="string"==typeof o?o:o.from,a=bN(o,e[s]);return r(r({},t),a)}return t}),{})}var _N,IN,CN,AN,TN,RN,ON,PN,DN=Symbol("stream"),kN=function(){function e(t){s(this,e),this[DN]=void 0,this[DN]=t}return u(e,[{key:"startAudio",value:function(e){return this[DN].startAudio(e)}},{key:"stopAudio",value:function(){return this[DN].stopAudio()}},{key:"muteAudio",value:function(e){return this[DN].muteAudio(e)}},{key:"unmuteAudio",value:function(e){return this[DN].unmuteAudio(e)}},{key:"inviteByPhone",value:function(e,t,n,i){return this[DN].dialOut(e,t,n,i)}},{key:"cancelInviteByPhone",value:function(e,t,n){return this[DN].cancelDialOut(e,t,n)}},{key:"hangup",value:function(){return this[DN].hangup()}},{key:"getCurrentSessionCallinInfo",value:function(){return this[DN].getDialInInfo()}},{key:"muteShareAudio",value:function(e){return this[DN].muteShareAudio(e)}},{key:"unmuteShareAudio",value:function(e){return this[DN].unmuteShareAudio(e)}},{key:"subscribeAudioStatisticData",value:function(e){return this[DN].subscribeAudioStatisticData(e)}},{key:"unsubscribeAudioStatisticData",value:function(e){return this[DN].unsubscribeAudioStatisticData(e)}},{key:"muteUserAudioLocally",value:function(e){return this[DN].muteUserAudioLocally(e)}},{key:"unmuteUserAudioLocally",value:function(e){return this[DN].unmuteUserAudioLocally(e)}},{key:"adjustUserAudioVolumeLocally",value:function(e,t){return this[DN].adjustUserAudioVolumeLocally(e,t)}},{key:"enableBackgroundNoiseSuppression",value:function(e){return this[DN].enableBackgroundNoiseSuppression(e)}},{key:"enableSyncButtonsOnHeadset",value:function(e){return this[DN].enableSyncButtonsOnHeadset(e)}},{key:"muteAllUserAudioLocally",value:function(){return this[DN].muteAllUserAudioLocally()}},{key:"unmuteAllUserAudioLocally",value:function(){return this[DN].unmuteAllUserAudioLocally()}},{key:"enableOriginalSound",value:function(e){return this[DN].enableOriginalSound(e)}},{key:"callCRCDevice",value:function(e,t){return this[DN].callCRCDevice(e,t)}},{key:"cancelCallCRCDevice",value:function(e,t){return this[DN].cancelCallCRCDevice(e,t)}},{key:"startSecondaryAudio",value:function(e,t){return this[DN].startSecondaryAudio(e,t)}},{key:"stopSecondaryAudio",value:function(){return this[DN].stopSecondaryAudio()}},{key:"muteAllAudio",value:function(){return this[DN].muteAllAudio()}},{key:"unmuteAllAudio",value:function(){return this[DN].unmuteAllAudio()}},{key:"isAudioMuted",value:function(e){return this[DN].isAudioMuted(e)}},{key:"getMicList",value:function(){return this[DN].getMicList()}},{key:"getSpeakerList",value:function(){return this[DN].getSpeakerList()}},{key:"getActiveMicrophone",value:function(){return this[DN].getActiveMicrophone()}},{key:"getActiveSpeaker",value:function(){return this[DN].getActiveSpeaker()}},{key:"switchMicrophone",value:function(e){return this[DN].switchMicrophone(e)}},{key:"switchSpeaker",value:function(e){return this[DN].switchSpeaker(e)}},{key:"isSupportPhoneFeature",value:function(){return this[DN].isSupportCallOut()}},{key:"getSupportCountryInfo",value:function(){return this[DN].getDialOutCountries()}},{key:"getInviteByPhoneStatus",value:function(){return this[DN].getDialOutStatus()}},{key:"getShareAudioStatus",value:function(){return this[DN].getShareAudioStatus()}},{key:"isOthersShareAudioMutedLocally",value:function(e){return this[DN].isOthersShareAudioMutedLocally(e)}},{key:"getAudioStatisticData",value:function(){return this[DN].getAudioStatisticData()}},{key:"isUserAudioMutedLocally",value:function(e){return this[DN].isUserAudioMutedLocally(e)}},{key:"getUserVolumeLocally",value:function(e){return this[DN].getUserVolumeLocally(e)}},{key:"isSupportMicrophoneAndShareAudioSimultaneously",value:function(){return this[DN].isSupportMicrophoneAndShareAudioSimultaneously()}},{key:"startVideo",value:function(e){return this[DN].startVideo(e)}},{key:"stopVideo",value:function(){return this[DN].stopVideo()}},{key:"renderVideo",value:function(e,t,n,i,r,o,s,a){return this[DN].renderVideo(e,t,n,i,r,o,s,a)}},{key:"stopRenderVideo",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;return this[DN].stopRenderVideo(e,t,n,i,r,o)}},{key:"updateVideoCanvasDimension",value:function(e,t,n){return this[DN].updateVideoCanvasDimension(e,t,n)}},{key:"adjustRenderedVideoPosition",value:function(e,t,n,i,r,o,s){return this[DN].adjustRenderedVideoPosition(e,t,n,i,r,o,s)}},{key:"clearVideoCanvas",value:function(e,t){return this[DN].clearVideoCanvas(e,t)}},{key:"mirrorVideo",value:function(e){return this[DN].mirrorVideo(e)}},{key:"enableHardwareAcceleration",value:function(e){return this[DN].enableHardwareAcceleration(e)}},{key:"previewVirtualBackground",value:function(e,t,n,i){return this[DN].previewVirtualBackground(e,t,n,i)}},{key:"updateVirtualBackgroundImage",value:function(e,t){return this[DN].updateVirtualBackgroundImage(e,t)}},{key:"stopPreviewVirtualBackground",value:function(){return this[DN].stopPreviewVirtualBackground()}},{key:"previewVideoMask",value:function(e,t){return this[DN].previewVideoMask(e,t)}},{key:"updateVideoMask",value:function(e){return this[DN].updateVideoMask(e)}},{key:"stopPreviewVideoMask",value:function(){return this[DN].stopPreviewVideoMask()}},{key:"switchCamera",value:function(e){return this[DN].switchCamera(e)}},{key:"subscribeVideoStatisticData",value:function(e){return this[DN].subscribeVideoStatisticData(e)}},{key:"unsubscribeVideoStatisticData",value:function(e){return this[DN].unsubscribeVideoStatisticData(e)}},{key:"attachVideo",value:function(e,t,n){return this[DN].attachVideo(e,t,n)}},{key:"detachVideo",value:function(e,t){return this[DN].detachVideo(e,t)}},{key:"isCapturingVideo",value:function(){return this[DN].isCapturingVideo()}},{key:"isCameraTaken",value:function(){return this[DN].isCameraTaken()}},{key:"getActiveVideoId",value:function(){return this[DN].getActiveVideoId()}},{key:"getActiveCamera",value:function(){return this[DN].getActiveCamera()}},{key:"getCameraList",value:function(){return this[DN].getCameraList()}},{key:"isCaptureForbidden",value:function(){return this[DN].isCaptureForbidden()}},{key:"getVideoMaxQuality",value:function(){return this[DN].getVideoMaxQuality()}},{key:"getReceivedVideoDimension",value:function(){return this[DN].getReceivedVideoDimension()}},{key:"isSupportMultipleVideos",value:function(){return this[DN].isSupportMultipleVideos()}},{key:"isSupportHDVideo",value:function(){return this[DN].isSupportHDVideo()}},{key:"isSupportVirtualBackground",value:function(){return this[DN].isSupportVirtualBackground()}},{key:"getVirtualbackgroundStatus",value:function(){return this[DN].getVirtualbackgroundStatus()}},{key:"getVideoStatisticData",value:function(){return this[DN].getVideoStatisticData()}},{key:"isRenderSelfViewWithVideoElement",value:function(){return this[DN].isRenderSelfViewWithVideoElement()}},{key:"getCapturedVideoResolution",value:function(){return this[DN].getCapturedVideoResolution()}},{key:"getVideoMaskStatus",value:function(){return this[DN].getVideoMaskStatus()}},{key:"isVideoMirrored",value:function(){return this[DN].isVideoMirrored()}},{key:"startShareView",value:function(e,t){return this[DN].startShareView(e,t)}},{key:"stopShareView",value:function(){return this[DN].stopShareView()}},{key:"switchShareView",value:function(e){return this[DN].switchShareView(e)}},{key:"startShareScreen",value:function(e,t){return void 0!==(null==t?void 0:t.broadcastToSubsession)&&Object.assign(t||{},{broadcastToBreakoutRoom:null==t?void 0:t.broadcastToSubsession}),this[DN].startShareScreen(e,t)}},{key:"pauseShareScreen",value:function(){return this[DN].pauseShareScreen()}},{key:"resumeShareScreen",value:function(){return this[DN].resumeShareScreen()}},{key:"stopShareScreen",value:function(){return this[DN].stopShareScreen()}},{key:"lockShare",value:function(e){return this[DN].lockShare(e)}},{key:"updateSharingCanvasDimension",value:function(e,t){return this[DN].updateSharingCanvasDimension(e,t)}},{key:"switchSharingSecondaryCamera",value:function(e){return this[DN].switchSharingSecondaryCamera(e)}},{key:"setSharePrivilege",value:function(e){return this[DN].setSharePrivilege(e)}},{key:"shareToSubsession",value:function(){return this[DN].shareToBreakoutRoom()}},{key:"stopShareToSubsession",value:function(){return this[DN].stopShareToBreakoutRoom()}},{key:"enableOptimizeForSharedVideo",value:function(e){return this[DN].enableOptimizeForSharedVideo(e)}},{key:"updateSharedVideoQuality",value:function(e){return this[DN].updateSharedVideoQuality(e)}},{key:"subscribeShareStatisticData",value:function(e){return this[DN].subscribeShareStatisticData(e)}},{key:"unsubscribeShareStatisticData",value:function(e){return this[DN].unsubscribeShareStatisticData(e)}},{key:"isShareLocked",value:function(){return this[DN].isShareLocked()}},{key:"getSharePrivilege",value:function(){return this[DN].getSharePrivilege()}},{key:"getActiveShareUserId",value:function(){return this[DN].getActiveShareUserId()}},{key:"getShareStatus",value:function(){return this[DN].getShareStatus()}},{key:"getShareUserList",value:function(){return this[DN].getShareUserList().map((function(e){return EN(e)}))}},{key:"isStartShareScreenWithVideoElement",value:function(){return this[DN].isStartShareScreenWithVideoElement()}},{key:"isOptimizeForSharedVideoEnabled",value:function(){return this[DN].isOptimizeForSharedVideoEnabled()}},{key:"isSupportOptimizedForSharedVideo",value:function(){return this[DN].isSupportOptimizedForSharedVideo()}},{key:"getShareStatisticData",value:function(){return this[DN].getShareStatisticData()}},{key:"requestFarEndCameraControl",value:function(e){return this[DN].requestFarEndCameraControl(e)}},{key:"approveFarEndCameraControl",value:function(e){return this[DN].approveFarEndCameraControl(e)}},{key:"declineFarEndCameraControl",value:function(e){return this[DN].declineFarEndCameraControl(e)}},{key:"giveUpFarEndCameraControl",value:function(e){return this[DN].giveUpFarEndCameraControl(e)}},{key:"controlCamera",value:function(e){return this[DN].controlCamera(e)}},{key:"controlFarEndCamera",value:function(e){return this[DN].controlFarEndCamera(e)}},{key:"getFarEndCameraPTZCapability",value:function(e){return this[DN].getFarEndCameraPTZCapability(e)}},{key:"getCameraPTZCapability",value:function(e){return this[DN].getCameraPTZCapability(e)}},{key:"isBrowserSupportPTZ",value:function(){return this[DN].isBrowserSupportPTZ()}},{key:"getNetworkQuality",value:function(e){return this[DN].getNetworkQuality(e)}},{key:"requestRemoteControl",value:function(){return this[DN].requestRemoteControl()}},{key:"giveUpRemoteControl",value:function(){return this[DN].giveUpRemoteControl()}},{key:"startRemoteControl",value:function(e){return this[DN].startRemoteControl(e)}},{key:"grabRemotoControl",value:function(){return this[DN].grabRemotoControl()}},{key:"approveRemoteControl",value:function(e){return this[DN].approveRemoteControl(e)}},{key:"declineRemoteControl",value:function(e){return this[DN].declineRemoteControl(e)}},{key:"stopRemoteControl",value:function(){return this[DN].stopRemoteControl()}},{key:"launchRemoteControlApp",value:function(e){return this[DN].launchRemoteControlApp(e)}},{key:"isRemotelyControlApproved",value:function(){return this[DN].isRemotelyControlApproved()}},{key:"isControllingUserRemotely",value:function(){return this[DN].isControllingUserRemotely()}},{key:"isTargetShareSupportRemoteControl",value:function(e){return this[DN].isTargetShareSupportRemoteControl(e)}},{key:"getRemoteControlAppDownloadUrl",value:function(){return this[DN].getRemoteControlAppDownloadUrl()}},{key:"getRemotelyControllingUser",value:function(){return this[DN].getRemotelyControllingUser()}},{key:"isRemoteControlEnabled",value:function(){return this[DN].isRemoteControlEnabled()}}]),e}(),xN=["isCoHost"],NN=Symbol("chat"),MN=function(){function e(t){s(this,e),this[NN]=void 0,this[NN]=t}return u(e,[{key:"send",value:function(e,t){return this[NN].send(e,t)}},{key:"sendToAll",value:function(e){return this[NN].send(e,ps.All)}},{key:"sendFile",value:function(e,t){return this[NN].sendFile(e,t)}},{key:"downloadFile",value:function(e,t,n){return this[NN].downloadFile(e,t,n)}},{key:"setPrivilege",value:function(e){return this[NN].setPrivilege(e)}},{key:"getPrivilege",value:function(){return this[NN].getPrivilege()}},{key:"getReceivers",value:function(){return this[NN].getReceivers().map((function(e){return r({isManager:e.isCoHost},c(e,xN))}))}},{key:"getHistory",value:function(){return this[NN].getHistory()}},{key:"isFileTransferEnabled",value:function(){return this[NN].isFileTransferEnabled()}},{key:"getFileTransferSetting",value:function(){return this[NN].getFileTransferSetting()}}]),e}(),FN=Symbol("recording"),LN=function(){function e(t){s(this,e),this[FN]=void 0,this[FN]=t}return u(e,[{key:"canStartRecording",value:function(){return this[FN].isRecordingEnabled()}},{key:"startCloudRecording",value:function(){return this[FN].startRecording()}},{key:"pauseCloudRecording",value:function(){return this[FN].pauseRecording()}},{key:"resumeCloudRecording",value:function(){return this[FN].startRecording()}},{key:"stopCloudRecording",value:function(){return this[FN].stopRecording()}},{key:"getCloudRecordingStatus",value:function(){return this[FN].getRecordingStatus()}},{key:"acceptIndividualRecording",value:function(){return this[FN].accept()}},{key:"declineIndividualRecording",value:function(){return this[FN].decline()}}]),e}(),VN=Symbol("command"),jN=function(){function e(t){s(this,e),this[VN]=void 0,this[VN]=t}return u(e,[{key:"send",value:function(e,t){return this[VN].send(e,t)}}]),e}(),BN=["isInRoom"],UN=["isAutoJoinRoom","isRoomSelectionEnabled"],HN=Symbol("breakout-room"),qN=function(){function e(t){s(this,e),this[HN]=void 0,this[HN]=t}return u(e,[{key:"createSubsessions",value:function(e,t){return this[HN].createRooms(e,t).then((function(e){return e.map((function(e){return{subsessionId:e.roomId,subsessionName:e.name,userList:e.attendeeList}}))}))}},{key:"openSubsessions",value:function(e,t){var n=t?r(r({},t),{},{isAutoJoinRoom:t.isAutoJoinSubsession,isRoomSelectionEnabled:t.isSubsessionSelectionEnabled}):void 0,i=e.map((function(e){return{roomId:e.subsessionId,name:e.subsessionName,attendeeList:e.userList}}));return this[HN].openRooms(i,n)}},{key:"joinSubsession",value:function(e){return this[HN].joinRoom(e)}},{key:"leaveSubsession",value:function(){return this[HN].leaveRoom()}},{key:"askForHelp",value:function(){return this[HN].askForHelp()}},{key:"postponeHelping",value:function(e){return this[HN].postponeHelping(e)}},{key:"broadcast",value:function(e){return this[HN].broadcast(e)}},{key:"assignUserToSubsession",value:function(e,t){return this[HN].assignUserToRoom(e,t)}},{key:"moveUserToSubsession",value:function(e,t){return this[HN].moveUserToRoom(e,t)}},{key:"moveBackToMainSession",value:function(e){return this[HN].moveBackToMainSession(e)}},{key:"closeAllSubsessions",value:function(){return this[HN].closeRoom()}},{key:"startBroadcastVoice",value:function(){return this[HN].startBroadcastVoice()}},{key:"stopBroadcastVoice",value:function(){return this[HN].stopBroadcastVoice()}},{key:"getUnassignedUserList",value:function(){return this[HN].getUnassignedAttendeeList().map((function(e){return EN(e)}))}},{key:"getSubsessionList",value:function(){return this[HN].getRoomList().map((function(e){return{subsessionId:e.roomId,subsessionName:e.name,userList:e.attendeeList.map((function(e){var t=e;return r({isInSubsession:t.isInRoom},c(t,BN))}))}}))}},{key:"getUserStatus",value:function(){return this[HN].getAttendeeStatus()}},{key:"getSubsessionStatus",value:function(){return this[HN].getRoomStatus()}},{key:"getCurrentSubsession",value:function(){var e=this[HN].getCurrentRoom();return{userStatus:e.attendeeStatus,subsessionName:e.name,subsessionId:e.roomId}}},{key:"getSubsessionOptions",value:function(){var e=this[HN].getRoomOptions();return r({isAutoJoinSubsession:e.isAutoJoinRoom,isSubsessionSelectionEnabled:e.isRoomSelectionEnabled},c(e,UN))}}]),e}(),KN=Symbol("liveTranscription"),$N=function(){function e(t){s(this,e),this[KN]=void 0,this[KN]=t}return u(e,[{key:"startLiveTranscription",value:function(){return this[KN].startLiveTranscription()}},{key:"setSpeakingLanguage",value:function(e){return this[KN].setSpeakingLanguage(e)}},{key:"setTranslationLanguage",value:function(e){return this[KN].setTranslationLanguage(e)}},{key:"getLiveTranscriptionStatus",value:function(){return this[KN].getLiveTranscriptionStatus()}},{key:"getCurrentTranscriptionLanguage",value:function(){return this[KN].getCurrentTranscriptionLanguage()}},{key:"getCurrentTranslationLanguage",value:function(){return this[KN].getCurrentTranslationLanguage()}},{key:"getLatestTranscription",value:function(){return this[KN].getLatestTranscription()}},{key:"getLatestTranslation",value:function(){return this[KN].getLatestTranslation()}},{key:"getFullTranscriptionHistory",value:function(){return this[KN].getFullTranscriptionHistory()}},{key:"disableCaptions",value:function(e){return this[KN].disableCaptions(e)}}]),e}(),WN=Symbol("liveStream"),GN=function(){function e(t){s(this,e),this[WN]=void 0,this[WN]=t}return u(e,[{key:"startLiveStream",value:function(e,t,n){return this[WN].startLiveStream(e,t,n)}},{key:"stopLiveStream",value:function(){return this[WN].stopLiveStream()}},{key:"isLiveStreamEnabled",value:function(){return this[WN].isLiveStreamEnabled()}},{key:"getLiveStreamStatus",value:function(){return this[WN].getLiveStreamStatus()}}]),e}(),zN=Symbol("logger"),JN=function(){function e(t,n){if(s(this,e),this[zN]=void 0,this[zN]=t,n){var i=n.debugMode,r=n.trackingId;this[zN].setLogOptions({debugMode:i,trackingId:r})}}return u(e,[{key:"reportToGlobalTracing",value:function(e){return this[zN].reportToGlobalTracing(e)}},{key:"reportRating",value:function(e,t){return this[zN].reportRating(e,t)}}]),e}(),QN=["roomName"],YN=["roomId","roomName"],ZN=[{event:"connection-change",originalEvent:"connection-change",payloadTransform:function(e){var t=e.roomName,n=c(e,QN);return t?r(r({},n),{},{subsessionName:t}):e}},{event:"user-added",originalEvent:"user-added",payloadTransform:function(e){return e.map((function(e){return wN(e)}))}},{event:"user-updated",originalEvent:"user-updated",payloadTransform:function(e){return e.map((function(e){return wN(e)}))}},{event:"user-removed",originalEvent:"user-removed",payloadTransform:function(e){return e.map((function(e){return wN(e)}))}},{event:"subsession-invite-to-join",originalEvent:"invite-to-join",payloadTransform:function(e){return{subsessionId:e.roomId,subsessionName:e.name}}},{event:"subsession-countdown",originalEvent:"room-countdown"},{event:"subsession-time-up",originalEvent:"room-time-up"},{event:"closing-subsession-countdown",originalEvent:"closing-room-countdown"},{event:"subsession-broadcast-message",originalEvent:"broadcast-message"},{event:"subsession-broadcast-voice",originalEvent:"broadcast-voice"},{event:"subsession-ask-for-help",originalEvent:"ask-for-help",payloadTransform:function(e){return{userId:e.userId,userGuid:e.userGuid,displayName:e.displayName,subsessionId:e.roomId,subsessionName:e.roomName}}},{event:"subsession-ask-for-help-response",originalEvent:"ask-for-help-response"},{event:"subsession-invite-back-to-main-session",originalEvent:"invite-back-to-main-session"},{event:"subsession-state-change",originalEvent:"room-state-change"},{event:"host-ask-unmute-audio",originalEvent:"unmute-audio-consent"},{event:"subsession-user-update",originalEvent:"room-user-update",payloadTransform:function(e){return r({subsessionId:e.roomId,subsessionName:e.roomName},c(e,YN))}}],XN=Symbol("summary"),eM=function(){function e(t){s(this,e),this[XN]=void 0,this[XN]=t}return u(e,[{key:"startSummary",value:function(){return this[XN].startSummary()}},{key:"stopSummary",value:function(){return this[XN].stopSummary()}},{key:"isSummaryEnabled",value:function(){return this[XN].isSummaryEnabled()}},{key:"getSummaryStatus",value:function(){return this[XN].getSummaryStatus()}},{key:"startMeetingQuery",value:function(){return this[XN].startMeetingQuery()}},{key:"stopMeetingQuery",value:function(){return this[XN].stopMeetingQuery()}},{key:"isMeetingQueryEnabled",value:function(){return this[XN].isMeetingQueryEnabled()}},{key:"getMeetingQueryStatus",value:function(){return this[XN].getMeetingQueryStatus()}}]),e}(),tM=Symbol("Client"),nM=new WeakMap,iM=function(){function e(){s(this,e),this[tM]=void 0,this.stream=void 0,this.chat=void 0,this.command=void 0,this.recording=void 0,this.subsession=void 0,this.liveTranscription=void 0,this.logger=void 0,this.liveStream=void 0,this.aiClient=void 0,this[tM]=lN.createClient(),nM.set(this,new Map)}return u(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US",t=arguments.length>2?arguments[2]:void 0,n=mN(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Global");return!1===window.isSecureContext&&console.warn("The page is not in a secure context, to use audio, video, screen, a secure context must be enabled."),function(){var e="__ZOOM_VIDEO_SDK_DOM_STORAGE_TEST__";try{return localStorage.setItem(e,e),localStorage.removeItem(e),sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch(e){return!1}}()||console.warn("localstorage or sessionstorage is not enabled, please enable to use the video sdk,"),this[tM].init("","",{language:e,dependentAssets:n,constraints:r(r({},lN.checkSystemRequirements()),{},{screen:"object"===("undefined"==typeof WebAssembly?"undefined":o(WebAssembly))&&"function"==typeof Worker}),additionalFeatures:["chat","cmd","recording","breakoutRoom","liveTranscription","logger","liveStream","summary"],webEndpoint:(null==t?void 0:t.webEndpoint)||"zoom.us",skipJsMedia:null==t?void 0:t.skipJsMedia,enforceMultipleVideos:null==t?void 0:t.enforceMultipleVideos,stayAwake:null==t?void 0:t.stayAwake,enforceVirtualBackground:null==t?void 0:t.enforceVirtualBackground,quicklyLeaveMeeting:null==t?void 0:t.leaveOnPageUnload,patchJsMedia:null==t?void 0:t.patchJsMedia,alternativeNameForVideoPlayer:null==t?void 0:t.alternativeNameForVideoPlayer})}},{key:"join",value:function(e,t,n,i,r){return gN(e)&&gN(t)&&gN(n)?e.length>200?Promise.reject({type:dN,reason:"The maximum length of topic is 200"}):n.length>200?Promise.reject({type:dN,reason:"The maximum length of username is 200"}):i&&("string"!=typeof i||i.length>10)?Promise.reject({type:dN,reason:"The maximum length of password is 10"}):this[tM].joinInstant(e,t,n,cN,i,r):Promise.reject({type:dN,reason:"Topic, token and userName must be string and required"})}},{key:"leave",value:function(){var e;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(null===(e=nM.get(this))||void 0===e||e.clear(),this[tM].end()):this[tM].leave()}},{key:"on",value:function(e,t){var n=ZN.find((function(t){return t.event===e}));if(n){var i=n.originalEvent,r=n.payloadTransform;if(r){var o=function(e){var n=r(e);t(n)};this[tM].on(i,o);var s=nM.get(this);if(s){s.has(e)||s.set(e,[]);var a=s.get(e);null==a||a.push({originalCb:t,newCb:o})}}else this[tM].on(i,t)}else this[tM].on(e,t)}},{key:"off",value:function(e,t){var n=ZN.find((function(t){return t.event===e}));if(n){var i=n.originalEvent;if(n.payloadTransform){var r=nM.get(this);if(r){var o=r.get(e),s=null==o?void 0:o.find((function(e){return e.originalCb===t}));if(s&&o){this[tM].off(i,s.newCb);var a=null==o?void 0:o.filter((function(e){return e.originalCb!==t}));r.set(e,a)}}}else this[tM].off(i,t)}else this[tM].off(e,t)}},{key:"getMediaStream",value:function(){return this.stream||(this.stream=new kN(this[tM].getMediaStream())),this.stream}},{key:"getChatClient",value:function(){return this.chat||(this.chat=new MN(this[tM].getFeatureModule("chat"))),this.chat}},{key:"getRecordingClient",value:function(){return this.recording||(this.recording=new LN(this[tM].getFeatureModule("recording"))),this.recording}},{key:"getCommandClient",value:function(){return this.command||(this.command=new jN(this[tM].getFeatureModule("cmd"))),this.command}},{key:"getSubsessionClient",value:function(){return this.subsession||(this.subsession=new qN(this[tM].getFeatureModule("breakoutRoom"))),this.subsession}},{key:"getLiveTranscriptionClient",value:function(){return this.liveTranscription||(this.liveTranscription=new $N(this[tM].getFeatureModule("liveTranscription"))),this.liveTranscription}},{key:"getLoggerClient",value:function(e){return this.logger||(this.logger=new JN(this[tM].getFeatureModule("logger"),e)),this.logger}},{key:"getLiveStreamClient",value:function(){return this.liveStream||(this.liveStream=new GN(this[tM].getFeatureModule("liveStream"))),this.liveStream}},{key:"getAIClient",value:function(){return this.aiClient||(this.aiClient=new eM(this[tM].getFeatureModule("summary"))),this.aiClient}},{key:"getSessionInfo",value:function(){var e=this[tM].getMeetingInfo();return{isInMeeting:e.isInMeeting||!1,password:e.password||"",topic:e.topic,userName:e.userName,userId:e.userId,sessionId:e.meetingId}}},{key:"getCurrentUserInfo",value:function(){return EN(this[tM].getCurrentUserInfo())}},{key:"getUser",value:function(e){return EN(this[tM].getParticipantsList().find((function(t){return t.userId===e})))}},{key:"getAllUser",value:function(){return this[tM].getParticipantsList().map((function(e){return EN(e)}))}},{key:"changeName",value:function(e,t){return this[tM].changeName(e,t)}},{key:"makeHost",value:function(e){return this[tM].makeHost(e)}},{key:"removeUser",value:function(e){return this[tM].removeUser(e)}},{key:"makeManager",value:function(e){return this[tM].makeCoHost(e)}},{key:"revokeManager",value:function(e){return this[tM].revokeCoHost(e)}},{key:"reclaimHost",value:function(){return this[tM].reclaimHost()}},{key:"isHost",value:function(){return this[tM].isHost()}},{key:"isOriginalHost",value:function(){return this[tM].isOriginHost()}},{key:"getSessionHost",value:function(){return EN(this[tM].getMeetingHost())}},{key:"isManager",value:function(){return this[tM].isCoHost()}}]),e}(),rM=function(){function e(){s(this,e)}return u(e,null,[{key:"createClient",value:function(){return this.videoClient||(this.videoClient=new iM),this.videoClient}},{key:"destroyClient",value:function(){this.videoClient&&(this.videoClient.leave(),this.videoClient=null)}},{key:"checkSystemRequirements",value:function(){return lN.checkSystemRequirements()}},{key:"checkFeatureRequirements",value:function(){return lN.checkFeatureRequirements()}},{key:"getDevices",value:function(e){return lN.getDevices(e)}},{key:"createLocalAudioTrack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return lN.createLocalAudioTrack(e)}},{key:"createLocalVideoTrack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return lN.createLocalVideoTrack(e)}},{key:"preloadDependentAssets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Global";lN.preloadDependentAssets(mN(e))}}]),e}();rM.videoClient=void 0,rM.VERSION=cN,t.ChatPrivilege=void 0,(_N=t.ChatPrivilege||(t.ChatPrivilege={}))[_N.All=1]="All",_N[_N.NoOne=4]="NoOne",_N[_N.EveryonePublicly=5]="EveryonePublicly",t.ChatMsgType=void 0,(IN=t.ChatMsgType||(t.ChatMsgType={}))[IN.All=0]="All",t.SubsessionAllocationPattern=void 0,(CN=t.SubsessionAllocationPattern||(t.SubsessionAllocationPattern={}))[CN.Automatically=th.Automatically]="Automatically",CN[CN.Manually=th.Manually]="Manually",t.SubsessionUserStatus=void 0,(AN=t.SubsessionUserStatus||(t.SubsessionUserStatus={}))[AN.Initial=rh.Initial]="Initial",AN[AN.Invited=rh.Invited]="Invited",AN[AN.Joining=rh.Joining]="Joining",AN[AN.InSubsession=rh.InRoom]="InSubsession",AN[AN.Leaving=rh.Leaving]="Leaving",AN[AN.MainSession=rh.MainSession]="MainSession",t.SubsessionStatus=void 0,(TN=t.SubsessionStatus||(t.SubsessionStatus={}))[TN.NotStarted=nh.NotStarted]="NotStarted",TN[TN.InProgress=nh.InProgress]="InProgress",TN[TN.Closing=nh.Closing]="Closing",TN[TN.Closed=nh.Closed]="Closed",t.ReconnectReason=void 0,(RN=t.ReconnectReason||(t.ReconnectReason={}))[RN.Failover=Eo.Failover]="Failover",RN[RN.JoinSubsession=Eo.JoinBreakoutRoom]="JoinSubsession",RN[RN.MoveToSubsession=Eo.MoveToBreakoutRoom]="MoveToSubsession",RN[RN.BackToMainSession=Eo.BackToMainSession]="BackToMainSession",t.SharePrivilege=void 0,(ON=t.SharePrivilege||(t.SharePrivilege={}))[ON.Unlocked=Ha.HostGrab]="Unlocked",ON[ON.Locked=Ha.OnlyHost]="Locked",ON[ON.MultipleShare=Ha.MultipleShare]="MultipleShare",t.RemoteControlAppStatus=void 0,(PN=t.RemoteControlAppStatus||(t.RemoteControlAppStatus={}))[PN.Unknown=bu.Unknown]="Unknown",PN[PN.Uninstalled=bu.Uninstalled]="Uninstalled",PN[PN.Installed=bu.Installed]="Installed",PN[PN.Unlaunched=Eu.Unlaunched]="Unlaunched",PN[PN.Launched=Eu.Launched]="Launched",t.ApprovedState=za,t.AskHostHelpResponse=ah,t.AudioChangeAction=La,t.CRCProtocol=Ru,t.CRCReturnCode=Ou,t.CameraControlCmd=fu,t.ChatFileDownloadStatus=As,t.ChatFileUploadStatus=Cs,t.ConnectionState=Io,t.DialoutState=Va,t.FarEndCameraControlDeclinedReason=gu,t.LeaveAudioSource=Fa,t.LiveStreamStatus=Rx,t.LiveTranscriptionLanguage=hx,t.LiveTranscriptionLanguageCode=dx,t.LiveTranscriptionMessageSource=ox,t.MobileVideoFacingMode=Za,t.MutedSource=Na,t.PassiveStopShareReason=Ja,t.RecordingStatus=ya,t.RemoteControlSessionStatus=wu,t.ShareStatus=qa,t.VideoActiveState=$a,t.VideoCapturingState=Ga,t.VideoQuality=Ka,t.default=rM,Object.defineProperty(t,"__esModule",{value:!0})}(t)},355:(e,t)=>{var n,i,r,o,s,a,u,l,c,d,h,p={userAgent:!1},f={},g=g||(n=Math,r=(i={}).lib={},o=r.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=r.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var s=n[o>>>2]>>>24-o%4*8&255;t[i+o>>>2]|=s<<24-(i+o)%4*8}else for(o=0;o<r;o+=4)t[i+o>>>2]=n[o>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=n.ceil(t/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],i=0;i<e;i+=4)t.push(4294967296*n.random()|0);return new s.init(t,e)}}),a=i.enc={},u=a.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var o=t[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(n,t/2)}},l=a.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var o=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(n,t)}},c=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,i=t.words,r=t.sigBytes,o=this.blockSize,a=r/(4*o),u=(a=e?n.ceil(a):n.max((0|a)-this._minBufferSize,0))*o,l=n.min(4*u,r);if(u){for(var c=0;c<u;c+=o)this._doProcessBlock(i,c);var d=i.splice(0,u);t.sigBytes-=l}return new s.init(d,l)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),r.Hasher=d.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}}),h=i.algo={},i);!function(e){var t,n=(t=g).lib,i=n.Base,r=n.WordArray;(t=t.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],i=0;i<t;i++){var o=e[i];n.push(o.high),n.push(o.low)}return r.create(n,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}})}(),g.lib.Cipher||function(e){var t=(p=g).lib,n=t.Base,i=t.WordArray,r=t.BufferedBlockAlgorithm,o=p.enc.Base64,s=p.algo.EvpKDF,a=t.Cipher=r.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,i){return("string"==typeof n?f:h).encrypt(e,t,n,i)},decrypt:function(t,n,i){return("string"==typeof n?f:h).decrypt(e,t,n,i)}}}});t.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=p.mode={},l=function(e,t,n){var i=this._iv;i?this._iv=void 0:i=this._prevBlock;for(var r=0;r<n;r++)e[t+r]^=i[r]},c=(t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();c.Encryptor=c.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize;l.call(this,e,t,i),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),c.Decryptor=c.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,r=e.slice(t,t+i);n.decryptBlock(e,t),l.call(this,e,t,i),this._prevBlock=r}}),u=u.CBC=c,c=(p.pad={}).Pkcs7={pad:function(e,t){for(var n,r=(n=(n=4*t)-e.sigBytes%n)<<24|n<<16|n<<8|n,o=[],s=0;s<n;s+=4)o.push(r);n=i.create(o,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=a.extend({cfg:a.cfg.extend({mode:u,padding:c}),reset:function(){a.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var d=t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),h=(u=(p.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?i.create([1398893684,1701076831]).concat(e).concat(t):t).toString(o)},parse:function(e){var t=(e=o.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var n=i.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return d.create({ciphertext:e,salt:n})}},t.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(e,t,n,i){i=this.cfg.extend(i);var r=e.createEncryptor(n,i);return t=r.finalize(t),r=r.cfg,d.create({ciphertext:t,key:n,iv:r.iv,algorithm:e,mode:r.mode,padding:r.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(n,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),p=(p.kdf={}).OpenSSL={execute:function(e,t,n,r){return r||(r=i.random(8)),e=s.create({keySize:t+n}).compute(e,r),n=i.create(e.words.slice(t),4*n),e.sigBytes=4*t,d.create({key:e,iv:n,salt:r})}},f=t.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:p}),encrypt:function(e,t,n,i){return n=(i=this.cfg.extend(i)).kdf.execute(n,e.keySize,e.ivSize),i.iv=n.iv,(e=h.encrypt.call(this,e,t,n.key,i)).mixIn(n),e},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),n=i.kdf.execute(n,e.keySize,e.ivSize,t.salt),i.iv=n.iv,h.decrypt.call(this,e,t,n.key,i)}})}(),function(){for(var e=g,t=e.lib.BlockCipher,n=e.algo,i=[],r=[],o=[],s=[],a=[],u=[],l=[],c=[],d=[],h=[],p=[],f=0;256>f;f++)p[f]=128>f?f<<1:f<<1^283;var m=0,v=0;for(f=0;256>f;f++){var y=(y=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&y^99;i[m]=y,r[y]=m;var S=p[m],b=p[S],E=p[b],w=257*p[y]^16843008*y;o[m]=w<<24|w>>>8,s[m]=w<<16|w>>>16,a[m]=w<<8|w>>>24,u[m]=w,w=16843009*E^65537*b^257*S^16843008*m,l[y]=w<<24|w>>>8,c[y]=w<<16|w>>>16,d[y]=w<<8|w>>>24,h[y]=w,m?(m=S^p[p[p[E^S]]],v^=p[p[v]]):m=v=1}var _=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=t.extend({_doReset:function(){for(var e=(n=this._key).words,t=n.sigBytes/4,n=4*((this._nRounds=t+6)+1),r=this._keySchedule=[],o=0;o<n;o++)if(o<t)r[o]=e[o];else{var s=r[o-1];o%t?6<t&&4==o%t&&(s=i[s>>>24]<<24|i[s>>>16&255]<<16|i[s>>>8&255]<<8|i[255&s]):(s=i[(s=s<<8|s>>>24)>>>24]<<24|i[s>>>16&255]<<16|i[s>>>8&255]<<8|i[255&s],s^=_[o/t|0]<<24),r[o]=r[o-t]^s}for(e=this._invKeySchedule=[],t=0;t<n;t++)o=n-t,s=t%4?r[o]:r[o-4],e[t]=4>t||4>=o?s:l[i[s>>>24]]^c[i[s>>>16&255]]^d[i[s>>>8&255]]^h[i[255&s]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,s,a,u,i)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,c,d,h,r),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,i,r,o,s,a){for(var u=this._nRounds,l=e[t]^n[0],c=e[t+1]^n[1],d=e[t+2]^n[2],h=e[t+3]^n[3],p=4,f=1;f<u;f++){var g=i[l>>>24]^r[c>>>16&255]^o[d>>>8&255]^s[255&h]^n[p++],m=i[c>>>24]^r[d>>>16&255]^o[h>>>8&255]^s[255&l]^n[p++],v=i[d>>>24]^r[h>>>16&255]^o[l>>>8&255]^s[255&c]^n[p++];h=i[h>>>24]^r[l>>>16&255]^o[c>>>8&255]^s[255&d]^n[p++],l=g,c=m,d=v}g=(a[l>>>24]<<24|a[c>>>16&255]<<16|a[d>>>8&255]<<8|a[255&h])^n[p++],m=(a[c>>>24]<<24|a[d>>>16&255]<<16|a[h>>>8&255]<<8|a[255&l])^n[p++],v=(a[d>>>24]<<24|a[h>>>16&255]<<16|a[l>>>8&255]<<8|a[255&c])^n[p++],h=(a[h>>>24]<<24|a[l>>>16&255]<<16|a[c>>>8&255]<<8|a[255&d])^n[p++],e[t]=g,e[t+1]=m,e[t+2]=v,e[t+3]=h},keySize:8}),e.AES=t._createHelper(n)}(),function(){function e(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function t(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}var n=g,i=(r=n.lib).WordArray,r=r.BlockCipher,o=n.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],l=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],c=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=o.DES=r.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;56>n;n++){var i=s[n]-1;t[n]=e[i>>>5]>>>31-i%32&1}for(e=this._subKeys=[],i=0;16>i;i++){var r=e[i]=[],o=u[i];for(n=0;24>n;n++)r[n/6|0]|=t[(a[n]-1+o)%28]<<31-n%6,r[4+(n/6|0)]|=t[28+(a[n+24]-1+o)%28]<<31-n%6;for(r[0]=r[0]<<1|r[0]>>>31,n=1;7>n;n++)r[n]>>>=4*(n-1)+3;r[7]=r[7]<<5|r[7]>>>27}for(t=this._invSubKeys=[],n=0;16>n;n++)t[n]=e[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(n,i,r){this._lBlock=n[i],this._rBlock=n[i+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var o=0;16>o;o++){for(var s=r[o],a=this._lBlock,u=this._rBlock,d=0,h=0;8>h;h++)d|=l[h][((u^s[h])&c[h])>>>0];this._lBlock=u,this._rBlock=a^d}r=this._lBlock,this._lBlock=this._rBlock,this._rBlock=r,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),n[i]=this._lBlock,n[i+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});n.DES=r._createHelper(d),o=o.TripleDES=r.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(i.create(e.slice(0,2))),this._des2=d.createEncryptor(i.create(e.slice(2,4))),this._des3=d.createEncryptor(i.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2}),n.TripleDES=r._createHelper(o)}(),function(){var e=g,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp(),e=[];for(var r=0;r<n;r+=3)for(var o=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,s=0;4>s&&r+.75*s<n;s++)e.push(i.charAt(o>>>6*(3-s)&63));if(t=i.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,i=this._map;(r=i.charAt(64))&&-1!=(r=e.indexOf(r))&&(n=r);for(var r=[],o=0,s=0;s<n;s++)if(s%4){var a=i.indexOf(e.charAt(s-1))<<s%4*2,u=i.indexOf(e.charAt(s))>>>6-s%4*2;r[o>>>2]|=(a|u)<<24-o%4*8,o++}return t.create(r,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,i,r,o,s){return((e=e+(t&n|~t&i)+r+s)<<o|e>>>32-o)+t}function n(e,t,n,i,r,o,s){return((e=e+(t&i|n&~i)+r+s)<<o|e>>>32-o)+t}function i(e,t,n,i,r,o,s){return((e=e+(t^n^i)+r+s)<<o|e>>>32-o)+t}function r(e,t,n,i,r,o,s){return((e=e+(n^(t|~i))+r+s)<<o|e>>>32-o)+t}for(var o=g,s=(u=o.lib).WordArray,a=u.Hasher,u=o.algo,l=[],c=0;64>c;c++)l[c]=4294967296*e.abs(e.sin(c+1))|0;u=u.MD5=a.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,o){for(var s=0;16>s;s++){var a=e[u=o+s];e[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}s=this._hash.words;var u=e[o+0],c=(a=e[o+1],e[o+2]),d=e[o+3],h=e[o+4],p=e[o+5],f=e[o+6],g=e[o+7],m=e[o+8],v=e[o+9],y=e[o+10],S=e[o+11],b=e[o+12],E=e[o+13],w=e[o+14],_=e[o+15],I=t(I=s[0],T=s[1],A=s[2],C=s[3],u,7,l[0]),C=t(C,I,T,A,a,12,l[1]),A=t(A,C,I,T,c,17,l[2]),T=t(T,A,C,I,d,22,l[3]);I=t(I,T,A,C,h,7,l[4]),C=t(C,I,T,A,p,12,l[5]),A=t(A,C,I,T,f,17,l[6]),T=t(T,A,C,I,g,22,l[7]),I=t(I,T,A,C,m,7,l[8]),C=t(C,I,T,A,v,12,l[9]),A=t(A,C,I,T,y,17,l[10]),T=t(T,A,C,I,S,22,l[11]),I=t(I,T,A,C,b,7,l[12]),C=t(C,I,T,A,E,12,l[13]),A=t(A,C,I,T,w,17,l[14]),I=n(I,T=t(T,A,C,I,_,22,l[15]),A,C,a,5,l[16]),C=n(C,I,T,A,f,9,l[17]),A=n(A,C,I,T,S,14,l[18]),T=n(T,A,C,I,u,20,l[19]),I=n(I,T,A,C,p,5,l[20]),C=n(C,I,T,A,y,9,l[21]),A=n(A,C,I,T,_,14,l[22]),T=n(T,A,C,I,h,20,l[23]),I=n(I,T,A,C,v,5,l[24]),C=n(C,I,T,A,w,9,l[25]),A=n(A,C,I,T,d,14,l[26]),T=n(T,A,C,I,m,20,l[27]),I=n(I,T,A,C,E,5,l[28]),C=n(C,I,T,A,c,9,l[29]),A=n(A,C,I,T,g,14,l[30]),I=i(I,T=n(T,A,C,I,b,20,l[31]),A,C,p,4,l[32]),C=i(C,I,T,A,m,11,l[33]),A=i(A,C,I,T,S,16,l[34]),T=i(T,A,C,I,w,23,l[35]),I=i(I,T,A,C,a,4,l[36]),C=i(C,I,T,A,h,11,l[37]),A=i(A,C,I,T,g,16,l[38]),T=i(T,A,C,I,y,23,l[39]),I=i(I,T,A,C,E,4,l[40]),C=i(C,I,T,A,u,11,l[41]),A=i(A,C,I,T,d,16,l[42]),T=i(T,A,C,I,f,23,l[43]),I=i(I,T,A,C,v,4,l[44]),C=i(C,I,T,A,b,11,l[45]),A=i(A,C,I,T,_,16,l[46]),I=r(I,T=i(T,A,C,I,c,23,l[47]),A,C,u,6,l[48]),C=r(C,I,T,A,g,10,l[49]),A=r(A,C,I,T,w,15,l[50]),T=r(T,A,C,I,p,21,l[51]),I=r(I,T,A,C,b,6,l[52]),C=r(C,I,T,A,d,10,l[53]),A=r(A,C,I,T,y,15,l[54]),T=r(T,A,C,I,a,21,l[55]),I=r(I,T,A,C,m,6,l[56]),C=r(C,I,T,A,_,10,l[57]),A=r(A,C,I,T,f,15,l[58]),T=r(T,A,C,I,E,21,l[59]),I=r(I,T,A,C,h,6,l[60]),C=r(C,I,T,A,S,10,l[61]),A=r(A,C,I,T,c,15,l[62]),T=r(T,A,C,I,v,21,l[63]),s[0]=s[0]+I|0,s[1]=s[1]+T|0,s[2]=s[2]+A|0,s[3]=s[3]+C|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;n[r>>>5]|=128<<24-r%32;var o=e.floor(i/4294967296);for(n[15+(r+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),n[14+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(n.length+1),this._process(),n=(t=this._hash).words,i=0;4>i;i++)r=n[i],n[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return t},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=a._createHelper(u),o.HmacMD5=a._createHmacHelper(u)}(Math),function(){var e=g,t=(r=e.lib).WordArray,n=r.Hasher,i=[],r=e.algo.SHA1=n.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],s=n[2],a=n[3],u=n[4],l=0;80>l;l++){if(16>l)i[l]=0|e[t+l];else{var c=i[l-3]^i[l-8]^i[l-14]^i[l-16];i[l]=c<<1|c>>>31}c=(r<<5|r>>>27)+u+i[l],c=20>l?c+(1518500249+(o&s|~o&a)):40>l?c+(1859775393+(o^s^a)):60>l?c+((o&s|o&a|s&a)-1894007588):c+((o^s^a)-899497514),u=a,a=s,s=o<<30|o>>>2,o=r,r=c}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=n._createHelper(r),e.HmacSHA1=n._createHmacHelper(r)}(),function(e){for(var t=g,n=(r=t.lib).WordArray,i=r.Hasher,r=t.algo,o=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},u=2,l=0;64>l;){var c;e:{c=u;for(var d=e.sqrt(c),h=2;h<=d;h++)if(!(c%h)){c=!1;break e}c=!0}c&&(8>l&&(o[l]=a(e.pow(u,.5))),s[l]=a(e.pow(u,1/3)),l++),u++}var p=[];r=r.SHA256=i.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],a=n[3],u=n[4],l=n[5],c=n[6],d=n[7],h=0;64>h;h++){if(16>h)p[h]=0|e[t+h];else{var f=p[h-15],g=p[h-2];p[h]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+p[h-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+p[h-16]}f=d+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&l^~u&c)+s[h]+p[h],g=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&o^r&o),d=c,c=l,l=u,u=a+f|0,a=o,o=r,r=i,i=f+g|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=e.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA256=i._createHelper(r),t.HmacSHA256=i._createHmacHelper(r)}(Math),function(){var e=g,t=e.lib.WordArray,n=(i=e.algo).SHA256,i=i.SHA224=n.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=n._createHelper(i),e.HmacSHA224=n._createHmacHelper(i)}(),function(){function e(){return i.create.apply(i,arguments)}for(var t=g,n=t.lib.Hasher,i=(o=t.x64).Word,r=o.WordArray,o=t.algo,s=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],a=[],u=0;80>u;u++)a[u]=e();o=o.SHA512=n.extend({_doReset:function(){this._hash=new r.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=(d=this._hash.words)[0],i=d[1],r=d[2],o=d[3],u=d[4],l=d[5],c=d[6],d=d[7],h=n.high,p=n.low,f=i.high,g=i.low,m=r.high,v=r.low,y=o.high,S=o.low,b=u.high,E=u.low,w=l.high,_=l.low,I=c.high,C=c.low,A=d.high,T=d.low,R=h,O=p,P=f,D=g,k=m,x=v,N=y,M=S,F=b,L=E,V=w,j=_,B=I,U=C,H=A,q=T,K=0;80>K;K++){var $=a[K];if(16>K)var W=$.high=0|e[t+2*K],G=$.low=0|e[t+2*K+1];else{W=((G=(W=a[K-15]).high)>>>1|(z=W.low)<<31)^(G>>>8|z<<24)^G>>>7;var z=(z>>>1|G<<31)^(z>>>8|G<<24)^(z>>>7|G<<25),J=((G=(J=a[K-2]).high)>>>19|(Q=J.low)<<13)^(G<<3|Q>>>29)^G>>>6,Q=(Q>>>19|G<<13)^(Q<<3|G>>>29)^(Q>>>6|G<<26),Y=(G=a[K-7]).high,Z=(X=a[K-16]).high,X=X.low;W=(W=(W=W+Y+((G=z+G.low)>>>0<z>>>0?1:0))+J+((G+=Q)>>>0<Q>>>0?1:0))+Z+((G+=X)>>>0<X>>>0?1:0),$.high=W,$.low=G}Y=F&V^~F&B,X=L&j^~L&U,$=R&P^R&k^P&k;var ee=O&D^O&x^D&x,te=(z=(R>>>28|O<<4)^(R<<30|O>>>2)^(R<<25|O>>>7),J=(O>>>28|R<<4)^(O<<30|R>>>2)^(O<<25|R>>>7),(Q=s[K]).high),ne=Q.low;Z=H+((F>>>14|L<<18)^(F>>>18|L<<14)^(F<<23|L>>>9))+((Q=q+((L>>>14|F<<18)^(L>>>18|F<<14)^(L<<23|F>>>9)))>>>0<q>>>0?1:0),H=B,q=U,B=V,U=j,V=F,j=L,F=N+(Z=(Z=(Z=Z+Y+((Q+=X)>>>0<X>>>0?1:0))+te+((Q+=ne)>>>0<ne>>>0?1:0))+W+((Q+=G)>>>0<G>>>0?1:0))+((L=M+Q|0)>>>0<M>>>0?1:0)|0,N=k,M=x,k=P,x=D,P=R,D=O,R=Z+($=z+$+((G=J+ee)>>>0<J>>>0?1:0))+((O=Q+G|0)>>>0<Q>>>0?1:0)|0}p=n.low=p+O,n.high=h+R+(p>>>0<O>>>0?1:0),g=i.low=g+D,i.high=f+P+(g>>>0<D>>>0?1:0),v=r.low=v+x,r.high=m+k+(v>>>0<x>>>0?1:0),S=o.low=S+M,o.high=y+N+(S>>>0<M>>>0?1:0),E=u.low=E+L,u.high=b+F+(E>>>0<L>>>0?1:0),_=l.low=_+j,l.high=w+V+(_>>>0<j>>>0?1:0),C=c.low=C+U,c.high=I+B+(C>>>0<U>>>0?1:0),T=d.low=T+q,d.high=A+H+(T>>>0<q>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(i+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=n._createHelper(o),t.HmacSHA512=n._createHmacHelper(o)}(),function(){var e=g,t=(r=e.x64).Word,n=r.WordArray,i=(r=e.algo).SHA512,r=r.SHA384=i.extend({_doReset:function(){this._hash=new n.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=i._createHelper(r),e.HmacSHA384=i._createHmacHelper(r)}(),function(){var e=g,t=(i=e.lib).WordArray,n=i.Hasher,i=e.algo,r=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),s=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=t.create([0,1518500249,1859775393,2400959708,2840853838]),l=t.create([1352829926,1548603684,1836072691,2053994217,0]);i=i.RIPEMD160=n.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;16>n;n++){var i=e[E=t+n];e[E]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var c,d,h,p,f,g,m,v,y,S,b,E=this._hash.words,w=(i=u.words,l.words),_=r.words,I=o.words,C=s.words,A=a.words;for(g=c=E[0],m=d=E[1],v=h=E[2],y=p=E[3],S=f=E[4],n=0;80>n;n+=1)b=c+e[t+_[n]]|0,b=16>n?b+((d^h^p)+i[0]):32>n?b+((d&h|~d&p)+i[1]):48>n?b+(((d|~h)^p)+i[2]):64>n?b+((d&p|h&~p)+i[3]):b+((d^(h|~p))+i[4]),b=(b=(b|=0)<<C[n]|b>>>32-C[n])+f|0,c=f,f=p,p=h<<10|h>>>22,h=d,d=b,b=g+e[t+I[n]]|0,b=16>n?b+((m^(v|~y))+w[0]):32>n?b+((m&y|v&~y)+w[1]):48>n?b+(((m|~v)^y)+w[2]):64>n?b+((m&v|~m&y)+w[3]):b+((m^v^y)+w[4]),b=(b=(b|=0)<<A[n]|b>>>32-A[n])+S|0,g=S,S=y,y=v<<10|v>>>22,v=m,m=b;b=E[1]+h+y|0,E[1]=E[2]+p+S|0,E[2]=E[3]+f+g|0,E[3]=E[4]+c+m|0,E[4]=E[0]+d+v|0,E[0]=b},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;for(t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process(),t=(e=this._hash).words,n=0;5>n;n++)i=t[n],t[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return e},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),e.RIPEMD160=n._createHelper(i),e.HmacRIPEMD160=n._createHmacHelper(i)}(Math),function(){var e=g,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var i=e.blockSize,r=4*i;n.sigBytes>r&&(n=e.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),s=this._iKey=n.clone(),a=o.words,u=s.words,l=0;l<i;l++)a[l]^=1549556828,u[l]^=909522486;o.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e,t=g,n=(e=t.lib).Base,i=e.WordArray,r=(e=t.algo).HMAC,o=e.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:e.SHA1,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){var n=this.cfg,o=r.create(n.hasher,e),s=i.create(),a=i.create([1]),u=s.words,l=a.words,c=n.keySize;for(n=n.iterations;u.length<c;){var d=o.update(t).finalize(a);o.reset();for(var h=d.words,p=h.length,f=d,g=1;g<n;g++){f=o.finalize(f),o.reset();for(var m=f.words,v=0;v<p;v++)h[v]^=m[v]}s.concat(d),l[0]++}return s.sigBytes=4*c,s}});t.PBKDF2=function(e,t,n){return o.create(n).compute(e,t)}}();var m,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y="=";function S(e){var t,n,i="";for(t=0;t+3<=e.length;t+=3)n=parseInt(e.substring(t,t+3),16),i+=v.charAt(n>>6)+v.charAt(63&n);if(t+1==e.length?(n=parseInt(e.substring(t,t+1),16),i+=v.charAt(n<<2)):t+2==e.length&&(n=parseInt(e.substring(t,t+2),16),i+=v.charAt(n>>2)+v.charAt((3&n)<<4)),y)for(;(3&i.length)>0;)i+=y;return i}function b(e){var t,n,i,r="",o=0;for(t=0;t<e.length&&e.charAt(t)!=y;++t)(i=v.indexOf(e.charAt(t)))<0||(0==o?(r+=T(i>>2),n=3&i,o=1):1==o?(r+=T(n<<2|i>>4),n=15&i,o=2):2==o?(r+=T(n),r+=T(i>>2),n=3&i,o=3):(r+=T(n<<2|i>>4),r+=T(15&i),o=0));return 1==o&&(r+=T(n<<2)),r}function E(e,t,n){null!=e&&("number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function w(){return new E(null)}"Microsoft Internet Explorer"==p.appName?(E.prototype.am=function(e,t,n,i,r,o){for(var s=32767&t,a=t>>15;--o>=0;){var u=32767&this[e],l=this[e++]>>15,c=a*u+l*s;r=((u=s*u+((32767&c)<<15)+n[i]+(1073741823&r))>>>30)+(c>>>15)+a*l+(r>>>30),n[i++]=1073741823&u}return r},m=30):"Netscape"!=p.appName?(E.prototype.am=function(e,t,n,i,r,o){for(;--o>=0;){var s=t*this[e++]+n[i]+r;r=Math.floor(s/67108864),n[i++]=67108863&s}return r},m=26):(E.prototype.am=function(e,t,n,i,r,o){for(var s=16383&t,a=t>>14;--o>=0;){var u=16383&this[e],l=this[e++]>>14,c=a*u+l*s;r=((u=s*u+((16383&c)<<14)+n[i]+r)>>28)+(c>>14)+a*l,n[i++]=268435455&u}return r},m=28),E.prototype.DB=m,E.prototype.DM=(1<<m)-1,E.prototype.DV=1<<m,E.prototype.FV=Math.pow(2,52),E.prototype.F1=52-m,E.prototype.F2=2*m-52;var _,I,C="0123456789abcdefghijklmnopqrstuvwxyz",A=new Array;for(_="0".charCodeAt(0),I=0;I<=9;++I)A[_++]=I;for(_="a".charCodeAt(0),I=10;I<36;++I)A[_++]=I;for(_="A".charCodeAt(0),I=10;I<36;++I)A[_++]=I;function T(e){return C.charAt(e)}function R(e,t){var n=A[e.charCodeAt(t)];return null==n?-1:n}function O(e){var t=w();return t.fromInt(e),t}function P(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function D(e){this.m=e}function k(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function x(e,t){return e&t}function N(e,t){return e|t}function M(e,t){return e^t}function F(e,t){return e&~t}function L(e){if(0==e)return-1;var t=0;return 65535&e||(e>>=16,t+=16),255&e||(e>>=8,t+=8),15&e||(e>>=4,t+=4),3&e||(e>>=2,t+=2),1&e||++t,t}function V(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function j(){}function B(e){return e}function U(e){this.r2=w(),this.q3=w(),E.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}D.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},D.prototype.revert=function(e){return e},D.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},D.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},D.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},k.prototype.convert=function(e){var t=w();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(E.ZERO)>0&&this.m.subTo(t,t),t},k.prototype.revert=function(e){var t=w();return e.copyTo(t),this.reduce(t),t},k.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e[t],i=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[n=t+this.m.t]+=this.m.am(0,i,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},k.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},k.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},E.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},E.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},E.prototype.fromString=function(e,t){var n;if(16==t)n=4;else if(8==t)n=3;else if(256==t)n=8;else if(2==t)n=1;else if(32==t)n=5;else{if(4!=t)return void this.fromRadix(e,t);n=2}this.t=0,this.s=0;for(var i=e.length,r=!1,o=0;--i>=0;){var s=8==n?255&e[i]:R(e,i);s<0?"-"==e.charAt(i)&&(r=!0):(r=!1,0==o?this[this.t++]=s:o+n>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,(o+=n)>=this.DB&&(o-=this.DB))}8==n&&128&e[0]&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),r&&E.ZERO.subTo(this,this)},E.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},E.prototype.dlShiftTo=function(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s},E.prototype.drShiftTo=function(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s},E.prototype.lShiftTo=function(e,t){var n,i=e%this.DB,r=this.DB-i,o=(1<<r)-1,s=Math.floor(e/this.DB),a=this.s<<i&this.DM;for(n=this.t-1;n>=0;--n)t[n+s+1]=this[n]>>r|a,a=(this[n]&o)<<i;for(n=s-1;n>=0;--n)t[n]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},E.prototype.rShiftTo=function(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)t.t=0;else{var i=e%this.DB,r=this.DB-i,o=(1<<i)-1;t[0]=this[n]>>i;for(var s=n+1;s<this.t;++s)t[s-n-1]|=(this[s]&o)<<r,t[s-n]=this[s]>>i;i>0&&(t[this.t-n-1]|=(this.s&o)<<r),t.t=this.t-n,t.clamp()}},E.prototype.subTo=function(e,t){for(var n=0,i=0,r=Math.min(e.t,this.t);n<r;)i+=this[n]-e[n],t[n++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i-=e.s;n<this.t;)i+=this[n],t[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<e.t;)i-=e[n],t[n++]=i&this.DM,i>>=this.DB;i-=e.s}t.s=i<0?-1:0,i<-1?t[n++]=this.DV+i:i>0&&(t[n++]=i),t.t=n,t.clamp()},E.prototype.multiplyTo=function(e,t){var n=this.abs(),i=e.abs(),r=n.t;for(t.t=r+i.t;--r>=0;)t[r]=0;for(r=0;r<i.t;++r)t[r+n.t]=n.am(0,i[r],t,r,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&E.ZERO.subTo(t,t)},E.prototype.squareTo=function(e){for(var t=this.abs(),n=e.t=2*t.t;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){var i=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,i,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()},E.prototype.divRemTo=function(e,t,n){var i=e.abs();if(!(i.t<=0)){var r=this.abs();if(r.t<i.t)return null!=t&&t.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=w());var o=w(),s=this.s,a=e.s,u=this.DB-P(i[i.t-1]);u>0?(i.lShiftTo(u,o),r.lShiftTo(u,n)):(i.copyTo(o),r.copyTo(n));var l=o.t,c=o[l-1];if(0!=c){var d=c*(1<<this.F1)+(l>1?o[l-2]>>this.F2:0),h=this.FV/d,p=(1<<this.F1)/d,f=1<<this.F2,g=n.t,m=g-l,v=null==t?w():t;for(o.dlShiftTo(m,v),n.compareTo(v)>=0&&(n[n.t++]=1,n.subTo(v,n)),E.ONE.dlShiftTo(l,v),v.subTo(o,o);o.t<l;)o[o.t++]=0;for(;--m>=0;){var y=n[--g]==c?this.DM:Math.floor(n[g]*h+(n[g-1]+f)*p);if((n[g]+=o.am(0,y,n,m,0,l))<y)for(o.dlShiftTo(m,v),n.subTo(v,n);n[g]<--y;)n.subTo(v,n)}null!=t&&(n.drShiftTo(l,t),s!=a&&E.ZERO.subTo(t,t)),n.t=l,n.clamp(),u>0&&n.rShiftTo(u,n),s<0&&E.ZERO.subTo(n,n)}}},E.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(!(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},E.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},E.prototype.exp=function(e,t){if(e>4294967295||e<1)return E.ONE;var n=w(),i=w(),r=t.convert(this),o=P(e)-1;for(r.copyTo(n);--o>=0;)if(t.sqrTo(n,i),(e&1<<o)>0)t.mulTo(i,r,n);else{var s=n;n=i,i=s}return t.revert(n)},E.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,i=(1<<t)-1,r=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(n=this[s]>>a)>0&&(r=!0,o=T(n));s>=0;)a<t?(n=(this[s]&(1<<a)-1)<<t-a,n|=this[--s]>>(a+=this.DB-t)):(n=this[s]>>(a-=t)&i,a<=0&&(a+=this.DB,--s)),n>0&&(r=!0),r&&(o+=T(n));return r?o:"0"},E.prototype.negate=function(){var e=w();return E.ZERO.subTo(this,e),e},E.prototype.abs=function(){return this.s<0?this.negate():this},E.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(0!=(t=n-e.t))return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0},E.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+P(this[this.t-1]^this.s&this.DM)},E.prototype.mod=function(e){var t=w();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(E.ZERO)>0&&e.subTo(t,t),t},E.prototype.modPowInt=function(e,t){var n;return n=e<256||t.isEven()?new D(t):new k(t),this.exp(e,n)},E.ZERO=O(0),E.ONE=O(1),j.prototype.convert=B,j.prototype.revert=B,j.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n)},j.prototype.sqrTo=function(e,t){e.squareTo(t)},U.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=w();return e.copyTo(t),this.reduce(t),t},U.prototype.revert=function(e){return e},U.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},U.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},U.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var H=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],q=(1<<26)/H[H.length-1];function K(){this.i=0,this.j=0,this.S=new Array}E.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},E.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),i=O(n),r=w(),o=w(),s="";for(this.divRemTo(i,r,o);r.signum()>0;)s=(n+o.intValue()).toString(e).substr(1)+s,r.divRemTo(i,r,o);return o.intValue().toString(e)+s},E.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var n=this.chunkSize(t),i=Math.pow(t,n),r=!1,o=0,s=0,a=0;a<e.length;++a){var u=R(e,a);u<0?"-"==e.charAt(a)&&0==this.signum()&&(r=!0):(s=t*s+u,++o>=n&&(this.dMultiply(i),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(s,0)),r&&E.ZERO.subTo(this,this)},E.prototype.fromNumber=function(e,t,n){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(E.ONE.shiftLeft(e-1),N,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(E.ONE.shiftLeft(e-1),this);else{var i=new Array,r=7&e;i.length=1+(e>>3),t.nextBytes(i),r>0?i[0]&=(1<<r)-1:i[0]=0,this.fromString(i,256)}},E.prototype.bitwiseTo=function(e,t,n){var i,r,o=Math.min(e.t,this.t);for(i=0;i<o;++i)n[i]=t(this[i],e[i]);if(e.t<this.t){for(r=e.s&this.DM,i=o;i<this.t;++i)n[i]=t(this[i],r);n.t=this.t}else{for(r=this.s&this.DM,i=o;i<e.t;++i)n[i]=t(r,e[i]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()},E.prototype.changeBit=function(e,t){var n=E.ONE.shiftLeft(e);return this.bitwiseTo(n,t,n),n},E.prototype.addTo=function(e,t){for(var n=0,i=0,r=Math.min(e.t,this.t);n<r;)i+=this[n]+e[n],t[n++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i+=e.s;n<this.t;)i+=this[n],t[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<e.t;)i+=e[n],t[n++]=i&this.DM,i>>=this.DB;i+=e.s}t.s=i<0?-1:0,i>0?t[n++]=i:i<-1&&(t[n++]=this.DV+i),t.t=n,t.clamp()},E.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},E.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},E.prototype.multiplyLowerTo=function(e,t,n){var i,r=Math.min(this.t+e.t,t);for(n.s=0,n.t=r;r>0;)n[--r]=0;for(i=n.t-this.t;r<i;++r)n[r+this.t]=this.am(0,e[r],n,r,0,this.t);for(i=Math.min(e.t,t);r<i;++r)this.am(0,e[r],n,r,0,t-r);n.clamp()},E.prototype.multiplyUpperTo=function(e,t,n){--t;var i=n.t=this.t+e.t-t;for(n.s=0;--i>=0;)n[i]=0;for(i=Math.max(t-this.t,0);i<e.t;++i)n[this.t+i-t]=this.am(t-i,e[i],n,0,0,this.t+i-t);n.clamp(),n.drShiftTo(1,n)},E.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(0==t)n=this[0]%e;else for(var i=this.t-1;i>=0;--i)n=(t*n+this[i])%e;return n},E.prototype.millerRabin=function(e){var t=this.subtract(E.ONE),n=t.getLowestSetBit();if(n<=0)return!1;var i=t.shiftRight(n);(e=e+1>>1)>H.length&&(e=H.length);for(var r=w(),o=0;o<e;++o){r.fromInt(H[Math.floor(Math.random()*H.length)]);var s=r.modPow(i,this);if(0!=s.compareTo(E.ONE)&&0!=s.compareTo(t)){for(var a=1;a++<n&&0!=s.compareTo(t);)if(0==(s=s.modPowInt(2,this)).compareTo(E.ONE))return!1;if(0!=s.compareTo(t))return!1}}return!0},E.prototype.clone=function(){var e=w();return this.copyTo(e),e},E.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},E.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},E.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},E.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},E.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var n,i=this.DB-e*this.DB%8,r=0;if(e-- >0)for(i<this.DB&&(n=this[e]>>i)!=(this.s&this.DM)>>i&&(t[r++]=n|this.s<<this.DB-i);e>=0;)i<8?(n=(this[e]&(1<<i)-1)<<8-i,n|=this[--e]>>(i+=this.DB-8)):(n=this[e]>>(i-=8)&255,i<=0&&(i+=this.DB,--e)),128&n&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(t[r++]=n);return t},E.prototype.equals=function(e){return 0==this.compareTo(e)},E.prototype.min=function(e){return this.compareTo(e)<0?this:e},E.prototype.max=function(e){return this.compareTo(e)>0?this:e},E.prototype.and=function(e){var t=w();return this.bitwiseTo(e,x,t),t},E.prototype.or=function(e){var t=w();return this.bitwiseTo(e,N,t),t},E.prototype.xor=function(e){var t=w();return this.bitwiseTo(e,M,t),t},E.prototype.andNot=function(e){var t=w();return this.bitwiseTo(e,F,t),t},E.prototype.not=function(){for(var e=w(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},E.prototype.shiftLeft=function(e){var t=w();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},E.prototype.shiftRight=function(e){var t=w();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},E.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+L(this[e]);return this.s<0?this.t*this.DB:-1},E.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=V(this[n]^t);return e},E.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:!!(this[t]&1<<e%this.DB)},E.prototype.setBit=function(e){return this.changeBit(e,N)},E.prototype.clearBit=function(e){return this.changeBit(e,F)},E.prototype.flipBit=function(e){return this.changeBit(e,M)},E.prototype.add=function(e){var t=w();return this.addTo(e,t),t},E.prototype.subtract=function(e){var t=w();return this.subTo(e,t),t},E.prototype.multiply=function(e){var t=w();return this.multiplyTo(e,t),t},E.prototype.divide=function(e){var t=w();return this.divRemTo(e,t,null),t},E.prototype.remainder=function(e){var t=w();return this.divRemTo(e,null,t),t},E.prototype.divideAndRemainder=function(e){var t=w(),n=w();return this.divRemTo(e,t,n),new Array(t,n)},E.prototype.modPow=function(e,t){var n,i,r=e.bitLength(),o=O(1);if(r<=0)return o;n=r<18?1:r<48?3:r<144?4:r<768?5:6,i=r<8?new D(t):t.isEven()?new U(t):new k(t);var s=new Array,a=3,u=n-1,l=(1<<n)-1;if(s[1]=i.convert(this),n>1){var c=w();for(i.sqrTo(s[1],c);a<=l;)s[a]=w(),i.mulTo(c,s[a-2],s[a]),a+=2}var d,h,p=e.t-1,f=!0,g=w();for(r=P(e[p])-1;p>=0;){for(r>=u?d=e[p]>>r-u&l:(d=(e[p]&(1<<r+1)-1)<<u-r,p>0&&(d|=e[p-1]>>this.DB+r-u)),a=n;!(1&d);)d>>=1,--a;if((r-=a)<0&&(r+=this.DB,--p),f)s[d].copyTo(o),f=!1;else{for(;a>1;)i.sqrTo(o,g),i.sqrTo(g,o),a-=2;a>0?i.sqrTo(o,g):(h=o,o=g,g=h),i.mulTo(g,s[d],o)}for(;p>=0&&!(e[p]&1<<r);)i.sqrTo(o,g),h=o,o=g,g=h,--r<0&&(r=this.DB-1,--p)}return i.revert(o)},E.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return E.ZERO;for(var n=e.clone(),i=this.clone(),r=O(1),o=O(0),s=O(0),a=O(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),t?(r.isEven()&&o.isEven()||(r.addTo(this,r),o.subTo(e,o)),r.rShiftTo(1,r)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),t?(s.isEven()&&a.isEven()||(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);n.compareTo(i)>=0?(n.subTo(i,n),t&&r.subTo(s,r),o.subTo(a,o)):(i.subTo(n,i),t&&s.subTo(r,s),a.subTo(o,a))}return 0!=i.compareTo(E.ONE)?E.ZERO:a.compareTo(e)>=0?a.subtract(e):a.signum()<0?(a.addTo(e,a),a.signum()<0?a.add(e):a):a},E.prototype.pow=function(e){return this.exp(e,new j)},E.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var i=t;t=n,n=i}var r=t.getLowestSetBit(),o=n.getLowestSetBit();if(o<0)return t;for(r<o&&(o=r),o>0&&(t.rShiftTo(o,t),n.rShiftTo(o,n));t.signum()>0;)(r=t.getLowestSetBit())>0&&t.rShiftTo(r,t),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return o>0&&n.lShiftTo(o,n),n},E.prototype.isProbablePrime=function(e){var t,n=this.abs();if(1==n.t&&n[0]<=H[H.length-1]){for(t=0;t<H.length;++t)if(n[0]==H[t])return!0;return!1}if(n.isEven())return!1;for(t=1;t<H.length;){for(var i=H[t],r=t+1;r<H.length&&i<q;)i*=H[r++];for(i=n.modInt(i);t<r;)if(i%H[t++]==0)return!1}return n.millerRabin(e)},E.prototype.square=function(){var e=w();return this.squareTo(e),e},K.prototype.init=function(e){var t,n,i;for(t=0;t<256;++t)this.S[t]=t;for(n=0,t=0;t<256;++t)n=n+this.S[t]+e[t%e.length]&255,i=this.S[t],this.S[t]=this.S[n],this.S[n]=i;this.i=0,this.j=0},K.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var $,W,G,z=256;function J(){!function(e){W[G++]^=255&e,W[G++]^=e>>8&255,W[G++]^=e>>16&255,W[G++]^=e>>24&255,G>=z&&(G-=z)}((new Date).getTime())}if(null==W){var Q;if(W=new Array,G=0,void 0!==f&&(void 0!==f.crypto||void 0!==f.msCrypto)){var Y=f.crypto||f.msCrypto;if(Y.getRandomValues){var Z=new Uint8Array(32);for(Y.getRandomValues(Z),Q=0;Q<32;++Q)W[G++]=Z[Q]}else if("Netscape"==p.appName&&p.appVersion<"5"){var X=f.crypto.random(32);for(Q=0;Q<X.length;++Q)W[G++]=255&X.charCodeAt(Q)}}for(;G<z;)Q=Math.floor(65536*Math.random()),W[G++]=Q>>>8,W[G++]=255&Q;G=0,J()}function ee(){if(null==$){for(J(),($=new K).init(W),G=0;G<W.length;++G)W[G]=0;G=0}return $.next()}function te(){}function ne(e,t){return new E(e,t)}function ie(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function re(e,t){this.x=t,this.q=e}function oe(e,t,n,i){this.curve=e,this.x=t,this.y=n,this.z=null==i?E.ONE:i,this.zinv=null}function se(e,t,n){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(n),this.infinity=new oe(this,null,null)}te.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=ee()},ie.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},ie.prototype.setPublic=function(e,t){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof e)this.n=e,this.e=t;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA public key";this.n=ne(e,16),this.e=parseInt(t,16)}},ie.prototype.type="RSA",ie.prototype.doPrivate=function(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),n=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(n)<0;)t=t.add(this.p);return t.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},ie.prototype.setPrivate=function(e,t,n){if(this.isPrivate=!0,"string"!=typeof e)this.n=e,this.e=t,this.d=n;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA private key";this.n=ne(e,16),this.e=parseInt(t,16),this.d=ne(n,16)}},ie.prototype.setPrivateEx=function(e,t,n,i,r,o,s,a){if(this.isPrivate=!0,this.isPublic=!1,null==e)throw"RSASetPrivateEx N == null";if(null==t)throw"RSASetPrivateEx E == null";if(0==e.length)throw"RSASetPrivateEx N.length == 0";if(0==t.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=ne(e,16),this.e=parseInt(t,16),this.d=ne(n,16),this.p=ne(i,16),this.q=ne(r,16),this.dmp1=ne(o,16),this.dmq1=ne(s,16),this.coeff=ne(a,16)},ie.prototype.generate=function(e,t){var n=new te,i=e>>1;this.e=parseInt(t,16);for(var r=new E(t,16),o=e/2-100,s=E.ONE.shiftLeft(o);;){for(;this.p=new E(e-i,1,n),0!=this.p.subtract(E.ONE).gcd(r).compareTo(E.ONE)||!this.p.isProbablePrime(10););for(;this.q=new E(i,1,n),0!=this.q.subtract(E.ONE).gcd(r).compareTo(E.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var a=this.p;this.p=this.q,this.q=a}var u=this.q.subtract(this.p).abs();if(!(u.bitLength()<o||u.compareTo(s)<=0)){var l=this.p.subtract(E.ONE),c=this.q.subtract(E.ONE),d=l.multiply(c);if(0==d.gcd(r).compareTo(E.ONE)&&(this.n=this.p.multiply(this.q),this.n.bitLength()==e)){this.d=r.modInverse(d),this.dmp1=this.d.mod(l),this.dmq1=this.d.mod(c),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0},re.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)},re.prototype.toBigInteger=function(){return this.x},re.prototype.negate=function(){return new re(this.q,this.x.negate().mod(this.q))},re.prototype.add=function(e){return new re(this.q,this.x.add(e.toBigInteger()).mod(this.q))},re.prototype.subtract=function(e){return new re(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},re.prototype.multiply=function(e){return new re(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},re.prototype.square=function(){return new re(this.q,this.x.square().mod(this.q))},re.prototype.divide=function(e){return new re(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},re.prototype.sqrt=function(){return new re(this.q,this.x.sqrt().mod(this.q))},oe.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},oe.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},oe.prototype.equals=function(e){return e==this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(E.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(E.ZERO))},oe.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(E.ZERO)&&!this.y.toBigInteger().equals(E.ZERO)},oe.prototype.negate=function(){return new oe(this.curve,this.x,this.y.negate(),this.z)},oe.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),n=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(E.ZERO.equals(n))return E.ZERO.equals(t)?this.twice():this.curve.getInfinity();var i=new E("3"),r=this.x.toBigInteger(),o=this.y.toBigInteger(),s=(e.x.toBigInteger(),e.y.toBigInteger(),n.square()),a=s.multiply(n),u=r.multiply(s),l=t.square().multiply(this.z),c=l.subtract(u.shiftLeft(1)).multiply(e.z).subtract(a).multiply(n).mod(this.curve.q),d=u.multiply(i).multiply(t).subtract(o.multiply(a)).subtract(l.multiply(t)).multiply(e.z).add(t.multiply(a)).mod(this.curve.q),h=a.multiply(this.z).multiply(e.z).mod(this.curve.q);return new oe(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(d),h)},oe.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new E("3"),t=this.x.toBigInteger(),n=this.y.toBigInteger(),i=n.multiply(this.z),r=i.multiply(n).mod(this.curve.q),o=this.curve.a.toBigInteger(),s=t.square().multiply(e);E.ZERO.equals(o)||(s=s.add(this.z.square().multiply(o)));var a=(s=s.mod(this.curve.q)).square().subtract(t.shiftLeft(3).multiply(r)).shiftLeft(1).multiply(i).mod(this.curve.q),u=s.multiply(e).multiply(t).subtract(r.shiftLeft(1)).shiftLeft(2).multiply(r).subtract(s.square().multiply(s)).mod(this.curve.q),l=i.square().multiply(i).shiftLeft(3).mod(this.curve.q);return new oe(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(u),l)},oe.prototype.multiply=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,n=e,i=n.multiply(new E("3")),r=this.negate(),o=this,s=this.curve.q.subtract(e),a=s.multiply(new E("3")),u=new oe(this.curve,this.x,this.y),l=u.negate();for(t=i.bitLength()-2;t>0;--t){o=o.twice();var c=i.testBit(t);c!=n.testBit(t)&&(o=o.add(c?this:r))}for(t=a.bitLength()-2;t>0;--t){u=u.twice();var d=a.testBit(t);d!=s.testBit(t)&&(u=u.add(d?u:l))}return o},oe.prototype.multiplyTwo=function(e,t,n){var i;i=e.bitLength()>n.bitLength()?e.bitLength()-1:n.bitLength()-1;for(var r=this.curve.getInfinity(),o=this.add(t);i>=0;)r=r.twice(),e.testBit(i)?r=n.testBit(i)?r.add(o):r.add(this):n.testBit(i)&&(r=r.add(t)),--i;return r},se.prototype.getQ=function(){return this.q},se.prototype.getA=function(){return this.a},se.prototype.getB=function(){return this.b},se.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)},se.prototype.getInfinity=function(){return this.infinity},se.prototype.fromBigInteger=function(e){return new re(this.q,e)},se.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var t=e.substr(0,2),n=(e.substr(2),this.fromBigInteger(new E(a,16))),i=this.getA(),r=this.getB(),o=n.square().add(i).multiply(n).add(r).sqrt();return"03"==t&&(o=o.negate()),new oe(this,n,o);case 4:case 6:case 7:var s=(e.length-2)/2,a=e.substr(2,s),u=e.substr(s+2,s);return new oe(this,this.fromBigInteger(new E(a,16)),this.fromBigInteger(new E(u,16)));default:return null}},re.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},oe.prototype.getEncoded=function(e){var t=function(e,t){var n=e.toByteArrayUnsigned();if(t<n.length)n=n.slice(n.length-t);else for(;t>n.length;)n.unshift(0);return n},n=this.getX().toBigInteger(),i=this.getY().toBigInteger(),r=t(n,32);return e?i.isEven()?r.unshift(2):r.unshift(3):(r.unshift(4),r=r.concat(t(i,32))),r},oe.decodeFrom=function(e,t){t[0];var n=t.length-1,i=t.slice(1,1+n/2),r=t.slice(1+n/2,1+n);i.unshift(0),r.unshift(0);var o=new E(i),s=new E(r);return new oe(e,e.fromBigInteger(o),e.fromBigInteger(s))},oe.decodeFromHex=function(e,t){t.substr(0,2);var n=t.length-2,i=t.substr(2,n/2),r=t.substr(2+n/2,n/2),o=new E(i,16),s=new E(r,16);return new oe(e,e.fromBigInteger(o),e.fromBigInteger(s))},oe.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),n=e.y.subtract(this.y).divide(t),i=n.square().subtract(this.x).subtract(e.x),r=n.multiply(this.x.subtract(i)).subtract(this.y);return new oe(this.curve,i,r)},oe.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(E.valueOf(2)),t=this.curve.fromBigInteger(E.valueOf(3)),n=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),i=n.square().subtract(this.x.multiply(e)),r=n.multiply(this.x.subtract(i)).subtract(this.y);return new oe(this.curve,i,r)},oe.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,n=e,i=n.multiply(new E("3")),r=this.negate(),o=this;for(t=i.bitLength()-2;t>0;--t){o=o.twice();var s=i.testBit(t);s!=n.testBit(t)&&(o=o.add2D(s?this:r))}return o},oe.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),n=this.curve.getA().toBigInteger(),i=this.curve.getB().toBigInteger(),r=this.curve.getQ(),o=t.multiply(t).mod(r),s=e.multiply(e).multiply(e).add(n.multiply(e)).add(i).mod(r);return o.equals(s)},oe.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},oe.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),n=this.getY().toBigInteger();if(t.compareTo(E.ONE)<0||t.compareTo(e.subtract(E.ONE))>0)throw new Error("x coordinate out of bounds");if(n.compareTo(E.ONE)<0||n.compareTo(e.subtract(E.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var ae=function(){var e=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),t=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function i(e,t,i){return t?n[t]:String.fromCharCode(parseInt(i,16))}var r=new String(""),o=Object.hasOwnProperty;return function(n,s){var a,u,l=n.match(e),c=l[0],d=!1;"{"===c?a={}:"["===c?a=[]:(a=[],d=!0);for(var h=[a],p=1-d,f=l.length;p<f;++p){var g;switch((c=l[p]).charCodeAt(0)){default:(g=h[0])[u||g.length]=+c,u=void 0;break;case 34:if(-1!==(c=c.substring(1,c.length-1)).indexOf("\\")&&(c=c.replace(t,i)),g=h[0],!u){if(!(g instanceof Array)){u=c||r;break}u=g.length}g[u]=c,u=void 0;break;case 91:g=h[0],h.unshift(g[u||g.length]=[]),u=void 0;break;case 93:case 125:h.shift();break;case 102:(g=h[0])[u||g.length]=!1,u=void 0;break;case 110:(g=h[0])[u||g.length]=null,u=void 0;break;case 116:(g=h[0])[u||g.length]=!0,u=void 0;break;case 123:g=h[0],h.unshift(g[u||g.length]={}),u=void 0}}if(d){if(1!==h.length)throw new Error;a=a[0]}else if(h.length)throw new Error;if(s){var m=function(e,t){var n=e[t];if(n&&"object"==typeof n){var i=null;for(var r in n)if(o.call(n,r)&&n!==e){var a=m(n,r);void 0!==a?n[r]=a:(i||(i=[]),i.push(r))}if(i)for(var u=i.length;--u>=0;)delete n[i[u]]}return s.call(e,t,n)};a=m({"":a},"")}return a}}();void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),ue.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){return Ue(e)},this.getPEMStringFromHex=function(e,t){return _e(e,t)},this.newObject=function(e){var t=ue.asn1,n=t.ASN1Object,i=t.DERBoolean,r=t.DERInteger,o=t.DERBitString,s=t.DEROctetString,a=t.DERNull,u=t.DERObjectIdentifier,l=t.DEREnumerated,c=t.DERUTF8String,d=t.DERNumericString,h=t.DERPrintableString,p=t.DERTeletexString,f=t.DERIA5String,g=t.DERUTCTime,m=t.DERGeneralizedTime,v=t.DERVisibleString,y=t.DERBMPString,S=t.DERSequence,b=t.DERSet,E=t.DERTaggedObject,w=t.ASN1Util.newObject;if(e instanceof t.ASN1Object)return e;var _=Object.keys(e);if(1!=_.length)throw new Error("key of param shall be only one.");var I=_[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+I+":"))throw new Error("undefined key: "+I);if("bool"==I)return new i(e[I]);if("int"==I)return new r(e[I]);if("bitstr"==I)return new o(e[I]);if("octstr"==I)return new s(e[I]);if("null"==I)return new a(e[I]);if("oid"==I)return new u(e[I]);if("enum"==I)return new l(e[I]);if("utf8str"==I)return new c(e[I]);if("numstr"==I)return new d(e[I]);if("prnstr"==I)return new h(e[I]);if("telstr"==I)return new p(e[I]);if("ia5str"==I)return new f(e[I]);if("utctime"==I)return new g(e[I]);if("gentime"==I)return new m(e[I]);if("visstr"==I)return new v(e[I]);if("bmpstr"==I)return new y(e[I]);if("asn1"==I)return new n(e[I]);if("seq"==I){for(var C=e[I],A=[],T=0;T<C.length;T++){var R=w(C[T]);A.push(R)}return new S({array:A})}if("set"==I){for(C=e[I],A=[],T=0;T<C.length;T++)R=w(C[T]),A.push(R);return new b({array:A})}if("tag"==I){var O=e[I];if("[object Array]"===Object.prototype.toString.call(O)&&3==O.length){var P=w(O[2]);return new E({tag:O[0],explicit:O[1],obj:P})}return new E(O)}},this.jsonToASN1HEX=function(e){return this.newObject(e).tohex()}},ue.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",n=parseInt(e.substr(0,2),16),i=(t=Math.floor(n/40)+"."+n%40,""),r=2;r<e.length;r+=2){var o=("00000000"+parseInt(e.substr(r,2),16).toString(2)).slice(-8);i+=o.substr(1,7),"0"==o.substr(0,1)&&(t=t+"."+new E(i,2).toString(10),i="")}return t},ue.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},n=function(e){var n="",i=new E(e,10).toString(2),r=7-i.length%7;7==r&&(r=0);for(var o="",s=0;s<r;s++)o+="0";for(i=o+i,s=0;s<i.length-1;s+=7){var a=i.substr(s,7);s!=i.length-7&&(a="1"+a),n+=t(parseInt(a,2))}return n};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var i="",r=e.split("."),o=40*parseInt(r[0])+parseInt(r[1]);i+=t(o),r.splice(0,2);for(var s=0;s<r.length;s++)i+=n(r[s]);return i},ue.asn1.ASN1Object=function(e){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n=0,v="+this.hV);var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var n=t.length/2;if(n>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+e.toString(16));return(128+n).toString(16)+t},this.tohex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(e){this.params=e},null!=e&&null!=e.tlv&&(this.hTLV=e.tlv,this.isModified=!1)},ue.asn1.DERAbstractString=function(e){ue.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=ye(this.s).toLowerCase()},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},$e(ue.asn1.DERAbstractString,ue.asn1.ASN1Object),ue.asn1.DERAbstractTime=function(e){ue.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){var t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t)},this.formatDate=function(e,t,n){var i=this.zeroPadding,r=this.localDateToUTC(e),o=String(r.getFullYear());"utc"==t&&(o=o.substr(2,2));var s=o+i(String(r.getMonth()+1),2)+i(String(r.getDate()),2)+i(String(r.getHours()),2)+i(String(r.getMinutes()),2)+i(String(r.getSeconds()),2);if(!0===n){var a=r.getMilliseconds();if(0!=a){var u=i(String(a),3);s=s+"."+(u=u.replace(/[0]+$/,""))}}return s+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.setByParam=function(e){this.hV=null,this.hTLV=null,this.params=e},this.getString=function(){},this.setString=function(e){this.hTLV=null,this.isModified=!0,null==this.params&&(this.params={}),this.params.str=e},this.setByDate=function(e){this.hTLV=null,this.isModified=!0,null==this.params&&(this.params={}),this.params.date=e},this.setByDateValue=function(e,t,n,i,r,o){var s=new Date(Date.UTC(e,t-1,n,i,r,o,0));this.setByDate(s)},this.getFreshValueHex=function(){return this.hV}},$e(ue.asn1.DERAbstractTime,ue.asn1.ASN1Object),ue.asn1.DERAbstractStructured=function(e){ue.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},$e(ue.asn1.DERAbstractStructured,ue.asn1.ASN1Object),ue.asn1.DERBoolean=function(e){ue.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==e?"010100":"0101ff"},$e(ue.asn1.DERBoolean,ue.asn1.ASN1Object),ue.asn1.DERInteger=function(e){ue.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var t=Ue;this.setByBigInteger=function(e){this.isModified=!0,this.params={bigint:e}},this.setByInteger=function(e){this.isModified=!0,this.params=e},this.setValueHex=function(e){this.isModified=!0,this.params={hex:e}},this.getFreshValueHex=function(){var e=this.params,n=null;if(null==e)throw new Error("value not set");if("object"==typeof e&&null!=e.hex)return this.hV=e.hex,this.hV;if("number"==typeof e)n=new E(String(e),10);else if(null!=e.int)n=new E(String(e.int),10);else{if(null==e.bigint)throw new Error("wrong parameter");n=e.bigint}return this.hV=t(n),this.hV},null!=e&&(this.params=e)},$e(ue.asn1.DERInteger,ue.asn1.ASN1Object),ue.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ue.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.tohex()}ue.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var n="0"+e;this.hTLV=null,this.isModified=!0,this.hV=n+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0),e+="0000000".substr(0,t);for(var n="",i=0;i<e.length-1;i+=8){var r=e.substr(i,8),o=parseInt(r,2).toString(16);1==o.length&&(o="0"+o),n+=o}this.hTLV=null,this.isModified=!0,this.hV="0"+t+n},this.setByBooleanArray=function(e){for(var t="",n=0;n<e.length;n++)1==e[n]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},$e(ue.asn1.DERBitString,ue.asn1.ASN1Object),ue.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ue.asn1.ASN1Util.newObject(e.obj);e.hex=t.tohex()}ue.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},$e(ue.asn1.DEROctetString,ue.asn1.DERAbstractString),ue.asn1.DERNull=function(){ue.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},$e(ue.asn1.DERNull,ue.asn1.ASN1Object),ue.asn1.DERObjectIdentifier=function(e){ue.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){var t=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},n=function(e){var n="",i=parseInt(e,10).toString(2),r=7-i.length%7;7==r&&(r=0);for(var o="",s=0;s<r;s++)o+="0";for(i=o+i,s=0;s<i.length-1;s+=7){var a=i.substr(s,7);s!=i.length-7&&(a="1"+a),n+=t(parseInt(a,2))}return n};try{if(!e.match(/^[0-9.]+$/))return null;var i="",r=e.split("."),o=40*parseInt(r[0],10)+parseInt(r[1],10);i+=t(o),r.splice(0,2);for(var s=0;s<r.length;s++)i+=n(r[s]);return i}catch(e){return null}}(e);if(null==t)throw new Error("malformed oid string: "+e);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){var t=ue.asn1.x509.OID.name2oid(e);if(""===t)throw new Error("DERObjectIdentifier oidName undefined: "+e);this.setValueOidString(t)},this.setValueNameOrOid=function(e){e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){"string"==typeof e?this.setValueNameOrOid(e):void 0!==e.oid?this.setValueNameOrOid(e.oid):void 0!==e.name?this.setValueNameOrOid(e.name):void 0!==e.hex&&this.setValueHex(e.hex)},void 0!==e&&this.setByParam(e)},$e(ue.asn1.DERObjectIdentifier,ue.asn1.ASN1Object),ue.asn1.DEREnumerated=function(e){ue.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=Ue(e)},this.setByInteger=function(e){var t=new E(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},$e(ue.asn1.DEREnumerated,ue.asn1.ASN1Object),ue.asn1.DERUTF8String=function(e){ue.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},$e(ue.asn1.DERUTF8String,ue.asn1.DERAbstractString),ue.asn1.DERNumericString=function(e){ue.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},$e(ue.asn1.DERNumericString,ue.asn1.DERAbstractString),ue.asn1.DERPrintableString=function(e){ue.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},$e(ue.asn1.DERPrintableString,ue.asn1.DERAbstractString),ue.asn1.DERTeletexString=function(e){ue.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},$e(ue.asn1.DERTeletexString,ue.asn1.DERAbstractString),ue.asn1.DERIA5String=function(e){ue.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},$e(ue.asn1.DERIA5String,ue.asn1.DERAbstractString),ue.asn1.DERVisibleString=function(e){ue.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"},$e(ue.asn1.DERVisibleString,ue.asn1.DERAbstractString),ue.asn1.DERBMPString=function(e){ue.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"},$e(ue.asn1.DERBMPString,ue.asn1.DERAbstractString),ue.asn1.DERUTCTime=function(e){ue.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var e=this.params;if(null==this.params&&(e={date:new Date}),"string"==typeof e){if(!e.match(/^[0-9]{12}Z$/)&&!e.match(/^[0-9]{12}\.[0-9]+Z$/))throw new Error("malformed string for UTCTime: "+e);this.hV=pe(e)}else if(null!=e.str)this.hV=pe(e.str);else if(null==e.date&&1==e.millis){var t=new Date;this.hV=pe(this.formatDate(t,"utc",!0))}else if(null!=e.date&&e.date instanceof Date){var n=!0===e.millis;this.hV=pe(this.formatDate(e.date,"utc",n))}else e instanceof Date&&(this.hV=pe(this.formatDate(e,"utc")));if(null==this.hV)throw new Error("parameter not specified properly for UTCTime");return this.hV},null!=e&&this.setByParam(e)},$e(ue.asn1.DERUTCTime,ue.asn1.DERAbstractTime),ue.asn1.DERGeneralizedTime=function(e){ue.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.params=e,this.getFreshValueHex=function(){var e=this.params;if(null==this.params&&(e={date:new Date}),"string"==typeof e){if(!e.match(/^[0-9]{14}Z$/)&&!e.match(/^[0-9]{14}\.[0-9]+Z$/))throw new Error("malformed string for GeneralizedTime: "+e);this.hV=pe(e)}else if(null!=e.str)this.hV=pe(e.str);else if(null==e.date&&1==e.millis){var t=new Date;this.hV=pe(this.formatDate(t,"gen",!0))}else if(null!=e.date&&e.date instanceof Date){var n=!0===e.millis;this.hV=pe(this.formatDate(e.date,"gen",n))}else e instanceof Date&&(this.hV=pe(this.formatDate(e,"gen")));if(null==this.hV)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},null!=e&&this.setByParam(e)},$e(ue.asn1.DERGeneralizedTime,ue.asn1.DERAbstractTime),ue.asn1.DERSequence=function(e){ue.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++)e+=this.asn1Array[t].tohex();return this.hV=e,this.hV}},$e(ue.asn1.DERSequence,ue.asn1.DERAbstractStructured),ue.asn1.DERSet=function(e){ue.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var n=this.asn1Array[t];e.push(n.tohex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},$e(ue.asn1.DERSet,ue.asn1.DERAbstractStructured),ue.asn1.DERTaggedObject=function(e){ue.asn1.DERTaggedObject.superclass.constructor.call(this);var t=ue.asn1,n=de,i=n.getV,r=(n.isASN1HEX,t.ASN1Util.newObject);this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(e,t,n){this.params={tag:t,explicit:e,obj:n}},this.getFreshValueHex=function(){var e=this.params;if(null==e.explicit&&(e.explicit=!0),null!=e.tage&&(e.tag=e.tage,e.explicit=!0),null!=e.tagi&&(e.tag=e.tagi,e.explicit=!1),null!=e.str)this.hV=ye(e.str);else if(null!=e.hex)this.hV=e.hex;else{if(null==e.obj)throw new Error("str, hex nor obj not specified");var n;e.obj instanceof t.ASN1Object?n=e.obj.tohex():"object"==typeof e.obj&&(n=r(e.obj).tohex()),e.explicit?this.hV=n:this.hV=i(n,0)}return null==e.tag&&(e.tag="a0"),this.hT=e.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.DERTaggedObject,ue.asn1.ASN1Object);var ue,le,ce,de=new function(){};function he(e){for(var t="",n=0;n<e.length;n++){var i=e[n].toString(16);1==i.length&&(i="0"+i),t+=i}return t}function pe(e){return he(function(e){for(var t=new Array,n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e))}function fe(e){return(e=(e=e.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function ge(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),(e=e.replace(/-/g,"+")).replace(/_/g,"/")}function me(e){return e.length%2==1&&(e="0"+e),fe(S(e))}function ve(e){return b(ge(e))}function ye(e){return Ae(Me(e)).toLowerCase()}function Se(e){try{return decodeURIComponent(Te(e))}catch(e){return null}}function be(e){return Se(function(e){for(var t=e.match(/.{1,2}/g),n=[],i=0;i<t.length;i++){var r=parseInt(t[i],16);161<=r&&r<=191?(n.push("c2"),n.push(t[i])):192<=r&&r<=255?(n.push("c3"),n.push((r-64).toString(16))):n.push(t[i])}return n.join("")}(e))}function Ee(e){for(var t="",n=0;n<e.length-1;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t}function we(e){for(var t="",n=0;n<e.length;n++)t+=("0"+e.charCodeAt(n).toString(16)).slice(-2);return t}function _e(e,t){return"-----BEGIN "+t+"-----\r\n"+function(e,t){return(e=e.replace(new RegExp("(.{"+t+"})","g"),"$1\r\n")).replace(/\s+$/,"")}(function(e){return S(e)}(e),64)+"\r\n-----END "+t+"-----\r\n"}function Ie(e,t){if(-1==e.indexOf("-----BEGIN "))throw new Error("can't find PEM header");return function(e){return b(e.replace(/[^0-9A-Za-z\/+=]*/g,""))}(e=void 0!==t?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),"")).replace(new RegExp("-----END "+t+"-----[^]*$"),""):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function Ce(e){return Math.round(function(e){var t,n,i,r,o,s,a,u,l,c;if(c=(e=function(e){return e.match(/^[0-9]{12}Z$/)||e.match(/^[0-9]{12}[.][0-9]*Z$/)?e.match(/^[0-4]/)?"20"+e:"19"+e:e}(e)).match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return t=parseInt(c[1]),n=parseInt(c[2])-1,i=parseInt(c[3]),r=parseInt(c[4]),o=parseInt(c[5]),s=parseInt(c[6]),a=0,""!==(u=c[7])&&(l=(u.substr(1)+"00").substr(0,3),a=parseInt(l)),Date.UTC(t,n,i,r,o,s,a);throw new Error("unsupported zulu format: "+e)}(e)/1e3)}function Ae(e){return e.replace(/%/g,"")}function Te(e){return e.replace(/(..)/g,"%$1")}function Re(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;var n=(e=e.toLowerCase()).split(":").length-1;if(n<2)throw t;var i=":".repeat(7-n+2),r=(e=e.replace("::",i)).split(":");if(8!=r.length)throw t;for(var o=0;o<8;o++)r[o]=("0000"+r[o]).slice(-4);return r.join("")}function Oe(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+e);var t=(e=e.toLowerCase()).match(/.{1,4}/g);t=t.map((function(e){return e.replace(/^0+/,"")})),t=t.map((function(e){return""==e?"0":e}));var n=(e=":"+t.join(":")+":").match(/:(0:){2,}/g);if(null==n)return e.slice(1,-1);var i=n.sort().slice(-1)[0];return"::"!=(e=e.replace(i.substr(0,i.length-1),":")).substr(0,2)&&(e=e.substr(1)),"::"!=e.substr(-2,2)&&(e=e.substr(0,e.length-1)),e}function Pe(e){var t=new Error("malformed hex value");if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(8==e.length)try{return parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16)}catch(e){throw t}else{if(16!=e.length){if(32==e.length)return Oe(e);if(64==e.length){try{return Oe(e.substr(0,32))+"/"+De(e.substr(32))}catch(e){throw t}return}return e}try{return Pe(e.substr(0,8))+"/"+De(e.substr(8))}catch(e){throw t}}}function De(e){var t,n=new Error("malformed mask");try{t=new E(e,16).toString(2)}catch(e){throw n}if(!t.match(/^1*0*$/))throw n;return t.replace(/0+$/,"").length}function ke(e){var t=new Error("malformed IP address");if(!(e=e.toLowerCase(e)).match(/^[0-9a-f.:/]+$/))throw t;if(!e.match(/^[0-9.]+$/)){var n;if(e.match(/^[0-9.]+\/[0-9]+$/))return ke((n=e.split("/"))[0])+xe(parseInt(n[1]),32);if(e.match(/^[0-9a-f:]+$/)&&-1!==e.indexOf(":"))return Re(e);if(e.match(/^[0-9a-f:]+\/[0-9]+$/)&&-1!==e.indexOf(":"))return Re((n=e.split("/"))[0])+xe(parseInt(n[1]),128);throw t}var i=e.split(".");if(4!==i.length)throw t;var r="";try{for(var o=0;o<4;o++)r+=("0"+parseInt(i[o]).toString(16)).slice(-2);return r}catch(e){throw t}}function xe(e,t){return 32==t&&0==e?"00000000":128==t&&0==e?"00000000000000000000000000000000":new E(Array(e+1).join("1")+Array(t-e+1).join("0"),2).toString(16)}function Ne(e){var t=e.match(/.{4}/g).map((function(e){var t=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2),16);if(0==t&n<128)return String.fromCharCode(n);if(t<8){var i=128|63&n;return Se((192|(7&t)<<3|(192&n)>>6).toString(16)+i.toString(16))}i=128|(15&t)<<2|(192&n)>>6;var r=128|63&n;return Se((224|(240&t)>>4).toString(16)+i.toString(16)+r.toString(16))}));return t.join("")}function Me(e){for(var t=encodeURIComponent(e),n="",i=0;i<t.length;i++)"%"==t[i]?(n+=t.substr(i,3),i+=2):n=n+"%"+pe(t[i]);return n}function Fe(e){return!(e.length%2!=0||!e.match(/^[0-9a-f]+$/)&&!e.match(/^[0-9A-F]+$/))}function Le(e){return!!e.match(/^[0-9A-Za-z-_.]+$/)}function Ve(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function je(e){if(!Fe(e))return null;try{var t=[],n=e.substr(0,2),i=parseInt(n,16);t[0]=new String(Math.floor(i/40)),t[1]=new String(i%40);for(var r=e.substr(2),o=[],s=0;s<r.length/2;s++)o.push(parseInt(r.substr(2*s,2),16));var a=[],u="";for(s=0;s<o.length;s++)128&o[s]?u+=He((127&o[s]).toString(2),7):(u+=He((127&o[s]).toString(2),7),a.push(new String(parseInt(u,2))),u="");var l=t.join(".");return a.length>0&&(l=l+"."+a.join(".")),l}catch(e){return null}}function Be(e){return Ue(new E(String(e),10))}function Ue(e){var t=e.toString(16);if("-"!=t.substr(0,1))return t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t),t;var n=t.substr(1).length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var i="",r=0;r<n;r++)i+="f";return new E(i,16).xor(e).add(E.ONE).toString(16).replace(/^-/,"")}de.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var n=parseInt(e.substr(t+3,1));return 0==n?-1:0<n&&n<10?n+1:-2},de.getL=function(e,t){var n=de.getLblen(e,t);return n<1?"":e.substr(t+2,2*n)},de.getVblen=function(e,t){var n;return""==(n=de.getL(e,t))?-1:("8"===n.substr(0,1)?new E(n.substr(2),16):new E(n,16)).intValue()},de.getVidx=function(e,t){var n=de.getLblen(e,t);return n<0?n:t+2*(n+1)},de.getV=function(e,t){var n=de.getVidx(e,t),i=de.getVblen(e,t);return e.substr(n,2*i)},de.getTLV=function(e,t){return e.substr(t,2)+de.getL(e,t)+de.getV(e,t)},de.getTLVblen=function(e,t){return 2+2*de.getLblen(e,t)+2*de.getVblen(e,t)},de.getNextSiblingIdx=function(e,t){return de.getVidx(e,t)+2*de.getVblen(e,t)},de.getChildIdx=function(e,t){var n,i,r,o=de,s=[];n=o.getVidx(e,t),i=2*o.getVblen(e,t),"03"==e.substr(t,2)&&(n+=2,i-=2),r=0;for(var a=n;r<=i;){var u=o.getTLVblen(e,a);if((r+=u)<=i&&s.push(a),a+=u,r>=i)break}return s},de.getNthChildIdx=function(e,t,n){return de.getChildIdx(e,t)[n]},de.getIdxbyList=function(e,t,n,i){var r,o,s=de;return 0==n.length?void 0!==i&&e.substr(t,2)!==i?-1:t:(r=n.shift())>=(o=s.getChildIdx(e,t)).length?-1:s.getIdxbyList(e,o[r],n,i)},de.getIdxbyListEx=function(e,t,n,i){var r,o,s=de;if(0==n.length)return void 0!==i&&e.substr(t,2)!==i?-1:t;r=n.shift(),o=s.getChildIdx(e,t);for(var a=0,u=0;u<o.length;u++){var l=e.substr(o[u],2);if("number"==typeof r&&!s.isContextTag(l)&&a==r||"string"==typeof r&&s.isContextTag(l,r))return s.getIdxbyListEx(e,o[u],n,i);s.isContextTag(l)||a++}return-1},de.getTLVbyList=function(e,t,n,i){var r=de,o=r.getIdxbyList(e,t,n,i);return-1==o||o>=e.length?null:r.getTLV(e,o)},de.getTLVbyListEx=function(e,t,n,i){var r=de,o=r.getIdxbyListEx(e,t,n,i);return-1==o?null:r.getTLV(e,o)},de.getVbyList=function(e,t,n,i,r){var o,s,a=de;return-1==(o=a.getIdxbyList(e,t,n,i))||o>=e.length?null:(s=a.getV(e,o),!0===r&&(s=s.substr(2)),s)},de.getVbyListEx=function(e,t,n,i,r){var o,s,a=de;return-1==(o=a.getIdxbyListEx(e,t,n,i))?null:(s=a.getV(e,o),"03"==e.substr(o,2)&&!1!==r&&(s=s.substr(2)),s)},de.getInt=function(e,t,n){null==n&&(n=-1);try{var i=e.substr(t,2);if("02"!=i&&"03"!=i)return n;var r=de.getV(e,t);return"02"==i?parseInt(r,16):function(e){if(e.length%2!=0)return-1;if(null==(e=e.toLowerCase()).match(/^[0-9a-f]+$/))return-1;try{var t=e.substr(0,2);if("00"==t)return parseInt(e.substr(2),16);var n=parseInt(t,16);if(n>7)return-1;var i=e.substr(2),r=parseInt(i,16).toString(2);"0"==r&&(r="00000000"),r=r.slice(0,0-n);var o=parseInt(r,2);return NaN==o?-1:o}catch(e){return-1}}(r)}catch(e){return n}},de.getOID=function(e,t,n){null==n&&(n=null);try{return"06"!=e.substr(t,2)?n:je(de.getV(e,t))}catch(e){return n}},de.getOIDName=function(e,t,n){null==n&&(n=null);try{var i=de.getOID(e,t,n);if(i==n)return n;var r=ue.asn1.x509.OID.oid2name(i);return""==r?i:r}catch(e){return n}},de.getString=function(e,t,n){null==n&&(n=null);try{return Ee(de.getV(e,t))}catch(e){return n}},de.hextooidstr=function(e){var t=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},n=[],i=e.substr(0,2),r=parseInt(i,16);n[0]=new String(Math.floor(r/40)),n[1]=new String(r%40);for(var o=e.substr(2),s=[],a=0;a<o.length/2;a++)s.push(parseInt(o.substr(2*a,2),16));var u=[],l="";for(a=0;a<s.length;a++)128&s[a]?l+=t((127&s[a]).toString(2),7):(l+=t((127&s[a]).toString(2),7),u.push(new String(parseInt(l,2))),l="");var c=n.join(".");return u.length>0&&(c=c+"."+u.join(".")),c},de.dump=function(e,t,n,i){var r=de,o=r.getV,s=r.dump,a=r.getChildIdx,u=e;e instanceof ue.asn1.ASN1Object&&(u=e.tohex());var l=function(e,t){return e.length<=2*t?e:e.substr(0,t)+"..(total "+e.length/2+"bytes).."+e.substr(e.length-t,t)};void 0===t&&(t={ommit_long_octet:32}),void 0===n&&(n=0),void 0===i&&(i="");var c,d=t.ommit_long_octet;if("01"==(c=u.substr(n,2)))return"00"==(h=o(u,n))?i+"BOOLEAN FALSE\n":i+"BOOLEAN TRUE\n";if("02"==c)return i+"INTEGER "+l(h=o(u,n),d)+"\n";if("03"==c){var h=o(u,n);return r.isASN1HEX(h.substr(2))?(E=i+"BITSTRING, encapsulates\n")+s(h.substr(2),t,0,i+"  "):i+"BITSTRING "+l(h,d)+"\n"}if("04"==c)return h=o(u,n),r.isASN1HEX(h)?(E=i+"OCTETSTRING, encapsulates\n")+s(h,t,0,i+"  "):i+"OCTETSTRING "+l(h,d)+"\n";if("05"==c)return i+"NULL\n";if("06"==c){var p=o(u,n),f=ue.asn1.ASN1Util.oidHexToInt(p),g=ue.asn1.x509.OID.oid2name(f),m=f.replace(/\./g," ");return""!=g?i+"ObjectIdentifier "+g+" ("+m+")\n":i+"ObjectIdentifier ("+m+")\n"}if("0a"==c)return i+"ENUMERATED "+parseInt(o(u,n))+"\n";if("0c"==c)return i+"UTF8String '"+Se(o(u,n))+"'\n";if("13"==c)return i+"PrintableString '"+Se(o(u,n))+"'\n";if("14"==c)return i+"TeletexString '"+Se(o(u,n))+"'\n";if("16"==c)return i+"IA5String '"+Se(o(u,n))+"'\n";if("17"==c)return i+"UTCTime "+Se(o(u,n))+"\n";if("18"==c)return i+"GeneralizedTime "+Se(o(u,n))+"\n";if("1a"==c)return i+"VisualString '"+Se(o(u,n))+"'\n";if("1e"==c)return i+"BMPString '"+Ne(o(u,n))+"'\n";if("30"==c){if("3000"==u.substr(n,4))return i+"SEQUENCE {}\n";E=i+"SEQUENCE\n";var v=t;if((2==(b=a(u,n)).length||3==b.length)&&"06"==u.substr(b[0],2)&&"04"==u.substr(b[b.length-1],2)){g=r.oidname(o(u,b[0]));var y=JSON.parse(JSON.stringify(t));y.x509ExtName=g,v=y}for(var S=0;S<b.length;S++)E+=s(u,v,b[S],i+"  ");return E}if("31"==c){E=i+"SET\n";var b=a(u,n);for(S=0;S<b.length;S++)E+=s(u,t,b[S],i+"  ");return E}if(128&(c=parseInt(c,16))){var E,w=31&c;if(32&c){for(E=i+"["+w+"]\n",b=a(u,n),S=0;S<b.length;S++)E+=s(u,t,b[S],i+"  ");return E}return h=o(u,n),de.isASN1HEX(h)?(E=i+"["+w+"]\n")+s(h,t,0,i+"  "):(("68747470"==h.substr(0,8)||"subjectAltName"===t.x509ExtName&&2==w)&&(h=Se(h)),i+"["+w+"] "+h+"\n")}return i+"UNKNOWN("+c+") "+o(u,n)+"\n"},de.parse=function(e){var t=de,n=t.parse,i=t.isASN1HEX,r=t.getV,o=t.getTLV,s=t.getChildIdx,a=ue.asn1,u=a.ASN1Util.oidHexToInt,l=a.x509.OID.oid2name,c=Se,d=Ne,h=be,p={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},f=e.substr(0,2),g={},m=r(e,0);if("01"==f)return"0101ff"==e?{bool:!0}:{bool:!1};if("02"==f)return{int:{hex:m}};if("03"==f)try{if("00"!=m.substr(0,2))throw"not encap";var v=m.substr(2);if(!i(v))throw"not encap";return{bitstr:{obj:n(v)}}}catch(e){var y=null;return m.length<=10&&(y=function(e){if("string"!=typeof e)return null;if(e.length%2!=0)return null;if(!e.match(/^[0-9a-f]+$/))return null;try{var t=parseInt(e.substr(0,2),16);if(t<0||7<t)return null;for(var n=e.substr(2),i="",r=0;r<n.length;r+=2){var o=n.substr(r,2),s=parseInt(o,16).toString(2);i+=s=("0000000"+s).slice(-8)}return i.substr(0,i.length-t)}catch(e){return null}}(m)),null==y?{bitstr:{hex:m}}:{bitstr:{bin:y}}}else if("04"==f)try{if(!i(m))throw"not encap";return{octstr:{obj:n(m)}}}catch(e){return{octstr:{hex:m}}}else{if("05"==f)return{null:""};if("06"==f){var S=u(m),b=l(S);return""==b?{oid:S}:{oid:b}}if("0a"==f)return m.length>4?{enum:{hex:m}}:{enum:parseInt(m,16)};if("30"==f||"31"==f)return g[p[f]]=function(e){for(var t=[],i=s(e,0),r=0;r<i.length;r++){var a=i[r],u=o(e,a),l=n(u);t.push(l)}return t}(e),g;if("14"==f){var E=h(m);return g[p[f]]={str:E},g}if("1e"==f)return E=d(m),g[p[f]]={str:E},g;if(-1!=":0c:12:13:16:17:18:1a:".indexOf(f))return E=c(m),g[p[f]]={str:E},g;if(f.match(/^8[0-9]$/))return null==(E=c(m))|""==E||null!=E.match(/[\x00-\x1F\x7F-\x9F]/)||null!=E.match(/[\u0000-\u001F\u0080\u009F]/)?{tag:{tag:f,explicit:!1,hex:m}}:{tag:{tag:f,explicit:!1,str:E}};if(!f.match(/^a[0-9]$/)){var w=new ue.asn1.ASN1Object;return w.hV=m,{asn1:{tlv:f+w.getLengthHexFromValue()+m}}}try{if(!i(m))throw new Error("not encap");return{tag:{tag:f,explicit:!0,obj:n(m)}}}catch(e){return{tag:{tag:f,explicit:!0,hex:m}}}}},de.isContextTag=function(e,t){var n,i;e=e.toLowerCase();try{n=parseInt(e,16)}catch(e){return-1}if(void 0===t)return 128==(192&n);try{return null!=t.match(/^\[[0-9]+\]$/)&&!((i=parseInt(t.substr(1,t.length-1),10))>31)&&128==(192&n)&&(31&n)==i}catch(e){return!1}},de.isASN1HEX=function(e){var t=de;if(e.length%2==1)return!1;var n=t.getVblen(e,0),i=e.substr(0,2),r=t.getL(e,0);return e.length-i.length-r.length==2*n},de.checkStrictDER=function(e,t,n,i,r){var o=de;if(void 0===n){if("string"!=typeof e)throw new Error("not hex string");if(e=e.toLowerCase(),!ue.lang.String.isHex(e))throw new Error("not hex string");n=e.length,r=(i=e.length/2)<128?1:Math.ceil(i.toString(16))+1}if(o.getL(e,t).length>2*r)throw new Error("L of TLV too long: idx="+t);var s=o.getVblen(e,t);if(s>i)throw new Error("value of L too long than hex: idx="+t);var a=o.getTLV(e,t),u=a.length-2-o.getL(e,t).length;if(u!==2*s)throw new Error("V string length and L's value not the same:"+u+"/"+2*s);if(0===t&&e.length!=a.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+a.length);var l=e.substr(t,2);if("02"===l){var c=o.getVidx(e,t);if("00"==e.substr(c,2)&&e.charCodeAt(c+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(l,16)){for(var d=o.getVblen(e,t),h=0,p=o.getChildIdx(e,t),f=0;f<p.length;f++)h+=o.getTLV(e,p[f]).length,o.checkStrictDER(e,p[f],n,i,r);if(2*d!=h)throw new Error("sum of children's TLV length and L unmatch: "+2*d+"!="+h)}},de.oidname=function(e){var t=ue.asn1;ue.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var n=t.x509.OID.oid2name(e);return""===n&&(n=e),n},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.x509&&ue.asn1.x509||(ue.asn1.x509={}),ue.asn1.x509.Certificate=function(e){ue.asn1.x509.Certificate.superclass.constructor.call(this);var t=ue.asn1,n=t.DERBitString,i=t.DERSequence,r=t.x509,o=r.TBSCertificate,s=r.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(e){this.params=e},this.sign=function(){var e=this.params,t=e.sigalg;null!=e.sigalg.name&&(t=e.sigalg.name);var n=e.tbsobj.tohex(),i=new ue.crypto.Signature({alg:t});i.init(e.cakey),i.updateHex(n),e.sighex=i.sign()},this.getPEM=function(){return _e(this.tohex(),"CERTIFICATE")},this.tohex=function(){var e=this.params;if(null!=e.tbsobj&&null!=e.tbsobj||(e.tbsobj=new o(e)),null==e.sighex&&null!=e.cakey&&this.sign(),null==e.sighex)throw new Error("sighex or cakey parameter not defined");var t=[];return t.push(e.tbsobj),t.push(new s({name:e.sigalg})),t.push(new n({hex:"00"+e.sighex})),new i({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&(this.params=e)},$e(ue.asn1.x509.Certificate,ue.asn1.ASN1Object),ue.asn1.x509.TBSCertificate=function(e){ue.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=ue.asn1,n=t.x509,i=t.DERTaggedObject,r=t.DERInteger,o=t.DERSequence,s=n.AlgorithmIdentifier,a=n.Time,u=n.X500Name,l=n.Extensions,c=n.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=[],t=this.params;if(null!=t.version||1!=t.version){var n=2;null!=t.version&&(n=t.version-1);var d=new i({obj:new r({int:n})});e.push(d)}return e.push(new r(t.serial)),e.push(new s({name:t.sigalg})),e.push(new u(t.issuer)),e.push(new o({array:[new a(t.notbefore),new a(t.notafter)]})),e.push(new u(t.subject)),e.push(new c(We.getKey(t.sbjpubkey))),void 0!==t.ext&&t.ext.length>0&&e.push(new i({tag:"a3",obj:new l(t.ext)})),new ue.asn1.DERSequence({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.TBSCertificate,ue.asn1.ASN1Object),ue.asn1.x509.Extensions=function(e){ue.asn1.x509.Extensions.superclass.constructor.call(this);var t=ue.asn1,n=t.DERSequence,i=t.x509;this.aParam=[],this.setByParam=function(e){this.aParam=e},this.tohex=function(){for(var e=[],t=0;t<this.aParam.length;t++){var r=this.aParam[t],o=r.extname,s=null;if(null!=r.extn)s=new i.PrivateExtension(r);else if("subjectKeyIdentifier"==o)s=new i.SubjectKeyIdentifier(r);else if("keyUsage"==o)s=new i.KeyUsage(r);else if("subjectAltName"==o)s=new i.SubjectAltName(r);else if("issuerAltName"==o)s=new i.IssuerAltName(r);else if("basicConstraints"==o)s=new i.BasicConstraints(r);else if("nameConstraints"==o)s=new i.NameConstraints(r);else if("cRLDistributionPoints"==o)s=new i.CRLDistributionPoints(r);else if("certificatePolicies"==o)s=new i.CertificatePolicies(r);else if("policyMappings"==o)s=new i.PolicyMappings(r);else if("policyConstraints"==o)s=new i.PolicyConstraints(r);else if("inhibitAnyPolicy"==o)s=new i.InhibitAnyPolicy(r);else if("authorityKeyIdentifier"==o)s=new i.AuthorityKeyIdentifier(r);else if("extKeyUsage"==o)s=new i.ExtKeyUsage(r);else if("authorityInfoAccess"==o)s=new i.AuthorityInfoAccess(r);else if("cRLNumber"==o)s=new i.CRLNumber(r);else if("cRLReason"==o)s=new i.CRLReason(r);else if("ocspNonce"==o)s=new i.OCSPNonce(r);else if("ocspNoCheck"==o)s=new i.OCSPNoCheck(r);else if("adobeTimeStamp"==o)s=new i.AdobeTimeStamp(r);else{if("subjectDirectoryAttributes"!=o)throw new Error("extension not supported:"+JSON.stringify(r));s=new i.SubjectDirectoryAttributes(r)}null!=s&&e.push(s)}return new n({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.x509.Extensions,ue.asn1.ASN1Object),ue.asn1.x509.Extension=function(e){ue.asn1.x509.Extension.superclass.constructor.call(this);var t=ue.asn1,n=t.DERObjectIdentifier,i=t.DEROctetString,r=(t.DERBitString,t.DERBoolean),o=t.DERSequence;this.tohex=function(){var e=new n({oid:this.oid}),t=new i({hex:this.getExtnValueHex()}),s=new Array;return s.push(e),this.critical&&s.push(new r),s.push(t),new o({array:s}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,void 0!==e&&void 0!==e.critical&&(this.critical=e.critical)},$e(ue.asn1.x509.Extension,ue.asn1.ASN1Object),ue.asn1.x509.KeyUsage=function(e){ue.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=Error,n={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var e=this.getBinValue();return this.asn1ExtnValue=new ue.asn1.DERBitString({bin:e}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var e=this.params;if("object"!=typeof e||"object"!=typeof e.names&&"string"!=typeof e.bin)throw new t("parameter not yet set");if(null!=e.names)return qe(e.names,n);if(null!=e.bin)return e.bin;throw new t("parameter not set properly")},this.oid="2.5.29.15",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.KeyUsage,ue.asn1.x509.Extension),ue.asn1.x509.BasicConstraints=function(e){ue.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERBoolean,i=t.DERInteger,r=t.DERSequence;this.getExtnValueHex=function(){var e=new Array;this.cA&&e.push(new n),this.pathLen>-1&&e.push(new i({int:this.pathLen}));var t=new r({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==e&&(void 0!==e.cA&&(this.cA=e.cA),void 0!==e.pathLen&&(this.pathLen=e.pathLen))},$e(ue.asn1.x509.BasicConstraints,ue.asn1.x509.Extension),ue.asn1.x509.CRLDistributionPoints=function(e){ue.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=ue.asn1,n=t.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(e){for(var i=[],r=0;r<e.length;r++)if(e[r]instanceof ue.asn1.ASN1Object)i.push(e[r]);else{var o=new n.DistributionPoint(e[r]);i.push(o)}this.asn1ExtnValue=new t.DERSequence({array:i})},this.setByOneURI=function(e){var t=new n.DistributionPoint({fulluri:e});this.setByDPArray([t])},this.oid="2.5.29.31",void 0!==e&&(void 0!==e.array?this.setByDPArray(e.array):void 0!==e.uri&&this.setByOneURI(e.uri))},$e(ue.asn1.x509.CRLDistributionPoints,ue.asn1.x509.Extension),ue.asn1.x509.DistributionPoint=function(e){ue.asn1.x509.DistributionPoint.superclass.constructor.call(this);var t=ue.asn1,n=t.x509.DistributionPointName;this.tohex=function(){var e=new t.DERSequence;if(null!=this.asn1DP){var n=new t.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});e.appendASN1Object(n)}return this.hTLV=e.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(void 0!==e.dpobj?this.asn1DP=e.dpobj:void 0!==e.dpname?this.asn1DP=new n(e.dpname):void 0!==e.fulluri&&(this.asn1DP=new n({full:[{uri:e.fulluri}]})))},$e(ue.asn1.x509.DistributionPoint,ue.asn1.ASN1Object),ue.asn1.x509.DistributionPointName=function(e){ue.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=ue.asn1,n=t.DERTaggedObject;if(this.tohex=function(){if("full"!=this.type)throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new n({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e)if(t.x509.GeneralNames.prototype.isPrototypeOf(e))this.type="full",this.tag="a0",this.asn1V=e;else{if(void 0===e.full)throw new Error("This class supports GeneralNames only as argument");this.type="full",this.tag="a0",this.asn1V=new t.x509.GeneralNames(e.full)}},$e(ue.asn1.x509.DistributionPointName,ue.asn1.ASN1Object),ue.asn1.x509.CertificatePolicies=function(e){ue.asn1.x509.CertificatePolicies.superclass.constructor.call(this,e);var t=ue.asn1,n=t.x509,i=t.DERSequence,r=n.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var e=[],t=0;t<this.params.array.length;t++)e.push(new r(this.params.array[t]));var n=new i({array:e});return this.asn1ExtnValue=n,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.CertificatePolicies,ue.asn1.x509.Extension),ue.asn1.x509.PolicyInformation=function(e){ue.asn1.x509.PolicyInformation.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERSequence,i=t.DERObjectIdentifier,r=t.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(void 0===this.params.policyoid&&void 0===this.params.array)throw new Error("parameter oid and array missing");var e=[new i(this.params.policyoid)];if(void 0!==this.params.array){for(var t=[],o=0;o<this.params.array.length;o++)t.push(new r(this.params.array[o]));t.length>0&&e.push(new n({array:t}))}return new n({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(this.params=e)},$e(ue.asn1.x509.PolicyInformation,ue.asn1.ASN1Object),ue.asn1.x509.PolicyQualifierInfo=function(e){ue.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERSequence,i=t.DERIA5String,r=t.DERObjectIdentifier,o=t.x509.UserNotice;this.params=null,this.tohex=function(){return void 0!==this.params.cps?new n({array:[new r({oid:"1.3.6.1.5.5.7.2.1"}),new i({str:this.params.cps})]}).tohex():null!=this.params.unotice?new n({array:[new r({oid:"1.3.6.1.5.5.7.2.2"}),new o(this.params.unotice)]}).tohex():void 0},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(this.params=e)},$e(ue.asn1.x509.PolicyQualifierInfo,ue.asn1.ASN1Object),ue.asn1.x509.UserNotice=function(e){ue.asn1.x509.UserNotice.superclass.constructor.call(this,e);var t=ue.asn1.DERSequence,n=(ue.asn1.DERInteger,ue.asn1.x509.DisplayText),i=ue.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var e=[];return void 0!==this.params.noticeref&&e.push(new i(this.params.noticeref)),void 0!==this.params.exptext&&e.push(new n(this.params.exptext)),new t({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(this.params=e)},$e(ue.asn1.x509.UserNotice,ue.asn1.ASN1Object),ue.asn1.x509.NoticeReference=function(e){ue.asn1.x509.NoticeReference.superclass.constructor.call(this,e);var t=ue.asn1.DERSequence,n=ue.asn1.DERInteger,i=ue.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var e=[];if(void 0!==this.params.org&&e.push(new i(this.params.org)),void 0!==this.params.noticenum){for(var r=[],o=this.params.noticenum,s=0;s<o.length;s++)r.push(new n(o[s]));e.push(new t({array:r}))}if(0==e.length)throw new Error("parameter is empty");return new t({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(this.params=e)},$e(ue.asn1.x509.NoticeReference,ue.asn1.ASN1Object),ue.asn1.x509.DisplayText=function(e){ue.asn1.x509.DisplayText.superclass.constructor.call(this,e),this.hT="0c",void 0!==e&&("ia5"===e.type?this.hT="16":"vis"===e.type?this.hT="1a":"bmp"===e.type&&(this.hT="1e"))},$e(ue.asn1.x509.DisplayText,ue.asn1.DERAbstractString),ue.asn1.x509.PolicyMappings=function(e){ue.asn1.x509.PolicyMappings.superclass.constructor.call(this,e);var t=ue.asn1,n=(t.x509,t.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){for(var e=this.params,t=[],i=0;i<e.array.length;i++){var r=e.array[i];t.push({seq:[{oid:r[0]},{oid:r[1]}]})}return this.asn1ExtnValue=n({seq:t}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.PolicyMappings,ue.asn1.x509.Extension),ue.asn1.x509.PolicyConstraints=function(e){ue.asn1.x509.PolicyConstraints.superclass.constructor.call(this,e);var t=ue.asn1,n=(t.x509,t.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){var e=this.params,t=[];return null!=e.reqexp&&t.push({tag:{tagi:"80",obj:{int:e.reqexp}}}),null!=e.inhibit&&t.push({tag:{tagi:"81",obj:{int:e.inhibit}}}),this.asn1ExtnValue=n({seq:t}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.PolicyConstraints,ue.asn1.x509.Extension),ue.asn1.x509.InhibitAnyPolicy=function(e){ue.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,e);var t=ue.asn1,n=(t.x509,t.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=n({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.InhibitAnyPolicy,ue.asn1.x509.Extension),ue.asn1.x509.NameConstraints=function(e){ue.asn1.x509.NameConstraints.superclass.constructor.call(this,e);var t=ue.asn1,n=t.x509,i=t.ASN1Util.newObject,r=n.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var e=this.params,t=[];if(null!=e.permit&&null!=e.permit.length){for(var n=[],o=0;o<e.permit.length;o++)n.push(new r(e.permit[o]));t.push({tag:{tagi:"a0",obj:{seq:n}}})}if(null!=e.exclude&&null!=e.exclude.length){var s=[];for(o=0;o<e.exclude.length;o++)s.push(new r(e.exclude[o]));t.push({tag:{tagi:"a1",obj:{seq:s}}})}return this.asn1ExtnValue=i({seq:t}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.NameConstraints,ue.asn1.x509.Extension),ue.asn1.x509.GeneralSubtree=function(e){ue.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var t=ue.asn1,n=t.x509.GeneralName,i=t.ASN1Util.newObject;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params,t=[new n(e)];return null!=e.min&&t.push({tag:{tagi:"80",obj:{int:e.min}}}),null!=e.max&&t.push({tag:{tagi:"81",obj:{int:e.max}}}),i({seq:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.GeneralSubtree,ue.asn1.ASN1Object),ue.asn1.x509.ExtKeyUsage=function(e){ue.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var t=ue.asn1;this.setPurposeArray=function(e){this.asn1ExtnValue=new t.DERSequence;for(var n=0;n<e.length;n++){var i=new t.DERObjectIdentifier(e[n]);this.asn1ExtnValue.appendASN1Object(i)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",void 0!==e&&void 0!==e.array&&this.setPurposeArray(e.array)},$e(ue.asn1.x509.ExtKeyUsage,ue.asn1.x509.Extension),ue.asn1.x509.AuthorityKeyIdentifier=function(e){ue.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var t=ue,n=t.asn1,i=n.DERTaggedObject,r=n.x509.GeneralNames;t.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var e=new Array;this.asn1KID&&e.push(new i({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&e.push(new i({explicit:!1,tag:"a1",obj:new r([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&e.push(new i({explicit:!1,tag:"82",obj:this.asn1CertSN}));var t=new n.DERSequence({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(e){if(void 0!==e.str||void 0!==e.hex)this.asn1KID=new ue.asn1.DEROctetString(e);else if("object"==typeof e&&ue.crypto.Util.isKey(e)||"string"==typeof e&&-1!=e.indexOf("BEGIN ")){var t=e;"string"==typeof e&&(t=We.getKey(e));var n=We.getKeyID(t);this.asn1KID=new ue.asn1.DEROctetString({hex:n})}},this.setCertIssuerByParam=function(e){void 0!==e.str||void 0!==e.ldapstr||void 0!==e.hex||void 0!==e.certsubject||void 0!==e.certissuer?this.asn1CertIssuer=new ue.asn1.x509.X500Name(e):"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&-1!=e.indexOf("CERTIFICATE")&&(this.asn1CertIssuer=new ue.asn1.x509.X500Name({certissuer:e}))},this.setCertSNByParam=function(e){if(void 0!==e.str||void 0!==e.bigint||void 0!==e.hex)this.asn1CertSN=new ue.asn1.DERInteger(e);else if("string"==typeof e&&-1!=e.indexOf("BEGIN ")&&e.indexOf("CERTIFICATE")){var t=new Qe;t.readCertPEM(e);var n=t.getSerialNumberHex();this.asn1CertSN=new ue.asn1.DERInteger({hex:n})}},this.oid="2.5.29.35",void 0!==e&&(void 0!==e.kid&&this.setKIDByParam(e.kid),void 0!==e.issuer&&this.setCertIssuerByParam(e.issuer),void 0!==e.sn&&this.setCertSNByParam(e.sn),void 0!==e.issuersn&&"string"==typeof e.issuersn&&-1!=e.issuersn.indexOf("BEGIN ")&&e.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(e.issuersn),this.setCertIssuerByParam(e.issuersn)))},$e(ue.asn1.x509.AuthorityKeyIdentifier,ue.asn1.x509.Extension),ue.asn1.x509.SubjectKeyIdentifier=function(e){ue.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,e);var t=ue.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(e){if(void 0!==e.str||void 0!==e.hex)this.asn1KID=new t(e);else if("object"==typeof e&&ue.crypto.Util.isKey(e)||"string"==typeof e&&-1!=e.indexOf("BEGIN")){var n=e;"string"==typeof e&&(n=We.getKey(e));var i=We.getKeyID(n);this.asn1KID=new ue.asn1.DEROctetString({hex:i})}},this.oid="2.5.29.14",void 0!==e&&void 0!==e.kid&&this.setKIDByParam(e.kid)},$e(ue.asn1.x509.SubjectKeyIdentifier,ue.asn1.x509.Extension),ue.asn1.x509.AuthorityInfoAccess=function(e){ue.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(e){for(var t=new Array,n=ue.asn1,i=n.DERSequence,r=n.DERObjectIdentifier,o=n.x509.GeneralName,s=0;s<e.length;s++){var a,u=e[s];if(void 0!==u.ocsp)a=new i({array:[new r({oid:"1.3.6.1.5.5.7.48.1"}),new o({uri:u.ocsp})]});else{if(void 0===u.caissuer)throw new Error("unknown AccessMethod parameter: "+JSON.stringify(u));a=new i({array:[new r({oid:"1.3.6.1.5.5.7.48.2"}),new o({uri:u.caissuer})]})}t.push(a)}this.asn1ExtnValue=new i({array:t})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==e&&void 0!==e.array&&this.setAccessDescriptionArray(e.array)},$e(ue.asn1.x509.AuthorityInfoAccess,ue.asn1.x509.Extension),ue.asn1.x509.SubjectAltName=function(e){ue.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new ue.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},$e(ue.asn1.x509.SubjectAltName,ue.asn1.x509.Extension),ue.asn1.x509.IssuerAltName=function(e){ue.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new ue.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},$e(ue.asn1.x509.IssuerAltName,ue.asn1.x509.Extension),ue.asn1.x509.SubjectDirectoryAttributes=function(e){ue.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERSequence,i=t.ASN1Util.newObject,r=t.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var e=[],t=0;t<this.params.array.length;t++){var o=this.params.array[t];if(null==o.attr||null==o.array){var s={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if("dateOfBirth"==o.attr)s.seq[0].oid=r(o.attr),s.seq[1].set[0]={gentime:o.str};else if("placeOfBirth"==o.attr)s.seq[0].oid=r(o.attr),s.seq[1].set[0]={utf8str:o.str};else if("gender"==o.attr)s.seq[0].oid=r(o.attr),s.seq[1].set[0]={prnstr:o.str};else if("countryOfCitizenship"==o.attr)s.seq[0].oid=r(o.attr),s.seq[1].set[0]={prnstr:o.str};else{if("countryOfResidence"!=o.attr)throw new Error("unsupported attribute: "+o.attr);s.seq[0].oid=r(o.attr),s.seq[1].set[0]={prnstr:o.str}}e.push(new i(s))}else{var a={seq:[{oid:o.attr},{set:o.array}]};e.push(i(a))}}var u=new n({array:e});return this.asn1ExtnValue=u,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",void 0!==e&&(this.params=e)},$e(ue.asn1.x509.SubjectDirectoryAttributes,ue.asn1.x509.Extension),ue.asn1.x509.PrivateExtension=function(e){ue.asn1.x509.PrivateExtension.superclass.constructor.call(this,e);var t=ue,n=t.lang.String.isHex,i=t.asn1,r=i.x509.OID.name2oid,o=i.ASN1Util.newObject;this.params=null,this.setByParam=function(e){this.oid=r(e.extname),this.params=e},this.getExtnValueHex=function(){if(null==this.params.extname||null==this.params.extn)throw new Error("extname or extnhex not specified");var e=this.params.extn;if("string"==typeof e&&n(e))return e;if("object"==typeof e)try{return o(e).tohex()}catch(e){}throw new Error("unsupported extn value")},null!=e&&this.setByParam(e)},$e(ue.asn1.x509.PrivateExtension,ue.asn1.x509.Extension),ue.asn1.x509.CRL=function(e){ue.asn1.x509.CRL.superclass.constructor.call(this);var t=ue.asn1,n=t.DERSequence,i=t.DERBitString,r=t.x509,o=r.AlgorithmIdentifier,s=r.TBSCertList;this.params=void 0,this.setByParam=function(e){this.params=e},this.sign=function(){var e=new s(this.params).tohex(),t=new ue.crypto.Signature({alg:this.params.sigalg});t.init(this.params.cakey),t.updateHex(e);var n=t.sign();this.params.sighex=n},this.getPEM=function(){return _e(this.tohex(),"X509 CRL")},this.tohex=function(){var e=this.params;if(null==e.tbsobj&&(e.tbsobj=new s(e)),null==e.sighex&&null!=e.cakey&&this.sign(),null==e.sighex)throw new Error("sighex or cakey parameter not defined");var t=[];return t.push(e.tbsobj),t.push(new o({name:e.sigalg})),t.push(new i({hex:"00"+e.sighex})),new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&(this.params=e)},$e(ue.asn1.x509.CRL,ue.asn1.ASN1Object),ue.asn1.x509.TBSCertList=function(e){ue.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=ue.asn1,n=t.DERInteger,i=t.DERSequence,r=t.DERTaggedObject,o=(t.DERObjectIdentifier,t.x509),s=o.AlgorithmIdentifier,a=o.Time,u=o.Extensions,l=o.X500Name;this.params=null,this.setByParam=function(e){this.params=e},this.getRevCertSequence=function(){for(var e=[],t=this.params.revcert,r=0;r<t.length;r++){var o=[new n(t[r].sn),new a(t[r].date)];null!=t[r].ext&&o.push(new u(t[r].ext)),e.push(new i({array:o}))}return new i({array:e})},this.tohex=function(){var e=[],t=this.params;if(null!=t.version){var o=t.version-1,c=new n({int:o});e.push(c)}if(e.push(new s({name:t.sigalg})),e.push(new l(t.issuer)),e.push(new a(t.thisupdate)),null!=t.nextupdate&&e.push(new a(t.nextupdate)),null!=t.revcert&&e.push(this.getRevCertSequence()),null!=t.ext){var d=new u(t.ext);e.push(new r({tag:"a0",explicit:!0,obj:d}))}return new i({array:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.TBSCertList,ue.asn1.ASN1Object),ue.asn1.x509.CRLEntry=function(e){ue.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=ue.asn1;this.setCertSerial=function(e){this.sn=new t.DERInteger(e)},this.setRevocationDate=function(e){this.time=new t.x509.Time(e)},this.tohex=function(){var e=new t.DERSequence({array:[this.sn,this.time]});return this.TLV=e.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(void 0!==e.time&&this.setRevocationDate(e.time),void 0!==e.sn&&this.setCertSerial(e.sn))},$e(ue.asn1.x509.CRLEntry,ue.asn1.ASN1Object),ue.asn1.x509.CRLNumber=function(e){ue.asn1.x509.CRLNumber.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",null!=e&&(this.params=e)},$e(ue.asn1.x509.CRLNumber,ue.asn1.x509.Extension),ue.asn1.x509.CRLReason=function(e){ue.asn1.x509.CRLReason.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",null!=e&&(this.params=e)},$e(ue.asn1.x509.CRLReason,ue.asn1.x509.Extension),ue.asn1.x509.OCSPNonce=function(e){ue.asn1.x509.OCSPNonce.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",null!=e&&(this.params=e)},$e(ue.asn1.x509.OCSPNonce,ue.asn1.x509.Extension),ue.asn1.x509.OCSPNoCheck=function(e){ue.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",null!=e&&(this.params=e)},$e(ue.asn1.x509.OCSPNoCheck,ue.asn1.x509.Extension),ue.asn1.x509.AdobeTimeStamp=function(e){ue.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,e);var t=ue.asn1,n=t.DERInteger,i=t.DERBoolean,r=t.DERSequence,o=t.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var e=this.params,t=[new n(1)];return t.push(new o({uri:e.uri})),null!=e.reqauth&&t.push(new i(e.reqauth)),this.asn1ExtnValue=new r({array:t}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.AdobeTimeStamp,ue.asn1.x509.Extension),ue.asn1.x509.X500Name=function(e){ue.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=ue.asn1,n=t.x509,i=n.RDN;this.setByString=function(e,t){void 0!==t&&(this.sRule=t);var n=e.split("/");n.shift();for(var r=[],o=0;o<n.length;o++)if(n[o].match(/^[^=]+=.+$/))r.push(n[o]);else{var s=r.length-1;r[s]=r[s]+"/"+n[o]}for(o=0;o<r.length;o++)this.asn1Array.push(new i({str:r[o],rule:this.sRule}))},this.setByLdapString=function(e,t){void 0!==t&&(this.sRule=t);var i=n.X500Name.ldapToCompat(e);this.setByString(i,t)},this.setByObject=function(e,t){for(var n in void 0!==t&&(this.sRule=t),e)if(e.hasOwnProperty(n)){var r=new i({str:n+"="+e[n],rule:this.sRule});this.asn1Array?this.asn1Array.push(r):this.asn1Array=[r]}},this.setByParam=function(e){var t;void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.array?this.paramArray=e.array:void 0!==e.str?this.setByString(e.str):void 0!==e.ldapstr?this.setByLdapString(e.ldapstr):void 0!==e.hex?this.hTLV=e.hex:void 0!==e.certissuer?((t=new Qe).readCertPEM(e.certissuer),this.hTLV=t.getIssuerHex()):void 0!==e.certsubject?((t=new Qe).readCertPEM(e.certsubject),this.hTLV=t.getSubjectHex()):"object"==typeof e&&void 0===e.certsubject&&void 0===e.certissuer&&this.setByObject(e)},this.tohex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(0==this.asn1Array.length&&this.paramArray.length>0)for(var e=0;e<this.paramArray.length;e++){var n={array:this.paramArray[e]};"utf8"!=this.sRule&&(n.rule=this.sRule);var r=new i(n);this.asn1Array.push(r)}var o=new t.DERSequence({array:this.asn1Array});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.X500Name,ue.asn1.ASN1Object),ue.asn1.x509.X500Name.compatToLDAP=function(e){if("/"!==e.substr(0,1))throw"malformed input";var t=(e=e.substr(1)).split("/");return t.reverse(),t=t.map((function(e){return e.replace(/,/,"\\,")})),t.join(",")},ue.asn1.x509.X500Name.onelineToLDAP=function(e){return ue.asn1.x509.X500Name.compatToLDAP(e)},ue.asn1.x509.X500Name.ldapToCompat=function(e){for(var t=e.split(","),n=!1,i=[],r=0;t.length>0;r++){var o=t.shift();if(!0===n){var s=(i.pop()+","+o).replace(/\\,/g,",");i.push(s),n=!1}else i.push(o);"\\"===o.substr(-1,1)&&(n=!0)}return i=i.map((function(e){return e.replace("/","\\/")})),i.reverse(),"/"+i.join("/")},ue.asn1.x509.X500Name.ldapToOneline=function(e){return ue.asn1.x509.X500Name.ldapToCompat(e)},ue.asn1.x509.RDN=function(e){ue.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=ue.asn1.x509.AttributeTypeAndValue;this.setByParam=function(e){void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.str&&this.addByMultiValuedString(e.str),void 0!==e.array&&(this.paramArray=e.array)},this.addByString=function(e){this.asn1Array.push(new ue.asn1.x509.AttributeTypeAndValue({str:e,rule:this.sRule}))},this.addByMultiValuedString=function(e){for(var t=ue.asn1.x509.RDN.parseString(e),n=0;n<t.length;n++)this.addByString(t[n])},this.tohex=function(){if(0==this.asn1Array.length&&this.paramArray.length>0)for(var e=0;e<this.paramArray.length;e++){var n=this.paramArray[e];void 0!==n.rule&&"utf8"!=this.sRule&&(n.rule=this.sRule);var i=new t(n);this.asn1Array.push(i)}var r=new ue.asn1.DERSet({array:this.asn1Array});return this.TLV=r.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.RDN,ue.asn1.ASN1Object),ue.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),n=!1,i=[],r=0;t.length>0;r++){var o=t.shift();if(!0===n){var s=(i.pop()+"+"+o).replace(/\\\+/g,"+");i.push(s),n=!1}else i.push(o);"\\"===o.substr(-1,1)&&(n=!0)}var a=!1,u=[];for(r=0;i.length>0;r++){if(o=i.shift(),!0===a){var l=u.pop();o.match(/"$/)?(s=(l+"+"+o).replace(/^([^=]+)="(.*)"$/,"$1=$2"),u.push(s),a=!1):u.push(l+"+"+o)}else u.push(o);o.match(/^[^=]+="/)&&(a=!0)}return u},ue.asn1.x509.AttributeTypeAndValue=function(e){ue.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var t=ue,n=t.asn1,i=n.DERSequence,r=n.DERUTF8String,o=n.DERPrintableString,s=n.DERTeletexString,a=n.DERIA5String,u=n.DERVisibleString,l=n.DERBMPString,c=t.lang.String.isMail,d=t.lang.String.isPrintable;this.setByParam=function(e){if(void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.ds&&(this.dsType=e.ds),void 0===e.value&&void 0!==e.str){var t=e.str.match(/^([^=]+)=(.+)$/);if(!t)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.sType=t[1],this.sValue=t[2]}else this.sType=e.type,this.sValue=e.value},this.setByString=function(e,t){void 0!==t&&(this.sRule=t);var n=e.match(/^([^=]+)=(.+)$/);if(!n)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.setByAttrTypeAndValueStr(n[1],n[2])},this._getDsType=function(){var e=this.sType,t=this.sValue,n=this.sRule;return"prn"===n?"CN"==e&&c(t)?"ia5":d(t)?"prn":"utf8":"utf8"===n?"CN"==e&&c(t)?"ia5":"C"==e?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(e,t,n){void 0!==n&&(this.sRule=n),this.sType=e,this.sValue=t},this.getValueObj=function(e,t){if("utf8"==e)return new r({str:t});if("prn"==e)return new o({str:t});if("tel"==e)return new s({str:t});if("ia5"==e)return new a({str:t});if("vis"==e)return new u({str:t});if("bmp"==e)return new l({str:t});throw new Error("unsupported directory string type: type="+e+" value="+t)},this.tohex=function(){null==this.dsType&&(this.dsType=this._getDsType());var e=ue.asn1.x509.OID.atype2obj(this.sType),t=this.getValueObj(this.dsType,this.sValue),n=new i({array:[e,t]});return this.TLV=n.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.AttributeTypeAndValue,ue.asn1.ASN1Object),ue.asn1.x509.SubjectPublicKeyInfo=function(e){ue.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=ue,n=t.asn1,i=n.DERInteger,r=n.DERBitString,o=n.DERObjectIdentifier,s=n.DERSequence,a=n.ASN1Util.newObject,u=n.x509.AlgorithmIdentifier,l=t.crypto;l.ECDSA,l.DSA,this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new s({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.tohex=function(){var e=this.getASN1Object();return this.hTLV=e.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(e){try{if(e instanceof ie){var t=a({seq:[{int:{bigint:e.n}},{int:{int:e.e}}]}).tohex();this.asn1AlgId=new u({name:"rsaEncryption"}),this.asn1SubjPKey=new r({hex:"00"+t})}}catch(e){}try{if(e instanceof ue.crypto.ECDSA){var n=new o({name:e.curveName});this.asn1AlgId=new u({name:"ecPublicKey",asn1params:n}),this.asn1SubjPKey=new r({hex:"00"+e.pubKeyHex})}}catch(e){}try{if(e instanceof ue.crypto.DSA){n=new a({seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}),this.asn1AlgId=new u({name:"dsa",asn1params:n});var s=new i({bigint:e.y});this.asn1SubjPKey=new r({hex:"00"+s.tohex()})}}catch(e){}},void 0!==e&&this.setPubKey(e)},$e(ue.asn1.x509.SubjectPublicKeyInfo,ue.asn1.ASN1Object),ue.asn1.x509.Time=function(e){ue.asn1.x509.Time.superclass.constructor.call(this);var t=ue.asn1,n=t.DERUTCTime,i=t.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(e){this.timeParams=e},this.setByParam=function(e){this.params=e},this.getType=function(e){return e.match(/^[0-9]{12}Z$/)?"utc":e.match(/^[0-9]{14}Z$/)?"gen":e.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":e.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var e=this.params,t=null;if("string"==typeof e&&(e={str:e}),null==e||!e.str||null!=e.type&&null!=e.type||(e.type=this.getType(e.str)),null!=e&&e.str?("utc"==e.type&&(t=new n(e.str)),"gen"==e.type&&(t=new i(e.str))):t="gen"==this.type?new i:new n,null==t)throw new Error("wrong setting for Time");return this.TLV=t.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},ue.asn1.x509.Time_bak=function(e){ue.asn1.x509.Time_bak.superclass.constructor.call(this);var t=ue.asn1,n=t.DERUTCTime,i=t.DERGeneralizedTime;this.setTimeParams=function(e){this.timeParams=e},this.tohex=function(){var e=null;return e=null!=this.timeParams?"utc"==this.type?new n(this.timeParams):new i(this.timeParams):"utc"==this.type?new n:new i,this.TLV=e.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",void 0!==e&&(void 0!==e.type?this.type=e.type:void 0!==e.str&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)},$e(ue.asn1.x509.Time,ue.asn1.ASN1Object),ue.asn1.x509.AlgorithmIdentifier=function(e){ue.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var t=ue.asn1,n=t.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw new Error("algorithm not specified");if(null!==this.nameAlg){var e=null;for(var i in n)i===this.nameAlg&&(e=n[i]);if(null!==e)return this.hTLV=e,this.hTLV}null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=t.x509.OID.name2obj(this.nameAlg));var r=[this.asn1Alg];null!==this.asn1Params&&r.push(this.asn1Params);var o=new t.DERSequence({array:r});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&(void 0!==e.name&&(this.nameAlg=e.name),void 0!==e.asn1params&&(this.asn1Params=e.asn1params),void 0!==e.paramempty&&(this.paramEmpty=e.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){void 0!==this.nameAlg.name&&(this.nameAlg=this.nameAlg.name);var i=this.nameAlg.toLowerCase();"withdsa"!==i.substr(-7,7)&&"withecdsa"!==i.substr(-9,9)&&(this.asn1Params=new t.DERNull)}},$e(ue.asn1.x509.AlgorithmIdentifier,ue.asn1.ASN1Object),ue.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},ue.asn1.x509.GeneralName=function(e){ue.asn1.x509.GeneralName.superclass.constructor.call(this);var t=ue.asn1,n=t.x509,i=n.X500Name,r=n.OtherName,o=t.DERIA5String,s=(t.DERPrintableString,t.DEROctetString),a=t.DERTaggedObject,u=t.ASN1Object,l=Error;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e,t,n=this.params,c=!1;if(void 0!==n.other)e="a0",t=new r(n.other);else if(void 0!==n.rfc822)e="81",t=new o({str:n.rfc822});else if(void 0!==n.dns)e="82",t=new o({str:n.dns});else if(void 0!==n.dn)e="a4",c=!0,t="string"==typeof n.dn?new i({str:n.dn}):n.dn instanceof ue.asn1.x509.X500Name?n.dn:new i(n.dn);else if(void 0!==n.ldapdn)e="a4",c=!0,t=new i({ldapstr:n.ldapdn});else if(void 0!==n.certissuer||void 0!==n.certsubj){var d,h;e="a4",c=!0;var p=null;if(void 0!==n.certsubj?(d=!1,h=n.certsubj):(d=!0,h=n.certissuer),h.match(/^[0-9A-Fa-f]+$/),-1!=h.indexOf("-----BEGIN ")&&(p=Ie(h)),null==p)throw new Error("certsubj/certissuer not cert");var f,g=new Qe;g.hex=p,f=d?g.getIssuerHex():g.getSubjectHex(),(t=new u).hTLV=f}else if(void 0!==n.uri)e="86",t=new o({str:n.uri});else{if(void 0===n.ip)throw new l("improper params");var m;e="87";var v=n.ip;try{if(v.match(/^[0-9a-f]+$/)){var y=v.length;if(8!=y&&16!=y&&32!=y&&64!=y)throw"err";m=v}else m=ke(v)}catch(e){throw new l("malformed IP address: "+n.ip+":"+e.message)}t=new s({hex:m})}return new a({tag:e,explicit:c,obj:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.GeneralName,ue.asn1.ASN1Object),ue.asn1.x509.GeneralNames=function(e){ue.asn1.x509.GeneralNames.superclass.constructor.call(this);var t=ue.asn1;this.setByParamArray=function(e){for(var n=0;n<e.length;n++){var i=new t.x509.GeneralName(e[n]);this.asn1Array.push(i)}},this.tohex=function(){return new t.DERSequence({array:this.asn1Array}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,void 0!==e&&this.setByParamArray(e)},$e(ue.asn1.x509.GeneralNames,ue.asn1.ASN1Object),ue.asn1.x509.OtherName=function(e){ue.asn1.x509.OtherName.superclass.constructor.call(this);var t=ue.asn1,n=t.DERObjectIdentifier,i=t.DERSequence,r=t.ASN1Util.newObject;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params;if(null==e.oid||null==e.value)throw new Error("oid or value not specified");var t=new n({oid:e.oid}),o=r({tag:{tag:"a0",explicit:!0,obj:e.value}});return new i({array:[t,o]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.x509.OtherName,ue.asn1.ASN1Object),ue.asn1.x509.OID=new function(){var e=ue.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.name2oidList[t])throw"Name of ObjectIdentifier not defined: "+t;var n=this.name2oidList[t],i=new e({oid:n});return this.objCache[t]=i,i},this.atype2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];var n;if(t.match(/^\d+\.\d+\.[0-9.]+$/))n=t;else if(void 0!==this.atype2oidList[t])n=this.atype2oidList[t];else{if(void 0===this.name2oidList[t])throw new Error("AttributeType name undefined: "+t);n=this.name2oidList[t]}var i=new e({oid:n});return this.objCache[t]=i,i},this.registerOIDs=function(e){if(this.checkOIDs(e))for(var t in e)this.name2oidList[t]=e[t]},this.checkOIDs=function(e){try{var t=Object.keys(e);return 0!=t.length&&(t.map((function(e,t,n){if(!this[e].match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")}),e),!0)}catch(e){return!1}}},ue.asn1.x509.OID.oid2name=function(e){var t=ue.asn1.x509.OID.name2oidList;for(var n in t)if(t[n]==e)return n;return""},ue.asn1.x509.OID.oid2atype=function(e){var t=ue.asn1.x509.OID.atype2oidList;for(var n in t)if(t[n]==e)return n;return e},ue.asn1.x509.OID.name2oid=function(e){if(e.match(/^[0-9.]+$/))return e;var t=ue.asn1.x509.OID.name2oidList;return void 0===t[e]?"":t[e]},ue.asn1.x509.X509Util={},ue.asn1.x509.X509Util.newCertPEM=function(e){var t=ue.asn1.x509;return t.TBSCertificate,new(0,t.Certificate)(e).getPEM()},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.cms&&ue.asn1.cms||(ue.asn1.cms={}),ue.asn1.cms.Attribute=function(e){var t=Error,n=ue.asn1,i=n.DERSequence,r=n.DERSet,o=n.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(e){this.params=e},this.getValueArray=function(){throw new t("not yet implemented abstract")},this.tohex=function(){var e=new o({oid:this.typeOid}),t=new r({array:this.getValueArray()});return new i({array:[e,t]}).tohex()},this.getEncodedHex=function(){return this.tohex()}},$e(ue.asn1.cms.Attribute,ue.asn1.ASN1Object),ue.asn1.cms.ContentType=function(e){var t=ue.asn1;t.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){return[new t.DERObjectIdentifier(this.params.type)]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.ContentType,ue.asn1.cms.Attribute),ue.asn1.cms.MessageDigest=function(e){var t=ue.asn1,n=t.DEROctetString;t.cms.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){return[new n(this.params)]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.MessageDigest,ue.asn1.cms.Attribute),ue.asn1.cms.SigningTime=function(e){var t=ue.asn1;t.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){return[new t.x509.Time(this.params)]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SigningTime,ue.asn1.cms.Attribute),ue.asn1.cms.SigningCertificate=function(e){var t=Error,n=ue,i=n.asn1,r=i.DERSequence,o=i.cms,s=o.ESSCertID;n.crypto,o.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(null==this.params||null==this.params||null==this.params.array)throw new t("parameter 'array' not specified");for(var n=this.params.array,i=[],o=0;o<n.length;o++){var a=n[o];0!=e.hasis||"string"!=typeof a||-1==a.indexOf("-----BEGIN")&&!de.isASN1HEX(a)||(a={cert:a}),0!=a.hasis&&0==e.hasis&&(a.hasis=!1),i.push(new s(a))}var u=new r({array:i});return[new r({array:[u]})]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SigningCertificate,ue.asn1.cms.Attribute),ue.asn1.cms.ESSCertID=function(e){ue.asn1.cms.ESSCertID.superclass.constructor.call(this);var t=Error,n=ue,i=n.asn1,r=i.DEROctetString,o=i.DERSequence,s=i.cms.IssuerSerial;this.params=null,this.getCertHash=function(e,i){if(null!=e.hash)return e.hash;if("string"==typeof e&&-1==e.indexOf("-----BEGIN")&&!de.isASN1HEX(e))return e;var r,o,s;if("string"==typeof e)r=e;else{if(null==e.cert)throw new t("hash nor cert unspecified");r=e.cert}if(o=-1!=r.indexOf("-----BEGIN")?Ie(r):r,"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?o=Ie(e):de.isASN1HEX(e)&&(o=e)),null!=e.alg)s=e.alg;else{if(null==i)throw new t("hash alg unspecified");s=i}return n.crypto.Util.hashHex(o,s)},this.tohex=function(){var e=this.params,t=this.getCertHash(e,"sha1"),n=[];return n.push(new r({hex:t})),("string"==typeof e&&-1!=e.indexOf("-----BEGIN")||null!=e.cert&&0!=e.hasis||null!=e.issuer&&null!=e.serial)&&n.push(new s(e)),new o({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.ESSCertID,ue.asn1.ASN1Object),ue.asn1.cms.SigningCertificateV2=function(e){var t=Error,n=ue,i=n.asn1,r=i.DERSequence,o=(i.x509,i.cms),s=o.ESSCertIDv2;n.crypto,o.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(null==this.params||null==this.params||null==this.params.array)throw new t("parameter 'array' not specified");for(var n=this.params.array,i=[],o=0;o<n.length;o++){var a=n[o];null==e.alg&&0!=e.hasis||"string"!=typeof a||-1==a.indexOf("-----BEGIN")&&!de.isASN1HEX(a)||(a={cert:a}),null==a.alg&&null!=e.alg&&(a.alg=e.alg),0!=a.hasis&&0==e.hasis&&(a.hasis=!1),i.push(new s(a))}var u=new r({array:i});return[new r({array:[u]})]},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SigningCertificateV2,ue.asn1.cms.Attribute),ue.asn1.cms.ESSCertIDv2=function(e){ue.asn1.cms.ESSCertIDv2.superclass.constructor.call(this),Error;var t=ue.asn1,n=t.DEROctetString,i=t.DERSequence,r=t.cms.IssuerSerial,o=t.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var e=this.params,t=this.getCertHash(e,"sha256"),s=[];return null!=e.alg&&"sha256"!=e.alg&&s.push(new o({name:e.alg})),s.push(new n({hex:t})),("string"==typeof e&&-1!=e.indexOf("-----BEGIN")||null!=e.cert&&0!=e.hasis||null!=e.issuer&&null!=e.serial)&&s.push(new r(e)),new i({array:s}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.ESSCertIDv2,ue.asn1.cms.ESSCertID),ue.asn1.cms.IssuerSerial=function(e){var t=Error,n=ue.asn1,i=n.DERInteger,r=n.DERSequence,o=n.cms,s=n.x509.GeneralNames,a=Qe;o.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(e){this.params=e},this.tohex=function(){var e,n,o=this.params;if("string"==typeof o&&-1!=o.indexOf("-----BEGIN")||null!=o.cert){var u;u=null!=o.cert?o.cert:o;var l=new a;l.readCertPEM(u),e=l.getIssuer(),n={hex:l.getSerialNumberHex()}}else{if(null==o.issuer||!o.serial)throw new t("cert or issuer and serial parameter not specified");e=o.issuer,n=o.serial}var c=new s([{dn:e}]),d=new i(n);return new r({array:[c,d]}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.IssuerSerial,ue.asn1.ASN1Object),ue.asn1.cms.SignerIdentifier=function(e){var t=ue.asn1,n=(t.DERInteger,t.DERSequence,t.cms),i=n.IssuerAndSerialNumber,r=n.SubjectKeyIdentifier;t.x509.X500Name,Error,n.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if("isssn"==e.type)return new i(e).tohex();if("skid"==e.type)return new r(e).tohex();throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SignerIdentifier,ue.asn1.ASN1Object),ue.asn1.cms.IssuerAndSerialNumber=function(e){var t=ue.asn1,n=t.DERInteger,i=t.DERSequence,r=t.cms,o=t.x509.X500Name,s=Qe,a=Error;r.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e,t,r=this.params;if("string"==typeof r&&-1!=r.indexOf("-----BEGIN")||null!=r.cert){var u;u=null!=r.cert?r.cert:r;var l=new s;l.readCertPEM(u),e=l.getIssuer(),t={hex:l.getSerialNumberHex()}}else{if(null==r.issuer||!r.serial)throw new a("cert or issuer and serial parameter not specified");e=r.issuer,t=r.serial}var c=new o(e),d=new n(t);return new i({array:[c,d]}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.IssuerAndSerialNumber,ue.asn1.ASN1Object),ue.asn1.cms.SubjectKeyIdentifier=function(e){var t=ue.asn1,n=(t.DERInteger,t.DERSequence,t.ASN1Util.newObject),i=t.cms,r=(i.IssuerAndSerialName,i.SubjectKeyIdentifier,t.x509.X500Name,Qe),o=Error;i.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var e,t=this.params;if(null==t.cert&&null==t.skid)throw new o("property cert nor skid undefined");return null!=t.cert?e=new r(t.cert).getExtSubjectKeyIdentifier().kid.hex:null!=t.skid&&(e=t.skid),n({tag:{tage:"a0",obj:{octstr:{hex:e}}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SubjectKeyIdentifier,ue.asn1.ASN1Object),ue.asn1.cms.AttributeList=function(e){var t=Error,n=ue.asn1,i=n.DERSet,r=n.cms;r.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params;if(null!=this.hTLV)return this.hTLV;var n=!0;null!=e.sortflag&&(n=e.sortflag);for(var o=e.array,s=[],a=0;a<o.length;a++){var u=o[a],l=u.attr;if("contentType"==l)s.push(new r.ContentType(u));else if("messageDigest"==l)s.push(new r.MessageDigest(u));else if("signingTime"==l)s.push(new r.SigningTime(u));else if("signingCertificate"==l)s.push(new r.SigningCertificate(u));else if("signingCertificateV2"==l)s.push(new r.SigningCertificateV2(u));else if("signaturePolicyIdentifier"==l)s.push(new ue.asn1.cades.SignaturePolicyIdentifier(u));else{if("signatureTimeStamp"!=l&&"timeStampToken"!=l)throw new t("unknown attr: "+l);s.push(new ue.asn1.cades.SignatureTimeStamp(u))}}var c=new i({array:s,sortflag:n});return this.hTLV=c.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.AttributeList,ue.asn1.ASN1Object),ue.asn1.cms.SignerInfo=function(e){var t=Error,n=ue,i=n.asn1,r=i.DERInteger,o=i.DEROctetString,s=i.DERSequence,a=i.DERTaggedObject,u=i.cms,l=u.SignerIdentifier,c=u.AttributeList,d=(u.ContentType,u.EncapsulatedContentInfo,u.MessageDigest,u.SignedData,i.x509.AlgorithmIdentifier),h=n.crypto,p=We;u.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var e=this.params,t=e.sigalg,n=new c(e.sattrs).tohex(),i=p.getKey(e.signkey),r=new h.Signature({alg:t});r.init(i),r.updateHex(n);var o=r.sign();e.sighex=o},this.tohex=function(){var e=this.params,n=[];if(n.push(new r({int:e.version})),n.push(new l(e.id)),n.push(new d({name:e.hashalg})),null!=e.sattrs){var i=new c(e.sattrs);try{n.push(new a({tag:"a0",explicit:!1,obj:i}))}catch(e){throw new t("si sattr error: "+e)}}if(null!=e.sigalgfield?n.push(new d({name:e.sigalgfield})):n.push(new d({name:e.sigalg})),null==e.sighex&&null!=e.signkey&&this.sign(),n.push(new o({hex:e.sighex})),null!=e.uattrs){i=new c(e.uattrs);try{n.push(new a({tag:"a1",explicit:!1,obj:i}))}catch(e){throw new t("si uattr error: "+e)}}return new s({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SignerInfo,ue.asn1.ASN1Object),ue.asn1.cms.EncapsulatedContentInfo=function(e){var t=ue.asn1,n=t.DERTaggedObject,i=t.DERSequence,r=t.DERObjectIdentifier,o=t.DEROctetString;t.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];if(t.push(new r(e.type)),null!=e.content&&(null!=e.content.hex||null!=e.content.str)&&1!=e.isDetached){var s=new o(e.content),a=new n({tag:"a0",explicit:!0,obj:s});t.push(a)}return new i({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.EncapsulatedContentInfo,ue.asn1.ASN1Object),ue.asn1.cms.ContentInfo=function(e){var t=ue.asn1,n=t.DERTaggedObject,i=t.DERSequence,r=t.DERObjectIdentifier;t.x509.OID.name2obj,ue.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];t.push(new r(e.type));var o=new n({tag:"a0",explicit:!0,obj:e.obj});return t.push(o),new i({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.ContentInfo,ue.asn1.ASN1Object),ue.asn1.cms.SignedData=function(e){Error;var t=ue.asn1,n=(t.ASN1Object,t.DERInteger),i=t.DERSet,r=t.DERSequence,o=(t.DERTaggedObject,t.cms),s=o.EncapsulatedContentInfo,a=o.SignerInfo,u=o.ContentInfo,l=o.CertificateSet,c=o.RevocationInfoChoices,d=t.x509.AlgorithmIdentifier;ue.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var e=this.params;this._setDigestAlgs(e),this._setContentTypeByEContent(e),this._setMessageDigestByEContent(e),this._setSignerInfoVersion(e),this._setSignedDataVersion(e)},this._setDigestAlgs=function(e){for(var t={},n=e.sinfos,i=0;i<n.length;i++)t[n[i].hashalg]=1;e.hashalgs=Object.keys(t).sort()},this._setContentTypeByEContent=function(e){for(var t=e.econtent.type,n=e.sinfos,i=0;i<n.length;i++){var r=n[i];this._getAttrParamByName(r,"contentType").type=t}},this._setMessageDigestByEContent=function(e){var t=e.econtent,n=(e.econtent.type,t.content.hex);null==n&&"data"==t.type&&null!=t.content.str&&(n=we(t.content.str));for(var i=e.sinfos,r=0;r<i.length;r++){var o=i[r],s=o.hashalg,a=this._getAttrParamByName(o,"messageDigest"),u=ue.crypto.Util.hashHex(n,s);a.hex=u}},this._getAttrParamByName=function(e,t){for(var n=e.sattrs.array,i=0;i<n.length;i++)if(n[i].attr==t)return n[i]},this._setSignerInfoVersion=function(e){for(var t=e.sinfos,n=0;n<t.length;n++){var i=t[n],r=1;"skid"==i.id.type&&(r=3),i.version=r}},this._setSignedDataVersion=function(e){var t=this._getSignedDataVersion(e);e.version=t},this._getSignedDataVersion=function(e){if(null!=e.revinfos)for(var t=e.revinfos,n=0;n<t.length;n++)if(null!=t[n].ocsp)return 5;var i=e.sinfos;for(n=0;n<i.length;n++)if(3==e.sinfos[n].version)return 3;return"data"!=e.econtent.type?3:1},this.tohex=function(){var e=this.params;null!=this.getEncodedHexPrepare&&this.getEncodedHexPrepare(),1!=e.fixed&&this.checkAndFixParam();var t=[];t.push(new n({int:e.version}));for(var o=[],u=0;u<e.hashalgs.length;u++){var h=e.hashalgs[u];o.push(new d({name:h}))}t.push(new i({array:o})),t.push(new s(e.econtent)),null!=e.certs&&t.push(new l(e.certs)),null!=e.revinfos&&t.push(new c(e.revinfos));var p=[];for(u=0;u<e.sinfos.length;u++){var f=e.sinfos[u];p.push(new a(f))}return t.push(new i({array:p})),new r({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){return new u({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.SignedData,ue.asn1.ASN1Object),ue.asn1.cms.CertificateSet=function(e){ue.asn1.cms.CertificateSet.superclass.constructor.call(this);var t=Error,n=ue.asn1,i=n.DERTaggedObject,r=n.DERSet,o=n.ASN1Object;this.params=null,this.tohex=function(){var e,n=this.params,s=[];if(n instanceof Array)e=n;else{if(null==n.array)throw new t("cert array not specified");e=n.array}for(var a=0;a<e.length;a++){var u=Ie(e[a]),l=new o;l.hTLV=u,s.push(l)}var c={array:s};0==n.sortflag&&(c.sortflag=!1);var d=new r(c);return new i({tag:"a0",explicit:!1,obj:d}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.CertificateSet,ue.asn1.ASN1Object),ue.asn1.cms.RevocationInfoChoices=function(e){ue.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(!e instanceof Array)throw new Error("params is not array");for(var t=[],n=0;n<e.length;n++)t.push(new ue.asn1.cms.RevocationInfoChoice(e[n]));return ue.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:t}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.RevocationInfoChoices,ue.asn1.ASN1Object),ue.asn1.cms.RevocationInfoChoice=function(e){ue.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(null!=e.crl&&"string"==typeof e.crl){var t=e.crl;return-1!=e.crl.indexOf("-----BEGIN")&&(t=Ie(e.crl)),t}if(null!=e.ocsp)return ue.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new ue.asn1.cms.OtherRevocationFormat(e)}}).tohex();throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.RevocationInfoChoice,ue.asn1.ASN1Object),ue.asn1.cms.OtherRevocationFormat=function(e){ue.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var t=Error,n=ue,i=n.asn1.ASN1Util.newObject,r=n.lang.String.isHex;this.params=null,this.tohex=function(){var e=this.params;if(null==e.ocsp)throw new t("property ocsp not specified");if(!r(e.ocsp)||!de.isASN1HEX(e.ocsp))throw new t("ocsp value not ASN.1 hex string");return i({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:e.ocsp}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cms.OtherRevocationFormat,ue.asn1.ASN1Object),ue.asn1.cms.CMSUtil=new function(){},ue.asn1.cms.CMSUtil.newSignedData=function(e){return new ue.asn1.cms.SignedData(e)},ue.asn1.cms.CMSUtil.verifySignedData=function(e){var t=ue,n=t.asn1,i=n.cms,r=(i.SignerInfo,i.SignedData,i.SigningTime,i.SigningCertificate,i.SigningCertificateV2,n.cades.SignaturePolicyIdentifier,t.lang.String.isHex),o=de,s=o.getVbyList,a=o.getTLVbyList,u=o.getIdxbyList,l=o.getChildIdx,c=o.getTLV,d=o.oidname,h=t.crypto.Util.hashHex;void 0===e.cms&&r(e.cms);var p=e.cms,f=function(e,t){var n=t.idx;t.signerid_issuer1=a(e,n,[1,0],"30"),t.signerid_serial1=s(e,n,[1,1],"02"),t.hashalg=d(s(e,n,[2,0],"06"));var i=u(e,n,[3],"a0");t.idxSignedAttrs=i,g(e,t,i);var r=l(e,n).length;if(r<6)throw"malformed SignerInfo";t.sigalg=d(s(e,n,[r-2,0],"06")),t.sigval=s(e,n,[r-1],"04")},g=function(e,t,n){var i=l(e,n);t.signedAttrIdxList=i;for(var r=0;r<i.length;r++){var o,a=i[r],u=s(e,a,[0],"06");"2a864886f70d010905"===u?(o=Se(s(e,a,[1,0])),t.saSigningTime=o):"2a864886f70d010904"===u&&(o=s(e,a,[1,0],"04"),t.saMessageDigest=o)}},m=function(e,t,n,i){n.verifyDetail={};var r=n.verifyDetail,o=t.parse.econtent,s=n.hashalg,a=n.saMessageDigest;r.validMessageDigest=!1,h(o,s)===a&&(r.validMessageDigest=!0),function(e,t,n,i){var r,o=t.parse.certsIdx;if(void 0===t.certs){r=[],t.certkeys=[];for(var s=l(e,o),a=0;a<s.length;a++){var u=c(e,s[a]),d=new Qe;d.readCertHex(u),r[a]=d,t.certkeys[a]=d.getPublicKey()}t.certs=r}else r=t.certs;for(t.cccc=r.length,t.cccci=s.length,a=0;a<r.length;a++){var h=d.getIssuerHex(),p=d.getSerialNumberHex();n.signerid_issuer1===h&&n.signerid_serial1===p&&(n.certkey_idx=a)}}(e,t,n),r.validSignatureValue=!1;var u=n.sigalg,d="31"+c(e,n.idxSignedAttrs).substr(2);n.signedattrshex=d;var p=t.certs[n.certkey_idx].getPublicKey(),f=new ue.crypto.Signature({alg:u});f.init(p),f.updateHex(d);var g=f.verify(n.sigval);r.validSignatureValue_isValid=g,!0===g&&(r.validSignatureValue=!0),n.isValid=!1,r.validMessageDigest&&r.validSignatureValue&&(n.isValid=!0)},v={isValid:!1,parse:{}};return function(e,t){if("2a864886f70d010702"!==s(e,0,[0],"06"))return t;t.cmsType="signedData",t.econtent=s(e,0,[1,0,2,1,0]),function(e,t){for(var n,i=3;i<6;i++)if(void 0!==(n=u(e,0,[1,0,i]))){var r=e.substr(n,2);"a0"===r&&(t.certsIdx=n),"a1"===r&&(t.revinfosIdx=n),"31"===r&&(t.signerinfosIdx=n)}}(e,t),t.signerInfos=[],function(e,t){var n=t.signerinfosIdx;if(void 0!==n){var i=l(e,n);t.signerInfoIdxList=i;for(var r=0;r<i.length;r++){var o={idx:i[r]};f(e,o),t.signerInfos.push(o)}}}(e,t)}(p,v.parse),function(e,t){for(var n=t.parse.signerInfos,i=n.length,r=!0,o=0;o<i;o++){var s=n[o];m(e,t,s),s.isValid||(r=!1)}t.isValid=r}(p,v),v},ue.asn1.cms.CMSParser=function(){var e=Error,t=Qe,n=new t,i=de,r=i.getV,o=i.getTLV,s=(i.getIdxbyList,i.getTLVbyList),a=i.getTLVbyListEx,u=i.getVbyList,l=i.getVbyListEx,c=i.getChildIdx;this.getCMSSignedData=function(e){var t=s(e,0,[1,0]);return this.getSignedData(t)},this.getSignedData=function(e){var t=c(e,0),n={},i=r(e,t[0]),s=parseInt(i,16);n.version=s;var u=o(e,t[1]);n.hashalgs=this.getHashAlgArray(u);var l=o(e,t[2]);n.econtent=this.getEContent(l);var d=a(e,0,["[0]"]);null!=d&&(n.certs=this.getCertificateSet(d)),a(e,0,["[1]"]);var h=a(e,0,[3]);return n.sinfos=this.getSignerInfos(h),n},this.getHashAlgArray=function(e){for(var n=c(e,0),i=new t,r=[],s=0;s<n.length;s++){var a=o(e,n[s]),u=i.getAlgorithmIdentifierName(a);r.push(u)}return r},this.getEContent=function(e){var t={},n=u(e,0,[0]),i=u(e,0,[1,0]);return t.type=ue.asn1.x509.OID.oid2name(de.hextooidstr(n)),t.content={hex:i},t},this.getSignerInfos=function(e){for(var t=[],n=c(e,0),i=0;i<n.length;i++){var r=o(e,n[i]),s=this.getSignerInfo(r);t.push(s)}return t},this.getSignerInfo=function(e){var t={},r=c(e,0),s=i.getInt(e,r[0],-1);-1!=s&&(t.version=s);var u=o(e,r[1]),d=this.getIssuerAndSerialNumber(u);t.id=d;var h=o(e,r[2]),p=n.getAlgorithmIdentifierName(h);t.hashalg=p;var f=a(e,0,["[0]"]);if(null!=f){var g=this.getAttributeList(f);t.sattrs=g}var m=a(e,0,[3]),v=n.getAlgorithmIdentifierName(m);t.sigalg=v;var y=l(e,0,[4]);t.sighex=y;var S=a(e,0,["[1]"]);if(null!=S){var b=this.getAttributeList(S);t.uattrs=b}return t},this.getSignerIdentifier=function(e){if("30"==e.substr(0,2))return this.getIssuerAndSerialNumber(e);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(e){var t={type:"isssn"},i=c(e,0),s=o(e,i[0]);t.issuer=n.getX500Name(s);var a=r(e,i[1]);return t.serial={hex:a},t},this.getAttributeList=function(e){for(var t=[],n=c(e,0),i=0;i<n.length;i++){var r=o(e,n[i]),s=this.getAttribute(r);t.push(s)}return{array:t}},this.getAttribute=function(e){var t={},n=c(e,0),r=i.getOID(e,n[0]),s=ue.asn1.x509.OID.oid2name(r);t.attr=s;var a=o(e,n[1]),u=c(a,0);if(1==u.length)t.valhex=o(a,u[0]);else{for(var l=[],d=0;d<u.length;d++)l.push(o(a,u[d]));t.valhex=l}return"contentType"==s?this.setContentType(t):"messageDigest"==s?this.setMessageDigest(t):"signingTime"==s?this.setSigningTime(t):"signingCertificate"==s?this.setSigningCertificate(t):"signingCertificateV2"==s?this.setSigningCertificateV2(t):"signaturePolicyIdentifier"==s&&this.setSignaturePolicyIdentifier(t),t},this.setContentType=function(e){var t=i.getOIDName(e.valhex,0,null);null!=t&&(e.type=t,delete e.valhex)},this.setSigningTime=function(e){var t=Se(r(e.valhex,0));e.str=t,delete e.valhex},this.setMessageDigest=function(e){var t=r(e.valhex,0);e.hex=t,delete e.valhex},this.setSigningCertificate=function(e){var t=c(e.valhex,0);if(t.length>0){for(var n=o(e.valhex,t[0]),i=c(n,0),r=[],s=0;s<i.length;s++){var a=o(n,i[s]),u=this.getESSCertID(a);r.push(u)}e.array=r}if(t.length>1){var l=o(e.valhex,t[1]);e.polhex=l}delete e.valhex},this.setSignaturePolicyIdentifier=function(e){var n=c(e.valhex,0);if(n.length>0){var s=i.getOID(e.valhex,n[0]);e.oid=s}if(n.length>1){var a=new t,u=c(e.valhex,n[1]),l=o(e.valhex,u[0]),d=a.getAlgorithmIdentifierName(l);e.alg=d;var h=r(e.valhex,u[1]);e.hash=h}delete e.valhex},this.setSigningCertificateV2=function(e){var t=c(e.valhex,0);if(t.length>0){for(var n=o(e.valhex,t[0]),i=c(n,0),r=[],s=0;s<i.length;s++){var a=o(n,i[s]),u=this.getESSCertIDv2(a);r.push(u)}e.array=r}if(t.length>1){var l=o(e.valhex,t[1]);e.polhex=l}delete e.valhex},this.getESSCertID=function(e){var t={},n=c(e,0);if(n.length>0){var i=r(e,n[0]);t.hash=i}if(n.length>1){var s=o(e,n[1]),a=this.getIssuerSerial(s);null!=a.serial&&(t.serial=a.serial),null!=a.issuer&&(t.issuer=a.issuer)}return t},this.getESSCertIDv2=function(t){var i={},s=c(t,0);if(s.length<1||3<s.length)throw new e("wrong number of elements");var a=0;if("30"==t.substr(s[0],2)){var u=o(t,s[0]);i.alg=n.getAlgorithmIdentifierName(u),a++}else i.alg="sha256";var l=r(t,s[a]);if(i.hash=l,s.length>a+1){var d=o(t,s[a+1]),h=this.getIssuerSerial(d);i.issuer=h.issuer,i.serial=h.serial}return i},this.getIssuerSerial=function(e){var t={},i=c(e,0),s=o(e,i[0]),a=n.getGeneralNames(s)[0].dn;t.issuer=a;var u=r(e,i[1]);return t.serial={hex:u},t},this.getCertificateSet=function(e){for(var t=c(e,0),n=[],i=0;i<t.length;i++){var r=o(e,t[i]);if("30"==r.substr(0,2)){var s=_e(r,"CERTIFICATE");n.push(s)}}return{array:n,sortflag:!1}}},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.tsp&&ue.asn1.tsp||(ue.asn1.tsp={}),ue.asn1.tsp.TimeStampToken=function(e){var t=ue.asn1.tsp;t.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var e=new t.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=e.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.TimeStampToken,ue.asn1.cms.SignedData),ue.asn1.tsp.TSTInfo=function(e){Error;var t=ue.asn1,n=t.DERSequence,i=t.DERInteger,r=t.DERBoolean,o=t.DERGeneralizedTime,s=t.DERObjectIdentifier,a=t.DERTaggedObject,u=t.tsp,l=u.MessageImprint,c=u.Accuracy,d=(t.x509.X500Name,t.x509.GeneralName);if(u.TSTInfo.superclass.constructor.call(this),this.dVersion=new i({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var e=[this.dVersion];if(null==this.dPolicy)throw new Error("policy shall be specified.");if(e.push(this.dPolicy),null==this.dMessageImprint)throw new Error("messageImprint shall be specified.");if(e.push(this.dMessageImprint),null==this.dSerial)throw new Error("serialNumber shall be specified.");if(e.push(this.dSerial),null==this.dGenTime)throw new Error("genTime shall be specified.");e.push(this.dGenTime),null!=this.dAccuracy&&e.push(this.dAccuracy),null!=this.dOrdering&&e.push(this.dOrdering),null!=this.dNonce&&e.push(this.dNonce),null!=this.dTsa&&e.push(this.dTsa);var t=new n({array:e});return this.hTLV=t.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e){if("string"==typeof e.policy){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new s({oid:e.policy})}void 0!==e.messageImprint&&(this.dMessageImprint=new l(e.messageImprint)),void 0!==e.serial&&(this.dSerial=new i(e.serial)),void 0!==e.genTime&&(this.dGenTime=new o(e.genTime)),void 0!==e.accuracy&&(this.dAccuracy=new c(e.accuracy)),void 0!==e.ordering&&1==e.ordering&&(this.dOrdering=new r),void 0!==e.nonce&&(this.dNonce=new i(e.nonce)),void 0!==e.tsa&&(this.dTsa=new a({tag:"a0",explicit:!0,obj:new d({dn:e.tsa})}))}},$e(ue.asn1.tsp.TSTInfo,ue.asn1.ASN1Object),ue.asn1.tsp.Accuracy=function(e){var t=ue.asn1,n=t.ASN1Util.newObject;t.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];return null!=e.seconds&&"number"==typeof e.seconds&&t.push({int:e.seconds}),null!=e.millis&&"number"==typeof e.millis&&t.push({tag:{tagi:"80",obj:{int:e.millis}}}),null!=e.micros&&"number"==typeof e.micros&&t.push({tag:{tagi:"81",obj:{int:e.micros}}}),n({seq:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.Accuracy,ue.asn1.ASN1Object),ue.asn1.tsp.MessageImprint=function(e){var t=ue.asn1,n=t.DERSequence,i=t.DEROctetString,r=t.x509.AlgorithmIdentifier;t.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=new r({name:e.alg}),o=new i({hex:e.hash});return new n({array:[t,o]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.tsp.MessageImprint,ue.asn1.ASN1Object),ue.asn1.tsp.TimeStampReq=function(e){var t=ue.asn1,n=t.DERSequence,i=t.DERInteger,r=t.DERBoolean,o=(t.ASN1Object,t.DERObjectIdentifier),s=t.tsp,a=s.MessageImprint;s.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];return t.push(new i({int:1})),e.messageImprint instanceof ue.asn1.ASN1Object?t.push(e.messageImprint):t.push(new a(e.messageImprint)),null!=e.policy&&t.push(new o(e.policy)),null!=e.nonce&&t.push(new i(e.nonce)),1==e.certreq&&t.push(new r),new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.TimeStampReq,ue.asn1.ASN1Object),ue.asn1.tsp.TimeStampResp=function(e){var t=ue.asn1,n=t.DERSequence,i=(t.ASN1Object,t.tsp),r=i.PKIStatusInfo;i.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,o=[];if(null!=e.econtent||null!=e.tst)if(null!=e.statusinfo?o.push(new r(e.statusinfo)):o.push(new r("granted")),null!=e.econtent)o.push(new i.TimeStampToken(e).getContentInfo());else{if(!(e.tst instanceof t.ASN1Object))throw new Error("improper member tst value");o.push(e.tst)}else{if(null==e.statusinfo)throw new Error("parameter for token nor statusinfo not specified");o.push(new r(e.statusinfo))}return new n({array:o}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.TimeStampResp,ue.asn1.ASN1Object),ue.asn1.tsp.PKIStatusInfo=function(e){var t=Error,n=ue.asn1,i=n.DERSequence,r=n.tsp,o=r.PKIStatus,s=r.PKIFreeText,a=r.PKIFailureInfo;r.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,n=[];if("string"==typeof e)n.push(new o(e));else{if(null==e.status)throw new t("property 'status' unspecified");n.push(new o(e.status)),null!=e.statusstr&&n.push(new s(e.statusstr)),null!=e.failinfo&&n.push(new a(e.failinfo))}return new i({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.PKIStatusInfo,ue.asn1.ASN1Object),ue.asn1.tsp.PKIStatus=function(e){var t=Error,n=ue.asn1,i=n.DERInteger;n.tsp.PKIStatus.superclass.constructor.call(this);var r={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var e,n=this.params;if("string"==typeof n)try{e=r[n]}catch(e){throw new t("undefined name: "+n)}else{if("number"!=typeof n)throw new t("unsupported params");e=n}return new i({int:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.PKIStatus,ue.asn1.ASN1Object),ue.asn1.tsp.PKIFreeText=function(e){var t=Error,n=ue.asn1,i=n.DERSequence,r=n.DERUTF8String;n.tsp.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(!e instanceof Array)throw new t("wrong params: not array");for(var n=[],o=0;o<e.length;o++)n.push(new r({str:e[o]}));return new i({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.PKIFreeText,ue.asn1.ASN1Object),ue.asn1.tsp.PKIFailureInfo=function(e){var t=Error,n=ue.asn1,i=n.DERBitString,r=n.tsp.PKIFailureInfo,o={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};r.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var e=this.params,n=0;if("number"==typeof e&&0<=e&&e<=25){for(var i=(n|=1<<e).toString(2),r="",s=i.length-1;s>=0;s--)r+=i[s];return r}if("string"==typeof e&&null!=o[e])return qe([e],o);if("object"==typeof e&&null!=e.length)return qe(e,o);throw new t("wrong params")},this.tohex=function(){this.params;var e=this.getBinValue();return new i({bin:e}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.tsp.PKIFailureInfo,ue.asn1.ASN1Object),ue.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(e,t){throw"not implemented yet"}},ue.asn1.tsp.SimpleTSAAdapter=function(e){var t=ue,n=t.asn1.tsp,i=t.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(e,t){var r=i(e,t);this.params.econtent.content.messageImprint={alg:t,hash:r},this.params.econtent.content.serial={int:this.serial++};var o=Math.floor(1e9*Math.random());return this.params.econtent.content.nonce={int:o},new n.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},$e(ue.asn1.tsp.SimpleTSAAdapter,ue.asn1.tsp.AbstractTSAAdapter),ue.asn1.tsp.FixedTSAAdapter=function(e){var t=ue,n=t.asn1.tsp,i=t.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(e,t){var r=i(e,t);return this.params.econtent.content.messageImprint={alg:t,hash:r},new n.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},$e(ue.asn1.tsp.FixedTSAAdapter,ue.asn1.tsp.AbstractTSAAdapter),ue.asn1.tsp.TSPUtil=new function(){},ue.asn1.tsp.TSPUtil.newTimeStampToken=function(e){return new ue.asn1.tsp.TimeStampToken(e)},ue.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){return(new ue.asn1.tsp.TSPParser).getTimeStampReq(e)},ue.asn1.tsp.TSPUtil.parseMessageImprint=function(e){return(new ue.asn1.tsp.TSPParser).getMessageImprint(e)},ue.asn1.tsp.TSPParser=function(){Error;var e=new Qe,t=de,n=t.getV,i=t.getTLV,r=t.getIdxbyList,o=(t.getTLVbyListEx,t.getChildIdx),s=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],a={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(e){var t=o(e,0);if(1==t.length)return this.getPKIStatusInfo(i(e,t[0]));if(t.length>1){var n=this.getPKIStatusInfo(i(e,t[0])),r=i(e,t[1]),s=this.getToken(r);return s.statusinfo=n,s}},this.getToken=function(e){var t=(new ue.asn1.cms.CMSParser).getCMSSignedData(e);return this.setTSTInfo(t),t},this.setTSTInfo=function(e){var t=e.econtent;if("tstinfo"==t.type){var n=t.content.hex,i=this.getTSTInfo(n);t.content=i}},this.getTSTInfo=function(t){var r={},s=o(t,0),a=n(t,s[1]);r.policy=je(a);var u=i(t,s[2]);r.messageImprint=this.getMessageImprint(u);var l=n(t,s[3]);r.serial={hex:l};var c=n(t,s[4]);r.genTime={str:Se(c)};var d=0;if(s.length>5&&"30"==t.substr(s[5],2)){var h=i(t,s[5]);r.accuracy=this.getAccuracy(h),d++}if(s.length>5+d&&"01"==t.substr(s[5+d],2)&&("ff"==n(t,s[5+d])&&(r.ordering=!0),d++),s.length>5+d&&"02"==t.substr(s[5+d],2)){var p=n(t,s[5+d]);r.nonce={hex:p},d++}if(s.length>5+d&&"a0"==t.substr(s[5+d],2)){var f=i(t,s[5+d]);f="30"+f.substr(2),pGeneralNames=e.getGeneralNames(f);var g=pGeneralNames[0].dn;r.tsa=g,d++}if(s.length>5+d&&"a1"==t.substr(s[5+d],2)){var m=i(t,s[5+d]);m="30"+m.substr(2);var v=e.getExtParamArray(m);r.ext=v,d++}return r},this.getAccuracy=function(e){for(var t={},i=o(e,0),r=0;r<i.length;r++){var s=e.substr(i[r],2),a=n(e,i[r]),u=parseInt(a,16);"02"==s?t.seconds=u:"80"==s?t.millis=u:"81"==s&&(t.micros=u)}return t},this.getMessageImprint=function(e){if("30"!=e.substr(0,2))throw new Error("head of messageImprint hex shall be x30");var i={},s=(o(e,0),r(e,0,[0,0])),a=n(e,s),u=t.hextooidstr(a),l=ue.asn1.x509.OID.oid2name(u);if(""==l)throw new Error("hashAlg name undefined: "+u);var c=l,d=r(e,0,[1]);return i.alg=c,i.hash=n(e,d),i},this.getPKIStatusInfo=function(e){var t={},r=o(e,0),a=0;try{var u=n(e,r[0]),l=parseInt(u,16);t.status=s[l]}catch(e){}if(r.length>1&&"30"==e.substr(r[1],2)){var c=i(e,r[1]);t.statusstr=this.getPKIFreeText(c),a++}if(r.length>a&&"03"==e.substr(r[1+a],2)){var d=i(e,r[1+a]);t.failinfo=this.getPKIFailureInfo(d)}return t},this.getPKIFreeText=function(e){for(var n=[],i=o(e,0),r=0;r<i.length;r++)n.push(t.getString(e,i[r]));return n},this.getPKIFailureInfo=function(e){var n=t.getInt(e,0);return null!=a[n]?a[n]:n},this.getTimeStampReq=function(e){var r={certreq:!1},s=o(e,0);if(s.length<2)throw new Error("TimeStampReq must have at least 2 items");var a=i(e,s[1]);r.messageImprint=ue.asn1.tsp.TSPUtil.parseMessageImprint(a);for(var u=2;u<s.length;u++){var l=s[u],c=e.substr(l,2);if("06"==c){var d=n(e,l);r.policy=t.hextooidstr(d)}"02"==c&&(r.nonce=n(e,l)),"01"==c&&(r.certreq=!0)}return r}},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.cades&&ue.asn1.cades||(ue.asn1.cades={}),ue.asn1.cades.SignaturePolicyIdentifier=function(e){var t=ue.asn1.cades,n=t.SignaturePolicyId;t.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new n(this.params)]},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.SignaturePolicyIdentifier,ue.asn1.cms.Attribute),ue.asn1.cades.SignaturePolicyId=function(e){var t=ue.asn1,n=t.DERSequence,i=t.DERObjectIdentifier,r=(t.x509.AlgorithmIdentifier,t.cades),o=r.SignaturePolicyId,s=r.OtherHashAlgAndValue;o.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,t=[];return t.push(new i(e.oid)),t.push(new s(e)),new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.SignaturePolicyId,ue.asn1.ASN1Object),ue.asn1.cades.OtherHashAlgAndValue=function(e){var t=Error,n=ue.asn1,i=n.DERSequence,r=n.DEROctetString,o=n.x509.AlgorithmIdentifier;n.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if(null==e.alg)throw new t("property 'alg' not specified");if(null==e.hash&&null==e.cert)throw new t("property 'hash' nor 'cert' not specified");var n=null;if(null!=e.hash)n=e.hash;else if(null!=e.cert){if("string"!=typeof e.cert)throw new t("cert not string");var s=e.cert;-1!=e.cert.indexOf("-----BEGIN")&&(s=Ie(e.cert)),n=ue.crypto.Util.hashHex(s,e.alg)}var a=[];return a.push(new o({name:e.alg})),a.push(new r({hex:n})),new i({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.OtherHashAlgAndValue,ue.asn1.ASN1Object),ue.asn1.cades.OtherHashValue=function(e){ue.asn1.cades.OtherHashValue.superclass.constructor.call(this);var t=Error,n=ue,i=(n.lang.String.isHex,n.asn1.DEROctetString);n.crypto.Util.hashHex,this.params=null,this.tohex=function(){var e=this.params;if(null==e.hash&&null==e.cert)throw new t("hash or cert not specified");var n=null;if(null!=e.hash)n=e.hash;else if(null!=e.cert){if("string"!=typeof e.cert)throw new t("cert not string");var r=e.cert;-1!=e.cert.indexOf("-----BEGIN")&&(r=Ie(e.cert)),n=ue.crypto.Util.hashHex(r,"sha1")}return new i({hex:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.OtherHashValue,ue.asn1.ASN1Object),ue.asn1.cades.SignatureTimeStamp=function(e){var t=Error,n=ue,i=n.lang.String.isHex,r=n.asn1,o=r.ASN1Object;r.x509,r.cades.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var e=this.params;if(null!=e.tst){if(i(e.tst))return(n=new o).hTLV=e.tst,[n];if(e.tst instanceof o)return[e.tst];throw new t("params.tst has wrong value")}if(null!=e.res){var n,r=e.res;if(r instanceof o&&(r=r.tohex()),"string"!=typeof r||!i(r))throw new t("params.res has wrong value");return de.getTLVbyList(r,0,[1]),(n=new o).hTLV=e.tst,[n]}},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.SignatureTimeStamp,ue.asn1.cms.Attribute),ue.asn1.cades.CompleteCertificateRefs=function(e){var t=Error,n=ue,i=n.asn1,r=i.DERSequence,o=i.cades,s=o.OtherCertID,a=n.lang.String.isHex;o.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var e=this.params,n=[],i=0;i<e.array.length;i++){var o=e.array[i];if("string"==typeof o)if(-1!=o.indexOf("-----BEGIN"))o={cert:o};else{if(!a(o))throw new t("unsupported value: "+o);o={hash:o}}null!=e.alg&&null==o.alg&&(o.alg=e.alg),null!=e.hasis&&null==o.hasis&&(o.hasis=e.hasis);var u=new s(o);n.push(u)}return[new r({array:n})]},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.CompleteCertificateRefs,ue.asn1.cms.Attribute),ue.asn1.cades.OtherCertID=function(e){var t=ue.asn1,n=t.DERSequence,i=t.cms.IssuerSerial,r=t.cades,o=r.OtherHashValue,s=r.OtherHashAlgAndValue;r.OtherCertID.superclass.constructor.call(this),this.params=e,this.tohex=function(){var e=this.params;"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?e={cert:e}:_isHex(e)&&(e={hash:e}));var t,r=[];if(t=null!=e.alg?new s(e):new o(e),r.push(t),null!=e.cert&&1==e.hasis||null!=e.issuer&&null!=e.serial){var a=new i(e);r.push(a)}return new n({array:r}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.OtherCertID,ue.asn1.ASN1Object),ue.asn1.cades.OtherHash=function(e){Error;var t=ue,n=t.asn1,i=(n.cms,n.cades),r=i.OtherHashAlgAndValue,o=i.OtherHashValue,s=(t.crypto.Util.hashHex,t.lang.String.isHex);i.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;return"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?e={cert:e}:s(e)&&(e={hash:e})),(null!=e.alg?new r(e):new o(e)).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.cades.OtherHash,ue.asn1.ASN1Object),ue.asn1.cades.CAdESUtil=new function(){},ue.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){return(new ue.asn1.cms.CMSParser).getCMSSignedData(e)},ue.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,n){var i=de,r=i.getChildIdx,o=i.getTLV,s=i.getV,a=ue.asn1,u=a.ASN1Object,l=a.cms,c=l.AttributeList,d=l.SignerInfo,h={},p=r(e,t);if(6!=p.length)throw"not supported items for SignerInfo (!=6)";var f=p.shift();h.version=o(e,f);var g=p.shift();h.si=o(e,g);var m=p.shift();h.digalg=o(e,m);var v=p.shift();h.sattrs=o(e,v);var y=p.shift();h.sigalg=o(e,y);var S=p.shift();h.sig=o(e,S),h.sigval=s(e,S);var b=null;return h.obj=new d,(b=new u).hTLV=h.version,h.obj.dCMSVersion=b,(b=new u).hTLV=h.si,h.obj.dSignerIdentifier=b,(b=new u).hTLV=h.digalg,h.obj.dDigestAlgorithm=b,(b=new u).hTLV=h.sattrs,h.obj.dSignedAttrs=b,(b=new u).hTLV=h.sigalg,h.obj.dSigAlg=b,(b=new u).hTLV=h.sig,h.obj.dSig=b,h.obj.dUnsignedAttrs=new c,h},void 0!==ue.asn1.csr&&ue.asn1.csr||(ue.asn1.csr={}),ue.asn1.csr.CertificationRequest=function(e){var t=ue.asn1,n=t.DERBitString,i=t.DERSequence,r=t.csr,o=(t.x509,r.CertificationRequestInfo);r.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(e){this.params=e},this.sign=function(){var e=new o(this.params).tohex(),t=new ue.crypto.Signature({alg:this.params.sigalg});t.init(this.params.sbjprvkey),t.updateHex(e);var n=t.sign();this.params.sighex=n},this.getPEM=function(){return _e(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var e=this.params,t=new ue.asn1.csr.CertificationRequestInfo(this.params),r=new ue.asn1.x509.AlgorithmIdentifier({name:e.sigalg});if(null==e.sighex&&null!=e.sbjprvkey&&this.sign(),null==e.sighex)throw new Error("sighex or sbjprvkey parameter not defined");var o=new n({hex:"00"+e.sighex});return new i({array:[t,r,o]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.csr.CertificationRequest,ue.asn1.ASN1Object),ue.asn1.csr.CertificationRequestInfo=function(e){var t=ue.asn1,n=(t.DERBitString,t.DERSequence),i=t.DERInteger,r=t.DERUTF8String,o=t.DERTaggedObject,s=t.ASN1Util.newObject,a=t.csr,u=t.x509,l=u.X500Name,c=u.Extensions,d=u.SubjectPublicKeyInfo;a.AttributeList,a.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(e){null!=e&&(this.params=e)},this.tohex=function(){var e=this.params,t=[];if(t.push(new i({int:0})),t.push(new l(e.subject)),t.push(new d(We.getKey(e.sbjpubkey))),null!=e.attrs){var a=function(e){for(var t=Error,n=ue.asn1.x509.Extensions,i=[],r=0;r<e.length;r++){var o=e[r],s=o.attr;if("extensionRequest"==s){var a={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[new n(o.ext)]}]};i.push(a)}else if("unstructuredName"==s)a={seq:[{oid:"1.2.840.113549.1.9.2"},{set:o.names}]},i.push(a);else{if("challengePassword"!=s)throw new t("unknown CSR attribute");a={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:o.password}]}]},i.push(a)}}return{set:i}}(e.attrs),u=s({tag:{tage:"a0",obj:a}});t.push(u)}else if(null!=e.extreq){var h=new c(e.extreq);u=s({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[h]}]}}}),t.push(u)}else t.push(new o({tag:"a0",explicit:!1,obj:new r({str:""})}));return new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},null!=e&&this.setByParam(e)},$e(ue.asn1.csr.CertificationRequestInfo,ue.asn1.ASN1Object),ue.asn1.csr.AttributeList=function(e){},$e(ue.asn1.csr.AttributeList,ue.asn1.ASN1Object),ue.asn1.csr.CSRUtil=new function(){},ue.asn1.csr.CSRUtil.newCSRPEM=function(e){return new ue.asn1.csr.CertificationRequest(e).getPEM()},ue.asn1.csr.CSRUtil.getParam=function(e,t){var n=de,i=n.getV,r=n.getIdxbyList,o=n.getTLVbyList,s=n.getTLVbyListEx,a=n.getVbyListEx,u={};if(-1==e.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw new Error("argument is not PEM file");var l=Ie(e,"CERTIFICATE REQUEST");t&&(u.tbs=o(l,0,[0]));try{var c=s(l,0,[0,1]);if("3000"==c)u.subject={};else{var d=new Qe;u.subject=d.getX500Name(c)}}catch(e){}var h=s(l,0,[0,2]),p=We.getKey(h,null,"pkcs8pub");u.sbjpubkey=We.getPEM(p,"PKCS8PUB");var f=function(e){var t=r(e,0,[0,3,0,0],"06");return"2a864886f70d01090e"!=i(e,t)?null:o(e,0,[0,3,0,1,0],"30")}(l);d=new Qe,null!=f&&(u.extreq=d.getExtParamArray(f));try{var g=s(l,0,[1],"30");d=new Qe,u.sigalg=d.getAlgorithmIdentifierName(g)}catch(e){}try{var m=a(l,0,[2]);u.sighex=m}catch(e){}return u},ue.asn1.csr.CSRUtil.verifySignature=function(e){try{var t=null;if("string"==typeof e&&-1!=e.indexOf("-----BEGIN CERTIFICATE REQUEST")?t=ue.asn1.csr.CSRUtil.getParam(e,!0):"object"==typeof e&&null!=e.sbjpubkey&&null!=e.sigalg&&null!=e.sighex&&null!=e.tbs&&(t=e),null==t)return!1;var n=new ue.crypto.Signature({alg:t.sigalg});return n.init(t.sbjpubkey),n.updateHex(t.tbs),n.verify(t.sighex)}catch(e){return alert(e),!1}},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.ocsp&&ue.asn1.ocsp||(ue.asn1.ocsp={}),ue.asn1.ocsp.DEFAULT_HASH="sha1",ue.asn1.ocsp.OCSPResponse=function(e){ue.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),ue.asn1.DEREnumerated;var t=ue.asn1.ASN1Util.newObject,n=ue.asn1.ocsp.ResponseBytes,i=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var e=this.params.resstatus;return"number"==typeof e?e:"string"!=typeof e?-1:i.indexOf(e)},this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params,i=this._getStatusCode();if(-1==i)throw new Error("responseStatus not supported: "+e.resstatus);if(0!=i)return t({seq:[{enum:{int:i}}]}).tohex();var r=new n(e);return t({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:r}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.OCSPResponse,ue.asn1.ASN1Object),ue.asn1.ocsp.ResponseBytes=function(e){ue.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var t=ue.asn1,n=t.DERSequence,i=t.DERObjectIdentifier,r=t.DEROctetString,o=t.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(e){this.params=e},this.tohex=function(){var e=this.params;if("ocspBasic"!=e.restype)throw new Error("not supported responseType: "+e.restype);var t=new o(e),s=[];return s.push(new i({name:"ocspBasic"})),s.push(new r({hex:t.tohex()})),new n({array:s}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.ResponseBytes,ue.asn1.ASN1Object),ue.asn1.ocsp.BasicOCSPResponse=function(e){ue.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var t=Error,n=ue.asn1,i=n.ASN1Object,r=n.DERSequence,o=(n.DERGeneralizedTime,n.DERTaggedObject),s=n.DERBitString,a=(n.x509.Extensions,n.x509.AlgorithmIdentifier),u=n.ocsp;u.ResponderID,_SingleResponseList=u.SingleResponseList,_ResponseData=u.ResponseData,this.params=null,this.setByParam=function(e){this.params=e},this.sign=function(){var e=this.params,t=e.tbsresp.tohex(),n=new ue.crypto.Signature({alg:e.sigalg});n.init(e.reskey),n.updateHex(t),e.sighex=n.sign()},this.tohex=function(){var e=this.params;null==e.tbsresp&&(e.tbsresp=new _ResponseData(e)),null==e.sighex&&null!=e.reskey&&this.sign();var n=[];if(n.push(e.tbsresp),n.push(new a({name:e.sigalg})),n.push(new s({hex:"00"+e.sighex})),null!=e.certs&&null!=e.certs.length){for(var u=[],l=0;l<e.certs.length;l++){var c=e.certs[l],d=null;if(de.isASN1HEX(c))d=c;else{if(!c.match(/-----BEGIN/))throw new t("certs["+l+"] not hex or PEM");d=Ie(c)}u.push(new i({tlv:d}))}var h=new r({array:u});n.push(new o({tag:"a0",explicit:!0,obj:h}))}return new r({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.BasicOCSPResponse,ue.asn1.ASN1Object),ue.asn1.ocsp.ResponseData=function(e){ue.asn1.ocsp.ResponseData.superclass.constructor.call(this);var t=Error,n=ue.asn1,i=n.DERSequence,r=n.DERGeneralizedTime,o=n.DERTaggedObject,s=n.x509.Extensions,a=n.ocsp,u=a.ResponderID;_SingleResponseList=a.SingleResponseList,this.params=null,this.tohex=function(){var e=this.params;null!=e.respid&&new t("respid not specified"),null!=e.prodat&&new t("prodat not specified"),null!=e.array&&new t("array not specified");var n=[];if(n.push(new u(e.respid)),n.push(new r(e.prodat)),n.push(new _SingleResponseList(e.array)),null!=e.ext){var a=new s(e.ext);n.push(new o({tag:"a1",explicit:!0,obj:a}))}return new i({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.ResponseData,ue.asn1.ASN1Object),ue.asn1.ocsp.ResponderID=function(e){ue.asn1.ocsp.ResponderID.superclass.constructor.call(this);var t=ue,n=t.asn1,i=n.ASN1Util.newObject,r=n.x509.X500Name,o=t.lang.String.isHex,s=Error;this.params=null,this.tohex=function(){var e=this.params;if(null!=e.key){var t,n=null;if("string"==typeof e.key?(o(e.key)&&(n=e.key),e.key.match(/-----BEGIN CERTIFICATE/)&&null!=(t=new Qe(e.key).getExtSubjectKeyIdentifier())&&(n=t.kid.hex)):e.key instanceof Qe&&null!=(t=e.key.getExtSubjectKeyIdentifier())&&(n=t.kid.hex),null==n)throw new s("wrong key member value");return i({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:n}}}}).tohex()}if(null!=e.name){var a=null;if("string"==typeof e.name&&e.name.match(/-----BEGIN CERTIFICATE/)?a=new Qe(e.name).getSubject():e.name instanceof Qe?a=e.name.getSubject():"object"!=typeof e.name||null==e.name.array&&null==e.name.str||(a=e.name),null==a)throw new s("wrong name member value");return i({tag:{tag:"a1",explicit:!0,obj:new r(a)}}).tohex()}throw new s("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.ResponderID,ue.asn1.ASN1Object),ue.asn1.ocsp.SingleResponseList=function(e){ue.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var t=ue.asn1,n=t.DERSequence,i=t.ocsp.SingleResponse;this.params=null,this.tohex=function(){var e=this.params;if("object"!=typeof e||null==e.length)throw new Error("params not specified properly");for(var t=[],r=0;r<e.length;r++)t.push(new i(e[r]));return new n({array:t}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.SingleResponseList,ue.asn1.ASN1Object),ue.asn1.ocsp.SingleResponse=function(e){var t=Error,n=ue.asn1,i=n.DERSequence,r=n.DERGeneralizedTime,o=n.DERTaggedObject,s=n.ocsp,a=s.CertID,u=s.CertStatus,l=n.x509.Extensions;s.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params,n=[];if(null==e.certid)throw new t("certid unspecified");if(null==e.status)throw new t("status unspecified");if(null==e.thisupdate)throw new t("thisupdate unspecified");if(n.push(new a(e.certid)),n.push(new u(e.status)),n.push(new r(e.thisupdate)),null!=e.nextupdate){var s=new r(e.nextupdate);n.push(new o({tag:"a0",explicit:!0,obj:s}))}if(null!=e.ext){var c=new l(e.ext);n.push(new o({tag:"a1",explicit:!0,obj:c}))}return new i({array:n}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.SingleResponse,ue.asn1.ASN1Object),ue.asn1.ocsp.CertID=function(e){var t=ue,n=t.asn1,i=n.DEROctetString,r=n.DERInteger,o=n.DERSequence,s=n.x509.AlgorithmIdentifier,a=n.ocsp,u=(a.DEFAULT_HASH,t.crypto.Util.hashHex),l=Qe,c=de.getVbyList;a.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(e,t,n,i){null==i&&(i=this.DEFAULT_HASH),this.params={alg:i,issname:e,isskey:t,sbjsn:n}},this.setByCert=function(e,t,n){null==n&&(n=this.DEFAULT_HASH),this.params={alg:n,issuerCert:e,subjectCert:t}},this.getParamByCerts=function(e,t,n){null==n&&(n=this.DEFAULT_HASH);var i=new l(e),r=new l(t),o=u(i.getSubjectHex(),n),s=i.getPublicKeyHex();return{alg:n,issname:o,isskey:u(c(s,0,[1],"03",!0),n),sbjsn:r.getSerialNumberHex()}},this.tohex=function(){if("object"!=typeof this.params)throw new Error("params not set");var e,t,n,a,u=this.params;if(a=null==u.alg?this.DEFAULT_HASH:u.alg,null!=u.issuerCert&&null!=u.subjectCert){var l=this.getParamByCerts(u.issuerCert,u.subjectCert,a);e=l.issname,t=l.isskey,n=l.sbjsn}else{if(null==u.issname||null==u.isskey||null==u.sbjsn)throw new Error("required param members not defined");e=u.issname,t=u.isskey,n=u.sbjsn}var c=new s({name:a}),d=new i({hex:e}),h=new i({hex:t}),p=new r({hex:n}),f=new o({array:[c,d,h,p]});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.CertID,ue.asn1.ASN1Object),ue.asn1.ocsp.CertStatus=function(e){ue.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var e=this.params;if("good"==e.status)return"8000";if("unknown"==e.status)return"8200";if("revoked"==e.status){var t=[{gentime:{str:e.time}}];null!=e.reason&&t.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:e.reason}}}});var n={tag:"a1",explicit:!1,obj:{seq:t}};return ue.asn1.ASN1Util.newObject({tag:n}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},$e(ue.asn1.ocsp.CertStatus,ue.asn1.ASN1Object),ue.asn1.ocsp.Request=function(e){var t=ue.asn1,n=t.DERSequence,i=t.ocsp;if(i.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var e=[];if(null===this.dReqCert)throw"reqCert not set";e.push(this.dReqCert);var t=new n({array:e});return this.hTLV=t.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e){var r=new i.CertID(e);this.dReqCert=r}},$e(ue.asn1.ocsp.Request,ue.asn1.ASN1Object),ue.asn1.ocsp.TBSRequest=function(e){var t=ue.asn1,n=t.DERSequence,i=t.ocsp;i.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(e){for(var t=[],n=0;n<e.length;n++){var r=new i.Request(e[0]);t.push(r)}this.dRequestList=t},this.tohex=function(){var e=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var t=new n({array:this.dRequestList});if(e.push(t),null!==this.dRequestExt)throw"requestExtensions not supported";var i=new n({array:e});return this.hTLV=i.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&void 0!==e.reqList&&this.setRequestListByParam(e.reqList)},$e(ue.asn1.ocsp.TBSRequest,ue.asn1.ASN1Object),ue.asn1.ocsp.OCSPRequest=function(e){var t=ue.asn1,n=t.DERSequence,i=t.ocsp;if(i.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var e=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(e.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var t=new n({array:e});return this.hTLV=t.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==e&&void 0!==e.reqList){var r=new i.TBSRequest(e);this.dTbsRequest=r}},$e(ue.asn1.ocsp.OCSPRequest,ue.asn1.ASN1Object),ue.asn1.ocsp.OCSPUtil={},ue.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,n){var i=ue.asn1.ocsp;void 0===n&&(n=i.DEFAULT_HASH);var r={alg:n,issuerCert:e,subjectCert:t};return new i.OCSPRequest({reqList:[r]}).tohex()},ue.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=de,n=t.getVbyList,i=t.getVbyListEx,r=t.getIdxbyList,o=(t.getIdxbyListEx,t.getV),s={};try{var a=i(e,0,[0],"0a");s.responseStatus=parseInt(a,16)}catch(e){}if(0!==s.responseStatus)return s;try{var u=r(e,0,[1,0,1,0,0,2,0,1]);"80"===e.substr(u,2)?s.certStatus="good":"a1"===e.substr(u,2)?(s.certStatus="revoked",s.revocationTime=Se(n(e,u,[0]))):"82"===e.substr(u,2)&&(s.certStatus="unknown")}catch(e){}try{var l=r(e,0,[1,0,1,0,0,2,0,2]);s.thisUpdate=Se(o(e,l))}catch(e){}try{var c=r(e,0,[1,0,1,0,0,2,0,3]);"a0"===e.substr(c,2)&&(s.nextUpdate=Se(n(e,c,[0])))}catch(e){}return s},ue.asn1.ocsp.OCSPParser=function(){var e=Error,t=Qe,n=new t,i=de,r=i.getV,o=i.getTLV,s=i.getIdxbyList,a=i.getVbyList,u=i.getTLVbyList,l=i.getVbyListEx,c=i.getTLVbyListEx,d=i.getChildIdx;this.getOCSPRequest=function(t){var n=d(t,0);if(1!=n.length&&2!=n.length)throw new e("wrong number elements: "+n.length);return this.getTBSRequest(o(t,n[0]))},this.getTBSRequest=function(e){var t={},i=c(e,0,[0],"30");t.array=this.getRequestList(i);var r=c(e,0,["[2]",0],"30");return null!=r&&(t.ext=n.getExtParamArray(r)),t},this.getRequestList=function(e){for(var t=[],n=d(e,0),i=0;i<n.length;i++)e=o(e,n[i]),t.push(this.getRequest(e));return t},this.getRequest=function(t){var i=d(t,0);if(1!=i.length&&2!=i.length)throw new e("wrong number elements: "+i.length);var r=this.getCertID(o(t,i[0]));if(2==i.length){var a=s(t,0,[1,0]);r.ext=n.getExtParamArray(o(t,a))}return r},this.getCertID=function(n){var i=d(n,0);if(4!=i.length)throw new e("wrong number elements: "+i.length);var s=new t,a={};return a.alg=s.getAlgorithmIdentifierName(o(n,i[0])),a.issname=r(n,i[1]),a.isskey=r(n,i[2]),a.sbjsn=r(n,i[3]),a},this.getOCSPResponse=function(e){var t,n=d(e,0),i=r(e,n[0]),o=parseInt(i);if(1==n.length)return{resstatus:o};var s=u(e,0,[1,0]);return(t=this.getResponseBytes(s)).resstatus=o,t},this.getResponseBytes=function(e){var t,n=d(e,0),i=u(e,0,[1,0]);t=this.getBasicOCSPResponse(i);var o=r(e,n[0]);return t.restype=ue.asn1.x509.OID.oid2name(je(o)),t},this.getBasicOCSPResponse=function(e){var t,n=d(e,0);t=this.getResponseData(o(e,n[0]));var i=new Qe;t.alg=i.getAlgorithmIdentifierName(o(e,n[1]));var s=r(e,n[2]);t.sighex=s.substr(2);var a=l(e,0,["[0]"]);if(null!=a){for(var u=d(a,0),c=[],h=0;h<u.length;h++){var p=o(a,u[h]);c.push(p)}t.certs=c}return t},this.getResponseData=function(e){var t=d(e,0),n=t.length,i={},s=0;"a0"==e.substr(t[0],2)&&s++,i.respid=this.getResponderID(o(e,t[s++]));var a=r(e,t[s++]);if(i.prodat=Se(a),i.array=this.getSingleResponseList(o(e,t[s++])),"a1"==e.substr(t[n-1],2)){var l=u(e,t[n-1],[0]),c=new Qe;i.ext=c.getExtParamArray(l)}return i},this.getResponderID=function(e){var t={};if("a2"==e.substr(0,2)){var n=a(e,0,[0]);t.key=n}if("a1"==e.substr(0,2)){var i=u(e,0,[0]),r=new Qe;t.name=r.getX500Name(i)}return t},this.getSingleResponseList=function(e){for(var t=d(e,0),n=[],i=0;i<t.length;i++){var r=this.getSingleResponse(o(e,t[i]));n.push(r)}return n},this.getSingleResponse=function(e){var t=d(e,0),n={},i=this.getCertID(o(e,t[0]));n.certid=i;var s=this.getCertStatus(o(e,t[1]));if(n.status=s,"18"==e.substr(t[2],2)){var l=r(e,t[2]);n.thisupdate=Se(l)}for(var c=3;c<t.length;c++){if("a0"==e.substr(t[c],2)){var h=a(e,t[c],[0],"18");n.nextupdate=Se(h)}if("a1"==e.substr(t[c],2)){var p=new Qe,f=u(e,0,[c,0]);n.ext=p.getExtParamArray(f)}}return n},this.getCertStatus=function(e){var t={};if("8000"==e)return{status:"good"};if("8200"==e)return{status:"unknown"};if("a1"==e.substr(0,2)){t.status="revoked";var n=Se(a(e,0,[0]));t.time=n}return t}},void 0!==ue&&ue||(ue={}),void 0!==ue.lang&&ue.lang||(ue.lang={}),ue.lang.String=function(){},"function"==typeof Buffer?(le=function(e){return fe(Buffer.from(e,"utf8").toString("base64"))},ce=function(e){return Buffer.from(ge(e),"base64").toString("utf8")}):(le=function(e){return me(Ae(Me(e)))},ce=function(e){return decodeURIComponent(Te(ve(e)))}),ue.lang.String.isInteger=function(e){return!!e.match(/^[0-9]+$/)||!!e.match(/^-[0-9]+$/)},ue.lang.String.isHex=function(e){return Fe(e)},ue.lang.String.isBase64=function(e){return!(!(e=e.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||e.length%4!=0)},ue.lang.String.isBase64URL=function(e){return!e.match(/[+/=]/)&&(e=ge(e),ue.lang.String.isBase64(e))},ue.lang.String.isIntegerArray=function(e){return!!(e=e.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},ue.lang.String.isPrintable=function(e){return null!==e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},ue.lang.String.isIA5=function(e){return null!==e.match(/^[\x20-\x21\x23-\x7f]*$/)},ue.lang.String.isMail=function(e){return null!==e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};var He=function(e,t,n){return null==n&&(n="0"),e.length>=t?e:new Array(t-e.length+1).join(n)+e};function qe(e,t){for(var n=0,i=0;i<e.length;i++)n|=1<<t[e[i]];var r=n.toString(2),o="";for(i=r.length-1;i>=0;i--)o+=r[i];return o}function Ke(e,t,n){if("object"==typeof e){t=String(t).split(".");for(var i=0;i<t.length&&e;i++){var r=t[i];r.match(/^[0-9]+$/)&&(r=parseInt(r)),e=e[r]}return e||!1===e?e:n}}function $e(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t)}void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:g.algo.MD5,sha1:g.algo.SHA1,sha224:g.algo.SHA224,sha256:g.algo.SHA256,sha384:g.algo.SHA384,sha512:g.algo.SHA512,ripemd160:g.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(void 0===this.DIGESTINFOHEAD[t])throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,n){var i=this.getDigestInfoHex(e,t),r=n/4;if(i.length+22>r)throw"key is too short for SigAlg: keylen="+n+","+t;for(var o="00"+i,s="",a=r-4-o.length,u=0;u<a;u+=2)s+="ff";return"0001"+s+o},this.hashString=function(e,t){return new ue.crypto.MessageDigest({alg:t}).digestString(e)},this.hashHex=function(e,t){return new ue.crypto.MessageDigest({alg:t}).digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof ie||e instanceof ue.crypto.DSA||e instanceof ue.crypto.ECDSA}},ue.crypto.Util.md5=function(e){return new ue.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(e)},ue.crypto.Util.ripemd160=function(e){return new ue.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(e)},ue.crypto.Util.SECURERANDOMGEN=new te,ue.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return ue.crypto.Util.SECURERANDOMGEN.nextBytes(t),he(t)},ue.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new E(ue.crypto.Util.getRandomHexOfNbytes(e),16)},ue.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,n=new Array((e-t)/8+1);return ue.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<t&255^255)&n[0],he(n)},ue.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new E(ue.crypto.Util.getRandomHexOfNbits(e),16)},ue.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var n=ue.crypto.Util.getRandomBigIntegerOfNbits(t);if(-1!=e.compareTo(n))return n}},ue.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var n=e.compareTo(t);if(1==n)throw"biMin is greater than biMax";if(0==n)return e;var i=t.subtract(e);return ue.crypto.Util.getRandomBigIntegerZeroToMax(i).add(e)},ue.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(e,t){if(null!==(e=ue.crypto.MessageDigest.getCanonicalAlgName(e))&&void 0===t&&(t=ue.crypto.Util.DEFAULTPROVIDER[e]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)&&"cryptojs"==t){try{this.md=ue.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=g.enc.Hex.parse(e);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(g.enc.Hex)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}if(-1!=":sha256:".indexOf(e)&&"sjcl"==t){try{this.md=new sjcl.hash.sha256}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=sjcl.codec.hex.toBits(e);this.md.update(t)},this.digest=function(){var e=this.md.finalize();return sjcl.codec.hex.fromBits(e)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==e&&void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ue.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},ue.crypto.MessageDigest.getCanonicalAlgName=function(e){return"string"==typeof e&&(e=(e=e.toLowerCase()).replace(/-/,"")),e},ue.crypto.MessageDigest.getHashLength=function(e){var t=ue.crypto.MessageDigest,n=t.getCanonicalAlgName(e);if(void 0===t.HASHLENGTH[n])throw"not supported algorithm: "+e;return t.HASHLENGTH[n]},ue.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},ue.crypto.Mac=function(e){this.setAlgAndProvider=function(e,t){if(null==(e=e.toLowerCase())&&(e="hmacsha1"),"hmac"!=(e=e.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+e;void 0===t&&(t=ue.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+t;var n=e.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==t){try{var i=ue.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[n];this.mac=g.algo.HMAC.create(i,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+e}this.updateString=function(e){this.mac.update(e)},this.updateHex=function(e){var t=g.enc.Hex.parse(e);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(g.enc.Hex)},this.doFinalString=function(e){return this.updateString(e),this.doFinal()},this.doFinalHex=function(e){return this.updateHex(e),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if("string"==typeof e){var t=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(t=we(e)),void(this.pass=g.enc.Hex.parse(t))}if("object"!=typeof e)throw"KJUR.crypto.Mac unsupported password type: "+e;if(t=null,void 0!==e.hex){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;t=e.hex}if(void 0!==e.utf8&&(t=ye(e.utf8)),void 0!==e.rstr&&(t=we(e.rstr)),void 0!==e.b64&&(t=b(e.b64)),void 0!==e.b64u&&(t=ve(e.b64u)),null==t)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=g.enc.Hex.parse(t)},void 0!==e&&(void 0!==e.pass&&this.setPassword(e.pass),void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ue.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},ue.crypto.Signature=function(e){var t=null;if(this._setAlgNames=function(){var e=this.algName.match(/^(.+)with(.+)$/);e&&(this.mdAlgName=e[1].toLowerCase(),this.pubkeyAlgName=e[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(e,t){for(var n="",i=t/4-e.length,r=0;r<i;r++)n+="0";return n+e},this.setAlgAndProvider=function(e,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw new Error("provider not supported: "+t);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new ue.crypto.MessageDigest({alg:this.mdAlgName})}catch(e){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+e)}this.init=function(e,t){var n=null;try{n=void 0===t?We.getKey(e):We.getKey(e,t)}catch(e){throw"init failed:"+e}if(!0===n.isPrivate)this.prvKey=n,this.state="SIGN";else{if(!0!==n.isPublic)throw"init failed.:"+n;this.pubKey=n,this.state="VERIFY"}},this.updateString=function(e){this.md.updateString(e)},this.updateHex=function(e){this.md.updateHex(e)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==ue.crypto.ECDSA&&(this.prvKey=new ue.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof ie&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ie&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof ue.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof ue.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(e){return this.updateString(e),this.sign()},this.signHex=function(e){return this.updateHex(e),this.sign()},this.verify=function(e){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==ue.crypto.ECDSA&&(this.pubKey=new ue.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof ie&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,e,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ie&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ue.crypto.ECDSA&&this.pubKey instanceof ue.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ue.crypto.DSA&&this.pubKey instanceof ue.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(e,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(e){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(e){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(e){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(e){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,void 0!==e&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=ue.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{t=We.getKey(e.prvkeypem),this.init(t)}catch(e){throw"fatal error to load pem private key: "+e}}},ue.crypto.Cipher=function(e){},ue.crypto.Cipher.encrypt=function(e,t,n,i){if(null!=Ke(i,"enclag")&&(n=i.encalg),"string"==typeof n&&"-CBC"==n.substr(-4)){var r=t,o=e;null!=Ke(i,"key")&&(r=i.key),null!=Ke(i,"enc")&&(hEnc=i.enc);var s,a=g.enc.Hex.parse(r),u=g.enc.Hex.parse(o),l=g.enc.Hex.parse(i.iv);if("des-EDE3-CBC"==n)s=g.TripleDES.encrypt(u,a,{iv:l});else{if("aes128-CBC"!=n&&"aes256-CBC"!=n)throw new Error("unsupported algorithm: "+n);s=g.AES.encrypt(u,a,{iv:l})}return s+""}throw new Error("Cipher.encrypt: unsupported key or algorithm")},ue.crypto.Cipher.decrypt=function(e,t,n,i){if(null!=Ke(i,"enclag")&&(n=i.encalg),"string"==typeof n&&"-CBC"==n.substr(-4)){var r=t,o=e;null!=Ke(i,"key")&&(r=i.key),null!=Ke(i,"enc")&&(o=i.enc);var s,a=g.enc.Hex.parse(r),u=g.enc.Hex.parse(o),l=g.enc.Hex.parse(i.iv);if("des-EDE3-CBC"==n)s=g.TripleDES.decrypt({ciphertext:u},a,{iv:l});else{if("aes128-CBC"!=n&&"aes256-CBC"!=n)throw new Error("unsupported algorithm: "+n);s=g.AES.decrypt({ciphertext:u},a,{iv:l})}return g.enc.Hex.stringify(s)}throw new Error("Cipher.decrypt: unsupported key or algorithm")},ue.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.ECDSA=function(e){var t=Error,n=E,i=oe,r=ue.crypto.ECDSA,o=ue.crypto.ECParameterDB,s=r.getName,a=de,u=a.getVbyListEx,l=a.isASN1HEX,c=new te;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){return new n(e.bitLength(),c).mod(e.subtract(n.ONE)).add(n.ONE)},this.setNamedCurve=function(e){this.ecparams=o.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keycharlen;if(e.length!==2+2*t)throw"malformed public key hex length";var n={};return n.x=e.substr(2,t),n.y=e.substr(2+t),n},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":"secp521r1"===e||"NIST P-521"===e||"P-521"===e?"P-521":null},this.generateKeyPairHex=function(){var e=this.ecparams.n,t=this.getBigRandom(e),n=this.ecparams.keycharlen,i=("0000000000"+t.toString(16)).slice(-n);return this.setPrivateKeyHex(i),{ecprvhex:i,ecpubhex:this.generatePublicKeyHex()}},this.generatePublicKeyHex=function(){var e=new n(this.prvKeyHex,16),t=this.ecparams.G.multiply(e),i=t.getX().toBigInteger(),r=t.getY().toBigInteger(),o=this.ecparams.keycharlen,s="04"+("0000000000"+i.toString(16)).slice(-o)+("0000000000"+r.toString(16)).slice(-o);return this.setPublicKeyHex(s),s},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var i=new n(t,16),o=this.ecparams.n,s=new n(e.substring(0,this.ecparams.keycharlen),16);do{var a=this.getBigRandom(o),u=this.ecparams.G.multiply(a).getX().toBigInteger().mod(o)}while(u.compareTo(n.ZERO)<=0);var l=a.modInverse(o).multiply(s.add(i.multiply(u))).mod(o);return r.biRSSigToASN1Sig(u,l)},this.sign=function(e,t){var i=t,r=this.ecparams.n,o=n.fromByteArrayUnsigned(e);do{var s=this.getBigRandom(r),a=this.ecparams.G.multiply(s).getX().toBigInteger().mod(r)}while(a.compareTo(E.ZERO)<=0);var u=s.modInverse(r).multiply(o.add(i.multiply(a))).mod(r);return this.serializeSig(a,u)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,o){try{var s,a,u=r.parseSigHex(t);s=u.r,a=u.s;var l=i.decodeFromHex(this.ecparams.curve,o),c=new n(e.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(c,s,a,l)}catch(e){return!1}},this.verify=function(e,t,r){var o,s,a;if(Bitcoin.Util.isArray(t)){var u=this.parseSig(t);o=u.r,s=u.s}else{if("object"!=typeof t||!t.r||!t.s)throw"Invalid value for signature";o=t.r,s=t.s}if(r instanceof oe)a=r;else{if(!Bitcoin.Util.isArray(r))throw"Invalid format for pubkey value, must be byte array or ECPointFp";a=i.decodeFrom(this.ecparams.curve,r)}var l=n.fromByteArrayUnsigned(e);return this.verifyRaw(l,o,s,a)},this.verifyRaw=function(e,t,i,r){var o=this.ecparams.n,s=this.ecparams.G;if(t.compareTo(n.ONE)<0||t.compareTo(o)>=0)return!1;if(i.compareTo(n.ONE)<0||i.compareTo(o)>=0)return!1;var a=i.modInverse(o),u=e.multiply(a).mod(o),l=t.multiply(a).mod(o);return s.multiply(u).add(r.multiply(l)).getX().toBigInteger().mod(o).equals(t)},this.serializeSig=function(e,t){var n=e.toByteArraySigned(),i=t.toByteArraySigned(),r=[];return r.push(2),r.push(n.length),(r=r.concat(n)).push(2),r.push(i.length),(r=r.concat(i)).unshift(r.length),r.unshift(48),r},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(2!=e[t=2])throw new Error("First element in signature must be a DERInteger");var i=e.slice(t+2,t+2+e[t+1]);if(2!=e[t+=2+e[t+1]])throw new Error("Second element in signature must be a DERInteger");var r=e.slice(t+2,t+2+e[t+1]);return t+=2+e[t+1],{r:n.fromByteArrayUnsigned(i),s:n.fromByteArrayUnsigned(r)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||t>7)throw"Invalid signature type";var i=this.ecparams.n;return{r:n.fromByteArrayUnsigned(e.slice(1,33)).mod(i),s:n.fromByteArrayUnsigned(e.slice(33,65)).mod(i),i:t}},this.readPKCS5PrvKeyHex=function(e){if(!1===l(e))throw new Error("not ASN.1 hex string");var t,n,i;try{t=u(e,0,["[0]",0],"06"),n=u(e,0,[1],"04");try{i=u(e,0,["[1]",0],"03")}catch(e){}}catch(e){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=s(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){if(!1===l(e))throw new t("not ASN.1 hex string");var n,i,r;try{u(e,0,[1,0],"06"),n=u(e,0,[1,1],"06"),i=u(e,0,[2,0,1],"04");try{r=u(e,0,[2,0,"[1]",0],"03")}catch(e){}}catch(e){throw new t("malformed PKCS#8 plain ECC private key")}if(this.curveName=s(n),void 0===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(r),this.setPrivateKeyHex(i),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){if(!1===l(e))throw new t("not ASN.1 hex string");var n,i;try{u(e,0,[0,0],"06"),n=u(e,0,[0,1],"06"),i=u(e,0,[1],"03")}catch(e){throw new t("malformed PKCS#8 ECC public key")}if(this.curveName=s(n),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},this.readCertPubKeyHex=function(e,n){if(!1===l(e))throw new t("not ASN.1 hex string");var i,r;try{i=u(e,0,[0,5,0,1],"06"),r=u(e,0,[0,5,1],"03")}catch(e){throw new t("malformed X.509 certificate ECC public key")}if(this.curveName=s(i),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(r)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},ue.crypto.ECDSA.parseSigHex=function(e){var t=ue.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new E(t.r,16),s:new E(t.s,16)}},ue.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=de,n=t.getChildIdx,i=t.getV;if(t.checkStrictDER(e,0),"30"!=e.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var r=n(e,0);if(2!=r.length)throw new Error("signature shall have two elements");var o=r[0],s=r[1];if("02"!=e.substr(o,2))throw new Error("1st item not ASN.1 integer");if("02"!=e.substr(s,2))throw new Error("2nd item not ASN.1 integer");return{r:i(e,o),s:i(e,s)}},ue.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=ue.crypto.ECDSA.parseSigHexInHexRS(e),n=t.r,i=t.s;if(n.length>=130&&n.length<=134){if(n.length%2!=0)throw Error("unknown ECDSA sig r length error");if(i.length%2!=0)throw Error("unknown ECDSA sig s length error");"00"==n.substr(0,2)&&(n=n.substr(2)),"00"==i.substr(0,2)&&(i=i.substr(2));var r=Math.max(n.length,i.length);return(n=("000000"+n).slice(-r))+("000000"+i).slice(-r)}if("00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),"00"==i.substr(0,2)&&i.length%32==2&&(i=i.substr(2)),n.length%32==30&&(n="00"+n),i.length%32==30&&(i="00"+i),n.length%32!=0)throw Error("unknown ECDSA sig r length error");if(i.length%32!=0)throw Error("unknown ECDSA sig s length error");return n+i},ue.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var t=e.substr(0,e.length/2),n=e.substr(e.length/2);return ue.crypto.ECDSA.hexRSSigToASN1Sig(t,n)},ue.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var n=new E(e,16),i=new E(t,16);return ue.crypto.ECDSA.biRSSigToASN1Sig(n,i)},ue.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var n=ue.asn1,i=new n.DERInteger({bigint:e}),r=new n.DERInteger({bigint:t});return new n.DERSequence({array:[i,r]}).tohex()},ue.crypto.ECDSA.getName=function(e){return"2b8104001f"===e?"secp192k1":"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040021"===e?"secp224r1":"2b81040022"===e?"secp384r1":"2b81040023"===e?"secp521r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)?"secp256r1":-1!=="|secp256k1|".indexOf(e)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(e)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(e)?"secp384r1":-1!=="|secp521r1|NIST P-521|P-521|".indexOf(e)?"secp521r1":null},void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.ECParameterDB=new function(){var e={},t={};function n(e){return new E(e,16)}this.getByName=function(n){var i=n;if(void 0!==t[i]&&(i=t[n]),void 0!==e[i])return e[i];throw"unregistered EC curve name: "+i},this.regist=function(i,r,o,s,a,u,l,c,d,h,p,f){e[i]={};var g=n(o),m=n(s),v=n(a),y=n(u),S=n(l),b=new se(g,m,v),E=b.decodePointHex("04"+c+d);e[i].name=i,e[i].keylen=r,e[i].keycharlen=2*Math.ceil(r/8),e[i].curve=b,e[i].G=E,e[i].n=y,e[i].h=S,e[i].oid=p,e[i].info=f;for(var w=0;w<h.length;w++)t[h[w]]=i}},ue.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),ue.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),ue.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),ue.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),ue.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),ue.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),ue.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),ue.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),ue.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),ue.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.DSA=function(){var e=de,t=(e.getVbyList,e.getVbyListEx),n=e.isASN1HEX,i=E;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(e,t,n,i,r){this.isPrivate=!0,this.p=e,this.q=t,this.g=n,this.y=i,this.x=r},this.setPrivateHex=function(e,t,n,i,r){var o,s,a,u,l;o=new E(e,16),s=new E(t,16),a=new E(n,16),u="string"==typeof i&&i.length>1?new E(i,16):null,l=new E(r,16),this.setPrivate(o,s,a,u,l)},this.setPublic=function(e,t,n,i){this.isPublic=!0,this.p=e,this.q=t,this.g=n,this.y=i,this.x=null},this.setPublicHex=function(e,t,n,i){var r,o,s,a;r=new E(e,16),o=new E(t,16),s=new E(n,16),a=new E(i,16),this.setPublic(r,o,s,a)},this.signWithMessageHash=function(e){var t=this.p,n=this.q,i=this.g,r=(this.y,this.x),o=ue.crypto.Util.getRandomBigIntegerMinToMax(E.ONE.add(E.ONE),n.subtract(E.ONE)),s=new E(e.substr(0,n.bitLength()/4),16),a=i.modPow(o,t).mod(n),u=o.modInverse(n).multiply(s.add(r.multiply(a))).mod(n);return ue.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:a}},{int:{bigint:u}}]})},this.verifyWithMessageHash=function(e,t){var n=this.p,i=this.q,r=this.g,o=this.y,s=this.parseASN1Signature(t),a=s[0],u=s[1],l=new E(e.substr(0,i.bitLength()/4),16);if(E.ZERO.compareTo(a)>0||a.compareTo(i)>0)throw"invalid DSA signature";if(E.ZERO.compareTo(u)>=0||u.compareTo(i)>0)throw"invalid DSA signature";var c=u.modInverse(i),d=l.multiply(c).mod(i),h=a.multiply(c).mod(i);return 0==r.modPow(d,n).multiply(o.modPow(h,n)).mod(n).mod(i).compareTo(a)},this.parseASN1Signature=function(e){try{return[new i(t(e,0,[0],"02"),16),new i(t(e,0,[1],"02"),16)]}catch(e){throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(e){var i,r,o,s,a;if(!1===n(e))throw new Error("not ASN.1 hex string");try{i=t(e,0,[1],"02"),r=t(e,0,[2],"02"),o=t(e,0,[3],"02"),s=t(e,0,[4],"02"),a=t(e,0,[5],"02")}catch(e){throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(i,r,o,s,a)},this.readPKCS8PrvKeyHex=function(e){var i,r,o,s;if(!1===n(e))throw new Error("not ASN.1 hex string");try{i=t(e,0,[1,1,0],"02"),r=t(e,0,[1,1,1],"02"),o=t(e,0,[1,1,2],"02"),s=t(e,0,[2,0],"02")}catch(e){throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(i,r,o,null,s)},this.readPKCS8PubKeyHex=function(e){var i,r,o,s;if(!1===n(e))throw new Error("not ASN.1 hex string");try{i=t(e,0,[0,1,0],"02"),r=t(e,0,[0,1,1],"02"),o=t(e,0,[0,1,2],"02"),s=t(e,0,[1,0],"02")}catch(e){throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(i,r,o,s)},this.readCertPubKeyHex=function(e,i){var r,o,s,a;if(!1===n(e))throw new Error("not ASN.1 hex string");try{r=t(e,0,[0,5,0,1,0],"02"),o=t(e,0,[0,5,0,1,1],"02"),s=t(e,0,[0,5,0,1,2],"02"),a=t(e,0,[0,5,1,0],"02")}catch(e){throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(r,o,s,a)}};var We=function(){var e=function(e,n,i){return t(g.AES,e,n,i)},t=function(e,t,n,i){var r=g.enc.Hex.parse(t),o=g.enc.Hex.parse(n),s=g.enc.Hex.parse(i),a={};a.key=o,a.iv=s,a.ciphertext=r;var u=e.decrypt(a,o,{iv:s});return g.enc.Hex.stringify(u)},n=function(e,t,n){return i(g.AES,e,t,n)},i=function(e,t,n,i){var r=g.enc.Hex.parse(t),o=g.enc.Hex.parse(n),s=g.enc.Hex.parse(i),a=e.encrypt(r,o,{iv:s}),u=g.enc.Hex.parse(a.toString());return g.enc.Base64.stringify(u)},r={"AES-256-CBC":{proc:e,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:n,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(e,n,i){return t(g.TripleDES,e,n,i)},eproc:function(e,t,n){return i(g.TripleDES,e,t,n)},keylen:24,ivlen:8},"DES-CBC":{proc:function(e,n,i){return t(g.DES,e,n,i)},eproc:function(e,t,n){return i(g.DES,e,t,n)},keylen:8,ivlen:8}},o=function(e){var t={},n=e.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));n&&(t.cipher=n[1],t.ivsalt=n[2]);var i=e.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));i&&(t.type=i[1]);var r=-1,o=0;-1!=e.indexOf("\r\n\r\n")&&(r=e.indexOf("\r\n\r\n"),o=2),-1!=e.indexOf("\n\n")&&(r=e.indexOf("\n\n"),o=1);var s=e.indexOf("-----END");if(-1!=r&&-1!=s){var a=e.substring(r+2*o,s-o);a=a.replace(/\s+/g,""),t.data=a}return t},s=function(e,t,n){for(var i=n.substring(0,16),o=g.enc.Hex.parse(i),s=g.enc.Utf8.parse(t),a=r[e].keylen+r[e].ivlen,u="",l=null;;){var c=g.algo.MD5.create();if(null!=l&&c.update(l),c.update(s),c.update(o),l=c.finalize(),(u+=g.enc.Hex.stringify(l)).length>=2*a)break}var d={};return d.keyhex=u.substr(0,2*r[e].keylen),d.ivhex=u.substr(2*r[e].keylen,2*r[e].ivlen),d},a=function(e,t,n,i){var o=g.enc.Base64.parse(e),s=g.enc.Hex.stringify(o);return(0,r[t].proc)(s,n,i)};return{version:"1.0.0",parsePKCS5PEM:function(e){return o(e)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(e,t,n){return s(e,t,n)},decryptKeyB64:function(e,t,n,i){return a(e,t,n,i)},getDecryptedKeyHex:function(e,t){var n=o(e),i=(n.type,n.cipher),r=n.ivsalt,u=n.data,l=s(i,t,r).keyhex;return a(u,i,l,r)},getEncryptedPKCS5PEMFromPrvKeyHex:function(e,t,n,i,o){var a="";if(void 0!==i&&null!=i||(i="AES-256-CBC"),void 0===r[i])throw new Error("KEYUTIL unsupported algorithm: "+i);if(void 0===o||null==o){var u=function(e){var t=g.lib.WordArray.random(e);return g.enc.Hex.stringify(t)}(r[i].ivlen);o=u.toUpperCase()}var l=function(e,t,n,i){return(0,r[t].eproc)(e,n,i)}(t,i,s(i,n,o).keyhex,o);return a="-----BEGIN "+e+" PRIVATE KEY-----\r\n",a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+i+","+o+"\r\n",a+="\r\n",(a+=l.replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+e+" PRIVATE KEY-----\r\n"},getEncryptedPKCS8PEM:function(e,t,n){return _e(this.getEncryptedPKCS8Hex(e,t,n),"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(e,t,n){var i;(i=null==n||null==n?{}:JSON.parse(JSON.stringify(n))).plain=e,this.initPBES2Param(i),this.encryptPBES2Param(i,t);var r=this.generatePBES2ASN1Param(i);return ue.asn1.ASN1Util.newObject(r).tohex()},initPBES2Param:function(e){var t;null==Ke(e,"encalg")&&(e.encalg="aes256-CBC"),null==Ke(e,"iter")&&(e.iter=2048),null==Ke(e,"prf")&&(e.prf="hmacWithSHA256"),null==Ke(e,"salt")&&(e.salt=g.enc.Hex.stringify(g.lib.WordArray.random(8))),null==Ke(e,"enciv")&&("des-EDE3-CBC"==e.encalg&&(t=8),"aes128-CBC"==e.encalg&&(t=16),"aes256-CBC"==e.encalg&&(t=16),e.enciv=g.enc.Hex.stringify(g.lib.WordArray.random(t)))},encryptPBES2Param:function(e,t){var n=We.getDKFromPBES2Param(e,t);try{var i=ue.crypto.Cipher.encrypt(e.plain,n,e.encalg,{iv:e.enciv})}catch(t){throw new Error("encrypt error: "+e.plain+" "+n+" "+e.encalg+" "+e.enciv)}e.enc=i},generatePBES2ASN1Param:function(e){var t={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:e.salt}},{int:{hex:Be(e.iter)}}]}]},{seq:[{oid:e.encalg},{octstr:{hex:e.enciv}}]}]}]},{octstr:{hex:e.enc}}]};return"hmacWithSHA1"!=e.prf&&t.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:e.prf},{null:""}]}),t},parseHexOfEncryptedPKCS8:function(e){var t=de,n=t.getChildIdx,i=t.getV,r={},o=n(e,0);if(2!=o.length)throw new Error("malformed format: SEQUENCE(0).items != 2: "+o.length);r.ciphertext=i(e,o[1]);var s=n(e,o[0]);if(2!=s.length)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+s.length);if("2a864886f70d01050d"!=i(e,s[0]))throw new Error("this only supports pkcs5PBES2");var a=n(e,s[1]);if(2!=s.length)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+a.length);var u=n(e,a[1]);if(2!=u.length)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length);if("2a864886f70d0307"!=i(e,u[0]))throw"this only supports TripleDES";r.encryptionSchemeAlg="TripleDES",r.encryptionSchemeIV=i(e,u[1]);var l=n(e,a[0]);if(2!=l.length)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+l.length);if("2a864886f70d01050c"!=i(e,l[0]))throw new Error("this only supports pkcs5PBKDF2");var c=n(e,l[1]);if(c.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+c.length);r.pbkdf2Salt=i(e,c[0]);var d=i(e,c[1]);try{r.pbkdf2Iter=parseInt(d,16)}catch(e){throw new Error("malformed format pbkdf2Iter: "+d)}return r},getPBKDF2KeyHexFromParam:function(e,t){var n=g.enc.Hex.parse(e.pbkdf2Salt),i=e.pbkdf2Iter,r=g.PBKDF2(t,n,{keySize:6,iterations:i});return g.enc.Hex.stringify(r)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(e,t){var n=Ie(e,"ENCRYPTED PRIVATE KEY"),i=this.parseHexOfEncryptedPKCS8(n),r=We.getPBKDF2KeyHexFromParam(i,t),o={};o.ciphertext=g.enc.Hex.parse(i.ciphertext);var s=g.enc.Hex.parse(r),a=g.enc.Hex.parse(i.encryptionSchemeIV),u=g.TripleDES.decrypt(o,s,{iv:a});return g.enc.Hex.stringify(u)},parsePBES2:function(e){var t=de.parse(e);if("pkcs5PBES2"!=Ke(t,"seq.0.seq.0.oid")||"pkcs5PBKDF2"!=Ke(t,"seq.0.seq.1.seq.0.seq.0.oid"))throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var n=Ke(t,"seq.0.seq.1.seq.0.seq.1.seq");if(null==n)throw new Error("PBKDF2 parameter not found");var i=Ke(n,"0.octstr.hex"),r=Ke(n,"1.int.hex"),o=Ke(n,"2.seq.0.oid","hmacWithSHA1"),s=-1;try{s=parseInt(r,16)}catch(e){throw new Error("iter not proper value")}var a=Ke(t,"seq.0.seq.1.seq.1.seq.0.oid"),u=Ke(t,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),l=Ke(t,"seq.1.octstr.hex");if(null==a||null==u||null==l)throw new Error("encalg, enciv or enc is undefined");return{salt:i,iter:s,prf:o,encalg:a,enciv:u,enc:l}},getDKFromPBES2Param:function(e,t){var n={hmacWithSHA1:g.algo.SHA1,hmacWithSHA224:g.algo.SHA224,hmacWithSHA256:g.algo.SHA256,hmacWithSHA384:g.algo.SHA384,hmacWithSHA512:g.algo.SHA512}[e.prf];if(null==n)throw new Error("unsupported prf");var i={"des-EDE3-CBC":6,"aes128-CBC":4,"aes256-CBC":8}[e.encalg];if(null==i)throw new Error("unsupported encalg");var r=g.enc.Hex.parse(e.salt),o=e.iter;try{var s=g.PBKDF2(t,r,{keySize:i,iterations:o,hasher:n});return g.enc.Hex.stringify(s)}catch(n){throw new Error("PBKDF2 error: "+n+" "+JSON.stringify(e)+" "+t)}},getPlainHexFromEncryptedPKCS8PEM:function(e,t){if(-1==e.indexOf("BEGIN ENCRYPTED PRIVATE KEY"))throw new Error("not Encrypted PKCS#8 PEM string");var n,i=Ie(e);try{n=We.parsePBES2(i)}catch(e){throw new Error("malformed PBES2 format: "+e.message)}var r=We.getDKFromPBES2Param(n,t);return ue.crypto.Cipher.decrypt(n.enc,r,n.encalg,{iv:n.enciv})},getKeyFromEncryptedPKCS8PEM:function(e,t){var n=this.getPlainHexFromEncryptedPKCS8PEM(e,t);return this.getKeyFromPlainPrivatePKCS8Hex(n)},parsePlainPrivatePKCS8Hex:function(e){var t=de,n=t.getChildIdx,i=t.getV,r={algparam:null};if("30"!=e.substr(0,2))throw new Error("malformed plain PKCS8 private key(code:001)");var o=n(e,0);if(o.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if("30"!=e.substr(o[1],2))throw new Error("malformed PKCS8 private key(code:003)");var s=n(e,o[1]);if(2!=s.length)throw new Error("malformed PKCS8 private key(code:004)");if("06"!=e.substr(s[0],2))throw new Error("malformed PKCS8 private key(code:005)");if(r.algoid=i(e,s[0]),"06"==e.substr(s[1],2)&&(r.algparam=i(e,s[1])),"04"!=e.substr(o[2],2))throw new Error("malformed PKCS8 private key(code:006)");return r.keyidx=t.getVidx(e,o[2]),r},getKeyFromPlainPrivatePKCS8PEM:function(e){var t=Ie(e,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(t)},getKeyFromPlainPrivatePKCS8Hex:function(e){var t,n=this.parsePlainPrivatePKCS8Hex(e);if("2a864886f70d010101"==n.algoid)t=new ie;else if("2a8648ce380401"==n.algoid)t=new ue.crypto.DSA;else{if("2a8648ce3d0201"!=n.algoid)throw new Error("unsupported private key algorithm");t=new ue.crypto.ECDSA}return t.readPKCS8PrvKeyHex(e),t},_getKeyFromPublicPKCS8Hex:function(e){var t,n=de.getVbyList(e,0,[0,0],"06");if("2a864886f70d010101"===n)t=new ie;else if("2a8648ce380401"===n)t=new ue.crypto.DSA;else{if("2a8648ce3d0201"!==n)throw new Error("unsupported PKCS#8 public key hex");t=new ue.crypto.ECDSA}return t.readPKCS8PubKeyHex(e),t},parsePublicRawRSAKeyHex:function(e){var t=de,n=t.getChildIdx,i=t.getV,r={};if("30"!=e.substr(0,2))throw new Error("malformed RSA key(code:001)");var o=n(e,0);if(2!=o.length)throw new Error("malformed RSA key(code:002)");if("02"!=e.substr(o[0],2))throw new Error("malformed RSA key(code:003)");if(r.n=i(e,o[0]),"02"!=e.substr(o[1],2))throw new Error("malformed RSA key(code:004)");return r.e=i(e,o[1]),r},parsePublicPKCS8Hex:function(e){var t=de,n=t.getChildIdx,i=t.getV,r={algparam:null},o=n(e,0);if(2!=o.length)throw new Error("outer DERSequence shall have 2 elements: "+o.length);var s=o[0];if("30"!=e.substr(s,2))throw new Error("malformed PKCS8 public key(code:001)");var a=n(e,s);if(2!=a.length)throw new Error("malformed PKCS8 public key(code:002)");if("06"!=e.substr(a[0],2))throw new Error("malformed PKCS8 public key(code:003)");if(r.algoid=i(e,a[0]),"06"==e.substr(a[1],2)?r.algparam=i(e,a[1]):"30"==e.substr(a[1],2)&&(r.algparam={},r.algparam.p=t.getVbyList(e,a[1],[0],"02"),r.algparam.q=t.getVbyList(e,a[1],[1],"02"),r.algparam.g=t.getVbyList(e,a[1],[2],"02")),"03"!=e.substr(o[1],2))throw new Error("malformed PKCS8 public key(code:004)");return r.key=i(e,o[1]).substr(2),r}}}();function Ge(e,t){for(var n="",i=t/4-e.length,r=0;r<i;r++)n+="0";return n+e}function ze(e,t,n){for(var i="",r=0;i.length<t;)i+=Ee(n(we(e+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])))),r+=1;return i}function Je(e){for(var t in ue.crypto.Util.DIGESTINFOHEAD){var n=ue.crypto.Util.DIGESTINFOHEAD[t],i=n.length;if(e.substring(0,i)==n)return[t,e.substring(i)]}return[]}function Qe(e){var t,n=de,i=n.getChildIdx,r=n.getV,o=(n.dump,n.parse),s=n.getTLV,a=n.getVbyList,u=n.getVbyListEx,l=n.getTLVbyList,c=n.getTLVbyListEx,d=n.getIdxbyList,h=n.getIdxbyListEx,p=n.getVidx,f=n.getInt,g=n.oidname,m=n.hextooidstr,v=Ie,y=Error;try{t=ue.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(e){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(null===this.hex||0!==this.version)return this.version;var e=l(this.hex,0,[0,0]);if("a0"==e.substr(0,2)){var t=l(e,0,[0]),n=f(t,0);if(n<0||2<n)throw new Error("malformed version field");return this.version=n+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return u(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var e=c(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(e)},this.getAlgorithmIdentifierName=function(e){for(var n in t)if(e===t[n])return n;return g(u(e,0,[0],"06"))},this.getIssuer=function(e,t){return this.getX500Name(this.getIssuerHex(),e,t)},this.getIssuerHex=function(){return l(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(e,t){return this.getX500Name(this.getSubjectHex(),e,t)},this.getSubjectHex=function(){return l(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var e=a(this.hex,0,[0,4+this.foffset,0]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getNotAfter=function(){var e=a(this.hex,0,[0,4+this.foffset,1]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var e=this.getSPKI();return null==e?null:a(e,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return d(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var e=this.getPublicKeyIdx();return d(this.hex,e,[1,0],"30")},this.getPublicKey=function(){return We.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var e=l(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(e)},this.getSignatureValueHex=function(){return a(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmField(),n=this.getSignatureValueHex(),i=l(this.hex,0,[0],"30"),r=new ue.crypto.Signature({alg:t});return r.init(e),r.updateHex(i),r.verify(n)},this.parseExt=function(e){var t,o,s;if(void 0===e){if(s=this.hex,3!==this.version)return-1;t=d(s,0,[0,7,0],"30"),o=i(s,t)}else{s=Ie(e);var u=d(s,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=r(s,u))return void(this.aExtInfo=new Array);t=d(s,0,[0,3,0,1,0],"30"),o=i(s,t),this.hex=s}this.aExtInfo=new Array;for(var l=0;l<o.length;l++){var c={critical:!1},h=0;3===i(s,o[l]).length&&(c.critical=!0,h=1),c.oid=n.hextooidstr(a(s,o[l],[0],"06"));var f=d(s,o[l],[1+h]);c.vidx=p(s,f),this.aExtInfo.push(c)}},this.getExtInfo=function(e){var t=this.aExtInfo,n=e;if(e.match(/^[0-9.]+$/)||(n=ue.asn1.x509.OID.name2oid(e)),""!==n)for(var i=0;i<t.length;i++)if(t[i].oid===n)return t[i]},this.getCriticalExtV=function(e,t,n){if(null!=t)return[t,n];var i=this.getExtInfo(e);return null==i?[null,null]:[s(this.hex,i.vidx),i.critical]},this.getExtBasicConstraints=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("basicConstraints");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"basicConstraints"};if(t&&(i.critical=!0),"3000"===e)return i;if("30030101ff"===e)return i.cA=!0,i;if("30060101ff02"===e.substr(0,12)){var o=r(e,10),a=parseInt(o,16);return i.cA=!0,i.pathLen=a,i}throw new Error("hExtV parse error: "+e)},this.getExtNameConstraints=function(e,t){var n=this.getCriticalExtV("nameConstraints",e,t);if(e=n[0],t=n[1],null!=e){var r={extname:"nameConstraints"};t&&(r.critical=!0);for(var o=i(e,0),a=0;a<o.length;a++){for(var u=[],l=i(e,o[a]),c=0;c<l.length;c++){var d=s(e,l[c]),h=this.getGeneralSubtree(d);u.push(h)}var p=e.substr(o[a],2);"a0"==p?r.permit=u:"a1"==p&&(r.exclude=u)}return r}},this.getGeneralSubtree=function(e){var t=i(e,0),n=t.length;if(n<1||2<n)throw new Error("wrong num elements");for(var o=this.getGeneralName(s(e,t[0])),a=1;a<n;a++){var u=e.substr(t[a],2),l=r(e,t[a]),c=parseInt(l,16);"80"==u&&(o.min=c),"81"==u&&(o.max=c)}return o},this.getExtKeyUsage=function(e,t){var n=this.getCriticalExtV("keyUsage",e,t);if(e=n[0],t=n[1],null!=e){var i={extname:"keyUsage"};return t&&(i.critical=!0),i.names=this.getExtKeyUsageString(e).split(","),i}},this.getExtKeyUsageBin=function(e){if(void 0===e){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";e=s(this.hex,t.vidx)}if(8!=e.length&&10!=e.length)throw new Error("malformed key usage value: "+e);var n="000000000000000"+parseInt(e.substr(6),16).toString(2);return 8==e.length&&(n=n.slice(-8)),10==e.length&&(n=n.slice(-16)),""==(n=n.replace(/0+$/,""))&&(n="0"),n},this.getExtKeyUsageString=function(e){for(var t=this.getExtKeyUsageBin(e),n=new Array,i=0;i<t.length;i++)"1"==t.substr(i,1)&&n.push(Qe.KEYUSAGE_NAME[i]);return n.join(",")},this.getExtSubjectKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("subjectKeyIdentifier");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"subjectKeyIdentifier"};t&&(i.critical=!0);var o=r(e,0);return i.kid={hex:o},i},this.getExtAuthorityKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("authorityKeyIdentifier");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var o={extname:"authorityKeyIdentifier"};t&&(o.critical=!0);for(var a=i(e,0),u=0;u<a.length;u++){var l=e.substr(a[u],2);if("80"===l&&(o.kid={hex:r(e,a[u])}),"a1"===l){var c=s(e,a[u]),d=this.getGeneralNames(c);o.issuer=d[0].dn}"82"===l&&(o.sn={hex:r(e,a[u])})}return o},this.getExtExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("extKeyUsage");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var o={extname:"extKeyUsage",array:[]};t&&(o.critical=!0);for(var a=i(e,0),u=0;u<a.length;u++)o.array.push(g(r(e,a[u])));return o},this.getExtExtKeyUsageName=function(){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return e;var t=new Array,n=s(this.hex,e.vidx);if(""===n)return t;for(var o=i(n,0),a=0;a<o.length;a++)t.push(g(r(n,o[a])));return t},this.getExtSubjectAltName=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("subjectAltName");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"subjectAltName",array:[]};return t&&(i.critical=!0),i.array=this.getGeneralNames(e),i},this.getExtIssuerAltName=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("issuerAltName");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"issuerAltName",array:[]};return t&&(i.critical=!0),i.array=this.getGeneralNames(e),i},this.getGeneralNames=function(e){for(var t=i(e,0),n=[],r=0;r<t.length;r++){var o=this.getGeneralName(s(e,t[r]));void 0!==o&&n.push(o)}return n},this.getGeneralName=function(e){var t=e.substr(0,2),n=r(e,0),i=Ee(n);return"81"==t?{rfc822:i}:"82"==t?{dns:i}:"86"==t?{uri:i}:"87"==t?{ip:Pe(n)}:"a4"==t?{dn:this.getX500Name(n)}:"a0"==t?{other:this.getOtherName(e)}:void 0},this.getExtSubjectAltName2=function(){var e,t,n,o=this.getExtInfo("subjectAltName");if(void 0===o)return o;for(var a=new Array,u=s(this.hex,o.vidx),l=i(u,0),c=0;c<l.length;c++)n=u.substr(l[c],2),e=r(u,l[c]),"81"===n&&(t=Se(e),a.push(["MAIL",t])),"82"===n&&(t=Se(e),a.push(["DNS",t])),"84"===n&&(t=Qe.hex2dn(e,0),a.push(["DN",t])),"86"===n&&(t=Se(e),a.push(["URI",t])),"87"===n&&(t=Pe(e),a.push(["IP",t]));return a},this.getExtCRLDistributionPoints=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("cRLDistributionPoints");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"cRLDistributionPoints",array:[]};t&&(r.critical=!0);for(var o=i(e,0),a=0;a<o.length;a++){var u=s(e,o[a]);r.array.push(this.getDistributionPoint(u))}return r},this.getDistributionPoint=function(e){for(var t={},n=i(e,0),r=0;r<n.length;r++){var o=e.substr(n[r],2),a=s(e,n[r]);"a0"==o&&(t.dpname=this.getDistributionPointName(a))}return t},this.getDistributionPointName=function(e){for(var t={},n=i(e,0),r=0;r<n.length;r++){var o=e.substr(n[r],2),a=s(e,n[r]);"a0"==o&&(t.full=this.getGeneralNames(a))}return t},this.getExtCRLDistributionPointsURI=function(){var e=this.getExtCRLDistributionPoints();if(null==e)return e;for(var t=e.array,n=[],i=0;i<t.length;i++)try{null!=t[i].dpname.full[0].uri&&n.push(t[i].dpname.full[0].uri)}catch(e){}return n},this.getExtAIAInfo=function(){var e=this.getExtInfo("authorityInfoAccess");if(void 0===e)return e;for(var t={ocsp:[],caissuer:[]},n=i(this.hex,e.vidx),r=0;r<n.length;r++){var o=a(this.hex,n[r],[0],"06"),s=a(this.hex,n[r],[1],"86");"2b06010505073001"===o&&t.ocsp.push(Se(s)),"2b06010505073002"===o&&t.caissuer.push(Se(s))}return t},this.getExtAuthorityInfoAccess=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("authorityInfoAccess");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"authorityInfoAccess",array:[]};t&&(r.critical=!0);for(var o=i(e,0),l=0;l<o.length;l++){var c=u(e,o[l],[0],"06"),d=Se(a(e,o[l],[1],"86"));if("2b06010505073001"==c)r.array.push({ocsp:d});else{if("2b06010505073002"!=c)throw new Error("unknown method: "+c);r.array.push({caissuer:d})}}return r},this.getExtCertificatePolicies=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("certificatePolicies");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"certificatePolicies",array:[]};t&&(r.critical=!0);for(var o=i(e,0),a=0;a<o.length;a++){var u=s(e,o[a]),l=this.getPolicyInformation(u);r.array.push(l)}return r},this.getPolicyInformation=function(e){var t={},n=a(e,0,[0],"06");t.policyoid=g(n);var r=h(e,0,[1],"30");if(-1!=r){t.array=[];for(var o=i(e,r),u=0;u<o.length;u++){var l=s(e,o[u]),c=this.getPolicyQualifierInfo(l);t.array.push(c)}}return t},this.getOtherName=function(e){var t={},n=i(e,0),r=a(e,n[0],[],"06"),s=a(e,n[1],[]);return t.oid=g(r),t.value=o(s),t},this.getPolicyQualifierInfo=function(e){var t={},n=a(e,0,[0],"06");if("2b06010505070201"===n){var i=u(e,0,[1],"16");t.cps=Ee(i)}else if("2b06010505070202"===n){var r=l(e,0,[1],"30");t.unotice=this.getUserNotice(r)}return t},this.getUserNotice=function(e){var t=null;try{return t=n.parse(e),this._asn1ToUnotice(t)}catch(e){return}},this._asn1ToUnotice=function(e){try{for(var t={},n=Ke(e,"seq"),i=0;i<n.length;i++){var r=this._asn1ToNoticeRef(n[i]);null!=r&&(t.noticeref=r);var o=this.asn1ToDisplayText(n[i]);null!=o&&(t.exptext=o)}return Object.keys(t).length>0?t:void 0}catch(e){return}},this._asn1ToNoticeRef=function(e){try{for(var t={},n=Ke(e,"seq"),i=0;i<n.length;i++){var r=this._asn1ToNoticeNum(n[i]);null!=r&&(t.noticenum=r);var o=this.asn1ToDisplayText(n[i]);null!=o&&(t.org=o)}return Object.keys(t).length>0?t:void 0}catch(e){return}},this._asn1ToNoticeNum=function(e){try{for(var t=Ke(e,"seq"),n=[],i=0;i<t.length;i++){var r=t[i];n.push(parseInt(Ke(r,"int.hex"),16))}return n}catch(e){return}},this.getDisplayText=function(e){var t={};return t.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[e.substr(0,2)],t.str=Ee(r(e,0)),t},this.asn1ToDisplayText=function(e){return null!=e.utf8str?{type:"utf8",str:e.utf8str.str}:null!=e.ia5str?{type:"ia5",str:e.ia5str.str}:null!=e.visstr?{type:"vis",str:e.visstr.str}:null!=e.bmpstr?{type:"bmp",str:e.bmpstr.str}:null!=e.prnstr?{type:"prn",str:e.prnstr.str}:void 0},this.getExtPolicyMappings=function(e,t){var n=this.getCriticalExtV("policyMappings",e,t);if(e=n[0],t=n[1],null!=e){var i={extname:"policyMappings"};t&&(i.critical=!0);try{for(var r=o(e).seq,s=[],a=0;a<r.length;a++){var u=r[a].seq;s.push([u[0].oid,u[1].oid])}i.array=s}catch(e){throw new y("malformed policyMappings")}return i}},this.getExtPolicyConstraints=function(e,t){var n=this.getCriticalExtV("policyConstraints",e,t);if(e=n[0],t=n[1],null!=e){var i={extname:"policyConstraints"};t&&(i.critical=!0);var r=o(e);try{for(var s=r.seq,a=0;a<s.length;a++){var u=s[a].tag;0==u.explicit&&("80"==u.tag&&(i.reqexp=parseInt(u.hex,16)),"81"==u.tag&&(i.inhibit=parseInt(u.hex,16)))}}catch(e){return new y("malformed policyConstraints value")}return i}},this.getExtInhibitAnyPolicy=function(e,t){var n=this.getCriticalExtV("inhibitAnyPolicy",e,t);if(e=n[0],t=n[1],null!=e){var i={extname:"inhibitAnyPolicy"};t&&(i.critical=!0);var r=f(e,0);return-1==r?new y("wrong value"):(i.skip=r,i)}},this.getExtCRLNumber=function(e,t){var n={extname:"cRLNumber"};if(t&&(n.critical=!0),"02"==e.substr(0,2))return n.num={hex:r(e,0)},n;throw new y("hExtV parse error: "+e)},this.getExtCRLReason=function(e,t){var n={extname:"cRLReason"};if(t&&(n.critical=!0),"0a"==e.substr(0,2))return n.code=parseInt(r(e,0),16),n;throw new Error("hExtV parse error: "+e)},this.getExtOcspNonce=function(e,t){var n={extname:"ocspNonce"};t&&(n.critical=!0);var i=r(e,0);return n.hex=i,n},this.getExtOcspNoCheck=function(e,t){var n={extname:"ocspNoCheck"};return t&&(n.critical=!0),n},this.getExtAdobeTimeStamp=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("adobeTimeStamp");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var r={extname:"adobeTimeStamp"};t&&(r.critical=!0);var o=i(e,0);if(o.length>1){var a=s(e,o[1]),u=this.getGeneralName(a);null!=u.uri&&(r.uri=u.uri)}if(o.length>2){var l=s(e,o[2]);"0101ff"==l&&(r.reqauth=!0),"010100"==l&&(r.reqauth=!1)}return r},this.getExtSubjectDirectoryAttributes=function(e,t){if(void 0===e&&void 0===t){var n=this.getExtInfo("subjectDirectoryAttributes");if(void 0===n)return;e=s(this.hex,n.vidx),t=n.critical}var i={extname:"subjectDirectoryAttributes"};t&&(i.critical=!0);try{for(var r=o(e),a=[],u=0;u<r.seq.length;u++){var l=r.seq[u],c=Ke(l,"seq.0.oid"),d=Ke(l,"seq.1.set");if(null==c||null==d)throw"error";a.push({attr:c,array:d})}return i.array=a,i}catch(e){throw new Error("malformed subjectDirectoryAttributes extension value")}};var S=function(e){var t={};try{var n=e.seq[0].oid,i=ue.asn1.x509.OID.name2oid(n);t.type=ue.asn1.x509.OID.oid2atype(i);var r=e.seq[1];if(null!=r.utf8str)t.ds="utf8",t.value=r.utf8str.str;else if(null!=r.numstr)t.ds="num",t.value=r.numstr.str;else if(null!=r.telstr)t.ds="tel",t.value=r.telstr.str;else if(null!=r.prnstr)t.ds="prn",t.value=r.prnstr.str;else if(null!=r.ia5str)t.ds="ia5",t.value=r.ia5str.str;else if(null!=r.visstr)t.ds="vis",t.value=r.visstr.str;else{if(null==r.bmpstr)throw"error";t.ds="bmp",t.value=r.bmpstr.str}return t}catch(e){throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},b=function(e){try{return e.set.map((function(e){return S(e)}))}catch(e){throw new Error("improper ASN.1 parsed RDN: "+e)}};this.getX500NameRule=function(e){for(var t=null,n=[],i=0;i<e.length;i++)for(var r=e[i],o=0;o<r.length;o++)n.push(r[o]);for(i=0;i<n.length;i++){var s=n[i],a=s.ds,u=s.value,l=s.type;if("prn"!=a&&"utf8"!=a&&"ia5"!=a)return"mixed";if("ia5"==a){if("CN"!=l)return"mixed";if(ue.lang.String.isMail(u))continue;return"mixed"}if("C"==l){if("prn"==a)continue;return"mixed"}if(null==t)t=a;else if(t!==a)return"mixed"}return null==t?"prn":t},this.getAttrTypeAndValue=function(e){var t=o(e);return S(t)},this.getRDN=function(e){var t=o(e);return b(t)},this.getX500NameArray=function(e){return function(e){try{return e.seq.map((function(e){return b(e)}))}catch(e){throw new Error("improper ASN.1 parsed X500Name: "+e)}}(o(e))},this.getX500Name=function(e,t,n){var i=this.getX500NameArray(e),r={str:this.dnarraytostr(i)};return r.array=i,1==n&&(r.hex=e),1==t&&(r.canon=this.c14nRDNArray(i)),r},this.readCertPEM=function(e){this.readCertHex(v(e))},this.readCertHex=function(e){this.hex=e,this.getVersion();try{d(this.hex,0,[0,7],"a3"),this.parseExt()}catch(e){}},this.getParam=function(e){var t={};return null==e&&(e={}),t.version=this.getVersion(),t.serial={hex:this.getSerialNumberHex()},t.sigalg=this.getSignatureAlgorithmField(),t.issuer=this.getIssuer(e.dncanon,e.dnhex),t.notbefore=this.getNotBefore(),t.notafter=this.getNotAfter(),t.subject=this.getSubject(e.dncanon,e.dnhex),t.sbjpubkey=_e(this.getPublicKeyHex(),"PUBLIC KEY"),null!=this.aExtInfo&&this.aExtInfo.length>0&&(t.ext=this.getExtParamArray()),t.sighex=this.getSignatureValueHex(),1==e.tbshex&&(t.tbshex=l(this.hex,0,[0])),1==e.nodnarray&&(delete t.issuer.array,delete t.subject.array),t},this.getExtParamArray=function(e){null==e&&-1!=h(this.hex,0,[0,"[3]"])&&(e=c(this.hex,0,[0,"[3]",0],"30"));for(var t=[],n=i(e,0),r=0;r<n.length;r++){var o=s(e,n[r]),a=this.getExtParam(o);null!=a&&t.push(a)}return t},this.getExtParam=function(e){var t=i(e,0).length;if(2!=t&&3!=t)throw new Error("wrong number elements in Extension: "+t+" "+e);var n=m(a(e,0,[0],"06")),r=!1;3==t&&"0101ff"==l(e,0,[1])&&(r=!0);var s=l(e,0,[t-1,0]),u=void 0;if("2.5.29.14"==n?u=this.getExtSubjectKeyIdentifier(s,r):"2.5.29.15"==n?u=this.getExtKeyUsage(s,r):"2.5.29.17"==n?u=this.getExtSubjectAltName(s,r):"2.5.29.18"==n?u=this.getExtIssuerAltName(s,r):"2.5.29.19"==n?u=this.getExtBasicConstraints(s,r):"2.5.29.30"==n?u=this.getExtNameConstraints(s,r):"2.5.29.31"==n?u=this.getExtCRLDistributionPoints(s,r):"2.5.29.32"==n?u=this.getExtCertificatePolicies(s,r):"2.5.29.33"==n?u=this.getExtPolicyMappings(s,r):"2.5.29.35"==n?u=this.getExtAuthorityKeyIdentifier(s,r):"2.5.29.36"==n?u=this.getExtPolicyConstraints(s,r):"2.5.29.37"==n?u=this.getExtExtKeyUsage(s,r):"2.5.29.54"==n?u=this.getExtInhibitAnyPolicy(s,r):"1.3.6.1.5.5.7.1.1"==n?u=this.getExtAuthorityInfoAccess(s,r):"2.5.29.20"==n?u=this.getExtCRLNumber(s,r):"2.5.29.21"==n?u=this.getExtCRLReason(s,r):"2.5.29.9"==n?u=this.getExtSubjectDirectoryAttributes(s,r):"1.3.6.1.5.5.7.48.1.2"==n?u=this.getExtOcspNonce(s,r):"1.3.6.1.5.5.7.48.1.5"==n?u=this.getExtOcspNoCheck(s,r):"1.2.840.113583.1.1.9.1"==n?u=this.getExtAdobeTimeStamp(s,r):null!=Qe.EXT_PARSER[n]&&(u=Qe.EXT_PARSER[n](n,r,s)),null!=u)return u;var c={extname:n,extn:s};try{c.extn=o(s)}catch(e){}return r&&(c.critical=!0),c},this.findExt=function(e,t){for(var n=0;n<e.length;n++)if(e[n].extname==t)return e[n];return null},this.updateExtCDPFullURI=function(e,t){var n=this.findExt(e,"cRLDistributionPoints");if(null!=n&&null!=n.array)for(var i=n.array,r=0;r<i.length;r++)if(null!=i[r].dpname&&null!=i[r].dpname.full)for(var o=i[r].dpname.full,s=0;s<o.length;s++){var a=o[r];null!=a.uri&&(a.uri=t)}},this.updateExtAIAOCSP=function(e,t){var n=this.findExt(e,"authorityInfoAccess");if(null!=n&&null!=n.array)for(var i=n.array,r=0;r<i.length;r++)null!=i[r].ocsp&&(i[r].ocsp=t)},this.updateExtAIACAIssuer=function(e,t){var n=this.findExt(e,"authorityInfoAccess");if(null!=n&&null!=n.array)for(var i=n.array,r=0;r<i.length;r++)null!=i[r].caissuer&&(i[r].caissuer=t)},this.dnarraytostr=function(e){return"/"+e.map((function(e){return function(e){return e.map((function(e){return function(e){return e.type+"="+e.value}(e).replace(/\+/,"\\+")})).join("+")}(e).replace(/\//,"\\/")})).join("/")},this.setCanonicalizedDN=function(e){var t;if(null!=e.str&&null==e.array){var n=new ue.asn1.x509.X500Name({str:e.str}).tohex();t=this.getX500NameArray(n)}else t=e.array;null==e.canon&&(e.canon=this.c14nRDNArray(t))},this.c14nRDNArray=function(e){for(var t=[],n=0;n<e.length;n++){for(var i=e[n],r=[],o=0;o<i.length;o++){var s=i[o],a=s.value;a=(a=(a=(a=a.replace(/^\s*/,"")).replace(/\s*$/,"")).replace(/\s+/g," ")).toLowerCase(),r.push(s.type.toLowerCase()+"="+a)}t.push(r.join("+"))}return"/"+t.join("/")},this.getInfo=function(){var e,t,n,i=function(e){for(var t="",n="    ",i="\n",r=e.array,o=0;o<r.length;o++){var s=r[o];null!=s.dn&&(t+=n+"dn: "+s.dn.str+i),null!=s.ip&&(t+=n+"ip: "+s.ip+i),null!=s.rfc822&&(t+=n+"rfc822: "+s.rfc822+i),null!=s.dns&&(t+=n+"dns: "+s.dns+i),null!=s.uri&&(t+=n+"uri: "+s.uri+i),null!=s.other&&(t+=n+"other: "+s.other.oid+"="+JSON.stringify(s.other.value).replace(/\"/g,"")+i)}return t.replace(/\n$/,"")},r=function(e){for(var t="",n=e.array,i=0;i<n.length;i++){var r=n[i];if(t+="    policy oid: "+r.policyoid+"\n",void 0!==r.array)for(var o=0;o<r.array.length;o++){var s=r.array[o];void 0!==s.cps&&(t+="    cps: "+s.cps+"\n")}}return t},o=function(e){for(var t="",n=e.array,i=0;i<n.length;i++){var r=n[i];try{void 0!==r.dpname.full[0].uri&&(t+="    "+r.dpname.full[0].uri+"\n")}catch(e){}try{void 0!==r.dname.full[0].dn.hex&&(t+="    "+Qe.hex2dn(r.dpname.full[0].dn.hex)+"\n")}catch(e){}}return t},s=function(e){for(var t="",n=e.array,i=0;i<n.length;i++){var r=n[i];void 0!==r.caissuer&&(t+="    caissuer: "+r.caissuer+"\n"),void 0!==r.ocsp&&(t+="    ocsp: "+r.ocsp+"\n")}return t};if(e="Basic Fields\n",e+="  serial number: "+this.getSerialNumberHex()+"\n",e+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",e+="  issuer: "+this.getIssuerString()+"\n",e+="  notBefore: "+this.getNotBefore()+"\n",e+="  notAfter: "+this.getNotAfter()+"\n",e+="  subject: "+this.getSubjectString()+"\n",e+="  subject public key info: \n",e+="    key algorithm: "+(t=this.getPublicKey()).type+"\n","RSA"===t.type&&(e+="    n="+Ve(t.n.toString(16)).substr(0,16)+"...\n",e+="    e="+Ve(t.e.toString(16))+"\n"),null!=(n=this.aExtInfo)){e+="X509v3 Extensions:\n";for(var a=0;a<n.length;a++){var u=n[a],l=ue.asn1.x509.OID.oid2name(u.oid);""===l&&(l=u.oid);var c="";if(!0===u.critical&&(c="CRITICAL"),e+="  "+l+" "+c+":\n","basicConstraints"===l){var d=this.getExtBasicConstraints();void 0===d.cA?e+="    {}\n":(e+="    cA=true",void 0!==d.pathLen&&(e+=", pathLen="+d.pathLen),e+="\n")}else{var h;if("policyMappings"==l)e+="    "+this.getExtPolicyMappings().array.map((function(e){var t=e;return t[0]+":"+t[1]})).join(", ")+"\n";else if("policyConstraints"==l)e+="    ",null!=(h=this.getExtPolicyConstraints()).reqexp&&(e+=" reqexp="+h.reqexp),null!=h.inhibit&&(e+=" inhibit="+h.inhibit),e+="\n";else if("inhibitAnyPolicy"==l)e+="    skip="+(h=this.getExtInhibitAnyPolicy()).skip+"\n";else if("keyUsage"==l)e+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"==l)e+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"==l){var p=this.getExtAuthorityKeyIdentifier();void 0!==p.kid&&(e+="    kid="+p.kid.hex+"\n")}else"extKeyUsage"==l?e+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"==l?e+=i(this.getExtSubjectAltName())+"\n":"cRLDistributionPoints"==l?e+=o(this.getExtCRLDistributionPoints()):"authorityInfoAccess"==l?e+=s(this.getExtAuthorityInfoAccess()):"certificatePolicies"==l&&(e+=r(this.getExtCertificatePolicies()))}}}return(e+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n")+"signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?this.readCertPEM(e):ue.lang.String.isHex(e)&&this.readCertHex(e))}We.getKey=function(e,t,n){var i,r=(v=de).getChildIdx,o=(v.getV,v.getVbyList),s=ue.crypto,a=s.ECDSA,u=s.DSA,l=ie,c=Ie,d=We;if(void 0!==l&&e instanceof l)return e;if(void 0!==a&&e instanceof a)return e;if(void 0!==u&&e instanceof u)return e;if(void 0!==e.curve&&void 0!==e.xy&&void 0===e.d)return new a({pub:e.xy,curve:e.curve});if(void 0!==e.curve&&void 0!==e.d)return new a({prv:e.d,curve:e.curve});if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(O=new l).setPublic(e.n,e.e),O;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.co&&void 0===e.qi)return(O=new l).setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),O;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0===e.p)return(O=new l).setPrivate(e.n,e.e,e.d),O;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0===e.x)return(O=new u).setPublic(e.p,e.q,e.g,e.y),O;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0!==e.x)return(O=new u).setPrivate(e.p,e.q,e.g,e.y,e.x),O;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(O=new l).setPublic(ve(e.n),ve(e.e)),O;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.qi)return(O=new l).setPrivateEx(ve(e.n),ve(e.e),ve(e.d),ve(e.p),ve(e.q),ve(e.dp),ve(e.dq),ve(e.qi)),O;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d)return(O=new l).setPrivate(ve(e.n),ve(e.e),ve(e.d)),O;if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0===e.d){var h=(R=new a({curve:e.crv})).ecparams.keycharlen,p="04"+("0000000000"+ve(e.x)).slice(-h)+("0000000000"+ve(e.y)).slice(-h);return R.setPublicKeyHex(p),R}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0!==e.d){h=(R=new a({curve:e.crv})).ecparams.keycharlen,p="04"+("0000000000"+ve(e.x)).slice(-h)+("0000000000"+ve(e.y)).slice(-h);var f=("0000000000"+ve(e.d)).slice(-h);return R.setPublicKeyHex(p),R.setPrivateKeyHex(f),R}if("pkcs5prv"===n){var g,m=e,v=de;if(9===(g=r(m,0)).length)(O=new l).readPKCS5PrvKeyHex(m);else if(6===g.length)(O=new u).readPKCS5PrvKeyHex(m);else{if(!(g.length>2&&"04"===m.substr(g[1],2)))throw new Error("unsupported PKCS#1/5 hexadecimal key");(O=new a).readPKCS5PrvKeyHex(m)}return O}if("pkcs8prv"===n)return d.getKeyFromPlainPrivatePKCS8Hex(e);if("pkcs8pub"===n)return d._getKeyFromPublicPKCS8Hex(e);if("x509pub"===n)return Qe.getPublicKeyFromCertHex(e);if(-1!=e.indexOf("-END CERTIFICATE-",0)||-1!=e.indexOf("-END X509 CERTIFICATE-",0)||-1!=e.indexOf("-END TRUSTED CERTIFICATE-",0))return Qe.getPublicKeyFromCertPEM(e);if(-1!=e.indexOf("-END PUBLIC KEY-")){var y=Ie(e,"PUBLIC KEY");return d._getKeyFromPublicPKCS8Hex(y)}if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var S=c(e,"RSA PRIVATE KEY");return d.getKey(S,null,"pkcs5prv")}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var b=o(i=c(e,"DSA PRIVATE KEY"),0,[1],"02"),w=o(i,0,[2],"02"),_=o(i,0,[3],"02"),I=o(i,0,[4],"02"),C=o(i,0,[5],"02");return(O=new u).setPrivate(new E(b,16),new E(w,16),new E(_,16),new E(I,16),new E(C,16)),O}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED"))return S=c(e,"EC PRIVATE KEY"),d.getKey(S,null,"pkcs5prv");if(-1!=e.indexOf("-END PRIVATE KEY-"))return d.getKeyFromPlainPrivatePKCS8PEM(e);if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var A=d.getDecryptedKeyHex(e,t),T=new ie;return T.readPKCS5PrvKeyHex(A),T}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var R,O=o(i=d.getDecryptedKeyHex(e,t),0,[1],"04"),P=o(i,0,[2,0],"06"),D=o(i,0,[3,0],"03").substr(2);if(void 0===ue.crypto.OID.oidhex2name[P])throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+P);return(R=new a({curve:ue.crypto.OID.oidhex2name[P]})).setPublicKeyHex(D),R.setPrivateKeyHex(O),R.isPublic=!1,R}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED"))return b=o(i=d.getDecryptedKeyHex(e,t),0,[1],"02"),w=o(i,0,[2],"02"),_=o(i,0,[3],"02"),I=o(i,0,[4],"02"),C=o(i,0,[5],"02"),(O=new u).setPrivate(new E(b,16),new E(w,16),new E(_,16),new E(I,16),new E(C,16)),O;if(-1!=e.indexOf("-END ENCRYPTED PRIVATE KEY-"))return d.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")},We.generateKeypair=function(e,t){if("RSA"==e){var n=t;(s=new ie).generate(n,"10001"),s.isPrivate=!0,s.isPublic=!0;var i=new ie,r=s.n.toString(16),o=s.e.toString(16);return i.setPublic(r,o),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=i,a}if("EC"==e){var s,a,u=t,l=new ue.crypto.ECDSA({curve:u}).generateKeyPairHex();return(s=new ue.crypto.ECDSA({curve:u})).setPublicKeyHex(l.ecpubhex),s.setPrivateKeyHex(l.ecprvhex),s.isPrivate=!0,s.isPublic=!1,(i=new ue.crypto.ECDSA({curve:u})).setPublicKeyHex(l.ecpubhex),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=i,a}throw new Error("unknown algorithm: "+e)},We.getPEM=function(e,t,n,i,r,o){var s=ue,a=s.asn1,u=a.DERObjectIdentifier,l=a.DERInteger,c=a.ASN1Util.newObject,d=a.x509.SubjectPublicKeyInfo,h=s.crypto,p=h.DSA,f=h.ECDSA,g=ie;function m(e){return c({seq:[{int:0},{int:{bigint:e.n}},{int:e.e},{int:{bigint:e.d}},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.dmp1}},{int:{bigint:e.dmq1}},{int:{bigint:e.coeff}}]})}function v(e){return c({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a0",!0,{oid:{name:e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]})}function y(e){return c({seq:[{int:0},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}},{int:{bigint:e.y}},{int:{bigint:e.x}}]})}if((void 0!==g&&e instanceof g||void 0!==p&&e instanceof p||void 0!==f&&e instanceof f)&&1==e.isPublic&&(void 0===t||"PKCS8PUB"==t))return _e(w=new d(e).tohex(),"PUBLIC KEY");if("PKCS1PRV"==t&&void 0!==g&&e instanceof g&&(void 0===n||null==n)&&1==e.isPrivate)return _e(w=m(e).tohex(),"RSA PRIVATE KEY");if("PKCS1PRV"==t&&void 0!==f&&e instanceof f&&(void 0===n||null==n)&&1==e.isPrivate){var S=new u({name:e.curveName}).tohex(),b=v(e).tohex(),E="";return(E+=_e(S,"EC PARAMETERS"))+_e(b,"EC PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==p&&e instanceof p&&(void 0===n||null==n)&&1==e.isPrivate)return _e(w=y(e).tohex(),"DSA PRIVATE KEY");if("PKCS5PRV"==t&&void 0!==g&&e instanceof g&&void 0!==n&&null!=n&&1==e.isPrivate){var w=m(e).tohex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",w,n,i,o)}if("PKCS5PRV"==t&&void 0!==f&&e instanceof f&&void 0!==n&&null!=n&&1==e.isPrivate)return w=v(e).tohex(),void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",w,n,i,o);if("PKCS5PRV"==t&&void 0!==p&&e instanceof p&&void 0!==n&&null!=n&&1==e.isPrivate)return w=y(e).tohex(),void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",w,n,i,o);var _=function(e,t){if("string"==typeof t)return We.getEncryptedPKCS8PEM(e,t);if("object"==typeof t&&null!=Ke(t,"passcode")){var n=JSON.parse(JSON.stringify(t)),i=n.passcode;return delete n.passcode,We.getEncryptedPKCS8PEM(e,i,n)}};if("PKCS8PRV"==t&&null!=g&&e instanceof g&&1==e.isPrivate){var I=m(e).tohex();return w=c({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:I}}]}).tohex(),void 0===n||null==n?_e(w,"PRIVATE KEY"):_(w,n)}if("PKCS8PRV"==t&&void 0!==f&&e instanceof f&&1==e.isPrivate){var C={seq:[{int:1},{octstr:{hex:e.prvKeyHex}}]};return"string"==typeof e.pubKeyHex&&C.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}),I=new c(C).tohex(),w=c({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:I}}]}).tohex(),void 0===n||null==n?_e(w,"PRIVATE KEY"):_(w,n)}if("PKCS8PRV"==t&&void 0!==p&&e instanceof p&&1==e.isPrivate)return I=new l({bigint:e.x}).tohex(),w=c({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:I}}]}).tohex(),void 0===n||null==n?_e(w,"PRIVATE KEY"):_(w,n);throw new Error("unsupported object nor format")},We.getKeyFromCSRPEM=function(e){var t=Ie(e,"CERTIFICATE REQUEST");return We.getKeyFromCSRHex(t)},We.getKeyFromCSRHex=function(e){var t=We.parseCSRHex(e);return We.getKey(t.p8pubkeyhex,null,"pkcs8pub")},We.parseCSRHex=function(e){var t=de,n=t.getChildIdx,i=t.getTLV,r={},o=e;if("30"!=o.substr(0,2))throw new Error("malformed CSR(code:001)");var s=n(o,0);if(s.length<1)throw new Error("malformed CSR(code:002)");if("30"!=o.substr(s[0],2))throw new Error("malformed CSR(code:003)");var a=n(o,s[0]);if(a.length<3)throw new Error("malformed CSR(code:004)");return r.p8pubkeyhex=i(o,a[2]),r},We.getKeyID=function(e){var t=We,n=de;"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&(e=t.getKey(e));var i=Ie(t.getPEM(e)),r=n.getIdxbyList(i,0,[1]),o=n.getV(i,r).substring(2);return ue.crypto.Util.hashHex(o,"sha1")},We.getJWK=function(e,t,n,i,r){var o,s,a={},u=ue.crypto.Util.hashHex;if("string"==typeof e)o=We.getKey(e),-1!=e.indexOf("CERTIFICATE")&&(s=Ie(e));else{if("object"!=typeof e)throw new Error("unsupported keyinfo type");e instanceof Qe?(o=e.getPublicKey(),s=e.hex):o=e}if(o instanceof ie&&o.isPrivate)a.kty="RSA",a.n=me(o.n.toString(16)),a.e=me(o.e.toString(16)),a.d=me(o.d.toString(16)),a.p=me(o.p.toString(16)),a.q=me(o.q.toString(16)),a.dp=me(o.dmp1.toString(16)),a.dq=me(o.dmq1.toString(16)),a.qi=me(o.coeff.toString(16));else if(o instanceof ie&&o.isPublic)a.kty="RSA",a.n=me(o.n.toString(16)),a.e=me(o.e.toString(16));else if(o instanceof ue.crypto.ECDSA&&o.isPrivate){if("P-256"!==(c=o.getShortNISTPCurveName())&&"P-384"!==c&&"P-521"!==c)throw new Error("unsupported curve name for JWT: "+c);var l=o.getPublicKeyXYHex();a.kty="EC",a.crv=c,a.x=me(l.x),a.y=me(l.y),a.d=me(o.prvKeyHex)}else if(o instanceof ue.crypto.ECDSA&&o.isPublic){var c;if("P-256"!==(c=o.getShortNISTPCurveName())&&"P-384"!==c&&"P-521"!==c)throw new Error("unsupported curve name for JWT: "+c);l=o.getPublicKeyXYHex(),a.kty="EC",a.crv=c,a.x=me(l.x),a.y=me(l.y)}if(null==a.kty)throw new Error("unsupported keyinfo");return o.isPrivate||1==t||(a.kid=ue.jws.JWS.getJWKthumbprint(a)),null!=s&&1!=n&&(a.x5c=[S(s)]),null!=s&&1!=i&&(a.x5t=fe(S(u(s,"sha1")))),null!=s&&1!=r&&(a["x5t#S256"]=fe(S(u(s,"sha256")))),a},We.getJWKFromKey=function(e){return We.getJWK(e,!0,!0,!0,!0)},ie.getPosArrayOfChildrenFromHex=function(e){return de.getChildIdx(e,0)},ie.getHexValueArrayOfChildrenFromHex=function(e){var t,n=de.getV,i=n(e,(t=ie.getPosArrayOfChildrenFromHex(e))[0]),r=n(e,t[1]),o=n(e,t[2]),s=n(e,t[3]),a=n(e,t[4]),u=n(e,t[5]),l=n(e,t[6]),c=n(e,t[7]),d=n(e,t[8]);return(t=new Array).push(i,r,o,s,a,u,l,c,d),t},ie.prototype.readPrivateKeyFromPEMString=function(e){var t=Ie(e),n=ie.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},ie.prototype.readPKCS5PrvKeyHex=function(e){var t=ie.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},ie.prototype.readPKCS8PrvKeyHex=function(e){var t,n,i,r,o,s,a,u,l=de,c=l.getVbyListEx;if(!1===l.isASN1HEX(e))throw new Error("not ASN.1 hex string");try{t=c(e,0,[2,0,1],"02"),n=c(e,0,[2,0,2],"02"),i=c(e,0,[2,0,3],"02"),r=c(e,0,[2,0,4],"02"),o=c(e,0,[2,0,5],"02"),s=c(e,0,[2,0,6],"02"),a=c(e,0,[2,0,7],"02"),u=c(e,0,[2,0,8],"02")}catch(e){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,n,i,r,o,s,a,u)},ie.prototype.readPKCS5PubKeyHex=function(e){var t=de,n=t.getV;if(!1===t.isASN1HEX(e))throw new Error("keyHex is not ASN.1 hex string");var i=t.getChildIdx(e,0);if(2!==i.length||"02"!==e.substr(i[0],2)||"02"!==e.substr(i[1],2))throw new Error("wrong hex for PKCS#5 public key");var r=n(e,i[0]),o=n(e,i[1]);this.setPublic(r,o)},ie.prototype.readPKCS8PubKeyHex=function(e){var t=de;if(!1===t.isASN1HEX(e))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==t.getTLVbyListEx(e,0,[0,0]))throw new Error("not PKCS8 RSA public key");var n=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(n)},ie.prototype.readCertPubKeyHex=function(e,t){var n,i;(n=new Qe).readCertHex(e),i=n.getPublicKeyHex(),this.readPKCS8PubKeyHex(i)},ie.prototype.sign=function(e,t){var n=function(e){return ue.crypto.Util.hashString(e,t)}(e);return this.signWithMessageHash(n,t)},ie.prototype.signWithMessageHash=function(e,t){var n=ne(ue.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),16);return Ge(this.doPrivate(n).toString(16),this.n.bitLength())},ie.prototype.signPSS=function(e,t,n){var i,r=(i=we(e),ue.crypto.Util.hashHex(i,t));return void 0===n&&(n=-1),this.signWithMessageHashPSS(r,t,n)},ie.prototype.signWithMessageHashPSS=function(e,t,n){var i,r=Ee(e),o=r.length,s=this.n.bitLength()-1,a=Math.ceil(s/8),u=function(e){return ue.crypto.Util.hashHex(e,t)};if(-1===n||void 0===n)n=o;else if(-2===n)n=a-o-2;else if(n<-2)throw new Error("invalid salt length");if(a<o+n+2)throw new Error("data too long");var l="";n>0&&(l=new Array(n),(new te).nextBytes(l),l=String.fromCharCode.apply(String,l));var c=Ee(u(we("\0\0\0\0\0\0\0\0"+r+l))),d=[];for(i=0;i<a-n-o-2;i+=1)d[i]=0;var h=String.fromCharCode.apply(String,d)+""+l,p=ze(c,h.length,u),f=[];for(i=0;i<h.length;i+=1)f[i]=h.charCodeAt(i)^p.charCodeAt(i);var g=65280>>8*a-s&255;for(f[0]&=~g,i=0;i<o;i++)f.push(c.charCodeAt(i));return f.push(188),Ge(this.doPrivate(new E(f)).toString(16),this.n.bitLength())},ie.prototype.verify=function(e,t){if(null==(t=t.toLowerCase()).match(/^[0-9a-f]+$/))return!1;var n=ne(t,16),i=this.n.bitLength();if(n.bitLength()>i)return!1;var r=this.doPublic(n).toString(16);if(r.length+3!=i/4)return!1;var o=Je(r.replace(/^1f+00/,""));if(0==o.length)return!1;var s=o[0],a=o[1],u=function(e){return ue.crypto.Util.hashString(e,s)}(e);return a==u},ie.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var n=ne(t,16);if(n.bitLength()>this.n.bitLength())return 0;var i=Je(this.doPublic(n).toString(16).replace(/^1f+00/,""));return 0!=i.length&&(i[0],i[1]==e)},ie.prototype.verifyPSS=function(e,t,n,i){var r,o=(r=we(e),ue.crypto.Util.hashHex(r,n));return void 0===i&&(i=-1),this.verifyWithMessageHashPSS(o,t,n,i)},ie.prototype.verifyWithMessageHashPSS=function(e,t,n,i){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var r,o=new E(t,16),s=function(e){return ue.crypto.Util.hashHex(e,n)},a=Ee(e),u=a.length,l=this.n.bitLength()-1,c=Math.ceil(l/8);if(-1===i||void 0===i)i=u;else if(-2===i)i=c-u-2;else if(i<-2)throw new Error("invalid salt length");if(c<u+i+2)throw new Error("data too long");var d=this.doPublic(o).toByteArray();for(r=0;r<d.length;r+=1)d[r]&=255;for(;d.length<c;)d.unshift(0);if(188!==d[c-1])throw new Error("encoded message does not end in 0xbc");var h=(d=String.fromCharCode.apply(String,d)).substr(0,c-u-1),p=d.substr(h.length,u),f=65280>>8*c-l&255;if(h.charCodeAt(0)&f)throw new Error("bits beyond keysize not zero");var g=ze(p,h.length,s),m=[];for(r=0;r<h.length;r+=1)m[r]=h.charCodeAt(r)^g.charCodeAt(r);m[0]&=~f;var v=c-u-i-2;for(r=0;r<v;r+=1)if(0!==m[r])throw new Error("leftmost octets not zero");if(1!==m[v])throw new Error("0x01 marker not found");return p===Ee(s(we("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,m.slice(-i)))))},ie.SALT_LEN_HLEN=-1,ie.SALT_LEN_MAX=-2,ie.SALT_LEN_RECOVER=-2,Qe.EXT_PARSER={},Qe.registExtParser=function(e,t){Qe.EXT_PARSER[e]=t},Qe.hex2dn=function(e,t){void 0===t&&(t=0);var n=new Qe;return de.getTLV(e,t),n.getX500Name(e).str},Qe.hex2rdn=function(e,t){if(void 0===t&&(t=0),"31"!==e.substr(t,2))throw new Error("malformed RDN");for(var n=new Array,i=de.getChildIdx(e,t),r=0;r<i.length;r++)n.push(Qe.hex2attrTypeValue(e,i[r]));return n=n.map((function(e){return e.replace("+","\\+")})),n.join("+")},Qe.hex2attrTypeValue=function(e,t){var n=de,i=n.getV;if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw new Error("malformed attribute type and value");var r=n.getChildIdx(e,t);2!==r.length||e.substr(r[0],2);var o=i(e,r[0]),s=ue.asn1.ASN1Util.oidHexToInt(o);return ue.asn1.x509.OID.oid2atype(s)+"="+Ee(i(e,r[1]))},Qe.getPublicKeyFromCertHex=function(e){var t=new Qe;return t.readCertHex(e),t.getPublicKey()},Qe.getPublicKeyFromCertPEM=function(e){var t=new Qe;return t.readCertPEM(e),t.getPublicKey()},Qe.getPublicKeyInfoPropOfCertPEM=function(e){var t,n,i=de.getVbyList,r={algparam:null};return(t=new Qe).readCertPEM(e),n=t.getPublicKeyHex(),r.keyhex=i(n,0,[1],"03").substr(2),r.algoid=i(n,0,[0,0],"06"),"2a8648ce3d0201"===r.algoid&&(r.algparam=i(n,0,[0,1],"06")),r},Qe.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==ue&&ue||(ue={}),void 0!==ue.jws&&ue.jws||(ue.jws={}),ue.jws.JWS=function(){var e=ue.jws.JWS.isSafeJSONString;this.parseJWS=function(t,n){if(void 0===this.parsedJWS||!n&&void 0===this.parsedJWS.sigvalH){var i=t.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==i)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var r=i[1],o=i[2],s=i[3],a=r+"."+o;if(this.parsedJWS={},this.parsedJWS.headB64U=r,this.parsedJWS.payloadB64U=o,this.parsedJWS.sigvalB64U=s,this.parsedJWS.si=a,!n){var u=ve(s),l=ne(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=l}var c=ce(r),d=ce(o);if(this.parsedJWS.headS=c,this.parsedJWS.payloadS=d,!e(c,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+c}}},ue.jws.JWS.sign=function(e,t,n,i,r){var o,s,a,u=ue,l=u.jws.JWS,c=l.readSafeJSONString,d=l.isSafeJSONString,h=u.crypto,p=(h.ECDSA,h.Mac),f=h.Signature,g=JSON;if("string"!=typeof t&&"object"!=typeof t)throw"spHeader must be JSON string or object: "+t;if("object"==typeof t&&(s=t,o=g.stringify(s)),"string"==typeof t){if(!d(o=t))throw"JWS Head is not safe JSON string: "+o;s=c(o)}if(a=n,"object"==typeof n&&(a=g.stringify(n)),""!=e&&null!=e||void 0===s.alg||(e=s.alg),""!=e&&null!=e&&void 0===s.alg&&(s.alg=e,o=g.stringify(s)),e!==s.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+s.alg;var m=null;if(void 0===l.jwsalg2sigalg[e])throw"unsupported alg name: "+e;m=l.jwsalg2sigalg[e];var v=le(o)+"."+le(a),y="";if("Hmac"==m.substr(0,4)){if(void 0===i)throw"mac key shall be specified for HS* alg";var S=new p({alg:m,prov:"cryptojs",pass:i});S.updateString(v),y=S.doFinal()}else if(-1!=m.indexOf("withECDSA")){(E=new f({alg:m})).init(i,r),E.updateString(v);var b=E.sign();y=ue.crypto.ECDSA.asn1SigToConcatSig(b)}else{var E;"none"!=m&&((E=new f({alg:m})).init(i,r),E.updateString(v),y=E.sign())}return v+"."+me(y)},ue.jws.JWS.verify=function(e,t,n){var i,r=ue,o=r.jws.JWS,s=o.readSafeJSONString,a=r.crypto,u=a.ECDSA,l=a.Mac,c=a.Signature;if(i=ie,!Le(e))return!1;var d=e.split(".");if(3!==d.length)return!1;var h,p=d[0]+"."+d[1],f=ve(d[2]),g=s(ce(d[0])),m=null;if(void 0===g.alg)throw"algorithm not specified in header";if(h=(m=g.alg).substr(0,2),null!=n&&"[object Array]"===Object.prototype.toString.call(n)&&n.length>0&&-1==(":"+n.join(":")+":").indexOf(":"+m+":"))throw"algorithm '"+m+"' not accepted in the list";if("none"!=m&&null===t)throw"key shall be specified to verify.";if("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&(t=We.getKey(t)),!("RS"!=h&&"PS"!=h||t instanceof i))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==h&&!(t instanceof u))throw"key shall be a ECDSA obj for ES* algs";var v=null;if(void 0===o.jwsalg2sigalg[g.alg])throw"unsupported alg name: "+m;if("none"==(v=o.jwsalg2sigalg[m]))throw"not supported";if("Hmac"==v.substr(0,4)){if(void 0===t)throw"hexadecimal key shall be specified for HMAC";var y=new l({alg:v,pass:t});return y.updateString(p),f==y.doFinal()}if(-1!=v.indexOf("withECDSA")){var S,b=null;try{b=u.concatSigToASN1Sig(f)}catch(e){return!1}return(S=new c({alg:v})).init(t),S.updateString(p),S.verify(b)}return(S=new c({alg:v})).init(t),S.updateString(p),S.verify(f)},ue.jws.JWS.parse=function(e){var t,n,i,r=e.split("."),o={};if(2!=r.length&&3!=r.length)throw"malformed sJWS: wrong number of '.' splitted elements";return t=r[0],n=r[1],3==r.length&&(i=r[2]),o.headerObj=ue.jws.JWS.readSafeJSONString(ce(t)),o.payloadObj=ue.jws.JWS.readSafeJSONString(ce(n)),o.headerPP=JSON.stringify(o.headerObj,null,"  "),null==o.payloadObj?o.payloadPP=ce(n):o.payloadPP=JSON.stringify(o.payloadObj,null,"  "),void 0!==i&&(o.sigHex=ve(i)),o},ue.jws.JWS.verifyJWT=function(e,t,n){var i=ue.jws,r=i.JWS,o=r.readSafeJSONString,s=r.inArray,a=r.includedArray;if(!Le(e))return!1;var u=e.split(".");if(3!=u.length)return!1;var l=u[0],c=u[1],d=(ve(u[2]),o(ce(l))),h=o(ce(c));if(void 0===d.alg)return!1;if(void 0===n.alg)throw"acceptField.alg shall be specified";if(!s(d.alg,n.alg))return!1;if(void 0!==h.iss&&"object"==typeof n.iss&&!s(h.iss,n.iss))return!1;if(void 0!==h.sub&&"object"==typeof n.sub&&!s(h.sub,n.sub))return!1;if(void 0!==h.aud&&"object"==typeof n.aud)if("string"==typeof h.aud){if(!s(h.aud,n.aud))return!1}else if("object"==typeof h.aud&&!a(h.aud,n.aud))return!1;var p=i.IntDate.getNow();return void 0!==n.verifyAt&&"number"==typeof n.verifyAt&&(p=n.verifyAt),void 0!==n.gracePeriod&&"number"==typeof n.gracePeriod||(n.gracePeriod=0),!(void 0!==h.exp&&"number"==typeof h.exp&&h.exp+n.gracePeriod<p||void 0!==h.nbf&&"number"==typeof h.nbf&&p<h.nbf-n.gracePeriod||void 0!==h.iat&&"number"==typeof h.iat&&p<h.iat-n.gracePeriod||void 0!==h.jti&&void 0!==n.jti&&h.jti!==n.jti||!r.verify(e,t,n.alg))},ue.jws.JWS.includedArray=function(e,t){var n=ue.jws.JWS.inArray;if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t))return!1;return!0},ue.jws.JWS.inArray=function(e,t){if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},ue.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},ue.jws.JWS.isSafeJSONString=function(e,t,n){var i=null;try{return"object"!=typeof(i=ae(e))||i.constructor===Array?0:(t&&(t[n]=i),1)}catch(e){return 0}},ue.jws.JWS.readSafeJSONString=function(e){var t=null;try{return"object"!=typeof(t=ae(e))||t.constructor===Array?null:t}catch(e){return null}},ue.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==t)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},ue.jws.JWS.getJWKthumbprint=function(e){if("RSA"!==e.kty&&"EC"!==e.kty&&"oct"!==e.kty)throw"unsupported algorithm for JWK Thumprint";var t="{";if("RSA"===e.kty){if("string"!=typeof e.n||"string"!=typeof e.e)throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if("EC"===e.kty){if("string"!=typeof e.crv||"string"!=typeof e.x||"string"!=typeof e.y)throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if("oct"===e.kty){if("string"!=typeof e.k)throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var n=we(t);return me(ue.crypto.Util.hashHex(n,"sha256"))},ue.jws.IntDate={},ue.jws.IntDate.get=function(e){var t=ue.jws.IntDate,n=t.getNow,i=t.getZulu;if("now"==e)return n();if("now + 1hour"==e)return n()+3600;if("now + 1day"==e)return n()+86400;if("now + 1month"==e)return n()+2592e3;if("now + 1year"==e)return n()+31536e3;if(e.match(/Z$/))return i(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},ue.jws.IntDate.getZulu=function(e){return Ce(e)},ue.jws.IntDate.getNow=function(){return~~(new Date/1e3)},ue.jws.IntDate.intDate2UTCString=function(e){return new Date(1e3*e).toUTCString()},ue.jws.IntDate.intDate2Zulu=function(e){var t=new Date(1e3*e);return("0000"+t.getUTCFullYear()).slice(-4)+("00"+(t.getUTCMonth()+1)).slice(-2)+("00"+t.getUTCDate()).slice(-2)+("00"+t.getUTCHours()).slice(-2)+("00"+t.getUTCMinutes()).slice(-2)+("00"+t.getUTCSeconds()).slice(-2)+"Z"},void 0!==ue&&ue||(ue={}),void 0!==ue.jws&&ue.jws||(ue.jws={}),ue.jws.JWSJS=function(){var e=ue.jws.JWS,t=e.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(e){this.init();var t=e.split(".");if(3!=t.length)throw"malformed input JWS";this.aHeader.push(t[0]),this.sPayload=t[1],this.aSignature.push(t[2])},this.addSignature=function(e,t,n,i){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var r=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var o=ue.jws.JWS.sign(e,t,this.sPayload,n,i).split(".");o[0],o[2],this.aHeader.push(o[0]),this.aSignature.push(o[2])}catch(e){throw this.aHeader.length>r&&this.aHeader.pop(),this.aSignature.length>r&&this.aSignature.pop(),"addSignature failed: "+e}},this.verifyAll=function(e){if(this.aHeader.length!==e.length||this.aSignature.length!==e.length)return!1;for(var t=0;t<e.length;t++){var n=e[t];if(2!==n.length)return!1;if(!1===this.verifyNth(t,n[0],n[1]))return!1}return!0},this.verifyNth=function(t,n,i){if(this.aHeader.length<=t||this.aSignature.length<=t)return!1;var r=this.aHeader[t],o=this.aSignature[t],s=r+"."+this.sPayload+"."+o,a=!1;try{a=e.verify(s,n,i)}catch(e){return!1}return a},this.readJWSJS=function(e){if("string"==typeof e){var n=t(e);if(null==n)throw"argument is not safe JSON object string";this.aHeader=n.headers,this.sPayload=n.payload,this.aSignature=n.signatures}else try{if(!(e.headers.length>0))throw"malformed header";if(this.aHeader=e.headers,"string"!=typeof e.payload)throw"malformed signatures";if(this.sPayload=e.payload,!(e.signatures.length>0))throw"malformed signatures";this.aSignature=e.signatures}catch(e){throw"malformed JWS-JS JSON object: "+e}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}},ue.crypto.ECDSA,ue.crypto.DSA,ue.crypto.Signature,ue.crypto.MessageDigest,ue.crypto.Mac,ue.crypto,ue.asn1,t.hT=ue.jws,ue.lang},606:e=>{var t,n,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var a,u=[],l=!1,c=-1;function d(){l&&a&&(l=!1,a.length?u=a.concat(u):c=-1,u.length&&h())}function h(){if(!l){var e=s(d);l=!0;for(var t=u.length;t;){for(a=u,u=[];++c<t;)a&&a[c].run();c=-1,t=u.length}a=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";const e=function(e,n){if(!e)throw t(n)},t=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},i=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},r={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const r=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,u=a?e[t+2]:0,l=r>>2,c=(3&r)<<4|s>>4;let d=(15&s)<<2|u>>6,h=63&u;a||(h=64,o||(d=64)),i.push(n[l],n[c],n[d],n[h])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const o=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&o)}else if(r>239&&r<365){const o=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(o>>10)),t[i++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){const r=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const u=t<e.length?n[e.charAt(t)]:64;if(++t,null==r||null==s||null==a||null==u)throw new o;const l=r<<2|s>>4;if(i.push(l),64!==a){const e=s<<4&240|a>>2;if(i.push(e),64!==u){const e=a<<6&192|u;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const s=function(e){const t=i(e);return r.encodeByteArray(t,!0)},a=function(e){return s(e).replace(/\./g,"")},u=function(e){try{return r.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(e){return c(void 0,e)}function c(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=c(e[n],t[n]));return e}const d=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&u(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},h=e=>{var t,n;return null===(n=null===(t=d())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},p=()=>{var e;return null===(e=d())||void 0===e?void 0:e.config},f=e=>{var t;return null===(t=d())||void 0===t?void 0:t[`_${e}`]};class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function m(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())}function y(){return"object"==typeof navigator&&"ReactNative"===navigator.product}class S extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,S.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b.prototype.create)}}class b{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?function(e,t){return e.replace(E,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",s=`${this.serviceName}: ${o} (${i}).`;return new S(i,s,n)}}const E=/\{\$([^}]+)}/g;function w(e){return JSON.parse(e)}function _(e){return JSON.stringify(e)}const I=function(e){let t={},n={},i={},r="";try{const o=e.split(".");t=w(u(o[0])||""),n=w(u(o[1])||""),r=o[2],i=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:i,signature:r}};function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function T(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function R(e,t,n){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function O(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],o=t[r];if(P(n)&&P(o)){if(!O(n,o))return!1}else if(n!==o)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function P(e){return null!==e&&"object"==typeof e}function D(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function k(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function x(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class N{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let i=0;i<16;i++)n[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let i,r,o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],u=this.chain_[3],l=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(i=u^s&(a^u),r=1518500249):(i=s^a^u,r=1859775393):e<60?(i=s&a|u&(s|a),r=2400959708):(i=s^a^u,r=3395469782);const t=(o<<5|o>>>27)+i+l+r+n[e]&4294967295;l=u,u=a,a=4294967295&(s<<30|s>>>2),s=o,o=t}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let i=0;const r=this.buf_;let o=this.inbuf_;for(;i<t;){if(0===o)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(r[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}else for(;i<t;)if(r[o]=e[i],++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let i=24;i>=0;i-=8)e[n]=this.chain_[t]>>i&255,++n;return e}}class M{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=F),void 0===i.error&&(i.error=F),void 0===i.complete&&(i.complete=F);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function F(){}function L(e,t){return`${e} failed: ${t} argument `}const V=function(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,n++):t+=3}return t};function j(e){return e&&e._delegate?e._delegate:e}class B{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const U="[DEFAULT]";class H{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new g;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:U})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=U){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=U){return this.instances.has(e)}getOptions(e=U){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===U?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e=U){return this.component?this.component.multipleInstances?e:U:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class q{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new H(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const K=[];var $;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}($||($={}));const W={debug:$.DEBUG,verbose:$.VERBOSE,info:$.INFO,warn:$.WARN,error:$.ERROR,silent:$.SILENT},G=$.INFO,z={[$.DEBUG]:"log",[$.VERBOSE]:"log",[$.INFO]:"info",[$.WARN]:"warn",[$.ERROR]:"error"},J=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=z[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...n)};class Q{constructor(e){this.name=e,this._logLevel=G,this._logHandler=J,this._userLogHandler=null,K.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?W[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$.DEBUG,...e),this._logHandler(this,$.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$.VERBOSE,...e),this._logHandler(this,$.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$.INFO,...e),this._logHandler(this,$.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$.WARN,...e),this._logHandler(this,$.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$.ERROR,...e),this._logHandler(this,$.ERROR,...e)}}const Y=(e,t)=>t.some((t=>e instanceof t));let Z,X;const ee=new WeakMap,te=new WeakMap,ne=new WeakMap,ie=new WeakMap,re=new WeakMap;let oe={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return te.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ne.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ae(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function se(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(X||(X=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(ue(this),e),ae(ee.get(this))}:function(...e){return ae(t.apply(ue(this),e))}:function(e,...n){const i=t.call(ue(this),e,...n);return ne.set(i,e.sort?e.sort():[e]),ae(i)}:(e instanceof IDBTransaction&&function(e){if(te.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",o),e.removeEventListener("abort",o)},r=()=>{t(),i()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",o),e.addEventListener("abort",o)}));te.set(e,t)}(e),Y(e,Z||(Z=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,oe):e);var t}function ae(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",o)},r=()=>{t(ae(e.result)),i()},o=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&ee.set(t,e)})).catch((()=>{})),re.set(t,e),t}(e);if(ie.has(e))return ie.get(e);const t=se(e);return t!==e&&(ie.set(e,t),re.set(t,e)),t}const ue=e=>re.get(e),le=["get","getKey","getAll","getAllKeys","count"],ce=["put","add","delete","clear"],de=new Map;function he(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(de.get(t))return de.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=ce.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!le.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,r?"readwrite":"readonly");let s=o.store;return i&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),r&&o.done]))[0]};return de.set(t,o),o}var pe;pe=oe,oe={...pe,get:(e,t,n)=>he(e,t)||pe.get(e,t,n),has:(e,t)=>!!he(e,t)||pe.has(e,t)};class fe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ge="@firebase/app",me="0.10.5",ve=new Q("@firebase/app"),ye="@firebase/app-compat",Se="@firebase/analytics-compat",be="@firebase/analytics",Ee="@firebase/app-check-compat",we="@firebase/app-check",_e="@firebase/auth",Ie="@firebase/auth-compat",Ce="@firebase/database",Ae="@firebase/database-compat",Te="@firebase/functions",Re="@firebase/functions-compat",Oe="@firebase/installations",Pe="@firebase/installations-compat",De="@firebase/messaging",ke="@firebase/messaging-compat",xe="@firebase/performance",Ne="@firebase/performance-compat",Me="@firebase/remote-config",Fe="@firebase/remote-config-compat",Le="@firebase/storage",Ve="@firebase/storage-compat",je="@firebase/firestore",Be="@firebase/vertexai-preview",Ue="@firebase/firestore-compat",He="firebase",qe="[DEFAULT]",Ke={[ge]:"fire-core",[ye]:"fire-core-compat",[be]:"fire-analytics",[Se]:"fire-analytics-compat",[we]:"fire-app-check",[Ee]:"fire-app-check-compat",[_e]:"fire-auth",[Ie]:"fire-auth-compat",[Ce]:"fire-rtdb",[Ae]:"fire-rtdb-compat",[Te]:"fire-fn",[Re]:"fire-fn-compat",[Oe]:"fire-iid",[Pe]:"fire-iid-compat",[De]:"fire-fcm",[ke]:"fire-fcm-compat",[xe]:"fire-perf",[Ne]:"fire-perf-compat",[Me]:"fire-rc",[Fe]:"fire-rc-compat",[Le]:"fire-gcs",[Ve]:"fire-gcs-compat",[je]:"fire-fst",[Ue]:"fire-fst-compat",[Be]:"fire-vertex","fire-js":"fire-js",[He]:"fire-js-all"},$e=new Map,We=new Map,Ge=new Map;function ze(e,t){try{e.container.addComponent(t)}catch(n){ve.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Je(e){const t=e.name;if(Ge.has(t))return ve.debug(`There were multiple attempts to register component ${t}.`),!1;Ge.set(t,e);for(const t of $e.values())ze(t,e);for(const t of We.values())ze(t,e);return!0}function Qe(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ye(e){return void 0!==e.settings}const Ze=new b("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Xe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new B("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ze.create("app-deleted",{appName:this._name})}}const et="10.12.2";function tt(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:qe,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!=typeof r||!r)throw Ze.create("bad-app-name",{appName:String(r)});if(n||(n=p()),!n)throw Ze.create("no-options");const o=$e.get(r);if(o){if(O(n,o.options)&&O(i,o.config))return o;throw Ze.create("duplicate-app",{appName:r})}const s=new q(r);for(const e of Ge.values())s.addComponent(e);const a=new Xe(n,i,s);return $e.set(r,a),a}function nt(e=qe){const t=$e.get(e);if(!t&&e===qe&&p())return tt();if(!t)throw Ze.create("no-app",{appName:e});return t}function it(e,t,n){var i;let r=null!==(i=Ke[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const o=r.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=[`Unable to register library "${r}" with version "${t}":`];return o&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ve.warn(e.join(" "))}Je(new B(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}const rt="firebase-heartbeat-database",ot=1,st="firebase-heartbeat-store";let at=null;function ut(){return at||(at=function(e,t,{blocked:n,upgrade:i,blocking:r,terminated:o}={}){const s=indexedDB.open(e,t),a=ae(s);return i&&s.addEventListener("upgradeneeded",(e=>{i(ae(s.result),e.oldVersion,e.newVersion,ae(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(rt,ot,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(st)}catch(e){console.warn(e)}}}).catch((e=>{throw Ze.create("idb-open",{originalErrorMessage:e.message})}))),at}async function lt(e,t){try{const n=(await ut()).transaction(st,"readwrite"),i=n.objectStore(st);await i.put(t,ct(e)),await n.done}catch(e){if(e instanceof S)ve.warn(e.message);else{const t=Ze.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});ve.warn(t.message)}}}function ct(e){return`${e.name}!${e.options.appId}`}class dt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new pt(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ht();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((e=>e.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=ht(),{heartbeatsToSend:n,unsentEntries:i}=function(e,t=1024){const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),ft(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),ft(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=a(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function ht(){return(new Date).toISOString().substring(0,10)}class pt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ut()).transaction(st),n=await t.objectStore(st).get(ct(e));return await t.done,n}catch(e){if(e instanceof S)ve.warn(e.message);else{const t=Ze.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});ve.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return lt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return lt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ft(e){return a(JSON.stringify({version:2,heartbeats:e})).length}Je(new B("platform-logger",(e=>new fe(e)),"PRIVATE")),Je(new B("heartbeat",(e=>new dt(e)),"PRIVATE")),it(ge,me,""),it(ge,me,"esm2017"),it("fire-js",""),it("firebase","10.12.2","app");const gt=tt(JSON.parse('{"apiKey":"AIzaSyAGmGHVKLxIHsT9ikcRXniud5pAZb7pU0Y","authDomain":"gates-oh.firebaseapp.com","projectId":"gates-oh","storageBucket":"gates-oh.appspot.com","messagingSenderId":"880940805741","appId":"1:880940805741:web:1631c19f516d966ac49964","measurementId":"G-PHFDH66KC9","databaseURL":"https://gates-oh-default-rtdb.firebaseio.com"}')),mt="@firebase/database",vt="1.0.5";let yt="";class St{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:w(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class bt{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return C(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const Et=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new St(t)}}catch(e){}return new bt},wt=Et("localStorage"),_t=Et("sessionStorage"),It=new Q("@firebase/database"),Ct=function(){let e=1;return function(){return e++}}(),At=function(t){const n=function(t){const n=[];let i=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);if(o>=55296&&o<=56319){const n=o-55296;r++,e(r<t.length,"Surrogate pair missing trail surrogate."),o=65536+(n<<10)+(t.charCodeAt(r)-56320)}o<128?n[i++]=o:o<2048?(n[i++]=o>>6|192,n[i++]=63&o|128):o<65536?(n[i++]=o>>12|224,n[i++]=o>>6&63|128,n[i++]=63&o|128):(n[i++]=o>>18|240,n[i++]=o>>12&63|128,n[i++]=o>>6&63|128,n[i++]=63&o|128)}return n}(t),i=new N;i.update(n);const o=i.digest();return r.encodeByteArray(o)},Tt=function(...e){let t="";for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?t+=Tt.apply(null,i):t+="object"==typeof i?_(i):i,t+=" "}return t};let Rt=null,Ot=!0;const Pt=function(...t){if(!0===Ot&&(Ot=!1,null===Rt&&!0===_t.get("logging_enabled")&&(n=!0,e(!i||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(It.logLevel=$.VERBOSE,Rt=It.log.bind(It),i&&_t.set("logging_enabled",!0)):"function"==typeof n?Rt=n:(Rt=null,_t.remove("logging_enabled")))),Rt){const e=Tt.apply(null,t);Rt(e)}var n,i},Dt=function(e){return function(...t){Pt(e,...t)}},kt=function(...e){const t="FIREBASE INTERNAL ERROR: "+Tt(...e);It.error(t)},xt=function(...e){const t=`FIREBASE FATAL ERROR: ${Tt(...e)}`;throw It.error(t),new Error(t)},Nt=function(...e){const t="FIREBASE WARNING: "+Tt(...e);It.warn(t)},Mt=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Ft="[MIN_NAME]",Lt="[MAX_NAME]",Vt=function(e,t){if(e===t)return 0;if(e===Ft||t===Lt)return-1;if(t===Ft||e===Lt)return 1;{const n=Wt(e),i=Wt(t);return null!==n?null!==i?n-i==0?e.length-t.length:n-i:-1:null!==i?1:e<t?-1:1}},jt=function(e,t){return e===t?0:e<t?-1:1},Bt=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+_(t))},Ut=function(e){if("object"!=typeof e||null===e)return _(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let i=0;i<t.length;i++)0!==i&&(n+=","),n+=_(t[i]),n+=":",n+=Ut(e[t[i]]);return n+="}",n},Ht=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let r=0;r<n;r+=t)r+t>n?i.push(e.substring(r,n)):i.push(e.substring(r,r+t));return i};function qt(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Kt=function(t){e(!Mt(t),"Invalid JSON number");let n,i,r,o,s;0===t?(i=0,r=0,n=1/t==-1/0?1:0):(n=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(o=Math.min(Math.floor(Math.log(t)/Math.LN2),1023),i=o+1023,r=Math.round(t*Math.pow(2,52-o)-Math.pow(2,52))):(i=0,r=Math.round(t/Math.pow(2,-1074))));const a=[];for(s=52;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)a.push(i%2?1:0),i=Math.floor(i/2);a.push(n?1:0),a.reverse();const u=a.join("");let l="";for(s=0;s<64;s+=8){let e=parseInt(u.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),l+=e}return l.toLowerCase()},$t=new RegExp("^-?(0*)\\d{1,10}$"),Wt=function(e){if($t.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Gt=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw Nt("Exception was thrown by user callback.",t),e}),Math.floor(0))}},zt=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class Jt{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){Nt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Qt{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Pt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Nt(e)}}class Yt{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Yt.OWNER="owner";const Zt="5",Xt=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,en="ac",tn="websocket",nn="long_polling";class rn{constructor(e,t,n,i,r=!1,o="",s=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=wt.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&wt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function on(t,n,i){let r;if(e("string"==typeof n,"typeof type must == string"),e("object"==typeof i,"typeof params must == object"),n===tn)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(n!==nn)throw new Error("Unknown connection type: "+n);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(t)&&(i.ns=t.namespace);const o=[];return qt(i,((e,t)=>{o.push(e+"="+t)})),r+o.join("&")}class sn{constructor(){this.counters_={}}incrementCounter(e,t=1){C(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return l(this.counters_)}}const an={},un={};function ln(e){const t=e.toString();return an[t]||(an[t]=new sn),an[t]}class cn{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Gt((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const dn="start";class hn{constructor(e,t,n,i,r,o,s){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Dt(e),this.stats_=ln(t),this.urlFn=e=>(this.appCheckToken&&(e[en]=this.appCheckToken),on(t,nn,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new cn(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new pn(((...e)=>{const[t,n,i,r,o]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===dn)this.id=n,this.password=i;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[dn]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=Zt,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[en]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Xt.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){hn.forceAllow_=!0}static forceDisallow(){hn.forceDisallow_=!0}static isAvailable(){return!(!hn.forceAllow_&&(hn.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=_(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=s(t),i=Ht(n,1840);for(let e=0;e<i.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=_(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class pn{constructor(e,t,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Ct(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=pn.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){Pt("frame writing exception"),e.stack&&Pt(e.stack),Pt(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Pt("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(i),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Pt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let fn=null;"undefined"!=typeof MozWebSocket?fn=MozWebSocket:"undefined"!=typeof WebSocket&&(fn=WebSocket);class gn{constructor(e,t,n,i,r,o,s){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Dt(this.connId),this.stats_=ln(t),this.connURL=gn.connectionURL_(t,o,s,i,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,i,r){const o={};return o.v=Zt,"undefined"!=typeof location&&location.hostname&&Xt.test(location.hostname)&&(o.r="f"),t&&(o.s=t),n&&(o.ls=n),i&&(o[en]=i),r&&(o.p=r),on(e,tn,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,wt.set("previous_websocket_failure",!0);try{let e;0,this.mySock=new fn(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){gn.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==fn&&!gn.forceDisallow_}static previouslyFailed(){return wt.isInMemoryStorage||!0===wt.get("previous_websocket_failure")}markConnectionHealthy(){wt.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=w(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(t){if(e(null===this.frames,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=_(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Ht(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}gn.responsesRequiredToBeHealthy=2,gn.healthyTimeout=3e4;class mn{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[hn,gn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=gn&&gn.isAvailable();let n=t&&!gn.previouslyFailed();if(e.webSocketOnly&&(t||Nt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[gn];else{const e=this.transports_=[];for(const t of mn.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);mn.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}mn.globalTransportInitialized_=!1;class vn{constructor(e,t,n,i,r,o,s,a,u,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=u,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Dt("c:"+this.id+":"),this.transportManager_=new mn(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=zt((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Bt("t",e),n=Bt("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Bt("t",e),n=Bt("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Bt("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?kt("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):kt("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Zt!==n&&Nt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),zt((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):zt((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(wt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class yn{put(e,t,n,i){}merge(e,t,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class Sn{constructor(t){this.allowedEvents_=t,this.listeners_={},e(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const i=this.getInitialEvent(e);i&&t.apply(n,i)}off(e,t,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let e=0;e<i.length;e++)if(i[e].callback===t&&(!n||n===i[e].context))return void i.splice(e,1)}validateEventType_(t){e(this.allowedEvents_.find((e=>e===t)),"Unknown event: "+t)}}class bn extends Sn{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||v()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new bn}getInitialEvent(t){return e("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class En{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function wn(){return new En("")}function _n(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function In(e){return e.pieces_.length-e.pieceNum_}function Cn(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new En(e.pieces_,t)}function An(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Tn(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Rn(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new En(t,0)}function On(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof En)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new En(n,0)}function Pn(e){return e.pieceNum_>=e.pieces_.length}function Dn(e,t){const n=_n(e),i=_n(t);if(null===n)return t;if(n===i)return Dn(Cn(e),Cn(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function kn(e,t){const n=Tn(e,0),i=Tn(t,0);for(let e=0;e<n.length&&e<i.length;e++){const t=Vt(n[e],i[e]);if(0!==t)return t}return n.length===i.length?0:n.length<i.length?-1:1}function xn(e,t){if(In(e)!==In(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function Nn(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(In(e)>In(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class Mn{constructor(e,t){this.errorPrefix_=t,this.parts_=Tn(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=V(this.parts_[e]);Fn(this)}}function Fn(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ln(e))}function Ln(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Vn extends Sn{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Vn}getInitialEvent(t){return e("visible"===t,"Unknown event type: "+t),[this.visible_]}}const jn=1e3;class Bn extends yn{constructor(e,t,n,i,r,o,s,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=s,this.authOverride_=a,this.id=Bn.nextPersistentConnectionId_++,this.log_=Dt("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=jn,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Vn.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&bn.getInstance().on("online",this.onOnline_,this)}sendRequest(t,n,i){const r=++this.requestNumber_,o={r,a:t,b:n};this.log_(_(o)),e(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[r]=i)}get(e){this.initConnection_();const t=new g,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(t,n,i,r){this.initConnection_();const o=t._queryIdentifier,s=t._path.toString();this.log_("Listen called for "+s+" "+o),this.listens.has(s)||this.listens.set(s,new Map),e(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),e(!this.listens.get(s).has(o),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:t,tag:i};this.listens.get(s).set(o,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+n+" for "+i);const r={p:n};e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest("q",r,(r=>{const o=r.d,s=r.s;Bn.warnOnListenWarnings_(o,t),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",r),"ok"!==s&&this.removeListen_(n,i),e.onComplete&&e.onComplete(s,o))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&C(e,"w")){const n=A(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();Nt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=I(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=I(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,i=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(t,n){const i=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),e(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,t._queryObject,n)}sendUnlisten_(e,t,n,i){this.log_("Unlisten on "+e+" for "+t);const r={p:e};i&&(r.q=n,r.t=i),this.sendRequest("n",r)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,i){const r={p:t,d:n};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,(e=>{i&&setTimeout((()=>{i(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,i){this.putInternal("p",e,t,n,i)}merge(e,t,n,i){this.putInternal("m",e,t,n,i)}putInternal(e,t,n,i,r){this.initConnection_();const o={p:t,d:n};void 0!==r&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+_(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):kt("Unrecognized action received from server: "+_(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){e(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=jn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=jn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=jn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Bn.nextConnectionId_++,o=this.lastSessionId;let s=!1,a=null;const u=function(){a?a.close():(s=!0,i())},l=function(t){e(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(t)};this.realtime_={close:u,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[e,u]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);s?Pt("getToken() completed but was canceled"):(Pt("getToken() completed. Creating connection."),this.authToken_=e&&e.accessToken,this.appCheckToken_=u&&u.token,a=new vn(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,i,(e=>{Nt(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),o))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&Nt(e),u())}}}interrupt(e){Pt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Pt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],T(this.interruptReasons_)&&(this.reconnectDelay_=jn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Ut(e))).join("$"):"default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const n=new En(e).toString();let i;if(this.listens.has(n)){const e=this.listens.get(n);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,t){Pt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Pt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+yt.replace(/\./g,"-")]=1,v()?e["framework.cordova"]=1:y()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=bn.getInstance().currentlyOnline();return T(this.interruptReasons_)&&e}}Bn.nextPersistentConnectionId_=0,Bn.nextConnectionId_=0;class Un{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Un(e,t)}}class Hn{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Un(Ft,e),i=new Un(Ft,t);return 0!==this.compare(n,i)}minPost(){return Un.MIN}}let qn;class Kn extends Hn{static get __EMPTY_NODE(){return qn}static set __EMPTY_NODE(e){qn=e}compare(e,t){return Vt(e.name,t.name)}isDefinedOn(e){throw t("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Un.MIN}maxPost(){return new Un(Lt,qn)}makePost(t,n){return e("string"==typeof t,"KeyIndex indexValue must always be a string."),new Un(t,qn)}toString(){return".key"}}const $n=new Kn;class Wn{constructor(e,t,n,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,i&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Gn{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:Gn.RED,this.left=null!=i?i:zn.EMPTY_NODE,this.right=null!=r?r:zn.EMPTY_NODE}copy(e,t,n,i,r){return new Gn(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return zn.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,i;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return zn.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Gn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Gn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Gn.RED=!0,Gn.BLACK=!1;class zn{constructor(e,t=zn.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new zn(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Gn.BLACK,null,null))}remove(e){return new zn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Gn.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,i=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Wn(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Wn(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Wn(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Wn(this.root_,null,this.comparator_,!0,e)}}function Jn(e,t){return Vt(e.name,t.name)}function Qn(e,t){return Vt(e,t)}let Yn;zn.EMPTY_NODE=new class{copy(e,t,n,i,r){return this}insert(e,t,n){return new Gn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Zn=function(e){return"number"==typeof e?"number:"+Kt(e):"string:"+e},Xn=function(t){if(t.isLeafNode()){const n=t.val();e("string"==typeof n||"number"==typeof n||"object"==typeof n&&C(n,".sv"),"Priority must be a string or number.")}else e(t===Yn||t.isEmpty(),"priority of unexpected type.");e(t===Yn||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let ei,ti,ni;class ii{constructor(t,n=ii.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=n,this.lazyHash_=null,e(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Xn(this.priorityNode_)}static set __childrenNodeConstructor(e){ei=e}static get __childrenNodeConstructor(){return ei}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ii(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:ii.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Pn(e)?this:".priority"===_n(e)?this.priorityNode_:ii.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:ii.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(t,n){const i=_n(t);return null===i?n:n.isEmpty()&&".priority"!==i?this:(e(".priority"!==i||1===In(t),".priority must be the last token in a path"),this.updateImmediateChild(i,ii.__childrenNodeConstructor.EMPTY_NODE.updateChild(Cn(t),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Zn(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Kt(this.value_):this.value_,this.lazyHash_=At(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===ii.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof ii.__childrenNodeConstructor?-1:(e(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const n=typeof t.value_,i=typeof this.value_,r=ii.VALUE_TYPE_ORDER.indexOf(n),o=ii.VALUE_TYPE_ORDER.indexOf(i);return e(r>=0,"Unknown leaf type: "+n),e(o>=0,"Unknown leaf type: "+i),r===o?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}ii.VALUE_TYPE_ORDER=["object","boolean","number","string"];const ri=new class extends Hn{compare(e,t){const n=e.node.getPriority(),i=t.node.getPriority(),r=n.compareTo(i);return 0===r?Vt(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Un.MIN}maxPost(){return new Un(Lt,new ii("[PRIORITY-POST]",ni))}makePost(e,t){const n=ti(e);return new Un(t,new ii("[PRIORITY-POST]",n))}toString(){return".priority"}},oi=Math.log(2);class si{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/oi,10)),this.current_=this.count-1;const n=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ai=function(e,t,n,i){e.sort(t);const r=function(t,i){const o=i-t;let s,a;if(0===o)return null;if(1===o)return s=e[t],a=n?n(s):s,new Gn(a,s.node,Gn.BLACK,null,null);{const u=parseInt(o/2,10)+t,l=r(t,u),c=r(u+1,i);return s=e[u],a=n?n(s):s,new Gn(a,s.node,Gn.BLACK,l,c)}},o=function(t){let i=null,o=null,s=e.length;const a=function(t,i){const o=s-t,a=s;s-=t;const l=r(o+1,a),c=e[o],d=n?n(c):c;u(new Gn(d,c.node,i,null,l))},u=function(e){i?(i.left=e,i=e):(o=e,i=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));n?a(i,Gn.BLACK):(a(i,Gn.BLACK),a(i,Gn.RED))}return o}(new si(e.length));return new zn(i||t,o)};let ui;const li={};class ci{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return e(li&&ri,"ChildrenNode.ts has not been loaded"),ui=ui||new ci({".priority":li},{".priority":ri}),ui}get(e){const t=A(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof zn?t:null}hasIndex(e){return C(this.indexSet_,e.toString())}addIndex(t,n){e(t!==$n,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const o=n.getIterator(Un.Wrap);let s,a=o.getNext();for(;a;)r=r||t.isDefinedOn(a.node),i.push(a),a=o.getNext();s=r?ai(i,t.getCompare()):li;const u=t.toString(),l=Object.assign({},this.indexSet_);l[u]=t;const c=Object.assign({},this.indexes_);return c[u]=s,new ci(c,l)}addToIndexes(t,n){const i=R(this.indexes_,((i,r)=>{const o=A(this.indexSet_,r);if(e(o,"Missing index implementation for "+r),i===li){if(o.isDefinedOn(t.node)){const e=[],i=n.getIterator(Un.Wrap);let r=i.getNext();for(;r;)r.name!==t.name&&e.push(r),r=i.getNext();return e.push(t),ai(e,o.getCompare())}return li}{const e=n.get(t.name);let r=i;return e&&(r=r.remove(new Un(t.name,e))),r.insert(t,t.node)}}));return new ci(i,this.indexSet_)}removeFromIndexes(e,t){const n=R(this.indexes_,(n=>{if(n===li)return n;{const i=t.get(e.name);return i?n.remove(new Un(e.name,i)):n}}));return new ci(n,this.indexSet_)}}let di;class hi{constructor(t,n,i){this.children_=t,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Xn(this.priorityNode_),this.children_.isEmpty()&&e(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return di||(di=new hi(new zn(Qn),null,ci.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||di}updatePriority(e){return this.children_.isEmpty()?this:new hi(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?di:t}}getChild(e){const t=_n(e);return null===t?this:this.getImmediateChild(t).getChild(Cn(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(t,n){if(e(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);{const e=new Un(t,n);let i,r;n.isEmpty()?(i=this.children_.remove(t),r=this.indexMap_.removeFromIndexes(e,this.children_)):(i=this.children_.insert(t,n),r=this.indexMap_.addToIndexes(e,this.children_));const o=i.isEmpty()?di:this.priorityNode_;return new hi(i,o,r)}}updateChild(t,n){const i=_n(t);if(null===i)return n;{e(".priority"!==_n(t)||1===In(t),".priority must be the last token in a path");const r=this.getImmediateChild(i).updateChild(Cn(t),n);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,i=0,r=!0;if(this.forEachChild(ri,((o,s)=>{t[o]=s.val(e),n++,r&&hi.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):r=!1})),!e&&r&&i<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Zn(this.getPriority().val())+":"),this.forEachChild(ri,((t,n)=>{const i=n.hash();""!==i&&(e+=":"+t+":"+i)})),this.lazyHash_=""===e?"":At(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new Un(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Un(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Un(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Un.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Un.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===pi?-1:0}withIndex(e){if(e===$n||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new hi(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===$n||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(ri),n=t.getIterator(ri);let i=e.getNext(),r=n.getNext();for(;i&&r;){if(i.name!==r.name||!i.node.equals(r.node))return!1;i=e.getNext(),r=n.getNext()}return null===i&&null===r}return!1}return!1}}resolveIndex_(e){return e===$n?null:this.indexMap_.get(e.toString())}}hi.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const pi=new class extends hi{constructor(){super(new zn(Qn),hi.EMPTY_NODE,ci.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return hi.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Un,{MIN:{value:new Un(Ft,hi.EMPTY_NODE)},MAX:{value:new Un(Lt,pi)}}),Kn.__EMPTY_NODE=hi.EMPTY_NODE,ii.__childrenNodeConstructor=hi,Yn=pi,ni=pi;const fi=!0;function gi(t,n=null){if(null===t)return hi.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(n=t[".priority"]),e(null===n||"string"==typeof n||"number"==typeof n||"object"==typeof n&&".sv"in n,"Invalid priority type found: "+typeof n),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new ii(t,gi(n));if(t instanceof Array||!fi){let e=hi.EMPTY_NODE;return qt(t,((n,i)=>{if(C(t,n)&&"."!==n.substring(0,1)){const t=gi(i);!t.isLeafNode()&&t.isEmpty()||(e=e.updateImmediateChild(n,t))}})),e.updatePriority(gi(n))}{const e=[];let i=!1;if(qt(t,((t,n)=>{if("."!==t.substring(0,1)){const r=gi(n);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),e.push(new Un(t,r)))}})),0===e.length)return hi.EMPTY_NODE;const r=ai(e,Jn,(e=>e.name),Qn);if(i){const t=ai(e,ri.getCompare());return new hi(r,gi(n),new ci({".priority":t},{".priority":ri}))}return new hi(r,gi(n),ci.Default)}}!function(e){ti=e}(gi);class mi extends Hn{constructor(t){super(),this.indexPath_=t,e(!Pn(t)&&".priority"!==_n(t),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),i=this.extractChild(t.node),r=n.compareTo(i);return 0===r?Vt(e.name,t.name):r}makePost(e,t){const n=gi(e),i=hi.EMPTY_NODE.updateChild(this.indexPath_,n);return new Un(t,i)}maxPost(){const e=hi.EMPTY_NODE.updateChild(this.indexPath_,pi);return new Un(Lt,e)}toString(){return Tn(this.indexPath_,0).join("/")}}const vi=new class extends Hn{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Vt(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Un.MIN}maxPost(){return Un.MAX}makePost(e,t){const n=gi(e);return new Un(t,n)}toString(){return".value"}};function yi(e){return{type:"value",snapshotNode:e}}function Si(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function bi(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Ei(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class wi{constructor(e){this.index_=e}updateChild(t,n,i,r,o,s){e(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=t.getImmediateChild(n);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()?t:(null!=s&&(i.isEmpty()?t.hasChild(n)?s.trackChildChange(bi(n,a)):e(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(Si(n,i)):s.trackChildChange(Ei(n,i,a))),t.isLeafNode()&&i.isEmpty()?t:t.updateImmediateChild(n,i).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(ri,((e,i)=>{t.hasChild(e)||n.trackChildChange(bi(e,i))})),t.isLeafNode()||t.forEachChild(ri,((t,i)=>{if(e.hasChild(t)){const r=e.getImmediateChild(t);r.equals(i)||n.trackChildChange(Ei(t,i,r))}else n.trackChildChange(Si(t,i))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?hi.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class _i{constructor(e){this.indexedFilter_=new wi(e.getIndex()),this.index_=e.getIndex(),this.startPost_=_i.getStartPost_(e),this.endPost_=_i.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,i,r,o){return this.matches(new Un(t,n))||(n=hi.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,i,r,o)}updateFullNode(e,t,n){t.isLeafNode()&&(t=hi.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(hi.EMPTY_NODE);const r=this;return t.forEachChild(ri,((e,t)=>{r.matches(new Un(e,t))||(i=i.updateImmediateChild(e,hi.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Ii{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new _i(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,i,r,o){return this.rangedFilter_.matches(new Un(t,n))||(n=hi.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,i,r,o):this.fullLimitUpdateChild_(e,t,n,r,o)}updateFullNode(e,t,n){let i;if(t.isLeafNode()||t.isEmpty())i=hi.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=hi.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;i=i.updateImmediateChild(t.name,t.node),n++}}}else{let e;i=t.withIndex(this.index_),i=i.updatePriority(hi.EMPTY_NODE),e=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:i=i.updateImmediateChild(t.name,hi.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,n,i,r,o){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const a=t;e(a.numChildren()===this.limit_,"");const u=new Un(n,i),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),c=this.rangedFilter_.matches(u);if(a.hasChild(n)){const e=a.getImmediateChild(n);let t=r.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=t&&(t.name===n||a.hasChild(t.name));)t=r.getChildAfterChild(this.index_,t,this.reverse_);const d=null==t?1:s(t,u);if(c&&!i.isEmpty()&&d>=0)return null!=o&&o.trackChildChange(Ei(n,i,e)),a.updateImmediateChild(n,i);{null!=o&&o.trackChildChange(bi(n,e));const i=a.updateImmediateChild(n,hi.EMPTY_NODE);return null!=t&&this.rangedFilter_.matches(t)?(null!=o&&o.trackChildChange(Si(t.name,t.node)),i.updateImmediateChild(t.name,t.node)):i}}return i.isEmpty()?t:c&&s(l,u)>=0?(null!=o&&(o.trackChildChange(bi(l.name,l.node)),o.trackChildChange(Si(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(l.name,hi.EMPTY_NODE)):t}}class Ci{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ri}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return e(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return e(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ft}hasEnd(){return this.endSet_}getIndexEndValue(){return e(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return e(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Lt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return e(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ri}copy(){const e=new Ci;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Ai(t){const n={};if(t.isDefault())return n;let i;if(t.index_===ri?i="$priority":t.index_===vi?i="$value":t.index_===$n?i="$key":(e(t.index_ instanceof mi,"Unrecognized index type!"),i=t.index_.toString()),n.orderBy=_(i),t.startSet_){const e=t.startAfterSet_?"startAfter":"startAt";n[e]=_(t.indexStartValue_),t.startNameSet_&&(n[e]+=","+_(t.indexStartName_))}if(t.endSet_){const e=t.endBeforeSet_?"endBefore":"endAt";n[e]=_(t.indexEndValue_),t.endNameSet_&&(n[e]+=","+_(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_),n}function Ti(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==ri&&(t.i=e.index_.toString()),t}class Ri extends yn{constructor(e,t,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=Dt("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(t,n){return void 0!==n?"tag$"+n:(e(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(e,t,n,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=Ri.getListenId_(e,n),s={};this.listens_[o]=s;const a=Ai(e._queryParams);this.restRequest_(r+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(r,a,!1,n),A(this.listens_,o)===s){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(t,null)}}))}unlisten(e,t){const n=Ri.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Ai(e._queryParams),n=e._path.toString(),i=new g;return this.restRequest_(n+".json",t,((e,t)=>{let r=t;404===e&&(r=null,e=null),null===e?(this.onDataUpdate_(n,r,!1,null),i.resolve(r)):i.reject(new Error(r))})),i.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([i,r])=>{i&&i.accessToken&&(t.auth=i.accessToken),r&&r.token&&(t.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+D(t);this.log_("Sending REST request for "+o);const s=new XMLHttpRequest;s.onreadystatechange=()=>{if(n&&4===s.readyState){this.log_("REST Response for "+o+" received. status:",s.status,"response:",s.responseText);let e=null;if(s.status>=200&&s.status<300){try{e=w(s.responseText)}catch(e){Nt("Failed to parse JSON response for "+o+": "+s.responseText)}n(null,e)}else 401!==s.status&&404!==s.status&&Nt("Got unsuccessful REST response for "+o+" Status: "+s.status),n(s.status);n=null}},s.open("GET",o,!0),s.send()}))}}class Oi{constructor(){this.rootNode_=hi.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Pi(){return{value:null,children:new Map}}function Di(e,t,n){if(Pn(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const i=_n(t);e.children.has(i)||e.children.set(i,Pi()),Di(e.children.get(i),t=Cn(t),n)}}function ki(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,i)=>{ki(i,new En(t.toString()+"/"+e),n)}))}class xi{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&qt(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class Ni{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new xi(e);const n=1e4+2e4*Math.random();zt(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;qt(e,((e,i)=>{i>0&&C(this.statsToReport_,e)&&(t[e]=i,n=!0)})),n&&this.server_.reportStats(t),zt(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Mi;function Fi(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Mi||(Mi={}));class Li{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Mi.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(Pn(this.path)){if(null!=this.affectedTree.value)return e(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new En(t));return new Li(wn(),e,this.revert)}}return e(_n(this.path)===t,"operationForChild called for unrelated child."),new Li(Cn(this.path),this.affectedTree,this.revert)}}class Vi{constructor(e,t){this.source=e,this.path=t,this.type=Mi.LISTEN_COMPLETE}operationForChild(e){return Pn(this.path)?new Vi(this.source,wn()):new Vi(this.source,Cn(this.path))}}class ji{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Mi.OVERWRITE}operationForChild(e){return Pn(this.path)?new ji(this.source,wn(),this.snap.getImmediateChild(e)):new ji(this.source,Cn(this.path),this.snap)}}class Bi{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Mi.MERGE}operationForChild(t){if(Pn(this.path)){const e=this.children.subtree(new En(t));return e.isEmpty()?null:e.value?new ji(this.source,wn(),e.value):new Bi(this.source,wn(),e)}return e(_n(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Bi(this.source,Cn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Ui{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Pn(e))return this.isFullyInitialized()&&!this.filtered_;const t=_n(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Hi{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function qi(e,n,i,r,o,s){const a=r.filter((e=>e.type===i));a.sort(((n,i)=>function(e,n,i){if(null==n.childName||null==i.childName)throw t("Should only compare child_ events.");const r=new Un(n.childName,n.snapshotNode),o=new Un(i.childName,i.snapshotNode);return e.index_.compare(r,o)}(e,n,i))),a.forEach((t=>{const i=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,t,s);o.forEach((r=>{r.respondsTo(t.type)&&n.push(r.createEvent(i,e.query_))}))}))}function Ki(e,t){return{eventCache:e,serverCache:t}}function $i(e,t,n,i){return Ki(new Ui(t,n,i),e.serverCache)}function Wi(e,t,n,i){return Ki(e.eventCache,new Ui(t,n,i))}function Gi(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function zi(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Ji;class Qi{constructor(e,t=(()=>(Ji||(Ji=new zn(jt)),Ji))()){this.value=e,this.children=t}static fromObject(e){let t=new Qi(null);return qt(e,((e,n)=>{t=t.set(new En(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:wn(),value:this.value};if(Pn(e))return null;{const n=_n(e),i=this.children.get(n);if(null!==i){const r=i.findRootMostMatchingPathAndValue(Cn(e),t);return null!=r?{path:On(new En(n),r.path),value:r.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Pn(e))return this;{const t=_n(e),n=this.children.get(t);return null!==n?n.subtree(Cn(e)):new Qi(null)}}set(e,t){if(Pn(e))return new Qi(t,this.children);{const n=_n(e),i=(this.children.get(n)||new Qi(null)).set(Cn(e),t),r=this.children.insert(n,i);return new Qi(this.value,r)}}remove(e){if(Pn(e))return this.children.isEmpty()?new Qi(null):new Qi(null,this.children);{const t=_n(e),n=this.children.get(t);if(n){const i=n.remove(Cn(e));let r;return r=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&r.isEmpty()?new Qi(null):new Qi(this.value,r)}return this}}get(e){if(Pn(e))return this.value;{const t=_n(e),n=this.children.get(t);return n?n.get(Cn(e)):null}}setTree(e,t){if(Pn(e))return t;{const n=_n(e),i=(this.children.get(n)||new Qi(null)).setTree(Cn(e),t);let r;return r=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new Qi(this.value,r)}}fold(e){return this.fold_(wn(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((i,r)=>{n[i]=r.fold_(On(e,i),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,wn(),t)}findOnPath_(e,t,n){const i=!!this.value&&n(t,this.value);if(i)return i;if(Pn(e))return null;{const i=_n(e),r=this.children.get(i);return r?r.findOnPath_(Cn(e),On(t,i),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,wn(),t)}foreachOnPath_(e,t,n){if(Pn(e))return this;{this.value&&n(t,this.value);const i=_n(e),r=this.children.get(i);return r?r.foreachOnPath_(Cn(e),On(t,i),n):new Qi(null)}}foreach(e){this.foreach_(wn(),e)}foreach_(e,t){this.children.inorderTraversal(((n,i)=>{i.foreach_(On(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class Yi{constructor(e){this.writeTree_=e}static empty(){return new Yi(new Qi(null))}}function Zi(e,t,n){if(Pn(t))return new Yi(new Qi(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const r=i.path;let o=i.value;const s=Dn(r,t);return o=o.updateChild(s,n),new Yi(e.writeTree_.set(r,o))}{const i=new Qi(n),r=e.writeTree_.setTree(t,i);return new Yi(r)}}}function Xi(e,t,n){let i=e;return qt(n,((e,n)=>{i=Zi(i,On(t,e),n)})),i}function er(e,t){if(Pn(t))return Yi.empty();{const n=e.writeTree_.setTree(t,new Qi(null));return new Yi(n)}}function tr(e,t){return null!=nr(e,t)}function nr(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Dn(n.path,t)):null}function ir(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ri,((e,n)=>{t.push(new Un(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Un(e,n.value))})),t}function rr(e,t){if(Pn(t))return e;{const n=nr(e,t);return new Yi(null!=n?new Qi(n):e.writeTree_.subtree(t))}}function or(e){return e.writeTree_.isEmpty()}function sr(e,t){return ar(wn(),e.writeTree_,t)}function ar(t,n,i){if(null!=n.value)return i.updateChild(t,n.value);{let r=null;return n.children.inorderTraversal(((n,o)=>{".priority"===n?(e(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):i=ar(On(t,n),o,i)})),i.getChild(t).isEmpty()||null===r||(i=i.updateChild(On(t,".priority"),r)),i}}function ur(e,t){return Sr(t,e)}function lr(e,t){if(e.snap)return Nn(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Nn(On(e.path,n),t))return!0;return!1}function cr(e){return e.visible}function dr(e,n,i){let r=Yi.empty();for(let o=0;o<e.length;++o){const s=e[o];if(n(s)){const e=s.path;let n;if(s.snap)Nn(i,e)?(n=Dn(i,e),r=Zi(r,n,s.snap)):Nn(e,i)&&(n=Dn(e,i),r=Zi(r,wn(),s.snap.getChild(n)));else{if(!s.children)throw t("WriteRecord should have .snap or .children");if(Nn(i,e))n=Dn(i,e),r=Xi(r,n,s.children);else if(Nn(e,i))if(n=Dn(e,i),Pn(n))r=Xi(r,wn(),s.children);else{const e=A(s.children,_n(n));if(e){const t=e.getChild(Cn(n));r=Zi(r,wn(),t)}}}}}return r}function hr(e,t,n,i,r){if(i||r){const o=rr(e.visibleWrites,t);if(!r&&or(o))return n;if(r||null!=n||tr(o,wn())){const o=function(e){return(e.visible||r)&&(!i||!~i.indexOf(e.writeId))&&(Nn(e.path,t)||Nn(t,e.path))};return sr(dr(e.allWrites,o,t),n||hi.EMPTY_NODE)}return null}{const i=nr(e.visibleWrites,t);if(null!=i)return i;{const i=rr(e.visibleWrites,t);return or(i)?n:null!=n||tr(i,wn())?sr(i,n||hi.EMPTY_NODE):null}}}function pr(e,t,n,i){return hr(e.writeTree,e.treePath,t,n,i)}function fr(e,t){return function(e,t,n){let i=hi.EMPTY_NODE;const r=nr(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(ri,((e,t)=>{i=i.updateImmediateChild(e,t)})),i;if(n){const r=rr(e.visibleWrites,t);return n.forEachChild(ri,((e,t)=>{const n=sr(rr(r,new En(e)),t);i=i.updateImmediateChild(e,n)})),ir(r).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}return ir(rr(e.visibleWrites,t)).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}(e.writeTree,e.treePath,t)}function gr(t,n,i,r){return function(t,n,i,r,o){e(r||o,"Either existingEventSnap or existingServerSnap must exist");const s=On(n,i);if(tr(t.visibleWrites,s))return null;{const e=rr(t.visibleWrites,s);return or(e)?o.getChild(i):sr(e,o.getChild(i))}}(t.writeTree,t.treePath,n,i,r)}function mr(e,t){return function(e,t){return nr(e.visibleWrites,t)}(e.writeTree,On(e.treePath,t))}function vr(e,t,n){return function(e,t,n,i){const r=On(t,n),o=nr(e.visibleWrites,r);return null!=o?o:i.isCompleteForChild(n)?sr(rr(e.visibleWrites,r),i.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function yr(e,t){return Sr(On(e.treePath,t),e.writeTree)}function Sr(e,t){return{treePath:e,writeTree:t}}class br{constructor(){this.changeMap=new Map}trackChildChange(n){const i=n.type,r=n.childName;e("child_added"===i||"child_changed"===i||"child_removed"===i,"Only child changes supported for tracking"),e(".priority"!==r,"Only non-priority child changes can be tracked.");const o=this.changeMap.get(r);if(o){const e=o.type;if("child_added"===i&&"child_removed"===e)this.changeMap.set(r,Ei(r,n.snapshotNode,o.snapshotNode));else if("child_removed"===i&&"child_added"===e)this.changeMap.delete(r);else if("child_removed"===i&&"child_changed"===e)this.changeMap.set(r,bi(r,o.oldSnap));else if("child_changed"===i&&"child_added"===e)this.changeMap.set(r,Si(r,n.snapshotNode));else{if("child_changed"!==i||"child_changed"!==e)throw t("Illegal combination of changes: "+n+" occurred after "+o);this.changeMap.set(r,Ei(r,n.snapshotNode,o.oldSnap))}}else this.changeMap.set(r,n)}getChanges(){return Array.from(this.changeMap.values())}}const Er=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class wr{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Ui(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return vr(this.writes_,e,t)}}getChildAfterChild(e,t,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:zi(this.viewCache_),r=function(e,t,n,i,r,o){return function(e,t,n,i,r,o,s){let a;const u=rr(e.visibleWrites,t),l=nr(u,wn());if(null!=l)a=l;else{if(null==n)return[];a=sr(u,n)}if(a=a.withIndex(s),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=s.getCompare(),n=o?a.getReverseIteratorFrom(i,s):a.getIteratorFrom(i,s);let u=n.getNext();for(;u&&e.length<r;)0!==t(u,i)&&e.push(u),u=n.getNext();return e}}(e.writeTree,e.treePath,t,n,i,r,o)}(this.writes_,i,t,1,n,e);return 0===r.length?null:r[0]}}function _r(t,n,i,r,o,s){const a=n.eventCache;if(null!=mr(r,i))return n;{let u,l;if(Pn(i))if(e(n.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),n.serverCache.isFiltered()){const e=zi(n),i=fr(r,e instanceof hi?e:hi.EMPTY_NODE);u=t.filter.updateFullNode(n.eventCache.getNode(),i,s)}else{const e=pr(r,zi(n));u=t.filter.updateFullNode(n.eventCache.getNode(),e,s)}else{const c=_n(i);if(".priority"===c){e(1===In(i),"Can't have a priority with additional path components");const o=a.getNode();l=n.serverCache.getNode();const s=gr(r,i,o,l);u=null!=s?t.filter.updatePriority(o,s):a.getNode()}else{const e=Cn(i);let d;if(a.isCompleteForChild(c)){l=n.serverCache.getNode();const t=gr(r,i,a.getNode(),l);d=null!=t?a.getNode().getImmediateChild(c).updateChild(e,t):a.getNode().getImmediateChild(c)}else d=vr(r,c,n.serverCache);u=null!=d?t.filter.updateChild(a.getNode(),c,d,e,o,s):a.getNode()}}return $i(n,u,a.isFullyInitialized()||Pn(i),t.filter.filtersNodes())}}function Ir(e,t,n,i,r,o,s,a){const u=t.serverCache;let l;const c=s?e.filter:e.filter.getIndexedFilter();if(Pn(n))l=c.updateFullNode(u.getNode(),i,null);else if(c.filtersNodes()&&!u.isFiltered()){const e=u.getNode().updateChild(n,i);l=c.updateFullNode(u.getNode(),e,null)}else{const e=_n(n);if(!u.isCompleteForPath(n)&&In(n)>1)return t;const r=Cn(n),o=u.getNode().getImmediateChild(e).updateChild(r,i);l=".priority"===e?c.updatePriority(u.getNode(),o):c.updateChild(u.getNode(),e,o,r,Er,null)}const d=Wi(t,l,u.isFullyInitialized()||Pn(n),c.filtersNodes());return _r(e,d,n,r,new wr(r,d,o),a)}function Cr(e,t,n,i,r,o,s){const a=t.eventCache;let u,l;const c=new wr(r,t,o);if(Pn(n))l=e.filter.updateFullNode(t.eventCache.getNode(),i,s),u=$i(t,l,!0,e.filter.filtersNodes());else{const r=_n(n);if(".priority"===r)l=e.filter.updatePriority(t.eventCache.getNode(),i),u=$i(t,l,a.isFullyInitialized(),a.isFiltered());else{const o=Cn(n),l=a.getNode().getImmediateChild(r);let d;if(Pn(o))d=i;else{const e=c.getCompleteChild(r);d=null!=e?".priority"===An(o)&&e.getChild(Rn(o)).isEmpty()?e:e.updateChild(o,i):hi.EMPTY_NODE}u=l.equals(d)?t:$i(t,e.filter.updateChild(a.getNode(),r,d,o,c,s),a.isFullyInitialized(),e.filter.filtersNodes())}}return u}function Ar(e,t){return e.eventCache.isCompleteForChild(t)}function Tr(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Rr(e,t,n,i,r,o,s,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let u,l=t;u=Pn(n)?i:new Qi(null).setTree(n,i);const c=t.serverCache.getNode();return u.children.inorderTraversal(((n,i)=>{if(c.hasChild(n)){const u=Tr(0,t.serverCache.getNode().getImmediateChild(n),i);l=Ir(e,l,new En(n),u,r,o,s,a)}})),u.children.inorderTraversal(((n,i)=>{const u=!t.serverCache.isCompleteForChild(n)&&null===i.value;if(!c.hasChild(n)&&!u){const u=Tr(0,t.serverCache.getNode().getImmediateChild(n),i);l=Ir(e,l,new En(n),u,r,o,s,a)}})),l}class Or{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new wi(n.getIndex()),r=(o=n).loadsAllData()?new wi(o.getIndex()):o.hasLimit()?new Ii(o):new _i(o);var o;this.processor_=function(e){return{filter:e}}(r);const s=t.serverCache,a=t.eventCache,u=i.updateFullNode(hi.EMPTY_NODE,s.getNode(),null),l=r.updateFullNode(hi.EMPTY_NODE,a.getNode(),null),c=new Ui(u,s.isFullyInitialized(),i.filtersNodes()),d=new Ui(l,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=Ki(d,c),this.eventGenerator_=new Hi(this.query_)}get query(){return this.query_}}function Pr(e,t){const n=zi(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Pn(t)&&!n.getImmediateChild(_n(t)).isEmpty())?n.getChild(t):null}function Dr(e){return 0===e.eventRegistrations_.length}function kr(t,n,i){const r=[];if(i){e(null==n,"A cancel should cancel all event registrations.");const o=t.query._path;t.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(i,o);t&&r.push(t)}))}if(n){let e=[];for(let i=0;i<t.eventRegistrations_.length;++i){const r=t.eventRegistrations_[i];if(r.matches(n)){if(n.hasAnyCallback()){e=e.concat(t.eventRegistrations_.slice(i+1));break}}else e.push(r)}t.eventRegistrations_=e}else t.eventRegistrations_=[];return r}function xr(n,i,r,o){i.type===Mi.MERGE&&null!==i.source.queryId&&(e(zi(n.viewCache_),"We should always have a full cache before handling merges"),e(Gi(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,a=function(n,i,r,o,s){const a=new br;let u,l;if(r.type===Mi.OVERWRITE){const t=r;t.source.fromUser?u=Cr(n,i,t.path,t.snap,o,s,a):(e(t.source.fromServer,"Unknown source."),l=t.source.tagged||i.serverCache.isFiltered()&&!Pn(t.path),u=Ir(n,i,t.path,t.snap,o,s,l,a))}else if(r.type===Mi.MERGE){const t=r;t.source.fromUser?u=function(e,t,n,i,r,o,s){let a=t;return i.foreach(((i,u)=>{const l=On(n,i);Ar(t,_n(l))&&(a=Cr(e,a,l,u,r,o,s))})),i.foreach(((i,u)=>{const l=On(n,i);Ar(t,_n(l))||(a=Cr(e,a,l,u,r,o,s))})),a}(n,i,t.path,t.children,o,s,a):(e(t.source.fromServer,"Unknown source."),l=t.source.tagged||i.serverCache.isFiltered(),u=Rr(n,i,t.path,t.children,o,s,l,a))}else if(r.type===Mi.ACK_USER_WRITE){const t=r;u=t.revert?function(t,n,i,r,o,s){let a;if(null!=mr(r,i))return n;{const u=new wr(r,n,o),l=n.eventCache.getNode();let c;if(Pn(i)||".priority"===_n(i)){let i;if(n.serverCache.isFullyInitialized())i=pr(r,zi(n));else{const t=n.serverCache.getNode();e(t instanceof hi,"serverChildren would be complete if leaf node"),i=fr(r,t)}c=t.filter.updateFullNode(l,i,s)}else{const e=_n(i);let o=vr(r,e,n.serverCache);null==o&&n.serverCache.isCompleteForChild(e)&&(o=l.getImmediateChild(e)),c=null!=o?t.filter.updateChild(l,e,o,Cn(i),u,s):n.eventCache.getNode().hasChild(e)?t.filter.updateChild(l,e,hi.EMPTY_NODE,Cn(i),u,s):l,c.isEmpty()&&n.serverCache.isFullyInitialized()&&(a=pr(r,zi(n)),a.isLeafNode()&&(c=t.filter.updateFullNode(c,a,s)))}return a=n.serverCache.isFullyInitialized()||null!=mr(r,wn()),$i(n,c,a,t.filter.filtersNodes())}}(n,i,t.path,o,s,a):function(e,t,n,i,r,o,s){if(null!=mr(r,n))return t;const a=t.serverCache.isFiltered(),u=t.serverCache;if(null!=i.value){if(Pn(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Ir(e,t,n,u.getNode().getChild(n),r,o,a,s);if(Pn(n)){let i=new Qi(null);return u.getNode().forEachChild($n,((e,t)=>{i=i.set(new En(e),t)})),Rr(e,t,n,i,r,o,a,s)}return t}{let l=new Qi(null);return i.foreach(((e,t)=>{const i=On(n,e);u.isCompleteForPath(i)&&(l=l.set(e,u.getNode().getChild(i)))})),Rr(e,t,n,l,r,o,a,s)}}(n,i,t.path,t.affectedTree,o,s,a)}else{if(r.type!==Mi.LISTEN_COMPLETE)throw t("Unknown operation type: "+r.type);u=function(e,t,n,i,r){const o=t.serverCache;return _r(e,Wi(t,o.getNode(),o.isFullyInitialized()||Pn(n),o.isFiltered()),n,i,Er,r)}(n,i,r.path,o,a)}const c=a.getChanges();return function(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=Gi(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&n.push(yi(Gi(t)))}}(i,u,c),{viewCache:u,changes:c}}(n.processor_,s,i,r,o);var u,l;return u=n.processor_,l=a.viewCache,e(l.eventCache.getNode().isIndexed(u.filter.getIndex()),"Event snap not indexed"),e(l.serverCache.getNode().isIndexed(u.filter.getIndex()),"Server snap not indexed"),e(a.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,Nr(n,a.changes,a.viewCache.eventCache.getNode(),null)}function Nr(e,t,n,i){const r=i?[i]:e.eventRegistrations_;return function(e,t,n,i){const r=[],o=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),qi(e,r,"child_removed",t,i,n),qi(e,r,"child_added",t,i,n),qi(e,r,"child_moved",o,i,n),qi(e,r,"child_changed",t,i,n),qi(e,r,"value",t,i,n),r}(e.eventGenerator_,t,n,r)}let Mr,Fr;class Lr{constructor(){this.views=new Map}}function Vr(t,n,i,r){const o=n.source.queryId;if(null!==o){const s=t.views.get(o);return e(null!=s,"SyncTree gave us an op for an invalid query."),xr(s,n,i,r)}{let e=[];for(const o of t.views.values())e=e.concat(xr(o,n,i,r));return e}}function jr(e,t,n,i,r){const o=t._queryIdentifier,s=e.views.get(o);if(!s){let e=pr(n,r?i:null),o=!1;e?o=!0:i instanceof hi?(e=fr(n,i),o=!1):(e=hi.EMPTY_NODE,o=!1);const s=Ki(new Ui(e,o,!1),new Ui(i,r,!1));return new Or(t,s)}return s}function Br(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Ur(e,t){let n=null;for(const i of e.views.values())n=n||Pr(i,t);return n}function Hr(e,t){if(t._queryParams.loadsAllData())return $r(e);{const n=t._queryIdentifier;return e.views.get(n)}}function qr(e,t){return null!=Hr(e,t)}function Kr(e){return null!=$r(e)}function $r(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Wr=1;class Gr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Qi(null),this.pendingWriteTree_={visibleWrites:Yi.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function zr(t,n,i,r,o){return function(t,n,i,r,o){e(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),t.allWrites.push({path:n,snap:i,writeId:r,visible:o}),o&&(t.visibleWrites=Zi(t.visibleWrites,n,i)),t.lastWriteId=r}(t.pendingWriteTree_,n,i,r,o),o?to(t,new ji({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},n,i)):[]}function Jr(t,n,i=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}(t.pendingWriteTree_,n);if(function(t,n){const i=t.allWrites.findIndex((e=>e.writeId===n));e(i>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[i];t.allWrites.splice(i,1);let o=r.visible,s=!1,a=t.allWrites.length-1;for(;o&&a>=0;){const e=t.allWrites[a];e.visible&&(a>=i&&lr(e,r.path)?o=!1:Nn(r.path,e.path)&&(s=!0)),a--}return!!o&&(s?(function(e){e.visibleWrites=dr(e.allWrites,cr,wn()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(t),!0):(r.snap?t.visibleWrites=er(t.visibleWrites,r.path):qt(r.children,(e=>{t.visibleWrites=er(t.visibleWrites,On(r.path,e))})),!0))}(t.pendingWriteTree_,n)){let e=new Qi(null);return null!=r.snap?e=e.set(wn(),!0):qt(r.children,(t=>{e=e.set(new En(t),!0)})),to(t,new Li(r.path,e,i))}return[]}function Qr(e,t,n){return to(e,new ji({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Yr(t,n,i,r,o=!1){const s=n._path,a=t.syncPointTree_.get(s);let u=[];if(a&&("default"===n._queryIdentifier||qr(a,n))){const l=function(t,n,i,r){const o=n._queryIdentifier,s=[];let a=[];const u=Kr(t);if("default"===o)for(const[e,n]of t.views.entries())a=a.concat(kr(n,i,r)),Dr(n)&&(t.views.delete(e),n.query._queryParams.loadsAllData()||s.push(n.query));else{const e=t.views.get(o);e&&(a=a.concat(kr(e,i,r)),Dr(e)&&(t.views.delete(o),e.query._queryParams.loadsAllData()||s.push(e.query)))}return u&&!Kr(t)&&s.push(new(e(Mr,"Reference.ts has not been loaded"),Mr)(n._repo,n._path)),{removed:s,events:a}}(a,n,i,r);0===a.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(s));const c=l.removed;if(u=l.events,!o){const e=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),i=t.syncPointTree_.findOnPath(s,((e,t)=>Kr(t)));if(e&&!i){const e=t.syncPointTree_.subtree(s);if(!e.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&Kr(t))return[$r(t)];{let e=[];return t&&(e=Br(t)),qt(n,((t,n)=>{e=e.concat(n)})),e}}))}(e);for(let e=0;e<n.length;++e){const i=n[e],r=i.query,o=ro(t,i);t.listenProvider_.startListening(co(r),oo(t,r),o.hashFn,o.onComplete)}}}if(!i&&c.length>0&&!r)if(e){const e=null;t.listenProvider_.stopListening(co(n),e)}else c.forEach((e=>{const n=t.queryToTagMap.get(so(e));t.listenProvider_.stopListening(co(e),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const i=t[n];if(!i._queryParams.loadsAllData()){const t=so(i),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(t,c)}return u}function Zr(e,t,n,i){const r=ao(e,i);if(null!=r){const i=uo(r),o=i.path,s=i.queryId,a=Dn(o,t);return lo(e,o,new ji(Fi(s),a,n))}return[]}function Xr(t,n,i,r=!1){const o=n._path;let s=null,a=!1;t.syncPointTree_.foreachOnPath(o,((e,t)=>{const n=Dn(e,o);s=s||Ur(t,n),a=a||Kr(t)}));let u,l=t.syncPointTree_.get(o);l?(a=a||Kr(l),s=s||Ur(l,wn())):(l=new Lr,t.syncPointTree_=t.syncPointTree_.set(o,l)),null!=s?u=!0:(u=!1,s=hi.EMPTY_NODE,t.syncPointTree_.subtree(o).foreachChild(((e,t)=>{const n=Ur(t,wn());n&&(s=s.updateImmediateChild(e,n))})));const c=qr(l,n);if(!c&&!n._queryParams.loadsAllData()){const i=so(n);e(!t.queryToTagMap.has(i),"View does not exist, but we have a tag");const r=Wr++;t.queryToTagMap.set(i,r),t.tagToQueryMap.set(r,i)}let d=function(e,t,n,i,r,o){const s=jr(e,t,i,r,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,s),function(e,t){e.eventRegistrations_.push(t)}(s,n),function(e,t){const n=e.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ri,((e,t)=>{i.push(Si(e,t))})),n.isFullyInitialized()&&i.push(yi(n.getNode())),Nr(e,i,n.getNode(),t)}(s,n)}(l,n,i,ur(t.pendingWriteTree_,o),s,u);if(!c&&!a&&!r){const i=Hr(l,n);d=d.concat(function(t,n,i){const r=n._path,o=oo(t,n),s=ro(t,i),a=t.listenProvider_.startListening(co(n),o,s.hashFn,s.onComplete),u=t.syncPointTree_.subtree(r);if(o)e(!Kr(u.value),"If we're adding a query, it shouldn't be shadowed");else{const e=u.fold(((e,t,n)=>{if(!Pn(e)&&t&&Kr(t))return[$r(t).query];{let e=[];return t&&(e=e.concat(Br(t).map((e=>e.query)))),qt(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<e.length;++n){const i=e[n];t.listenProvider_.stopListening(co(i),oo(t,i))}}return a}(t,n,i))}return d}function eo(e,t,n){const i=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(t,((e,n)=>{const i=Ur(n,Dn(e,t));if(i)return i}));return hr(i,t,r,n,!0)}function to(e,t){return no(t,e.syncPointTree_,null,ur(e.pendingWriteTree_,wn()))}function no(e,t,n,i){if(Pn(e.path))return io(e,t,n,i);{const r=t.get(wn());null==n&&null!=r&&(n=Ur(r,wn()));let o=[];const s=_n(e.path),a=e.operationForChild(s),u=t.children.get(s);if(u&&a){const e=n?n.getImmediateChild(s):null,t=yr(i,s);o=o.concat(no(a,u,e,t))}return r&&(o=o.concat(Vr(r,e,i,n))),o}}function io(e,t,n,i){const r=t.get(wn());null==n&&null!=r&&(n=Ur(r,wn()));let o=[];return t.children.inorderTraversal(((t,r)=>{const s=n?n.getImmediateChild(t):null,a=yr(i,t),u=e.operationForChild(t);u&&(o=o.concat(io(u,r,s,a)))})),r&&(o=o.concat(Vr(r,e,i,n))),o}function ro(e,t){const n=t.query,i=oo(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||hi.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return i?function(e,t,n){const i=ao(e,n);if(i){const n=uo(i),r=n.path,o=n.queryId,s=Dn(r,t);return lo(e,r,new Vi(Fi(o),s))}return[]}(e,n._path,i):function(e,t){return to(e,new Vi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const i=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const i=new Error(e+" at "+t._path.toString()+": "+n);return i.code=e.toUpperCase(),i}(t,n);return Yr(e,n,null,i)}}}}function oo(e,t){const n=so(t);return e.queryToTagMap.get(n)}function so(e){return e._path.toString()+"$"+e._queryIdentifier}function ao(e,t){return e.tagToQueryMap.get(t)}function uo(t){const n=t.indexOf("$");return e(-1!==n&&n<t.length-1,"Bad queryKey."),{queryId:t.substr(n+1),path:new En(t.substr(0,n))}}function lo(t,n,i){const r=t.syncPointTree_.get(n);return e(r,"Missing sync point for query tag that we're tracking"),Vr(r,i,ur(t.pendingWriteTree_,n),null)}function co(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(e(Fr,"Reference.ts has not been loaded"),Fr)(t._repo,t._path):t}class ho{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new ho(t)}node(){return this.node_}}class po{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=On(this.path_,e);return new po(this.syncTree_,t)}node(){return eo(this.syncTree_,this.path_)}}const fo=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},go=function(t,n,i){return t&&"object"==typeof t?(e(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?mo(t[".sv"],n,i):"object"==typeof t[".sv"]?vo(t[".sv"],n):void e(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},mo=function(t,n,i){if("timestamp"===t)return i.timestamp;e(!1,"Unexpected server value: "+t)},vo=function(t,n,i){t.hasOwnProperty("increment")||e(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;"number"!=typeof r&&e(!1,"Unexpected increment value: "+r);const o=n.node();if(e(null!=o,"Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;const s=o.getValue();return"number"!=typeof s?r:s+r},yo=function(e,t,n,i){return bo(t,new po(n,e),i)},So=function(e,t,n){return bo(e,new ho(t),n)};function bo(e,t,n){const i=e.getPriority().val(),r=go(i,t.getImmediateChild(".priority"),n);let o;if(e.isLeafNode()){const i=e,o=go(i.getValue(),t,n);return o!==i.getValue()||r!==i.getPriority().val()?new ii(o,gi(r)):e}{const i=e;return o=i,r!==i.getPriority().val()&&(o=o.updatePriority(new ii(r))),i.forEachChild(ri,((e,i)=>{const r=bo(i,t.getImmediateChild(e),n);r!==i&&(o=o.updateImmediateChild(e,r))})),o}}class Eo{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function wo(e,t){let n=t instanceof En?t:new En(t),i=e,r=_n(n);for(;null!==r;){const e=A(i.node.children,r)||{children:{},childCount:0};i=new Eo(r,i,e),n=Cn(n),r=_n(n)}return i}function _o(e){return e.node.value}function Io(e,t){e.node.value=t,Oo(e)}function Co(e){return e.node.childCount>0}function Ao(e,t){qt(e.node.children,((n,i)=>{t(new Eo(n,e,i))}))}function To(e,t,n,i){n&&!i&&t(e),Ao(e,(e=>{To(e,t,!0,i)})),n&&i&&t(e)}function Ro(e){return new En(null===e.parent?e.name:Ro(e.parent)+"/"+e.name)}function Oo(e){null!==e.parent&&function(e,t,n){const i=function(e){return void 0===_o(e)&&!Co(e)}(n),r=C(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,Oo(e)):i||r||(e.node.children[t]=n.node,e.node.childCount++,Oo(e))}(e.parent,e.name,e)}const Po=/[\[\].#$\/\u0000-\u001F\u007F]/,Do=/[\[\].#$\u0000-\u001F\u007F]/,ko=10485760,xo=function(e){return"string"==typeof e&&0!==e.length&&!Po.test(e)},No=function(e){return"string"==typeof e&&0!==e.length&&!Do.test(e)},Mo=function(e,t,n){const i=n instanceof En?new Mn(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Ln(i));if("function"==typeof t)throw new Error(e+"contains a function "+Ln(i)+" with contents = "+t.toString());if(Mt(t))throw new Error(e+"contains "+t.toString()+" "+Ln(i));if("string"==typeof t&&t.length>ko/3&&V(t)>ko)throw new Error(e+"contains a string greater than "+ko+" utf8 bytes "+Ln(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,r=!1;if(qt(t,((t,o)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(r=!0,!xo(t)))throw new Error(e+" contains an invalid key ("+t+") "+Ln(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=V(t),Fn(e)}(i,t),Mo(e,o,i),function(e){const t=e.parts_.pop();e.byteLength_-=V(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),n&&r)throw new Error(e+' contains ".value" child '+Ln(i)+" in addition to actual children.")}},Fo=function(e,t,n,i){if(i&&void 0===t)return;const r=L(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(r+" must be an object containing the children to replace.");const o=[];qt(t,((e,t)=>{const i=new En(e);if(Mo(r,t,On(n,i)),".priority"===An(i)&&!(null===(s=t)||"string"==typeof s||"number"==typeof s&&!Mt(s)||s&&"object"==typeof s&&C(s,".sv")))throw new Error(r+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");var s;o.push(i)})),function(e,t){let n,i;for(n=0;n<t.length;n++){i=t[n];const r=Tn(i);for(let t=0;t<r.length;t++)if(".priority"===r[t]&&t===r.length-1);else if(!xo(r[t]))throw new Error(e+"contains an invalid key ("+r[t]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(kn);let r=null;for(n=0;n<t.length;n++){if(i=t[n],null!==r&&Nn(r,i))throw new Error(e+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}}(r,o)},Lo=function(e,t,n,i){if(!(i&&void 0===n||No(n)))throw new Error(L(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Vo=function(e,t,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Lo(e,t,n,i)};class jo{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Bo(e,t){let n=null;for(let i=0;i<t.length;i++){const r=t[i],o=r.getPath();null===n||xn(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(r)}n&&e.eventLists_.push(n)}function Uo(e,t,n){Bo(e,n),qo(e,(e=>xn(e,t)))}function Ho(e,t,n){Bo(e,n),qo(e,(e=>Nn(e,t)||Nn(t,e)))}function qo(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];r&&(t(r.path)?(Ko(e.eventLists_[i]),e.eventLists_[i]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}function Ko(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const i=n.getEventRunner();Rt&&Pt("event: "+n.toString()),Gt(i)}}}const $o=25;class Wo{constructor(e,t,n,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new jo,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Pi(),this.transactionQueueTree_=new Eo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Go(e,t,n){if(e.stats_=ln(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Ri(e.repoInfo_,((t,n,i,r)=>{Qo(e,t,n,i,r)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>Yo(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Bn(e.repoInfo_,t,((t,n,i,r)=>{Qo(e,t,n,i,r)}),(t=>{Yo(e,t)}),(t=>{!function(e,t){qt(t,((t,n)=>{Zo(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,n){const i=t.toString();return un[i]||(un[i]=new Ni(e.stats_,e.server_)),un[i]}(e.repoInfo_),e.infoData_=new Oi,e.infoSyncTree_=new Gr({startListening:(t,n,i,r)=>{let o=[];const s=e.infoData_.getNode(t._path);return s.isEmpty()||(o=Qr(e.infoSyncTree_,t._path,s),setTimeout((()=>{r("ok")}),0)),o},stopListening:()=>{}}),Zo(e,"connected",!1),e.serverSyncTree_=new Gr({startListening:(t,n,i,r)=>(e.server_.listen(t,i,n,((n,i)=>{const o=r(n,i);Ho(e.eventQueue_,t._path,o)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function zo(e){const t=e.infoData_.getNode(new En(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Jo(e){return fo({timestamp:zo(e)})}function Qo(e,t,n,i,r){e.dataUpdateCount++;const o=new En(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let s=[];if(r)if(i){const t=R(n,(e=>gi(e)));s=function(e,t,n,i){const r=ao(e,i);if(r){const i=uo(r),o=i.path,s=i.queryId,a=Dn(o,t),u=Qi.fromObject(n);return lo(e,o,new Bi(Fi(s),a,u))}return[]}(e.serverSyncTree_,o,t,r)}else{const t=gi(n);s=Zr(e.serverSyncTree_,o,t,r)}else if(i){const t=R(n,(e=>gi(e)));s=function(e,t,n){const i=Qi.fromObject(n);return to(e,new Bi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,o,t)}else{const t=gi(n);s=Qr(e.serverSyncTree_,o,t)}let a=o;s.length>0&&(a=os(e,o)),Ho(e.eventQueue_,a,s)}function Yo(e,t){Zo(e,"connected",t),!1===t&&function(e){ts(e,"onDisconnectEvents");const t=Jo(e),n=Pi();ki(e.onDisconnect_,wn(),((i,r)=>{const o=yo(i,r,e.serverSyncTree_,t);Di(n,i,o)}));let i=[];ki(n,wn(),((t,n)=>{i=i.concat(Qr(e.serverSyncTree_,t,n));const r=cs(e,t);os(e,r)})),e.onDisconnect_=Pi(),Ho(e.eventQueue_,wn(),i)}(e)}function Zo(e,t,n){const i=new En("/.info/"+t),r=gi(n);e.infoData_.updateSnapshot(i,r);const o=Qr(e.infoSyncTree_,i,r);Ho(e.eventQueue_,i,o)}function Xo(e){return e.nextWriteId_++}function es(e,t,n){let i;i=".info"===_n(t._path)?Yr(e.infoSyncTree_,t,n):Yr(e.serverSyncTree_,t,n),Uo(e.eventQueue_,t._path,i)}function ts(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Pt(n,...t)}function ns(e,t,n,i){t&&Gt((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let r=e;i&&(r+=": "+i);const o=new Error(r);o.code=e,t(o)}}))}function is(e,t,n){return eo(e.serverSyncTree_,t,n)||hi.EMPTY_NODE}function rs(t,n=t.transactionQueueTree_){if(n||ls(t,n),_o(n)){const i=as(t,n);e(i.length>0,"Sending zero length transaction queue"),i.every((e=>0===e.status))&&function(t,n,i){const r=i.map((e=>e.currentWriteId)),o=is(t,n,r);let s=o;const a=o.hash();for(let t=0;t<i.length;t++){const r=i[t];e(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const o=Dn(n,r.path);s=s.updateChild(o,r.currentOutputSnapshotRaw)}const u=s.val(!0),l=n;t.server_.put(l.toString(),u,(e=>{ts(t,"transaction put response",{path:l.toString(),status:e});let r=[];if("ok"===e){const e=[];for(let n=0;n<i.length;n++)i[n].status=2,r=r.concat(Jr(t.serverSyncTree_,i[n].currentWriteId)),i[n].onComplete&&e.push((()=>i[n].onComplete(null,!0,i[n].currentOutputSnapshotResolved))),i[n].unwatcher();ls(t,wo(t.transactionQueueTree_,n)),rs(t,t.transactionQueueTree_),Ho(t.eventQueue_,n,r);for(let t=0;t<e.length;t++)Gt(e[t])}else{if("datastale"===e)for(let e=0;e<i.length;e++)3===i[e].status?i[e].status=4:i[e].status=0;else{Nt("transaction at "+l.toString()+" failed: "+e);for(let t=0;t<i.length;t++)i[t].status=4,i[t].abortReason=e}os(t,n)}}),a)}(t,Ro(n),i)}else Co(n)&&Ao(n,(e=>{rs(t,e)}))}function os(t,n){const i=ss(t,n),r=Ro(i);return function(t,n,i){if(0===n.length)return;const r=[];let o=[];const s=n.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let u=0;u<n.length;u++){const l=n[u],c=Dn(i,l.path);let d,h=!1;if(e(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)h=!0,d=l.abortReason,o=o.concat(Jr(t.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=$o)h=!0,d="maxretry",o=o.concat(Jr(t.serverSyncTree_,l.currentWriteId,!0));else{const e=is(t,l.path,s);l.currentInputSnapshot=e;const i=n[u].update(e.val());if(void 0!==i){Mo("transaction failed: Data returned ",i,l.path);let n=gi(i);"object"==typeof i&&null!=i&&C(i,".priority")||(n=n.updatePriority(e.getPriority()));const r=l.currentWriteId,a=Jo(t),u=So(n,e,a);l.currentOutputSnapshotRaw=n,l.currentOutputSnapshotResolved=u,l.currentWriteId=Xo(t),s.splice(s.indexOf(r),1),o=o.concat(zr(t.serverSyncTree_,l.path,u,l.currentWriteId,l.applyLocally)),o=o.concat(Jr(t.serverSyncTree_,r,!0))}else h=!0,d="nodata",o=o.concat(Jr(t.serverSyncTree_,l.currentWriteId,!0))}Ho(t.eventQueue_,i,o),o=[],h&&(n[u].status=2,a=n[u].unwatcher,setTimeout(a,Math.floor(0)),n[u].onComplete&&("nodata"===d?r.push((()=>n[u].onComplete(null,!1,n[u].currentInputSnapshot))):r.push((()=>n[u].onComplete(new Error(d),!1,null)))))}var a;ls(t,t.transactionQueueTree_);for(let e=0;e<r.length;e++)Gt(r[e]);rs(t,t.transactionQueueTree_)}(t,as(t,i),r),r}function ss(e,t){let n,i=e.transactionQueueTree_;for(n=_n(t);null!==n&&void 0===_o(i);)i=wo(i,n),n=_n(t=Cn(t));return i}function as(e,t){const n=[];return us(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function us(e,t,n){const i=_o(t);if(i)for(let e=0;e<i.length;e++)n.push(i[e]);Ao(t,(t=>{us(e,t,n)}))}function ls(e,t){const n=_o(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Io(t,n.length>0?n:void 0)}Ao(t,(t=>{ls(e,t)}))}function cs(e,t){const n=Ro(ss(e,t)),i=wo(e.transactionQueueTree_,t);return function(e,t,n){let i=e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,(t=>{ds(e,t)})),ds(e,i),To(i,(t=>{ds(e,t)})),n}function ds(t,n){const i=_o(n);if(i){const r=[];let o=[],s=-1;for(let n=0;n<i.length;n++)3===i[n].status||(1===i[n].status?(e(s===n-1,"All SENT items should be at beginning of queue."),s=n,i[n].status=3,i[n].abortReason="set"):(e(0===i[n].status,"Unexpected transaction status in abort"),i[n].unwatcher(),o=o.concat(Jr(t.serverSyncTree_,i[n].currentWriteId,!0)),i[n].onComplete&&r.push(i[n].onComplete.bind(null,new Error("set"),!1,null))));-1===s?Io(n,void 0):i.length=s+1,Ho(t.eventQueue_,Ro(n),o);for(let e=0;e<r.length;e++)Gt(r[e])}}const hs=function(e,t){const n=ps(e),i=n.namespace;"firebase.com"===n.domain&&xt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||xt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Nt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const r="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new rn(n.host,n.secure,i,r,t,"",i!==n.subdomain),path:new En(n.pathString)}},ps=function(e){let t="",n="",i="",r="",o="",s=!0,a="https",u=443;if("string"==typeof e){let l=e.indexOf("//");l>=0&&(a=e.substring(0,l-1),e=e.substring(l+2));let c=e.indexOf("/");-1===c&&(c=e.length);let d=e.indexOf("?");-1===d&&(d=e.length),t=e.substring(0,Math.min(c,d)),c<d&&(r=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let i=n[e];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(c,d)));const h=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Nt(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,d)));l=t.indexOf(":"),l>=0?(s="https"===a||"wss"===a,u=parseInt(t.substring(l+1),10)):l=t.length;const p=t.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),n=t.substring(e+1),o=i}"ns"in h&&(o=h.ns)}return{host:t,port:u,domain:n,subdomain:i,secure:s,scheme:a,pathString:r,namespace:o}};class fs{constructor(e,t,n,i){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_(this.snapshot.exportVal())}}class gs{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class ms{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(t){return e(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class vs{constructor(e,t,n,i){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=i}get key(){return Pn(this._path)?null:An(this._path)}get ref(){return new ys(this._repo,this._path)}get _queryIdentifier(){const e=Ti(this._queryParams),t=Ut(e);return"{}"===t?"default":t}get _queryObject(){return Ti(this._queryParams)}isEqual(e){if(!((e=j(e))instanceof vs))return!1;const t=this._repo===e._repo,n=xn(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class ys extends vs{constructor(e,t){super(e,t,new Ci,!1)}get parent(){const e=Rn(this._path);return null===e?null:new ys(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Ss{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new En(e),n=Es(this.ref,e);return new Ss(this._node.getChild(t),n,ri)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((t,n)=>e(new Ss(n,Es(this.ref,t),ri))))}hasChild(e){const t=new En(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function bs(e,t){return(e=j(e))._checkNotDeleted("ref"),void 0!==t?Es(e._root,t):e._root}function Es(e,t){return null===_n((e=j(e))._path)?Vo("child","path",t,!1):Lo("child","path",t,!1),new ys(e._repo,On(e._path,t))}function ws(t,n){Fo("update",n,t._path,!1);const i=new g;return function(t,n,i,r){ts(t,"update",{path:n.toString(),value:i});let o=!0;const s=Jo(t),a={};if(qt(i,((e,i)=>{o=!1,a[e]=yo(On(n,e),gi(i),t.serverSyncTree_,s)})),o)Pt("update() called with empty data.  Don't do anything."),ns(0,r,"ok",void 0);else{const o=Xo(t),s=function(t,n,i,r){!function(t,n,i,r){e(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:n,children:i,writeId:r,visible:!0}),t.visibleWrites=Xi(t.visibleWrites,n,i),t.lastWriteId=r}(t.pendingWriteTree_,n,i,r);const o=Qi.fromObject(i);return to(t,new Bi({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},n,o))}(t.serverSyncTree_,n,a,o);Bo(t.eventQueue_,s),t.server_.merge(n.toString(),i,((e,i)=>{const s="ok"===e;s||Nt("update at "+n+" failed: "+e);const a=Jr(t.serverSyncTree_,o,!s),u=a.length>0?os(t,n):n;Ho(t.eventQueue_,u,a),ns(0,r,e,i)})),qt(i,(e=>{const i=cs(t,On(n,e));os(t,i)})),Ho(t.eventQueue_,n,[])}}(t._repo,t._path,n,i.wrapCallback((()=>{}))),i.promise}function _s(e){e=j(e);const t=new ms((()=>{})),n=new Is(t);return function(e,t,n){const i=function(e,t){const n=t._path;let i=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const r=Dn(e,n);i=i||Ur(t,r)}));let r=e.syncPointTree_.get(n);r?i=i||Ur(r,wn()):(r=new Lr,e.syncPointTree_=e.syncPointTree_.set(n,r));const o=null!=i,s=o?new Ui(i,!0,!1):null;return Gi(jr(r,t,ur(e.pendingWriteTree_,t._path),o?s.getNode():hi.EMPTY_NODE,o).viewCache_)}(e.serverSyncTree_,t);return null!=i?Promise.resolve(i):e.server_.get(t).then((i=>{const r=gi(i).withIndex(t._queryParams.getIndex());let o;if(Xr(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())o=Qr(e.serverSyncTree_,t._path,r);else{const n=oo(e.serverSyncTree_,t);o=Zr(e.serverSyncTree_,t._path,r,n)}return Ho(e.eventQueue_,t._path,o),Yr(e.serverSyncTree_,t,n,null,!0),r}),(n=>(ts(e,"get for query "+_(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new Ss(t,new ys(e._repo,e._path),e._queryParams.getIndex())))}class Is{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new fs("value",this,new Ss(e.snapshotNode,new ys(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new gs(this,e,t):null}matches(e){return e instanceof Is&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Cs{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new gs(this,e,t):null}createEvent(t,n){e(null!=t.childName,"Child events should have a childName.");const i=Es(new ys(n._repo,n._path),t.childName),r=n._queryParams.getIndex();return new fs(t.type,this,new Ss(t.snapshotNode,i,r),t.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Cs&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function As(e,t,n,i){return function(e,t,n,i,r){let o;if("object"==typeof i&&(o=void 0,r=i),"function"==typeof i&&(o=i),r&&r.onlyOnce){const t=n,i=(n,i)=>{es(e._repo,e,a),t(n,i)};i.userCallback=n.userCallback,i.context=n.context,n=i}const s=new ms(n,o||void 0),a="value"===t?new Is(s):new Cs(t,s);return function(e,t,n){let i;i=".info"===_n(t._path)?Xr(e.infoSyncTree_,t,n):Xr(e.serverSyncTree_,t,n),Uo(e.eventQueue_,t._path,i)}(e._repo,e,a),()=>es(e._repo,e,a)}(e,"value",t,n,i)}!function(t){e(!Mr,"__referenceConstructor has already been defined"),Mr=t}(ys),function(t){e(!Fr,"__referenceConstructor has already been defined"),Fr=t}(ys);const Ts={};function Rs(e,t,n,i,r){let o=i||e.options.databaseURL;void 0===o&&(e.options.projectId||xt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Pt("Using default host for project ",e.options.projectId),o=`${e.options.projectId}-default-rtdb.firebaseio.com`);let s,a,u=hs(o,r),l=u.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(s=!0,o=`http://${a}?ns=${l.namespace}`,u=hs(o,r),l=u.repoInfo):s=!u.repoInfo.secure;const c=r&&s?new Yt(Yt.OWNER):new Qt(e.name,e.options,t);(function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!xo(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),No(e)}(n))throw new Error(L(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",u),Pn(u.path)||xt("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function(e,t,n,i){let r=Ts[t.name];r||(r={},Ts[t.name]=r);let o=r[e.toURLString()];return o&&xt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Wo(e,false,n,i),r[e.toURLString()]=o,o}(l,e,c,new Jt(e.name,n));return new Os(d,e)}class Os{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Go(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ys(this._repo,wn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=Ts[t];n&&n[e.key]===e||xt(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&xt("Cannot call "+e+" on a deleted database.")}}function Ps(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Bn.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Bn.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},yt=et,Je(new B("database",((e,{instanceIdentifier:t})=>Rs(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),it(mt,vt,void 0),it(mt,vt,"esm2017"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Ds=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ks=new b("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),xs=new Q("@firebase/auth");function Ns(e,...t){xs.logLevel<=$.ERROR&&xs.error(`Auth (${et}): ${e}`,...t)}function Ms(e,...t){throw js(e,...t)}function Fs(e,...t){return js(e,...t)}function Ls(e,t,n){const i=Object.assign(Object.assign({},Ds()),{[t]:n});return new b("auth","Firebase",i).create(t,{appName:e.name})}function Vs(e){return Ls(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function js(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return ks.create(e,...t)}function Bs(e,t,...n){if(!e)throw js(t,...n)}function Us(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Ns(t),new Error(t)}function Hs(e,t){e||Us(t)}function qs(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ks(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function $s(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Ks()||"https:"===Ks()||function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Ws{constructor(e,t){this.shortDelay=e,this.longDelay=t,Hs(t>e,"Short delay should be less than long delay!"),this.isMobile=v()||y()}get(){return $s()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Gs(e,t){Hs(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class zs{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Us("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Us("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Us("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Js={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Qs=new Ws(3e4,6e4);function Ys(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Zs(e,t,n,i,r={}){return Xs(e,r,(async()=>{let r={},o={};i&&("GET"===t?o=i:r={body:JSON.stringify(i)});const s=D(Object.assign({key:e.config.apiKey},o)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),zs.fetch()(ta(e,e.config.apiHost,n,s),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},r))}))}async function Xs(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},Js),t);try{const t=new ia(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw ra(e,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const t=r.ok?o.errorMessage:o.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw ra(e,"credential-already-in-use",o);if("EMAIL_EXISTS"===n)throw ra(e,"email-already-in-use",o);if("USER_DISABLED"===n)throw ra(e,"user-disabled",o);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw Ls(e,a,s);Ms(e,a)}}catch(t){if(t instanceof S)throw t;Ms(e,"network-request-failed",{message:String(t)})}}async function ea(e,t,n,i,r={}){const o=await Zs(e,t,n,i,r);return"mfaPendingCredential"in o&&Ms(e,"multi-factor-auth-required",{_serverResponse:o}),o}function ta(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?Gs(e.config,r):`${e.config.apiScheme}://${r}`}function na(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ia{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Fs(this.auth,"network-request-failed"))),Qs.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function ra(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Fs(e,t,i);return r.customData._tokenResponse=n,r}function oa(e){return void 0!==e&&void 0!==e.enterprise}class sa{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return na(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function aa(e,t){return Zs(e,"POST","/v1/accounts:lookup",t)}function ua(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function la(e){return 1e3*Number(e)}function ca(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return Ns("JWT malformed, contained fewer than 3 sections"),null;try{const e=u(n);return e?JSON.parse(e):(Ns("Failed to decode base64 JWT payload"),null)}catch(e){return Ns("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function da(e){const t=ca(e);return Bs(t,"internal-error"),Bs(void 0!==t.exp,"internal-error"),Bs(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function ha(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof S&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class pa{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class fa{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ua(this.lastLoginAt),this.creationTime=ua(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ga(e){var t;const n=e.auth,i=await e.getIdToken(),r=await ha(e,aa(n,{idToken:i}));Bs(null==r?void 0:r.users.length,n,"internal-error");const o=r.users[0];e._notifyReloadListener(o);const s=(null===(t=o.providerUserInfo)||void 0===t?void 0:t.length)?ma(o.providerUserInfo):[],a=(u=e.providerData,l=s,[...u.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var u,l;const c=e.isAnonymous,d=!(e.email&&o.passwordHash||(null==a?void 0:a.length)),h=!!c&&d,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new fa(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(e,p)}function ma(e){return e.map((e=>{var{providerId:t}=e,n=Ps(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class va{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Bs(e.idToken,"internal-error"),Bs(void 0!==e.idToken,"internal-error"),Bs(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):da(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Bs(0!==e.length,"internal-error");const t=da(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(Bs(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await Xs(e,{},(async()=>{const n=D({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,o=ta(e,i,"/v1/token",`key=${r}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",zs.fetch()(o,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,o=new va;return n&&(Bs("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),i&&(Bs("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),r&&(Bs("number"==typeof r,"internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new va,this.toJSON())}_performRefresh(){return Us("not implemented")}}function ya(e,t){Bs("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Sa{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=Ps(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new pa(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new fa(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await ha(this,this.stsTokenManager.getToken(this.auth,e));return Bs(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=j(e),i=await n.getIdToken(t),r=ca(i);Bs(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const o="object"==typeof r.firebase?r.firebase:void 0,s=null==o?void 0:o.sign_in_provider;return{claims:r,token:i,authTime:ua(la(r.auth_time)),issuedAtTime:ua(la(r.iat)),expirationTime:ua(la(r.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=j(e);await ga(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Bs(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Sa(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Bs(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ga(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ye(this.auth.app))return Promise.reject(Vs(this.auth));const e=await this.getIdToken();return await ha(this,async function(e,t){return Zs(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,o,s,a,u,l;const c=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(o=t.photoURL)&&void 0!==o?o:void 0,f=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(u=t.createdAt)&&void 0!==u?u:void 0,v=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:y,emailVerified:S,isAnonymous:b,providerData:E,stsTokenManager:w}=t;Bs(y&&w,e,"internal-error");const _=va.fromJSON(this.name,w);Bs("string"==typeof y,e,"internal-error"),ya(c,e.name),ya(d,e.name),Bs("boolean"==typeof S,e,"internal-error"),Bs("boolean"==typeof b,e,"internal-error"),ya(h,e.name),ya(p,e.name),ya(f,e.name),ya(g,e.name),ya(m,e.name),ya(v,e.name);const I=new Sa({uid:y,auth:e,email:d,emailVerified:S,displayName:c,isAnonymous:b,photoURL:p,phoneNumber:h,tenantId:f,stsTokenManager:_,createdAt:m,lastLoginAt:v});return E&&Array.isArray(E)&&(I.providerData=E.map((e=>Object.assign({},e)))),g&&(I._redirectEventId=g),I}static async _fromIdTokenResponse(e,t,n=!1){const i=new va;i.updateFromServerResponse(t);const r=new Sa({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ga(r),r}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];Bs(void 0!==i.localId,"internal-error");const r=void 0!==i.providerUserInfo?ma(i.providerUserInfo):[],o=!(i.email&&i.passwordHash||(null==r?void 0:r.length)),s=new va;s.updateFromIdToken(n);const a=new Sa({uid:i.localId,auth:e,stsTokenManager:s,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new fa(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||(null==r?void 0:r.length))};return Object.assign(a,u),a}}const ba=new Map;function Ea(e){Hs(e instanceof Function,"Expected a class definition");let t=ba.get(e);return t?(Hs(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ba.set(e,t),t)}class wa{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}wa.type="NONE";const _a=wa;function Ia(e,t,n){return`firebase:${e}:${t}:${n}`}class Ca{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=Ia(this.userKey,i.apiKey,r),this.fullPersistenceKey=Ia("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Sa._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ca(Ea(_a),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||Ea(_a);const o=Ia(n,e.config.apiKey,e.name);let s=null;for(const n of t)try{const t=await n._get(o);if(t){const i=Sa._fromJSON(e,t);n!==r&&(s=i),r=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],s&&await r._set(o,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(o)}catch(e){}}))),new Ca(r,e,n)):new Ca(r,e,n)}}function Aa(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Pa(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Ta(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ka(t))return"Blackberry";if(xa(t))return"Webos";if(Ra(t))return"Safari";if((t.includes("chrome/")||Oa(t))&&!t.includes("edge/"))return"Chrome";if(Da(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Ta(e=m()){return/firefox\//i.test(e)}function Ra(e=m()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Oa(e=m()){return/crios\//i.test(e)}function Pa(e=m()){return/iemobile/i.test(e)}function Da(e=m()){return/android/i.test(e)}function ka(e=m()){return/blackberry/i.test(e)}function xa(e=m()){return/webos/i.test(e)}function Na(e=m()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Ma(e=m()){return Na(e)||Da(e)||xa(e)||ka(e)||/windows phone/i.test(e)||Pa(e)}function Fa(e,t=[]){let n;switch(e){case"Browser":n=Aa(m());break;case"Worker":n=`${Aa(m())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${et}/${i}`}class La{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(e){i(e)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class Va{constructor(e){var t,n,i,r;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=o.minPasswordLength)&&void 0!==t?t:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,o,s;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(o=a.containsNumericCharacter)||void 0===o||o),a.isValid&&(a.isValid=null===(s=a.containsNonAlphanumericCharacter)||void 0===s||s),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class ja{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ua(this),this.idTokenSubscription=new Ua(this),this.beforeStateQueue=new La(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ks,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ea(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Ca.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await aa(this,{idToken:e}),n=await Sa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ye(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,o=null==i?void 0:i._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==o||!(null==s?void 0:s.user)||(i=s.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Bs(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ga(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ye(this.app))return Promise.reject(Vs(this));const t=e?j(e):null;return t&&Bs(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Bs(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return Ye(this.app)?Promise.reject(Vs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ye(this.app)?Promise.reject(Vs(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Ea(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return Zs(e,"GET","/v2/passwordPolicy",Ys(e,t))}(this),t=new Va(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new b("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Zs(e,"POST","/v2/accounts:revokeToken",Ys(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ea(e)||this._popupRedirectResolver;Bs(t,this,"argument-error"),this.redirectPersistenceManager=await Ca.create(this,[Ea(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t);let o=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Bs(s,this,"internal-error"),s.then((()=>{o||r(this.currentUser)})),"function"==typeof t){const r=e.addObserver(t,n,i);return()=>{o=!0,r()}}{const n=e.addObserver(t);return()=>{o=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Bs(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Fa(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){xs.logLevel<=$.WARN&&xs.warn(`Auth (${et}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function Ba(e){return j(e)}class Ua{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new M(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Bs(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ha={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qa(e){return Ha.loadJS(e)}function Ka(e){return`__${e}${Math.floor(1e6*Math.random())}`}class $a{constructor(e){this.type="recaptcha-enterprise",this.auth=Ba(e)}async verify(e="verify",t=!1){function n(t,n,i){const r=window.grecaptcha;oa(r)?r.enterprise.ready((()=>{r.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{(async function(e,t){return Zs(e,"GET","/v2/recaptchaConfig",Ys(e,t))})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new sa(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((r=>{if(!t&&oa(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let t=Ha.recaptchaEnterpriseScript;0!==t.length&&(t+=r),qa(t).then((()=>{n(r,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function Wa(e,t,n,i=!1){const r=new $a(e);let o;try{o=await r.verify(n)}catch(e){o=await r.verify(n,!0)}const s=Object.assign({},t);return i?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function Ga(e,t,n,i){var r;if(null===(r=e._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await Wa(e,t,n,"getOobCode"===n);return i(e,r)}return i(e,t).catch((async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await Wa(e,t,n,"getOobCode"===n);return i(e,r)}return Promise.reject(r)}))}function za(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ja(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Qa{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Us("not implemented")}_getIdTokenResponse(e){return Us("not implemented")}_linkToIdToken(e,t){return Us("not implemented")}_getReauthenticationResolver(e){return Us("not implemented")}}async function Ya(e,t){return Zs(e,"POST","/v1/accounts:signUp",t)}async function Za(e,t){return ea(e,"POST","/v1/accounts:signInWithPassword",Ys(e,t))}class Xa extends Qa{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Xa(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Xa(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ga(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Za);case"emailLink":return async function(e,t){return ea(e,"POST","/v1/accounts:signInWithEmailLink",Ys(e,t))}(e,{email:this._email,oobCode:this._password});default:Ms(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ga(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ya);case"emailLink":return async function(e,t){return ea(e,"POST","/v1/accounts:signInWithEmailLink",Ys(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Ms(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function eu(e,t){return ea(e,"POST","/v1/accounts:signInWithIdp",Ys(e,t))}class tu extends Qa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new tu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ms("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=Ps(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new tu(n,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){return eu(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,eu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,eu(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=D(t)}return e}}const nu={USER_NOT_FOUND:"user-not-found"};class iu extends Qa{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new iu({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new iu({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return ea(e,"POST","/v1/accounts:signInWithPhoneNumber",Ys(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await ea(e,"POST","/v1/accounts:signInWithPhoneNumber",Ys(e,t));if(n.temporaryProof)throw ra(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return ea(e,"POST","/v1/accounts:signInWithPhoneNumber",Ys(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),nu)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new iu({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class ru{constructor(e){var t,n,i,r,o,s;const a=k(x(e)),u=null!==(t=a.apiKey)&&void 0!==t?t:null,l=null!==(n=a.oobCode)&&void 0!==n?n:null,c=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Bs(u&&l&&c,"argument-error"),this.apiKey=u,this.operation=c,this.code=l,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(o=a.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=a.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=k(x(e)).link,n=t?k(x(t)).deep_link_id:null,i=k(x(e)).deep_link_id;return(i?k(x(i)).link:null)||i||n||t||e}(e);try{return new ru(t)}catch(e){return null}}}class ou{constructor(){this.providerId=ou.PROVIDER_ID}static credential(e,t){return Xa._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ru.parseLink(t);return Bs(n,"argument-error"),Xa._fromEmailAndCode(e,n.code,n.tenantId)}}ou.PROVIDER_ID="password",ou.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ou.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class su{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class au extends su{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class uu extends au{constructor(){super("facebook.com")}static credential(e){return tu._fromParams({providerId:uu.PROVIDER_ID,signInMethod:uu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return uu.credentialFromTaggedObject(e)}static credentialFromError(e){return uu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return uu.credential(e.oauthAccessToken)}catch(e){return null}}}uu.FACEBOOK_SIGN_IN_METHOD="facebook.com",uu.PROVIDER_ID="facebook.com";class lu extends au{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return tu._fromParams({providerId:lu.PROVIDER_ID,signInMethod:lu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return lu.credentialFromTaggedObject(e)}static credentialFromError(e){return lu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return lu.credential(t,n)}catch(e){return null}}}lu.GOOGLE_SIGN_IN_METHOD="google.com",lu.PROVIDER_ID="google.com";class cu extends au{constructor(){super("github.com")}static credential(e){return tu._fromParams({providerId:cu.PROVIDER_ID,signInMethod:cu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cu.credentialFromTaggedObject(e)}static credentialFromError(e){return cu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return cu.credential(e.oauthAccessToken)}catch(e){return null}}}cu.GITHUB_SIGN_IN_METHOD="github.com",cu.PROVIDER_ID="github.com";class du extends au{constructor(){super("twitter.com")}static credential(e,t){return tu._fromParams({providerId:du.PROVIDER_ID,signInMethod:du.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return du.credentialFromTaggedObject(e)}static credentialFromError(e){return du.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return du.credential(t,n)}catch(e){return null}}}du.TWITTER_SIGN_IN_METHOD="twitter.com",du.PROVIDER_ID="twitter.com";class hu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await Sa._fromIdTokenResponse(e,n,i),o=pu(n);return new hu({user:r,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=pu(n);return new hu({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function pu(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class fu extends S{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,fu.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new fu(e,t,n,i)}}function gu(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw fu._fromErrorAndOperation(e,n,t,i);throw n}))}new WeakMap;const mu="__sak";class vu{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(mu,"1"),this.storage.removeItem(mu),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class yu extends vu{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=m();return Ra(e)||Na(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Ma(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);!function(){const e=m();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||r===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}yu.type="LOCAL";const Su=yu;class bu extends vu{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}bu.type="SESSION";const Eu=bu;class wu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new wu(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,o=this.handlersMap[i];if(!(null==o?void 0:o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const s=Array.from(o).map((async e=>e(t.origin,r))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function _u(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}wu.receivers=[];class Iu{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise(((s,a)=>{const u=_u("",20);i.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);o={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===u)switch(t.data.status){case"ack":clearTimeout(l),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),s(t.data.response);break;default:clearTimeout(l),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])})).finally((()=>{o&&this.removeMessageHandler(o)}))}}function Cu(){return window}function Au(){return void 0!==Cu().WorkerGlobalScope&&"function"==typeof Cu().importScripts}const Tu="firebaseLocalStorageDb",Ru="firebaseLocalStorage",Ou="fbase_key";class Pu{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Du(e,t){return e.transaction([Ru],t?"readwrite":"readonly").objectStore(Ru)}function ku(){const e=indexedDB.open(Tu,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Ru,{keyPath:Ou})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Ru)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Tu);return new Pu(e).toPromise()}(),t(await ku()))}))}))}async function xu(e,t,n){const i=Du(e,!0).put({[Ou]:t,value:n});return new Pu(i).toPromise()}function Nu(e,t){const n=Du(e,!0).delete(t);return new Pu(n).toPromise()}class Mu{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await ku()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Au()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wu._getInstance(Au()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Iu(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ku();return await xu(e,mu,"1"),await Nu(e,mu),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>xu(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Du(e,!1).get(t),i=await new Pu(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Nu(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Du(e,!1).getAll();return new Pu(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Mu.type="LOCAL";const Fu=Mu;Ka("rcb"),new Ws(3e4,6e4);class Lu{constructor(e){this.providerId=Lu.PROVIDER_ID,this.auth=Ba(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var i;const r=await n.verify();try{let o;if(Bs("string"==typeof r,e,"argument-error"),Bs("recaptcha"===n.type,e,"argument-error"),o="string"==typeof t?{phoneNumber:t}:t,"session"in o){const t=o.session;if("phoneNumber"in o){Bs("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Zs(e,"POST","/v2/accounts/mfaEnrollment:start",Ys(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Bs("signin"===t.type,e,"internal-error");const n=(null===(i=o.multiFactorHint)||void 0===i?void 0:i.uid)||o.multiFactorUid;Bs(n,e,"missing-multi-factor-info");const s=await function(e,t){return Zs(e,"POST","/v2/accounts/mfaSignIn:start",Ys(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Zs(e,"POST","/v1/accounts:sendVerificationCode",Ys(e,t))}(e,{phoneNumber:o.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}(this.auth,e,j(t))}static credential(e,t){return iu._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Lu.credentialFromTaggedObject(t)}static credentialFromError(e){return Lu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?iu._fromTokenResponse(t,n):null}}Lu.PROVIDER_ID="phone",Lu.PHONE_SIGN_IN_METHOD="phone";class Vu extends Qa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return eu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return eu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return eu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ju(e){return async function(e,t,n=!1){if(Ye(e.app))return Promise.reject(Vs(e));const i="signIn",r=await gu(e,i,t),o=await hu._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(o.user),o}(e.auth,new Vu(e),e.bypassAuthState)}function Bu(e){const{auth:t,user:n}=e;return Bs(n,t,"internal-error"),async function(e,t,n=!1){const{auth:i}=e;if(Ye(i.app))return Promise.reject(Vs(i));const r="reauthenticate";try{const o=await ha(e,gu(i,r,t,e),n);Bs(o.idToken,i,"internal-error");const s=ca(o.idToken);Bs(s,i,"internal-error");const{sub:a}=s;return Bs(e.uid===a,i,"user-mismatch"),hu._forOperation(e,r,o)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&Ms(i,"user-mismatch"),e}}(n,new Vu(e),e.bypassAuthState)}async function Uu(e){const{auth:t,user:n}=e;return Bs(n,t,"internal-error"),async function(e,t,n=!1){const i=await ha(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return hu._forOperation(e,"link",i)}(n,new Vu(e),e.bypassAuthState)}class Hu{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:o,type:s}=e;if(o)return void this.reject(o);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ju;case"linkViaPopup":case"linkViaRedirect":return Uu;case"reauthViaPopup":case"reauthViaRedirect":return Bu;default:Ms(this.auth,"internal-error")}}resolve(e){Hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Hs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const qu=new Ws(2e3,1e4);class Ku extends Hu{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Ku.currentPopupAction&&Ku.currentPopupAction.cancel(),Ku.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Bs(e,this.auth,"internal-error"),e}async onExecution(){Hs(1===this.filter.length,"Popup operations only handle one event");const e=_u();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Fs(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Fs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ku.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Fs(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,qu.get())};e()}}Ku.currentPopupAction=null;const $u="pendingRedirect",Wu=new Map;class Gu extends Hu{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Wu.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Ia($u,e.config.apiKey,e.name)}(t),i=function(e){return Ea(e._redirectPersistence)}(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Wu.set(this.auth._key(),e)}return this.bypassAuthState||Wu.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function zu(e,t){Wu.set(e._key(),t)}async function Ju(e,t,n=!1){if(Ye(e.app))return Promise.reject(Vs(e));const i=Ba(e),r=function(e,t){return t?Ea(t):(Bs(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(i,t),o=new Gu(i,r,n),s=await o.execute();return s&&!n&&(delete s.user._redirectEventId,await i._persistUserIfCurrent(s.user),await i._setRedirectUser(null,t)),s}class Qu{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Zu(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Zu(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Fs(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Yu(e))}saveEventToCache(e){this.cachedEventUids.add(Yu(e)),this.lastProcessedEventTime=Date.now()}}function Yu(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Zu({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Xu=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,el=/^https?/;function tl(e){const t=qs(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!el.test(n))return!1;if(Xu.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const nl=new Ws(3e4,6e4);function il(){const e=Cu().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function rl(e){return new Promise(((t,n)=>{var i,r,o;function s(){il(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{il(),n(Fs(e,"network-request-failed"))},timeout:nl.get()})}if(null===(r=null===(i=Cu().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(o=Cu().gapi)||void 0===o?void 0:o.load)){const t=Ka("iframefcb");return Cu()[t]=()=>{gapi.load?s():n(Fs(e,"network-request-failed"))},qa(`${Ha.gapiScript}?onload=${t}`).catch((e=>n(e)))}s()}})).catch((e=>{throw ol=null,e}))}let ol=null;const sl=new Ws(5e3,15e3),al="__/auth/iframe",ul="emulator/auth/iframe",ll={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cl=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dl(e){const t=e.config;Bs(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Gs(t,ul):`https://${e.config.authDomain}/${al}`,i={apiKey:t.apiKey,appName:e.name,v:et},r=cl.get(e.config.apiHost);r&&(i.eid=r);const o=e._getFrameworks();return o.length&&(i.fw=o.join(",")),`${n}?${D(i).slice(1)}`}const hl={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class pl{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const fl=encodeURIComponent("fac");async function gl(e,t,n,i,r,o){Bs(e.config.authDomain,e,"auth-domain-config-required"),Bs(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:et,eventId:r};if(t instanceof su){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",T(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))s[e]=t}if(t instanceof au){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const a=s;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const u=await e._getAppCheckToken(),l=u?`#${fl}=${encodeURIComponent(u)}`:"";return`${function({config:e}){return e.emulator?Gs(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${D(a).slice(1)}${l}`}const ml="webStorageSupport",vl=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Eu,this._completeRedirectFn=Ju,this._overrideRedirectResult=zu}async _openPopup(e,t,n,i){var r;return Hs(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,r=600){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),s=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const u=Object.assign(Object.assign({},hl),{width:i.toString(),height:r.toString(),top:o,left:s}),l=m().toLowerCase();n&&(a=Oa(l)?"_blank":n),Ta(l)&&(t=t||"http://localhost",u.scrollbars="yes");const c=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=m()){var t;return Na(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",a),new pl(null);const d=window.open(t||"",a,c);Bs(d,e,"popup-blocked");try{d.focus()}catch(e){}return new pl(d)}(e,await gl(e,t,n,qs(),i),_u())}async _openRedirect(e,t,n,i){return await this._originValidation(e),r=await gl(e,t,n,qs(),i),Cu().location.href=r,new Promise((()=>{}));var r}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Hs(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await function(e){return ol=ol||rl(e),ol}(e),n=Cu().gapi;return Bs(n,e,"internal-error"),t.open({where:document.body,url:dl(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ll,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=Fs(e,"network-request-failed"),o=Cu().setTimeout((()=>{i(r)}),sl.get());function s(){Cu().clearTimeout(o),n(t)}t.ping(s).then(s,(()=>{i(r)}))}))))}(e),n=new Qu(e);return t.register("authEvent",(t=>(Bs(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ml,{type:ml},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[ml];void 0!==r&&t(!!r),Ms(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Zs(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(tl(e))return}catch(e){}Ms(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ma()||Ra()||Na()}};var yl="@firebase/auth",Sl="1.7.4";class bl{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Bs(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const El=f("authIdTokenMaxAge")||300;let wl=null;function _l(e=nt()){const t=Qe(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Qe(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(O(n.getOptions(),null!=t?t:{}))return e;Ms(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:vl,persistence:[Fu,Su,Eu]}),i=f("authTokenSyncURL");if(i&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(i,location.origin);if(location.origin===e.origin){const t=(r=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>El)return;const i=null==t?void 0:t.token;wl!==i&&(wl=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(e,t,n){j(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,n,i,r){j(e).onIdTokenChanged((e=>t(e)),void 0,void 0)}(n)}}var r;const o=h("auth");return o&&function(e,t,n){const i=Ba(e);Bs(i._canInitEmulator,i,"emulator-config-failed"),Bs(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),o=za(t),{host:s,port:a}=function(e){const t=za(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:Ja(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:Ja(t)}}}(t),u=null===a?"":`:${a}`;i.config.emulator={url:`${o}//${s}${u}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${o}`),n}var Il,Cl;Il={loadJS:e=>new Promise(((t,n)=>{const i=document.createElement("script");var r,o;i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=Fs("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",(null!==(o=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==o?o:document).appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Ha=Il,Cl="Browser",Je(new B("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=n.options;Bs(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:o,authDomain:s,clientPlatform:Cl,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Fa(Cl)},u=new ja(n,i,r,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Ea);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(u,t),u}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Je(new B("auth-internal",(e=>{return t=Ba(e.getProvider("auth").getImmediate()),new bl(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),it(yl,Sl,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Cl)),it(yl,Sl,"esm2017");var Al=n(355),Tl=n(729);const Rl="RvXUSUKwSHeoelnnEyPFdQ",Ol="OaGp0UeaBUd6o58OJ7wqRoNR4OedQT8nqqa5",Pl=n.n(Tl)().createClient();async function Dl(e,t,n=!1){async function i(e){const i=Pl.getMediaStream();try{const r=await i.attachVideo(e.userId,Tl.VideoQuality.Video_1080P);n&&(r.style.transform="scaleX(-1)"),t.appendChild(r)}catch(e){console.error("Error connecting to video:",e)}}const r=Pl.getAllUser(),o=r.find((t=>t.userIdentity===e));o?(t.innerHTML="",console.log("User found:",o.userIdentity),await i(o)):(console.log(r),t.innerHTML=`${e} has not connected`),n||(Pl.on("user-added",(async t=>{const n=t.user;n.userIdentity===e&&(console.log(`User joined: ${n.userIdentity}`),await i(n))})),Pl.on("video-active-change",(async t=>{const n=Pl.getAllUser().find((e=>e.userId===t.userId));n&&n.userIdentity===e&&(console.log(`User started video: ${n.userIdentity}`),await i(n))})))}async function kl(e,t,n,i,r="Accept permissions to drop in!",o=!1){const s=document.createElement("div");s.className="container glass permissions-form",s.id="permissions-form";const a=document.createElement("p");a.id="label",a.className="monitor-label",a.innerText=r;const u=document.createElement("div");u.className="video",u.id="permissions-video-container";const l=document.createElement("video-player-container");l.id="permissions-video",u.appendChild(l);const c=document.createElement("div");c.id="camera-dropdown-container";const d=document.createElement("div");d.id="mic-dropdown-container";const h=document.createElement("div");h.id="speaker-dropdown-container";const p=document.createElement("button");p.id="accept-permissions-button",p.className="glass-button denied",p.innerText=r,p.disabled=!0;const f=document.createElement("div");f.className="permissions-dropdown-container",f.appendChild(c),f.appendChild(d),f.appendChild(h);const g=document.createElement("div");if(g.className="permissions-row",g.appendChild(u),g.appendChild(f),s.appendChild(g),o){const e=document.createElement("input");e.type="text",e.id="username",e.classList.add("glass"),e.name="username";const t=document.createElement("label");t.for="username",t.innerText="Display Name",s.appendChild(t),s.appendChild(e)}s.appendChild(p),e.appendChild(s),t.style.display="none",await async function(e,t,n,i){const r=function(e,t,n,i,r,o){const s=Math.round((new Date).getTime()/1e3)-30,a={app_key:e,tpc:n,role_type:i,session_key:r,user_identity:o,version:1,iat:s,exp:s+7200},u=JSON.stringify({alg:"HS256",typ:"JWT"}),l=JSON.stringify(a);return Al.hT.JWS.sign("HS256",u,l,t)}(Rl,Ol,t,i?1:0,n,e);try{await Pl.init("en-US","Global",{patchJsMedia:!0}),console.log("Joining ",t," with JWT token:",r," as ",e),await Pl.join(t,r,e,n)}catch(e){console.error("Error joining meeting:",e)}}(n,i,"",!0),await async function(){const e=Pl.getMediaStream(),t=document.createElement("video");t.autoplay=!0,t.muted=!0,t.setAttribute("playsinline","true");try{const n=Pl.getCurrentUserInfo().userId;await e.startVideo({videoElement:t,userId:n}),console.log("Current user video started without attaching to DOM")}catch(e){console.error("Error starting current user's video:",e)}}(),await async function(){const e=Pl.getMediaStream();try{const t=Pl.getAllUser();for(const n of t)console.log("Muting user audio",n.userId),e.adjustUserAudioVolumeLocally(n.userId,0);Pl.on("user-added",(async t=>{await e.adjustUserAudioVolumeLocally(t[0].userId,0),console.log("Muting user audio",t[0].userId)})),await e.startAudio(),console.log("Current user audio started")}catch(e){console.error("Error starting current user's audio:",e)}}(),await Dl(n,document.getElementById("permissions-video"),!0),function(e){const t=Pl.getMediaStream(),n=t.getCameraList(),i=document.createElement("select");i.id="camera-dropdown",i.className="glass",i.style.appearance="none",i.style.outline="none",i.addEventListener("change",(async function(){const e=n[this.selectedIndex];await t.switchCamera(e.deviceId)})),n.forEach((e=>{const t=document.createElement("option");t.value=e.deviceId,t.text=e.label,i.appendChild(t)})),e.appendChild(i)}(c),function(e){const t=Pl.getMediaStream(),n=t.getMicList(),i=document.createElement("select");i.id="mic-dropdown",i.className="glass",i.style.appearance="none",i.style.outline="none",i.addEventListener("change",(async function(){const e=n[this.selectedIndex];await t.switchMicrophone(e.deviceId)})),n.forEach((e=>{const t=document.createElement("option");t.value=e.deviceId,t.text=e.label,i.appendChild(t)})),e.appendChild(i)}(d),function(e){const t=Pl.getMediaStream(),n=t.getSpeakerList(),i=document.createElement("select");i.id="speaker-dropdown",i.className="glass",i.style.appearance="none",i.style.outline="none",console.log(n),i.addEventListener("change",(async function(){const e=n[this.selectedIndex];await t.switchSpeaker(e.deviceId)})),n.forEach((e=>{const t=document.createElement("option");t.value=e.deviceId,t.text=e.label,i.appendChild(t)})),e.appendChild(i)}(h),p.disabled=!1,p.id="acceptButton",document.addEventListener("AcceptedPermissions",(async function(){t.style.display="block",s.style.display="none"}));let m=null;p.addEventListener("click",(async function(){if(o){if(!document.getElementById("username").value)return;m=document.getElementById("username").value,n=m}await async function(e,t){const n=Pl.getAllUser().find((t=>t.userIdentity===e));if(n){const i=Pl.getMediaStream();await i.detachVideo(n.userId),t.innerHTML=`${e} has disconnected`}else t.innerHTML=`${e} has not connected`}(n,document.getElementById("permissions-video"));const e=new CustomEvent("AcceptedPermissions",{detail:{username:m}});document.dispatchEvent(e)}))}function xl(e,t){let n="0%",i="100%";const r=Object.keys(e).map((e=>parseInt(e)));r.sort(((e,t)=>e-t));for(let e=0;e<r.length;e++)if(r[e]<=t&&(n=r[e]+"%"),r[e]>=t){i=r[e]+"%";break}const o=e[n],s=e[i],a=parseInt(n),u=parseInt(i);let l;return l=a===u?o:o+(s-o)*(t-a)/(u-a),l=Math.max(l,0),l}function Nl(e,t=null){return 20*xl(t.blur,e)}function Ml(e,t=null){return xl(t.ambience,e)}function Fl(e,t=null){return 200*xl(t.translationX,e)-100}function Ll(e,t=null){return 200*xl(t.translationY,e)-100}function Vl(e,t=null){return console.log("Scale Progress",e,xl(t.scale,e)),xl(t.scale,e)}n(606);var jl,Bl="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ul={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var i=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var o=e.g[3],s=t+(o^n&(r^o))+i[0]+3614090360&4294967295;s=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=(n=(r=(o=(t=n+(s<<7&4294967295|s>>>25))+((s=o+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(o^t))+i[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(r^o))+i[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(o^t))+i[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(r^o))+i[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(o^t))+i[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(r^o))+i[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=r+(n^o&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^r&(o^t))+i[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(r^o&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(o^t))+i[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(r^o))+i[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^o&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(o^t))+i[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(r^o))+i[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^o&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(o^t))+i[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(r^o))+i[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^o&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=r+(t^n&(o^t))+i[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(r^o))+i[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^r^o)+i[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^t)+i[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^r^o)+i[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^t)+i[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^r^o)+i[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^t)+i[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^r^o)+i[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=r+(o^t^n)+i[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(r^o^t)+i[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(r^(n|~o))+i[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=r+(t^(o|~n))+i[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(r^(n|~o))+i[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=r+(t^(o|~n))+i[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(r^(n|~o))+i[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=r+(t^(o|~n))+i[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(t=n+((s=t+(r^(n|~o))+i[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((r=o+((s=r+(t^(o|~n))+i[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+o&4294967295}function i(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var o=0|e[r];i&&o==t||(n[r]=o,i=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,i){for(var r=Array(arguments.length-2),o=2;o<arguments.length;o++)r[o-2]=arguments[o];return t.prototype[n].apply(e,r)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var i=t-this.blockSize,r=this.B,o=this.h,s=0;s<t;){if(0==o)for(;s<=i;)n(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[o++]=e.charCodeAt(s++),o==this.blockSize){n(this,r),o=0;break}}else for(;s<t;)if(r[o++]=e[s++],o==this.blockSize){n(this,r),o=0;break}}this.h=o,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var r={};function o(e){return-128<=e&&128>e?function(e,t){var n=r;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new i([0|e],0>e?-1:0)}(e)}(e):new i([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return h(s(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var a=o(0),u=o(1),l=o(16777216);function c(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(u)}function p(e,t){return e.add(h(t))}function f(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function g(e,t){this.g=e,this.h=t}function m(e,t){if(c(t))throw Error("division by zero");if(c(e))return new g(a,a);if(d(e))return t=m(h(e),t),new g(h(t.g),h(t.h));if(d(t))return t=m(e,h(t)),new g(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=u,i=t;0>=i.l(e);)n=v(n),i=v(i);var r=y(n,1),o=y(i,1);for(i=y(i,2),n=y(n,2);!c(i);){var l=o.add(i);0>=l.l(e)&&(r=r.add(n),o=l),i=y(i,1),n=y(n,1)}return t=p(e,r.j(t)),new g(r,t)}for(r=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),l=(o=s(n)).j(t);d(l)||0<l.l(e);)l=(o=s(n-=i)).j(t);c(o)&&(o=u),r=r.add(o),e=p(e,l)}return new g(r,e)}function v(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,o=[],s=0;s<r;s++)o[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new i(o,e.h)}(e=i.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.i(n);e+=(0<=i?i:4294967296+i)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(c(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,i="";;){var r=m(n,t).g,o=((0<(n=p(n,r.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(c(n=r))return o+i;for(;6>o.length;)o="0"+o;i=o+i}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=p(this,e))?-1:c(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,o=0;o<=t;o++){var s=r+(65535&this.i(o))+(65535&e.i(o)),a=(s>>>16)+(this.i(o)>>>16)+(e.i(o)>>>16);r=a>>>16,s&=65535,a&=65535,n[o]=a<<16|s}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(c(this)||c(e))return a;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(l)&&0>e.l(l))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var o=0;o<e.g.length;o++){var u=this.i(r)>>>16,p=65535&this.i(r),g=e.i(o)>>>16,m=65535&e.i(o);n[2*r+2*o]+=p*m,f(n,2*r+2*o),n[2*r+2*o+1]+=u*m,f(n,2*r+2*o+1),n[2*r+2*o+1]+=p*g,f(n,2*r+2*o+1),n[2*r+2*o+2]+=u*g,f(n,2*r+2*o+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new i(n,0)},e.A=function(e){return m(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Ul.Md5=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=s,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=s(Math.pow(n,8)),r=a,o=0;o<t.length;o+=8){var u=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+u),n);8>u?(u=s(Math.pow(n,u)),r=r.j(u).add(s(l))):r=(r=r.j(i)).add(s(l))}return r},jl=Ul.Integer=i}).apply(void 0!==Bl?Bl:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Hl="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ql={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Hl&&Hl];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,i){if(i)e:{var r=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var s=e[o];if(!(s in r))break e;r=r[s]}(i=i(o=r[e=e[e.length-1]]))!=o&&null!=i&&t(r,e,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(0,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,(function(e,t){return t}))}}));var i=i||{},r=this||self;function o(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function u(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function l(e,t,n){return(l=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:u).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,i){for(var r=Array(arguments.length-2),o=2;o<arguments.length;o++)r[o-2]=arguments[o];return t.prototype[n].apply(e,r)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function p(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(o(n)){const t=e.length||0,i=n.length||0;e.length=t+i;for(let r=0;r<i;r++)e[t+r]=n[r]}else e.push(n)}}function f(e){return/^[\s\xa0]*$/.test(e)}function g(){var e=r.navigator;return e&&(e=e.userAgent)?e:""}function m(e){return m[" "](e),e}m[" "]=function(){};var v=!(-1==g().indexOf("Gecko")||-1!=g().toLowerCase().indexOf("webkit")&&-1==g().indexOf("Edge")||-1!=g().indexOf("Trident")||-1!=g().indexOf("MSIE")||-1!=g().indexOf("Edge"));function y(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function S(e){const t={};for(const n in e)t[n]=e[n];return t}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(e,t){let n,i;for(let t=1;t<arguments.length;t++){for(n in i=arguments[t],i)e[n]=i[n];for(let t=0;t<b.length;t++)n=b[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function w(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function _(e){r.setTimeout((()=>{throw e}),0)}function I(){var e=O;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var C=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new A),(e=>e.reset()));class A{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let T,R=!1,O=new class{constructor(){this.h=this.g=null}add(e,t){const n=C.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},P=()=>{const e=r.Promise.resolve(void 0);T=()=>{e.then(D)}};var D=()=>{for(var e;e=I();){try{e.h.call(e.g)}catch(e){_(e)}var t=C;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}R=!1};function k(){this.s=this.s,this.C=this.C}function x(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}k.prototype.s=!1,k.prototype.ma=function(){this.s||(this.s=!0,this.N())},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},x.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};r.addEventListener("test",e,t),r.removeEventListener("test",e,t)}catch(e){}return e}();function M(e,t){if(x.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{m(t.nodeName);var r=!0;break e}catch(e){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:F[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&M.aa.h.call(this)}}d(M,x);var F={2:"touch",3:"pen",4:"mouse"};M.prototype.h=function(){M.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var L="closure_listenable_"+(1e6*Math.random()|0),V=0;function j(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ha=r,this.key=++V,this.da=this.fa=!1}function B(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function U(e){this.src=e,this.g={},this.h=0}function H(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],o=Array.prototype.indexOf.call(r,t,void 0);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(B(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function q(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r];if(!o.da&&o.listener==t&&o.capture==!!n&&o.ha==i)return r}return-1}U.prototype.add=function(e,t,n,i,r){var o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);var s=q(e,t,i,r);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new j(t,this.src,o,!!i,r)).fa=n,e.push(t)),t};var K="closure_lm_"+(1e6*Math.random()|0),$={};function W(e,t,n,i,r){if(i&&i.once)return z(e,t,n,i,r);if(Array.isArray(t)){for(var o=0;o<t.length;o++)W(e,t[o],n,i,r);return null}return n=te(n),e&&e[L]?e.K(t,n,s(i)?!!i.capture:!!i,r):G(e,t,n,!1,i,r)}function G(e,t,n,i,r,o){if(!t)throw Error("Invalid event type");var a=s(r)?!!r.capture:!!r,u=X(e);if(u||(e[K]=u=new U(e)),(n=u.add(t,n,i,a,o)).proxy)return n;if(i=function(){const e=Z;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)N||(r=a),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(Y(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function z(e,t,n,i,r){if(Array.isArray(t)){for(var o=0;o<t.length;o++)z(e,t[o],n,i,r);return null}return n=te(n),e&&e[L]?e.L(t,n,s(i)?!!i.capture:!!i,r):G(e,t,n,!0,i,r)}function J(e,t,n,i,r){if(Array.isArray(t))for(var o=0;o<t.length;o++)J(e,t[o],n,i,r);else i=s(i)?!!i.capture:!!i,n=te(n),e&&e[L]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=q(o=e.g[t],n,i,r))&&(B(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--))):e&&(e=X(e))&&(t=e.g[t.toString()],e=-1,t&&(e=q(t,n,i,r)),(n=-1<e?t[e]:null)&&Q(n))}function Q(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[L])H(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(Y(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=X(t))?(H(n,e),0==n.h&&(n.src=null,t[K]=null)):B(e)}}}function Y(e){return e in $?$[e]:$[e]="on"+e}function Z(e,t){if(e.da)e=!0;else{t=new M(t,this);var n=e.listener,i=e.ha||e.src;e.fa&&Q(e),e=n.call(i,t)}return e}function X(e){return(e=e[K])instanceof U?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"==typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){k.call(this),this.i=new U(this),this.M=this,this.F=null}function ie(e,t){var n,i=e.F;if(i)for(n=[];i;i=i.F)n.push(i);if(e=e.M,i=t.type||t,"string"==typeof t)t=new x(t,e);else if(t instanceof x)t.target=t.target||e;else{var r=t;E(t=new x(i,e),r)}if(r=!0,n)for(var o=n.length-1;0<=o;o--){var s=t.g=n[o];r=re(s,i,!0,t)&&r}if(r=re(s=t.g=e,i,!0,t)&&r,r=re(s,i,!1,t)&&r,n)for(o=0;o<n.length;o++)r=re(s=t.g=n[o],i,!1,t)&&r}function re(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.da&&s.capture==n){var a=s.listener,u=s.ha||s.src;s.fa&&H(e.i,s),r=!1!==a.call(u,i)&&r}}return r&&!i.defaultPrevented}function oe(e,t,n){if("function"==typeof e)n&&(e=l(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return 2147483647<Number(t)?-1:r.setTimeout(e,t||0)}function se(e){e.g=oe((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}d(ne,k),ne.prototype[L]=!0,ne.prototype.removeEventListener=function(e,t,n,i){J(this,e,t,n,i)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)B(n[i]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},ne.prototype.L=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};class ae extends k{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ue(e){k.call(this),this.h=e,this.g={}}d(ue,k);var le=[];function ce(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Q(e)}),e),e.g={}}ue.prototype.N=function(){ue.aa.N.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var de=r.JSON.stringify,he=r.JSON.parse,pe=class{stringify(e){return r.JSON.stringify(e,void 0)}parse(e){return r.JSON.parse(e,void 0)}};function fe(){}function ge(e){return e.h||(e.h=e.i())}function me(){}fe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){x.call(this,"d")}function Se(){x.call(this,"c")}d(ye,x),d(Se,x);var be={},Ee=null;function we(){return Ee=Ee||new ne}function _e(e){x.call(this,be.La,e)}function Ie(e){const t=we();ie(t,new _e(t))}function Ce(e,t){x.call(this,be.STAT_EVENT,e),this.stat=t}function Ae(e){const t=we();ie(t,new Ce(t,e))}function Te(e,t){x.call(this,be.Ma,e),this.size=t}function Re(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return r.setTimeout((function(){e()}),t)}function Oe(){this.g=!0}function Pe(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return de(n)}catch(e){return t}}(e,n)+(i?" "+i:"")}))}be.La="serverreachability",d(_e,x),be.STAT_EVENT="statevent",d(Ce,x),be.Ma="timingevent",d(Te,x),Oe.prototype.xa=function(){this.g=!1},Oe.prototype.info=function(){};var De,ke={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},xe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Ne(){}function Me(e,t,n,i){this.j=e,this.i=t,this.l=n,this.R=i||1,this.U=new ue(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fe}function Fe(){this.i=null,this.g="",this.h=!1}d(Ne,fe),Ne.prototype.g=function(){return new XMLHttpRequest},Ne.prototype.i=function(){return{}},De=new Ne;var Le={},Ve={};function je(e,t,n){e.L=1,e.v=dt(st(t)),e.m=n,e.P=!0,Be(e,null)}function Be(e,t){e.F=Date.now(),qe(e),e.A=st(e.v);var n=e.A,i=e.R;Array.isArray(i)||(i=[String(i)]),Ct(n.i,"t",i),e.C=0,n=e.j.J,e.h=new Fe,e.g=pn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(l(e.Y,e,e.g),e.O)),t=e.U,n=e.g,i=e.ca;var r="readystatechange";Array.isArray(r)||(r&&(le[0]=r.toString()),r=le);for(var o=0;o<r.length;o++){var s=W(n,r[o],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?S(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ie(),function(e,t,n,i,r,o){e.info((function(){if(e.g)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var l=a[u].split("=");if(1<l.length){var c=l[0];l=l[1];var d=c.split("_");s=2<=d.length&&"type"==d[1]?s+(c+"=")+l+"&":s+(c+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ue(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.j.Ca}function He(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Ve:(n=Number(t.substring(n,i)),isNaN(n)?Le:(i+=1)+n>t.length?Ve:(t=t.slice(i,i+n),e.C=i+n,t))}function qe(e){e.S=Date.now()+e.I,Ke(e,e.I)}function Ke(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Re(l(e.ba,e),t)}function $e(e){e.B&&(r.clearTimeout(e.B),e.B=null)}function We(e){0==e.j.G||e.J||un(e.j,e)}function Ge(e){$e(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ce(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function ze(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Xe(n.h,e)))if(!e.K&&Xe(n.h,e)&&3==n.G){try{var i=n.Da.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;an(n),Qt(n)}rn(n),Ae(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=Re(l(n.Za,n),6e3));if(1>=Ze(n.h)&&n.ca){try{n.ca()}catch(e){}n.ca=void 0}}else cn(n,11)}else if((e.K||n.g==e)&&an(n),!f(t))for(r=n.Da.g.parse(t),t=0;t<r.length;t++){let l=r[t];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.K=l[1],n.ia=l[2];const t=l[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const r=l[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const c=l[5];null!=c&&"number"==typeof c&&0<c&&(i=1.5*c,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var o=i.h;o.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(et(o,o.h),o.h=null))}if(i.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.ya=e,ct(i.I,i.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((i=n).qa=hn(i,i.J?i.ia:null,i.W),s.K){tt(i.h,s);var a=s,u=i.L;u&&(a.I=u),a.B&&($e(a),qe(a)),i.g=s}else nn(i);0<n.i.length&&Zt(n)}else"stop"!=l[0]&&"close"!=l[0]||cn(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?cn(n,7):Jt(n):"noop"!=l[0]&&n.l&&n.l.ta(l),n.v=0)}Ie()}catch(e){}}Me.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==$t(e)?t.j():this.Y(e)},Me.prototype.Y=function(e){try{if(e==this.g)e:{const h=$t(this.g);var t=this.g.Ba();if(this.g.Z(),!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Wt(this.g)))){this.J||4!=h||7==t||Ie(),$e(this);var n=this.g.Z();this.X=n;t:if(Ue(this)){var i=Wt(this.g);e="";var o=i.length,s=4==$t(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ge(this),We(this);var a="";break t}this.h.i=new r.TextDecoder}for(t=0;t<o;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:!(s&&t==o-1)});i.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,i,r,o,s){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+o+" "+s}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var u,l=this.g;if((u=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!f(u)){var c=u;break t}}c=null}if(!(n=c)){this.o=!1,this.s=3,Ae(12),Ge(this),We(this);break e}Pe(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ze(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=He(this,a),e==Ve){4==h&&(this.s=4,Ae(14),n=!1),Pe(this.i,this.l,null,"[Incomplete Response]");break}if(e==Le){this.s=4,Ae(15),Pe(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Pe(this.i,this.l,e,null),ze(this,e)}if(Ue(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=a.length||this.h.h||(this.s=1,Ae(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),on(d),d.M=!0,Ae(11))}}else Pe(this.i,this.l,a,"[Invalid Chunked Response]"),Ge(this),We(this)}else Pe(this.i,this.l,a,null),ze(this,a);4==h&&Ge(this),this.o&&!this.J&&(4==h?un(this.j,this):(this.o=!1,qe(this)))}else(function(e){const t={};e=(e.g&&2<=$t(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(f(e[i]))continue;var n=w(e[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const o=t[r]||[];t[r]=o,o.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Ae(12)):(this.s=0,Ae(13)),Ge(this),We(this)}}}catch(e){}},Me.prototype.cancel=function(){this.J=!0,Ge(this)},Me.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Ie(),Ae(17)),Ge(this),this.s=2,We(this)):Ke(this,this.S-e)};var Je=class{constructor(e,t){this.g=e,this.map=t}};function Qe(e){this.l=e||10,e=r.PerformanceNavigationTiming?0<(e=r.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ye(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ze(e){return e.h?1:e.g?e.g.size:0}function Xe(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function it(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(o(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(o(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(o(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,s=0;s<r;s++)t.call(void 0,i[s],n&&n[s],e)}Qe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ot(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof ot){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,ut(this,e.s),this.l=e.l;var t=e.i,n=new Et;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),lt(this,n),this.m=e.m}else e&&(t=String(e).match(rt))?(this.h=!1,at(this,t[1]||"",!0),this.o=ht(t[2]||""),this.g=ht(t[3]||"",!0),ut(this,t[4]),this.l=ht(t[5]||"",!0),lt(this,t[6]||"",!0),this.m=ht(t[7]||"")):(this.h=!1,this.i=new Et(null,this.h))}function st(e){return new ot(e)}function at(e,t,n){e.j=n?ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ut(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function lt(e,t,n){t instanceof Et?(e.i=t,function(e,t){t&&!e.j&&(wt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(_t(this,t),Ct(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=pt(t,St)),e.i=new Et(t,e.h))}function ct(e,t,n){e.i.set(t,n)}function dt(e){return ct(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function pt(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ft),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ft(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ot.prototype.toString=function(){var e=[],t=this.j;t&&e.push(pt(t,mt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(pt(t,mt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(pt(n,"/"==n.charAt(0)?yt:vt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",pt(n,bt)),e.join("")};var gt,mt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,St=/[#\?@]/g,bt=/#/g;function Et(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function wt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var o=e[n].substring(0,i);r=e[n].substring(i+1)}else o=e[n];t(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function _t(e,t){wt(e),t=At(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function It(e,t){return wt(e),t=At(e,t),e.g.has(t)}function Ct(e,t,n){_t(e,t),0<n.length&&(e.i=null,e.g.set(At(e,t),h(n)),e.h+=n.length)}function At(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Tt(e,t,n,i,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),i(n)}catch(e){}}function Rt(){this.g=new pe}function Ot(e,t,n){const i=n||"";try{it(e,(function(e,n){let r=e;s(e)&&(r=de(e)),t.push(i+n+"="+encodeURIComponent(r))}))}catch(e){throw t.push(i+"type="+encodeURIComponent("_badmap")),e}}function Pt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Dt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function kt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function xt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Nt(e)}function Nt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Mt(e){let t="";return y(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Ft(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=Mt(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):ct(e,t,n))}function Lt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Et.prototype).add=function(e,t){wt(this),this.i=null,e=At(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){wt(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},e.na=function(){wt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},e.V=function(e){wt(this);let t=[];if("string"==typeof e)It(this,e)&&(t=t.concat(this.g.get(At(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return wt(this),this.i=null,It(this,e=At(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const o=encodeURIComponent(String(i)),s=this.V(i);for(i=0;i<s.length;i++){var r=o;""!==s[i]&&(r+="="+encodeURIComponent(String(s[i]))),e.push(r)}}return this.i=e.join("&")},d(Pt,fe),Pt.prototype.g=function(){return new Dt(this.l,this.j)},Pt.prototype.i=(gt={},function(){return gt}),d(Dt,ne),(e=Dt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Nt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||r).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,xt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Nt(this)),this.g&&(this.readyState=3,Nt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==r.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?xt(this):Nt(this),3==this.readyState&&kt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,xt(this))},e.Qa=function(e){this.g&&(this.response=e,xt(this))},e.ga=function(){this.g&&xt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Dt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),d(Lt,ne);var Vt=/^https?$/i,jt=["POST","PUT"];function Bt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Ut(e),qt(e)}function Ut(e){e.A||(e.A=!0,ie(e,"complete"),ie(e,"error"))}function Ht(e){if(e.h&&void 0!==i&&(!e.v[1]||4!=$t(e)||2!=e.Z()))if(e.u&&4==$t(e))oe(e.Ea,0,e);else if(ie(e,"readystatechange"),4==$t(e)){e.h=!1;try{const i=e.Z();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var o;if(o=0===i){var s=String(e.D).match(rt)[1]||null;!s&&r.self&&r.self.location&&(s=r.self.location.protocol.slice(0,-1)),o=!Vt.test(s?s.toLowerCase():"")}n=o}if(n)ie(e,"complete"),ie(e,"success");else{e.m=6;try{var a=2<$t(e)?e.g.statusText:""}catch(e){a=""}e.l=a+" ["+e.Z()+"]",Ut(e)}}finally{qt(e)}}}function qt(e,t){if(e.g){Kt(e);const n=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||ie(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function Kt(e){e.I&&(r.clearTimeout(e.I),e.I=null)}function $t(e){return e.g?e.g.readyState:0}function Wt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Gt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function zt(e){this.Aa=0,this.i=[],this.j=new Oe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gt("baseRetryDelayMs",5e3,e),this.cb=Gt("retryDelaySeedMs",1e4,e),this.Wa=Gt("forwardChannelMaxRetries",2,e),this.wa=Gt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Qe(e&&e.concurrentRequestLimit),this.Da=new Rt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Jt(e){if(Yt(e),3==e.G){var t=e.U++,n=st(e.I);if(ct(n,"SID",e.K),ct(n,"RID",t),ct(n,"TYPE","terminate"),en(e,n),(t=new Me(e,e.j,t)).L=2,t.v=dt(st(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&r.Image&&((new Image).src=t.v,n=!0),n||(t.g=pn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),qe(t)}dn(e)}function Qt(e){e.g&&(on(e),e.g.cancel(),e.g=null)}function Yt(e){Qt(e),e.u&&(r.clearTimeout(e.u),e.u=null),an(e),e.h.cancel(),e.s&&("number"==typeof e.s&&r.clearTimeout(e.s),e.s=null)}function Zt(e){if(!Ye(e.h)&&!e.s){e.s=!0;var t=e.Ga;T||P(),R||(T(),R=!0),O.add(t,e),e.B=0}}function Xt(e,t){var n;n=t?t.l:e.U++;const i=st(e.I);ct(i,"SID",e.K),ct(i,"RID",n),ct(i,"AID",e.T),en(e,i),e.m&&e.o&&Ft(i,e.m,e.o),n=new Me(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),je(n,i,t)}function en(e,t){e.H&&y(e.H,(function(e,n){ct(t,n,e)})),e.l&&it({},(function(e,n){ct(t,n,e)}))}function tn(e,t,n){n=Math.min(e.i.length,n);var i=e.l?l(e.l.Na,e.l,e):null;e:{var r=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let s=0;s<n;s++){let n=r[s].g;const a=r[s].map;if(n-=t,0>n)t=Math.max(0,r[s].g-100),o=!1;else try{Ot(a,e,"req"+n+"_")}catch(e){i&&i(a)}}if(o){i=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,i}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;T||P(),R||(T(),R=!0),O.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v||(e.Y++,e.u=Re(l(e.Fa,e),ln(e,e.v)),e.v++,0))}function on(e){null!=e.A&&(r.clearTimeout(e.A),e.A=null)}function sn(e){e.g=new Me(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=st(e.qa);ct(t,"RID","rpc"),ct(t,"SID",e.K),ct(t,"AID",e.T),ct(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ct(t,"TO",e.ja),ct(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Ft(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=dt(st(t)),n.m=null,n.P=!0,Be(n,e)}function an(e){null!=e.C&&(r.clearTimeout(e.C),e.C=null)}function un(e,t){var n=null;if(e.g==t){an(e),on(e),e.g=null;var i=2}else{if(!Xe(e.h,t))return;n=t.D,tt(e.h,t),i=1}if(0!=e.G)if(t.o)if(1==i){n=t.m?t.m.length:0,t=Date.now()-t.F;var r=e.B;ie(i=we(),new Te(i,n)),Zt(e)}else nn(e);else if(3==(r=t.s)||0==r&&0<t.X||!(1==i&&function(e,t){return!(Ze(e.h)>=e.h.j-(e.s?1:0)||(e.s?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa)||(e.s=Re(l(e.Ga,e,t),ln(e,e.B)),e.B++,0)))}(e,t)||2==i&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),r){case 1:cn(e,5);break;case 4:cn(e,10);break;case 3:cn(e,6);break;default:cn(e,2)}}function ln(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function cn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.fb,e),i=e.Xa;const t=!i;i=new ot(i||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||at(i,"https"),dt(i),t?function(e,t){const n=new Oe;if(r.Image){const i=new Image;i.onload=c(Tt,n,"TestLoadImage: loaded",!0,t,i),i.onerror=c(Tt,n,"TestLoadImage: error",!1,t,i),i.onabort=c(Tt,n,"TestLoadImage: abort",!1,t,i),i.ontimeout=c(Tt,n,"TestLoadImage: timeout",!1,t,i),r.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(i.toString(),n):function(e,t){new Oe;const n=new AbortController,i=setTimeout((()=>{n.abort(),Tt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(i),e.ok?Tt(0,0,!0,t):Tt(0,0,!1,t)})).catch((()=>{clearTimeout(i),Tt(0,0,!1,t)}))}(i.toString(),n)}else Ae(2);e.G=0,e.l&&e.l.sa(t),dn(e),Yt(e)}function dn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(p(e.ka,t),p(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function hn(e,t,n){var i=n instanceof ot?st(n):new ot(n);if(""!=i.g)t&&(i.g=t+"."+i.g),ut(i,i.s);else{var o=r.location;i=o.protocol,t=t?t+"."+o.hostname:o.hostname,o=+o.port;var s=new ot(null);i&&at(s,i),t&&(s.g=t),o&&ut(s,o),n&&(s.l=n),i=s}return n=e.D,t=e.ya,n&&t&&ct(i,n,t),ct(i,"VER",e.la),en(e,i),i}function pn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Lt(new Pt({eb:n})):new Lt(e.pa)).Ha(e.J),t}function fn(){}function gn(){}function mn(e,t){ne.call(this),this.g=new zt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!f(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!f(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Sn(this)}function vn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yn(){Se.call(this),this.status=1}function Sn(e){this.g=e}(e=Lt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():De.g(),this.v=this.o?ge(this.o):ge(De),this.g.onreadystatechange=l(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){return void Bt(this,e)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var o in i)n.set(o,i[o]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),o=r.FormData&&e instanceof r.FormData,!(0<=Array.prototype.indexOf.call(jt,t,void 0))||i||o||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Kt(this),this.u=!0,this.g.send(e),this.u=!1}catch(e){Bt(this,e)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,ie(this,"complete"),ie(this,"abort"),qt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qt(this,!0)),Lt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Ht(this):this.bb())},e.bb=function(){Ht(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<$t(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),he(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=zt.prototype).la=8,e.G=1,e.connect=function(e,t,n,i){Ae(0),this.W=e,this.H=t||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=hn(this,null,this.W),Zt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const r=new Me(this,this.j,e);let o=this.o;if(this.S&&(o?(o=S(o),E(o,this.S)):o=this.S),null!==this.m||this.O||(r.H=o,o=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,r,t),ct(n=st(this.I),"RID",e),ct(n,"CVER",22),this.D&&ct(n,"X-HTTP-Session-Id",this.D),en(this,n),o&&(this.O?t="headers="+encodeURIComponent(String(Mt(o)))+"&"+t:this.m&&Ft(n,this.m,o)),et(this.h,r),this.Ua&&ct(n,"TYPE","init"),this.P?(ct(n,"$req",t),ct(n,"SID","null"),r.T=!0,je(r,n,null)):je(r,n,t),this.G=2}}else 3==this.G&&(e?Xt(this,e):0==this.i.length||Ye(this.h)||Xt(this))},e.Fa=function(){if(this.u=null,sn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Re(l(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ae(10),Qt(this),sn(this))},e.Za=function(){null!=this.C&&(this.C=null,Qt(this),rn(this),Ae(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ae(2)):(this.j.info("Failed to ping google.com"),Ae(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=fn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},gn.prototype.g=function(e,t){return new mn(e,t)},d(mn,ne),mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mn.prototype.close=function(){Jt(this.g)},mn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=de(e),e=n);t.i.push(new Je(t.Ya++,e)),3==t.G&&Zt(t)},mn.prototype.N=function(){this.g.l=null,delete this.j,Jt(this.g),delete this.g,mn.aa.N.call(this)},d(vn,ye),d(yn,Se),d(Sn,fn),Sn.prototype.ua=function(){ie(this.g,"a")},Sn.prototype.ta=function(e){ie(this.g,new vn(e))},Sn.prototype.sa=function(e){ie(this.g,new yn)},Sn.prototype.ra=function(){ie(this.g,"b")},gn.prototype.createWebChannel=gn.prototype.g,mn.prototype.send=mn.prototype.o,mn.prototype.open=mn.prototype.m,mn.prototype.close=mn.prototype.close,ql.createWebChannelTransport=function(){return new gn},ql.getStatEventTarget=function(){return we()},ql.Event=be,ql.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ke.NO_ERROR=0,ke.TIMEOUT=8,ke.HTTP_ERROR=6,ql.ErrorCode=ke,xe.COMPLETE="complete",ql.EventType=xe,me.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,ql.WebChannel=me,ql.FetchXmlHttpFactory=Pt,Lt.prototype.listenOnce=Lt.prototype.L,Lt.prototype.getLastError=Lt.prototype.Ka,Lt.prototype.getLastErrorCode=Lt.prototype.Ba,Lt.prototype.getStatus=Lt.prototype.Z,Lt.prototype.getResponseJson=Lt.prototype.Oa,Lt.prototype.getResponseText=Lt.prototype.oa,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Ha,ql.XhrIo=Lt}).apply(void 0!==Hl?Hl:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const Kl="@firebase/firestore";class $l{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$l.UNAUTHENTICATED=new $l(null),$l.GOOGLE_CREDENTIALS=new $l("google-credentials-uid"),$l.FIRST_PARTY=new $l("first-party-uid"),$l.MOCK_USER=new $l("mock-user");let Wl="10.12.1";const Gl=new Q("@firebase/firestore");function zl(e,...t){if(Gl.logLevel<=$.DEBUG){const n=t.map(Ql);Gl.debug(`Firestore (${Wl}): ${e}`,...n)}}function Jl(e,...t){if(Gl.logLevel<=$.ERROR){const n=t.map(Ql);Gl.error(`Firestore (${Wl}): ${e}`,...n)}}function Ql(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Yl(e="Unexpected state"){const t=`FIRESTORE (${Wl}) INTERNAL ASSERTION FAILED: `+e;throw Jl(t),new Error(t)}function Zl(e,t){e||Yl()}const Xl="cancelled",ec="invalid-argument",tc="failed-precondition",nc="unavailable";class ic extends S{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class rc{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class oc{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sc{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t($l.UNAUTHENTICATED)))}shutdown(){}}class ac{constructor(e){this.t=e,this.currentUser=$l.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new rc;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new rc,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},s=e=>{zl("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(zl("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new rc)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(zl("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Zl("string"==typeof t.accessToken),new oc(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Zl(null===e||"string"==typeof e),new $l(e)}}class uc{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=$l.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class lc{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new uc(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t($l.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class cc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dc{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&zl("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,zl("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{zl("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?i(e):zl("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Zl("string"==typeof e.token),this.R=e.token,new cc(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function hc(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class pc{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=hc(40);for(let i=0;i<n.length;++i)t.length<20&&n[i]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return t}}function fc(e,t){return e<t?-1:e>t?1:0}class gc{constructor(e,t,n){void 0===t?t=0:t>e.length&&Yl(),void 0===n?n=e.length-t:n>e.length-t&&Yl(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===gc.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof gc?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class mc extends gc{construct(e,t,n){return new mc(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new ic(ec,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new mc(t)}static emptyPath(){return new mc([])}}class vc{constructor(e){this.path=e}static fromPath(e){return new vc(mc.fromString(e))}static fromName(e){return new vc(mc.fromString(e).popFirst(5))}static empty(){return new vc(mc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===mc.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return mc.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new vc(new mc(e.slice()))}}function yc(e){return"IndexedDbTransactionError"===e.name}class Sc{constructor(e,t){this.comparator=e,this.root=t||Ec.EMPTY}insert(e,t){return new Sc(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ec.BLACK,null,null))}remove(e){return new Sc(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ec.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bc(this.root,e,this.comparator,!1)}getReverseIterator(){return new bc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bc(this.root,e,this.comparator,!0)}}class bc{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ec{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:Ec.RED,this.left=null!=i?i:Ec.EMPTY,this.right=null!=r?r:Ec.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new Ec(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ec.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Ec.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ec.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ec.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Yl();if(this.right.isRed())throw Yl();const e=this.left.check();if(e!==this.right.check())throw Yl();return e+(this.isRed()?0:1)}}Ec.EMPTY=null,Ec.RED=!0,Ec.BLACK=!1,Ec.EMPTY=new class{constructor(){this.size=0}get key(){throw Yl()}get value(){throw Yl()}get color(){throw Yl()}get left(){throw Yl()}get right(){throw Yl()}copy(e,t,n,i,r){return this}insert(e,t,n){return new Ec(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class wc{constructor(e){this.comparator=e,this.data=new Sc(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _c(this.data.getIterator())}getIteratorFrom(e){return new _c(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof wc))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new wc(this.comparator);return t.data=e,t}}class _c{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ic extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Cc{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ic("Invalid base64 string: "+e):e}}(e);return new Cc(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Cc(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cc.EMPTY_BYTE_STRING=new Cc("");const Ac=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Tc(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}class Rc{constructor(e,t,n,i,r,o,s,a,u){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=a,this.useFetchStreams=u}}class Oc{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Oc("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Oc&&e.projectId===this.projectId&&e.database===this.database}}var Pc,Dc,kc,xc;new Sc(vc.comparator),new Sc(vc.comparator),new Sc(vc.comparator),new wc(vc.comparator),new wc(fc),(Dc=Pc||(Pc={}))[Dc.OK=0]="OK",Dc[Dc.CANCELLED=1]="CANCELLED",Dc[Dc.UNKNOWN=2]="UNKNOWN",Dc[Dc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Dc[Dc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Dc[Dc.NOT_FOUND=5]="NOT_FOUND",Dc[Dc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Dc[Dc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Dc[Dc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Dc[Dc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Dc[Dc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Dc[Dc.ABORTED=10]="ABORTED",Dc[Dc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Dc[Dc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Dc[Dc.INTERNAL=13]="INTERNAL",Dc[Dc.UNAVAILABLE=14]="UNAVAILABLE",Dc[Dc.DATA_LOSS=15]="DATA_LOSS",new jl([4294967295,4294967295],0),Error;class Nc{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Tc(e.integerValue));else if("doubleValue"in e){const n=Tc(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),function(e){return 0===e&&1/e==-1/0}(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Et(t,20),"string"==typeof n&&(n=function(e){if(Zl(!!e),"string"==typeof e){let t=0;const n=Ac.exec(e);if(Zl(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Tc(e.seconds),nanos:Tc(e.nanos)}}(n)),t.At(`${n.seconds||""}`),t.dt(n.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(function(e){return"string"==typeof e?Cc.fromBase64String(e):Cc.fromUint8Array(e)}(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?function(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):Yl()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const e of Object.keys(n))this.Rt(e,t),this.It(n[e],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const e of n)this.It(e,t)}gt(e,t){this.Et(t,37),vc.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}Nc.bt=new Nc,new Uint8Array(0);class Mc{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Mc(e,Mc.DEFAULT_COLLECTION_PERCENTILE,Mc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Fc(){return"undefined"!=typeof document?document:null}Mc.DEFAULT_COLLECTION_PERCENTILE=10,Mc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mc.DEFAULT=new Mc(41943040,Mc.DEFAULT_COLLECTION_PERCENTILE,Mc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mc.DISABLED=new Mc(-1,0,0);class Lc{constructor(e,t,n=1e3,i=1.5,r=6e4){this.oi=e,this.timerId=t,this.No=n,this.Lo=i,this.Bo=r,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();const t=Math.floor(this.ko+this.Uo()),n=Math.max(0,Date.now()-this.Qo),i=Math.max(0,t-n);i>0&&zl("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,(()=>(this.Qo=Date.now(),e()))),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){null!==this.qo&&(this.qo.skipDelay(),this.qo=null)}cancel(){null!==this.qo&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}class Vc{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new rc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,r){const o=Date.now()+n,s=new Vc(e,t,o,i,r);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ic(Xl,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}(xc=kc||(kc={})).J_="default",xc.Cache="cache";class jc{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=$l.UNAUTHENTICATED,this.clientId=pc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{zl("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(zl("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ic(tc,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=function(e,t){if(Jl("AsyncQueue",`${t}: ${e}`),yc(e))return new ic(nc,`${t}: ${e}`);throw e}(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}function Bc(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Uc=new Map;class Hc{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new ic(ec,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ic(ec,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new ic(ec,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Bc(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new ic(ec,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new ic(ec,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new ic(ec,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qc{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hc({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ic(tc,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ic(tc,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hc(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new sc;switch(e.type){case"firstParty":return new lc(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ic(ec,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Uc.get(e);t&&(zl("ComponentProvider","Removing Datastore"),Uc.delete(e),t.terminate())}(this),Promise.resolve()}}class Kc{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Lc(this,"async_queue_retry"),this.hu=()=>{const e=Fc();e&&zl("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Yo.Wo()};const e=Fc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=Fc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise((()=>{}));const t=new rc;return this.Iu((()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.su.push(e),this.Tu())))}async Tu(){if(0!==this.su.length){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!yc(e))throw e;zl("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o((()=>this.Tu()))}}Iu(e){const t=this.iu.then((()=>(this.uu=!0,e().catch((e=>{this.au=e,this.uu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Jl("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.uu=!1,e))))));return this.iu=t,t}enqueueAfterDelay(e,t,n){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const i=Vc.createAndSchedule(this,e,t,n,(e=>this.Eu(e)));return this._u.push(i),i}Pu(){this.au&&Yl()}verifyOperationInProgress(){}async du(){let e;do{e=this.iu,await e}while(e!==this.iu)}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then((()=>{this._u.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this._u)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.du()}))}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}class $c extends qc{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Kc,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||function(e){var t,n,i;const r=e._freezeSettings(),o=function(e,t,n,i){return new Rc(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Bc(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._firestoreClient=new jc(e._authCredentials,e._appCheckCredentials,e._queue,o),(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}(this),this._firestoreClient.terminate()}}new RegExp("[~\\*/\\[\\]]"),new WeakMap,function(e,t=!0){!function(e){Wl=e}(et),Je(new B("firestore",((e,{instanceIdentifier:n,options:i})=>{const r=e.getProvider("app").getImmediate(),o=new $c(new ac(e.getProvider("auth-internal")),new dc(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ic(ec,'"projectId" not provided in firebase.initializeApp.');return new Oc(e.options.projectId,t)}(r,n),r);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),it(Kl,"4.6.3",e),it(Kl,"4.6.3","esm2017")}();let Wc="scale";document.addEventListener("DOMContentLoaded",(async function(){document.getElementById("main-content").style.display="none",document.getElementById("home-button").addEventListener("click",(()=>{window.location.href="/"}));const e=_l(gt);let t=null,n=null,i=null,r=window.location.pathname.split("/"),o=r[r.length-1];console.log("id",o);const s=function(e=nt(),t){const n=Qe(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=(e=>{const t=h("database");if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]})();e&&function(e,t,n,i={}){(e=j(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&xt("Cannot call useEmulator() after instance has already been initialized.");const r=e._repoInternal;let o;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&xt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Yt(Yt.OWNER);else if(i.mockUserToken){const t="string"==typeof i.mockUserToken?i.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(o)),""].join(".")}(i.mockUserToken,e.app.options.projectId);o=new Yt(t)}!function(e,t,n,i){e.repoInfo_=new rn(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),i&&(e.authTokenProvider_=i)}(r,t,n,o)}(n,...e)}return n}(gt);As(bs(s,"globalValues"),(e=>{const t=e.val();Wc=t.interactionType})),As(bs(s,`offices/${o}`),(e=>{const t=e.val();console.log("data",t);const n=t;console.log("office",n),document.title=n.name,document.getElementById("heading").textContent=n.name,n.doorOpen||(document.getElementById("main-content").innerHTML=`<h1>${n.name}'s door is closed.</h1><p>Redirecting to home...</p>`,document.getElementById("main-content").style.display="block",setTimeout((()=>{window.location.href="/"}),3e3))}),(e=>{console.error("Error reading data:",e)})),e.onAuthStateChanged((r=>{if(r){t=r.uid,console.log("User: ",r),console.log("UID: ",t);const e=bs(s,`users/${t}`),a=As(e,(r=>{const u=r.val();console.log("data",u);const l=u;if(console.log("user",l),l||ws(e,{id:t}).then((()=>{console.log("User added to database with id:",t)})),n=l.id,i=l.displayName?l.displayName:null,l.currentOffice)console.log("leaving office!"),a();else{let e="Drop by "+document.getElementById("heading").textContent;kl(document.getElementById("permissions"),document.getElementById("main-content"),t,"Gates-OH",e,null==l.displayName),document.addEventListener("AcceptedPermissions",(async function(e){new Audio("../../door-knock.mp3");const r=new Audio("../../white-noise.mp3");r.loop=!0;const u=bs(s,"globalValues/curves");let l=(await _s(u)).val();As(u,(e=>{const t=e.val();l=t})),r.play();const c=document.getElementById("scroll-overlay"),d=bs(s,`users/${t}`);c.onscroll=()=>{const e=c.scrollHeight-c.clientHeight,t=c.scrollTop;let n=0;0!==e&&(n=Math.min(100,t/e*100)),ws(d,{interactionProgress:n})};const h=bs(s,`users/${t}/interactionProgress`);document.getElementById("hallcam-container").style.display="none",document.getElementById("hallcam-video-container").style.filter=`blur(${Nl(0,l)}px)`,r.volume=Ml(0,l),document.getElementById("hallcam-video-container").style.transform=`scale(${Vl(100,l)}) translateX(${Fl(0,l)}%) translateY(${Ll(0,l)}%)`,console.log(`scale(${Vl(0,l)}) translateX(${Fl(0,l)}%) translateY(${Ll(0,l)}%)`),setTimeout((()=>{document.getElementById("hallcam-container").style.display="block",As(h,(async e=>{const t=e.val();document.getElementById("hallcam-video-container").style.filter=`blur(${Nl(t,l)}px)`,document.getElementById("visitor-tutorial").style.opacity=`${function(e,t=null){return xl(t.tutorial,e)}(t,l)}`,document.getElementById("progress-inner").style.height=`${t}%`,async function(e,t){const n=Pl.getAllUser().find((t=>t.userIdentity===e));if(n){const e=Pl.getMediaStream();try{e.adjustUserAudioVolumeLocally(n.userId,t)}catch(e){console.error("Error playing user's audio:",e)}}else console.error(`${e} is not connected`)}(o+" monitor",function(e,t=null){return xl(t.office,e)}(t,l)),r.volume=Ml(t,l),document.getElementById("hallcam-video-container").style.transform=`scale(${Vl(t,l)}) translateX(${Fl(t,l)}%) translateY(${Ll(t,l)}%)`}))}),3e3),i=e.detail.username,a(),i&&ws(d,{displayName:i}),await async function(){const e=bs(s,`offices/${o}/visitLog`),t=(new Date).toLocaleString();if(!i){const e=bs(s,`users/${n}`),t=(await _s(e)).val();i=t.displayName}const r={displayName:i,id:n,time:t};ws(e,{[t.replace(/\//g,"-")]:r}).then((()=>{console.log("Visit log updated!")})),document.getElementById("hallcam-container").style.display="none",await Dl(o+" monitor",document.getElementById("hallcam-video")),await Dl(n,document.getElementById("preview-video")),document.getElementById("hallcam-container").style.display="block";ws(bs(s,`offices/${o}`),{currentVisitorId:n,currentVisitorName:i}).then((()=>{console.log("Current visitor updated!")})),ws(bs(s,`users/${n}`),{currentOffice:o}).then((()=>{console.log("Current office updated!")}))}(),document.getElementById("preview-video-container").classList.remove("preview-video-hidden")}))}}),(e=>{console.error("Error reading data:",e)}))}else console.error("No user is signed in."),async function(e){var t;if(Ye(e.app))return Promise.reject(Vs(e));const n=Ba(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new hu({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await async function(e,t){return ea(e,"POST","/v1/accounts:signUp",Ys(e,t))}(n,{returnSecureToken:!0}),r=await hu._fromIdTokenResponse(n,"signIn",i,!0);await n._updateCurrentUser(r.user)}(e)})),window.addEventListener("beforeunload",(async()=>{!async function(){var e;ws(bs(s,`offices/${o}`),{currentVisitorId:null,currentVisitorName:null}).then((()=>{console.log("Current visitor cleared!")})),ws(bs(s,`users/${n}`),{currentOffice:null,interactionProgress:null}).then((()=>{console.log("Current office cleared!")})),e=document.getElementById("preview-video-container"),Pl.leave().then((()=>{console.log("Left the meeting"),e.innerHTML=""})).catch((e=>{console.error("Error leaving the meeting:",e)}))}()}))}))})()})();